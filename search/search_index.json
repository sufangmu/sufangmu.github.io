{"config":{"lang":["en"],"separator":"[\\s\\-\\.]+","pipeline":["stemmer"]},"docs":[{"location":"DevOps/Ansible/AnsibleAPI/","title":"AnsibleAPI","text":""},{"location":"DevOps/Ansible/AnsibleAPI/#_1","title":"\u4e00\u3001\u5b98\u65b9\u793a\u4f8b","text":"<p>Ansible 2.7 API\u6587\u6863\uff1ahttps://docs.ansible.com/ansible/2.7/dev_guide/developing_api.html</p> <p>\u5b98\u65b9\u63d0\u4f9b\u7684\u793a\u4f8b\u4ee3\u7801\uff1a</p> <pre><code>#!/usr/bin/env python\n\nimport json\nimport shutil\nfrom collections import namedtuple\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.vars.manager import VariableManager\nfrom ansible.inventory.manager import InventoryManager\nfrom ansible.playbook.play import Play\nfrom ansible.executor.task_queue_manager import TaskQueueManager\nfrom ansible.plugins.callback import CallbackBase\nimport ansible.constants as C\n\nclass ResultCallback(CallbackBase):\n    \"\"\"A sample callback plugin used for performing an action as results come in\n\n    If you want to collect all results into a single object for processing at\n    the end of the execution, look into utilizing the ``json`` callback plugin\n    or writing your own custom callback plugin\n    \"\"\"\n    def v2_runner_on_ok(self, result, **kwargs):\n        \"\"\"Print a json representation of the result\n\n        This method could store the result in an instance attribute for retrieval later\n        \"\"\"\n        host = result._host\n        print(json.dumps({host.name: result._result}, indent=4))\n\n# since API is constructed for CLI it expects certain options to always be set, named tuple 'fakes' the args parsing options object\nOptions = namedtuple('Options', ['connection', 'module_path', 'forks', 'become', 'become_method', 'become_user', 'check', 'diff'])\noptions = Options(connection='local', module_path=['/to/mymodules'], forks=10, become=None, become_method=None, become_user=None, check=False, diff=False)\n\n# initialize needed objects\nloader = DataLoader() # Takes care of finding and reading yaml, json and ini files\npasswords = dict(vault_pass='secret')\n\n# Instantiate our ResultCallback for handling results as they come in. Ansible expects this to be one of its main display outlets\nresults_callback = ResultCallback()\n\n# create inventory, use path to host config file as source or hosts in a comma separated string\ninventory = InventoryManager(loader=loader, sources='localhost,')\n\n# variable manager takes care of merging all the different sources to give you a unifed view of variables available in each context\nvariable_manager = VariableManager(loader=loader, inventory=inventory)\n\n# create datastructure that represents our play, including tasks, this is basically what our YAML loader does internally.\nplay_source =  dict(\n        name = \"Ansible Play\",\n        hosts = 'localhost',\n        gather_facts = 'no',\n        tasks = [\n            dict(action=dict(module='shell', args='ls'), register='shell_out'),\n            dict(action=dict(module='debug', args=dict(msg='{{shell_out.stdout}}')))\n         ]\n    )\n\n# Create play object, playbook objects use .load instead of init or new methods,\n# this will also automatically create the task objects from the info provided in play_source\nplay = Play().load(play_source, variable_manager=variable_manager, loader=loader)\n\n# Run it - instantiate task queue manager, which takes care of forking and setting up all objects to iterate over host list and tasks\ntqm = None\ntry:\n    tqm = TaskQueueManager(\n              inventory=inventory,\n              variable_manager=variable_manager,\n              loader=loader,\n              options=options,\n              passwords=passwords,\n              stdout_callback=results_callback,  # Use our custom callback instead of the ``default`` callback plugin, which prints to stdout\n          )\n    result = tqm.run(play) # most interesting data for a play is actually sent to the callback's methods\nfinally:\n    # we always need to cleanup child procs and the structres we use to communicate with them\n    if tqm is not None:\n        tqm.cleanup()\n\n    # Remove ansible tmpdir\n    shutil.rmtree(C.DEFAULT_LOCAL_TMP, True)\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#_2","title":"\u4e8c\u3001\u5f00\u53d1\u73af\u5883\u51c6\u5907","text":""},{"location":"DevOps/Ansible/AnsibleAPI/#1-ansible","title":"1. \u5b89\u88c5<code>ansible</code>","text":"<pre><code>pip3 install ansible==2.7.18\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#2-sshpass","title":"2. \u5b89\u88c5<code>sshpass</code>","text":"<pre><code>sudo apt install sshpass\n</code></pre> <p>\u5982\u679c\u73af\u5883\u4e0a\u6ca1\u6709sshpass\uff0c\u4f1a\u5728\u6267\u884c\u65f6\u51fa\u73b0\u5982\u4e0b\u7684\u62b1\u9519\u4fe1\u606f</p> <pre><code>FAILED! =&gt; {\"msg\": \"to use the 'ssh' connection type with passwords, you must install the sshpass program\"}\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#3","title":"3. \u5ba2\u6237\u7aef\u673a\u5668\u51c6\u5907","text":"<p>\u5ba2\u6237\u7aef\u9700\u8981\u5b58\u5728<code>/usr/bin/python</code></p>"},{"location":"DevOps/Ansible/AnsibleAPI/#_3","title":"\u4e09\u3001\u6838\u5fc3\u7c7b","text":""},{"location":"DevOps/Ansible/AnsibleAPI/#1","title":"1. \u6838\u5fc3\u7c7b\u4ecb\u7ecd","text":"<pre><code>from ansible.parsing.dataloader import DataLoader  # \u4ece\u6587\u4ef6\u6216\u8005\u5b57\u7b26\u4e32\u4e2d\u89e3\u6790YAML\u6216JSON\u683c\u5f0f\u7684\u5185\u5bb9\nfrom ansible.vars.manager import VariableManager  # \u4e3b\u673a\u548c\u4e3b\u673a\u7ec4\u7684\u53d8\u91cf\u7ba1\u7406\u5668\nfrom ansible.inventory.manager import InventoryManager  # \u521b\u5efa\u548c\u7ba1\u7406inventory\nfrom ansible.playbook.play import Play  # \u7528\u4e8e\u6267\u884c Ad-hoc \u7684\u7c7b ,\u9700\u8981\u4f20\u5165\u76f8\u5e94\u7684\u53c2\u6570\nfrom ansible.executor.task_queue_manager import TaskQueueManager  # \u5e95\u5c42\u7528\u5230\u7684\u4efb\u52a1\u961f\u5217\u7ba1\u7406\u5668\nfrom ansible.executor.playbook_executor import PlaybookExecutor  # \u6267\u884cplaybook\u7684\u6838\u5fc3\u7c7b\nfrom ansible.plugins.callback import CallbackBase  # \u5904\u7406\u4efb\u52a1\u6267\u884c\u540e\u8fd4\u56de\u7684\u72b6\u6001\nfrom ansible.inventory.host import Host, Group  # \u64cd\u4f5c\u5355\u4e2a\u4e3b\u673a\u548c\u4e3b\u673a\u7ec4\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#2-inventorymanager","title":"2. <code>InventoryManager</code>\u5bf9\u8c61","text":"<p>\u5728\u811a\u672c\u8def\u5f84\u4e0b\u521b\u5efa\u4e00\u4e2ahosts\u6587\u4ef6</p> <pre><code>[nginx]\n10.0.0.128 ansible_ssh_user=root ansible_ssh_pass='root'\n</code></pre> <pre><code>#!/usr/bin/env python3\n\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.inventory.manager import InventoryManager\n\n# \u6570\u636e\u89e3\u6790\u5668\uff0c\u89e3\u6790yaml, json \u548c ini \u6587\u4ef6\nloader = DataLoader()\n\n# \u8fd4\u56de\u8d44\u4ea7\u76f8\u5173\u7684\u5b9e\u4f8b\u5bf9\u8c61\n# sources\u53ef\u4ee5\u662f1  [\u914d\u7f6e\u6587\u4ef6\u8def\u5f84,] 2 \u7528\u9017\u53f7\u5206\u9694\u7684\u4e3b\u673a\u5b57\u7b26\u4e32\ninventory = InventoryManager(loader=loader, sources=['hosts', ])\n\n# InventoryManager\u5bf9\u8c61\u5e38\u7528\u65b9\u6cd5\n# \u67e5\u770b\u4e3b\u673a\u7ec4\u8d44\u6e90\nprint(inventory.get_groups_dict())  # {'all': ['10.0.0.128'], 'ungrouped': [], 'nginx': ['10.0.0.128']}\nprint(inventory.get_hosts())  # [10.0.0.128]\n\n# \u6dfb\u52a0\u4e00\u4e2a\u4e3b\u673a\u7ec4\ninventory.add_group('mysql')\n# \u6dfb\u52a0\u4e00\u4e2a\u4e3b\u673a\u5230\u4e3b\u673a\u7ec4\ninventory.add_host(host='10.0.0.131', group='mysql')\n\nprint(inventory.get_groups_dict())  # {'all': ['10.0.0.128'], 'ungrouped': [], 'nginx': ['10.0.0.128'], 'mysql': ['10.0.0.131']}\nprint(inventory.get_hosts())  # [10.0.0.128]\n\n# \u83b7\u53d6\u4e3b\u673a\u5bf9\u8c61\nhost = inventory.get_host('10.0.0.128')  # \u6ca1\u6709\u627e\u5230\u8fd4\u56deNone\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#3-variablemanager","title":"3. <code>VariableManager</code>\u5bf9\u8c61","text":"<pre><code>#!/usr/bin/env python3\n\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.inventory.manager import InventoryManager\nfrom ansible.vars.manager import VariableManager\n\nloader = DataLoader()\ninventory = InventoryManager(loader=loader, sources=['hosts', ])\nvariable_manager = VariableManager(loader=loader, inventory=inventory)\n\n# \u67e5\u770b\u53d8\u91cf\nprint(variable_manager.get_vars())\n# {\n# 'playbook_dir': '/home/sufangmu/PycharmProjects/AnsibleApi',\n# 'ansible_playbook_python': '/home/sufangmu/PycharmProjects/AnsibleApi/venv/bin/python',\n# 'groups': {'all': ['10.0.0.128'], 'ungrouped': [], 'nginx': ['10.0.0.128']},\n# 'omit': '__omit_place_holder__9b6cf1a7b8c467643be6b872df9d5a2f9339deb5'\n# }\n\n# \u67e5\u770b\u4e3b\u673a\u53d8\u91cf\nprint(variable_manager.get_vars(host=inventory.get_host('10.0.0.128')))\n# {\n# 'inventory_file': '/home/sufangmu/PycharmProjects/AnsibleApi/hosts',\n# 'inventory_dir': '/home/sufangmu/PycharmProjects/AnsibleApi',\n# 'ansible_ssh_user': 'root',\n# 'ansible_ssh_pass': 'root',\n# 'inventory_hostname': '10.0.0.128',\n# 'inventory_hostname_short': '10',\n# 'group_names': ['nginx'],\n# 'ansible_facts': {},\n# 'playbook_dir': '/home/sufangmu/PycharmProjects/AnsibleApi',\n# 'ansible_playbook_python': '/home/sufangmu/PycharmProjects/AnsibleApi/venv/bin/python',\n# 'groups': {'all': ['10.0.0.128'], 'ungrouped': [], 'nginx': ['10.0.0.128']},\n# 'omit': '__omit_place_holder__a0e7d6a9b4c638536744031013463f4014bc9235'\n# }\n\n# \u8bbe\u7f6e\u4e3b\u673a\u53d8\u91cf\nvariable_manager.set_host_variable(host=inventory.get_host('10.0.0.128'), varname='ansible_ssh_pass', value='123456')\n\n# \u6dfb\u52a0\u6269\u5c55\u53d8\u91cf\nextra_vars = {'webdir': '/data/www'}\nvariable_manager.extra_vars = extra_vars\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#4-ad-hoc","title":"4. \u6267\u884c<code>Ad-hoc</code>\u547d\u4ee4","text":"<pre><code>#!/usr/bin/env python3\nfrom collections import namedtuple\n\nfrom ansible.executor.task_queue_manager import TaskQueueManager\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.inventory.manager import InventoryManager\nfrom ansible.playbook.play import Play\nfrom ansible.vars.manager import VariableManager\n\nloader = DataLoader()\ninventory = InventoryManager(loader=loader, sources=['hosts', ])\nvariable_manager = VariableManager(loader=loader, inventory=inventory)\nOptions = namedtuple('Options',\n                     ['connection',\n                      'module_path',\n                      'forks',\n                      'become',\n                      'become_method',\n                      'become_user',\n                      'check',\n                      'diff']\n                     )\n\noptions = Options(connection='smart',  # local \u8fde\u63a5\u672c\u5730\u673a\u5668 smart \u8fde\u63a5\u8fdc\u7a0b\u673a\u5668\n                  module_path=None,\n                  forks=10,\n                  become=None,\n                  become_method=None,\n                  become_user=None,\n                  check=False,\n                  diff=False)\n\n# \u521b\u5efatask\nplay_source = dict(\n    name=\"Ansible Play\",  # \u4efb\u52a1\u7684\u540d\u79f0\n    hosts='all',  # \u6267\u884c\u4efb\u52a1\u7684\u76ee\u6807\u4e3b\u673a \u7ec4\u540d\u6216\u4e3b\u673a\uff0c\u6216all\n    gather_facts='no',\n    tasks=[\n        dict(action=dict(module='shell', args='ls'), register='shell_out'),\n        dict(action=dict(module='debug', args=dict(msg='{{shell_out.stdout}}')))\n    ]\n)\n# \u521b\u5efaplay\u5bf9\u8c61\nplay = Play().load(play_source, variable_manager=variable_manager, loader=loader)\n\npasswords = dict()\ntqm = TaskQueueManager(\n    inventory=inventory,\n    variable_manager=variable_manager,\n    loader=loader,\n    options=options,\n    passwords=passwords,\n)\nresult = tqm.run(play)\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>PLAY [Ansible Play] ************************************************************\n\nTASK [shell] *******************************************************************\nchanged: [10.0.0.128]\n\nTASK [debug] *******************************************************************\nok: [10.0.0.128] =&gt; {\n    \"msg\": \"hello.txt\\nhelloworld.txt\\npackages\"\n}\n\nProcess finished with exit code 0\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#5-playbook","title":"5. \u6267\u884c<code>playbook</code>\u547d\u4ee4","text":"<p>\u521b\u5efaplaybook</p> <pre><code>---\n- hosts: all\n  remote_user: root\n  vars:\n    filename: helloworld.txt\n  tasks:\n    - name: create new file\n      file: name={{ filename }} state=touch\n</code></pre> <p>\u6267\u884c\u811a\u672c</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# Playbook\u65b9\u5f0f\nfrom collections import namedtuple\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.vars.manager import VariableManager\nfrom ansible.inventory.manager import InventoryManager\nfrom ansible.executor.playbook_executor import PlaybookExecutor\nimport ansible.constants as C\n\nC.HOST_KEY_CHECKING = False\n\nloader = DataLoader()\ninventory = InventoryManager(loader=loader, sources=['hosts'])\nvariable_manager = VariableManager(loader=loader, inventory=inventory)\nOptions = namedtuple('Options',\n                     ['connection',\n                      'module_path',\n                      'forks',\n                      'become',\n                      'become_method',\n                      'become_user',\n                      'listhosts',\n                      'listtasks',\n                      'listtags',\n                      'syntax',\n                      'check',\n                      'diff']\n                     )\n\noptions = Options(connection='smart',\n                  module_path=None,\n                  forks=10,\n                  become=None,\n                  become_method=None,\n                  become_user=None,\n                  listhosts=None,\n                  listtasks=None,\n                  listtags=None,\n                  syntax=None,\n                  check=False,\n                  diff=False)\n\npasswords = dict()\nplaybook = PlaybookExecutor(\n    playbooks=['my_playbook.yml'],\n    inventory=inventory,\n    variable_manager=variable_manager,\n    loader=loader,\n    options=options,\n    passwords=passwords,\n)\nresult = playbook.run()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>PLAY [all] *********************************************************************\n\nTASK [Gathering Facts] *********************************************************\nok: [10.0.0.128]\n\nTASK [create new file] *********************************************************\nchanged: [10.0.0.128]\n\nPLAY RECAP *********************************************************************\n10.0.0.128                 : ok=2    changed=1    unreachable=0    failed=0   \n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#6","title":"6. \u91cd\u5199\u56de\u8c03\u63d2\u4ef6","text":""},{"location":"DevOps/Ansible/AnsibleAPI/#61ad-hoc","title":"6.1\u91cd\u5199Ad-hoc\u7684\u6267\u884c\u7ed3\u679c\u5904\u7406","text":"<pre><code>#!/usr/bin/env python3\n\nimport json\nfrom collections import namedtuple\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.vars.manager import VariableManager\nfrom ansible.inventory.manager import InventoryManager\nfrom ansible.playbook.play import Play\nfrom ansible.executor.task_queue_manager import TaskQueueManager\nfrom ansible.plugins.callback import CallbackBase\nimport ansible.constants as C\n\nC.HOST_KEY_CHECKING = False\n\n\nclass ResultCallback(CallbackBase):\n    # \u56de\u8c03\u63d2\u4ef6\uff1a\u5f53\u7ed3\u679c\u51fa\u73b0\u65f6\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\n    def __init__(self, *args, **kwargs):\n        super(ResultCallback, self).__init__(*args, **kwargs)\n        self.host_ok = {}\n        self.host_failed = {}\n        self.host_unreachable = {}\n\n    def v2_runner_on_ok(self, result, **kwargs):\n        self.host_ok[result._host.name] = result\n\n    def v2_runner_on_failed(self, result, ignore_errors=False):\n        self.host_failed[result._host.name] = result\n\n    def v2_runner_on_unreachable(self, result):\n        self.host_unreachable[result._host.name] = result\n\n\nloader = DataLoader()\ninventory = InventoryManager(loader=loader, sources=['hosts'])\nvariable_manager = VariableManager(loader=loader, inventory=inventory)\nOptions = namedtuple('Options',\n                     ['connection',\n                      'module_path',\n                      'forks',\n                      'become',\n                      'become_method',\n                      'become_user',\n                      'check',\n                      'diff']\n                     )\n\noptions = Options(connection='smart',  # local \u8fde\u63a5\u672c\u5730\u673a\u5668 smart \u8fde\u63a5\u8fdc\u7a0b\u673a\u5668\n                  module_path=None,\n                  forks=10,\n                  become=None,\n                  become_method=None,\n                  become_user=None,\n                  check=False,\n                  diff=False)\n\nplay_source = dict(\n    name=\"Ansible Play\",\n    hosts='all',\n    gather_facts='no',\n    tasks=[\n        dict(action=dict(module='shell', args='ls packages/readme.md'), register='shell_out'),\n\n    ]\n)\n\nplay = Play().load(play_source, variable_manager=variable_manager, loader=loader)\n\npasswords = dict()\nresults_callback = ResultCallback()\ntqm = TaskQueueManager(\n    inventory=inventory,\n    variable_manager=variable_manager,\n    loader=loader,\n    options=options,\n    passwords=passwords,\n    stdout_callback=results_callback,\n)\n\nresult = tqm.run(play)\n\nresult_raw = {\"ok\": {}, 'failed': {}, \"unreachable\": {}}\n\nfor host, result in results_callback.host_ok.items():\n    result_raw[\"ok\"][host] = result._result\nfor host, result in results_callback.host_failed.items():\n    result_raw[\"failed\"][host] = result._result\nfor host, result in results_callback.host_unreachable.items():\n    result_raw[\"unreachable\"][host] = result._result\n# \u683c\u5f0f\u5316\u8f93\u51fa\u7ed3\u679c\nprint(json.dumps(result_raw, indent=4))\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>/home/sufangmu/PycharmProjects/AnsibleApi/venv/bin/python /home/sufangmu/PycharmProjects/AnsibleApi/main5.py\n{\n    \"ok\": {\n        \"10.0.0.128\": {\n            \"cmd\": \"ls packages/readme.md\",\n            \"stdout\": \"packages/readme.md\",\n            \"stderr\": \"\",\n            \"rc\": 0,\n            \"start\": \"2021-09-05 15:49:44.308900\",\n            \"end\": \"2021-09-05 15:49:44.312274\",\n            \"delta\": \"0:00:00.003374\",\n            \"changed\": true,\n            \"invocation\": {\n                \"module_args\": {\n                    \"_raw_params\": \"ls packages/readme.md\",\n                    \"_uses_shell\": true,\n                    \"warn\": true,\n                    \"argv\": null,\n                    \"chdir\": null,\n                    \"executable\": null,\n                    \"creates\": null,\n                    \"removes\": null,\n                    \"stdin\": null\n                }\n            },\n            \"_ansible_parsed\": true,\n            \"stdout_lines\": [\n                \"packages/readme.md\"\n            ],\n            \"stderr_lines\": [],\n            \"_ansible_no_log\": false\n        }\n    },\n    \"failed\": {\n        \"10.0.0.131\": {\n            \"end\": \"2021-09-05 15:49:43.944436\",\n            \"stdout\": \"\",\n            \"cmd\": \"ls packages/readme.md\",\n            \"delta\": \"0:00:00.003367\",\n            \"changed\": true,\n            \"start\": \"2021-09-05 15:49:43.941069\",\n            \"msg\": \"non-zero return code\",\n            \"stderr\": \"ls: cannot access 'packages/readme.md': No such file or directory\",\n            \"rc\": 2,\n            \"invocation\": {\n                \"module_args\": {\n                    \"_uses_shell\": true,\n                    \"_raw_params\": \"ls packages/readme.md\",\n                    \"removes\": null,\n                    \"executable\": null,\n                    \"stdin\": null,\n                    \"warn\": true,\n                    \"argv\": null,\n                    \"creates\": null,\n                    \"chdir\": null\n                }\n            },\n            \"_ansible_parsed\": true,\n            \"stdout_lines\": [],\n            \"stderr_lines\": [\n                \"ls: cannot access 'packages/readme.md': No such file or directory\"\n            ],\n            \"_ansible_no_log\": false\n        }\n    },\n    \"unreachable\": {\n        \"10.0.0.129\": {\n            \"unreachable\": true,\n            \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host 10.0.0.129 port 22: No route to host\",\n            \"changed\": false\n        }\n    }\n}\n\nProcess finished with exit code 0\n</code></pre>"},{"location":"DevOps/Ansible/AnsibleAPI/#62-playbook","title":"6.2 \u91cd\u5199playbook\u7684\u6267\u884c\u7ed3\u679c\u5904\u7406","text":"<pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# Playbook\u65b9\u5f0f\nimport json\nfrom collections import namedtuple\nfrom ansible.parsing.dataloader import DataLoader\nfrom ansible.plugins.callback import CallbackBase\nfrom ansible.vars.manager import VariableManager\nfrom ansible.inventory.manager import InventoryManager\nfrom ansible.executor.playbook_executor import PlaybookExecutor\nimport ansible.constants as C\n\nC.HOST_KEY_CHECKING = False\n\n\nclass PlaybookResultCallback(CallbackBase):\n    # \u56de\u8c03\u63d2\u4ef6\uff1a\u5f53\u7ed3\u679c\u51fa\u73b0\u65f6\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\n    def __init__(self, *args, **kwargs):\n        super(PlaybookResultCallback, self).__init__(*args, **kwargs)\n        self.task_ok = {}\n        self.task_failed = {}\n        self.task_unreachable = {}\n        self.task_skipped = {}\n        self.task_stats = {}\n    def v2_runner_on_ok(self, result, **kwargs):\n        self.task_ok[result._host.name] = result\n\n    def v2_runner_on_failed(self, result, ignore_errors=False):\n        self.task_failed[result._host.name] = result\n\n    def v2_runner_on_unreachable(self, result):\n        self.task_unreachable[result._host.name] = result\n\n    def v2_runner_on_skipped(self, result):\n        self.task_skipped[result._host.name] = result\n\n    def v2_playbook_on_stats(self, stats):\n        hosts = stats.processed.keys()\n        for host in hosts:\n            t = stats.summarize(host)\n            self.task_stats[host] = {\n                \"ok\":t['ok'],\n                \"failed\":t[\"failures\"],\n                \"unreachable\":t[\"unreachable\"],\n                \"skipped\":t[\"skipped\"],\n                \"changed\":t[\"changed\"]\n            }\n\nloader = DataLoader()\ninventory = InventoryManager(loader=loader, sources=['hosts'])\nvariable_manager = VariableManager(loader=loader, inventory=inventory)\nOptions = namedtuple('Options',\n                     ['connection',\n                      'module_path',\n                      'forks',\n                      'become',\n                      'become_method',\n                      'become_user',\n                      'listhosts',\n                      'listtasks',\n                      'listtags',\n                      'syntax',\n                      'check',\n                      'diff']\n                     )\n\noptions = Options(connection='smart',\n                  module_path=None,\n                  forks=10,\n                  become=None,\n                  become_method=None,\n                  become_user=None,\n                  listhosts=None,\n                  listtasks=None,\n                  listtags=None,\n                  syntax=None,\n                  check=False,\n                  diff=False)\n\npasswords = dict()\nplaybook = PlaybookExecutor(\n    playbooks=['my_playbook.yml'],\n    inventory=inventory,\n    variable_manager=variable_manager,\n    loader=loader,\n    options=options,\n    passwords=passwords,\n)\n\nresults_callback = PlaybookResultCallback()\nplaybook._tqm._stdout_callback = results_callback\nresult = playbook.run()\n\nresult_raw = {\"ok\": {}, 'failed': {}, \"unreachable\": {}, \"skipped\": {},\"stats\":{}}\n\nfor host, result in results_callback.task_ok.items():\n    result_raw[\"ok\"][host] = result._result\nfor host, result in results_callback.task_failed.items():\n    result_raw[\"failed\"][host] = result._result\nfor host, result in results_callback.task_unreachable.items():\n    result_raw[\"unreachable\"][host] = result._result\nfor host, result in results_callback.task_skipped.items():\n    result_raw[\"skipped\"][host] = result._result\nfor host, result in results_callback.task_stats.items():\n    result_raw[\"stats\"][host] = result\nprint(json.dumps(result_raw, indent=4))\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>{\n    \"ok\": {\n        \"10.0.0.128\": {\n            \"cmd\": \"echo hello world\",\n            \"stdout\": \"hello world\",\n            \"stderr\": \"\",\n            \"rc\": 0,\n            \"start\": \"2021-09-05 16:51:49.568878\",\n            \"end\": \"2021-09-05 16:51:49.572153\",\n            \"delta\": \"0:00:00.003275\",\n            \"changed\": true,\n            \"invocation\": {\n                \"module_args\": {\n                    \"_raw_params\": \"echo hello world\",\n                    \"_uses_shell\": true,\n                    \"warn\": true,\n                    \"argv\": null,\n                    \"chdir\": null,\n                    \"executable\": null,\n                    \"creates\": null,\n                    \"removes\": null,\n                    \"stdin\": null\n                }\n            },\n            \"_ansible_parsed\": true,\n            \"stdout_lines\": [\n                \"hello world\"\n            ],\n            \"stderr_lines\": [],\n            \"_ansible_no_log\": false\n        },\n        \"10.0.0.131\": {\n            \"invocation\": {\n                \"module_args\": {\n                    \"warn\": true,\n                    \"_raw_params\": \"echo hello world\",\n                    \"stdin\": null,\n                    \"argv\": null,\n                    \"creates\": null,\n                    \"chdir\": null,\n                    \"removes\": null,\n                    \"executable\": null,\n                    \"_uses_shell\": true\n                }\n            },\n            \"end\": \"2021-09-05 16:51:49.623818\",\n            \"changed\": true,\n            \"delta\": \"0:00:00.003706\",\n            \"rc\": 0,\n            \"stdout\": \"hello world\",\n            \"stderr\": \"\",\n            \"start\": \"2021-09-05 16:51:49.620112\",\n            \"cmd\": \"echo hello world\",\n            \"_ansible_parsed\": true,\n            \"stdout_lines\": [\n                \"hello world\"\n            ],\n            \"stderr_lines\": [],\n            \"_ansible_no_log\": false\n        }\n    },\n    \"failed\": {},\n    \"unreachable\": {\n        \"10.0.0.129\": {\n            \"unreachable\": true,\n            \"msg\": \"Failed to connect to the host via ssh: ssh: connect to host 10.0.0.129 port 22: No route to host\",\n            \"changed\": false\n        }\n    },\n    \"skipped\": {\n        \"10.0.0.131\": {\n            \"changed\": false,\n            \"skip_reason\": \"Conditional result was False\",\n            \"_ansible_no_log\": false\n        }\n    },\n    \"stats\": {\n        \"10.0.0.128\": {\n            \"ok\": 3,\n            \"failed\": 0,\n            \"unreachable\": 0,\n            \"skipped\": 0,\n            \"changed\": 2\n        },\n        \"10.0.0.131\": {\n            \"ok\": 2,\n            \"failed\": 0,\n            \"unreachable\": 0,\n            \"skipped\": 1,\n            \"changed\": 1\n        },\n        \"10.0.0.129\": {\n            \"ok\": 0,\n            \"failed\": 0,\n            \"unreachable\": 1,\n            \"skipped\": 0,\n            \"changed\": 0\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Ansible/ansible/","title":"Ansible\u57fa\u7840","text":"<p>Ansible\u662f\u4e3b\u6d41\u7684\u81ea\u52a8\u5316\u8fd0\u7ef4\u5de5\u5177\u4e4b\u4e00\uff0c\u7c7b\u4f3c\u4ea7\u54c1\u8fd8\u6709Chef\u3001Puppet\u3001SaltStack\u7b49\u3002\u7b2c\u4e00\u4e2a\u7248\u672c\u662f0.0.1,\u53d1\u5e03\u4e8e2012\u5e743\u67089\u65e5\u3002</p>"},{"location":"DevOps/Ansible/ansible/#ansible","title":"\u4e00\u3001Ansible\u7b80\u4ecb","text":""},{"location":"DevOps/Ansible/ansible/#1ansible","title":"1\u3001Ansible\u67b6\u6784","text":"<ol> <li>\u5f15\u64ce\uff1aAnsible</li> <li>\u6a21\u5757\uff1a</li> <li> <p>\u6838\u5fc3\u6a21\u5757\uff08core modules\uff09:\u81ea\u5e26\u6a21\u5757    \u81ea\u5b9a\u4e49\u6a21\u5757\uff08custom modules\uff09</p> </li> <li> <p>\u63d2\u4ef6\uff08plugins\uff09:\u6a21\u5757\u529f\u80fd\u7684\u8865\u5145\uff0c\u501f\u52a9\u63d2\u4ef6\u5b8c\u6210\u8bb0\u5f55\u65e5\u5fd7\u3001\u90ae\u4ef6\u529f\u80fd</p> </li> <li>\u5267\u672c\uff08playbooks\uff09:\u4efb\u52a1\u914d\u7f6e\u6587\u4ef6\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u4e2a\u4efb\u52a1\u3002</li> <li>\u8fde\u63a5\u63d2\u4ef6\uff08connectior plugins\uff09:\u901a\u8fc7\u8fde\u63a5\u63d2\u4ef6\u8fde\u63a5\u5230\u88ab\u7ba1\u7406\u4e3b\u673a\uff0c\u9ed8\u8ba4\u4f7f\u7528SSH\u3002\u8fd8\u652f\u6301Zeromq\u3001local\u8fde\u63a5\u65b9\u5f0f</li> <li>\u4e3b\u673a\u6e05\u5355\uff08host inventory\uff09:\u5b9a\u4e49\u88ab\u7ba1\u7406\u8282\u70b9</li> </ol>"},{"location":"DevOps/Ansible/ansible/#2ansible","title":"2\u3001Ansible\u5b9e\u73b0\u539f\u7406","text":"<p>Ansible\u6267\u884c\u547d\u4ee4\u65f6\uff0c\u901a\u8fc7\u5176\u5e95\u5c42\u4f20\u8f93\u6a21\u5757\uff0c\u5c06\u4e00\u4e2a\u6216\u591a\u4e2a\u6587\u4ef6\uff0c\u6216\u8005\u5b9a\u4e49\u4e00\u4e2aPlay\u6216Command\u547d\u4ee4\u4f20\u8f93\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u7684/tmp\u76ee\u5f55\u7684\u4e34\u65f6\u6587\u4ef6\uff0c\u5e76\u5728\u8fdc\u7a0b\u6267\u884c\u8fd9\u4e9bPlay/Command\uff0c\u7136\u540e\u5220\u9664\u4e34\u65f6\u6587\u4ef6\u5e76\u8fd4\u56de\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c</p> <p>Ansible\u7684\u901a\u4fe1\u53d1\u5c55\u53f2\uff1a</p> <ol> <li>\u4f7f\u7528Paramiko</li> <li>OpenSSH(1.3\u9ed8\u8ba4\u4f7f\u7528)</li> <li>accelerate\u52a0\u901f\u6a21\u5f0f</li> <li>Faster OpenSSH in Ansible 1.5+(pipelining\u52a0\u901f\u65b9\u5f0f)</li> </ol>"},{"location":"DevOps/Ansible/ansible/#3ansible","title":"3\u3001Ansible\u7279\u70b9","text":"<ol> <li>\u8bed\u6cd5\u7b80\u5355\uff1a\u57fa\u4e8eYAML</li> <li>\u65e0\u5ba2\u6237\u7aef\uff1a\u4e0d\u9700\u8981\u5b89\u88c5\u5ba2\u6237\u7aef\uff0c\u901a\u8fc7SSH\u8fde\u63a5\u88ab\u7ba1\u7406\u4e3b\u673a</li> <li>Push\u9000\u9001</li> <li>\u5927\u91cf\u5185\u7f6e\u6a21\u5757\uff1a\u201cansible-doc -l\u201d\u53ef\u4ee5\u67e5\u770b\u5df2\u6709\u7684\u6a21\u5757</li> <li>\u7b49\u5e42\u6027\uff08idempotent\uff09\uff1a\u5df2\u7ecf\u5728\u88ab\u7ba1\u7406\u7aef\u6267\u884c\u8fc7\u7684\u5267\u672c\u4e0d\u4f1a\u518d\u6267\u884c</li> </ol>"},{"location":"DevOps/Ansible/ansible/#4","title":"4\u3001\u4e3b\u8981\u7528\u9014","text":"<ol> <li>\u5e94\u7528\u90e8\u7f72</li> <li>\u914d\u7f6e\u7ba1\u7406</li> <li>\u4efb\u52a1\u6d41\u7f16\u6392</li> </ol>"},{"location":"DevOps/Ansible/ansible/#5","title":"5\u3001\u5b89\u88c5","text":"<p>\u5728Ubuntu\u4e0a\u5b89\u88c5</p> <pre><code>sudo apt update\nsudo apt-get install software-properties-common\nsudo apt-add-repository --yes  ppa:ansible/ansible:2.7.6\nsudo apt update\nsudo apt-get install ansible\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#6","title":"6\u3001\u76ee\u5f55\u7ed3\u6784","text":"<ol> <li>\u914d\u7f6e\u76ee\u5f55\uff1a/etc/ansible\uff0c\u529f\u80fd\uff1aInventory\u4e3b\u673a\u4fe1\u606f\u914d\u7f6e\uff0cAnsible\u5de5\u5177\u914d\u7f6e</li> <li>\u6267\u884c\u76ee\u5f55\uff1a/usr/bin/\uff0c\u529f\u80fd\uff1aansible\u9ed8\u8ba4\u547d\u4ee4\u5b58\u653e\u76ee\u5f55</li> <li>lib\u5e93\u4f9d\u8d56\u76ee\u5f55:/usr/lib/python2.7/dist-packages/ansible/*</li> <li>\u5e2e\u52a9\u6587\u6863\u76ee\u5f55\uff1a/usr/share/doc/ansible/*</li> <li>man\u6587\u6863\u76ee\u5f55\uff1a/usr/share/man/man1/</li> </ol>"},{"location":"DevOps/Ansible/ansible/#7","title":"7\u3001\u4e0e\u5176\u4ed6\u5de5\u5177\u7684\u5bf9\u6bd4","text":"\u5de5\u5177 Ansible Puppet Chef SaltStack \u8bed\u8a00 Python Ruby Ruby Python \u67b6\u6784 \u65e0Client C/S C/S C/S"},{"location":"DevOps/Ansible/ansible/#8ansible","title":"8\u3001Ansible\u7684\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6","text":"<ol> <li>\u73af\u5883\u53d8\u91cf\u4e2d\u7684ANSIBLE_CONFIG</li> <li>\u5f53\u524d\u76ee\u5f55\u4e0b\u7684ansible.cfg</li> <li>~/.ansible.cfg</li> <li>/etc/ansible/ansible.cfg</li> </ol>"},{"location":"DevOps/Ansible/ansible/#_1","title":"\u4e8c\u3001\u57fa\u672c\u7528\u6cd5","text":""},{"location":"DevOps/Ansible/ansible/#1ansible_1","title":"1\u3001Ansible\u547d\u4ee4\u6267\u884c\u65b9\u5f0f\uff1a","text":"<ol> <li>Ad-Doc   \u7528\u4e8e\u6267\u884c\u4e34\u65f6\u547d\u4ee4</li> <li>Ansible-playbooks</li> <li>Tower\uff08\u56fe\u5f62\u5316\uff0c\u5546\u4e1a\u7248\uff09</li> </ol> <p>\u4f7f\u7528\u524d\u5148\u8ba4\u8bc1\uff1a</p> <pre><code>ubuntu@server:~$ ssh-copy-id ubuntu@172.16.10.101\n/usr/bin/ssh-copy-id: ERROR: No identities found\nubuntu@server:~$ ssh-keygen \nGenerating public/private rsa key pair.\nEnter file in which to save the key (/home/ubuntu/.ssh/id_rsa): \nCreated directory '/home/ubuntu/.ssh'.\nEnter passphrase (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in /home/ubuntu/.ssh/id_rsa.\nYour public key has been saved in /home/ubuntu/.ssh/id_rsa.pub.\nThe key fingerprint is:\nc6:31:74:1b:03:56:63:00:24:1f:45:10:79:60:cf:e8 ubuntu@server\nThe key's randomart image is:\n+--[ RSA 2048]----+\n|    ..OOB+B      |\n|     +.B.o =     |\n|      o.= .      |\n|     . . o       |\n|      E S        |\n|       .         |\n|                 |\n|                 |\n|                 |\n+-----------------+\nubuntu@server:~$ ssh-copy-id ubuntu@172.16.10.101\nThe authenticity of host '172.16.10.101 (172.16.10.101)' can't be established.\nECDSA key fingerprint is cd:f2:2a:0b:33:25:ba:94:36:6b:43:f7:02:e4:1c:d2.\nAre you sure you want to continue connecting (yes/no)? yes\n/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed\n/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys\nubuntu@172.16.10.101's password: \n\nNumber of key(s) added: 1\n\nNow try logging into the machine, with:   \"ssh 'ubuntu@172.16.10.101'\"\nand check to make sure that only the key(s) you wanted were added.\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#2ansible_1","title":"2\u3001ansible\u7cfb\u5217\u547d\u4ee4","text":"<ol> <li>ansible</li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u4e34\u65f6\u4e00\u6b21\u6027\u64cd\u4f5c\u3001\u4e8c\u6b21\u5f00\u53d1\u63a5\u53e3\u8c03\u7528</p> <ol> <li>ansible-galaxy</li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u4ece https://galaxy.ansible.com \u4e0b\u8f7dRoles</p> <ol> <li>ansible-pull </li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u9700\u8981\u914d\u7f6e\u7684\u673a\u5668\u6570\u91cf\u5de8\u5927</p> <ol> <li>ansible-doc</li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u67e5\u770bansible\u6a21\u5757\u7684\u8bf4\u660e </p> <p>\u67e5\u770b\u652f\u6301\u7684\u6a21\u5757\uff1a</p> <pre><code>ubuntu@server:~$ ansible-doc -l | wc -l\n2080\n</code></pre> <ol> <li>ansible-playbook   </li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u8bfb\u53d6\u9884\u5148\u7f16\u5199\u7684playbook\u6587\u4ef6\u5b9e\u73b0\u6279\u91cf\u7ba1\u7406</p> <ol> <li>ansible-vault </li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u914d\u7f6e\u6587\u4ef6\u52a0\u5bc6</p> <pre><code>  # \u52a0\u5bc6yml\u6587\u4ef6\n  ansible-vault encrypt example.yml\n</code></pre> <ol> <li>ansible-console</li> </ol> <p>\u4f7f\u7528\u573a\u666f\uff1a\u4ea4\u4e92\u5f0f\u4f7f\u7528ansible\u547d\u4ee4</p>"},{"location":"DevOps/Ansible/ansible/#3-ansible-inventory","title":"3\u3001 Ansible Inventory\u914d\u7f6e","text":"<p>Inventory\u662fAnsible\u914d\u7f6e\u4e3b\u673a\u4fe1\u606f\u7684\u914d\u7f6e\u6587\u4ef6\u3002\u9ed8\u8ba4\u5b58\u653e\u5728/etc/ansible/hosts,\u4f7f\u7528\u65f6\u53ef\u4ee5\u4f7f\u7528-i\u6307\u5b9a\u6587\u4ef6</p> <pre><code># 1. \u76f4\u63a5\u4e3aIP\u5730\u5740\n192.168.1.100\n# 2. \u4e3b\u673a\u540d\u65b9\u5f0f\nmysql.company.com\n# 3. ssh\u7aef\u53e3\u4e0d\u662f22\u7684\u4e3b\u673a\u5b9a\u4e49\nmysql.company.com:2222\n# 4. \u6709\u89c4\u5f8b\u7684\u4e3b\u673a\n192.168.1.[101:103] # \u8868\u793a101 102 103\nmysql[abc].company.com  # mysqla mysqlb mysqlc\n# 5. \u5b9a\u4e49\u7ec4\n[web]\nweb1.company.com\nweb2.company.com\nweb3.company.com\n# 6. \u7ec4\u5d4c\u5957\n[nginx]\nnode1.company.com\nnode2.company.com\n[tomcat]\nnode4.company.com\nnode5.company.com\n[web:children]\nnginx\ntomcat\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#4_1","title":"4. \u53d8\u91cf","text":"<p>\u53d8\u91cf\u68c0\u7d22\u987a\u5e8f</p> <ol> <li>Inventory\u914d\u7f6e\u6587\u4ef6</li> <li>Playbook\u4e2dvar\u5b9a\u4e49\u7684\u533a\u57df</li> <li>Roles\u4e2dvars\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6</li> <li>Roles\u540c\u7ea7\u76ee\u5f55group_vars\u548chosts_vars\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6</li> </ol> <pre><code># 1. \u4e3b\u673a\u53d8\u91cf\n[web]\nhost1 http_port=80\n\n# 2. \u7ec4\u53d8\u91cf\n[web:vars]\nntp_server=ntp.atlanta.example.com\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#5-ad-hoc","title":"5. Ad-Hoc\u4f7f\u7528","text":"<p>\u57fa\u672c\u6a21\u5757\u4f7f\u7528\uff1a</p> <p>\u6267\u884csudo</p> <p>ansible sw3 -m command  -b  -K -a \"docker images\" ansible all -m command -i hosts -a \"free -h\"</p> <p>\u4f7f\u7528\u573a\u666f</p> <ol> <li>\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u5065\u5eb7\u68c0\u67e5</li> <li>\u5176\u4e2d\u4e00\u4e2a\u6216\u4e00\u7ec4\u4e3b\u673a\u8fdb\u884c\u66f4\u6539</li> </ol>"},{"location":"DevOps/Ansible/ansible/#playbook","title":"\u4e09\u3001Playbook","text":"<p>ansible\u7684\u4efb\u52a1\u914d\u7f6e\u6587\u4ef6\u79f0\u4e3aplaybook(\u5267\u672c)\uff0c\u6bcf\u4e00\u4e2a\u5267\u672c\u90fd\u5305\u542b\u4e00\u7cfb\u5217\u7684play\u3002</p>"},{"location":"DevOps/Ansible/ansible/#1","title":"1. \u683c\u5f0f","text":"<p>ansible\u91c7\u7528YAML\u8bed\u6cd5\u7f16\u5199\uff0c\u6709\u4e24\u79cd\u683c\u5f0f\uff1a</p> <ol> <li>\u591a\u884c\u7f29\u8fdb(\u5efa\u8bae\u4f7f\u7528)</li> </ol> <p>\u5b98\u65b9\u793a\u4f8b\uff1a</p> <pre><code>---                     # \u9700\u8981\u4ee5---\u5f00\u59cb\uff0c\u4e14\u8981\u9876\u884c\u9996\u5199\n# \u53ef\u4ee5\u5728\u8fd9\u91cc\u7b80\u8981\u8bf4\u660eplaybook\u7684\u529f\u80fd(\u53ef\u9009)\n- hosts: webservers     # \u9009\u62e9\u5728\u54ea\u4e9b\u4e3b\u673a\u6267\u884c\u4e0b\u9762\u7684play\n  vars:                 # \u5b9a\u4e49\u7684\u53d8\u91cf\n    http_port: 80\n    max_clients: 200\n  remote_user: root\n  tasks:                # \u6307\u5b9a\u4e00\u7cfb\u5217\u5c06\u8981\u8fd0\u884c\u7684\u4efb\u52a1\n  - name: ensure apache is at the latest version\n    yum:\n      name: httpd\n      state: latest\n  - name: write the apache config file\n    template:\n      src: /srv/httpd.j2\n      dest: /etc/httpd.conf\n    notify:\n    - restart apache\n  - name: ensure apache is running\n    service:\n      name: httpd\n      state: started\n  handlers:\n    - name: restart apache\n      service:\n        name: httpd\n        state: restarted\n</code></pre> <ol> <li>\u5355\u884c\u7f29\u5199</li> </ol>"},{"location":"DevOps/Ansible/ansible/#2-handler","title":"2. Handler\uff1a","text":""},{"location":"DevOps/Ansible/ansible/#1notify-handler","title":"1.notify \u89e6\u53d1handler","text":"<pre><code>  tasks:\n    - name: \u5f00\u542fapache rewrite\n      apache2_module:\n        name: rewrite\n        state: present\n  handlers:\n    - name: restart apache\n      service:\n        name: httpd\n        state: restarted\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#2handler-handler","title":"2.handler \u8c03\u7528 handler","text":"<pre><code>  handlers:\n    - name: restart apache\n      service:\n        name: httpd\n        state: restarted\n      notify: restart memcached\n\n    - name: restart memcached\n      service:\n        name: memcached\n        state: restarted\n</code></pre> <p>\u6ce8\u610f\uff1a </p> <ol> <li>handler\u53ea\u6709\u5728\u5176\u6240\u5728\u7684\u4efb\u52a1\u88ab\u6267\u884c\u65f6\uff0c\u624d\u4f1a\u88ab\u8fd0\u884c</li> <li>handler\u53ea\u4f1a\u5728play\u7684\u672b\u5c3e\u8fd0\u884c\u4e00\u6b21</li> </ol>"},{"location":"DevOps/Ansible/ansible/#3","title":"3. \u53d8\u91cf","text":""},{"location":"DevOps/Ansible/ansible/#1_1","title":"1.\u547d\u540d\u89c4\u5219","text":"<ol> <li>\u4ee5\u82f1\u6587\u5927\u5c0f\u5199\u5b57\u6bcd\u5f00\u5934</li> <li>\u4e2d\u95f4\u53ef\u4ee5\u5305\u542b\u4e0b\u5212\u7ebf(_)\u548c\u6570\u5b57</li> </ol>"},{"location":"DevOps/Ansible/ansible/#2","title":"2.\u53d8\u91cf\u7684\u5b9a\u4e49","text":""},{"location":"DevOps/Ansible/ansible/#1vars","title":"1.\u5728vars\u4ee3\u7801\u5757\u5b9a\u4e49\u53d8\u91cf","text":"<pre><code>---\n- hosts: test\n  vars:\n    foo: bar\n  tasks:\n    - debug: msg=\"var foo is set to {{ foo }}\"\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#2_1","title":"2. \u628a\u53d8\u91cf\u5b9a\u4e49\u5230\u5355\u72ec\u7684\u6587\u4ef6\u4e2d","text":"<pre><code>$ cat vars.yml\n---\nfoo: bar\n</code></pre> <pre><code>---\n- hosts: test\n  vars_files:\n    - vars.yml\n  tasks:\n    - debug: msg=\"var foo is set to {{ foo }}\"\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#3-inventory","title":"3. \u5728Inventory\u6587\u4ef6\u4e2d\u5b9a\u4e49\u53d8\u91cf\uff08\u4e0d\u5efa\u8bae\uff09","text":"<ol> <li>\u4e3a\u67d0\u53f0\u4e3b\u673a\u6307\u5b9a\u53d8\u91cf</li> </ol> <pre><code>app1.example.com proxy_state=present\n</code></pre> <ol> <li>\u4e3a\u4e3b\u673a\u7ec4\u5b9a\u4e49\u53d8\u91cf</li> </ol> <pre><code>[web]\nnode1\nnode2\n[web:vars]\nhttp_port: 80\n</code></pre> <p>\u5728\u6267\u884cansible\u547d\u4ee4\u65f6\uff0cansible\u9ed8\u8ba4\u4f1a\u4ece/etc/ansible/host_vars\u548c/etc/ansible/group_vars\u4e24\u4e2a\u76ee\u5f55\u4e0b\u8bfb\u53d6\u53d8\u91cf\u5b9a\u4e49\uff0c\u53ef\u4ee5\u5728 \u8fd9\u4e24\u4e2a\u76ee\u5f55\u4e2d\u521b\u5efa\u4e0ehosts\u6587\u4ef6\u4e2d\u4e3b\u673a\u540d\u6216\u7ec4\u540d\u540c\u540d\u7684\u6587\u4ef6\u6765\u5b9a\u4e49\u53d8\u91cf\uff0c\u4f8b\u5982\uff1a</p> <pre><code>$ cat /etc/ansible/group_vars/web\n---\nhttp_port: 80\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#4_2","title":"4. \u6ce8\u518c\u53d8\u91cf","text":"<p>\u5c06\u64cd\u4f5c\u7684\u7ed3\u679c\uff0c\u5305\u62ec\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u4fdd\u5b58\u5230\u53d8\u91cf\u4e2d\uff0c\u8fd9\u4e2a\u8fc7\u7a0b\u4e2d\u7528\u6765\u4fdd\u5b58\u64cd\u4f5c\u7ed3\u679c\u7684\u53d8\u91cf\u5c31\u53eb\u6ce8\u518c\u53d8\u91cf\u3002 \u5728playbook\u4e2d\u4f7f\u7528register\u6765\u58f0\u660e\u4e00\u4e2a\u53d8\u91cf\u4e3a\u6ce8\u518c\u53d8\u91cf\u3002</p> <pre><code>- shell: my_command_here\n  register: my_command_result\n</code></pre> <p>\u4f7f\u7528stdout\u65b9\u6cd5\u6765\u8bfb\u53d6\u6807\u51c6\u8f93\u51fa\u5185\u5bb9\uff1amy_command_result.stdout \u4f7f\u7528stderr\u65b9\u6cd5\u6765\u8bfb\u53d6\u9519\u8bef\u8f93\u51fa\u5185\u5bb9\uff1amy_command_result.stderr</p>"},{"location":"DevOps/Ansible/ansible/#5-facts","title":"5. facts\u4fe1\u606f","text":"<p>\u5728\u8fd0\u884c\u4efb\u4f55\u4e00\u4e2aplaybook\u4e4b\u524d\uff0cansible\u9ed8\u8ba4\u4f1a\u5148\u6293\u53d6playbook\u4e2d\u6240\u6307\u5b9a\u7684\u6240\u6709\u4e3b\u673a\u7684\u7cfb\u7edf\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u79f0\u4e3afacts\u3002</p> <pre><code>ubuntu@server:~/test$ ansible-playbook test.yml\n\nPLAY [web] *************************************************************************************************************************************************************************************************************************\n\nTASK [Gathering Facts] *************************************************************************************************************************************************************************************************************\nok: [172.16.10.100]\n\nTASK [debug] ***********************************************************************************************************************************************************************************************************************\nok: [172.16.10.100] =&gt; {\n    \"msg\": \"var http_port is set to 80\"\n}\n\nPLAY RECAP *************************************************************************************************************************************************************************************************************************\n172.16.10.100              : ok=2    changed=0    unreachable=0    failed=0\n</code></pre> <p>facts\u4fe1\u606f\u7684\u83b7\u53d6</p> <pre><code>$ ansible web -m setup\n172.16.10.100 | SUCCESS =&gt; {\n    \"ansible_facts\": {\n        \"ansible_all_ipv4_addresses\": [\n            \"172.16.10.100\",\n            \"10.0.3.15\"\n        ],\n        \"ansible_all_ipv6_addresses\": [\n            \"fe80::a00:27ff:fe15:7966\",\n            \"fe80::a00:27ff:fef4:8f74\"\n        ],\n</code></pre> <p>\u5e38\u7528\u7684facts\u53d8\u91cf\uff1aansible_os_family,ansible_hostname,ansible_memtotal_mb\u3002</p> <p>\u5982\u679c\u9700\u8981\u5728\u6267\u884cplaybook\u4e4b\u524d\u8df3\u8fc7\u6536\u96c6facts\u4fe1\u606f\u8fd9\u4e00\u4e0d\u53ef\u4ee5\u5728playbook\u4e2d\u8bbe\u7f6egather_facts\uff1a</p> <pre><code>---\n- hosts: web\n  gather_facts: no\n</code></pre> <p>\u672c\u5730facts\u53d8\u91cf</p> <p>\u5728\u8fdc\u7a0b\u4e3b\u673a\u672c\u5730\u5b9a\u4e49facts\u53d8\u91cf</p> <p>\u9700\u8981\u628a\u5b9a\u4e49\u7684\u53d8\u91cf\u5199\u8fdb\u4e00\u4e2a\u4ee5.fact\u7ed3\u5c3e\u7684\u6587\u4ef6\u4e2d\uff08\u653e\u5728/etc/ansible/facts.d/\uff09\uff0c\u8fd9\u4e2a\u6587\u4ef6\u53ef\u4ee5\u662fjson\u6216ini\u6587\u4ef6\uff0c\u6216\u8005\u662f\u53ef\u4ee5\u8fd4\u56dejson\u4ee3\u7801\u7684\u53ef\u6267\u884c\u6587\u4ef6</p>"},{"location":"DevOps/Ansible/ansible/#6_1","title":"6. \u53d8\u91cf\u7684\u4f18\u5148\u7ea7","text":"<p>\u7531\u9ad8\u5230\u4f4e\u6392\u5e8f</p> <ol> <li>\u5728\u547d\u4ee4\u884c\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf(\u5373\u7528-e\u5b9a\u4e49\u7684\u53d8\u91cf)</li> <li>\u5728Inventory\u4e2d\u5b9a\u4e49\u7684\u8fde\u63a5\u53d8\u91cf\uff0c\u5982ansible_ssh_user</li> <li>\u5927\u591a\u6570\u5176\u4ed6\u53d8\u91cf(play\u4e2d\u7684\u53d8\u91cf\uff0cincluded\u4e2d\u7684\u53d8\u91cf\uff0crole\u4e2d\u7684\u53d8\u91cf)</li> <li>\u5728Inventory\u4e2d\u5b9a\u4e49\u7684\u53d8\u91cf</li> <li>\u7531\u7cfb\u7edf\u901agather_facts\u65b9\u6cd5\u53d1\u73b0\u7684\u53d8\u91cf</li> <li>role\u9ed8\u8ba4\u53d8\u91cf</li> </ol>"},{"location":"DevOps/Ansible/ansible/#4-ifthenwhen","title":"4. \u6d41\u7a0b\u63a7\u5236 if/then/when","text":""},{"location":"DevOps/Ansible/ansible/#when","title":"when","text":"<p>\u5728\u7279\u5b9a\u7684\u6761\u4ef6\u4e0b\u6267\u884c\u4efb\u52a1</p> <pre><code>---\n- hosts: web\n  tasks:\n    - name: \u6d4b\u8bd5php\u662f\u5426\u5b89\u88c5\n      shell: php --version\n      register: php_version\n    - name: \u5982\u679c\u5b89\u88c5\u5c31\u6267\u884c\u4e0b\u9762\u7684\u64cd\u4f5c\n      debug:\n        msg: \"php \u5b89\u88c5\u4e86\"\n      when: \"'7.0' in php_version.stdout\"\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#changed_whenfailed_when","title":"changed_when\u3001failed_when","text":"<p>\u6839\u636e\u4efb\u52a1\u8fd0\u884c\u8fd4\u56de\u7ed3\u679c\u5224\u65ad\u4efb\u52a1\u7684\u8fd0\u884c\u7ed3\u679c\u662f\u5426\u771f\u7684\u7b26\u5408\u6211\u4eec\u7684\u9884\u671f</p>"},{"location":"DevOps/Ansible/ansible/#5_1","title":"5. \u4efb\u52a1\u95f4\u6d41\u7a0b\u63a7\u5236","text":""},{"location":"DevOps/Ansible/ansible/#1_2","title":"1.\u4efb\u52a1\u6682\u505c","text":"<p>\u4e00\u4e9b\u670d\u52a1\u7684\u8fd0\u884c\u9700\u8981\u7b49\u5f85\u4e00\u4e9b\u72b6\u6001\u7684\u6062\u590d\uff0c\u6bd4\u5982\u4e00\u53f0\u4e3b\u673a\u6216\u5e94\u7528\u521a\u91cd\u542f\uff0c\u9700\u8981\u7b49\u5f85\u5b83\u4e0a\u9762\u7684\u7aef\u53e3\u5f00\u542f\uff0c\u6b64\u65f6 \u5c31\u4e0d\u5f97\u4e0d\u5c06\u6b63\u5728\u8fd0\u884c\u7684\u4efb\u52a1\u6682\u505c\uff0c\u76f4\u5230\u72b6\u6001\u6ee1\u8db3\u6211\u4eec\u7684\u9700\u6c42</p> <pre><code>---\n- hosts: web\n  tasks:\n    - name: \u7b49\u5f85web\u91cd\u542f\n      local_action:\n        module: wait_for\n        host: nginx\n        port: 80\n        delay: 10\n        timeout: 300\n        state: started\n    - name: \u91cd\u542f\u540e\u7ee7\u7eed\n      debug:\n         msg:  \"\u91cd\u542f\u540e\u6267\u884c\u540e\u7eed\u64cd\u4f5c\"\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#6_2","title":"6. \u4ea4\u4e92\u5f0f\u63d0\u793a","text":"<p>vars_prompt\u6a21\u5757\u4f1a\u5728\u6240\u6709play\u6267\u884c\u524d\u5148\u6267\u884c\uff0c\u5176\u4f18\u5148\u7ea7\u9ad8\u4e8eGathering Facts\u3002</p> <pre><code>---\n- hosts: web\n  vars_prompt:\n    - name: username\n      prompt: \"username\"\n      default: \"root\"   # \u8bbe\u7f6e\u9ed8\u8ba4\u503c\n    - name: password\n      prompt: \"password\"\n      private: yes     # \u8f93\u5165\u5bc6\u7801\u4e0d\u53ef\u89c1\n      confirm: yes     # \u8981\u6c42\u8f93\u5165\u4e24\u6b21\n  tasks:\n    - name: \u8f93\u51fa\u5bc6\u7801\n      debug:\n        msg: \"{{ username }} {{ password }}\"\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#7_1","title":"7. \u6807\u7b7e","text":"<p>\u6807\u7b7e\u529f\u80fd\u53ef\u4ee5\u7ed9\u89d2\u8272\u3001\u6587\u4ef6\u3001\u5355\u72ec\u7684\u4efb\u52a1\u6253\u4e0a\u6807\u7b7e\uff0c\u7136\u540e\u5229\u7528\u6807\u7b7e\u6765\u6307\u5b9a\u8981\u8fd0\u884cplaybook\u4e2d\u7684\u4e2a\u522b\u4efb\u52a1\u6216\u4e0d\u6267\u884c\u6307\u5b9a\u7684\u4efb\u52a1\u3002</p> <pre><code>- hosts: rabbitmq\n  tags: rabbitmq\n  roles:\n    - rabbitmq\n</code></pre> <p>\u6267\u884c\u5e26\u6307\u5b9a\u6807\u7b7e\u7684\u4efb\u52a1</p> <pre><code>ansible-playbook --tags \"rabbitmq\" test.yml\n</code></pre> <p>\u8df3\u8fc7\u5e26\u6307\u5b9a\u6807\u7b7e\u7684\u4efb\u52a1</p> <pre><code>ansible-playbook --skip-tags \"rabbitmq\" test.yml\n</code></pre> <p>\u53ef\u4ee5\u52a0\u591a\u4e2a\u6807\u7b7e</p> <pre><code>tags:\n  - one\n  - two\n\n# or\n\ntags: ['one', 'two']\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#8-block","title":"8. block\u5757","text":"<p>2.0\u4ee5\u540e\u7684\u7248\u672c\u5f15\u5165\uff0c\u5757\u529f\u80fd\u53ef\u4ee5\u5c06\u4efb\u52a1\u8fdb\u884c\u5206\u7ec4\uff0c\u5e76\u4e14\u53ef\u4ee5\u5728\u5757\u7ea7\u522b\u4e0a\u5e94\u7528\u4efb\u52a1\u53d8\u91cf\u3002\u5757\u8fd8\u53ef\u4ee5\u5757\u5185\u90e8\u7684\u4efb\u52a1\u5f02\u5e38</p>"},{"location":"DevOps/Ansible/ansible/#1_3","title":"1.\u793a\u4f8b","text":"<pre><code> tasks:\n   - name: Install Apache\n     block:\n       - yum:\n           name: \"{{ item }}\"\n           state: installed\n         with_items:\n           - httpd\n           - memcached\n       - template:\n           src: templates/src.j2\n           dest: /etc/foo.conf\n       - service:\n           name: bar\n           state: started\n           enabled: True\n     when: ansible_facts['distribution'] == 'CentOS'\n     become: true\n     become_user: root\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#2_2","title":"2.\u9519\u8bef\u5904\u7406","text":"<pre><code>- name: Attempt and graceful roll back demo\n  block:\n    - debug:\n        msg: 'I execute normally'\n    - name: i force a failure\n      command: /bin/false\n    - debug:\n        msg: 'I never execute, due to the above task failing, :-('\n  rescue:  # \u51fa\u9519\u65f6\u6267\u884c\n    - debug:\n        msg: 'I caught an error'\n    - name: i force a failure in middle of recovery! &gt;:-)\n      command: /bin/false\n    - debug:\n        msg: 'I also never execute :-('\n  always: # \u65e0\u8bba\u7ed3\u679c\u5982\u4f55\u90fd\u6267\u884c\n    - debug:\n        msg: \"This always executes\"\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#9-include","title":"9. Include","text":""},{"location":"DevOps/Ansible/ansible/#1_4","title":"1. \u57fa\u672c\u7528\u6cd5","text":"<pre><code>tasks:\n- include: other.yml\n</code></pre>"},{"location":"DevOps/Ansible/ansible/#2_3","title":"2. \u52a8\u6001\u52a0\u8f7d","text":"<p>\u5728\u6ee1\u8db3\u4e00\u5b9a\u6761\u4ef6\u65f6\u52a0\u8f7dInclude </p> <pre><code>- include: test.yml\n  when: \n</code></pre>"},{"location":"DevOps/Docker/Architecture/","title":"\u67b6\u6784","text":""},{"location":"DevOps/Docker/Architecture/#docker","title":"docker\u67b6\u6784","text":""},{"location":"DevOps/Docker/Architecture/#1-docker-client","title":"1. Docker Client","text":"<p>Docker\u5ba2\u6237\u7aef\uff0cDocker\u5f15\u64ce\u63d0\u4f9b\u7684CLI\u5de5\u5177\uff0c\u7528\u4e8e\u7528\u6237\u5411Docker\u63d0\u4ea4\u547d\u4ee4\u8bf7\u6c42</p>"},{"location":"DevOps/Docker/Architecture/#2-dockerd","title":"2. Dockerd","text":"<p>Dockerd\u5373Docker Daemon\uff0c\u4e3b\u8981\u7528\u6765\u7ba1\u7406docker\u955c\u50cf\uff0c\u5bb9\u5668\uff0c\u7f51\u7edc\uff0c\u5377\u3002\u901a\u8fc7gRPC\u4e0eContainerd\u8fdb\u884c\u901a\u4fe1</p>"},{"location":"DevOps/Docker/Architecture/#3-containerd","title":"3. Containerd","text":"<p>Containerd\u5373Containerd Daemon\uff0c\u4e3b\u8981\u529f\u80fd\u662f\u7ba1\u7406\u5bb9\u5668\u7684\u58f0\u660e\u5468\u671f\uff0c\u4e0d\u8fc7\u5176\u672c\u8eab\u4e0d\u4f1a\u521b\u5efa\u5bb9\u5668\uff0c\u800c\u662f\u8c03\u7528Runc\u6765\u5b8c\u6210\u5bb9\u5668\u7684\u521b\u5efa\u3002</p>"},{"location":"DevOps/Docker/Architecture/#4-runc","title":"4. Runc","text":"<p>Runc\u5373Run Container\uff0c\u662fOCI\u5bb9\u5668\u8fd0\u884c\u65f6\u89c4\u8303\u7684\u5b9e\u73b0\uff0cRunc\u9879\u76ee\u7684\u76ee\u6807\u4e4b\u4e00\u5c31\u662f\u4e0eOCI\u89c4\u8303\u4fdd\u6301\u4e00\u81f4\uff0c\u6240\u4ee5Runc\u6240\u5728\u5c42\u4e5f\u79f0\u4e3aOCI\u5c42\uff0c\u8fd9\u4f7f\u5f97Docker Daemon\u4e2d\u4e0d\u518d\u5305\u542b\u4efb\u4f55\u5bb9\u5668\u8fd0\u884c\u65f6\u7684\u4ee3\u7801\uff0c\u7b80\u5316\u4e86Docker Daemon\u3002</p> <p>Runc\u53ea\u6709\u4e00\u4e2a\u4f5c\u7528\u5c31\u662f\u521b\u5efa\u5bb9\u5668\uff0c\u5176\u672c\u8d28\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u8fd0\u884c\u65f6CLI\u5de5\u5177\uff0c\u5176\u5728fork\u5904\u4e00\u4e2a\u5bb9\u5668\u5b50\u8fdb\u7a0b\u540e\u4f1a\u542f\u52a8\u8be5\u5bb9\u5668\u8fdb\u7a0b\uff0c\u5728\u5bb9\u5668\u8fdb\u7a0b\u542f\u52a8\u5b8c\u6bd5\u540e\uff0cRunc\u4f1a\u81ea\u52a8\u9000\u51fa\u3002</p>"},{"location":"DevOps/Docker/Architecture/#5-shim","title":"5. Shim","text":"<p>Shim\u662f\u5b9e\u73b0Daemonless Container\u4e0d\u53ef\u6216\u7f3a\u7684\u5de5\u5177\uff0c\u4f7fRunc\u4e0eDaemon\u89e3\u8026\uff0c\u4f7f\u5f97Docker Daemon\u7684\u7ef4\u62a4\u4e0e\u5347\u7ea7\u4e0d\u4f1a\u5f71\u54cd\u5230\u8fd0\u884c\u4e2d\u7684\u5bb9\u5668\u3002</p> <p>\u6bcf\u6b21\u521b\u5efa\u5bb9\u5668\u65f6\uff0cContainerd\u540c\u65f6\u4f1afork\u51faRunc\u8fdb\u7a0b\u4e0eShim\u8fdb\u7a0b\uff0c\u5f53Runc\u81ea\u52a8\u9000\u51fa\u4e4b\u524d\uff0c\u4f1a\u5148\u5c06\u65b0\u5bb9\u5668\u7684\u7236\u8fdb\u7a0b\u6307\u5b9a\u4e3a\u76f8\u5e94\u7684Shim\u8fdb\u7a0b\u3002</p> <p>\u9664\u4e86\u4f5c\u4e3a\u5bb9\u5668\u7684\u7236\u8fdb\u7a0b\u5916\uff0cShim\u8fd8\u6709\u4e24\u4e2a\u91cd\u8981\u529f\u80fd\uff1a</p> <ol> <li>\u4fdd\u6301\u6240\u6709STDIN\u4e0eSTOUT\u6d41\u7684\u5f00\u542f\u72b6\u6001\uff0c\u4ece\u800c\u4f7f\u5f97\u5f53Docker Daemon\u91cd\u542f\u65f6\uff0c\u5bb9\u5668\u4e0d\u4f1a\u56e0\u4e3aPipe\u7684\u5173\u95ed\u800c\u7ec8\u6b62</li> <li>\u5c06\u5bb9\u5668\u7684\u72b6\u6001\u53cd\u9988\u7ed9Docker Daemon</li> </ol> <p>https://docs.docker.com/get-started/overview/#docker-architecture</p> <p></p>"},{"location":"DevOps/Docker/Container/","title":"\u5bb9\u5668","text":""},{"location":"DevOps/Docker/Container/#_1","title":"\u5e38\u7528\u547d\u4ee4","text":""},{"location":"DevOps/Docker/Container/#1","title":"1. \u5bb9\u5668\u8fd0\u884c","text":""},{"location":"DevOps/Docker/Container/#11","title":"1.1 \u4ea4\u6362\u65b9\u5f0f\u8fd0\u884c","text":"<pre><code>$ docker run -it ubuntu /bin/bash\nroot@a55772d7ac7f:/#\n# -t \u7ec8\u7aef\n# -i \u4ea4\u4e92\u65b9\u5f0f\n</code></pre>"},{"location":"DevOps/Docker/Container/#12","title":"1.2 \u4ea4\u6362\u65b9\u5f0f\u8fd0\u884c\u5e76\u6307\u5b9a\u66b4\u9732\u7aef\u53e3","text":"<pre><code>$ docker run -it -p 8080:8080 tomcat:8.5.49\n$ docker ps\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS                    NAMES\n6b6fba4ce3d7        tomcat:8.5.49       \"catalina.sh run\"   3 minutes ago       Up 3 minutes        0.0.0.0:8080-&gt;8080/tcp   flamboyant_greider\n</code></pre>"},{"location":"DevOps/Docker/Container/#13","title":"1.3 \u540e\u53f0\u8fd0\u884c","text":"<pre><code>$ docker run -d -p 8080:8080 tomcat:8.5.49\n3844bd1a8e04f4a528317f45090c4105d3636112f0b9860b3bb4bdd7229da814\n$ docker run -itd ubuntu\n41614d76e2d0fbb86af50b52c7e7c0ea5b62929154e88f954c5e42b13e41b9b7\n</code></pre>"},{"location":"DevOps/Docker/Container/#2","title":"2. \u5bb9\u5668\u9000\u51fa","text":"<ol> <li><code>exit</code></li> <li><code>CTRL</code>+<code>p</code>+<code>q</code></li> </ol>"},{"location":"DevOps/Docker/Container/#3","title":"3. \u8fdb\u5165\u5bb9\u5668","text":""},{"location":"DevOps/Docker/Container/#31-exec","title":"3.1 exec\u65b9\u5f0f","text":"<p>\u8fdb\u5165\u65f6\u521b\u5efa\u4e00\u4e2a\u65b0\u7ec8\u7aef\uff0c<code>exit</code>\u9000\u51fa\u540e\u5bb9\u5668\u4e0d\u9000\u51fa</p> <pre><code>$ docker exec -it 3846540d5ac1 /bin/bash\nroot@3846540d5ac1:/# \n</code></pre> <p>\u6267\u884c\u5bb9\u5668\u4e2d\u7684\u547d\u4ee4</p> <pre><code>$ docker exec -it 3846540d5ac1 hostname\n3846540d5ac1\n</code></pre> <p>\u6ce8\u610f\uff1a\u540c\u65f6\u4f7f\u7528docker attach\u547d\u4ee4\u540c\u65f6\u5728\u591a\u4e2a\u7ec8\u7aef\u8fd0\u884c\u65f6\uff0c\u6240\u6709\u7684\u7ec8\u7aef\u7a97\u53e3\u5c06\u540c\u6b65\u663e\u793a\u76f8\u540c\u5185\u5bb9\uff0c\u5f53\u67d0\u4e2a\u547d\u4ee4\u884c\u7a97\u53e3\u7684\u547d\u4ee4\u963b\u585e\u65f6\uff0c\u5176\u5b83\u547d\u4ee4\u884c\u7a97\u53e3\u540c\u6837\u4e5f\u65e0\u6cd5\u64cd\u4f5c</p>"},{"location":"DevOps/Docker/Container/#32-attach","title":"3.2 attach\u65b9\u5f0f","text":"<p>\u8fdb\u5165\u5bb9\u5668\u6b63\u5728\u6267\u884c\u7684\u7ec8\u7aef\uff0c<code>exit</code>\u540e\u5bb9\u5668\u4e5f\u9000\u51fa\u3002\u9000\u51fa\u65f6\u4f7f\u7528<code>CTRL</code>+<code>p</code>+<code>q</code>\u53ef\u4ee5\u4f7f\u5bb9\u5668\u4e0d\u9000\u51fa\u3002</p> <pre><code>docker attach 3846540d5ac1\n</code></pre>"},{"location":"DevOps/Docker/Container/#4","title":"4. \u5bb9\u5668\u7684\u542f\u505c","text":""},{"location":"DevOps/Docker/Container/#41","title":"4.1 \u542f\u52a8","text":"<pre><code>$ docker start [\u5bb9\u5668]\n$ docker restart [\u5bb9\u5668]\n</code></pre>"},{"location":"DevOps/Docker/Container/#42","title":"4.2 \u505c\u6b62","text":"<pre><code>$ docker stop [\u5bb9\u5668]\n$ docker kill [\u5bb9\u5668]\n</code></pre>"},{"location":"DevOps/Docker/Container/#5-docker-top","title":"5. docker top","text":"<pre><code>$ docker top 3196d88f30fa\n# \u53ef\u4ee5\u914d\u7f6eps\u547d\u4ee4\u7684\u53c2\u6570\u4f7f\u7528\n$ docker top 3196d88f30fa -o pid,comm\nPID                 COMMAND\n17179               java\n</code></pre>"},{"location":"DevOps/Docker/Container/#6-docker-logs","title":"6. docker logs","text":"<pre><code># \u548ctail -f\u76f8\u540c\n$ docker logs -f 3196d88f30fa\n# \u8f93\u51fa\u540e10\u884c\u65e5\u5fd7\n$ docker logs --tail 10 3196d88f30fa\n# \u6309\u65f6\u95f4\u7b5b\u9009\ndocker logs --since=\"2023-10-16T20:50:39Z\"  --until=\"2023-10-16T20:50:40Z\" 3196d88f30fa\n</code></pre>"},{"location":"DevOps/Docker/Container/#7-docker-cp","title":"7. docker cp","text":"<pre><code>$ docker cp hello.txt myubuntu:/root/\n</code></pre>"},{"location":"DevOps/Docker/Container/#8-docker-rm","title":"8. docker rm","text":"<p>\u5220\u9664\u5bb9\u5668</p> <pre><code>docker rm [\u5bb9\u5668]\ndocker rm -f [\u5bb9\u5668]\n</code></pre>"},{"location":"DevOps/Docker/Container/#9-docker-commit","title":"9. docker commit","text":"<p>\u5c06\u5bb9\u5668\u751f\u6210\u4e3a\u4e00\u4e2a\u955c\u50cf</p> <pre><code>docker commit c3f279d17e0a  svendowideit/testimage:version3\n</code></pre>"},{"location":"DevOps/Docker/Container/#10","title":"10. \u5bb9\u5668\u7684\u5bfc\u5165\u5bfc\u51fa","text":""},{"location":"DevOps/Docker/Container/#101","title":"10.1 \u5bfc\u51fa","text":"<pre><code>docker export -o myubuntu.tar myubunt\n</code></pre>"},{"location":"DevOps/Docker/Container/#102","title":"10.2 \u5bfc\u5165","text":"<p>\u5c06\u5bfc\u51fa\u7684\u5bb9\u5668\u5bfc\u5165\u4e3a\u955c\u50cf</p> <pre><code>docker import myubuntu.tar myubuntu:v1\n</code></pre>"},{"location":"DevOps/Docker/Container/#11_1","title":"11. \u5bb9\u5668\u6682\u505c\u4e0e\u6062\u590d","text":"<p>pause\u6682\u505c\u5bb9\u5668\u5bf9\u5916\u63d0\u4f9b\u670d\u52a1</p> <pre><code>$ docker pause tomcat\n</code></pre> <p>\u6062\u590d</p> <pre><code>$ docker unpause tomcat\n</code></pre>"},{"location":"DevOps/Docker/Container/#12_1","title":"12 \u521b\u5efa\u5bb9\u5668","text":"<p>\u53ea\u521b\u5efa\uff0c\u4e0d\u8fd0\u884c</p> <pre><code>$ docker create  -p 8080:8080 --name tomcat tomcat:8.5.49\n$ docker ps -a\nCONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES\nf974989ed804        tomcat:8.5.49       \"catalina.sh run\"   5 seconds ago       Created                                 tomcat\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/","title":"Dockerfile","text":"<p>Dockerfile\u662f\u7528\u6765\u6784\u5efaDocker\u955c\u50cf\u7684\u6587\u4ef6\uff0c\u6709\u4e00\u7cfb\u5217\u6267\u884c\u6784\u6210\uff0c\u901a\u8fc7docker build\u547d\u4ee4\u6784\u5efa\u955c\u50cf\u65f6\uff0cDockerfile\u4e2d\u7684\u6307\u4ee4\u4f1a\u7531\u4e0a\u5230\u4e0b\u4e00\u6b21\u6267\u884c\uff0c\u6bcf\u6761\u6307\u4ee4\u90fd\u4f1a\u521b\u5efa\u51fa\u4e00\u4e2a\u955c\u50cf\u3002\u8fd9\u5c31\u662f\u955c\u50cf\u5206\u5c42\u3002\u6307\u4ee4\u8d8a\u591a\uff0c\u5c42\u5c31\u8d8a\u591a\uff0c\u6548\u7387\u5c31\u8d8a\u4f4e\u3002</p> <ol> <li>\u6307\u4ee4\u5927\u5c0f\u5199\u4e0d\u654f\u611f\uff0c\u6309\u60ef\u4f8b\u5168\u90e8\u5927\u5c0f</li> <li>\u6307\u4ee4\u540e\u81f3\u5c11\u643a\u5e26\u4e00\u4e2a\u53c2\u6570</li> <li><code>#</code>\u5f00\u5934\u4e3a\u884c\u6ce8\u91ca</li> </ol>"},{"location":"DevOps/Docker/Dockerfile/#hello-world","title":"\u4e00\u3001\u521b\u5efa\u81ea\u5df1\u7684hello world\u955c\u50cf","text":""},{"location":"DevOps/Docker/Dockerfile/#1","title":"1. \u7f16\u5199\u81ea\u5df1\u7684\u7a0b\u5e8f","text":"<pre><code># yum install -y gcc glibc-static\n$ cat hello.c \n#include&lt;stdio.h&gt;\nint main()\n{\n    printf(\"hello docker!\\n\");\n    return 0;\n}\n$ gcc --static -o hello hello.c\n$ ./hello \nhello docker!\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#2-dockfile","title":"2. \u7f16\u5199Dockfile","text":"<pre><code>FROM scratch\nADD hello /\nCMD [\"/hello\"]\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#3","title":"3. \u6784\u5efa\u955c\u50cf","text":"<pre><code>$ docker build -t hello-docker .\nSending build context to Docker daemon  865.3kB\nStep 1/3 : FROM scratch\n ---&gt; \nStep 2/3 : ADD hello /\n ---&gt; aa3daa94007d\nStep 3/3 : CMD [\"/hello\"]\n ---&gt; Running in 53429e43da09\nRemoving intermediate container 53429e43da09\n ---&gt; d9ea27607729\nSuccessfully built d9ea27607729\nSuccessfully tagged hello-docker:latest\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#4-docker","title":"4. \u8fd0\u884cdocker","text":"<pre><code>$ docker run hello-docker\nhello docker!\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#_1","title":"\u4e8c\u3001\u955c\u50cf\u7684\u6784\u5efa\u8fc7\u7a0b","text":"<pre><code>FROM centos:7\nLABEL auth=Tom\nCOPY hello.log /var/log/\nRUN yum -y install vim\nCMD /bin/bash\n</code></pre> <p>FROM\u6307\u4ee4\u662fDockerfile\u4e2d\u552f\u4e00\u4e0d\u53ef\u7f3a\u5c11\u7684\u547d\u4ee4\uff0c\u5b83\u4e3a\u6700\u7ec8\u6784\u5efa\u51fa\u7684\u955c\u50cf\u8bbe\u5b9a\u4e86\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\uff08Baselmage\uff09\u3002\u8be5\u8bed\u53e5\u5e76\u4e0d\u4f1a\u4ea7\u751f\u65b0\u7684\u50cf\u5c42\uff0c\u5b83\u662f\u4f7f\u7528\u6307\u5b9a\u7684\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\u5c42\u7684\u3002<code>docker build</code>\u547d\u4ee4\u89e3\u6790Dockerfile\u7684FROM\u6307\u4ee4\u65f6\uff0c\u53ef\u4ee5\u7acb\u5373\u83b7\u6089\u5728\u54ea\u4e00\u4e2a\u955c\u50cf\u57fa\u7840\u4e0a\u5b8c\u6210\u4e0b\u4e00\u6761\u6307\u4ee4\u955c\u50cf\u5c42\u6784\u5efa\u3002Docker Daemon\u9996\u5148\u4ece\u57fa\u7840\u955c\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\u83b7\u53d6\u5230\u955c\u50cf\u7684ID\uff0c\u7136\u540e\u518d\u6839\u636e\u50cfID\u63d0\u53d6\u51fa\u955c\u50cf\u7684json\u6587\u4ef6\u5185\u5bb9\uff0c\u4ee5\u5907\u4e0b\u4e00\u6761\u6307\u4ee4\u50cf\u5c42\u6784\u5efa\u65f6\u4f7f\u7528\u3002</p> <p>LABEL\u6307\u4ee4\u4ec5\u4fee\u6539\u4e0a\u4e00\u6b65\u4e2d\u63d0\u53d6\u51fa\u7684\u955c\u50cfjson\u6587\u4ef6\u5185\u5bb9\uff0c\u5728json\u4e2d\u6dfb\u52a0LABEL\u4fe1\u606f\u540e\uff0c\u65e0\u9700\u65b0\u955c\u50cf\u6587\u4ef6\u7cfb\u7edf\u3002\u4f46\u4e5f\u4f1a\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\u5c42\uff0c\u53ea\u4e0d\u8fc7\u8be5\u955c\u50cf\u5c42\u4e2d\u53ea\u8bb0\u5f55\u4e86json\u6587\u4ef6\u5185\u5bb9\u7684\u4fee\u6539\u53d8\u5316\uff0c\u6ca1\u6709\u6587\u4ef6\u7cfb\u7edf\u7684\u53d8\u5316\u3002\u5982\u679c\u8be5\u6307\u4ee4\u5c31\u662f\u6700\u540e\u4e00\u6761\u6307\u4ee4\uff0c\u90a3\u4e48\u6b64\u65f6\u5f62\u6210\u7684\u955c\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\u5176\u5b9e\u5c31\u662f\u539f\u6765FROM\u540e\u6307\u5b9a\u955c\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u53ea\u662fjson\u6587\u4ef6\u53d1\u751f\u4e86\u53d8\u5316\u3002\u4f46\u7531\u4e8ejson\u6587\u4ef6\u5185\u5bb9\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u6240\u4ee5\u4ea7\u751f\u4e86\u65b0\u7684\u955c\u50cf\u5c42\u3002</p> <p>COPY\u6307\u4ee4\u4f1a\u5c06\u5bbf\u4e3b\u673a\u4e2d\u7684\u6307\u5b9a\u6587\u4ef6\u590d\u5236\u5230\u5bb9\u5668\u4e2d\u7684\u6307\u5b9a\u76ee\u5f55\uff0c\u6240\u4ee5\u4f1a\u6539\u53d8\u8be5\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5927\u5c0f\uff0c\u5e76\u751f\u6210\u65b0\u7684\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5185\u5bb9\u3002\u6240\u4ee5json\u6587\u4ef6\u4e2d\u7684\u955c\u50cfID\u4e5f\u5c31\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4ea7\u751f\u4e86\u65b0\u7684\u955c\u50cf\u5c42\u3002</p> <p>RUN\u6307\u4ee4\u672c\u8eab\u5e76\u4e0d\u4f1a\u6539\u53d8\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5927\u5c0f\uff0c\u4f46\u5982\u679cRUN\u7684\u547d\u4ee4\u662f\u5b89\u88c5\u6216\u8005\u5176\u4ed6\u589e\u52a0\u6587\u4ef6\u5185\u5bb9\u7684\u547d\u4ee4\uff0c\u6240\u4ee5\u5bfc\u81f4RUN\u547d\u4ee4\u6700\u7ec8\u6539\u53d8\u4e86\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5927\u5c0f\uff0c\u5c31\u751f\u6210\u4e86\u65b0\u7684\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5185\u5bb9\u3002\u6240\u4ee5json\u6587\u4ef6\u4e2d\u7684\u955c\u50cfID\u4e5f\u5c31\u53d1\u751f\u53d8\u5316\uff0c\u4ea7\u751f\u4e86\u65b0\u7684\u955c\u50cf\u5c42\u3002</p> <p>\u5bf9\u4e8eCMD\u6216ENTRYPOINT\u6307\u4ee4\uff0c\u5176\u662f\u4e0d\u4f1a\u6539\u53d8\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5927\u5c0f\u7684\uff0c\u56e0\u4e3a\u5176\u4e0d\u4f1a\u5728<code>docker build</code>\u8fc7\u7a0b\u4e2d\u6267\u884c\u3002\u6240\u4ee5\u8be5\u6761\u6307\u4ee4\u6ca1\u6709\u6539\u53d8\u955c\u50cf\u5c42\u6587\u4ef6\u7cfb\u7edf\u5927\u5c0f\u3002\u4f46\u5bf9\u4e8eCMD\u6216ENTRYPOINT\u6307\u4ee4\uff0c\u7531\u4e8e\u5176\u5c06\u6765\u5bb9\u5668\u542f\u52a8\u540e\u8981\u6267\u884c\u7684\u547d\u4ee4\uff0c\u6240\u4ee5\u4f1a\u5c06\u8be5\u6761\u6307\u4ee4\u5199\u5165\u5230json\u6587\u4ef6\u4e2d\uff0c\u4f1a\u5f15\u53d1json\u6587\u4ef6\u7684\u53d8\u5316\u3002\u6240\u4ee5json\u6587\u4ef6\u4e2d\u7684\u955c\u50cfID\u4e5f\u5c31\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4ea7\u751f\u4e86\u65b0\u7684\u50cf\u5c42\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#dockerfile","title":"\u4e09\u3001Dockerfile","text":""},{"location":"DevOps/Docker/Dockerfile/#1-scratch","title":"1. scratch\u955c\u50cf","text":"<p>scratch\u955c\u50cf\u662f\u4e00\u4e2a\u7a7a\u955c\u50cf\uff0c\u662f\u6240\u6709\u955c\u50cf\u7684Baselmage\uff08\u76f8\u5f53\u4e8e\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u4e2d\u7684Object\u7c7b\uff09\u3002scratch\u955c\u50cf\u53ea\u80fd\u5728Dockerfile\u4e2d\u88ab\u7ee7\u627f\u4e0d\u80fd\u901a\u8fc7pull\u547d\u4ee4\u62c9\u53d6\uff0c\u4e0d\u80fdrun\uff0c\u4e5f\u6ca1\u6709tag\uff0c\u5e76\u4e14\u5b83\u4e5f\u4e0d\u4f1a\u751f\u6210\u955c\u50cf\u4e2d\u7684\u6587\u4ef6\u7cfb\u7edf\u5c42\u3002\u5728Docker\u4e2d\uff0cscratch\u662f\u4e00\u4e2a\u4fdd\u7559\u5b57\uff0c\u7528\u6237\u4e0d\u80fd\u4f5c\u4e3a\u81ea\u5df1\u7684\u955c\u50cf\u540d\u79f0\u4f7f\u7528\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#2-add","title":"2. ADD","text":"<pre><code># \u8bed\u6cd5\u4e00\nADD &lt;src&gt; &lt;dest&gt;\n# \u8bed\u6cd5\u4e8c\nADD [\"&lt;src&gt;\", \"&lt;dest&gt;\"]\n</code></pre> <p>\u8be5\u6307\u4ee4\u5c06\u590d\u5236\u5f53\u524d\u5bbf\u4e3b\u673a\u4e2d\u6307\u5b9a\u6587\u4ef6src\u5230\u5bb9\u5668\u4e2d\u7684\u6307\u5b9a\u76ee\u5f55dest\u4e2d\u3002src\u53ef\u4ee5\u662f\u5bbf\u4e3b\u673a\u4e2d\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u4e5f\u53ef\u4ee5\u65f6\u76f8\u5bf9\u8def\u5f84\u3002\u4f46\u76f8\u5bf9\u8def\u5f84\u662f\u76f8\u5bf9\u4e8e<code>docker build</code>\u547d\u4ee4\u6240\u6307\u5b9a\u7684\u8def\u5f84\u7684\u3002src\u6307\u5b9a\u7684\u6587\u4ef6\u53ef\u4ee5\u662f\u4e00\u4e2a\u538b\u7f29\u6587\u4ef6\uff0c\u538b\u7f29\u6587\u4ef6\u590d\u5236\u5230\u5bb9\u5668\u540e\u4f1a\u81ea\u52a8\u89e3\u538b\u4e3a\u76ee\u5f55\uff1bsrc\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2aURL\uff0c\u6b64\u65f6\u7684ADD\u6307\u4ee4\u76f8\u5f53\u4e8ewget\u547d\u4ee4\uff1bsrc\u6700\u597d\u4e0d\u8981\u662f\u76ee\u5f55\uff0c\u5176\u4f1a\u5c06\u8be5\u76ee\u5f55\u4e2d\u6240\u6709\u5185\u5bb9\u590d\u5236\u5230\u5bb9\u5668\u7684\u6307\u5b9a\u76ee\u5f55\u4e2d\u3002dest\u662f\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\uff0c\u5176\u6700\u540e\u9762\u7684\u8def\u5f84\u5fc5\u987b\u8981\u52a0\u4e0a\u659c\u6760\uff0c\u5426\u5219\u7cfb\u7edf\u4f1a\u5c06\u6700\u540e\u7684\u76ee\u5f55\u540d\u79f0\u5f53\u505a\u662f\u6587\u4ef6\u540d\u3002</p> <p>ADD\u548cCOPY\u8fd8\u53ef\u652f\u6301\u6b63\u5219\u548c\u4fee\u6539\u6587\u4ef6\u6743\u9650\u548c\u5c5e\u4e3b</p> <pre><code>ADD --chown=myuser:mygroup --chmod=655 files* /somedir/\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#3-copy","title":"3. COPY","text":"<p>\u529f\u80fd\u4e0eADD\u6307\u4ee4\u76f8\u540c\uff0c\u53ea\u4e0d\u8fc7src\u4e0d\u80fd\u662fURL\u3002\u82e5src\u4e3a\u538b\u7f29\u6587\u4ef6\uff0c\u590d\u5236\u5230\u5bb9\u5668\u540e\u4e0d\u4f1a\u81ea\u52a8\u89e3\u538b\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#4-maintainer","title":"4. MAINTAINER","text":"<pre><code>MAINTAINER &lt;name&gt;\n</code></pre> <p>\u53c2\u6570\u586b\u5199\u7684\u4e00\u822c\u662f\u7ef4\u62a4\u8005\u59d3\u540d\u548c\u4fe1\u7bb1\u3002\u4e0d\u8fc7\uff0c\u8be5\u6307\u4ee4\u5b98\u65b9\u5df2\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u800c\u662f\u4f7f\u7528LABEL\u6307\u4ee4\u4ee3\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#5-label","title":"5. LABEL","text":"<pre><code>LABEL &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...\n</code></pre> <p>LABEL\u6307\u4ee4\u4e2d\u53ef\u4ee5\u4ee5\u952e\u503c\u5bf9\u7684\u65b9\u5f0f\u5305\u542b\u4efb\u610f\u955c\u50cf\u7684\u5143\u6570\u636e\u4fe1\u606f\uff0c\u7528\u4e8e\u66ff\u4ee3MAINTAINER\u6307\u4ee4\uff0c\u901a\u8fc7<code>docker inspect</code>\u53ef\u67e5\u5230LABEL\u4e0eMAINTAINER\u7684\u5185\u5bb9\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#6-env","title":"6. ENV","text":"<pre><code># \u8bed\u6cd5\u4e00\nENV &lt;key&gt; &lt;value&gt;\n# \u8bed\u6cd5\u4e8c\nENV &lt;key&gt;=&lt;value&gt; &lt;key&gt;=&lt;value&gt; ...\n</code></pre> <p>\u7528\u4e8e\u6307\u5b9a\u73af\u5883\u53d8\u91cf\uff0c\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\uff0c\u540e\u7eed\u53ef\u4ee5\u88abRUN\u6307\u4ee4\u4f7f\u7528\uff0c\u5bb9\u5668\u8fd0\u884c\u8fd0\u884c\u4e4b\u540e\uff0c\u4e5f\u53ef\u4ee5\u5728\u5bb9\u5668\u4e2d\u83b7\u53d6\u8fd9\u4e9b\u73af\u5883\u53d8\u91cf\u3002 </p>"},{"location":"DevOps/Docker/Dockerfile/#7-workdir","title":"7. WORKDIR","text":"<pre><code>WORKDIR /path/to/workdir\n</code></pre> <p>\u5bb9\u5668\u6253\u5f00\u540e\u9ed8\u8ba4\u8fdb\u5165\u7684\u76ee\u5f55\uff0c\u4e00\u822c\u5728\u7eed\u7684RUN\u3001CMD\u3001ENTRYPOINT\u3001ADD\u7b49\u6307\u4ee4\u4e2d\u4f1a\u5f15\u7528\u8be5\u76ee\u5f55\u3002\u53ef\u4ee5\u8bbe\u7f6e\u591a\u4e2aWORKDIR\u6307\u4ee4\u3002\u540e\u7eedWORKDIR\u6307\u4ee4\u82e5\u7528\u7684\u662f\u76f8\u5bf9\u8def\u5f84\uff0c\u5219\u4f1a\u57fa\u4e8e\u4e4b\u524dWORKDIR\u6307\u4ee4\u6307\u5b9a\u7684\u8def\u5f84\u3002\u5728\u4f7f\u7528<code>docker run</code>\u8fd0\u884c\u5bb9\u5668\u65f6\uff0c\u53ef\u4ee5\u901a\u8fc7-w\u53c2\u6570\u76d6\u6784\u5efa\u65f6\u6240\u8bbe\u7f6e\u7684\u5de5\u4f5c\u76ee\u5f55\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#8-run","title":"8. RUN","text":"<pre><code># \u8bed\u6cd5\u4e00\nRUN &lt;command&gt;\n# \u8bed\u6cd5\u4e8c\nRUN [\"executable\", \"param1\", \"param2\"]\n</code></pre> <p>\u8bed\u6cd5\u4e00\u7684<code>&lt;command&gt;</code>\u5c31\u662fshell\u547d\u4ee4\u3002<code>docker build</code>\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u4f7f\u7528shell\u8fd0\u884c\u6307\u5b9a\u7684command\u3002</p> <p>\u8bed\u6cd5\u4e8c\u5728<code>docker build</code>\u8fd0\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u8c03\u7528\u7b2c\u4e00\u4e2a\u53c2\u6570\"executable\"\u6307\u5b9a\u7684\u5e94\u7528\u7a0b\u5e8f\u8fd0\u884c\u5e76\u4f7f\u7528\u540e\u9762\u7b2c\u4e8c\u3001\u4e09\u7b49\u53c2\u6570\u4f5c\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u53c2\u6570\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#9-cmd","title":"9. CMD","text":"<pre><code># \u8bed\u6cd5\u4e00\nCMD command param1 param2 (shell form)\n# \u8bed\u6cd5\u4e8c\nCMD [\"executable\",\"param1\",\"param2\"]\n# \u8bed\u6cd5\u4e09\nCMD [\"param1\",\"param2\"]\n</code></pre> <p>\u8bed\u6cd5\u4e00\u4e2d\u7684command\u5c31\u662fshell\u547d\u4ee4\u3002\u5728\u5bb9\u5668\u542f\u52a8\u540e\u4f1a\u7acb\u5373\u8fd0\u884c\u6307\u5b9a\u7684shell\u547d\u4ee4\u3002</p> <p>\u8bed\u6cd5\u4e8c\u5728\u5bb9\u5668\u542f\u52a8\u540e\uff0c\u5373\u5728\u6267\u884c\u5b8c<code>docker run</code>\u540e\u4f1a\u7acb\u5373\u8c03\u7528\u6267\u884c\"executable\"\u6307\u5b9a\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528\u540e\u9762\u7b2c\u4e8c\u3001\u4e09\u7b49\u53c2\u6570\u4f5c\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u53c2\u6570\u3002</p> <p>\u8bed\u6cd5\u4e09\u662f\u63d0\u4f9b\u7ed9ENTRYPOINT\u7684\u9ed8\u8ba4\u53c2\u6570\u3002</p> <p>Dockerfile\u4e2d\u5b9a\u4e49\u7684CMD\u53ef\u4ee5\u88ab\u6267\u884c<code>docker run</code>\u65f6\u6307\u5b9a\u7684[COMMAND]\u66ff\u6362\u3002\u6267\u884c\u65f6\u4e0d\u80fd\u6dfb\u52a0<code>[ARG]</code></p>"},{"location":"DevOps/Docker/Dockerfile/#10-entrypoint","title":"10. ENTRYPOINT","text":"<pre><code># \u8bed\u6cd5\u4e00\nENTRYPOINT command param1 param2\n# \u8bed\u6cd5\u4e8c\nENTRYPOINT [\"executable\", \"param1\", \"param2\"]\n</code></pre> <p>\u8bed\u6cd5\u4e00\u4e2d\u7684command\u5c31\u662fshell\u547d\u4ee4\u3002\u5728\u5bb9\u5668\u542f\u52a8\u540e\u4f1a\u7acb\u5373\u8fd0\u884c\u6307\u5b9a\u7684shell\u547d\u4ee4\u3002</p> <p>\u8bed\u6cd5\u4e8c\u5728\u5bb9\u5668\u542f\u52a8\u540e\uff0c\u5373\u5728\u6267\u884c\u5b8c<code>docker run</code>\u540e\u4f1a\u7acb\u5373\u8c03\u7528\u6267\u884c\"executable\"\u6307\u5b9a\u7684\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u5e76\u4f7f\u7528\u540e\u9762\u7b2c\u4e8c\u3001\u4e09\u7b49\u53c2\u6570\u4f5c\u4e3a\u5e94\u7528\u7a0b\u5e8f\u7684\u8fd0\u884c\u53c2\u6570\u3002</p> <p>Dockerfile\u4e2d\u5b9a\u4e49\u7684ENTRYPOINT\u4e0d\u80fd\u88ab\u6267\u884c<code>docker run</code>\u65f6\u6307\u5b9a\u7684COMMAND\u66ff\u6362\u3002</p> <p>ENTRYPOINT\u548cCMD\u4f7f\u7528</p> <pre><code>FROM busybox:latest\nCMD [\"-c\", \"1\", \"www.baidu.com\"]\nENTRYPOINT [\"ping\"]\n</code></pre> <pre><code>$ docker build  -t mybox:v1  .\nSending build context to Docker daemon  2.048kB\nStep 1/3 : FROM busybox:latest\n ---&gt; a416a98b71e2\nStep 2/3 : CMD [\"-c\", \"1\", \"www.baidu.com\"]\n ---&gt; Running in a31cb0ed0cb3\nRemoving intermediate container a31cb0ed0cb3\n ---&gt; 9f87d23edad7\nStep 3/3 : ENTRYPOINT [\"ping\"]\n ---&gt; Running in 423c246fdd0b\nRemoving intermediate container 423c246fdd0b\n ---&gt; 87fef6276cb3\nSuccessfully built 87fef6276cb3\nSuccessfully tagged mybox:v1\n</code></pre> <p>\u4f7f\u7528CMD\u5b9a\u4e49\u7684\u53c2\u6570</p> <pre><code>$ docker run mybox:v1 \nPING www.baidu.com (36.155.132.31): 56 data bytes\n64 bytes from 36.155.132.31: seq=0 ttl=127 time=27.617 ms\n\n--- www.baidu.com ping statistics ---\n1 packets transmitted, 1 packets received, 0% packet loss\nround-trip min/avg/max = 27.617/27.617/27.617 ms\n</code></pre> <p>\u6267\u884cdocker run\u65f6\u6307\u5b9a\u53c2\u6570</p> <pre><code># www.taobao.com -c 2 \u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9ENTRYPOINT\n$ docker run mybox:v1  www.taobao.com -c 2\nPING www.taobao.com (117.176.244.213): 56 data bytes\n64 bytes from 117.176.244.213: seq=0 ttl=127 time=20.445 ms\n64 bytes from 117.176.244.213: seq=1 ttl=127 time=20.115 ms\n\n--- www.taobao.com ping statistics ---\n2 packets transmitted, 2 packets received, 0% packet loss\nround-trip min/avg/max = 20.115/20.280/20.445 ms\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#11-arg","title":"11. ARG","text":"<pre><code>ARG &lt;name&gt;[=&lt;default value&gt;]\n</code></pre> <p>\u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\uff0c\u8be5\u53d8\u91cf\u5c06\u4f1a\u4f7f\u7528\u4e8e\u955c\u50cf\u6784\u5efa\u8fd0\u884c\u65f6\u3002\u82e5\u8981\u5b9a\u4e49\u591a\u4e2a\u53d8\u91cf\uff0c\u5219\u9700\u8981\u5b9a\u4e49\u591a\u4e2aARG\u6307\u4ee4\u3002</p> <pre><code>FROM ubuntu\nARG CONT_IMG_VER\nENV CONT_IMG_VER=${CONT_IMG_VER:-v1.0.0}\nRUN echo $CONT_IMG_VER\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#12-onbuild","title":"12. ONBUILD","text":"<pre><code>ONBUILD INSTRUCTION\n</code></pre> <p>\u8be5\u6307\u4ee4\u7528\u4e8e\u6307\u5b9a\u5f53\u524d\u955c\u50cf\u7684\u5b50\u955c\u50cf\u8fdb\u884c\u6784\u5efa\u65f6\u8981\u6267\u884c\u7684\u6307\u4ee4\u3002</p> <pre><code># \u7236\u955c\u50cfDockerfile\u4e2d\u5b9a\u4e49\uff0c\u5b50\u955c\u50cfDockerfile\u4e2d\u6267\u884c\nONBUILD RUN yum install -y wget\n</code></pre>"},{"location":"DevOps/Docker/Dockerfile/#13-volume","title":"13. VOLUME","text":"<pre><code>VOLUME [\"/data\"]\n</code></pre> <p>\u8be5\u6307\u4ee4\u53ef\u4ee5\u5728\u5bb9\u5668\u4e2d\u521b\u5efa\u53ef\u4ee5\u6302\u8f7d\u6570\u636e\u5377\u7684\u6302\u8f7d\u70b9\u3002\u5176\u53c2\u6570\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u6570\u7ec4\u4e5f\u53ef\u4ee5\u662f\u4f7f\u7528\u7a7a\u683c\u9694\u5f00\u7684\u591a\u4e2a\u7eaf\u5b57\u7b26\u4e32\u3002\u4f8b\u5982\uff1a<code>VOLUME [\"/var/www\u201c\uff0c\"/etc/apache\u201d]</code>\u6216<code>VOLUME /var/www /etc/apache</code></p>"},{"location":"DevOps/Docker/Dockerfile/#14-expose","title":"14. EXPOSE","text":"<pre><code>EXPOSE &lt;port&gt; [&lt;port&gt;/&lt;protocol&gt;...]\n</code></pre> <p>\u6307\u5b9a\u5bb9\u5668\u51c6\u5404\u5bf9\u5916\u66b4\u9732\u7684\u7aef\u53e3\u53f7\uff0c\u4f46\u8be5\u7aef\u53e3\u53f7\u5e76\u4e0d\u4f1a\u771f\u6b63\u7684\u5bf9\u5916\u66b4\u9732\u3002\u82e5\u8981\u771f\u6b63\u66b4\u9732\uff0c\u5219\u9700\u8981\u5728\u6267\u884cdocker run\u547d\u4ee4\u65f6\u4f7f\u7528-p\u6765\u6307\u5b9a\u8981\u771f\u6b63\u66b4\u9732\u51fa\u7684\u7aef\u53e3\u53f7\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#_2","title":"\u56db\u3001\u6784\u5efa\u7f13\u5b58","text":""},{"location":"DevOps/Docker/Dockerfile/#1-build-cache","title":"1. build cache\u673a\u5236","text":"<p>Docker Daemnon\u901a\u8fc7Dockerfile\u6784\u5efa\u955c\u50cf\u65f6\uff0c\u5f53\u53d1\u73b0\u5373\u5c06\u65b0\u6784\u5efa\u51fa\u7684\u955c\u50cf\uff08\u5c42\uff09\u4e0e\u672c\u5730\u5df2\u5b58\u5728\u7684\u67d0\u955c\u50cf\uff08\u5c42\uff09\u91cd\u590d\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u590d\u7528\u5df2\u5b58\u5728\u955c\u50cf\uff08\u5c42\uff09\u800c\u4e0d\u662f\u91cd\u65b0\u6784\u5efa\u65b0\u7684\u50cf\uff08\u5c42\uff09\uff0c\u8fd9\u79cd\u673a\u5236\u79f0\u4e3adocker build cache\u673a\u5236\u3002\u8be5\u673a\u5236\u4e0d\u4ec5\u52a0\u5feb\u4e86\u955c\u50cf\u7684\u6784\u5efa\u8fc7\u7a0b\uff0c\u540c\u65f6\u4e5f\u5927\u91cf\u8282\u7701\u4e86Docker\u5bbf\u4e3b\u673a\u7684\u7a7a\u95f4\u3002      docker build cache\u5e76\u4e0d\u662f\u5360\u7528\u5185\u5b58\u7684cache\uff0c\u800c\u662f\u4e00\u79cd\u5bf9\u78c1\u76d8\u4e2d\u76f8\u5e94\u955c\u50cf\u5c42\u7684\u68c0\u7d22\u3001\u590d\u7528\u673a\u5236\u3002\u6240\u4ee5\u65e0\u8bba\u662f\u5173\u95edDocker\u5f15\u64ce\uff0c\u8fd8\u662f\u91cd\u542fDocker\u5bbf\u4e3b\u673a\uff0c\u53ea\u8981\u8be5\u955c\u50cf\uff08\u5c42\uff09\u5b58\u5728\u4e8e\u672c\u5730\uff0c\u90a3\u4e48\u5c31\u4f1a\u590d\u7528\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#2-build-cache","title":"2. build cache\u5931\u6548","text":"<p>\u200b      docker build cache\u5728\u4ee5\u4e0b\u51e0\u79cd\u60c5\u51b5\u4e0b\u4f1a\u5931\u6548\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#21-dockerfile","title":"2.1 Dockerfile\u6587\u4ef6\u53d1\u751f\u53d8\u5316","text":"<p>\u5f53Dockerfile\u6587\u4ef6\u4e2d\u67d0\u4e2a\u6307\u4ee4\u5185\u5bb9\u53d1\u751f\u53d8\u5316\uff0c\u90a3\u4e48\u4ece\u53d1\u751f\u53d8\u5316\u7684\u8fd9\u4e2a\u6307\u4ee4\u5c42\u5f00\u59cb\u7684\u6240\u6709\u955c\u50cf\u5c42cache\u5168\u90e8\u5931\u6548\u3002\u5373\u4ece\u8be5\u6307\u4ee4\u884c\u5f00\u59cb\u7684\u955c\u50cf\u5c42\u5c06\u6784\u5efa\u51fa\u65b0\u7684\u955c\u50cf\u5c42\uff0c\u800c\u4e0d\u518d\u4f7f\u7528build cache\uff0c\u5373\u4f7f\u540e\u9762\u7684\u6307\u4ee4\u5e76\u672a\u53d1\u751f\u53d8\u5316\u3002\u56e0\u4e3a\u955c\u50cf\u5173\u7cfb\u672c\u8d28\u4e0a\u662f\u4e00\u79cd\u6811\u72b6\u5173\u7cfb\uff0c\u53ea\u8981\u5176\u4e0a\u5c42\u8282\u70b9\u53d8\u4e86\uff0c\u90a3\u4e48\u8be5\u53d1\u751f\u53d8\u5316\u8282\u70b9\u7684\u6240\u6709\u4e0b\u5c42\u8282\u70b9\u4e5f\u5c31\u5168\u90e8\u53d8\u5316\u4e86\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#22-addcopy","title":"2.2 ADD\u6216COPY\u6307\u4ee4\u5185\u5bb9\u53d8\u5316","text":"<p>Dockerfile\u6587\u4ef6\u5185\u5bb9\u6ca1\u6709\u53d8\u5316\uff0c\u4f46ADD\u6216COPY\u6307\u4ee4\u6240\u590d\u5236\u7684\u6587\u4ef6\u5185\u5bb9\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u540c\u6837\u4f1a\u4f7f\u4ece\u8be5\u6307\u4ee4\u955c\u50cf\u5c42\u5f00\u59cb\u7684\u540e\u9762\u6240\u6709\u955c\u50cf\u5c42\u7684build cache\u5931\u6548\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#23-run","title":"2.3 RUN\u6307\u4ee4\u5916\u90e8\u4f9d\u8d56\u53d8\u5316","text":"<p>\u4e0eADD/COPY\u6307\u4ee4\u76f8\u4f3c\u3002Dockerfile\u6587\u4ef6\u5185\u5bb9\u6ca1\u6709\u53d8\u5316\uff0c\u4f46RUN\u547d\u4ee4\u7684\u5916\u90e8\u4f9d\u8d56\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u4f8b\u5982\u5b89\u88c5\u7684\u8f6f\u4ef6\u6e90\u53d1\u751f\u4e86\u53d8\u66f4\uff08\u7248\u672c\u53d8\u5316\u3001\u4e0b\u8f7d\u5730\u5740\u53d8\u5316\u7b49\uff09\uff0c\u90a3\u4e48\u4ece\u53d1\u751f\u53d8\u5316\u7684\u8fd9\u4e2a\u6307\u4ee4\u5c42\u5f00\u59cb\u7684\u6240\u6709\u955c\u50cf\u5c42cache\u5168\u90e8\u5931\u6548\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#24-buildcache","title":"2.4 \u6307\u5b9a\u4e0d\u4f7f\u7528buildcache","text":"<p>\u6709\u4e9b\u65f6\u5019\u4e3a\u4e86\u786e\u4fdd\u5728\u955c\u50cf\u6784\u5efa\u8fc7\u7a0b\u4e2d\u4f7f\u7528\u5230\u65b0\u7684\u6570\u636e\uff0c\u5728\u955c\u50cf\u6784\u5efadocker build\u65f6\uff0c\u901a\u8fc7<code>--no-cache</code>\u9009\u9879\u6307\u5b9a\u4e0d\u4f7f\u7528build cache\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#25-dangling-build-cache","title":"2.5 \u6e05\u7406dangling build cache","text":"<p>\u200b     dangling build cache\uff0c\u5373\u60ac\u865abuildcache\uff0c\u6307\u7684\u662f\u65e0\u6cd5\u4f7f\u7528\u7684build cache\u3002\u4e00\u822c\u4e3a\u60ac\u865a\u955c\u50cfdangling image\u6240\u4ea7\u751f\u7684build cache\u901a\u8fc7docker system prune\u547d\u4ee4\u53ef\u4ee5\u6e05\u9664\u3002</p>"},{"location":"DevOps/Docker/Dockerfile/#dockerfile_1","title":"\u4e94\u3001\u7f16\u8bd1Dockerfile\u7684\u5efa\u8bae","text":"<ol> <li>\u5355\u4e00\u804c\u8d23\uff1a \u4e0d\u540c\u529f\u80fd\u7684\u5e94\u7528\u5e94\u8be5\u5c3d\u91cf\u62c6\u5206\u4e3a\u4e0d\u540c\u7684\u5bb9\u5668\uff0c\u6bcf\u4e2a\u5bb9\u5668\u53ea\u8d1f\u8d23\u5355\u4e00\u4e1a\u52a1\u8fdb\u7a0b</li> <li>\u63d0\u4f9b\u6ce8\u91ca\u4fe1\u606f\uff1a\u6da9\u96be\u61c2\u7684\u4ee3\u7801\u5c3d\u91cf\u6dfb\u52a0\u6ce8\u91ca </li> <li>\u4fdd\u6301\u5bb9\u5668\u6700\u5c0f\u5316\uff1a\u5e94\u8be5\u907f\u514d\u5b89\u88c5\u65e0\u7528\u7684\u8f6f\u4ef6\u5305</li> <li>\u5408\u7406\u9009\u62e9\u57fa\u7840\u955c\u50cf\uff1a\u5bb9\u5668\u7684\u6838\u5fc3\u662f\u5e94\u7528\uff0c\u53ea\u8981\u57fa\u7840\u955c\u50cf\u80fd\u591f\u6ee1\u8db3\u5e94\u7528\u7684\u8fd0\u884c\u73af\u5883\u5373\u53ef</li> <li>\u5c3d\u91cf\u4f7f\u7528\u6784\u5efa\u7f13\u5b58\uff1a\u4ece\u5f53\u524d\u6784\u5efa\u5c42\u5f00\u59cb\uff0c\u6bd4\u8f83\u6240\u6709\u7684\u5b50\u955c\u50cf\uff0c\u68c0\u67e5\u6240\u6709\u7684\u6784\u6307\u4ee4\u662f\u5426\u4e0e\u5f53\u524d\u5b8c\u5168\u4e00\u81f4\u5982\u679c\u4e0d\u4e00\u81f4\uff0c\u5219\u4e0d\u4f7f\u7528\u7f13\u5b58\uff1b \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u53ea\u9700\u8981\u6bd4\u8f83\u6784\u5efa\u6307\u4ee4\u5373\u53ef\u5224\u65ad\u662f\u5426\u9700\u8981\u4f7f        \u7528\u7f13\u5b58\uff0c\u4f46\u662f\u6709\u4e9b\u6307\u4ee4\u9664\u5916\uff08\u4f8b\u5982ADD\u548cCOPY\uff09\uff1b\u5bf9\u4e8eADD\u548cCOPY\u6307\u4ee4\u8981\u6821\u9a8c\u547d\u4ee4\u662f\u5426\u4e00\u81f4\uff0c\u8fd8\u8981\u4e3a\u5373\u5c06\u8d1d\u5230\u5bb9\u5668\u7684\u6587\u4ef6\u8ba1\u7b97\u6821\u9a8c\u548c\uff0c\u547d\u4ee4\u548c\u6821\u9a8c\u548c\u5b8c\u5168\u4e00\u81f4\uff0c\u624d\u8ba4\u4e3a\u547d\u4e2d\u7f13\u5b58</li> <li>\u6b63\u786e\u8bbe\u7f6e\u65f6\u533a</li> <li>\u4f7f\u7528\u56fd\u5185\u8f6f\u4ef6\u6e90\u52a0\u5feb\u955c\u50cf\u6784\u5efa\u901f\u5ea6</li> <li>\u6700\u5c0f\u5316\u955c\u50cf\u5c42\u6570</li> </ol>"},{"location":"DevOps/Docker/Image/","title":"\u955c\u50cf","text":""},{"location":"DevOps/Docker/Image/#_1","title":"\u4e00\u3001\u955c\u50cf\u7ed3\u6784","text":"<p>\u955c\u50cf\u662f\u5206\u5c42\u7684\u7ed3\u6784\uff0c\u6bcf\u4e2a\u5c42\u90fd\u662f\u53ea\u8bfb\u7684\uff0c\u6240\u6709\u5bf9\u5206\u5c42\u7684\u4fee\u6539\u90fd\u662f\u4ee5\u65b0\u5206\u5c42\u7684\u5f62\u5f0f\u51fa\u73b0\uff0c\u5e76\u4e0d\u4f1a\u7834\u574f\u539f\u5206\u5c42\u5185\u5bb9\u3002\u5206\u5c42\u53ef\u4ee5\u5b9e\u73b0\u4e0d\u540c\u955c\u50cf\u95f4\u7684\u8d44\u6e90\u5171\u4eab\uff0c\u5373\u4e0d\u540c\u955c\u50cf\u5bf9\u76f8\u540c\u4e0b\u5c42\u955c\u50cf\u7684\u590d\u7528\u3002\u5bf9\u4e8edocker pull\u547d\u4ee4\uff0c\u5728\u5176\u62c9\u53d6\u4e4b\u524d\u4f1a\u5148\u83b7\u53d6\u5230\u5176\u8981\u62c9\u53d6\u955c\u50cf\u7684\u6240\u6709ImageID\uff0c\u7136\u540e\u5728\u672c\u5730\u67e5\u627e\u662f\u5426\u5b58\u5728\u8fd9\u4e9b\u5206\u5c42\uff0c\u5982\u679c\u5b58\u5728\uff0c\u5219\u4e0d\u518d\u62c9\u53d6\uff0c\u800c\u662f\u5171\u4eab\u672c\u5730\u7684\u8be5\u5206\u5c42\uff0c\u5927\u5927\u8282\u7701\u4e86\u8282\u70b9\u7684\u5b58\u50a8\u7a7a\u95f4\u548c\u7f51\u7edc\u5e26\u5bbd\uff0c\u63d0\u5347\u4e86\u62c9\u53d6\u6548\u7387\u3002</p> <pre><code>$ docker pull redis\nUsing default tag: latest\nlatest: Pulling from library/redis\na378f10b3218: Pull complete \n3c75410c1f8b: Pull complete \n667874757cc1: Pull complete \n7150b93d249d: Pull complete \nDigest: sha256:4ca2a277f1dc3ddd0da33a258096de9a1cf5b9d9bd96b27ee78763ee2248c28c\nStatus: Downloaded newer image for redis:latest\n</code></pre>"},{"location":"DevOps/Docker/Image/#1","title":"1. \u955c\u50cf\u5c42\u7684\u6784\u6210","text":"<p>\u6bcf\u4e2a\u955c\u50cf\u5c42\u7531\u4e24\u90e8\u5206\u6784\u6210\uff0c\u955c\u50cf\u6587\u4ef6\u7cfb\u7edf\u4e0e\u955c\u50cfjson\u6587\u4ef6\u3002\u8fd9\u4e24\u90e8\u5206\u5177\u6709\u76f8\u540c\u7684ImageID\uff0c\u955c\u50cf\u6587\u4ef6\u7cfb\u7edf\u662f\u5bf9\u955c\u50cf\u6218\u53cb\u7684\u78c1\u76d8\u7a7a\u95f4\u8fdb\u884c\u7ba1\u7406\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u62e5\u6709\u8be5\u8fdb\u884c\u6240\u6709\u955c\u50cf\u5c42\u7684\u6570\u636e\u5185\u5bb9\u3002\u800c\u955c\u50cfjson\u6587\u4ef6\u65f6\u7528\u4e8e\u63cf\u8ff0\u955c\u50cf\u7684\u76f8\u5173\u5c5e\u6027\u7684\u96c6\u5408\uff0c\u901a\u8fc7<code>docker inspect [\u955c\u50cf\u540d]</code>\u67e5\u770b</p>"},{"location":"DevOps/Docker/Image/#2","title":"2. \u955c\u50cf\u6587\u4ef6\u7cfb\u7edf\u6784\u6210","text":"<p>\u4e00\u4e2adocker\u955c\u50cf\u7684\u6587\u4ef6\u7cfb\u7edf\u7531\u591a\u4e2a\u53ea\u8bfb\u955c\u50cf\u5c42\u6784\u6210\uff0c\u6bcf\u5c42\u90fd\u5b8c\u6210\u4e86\u7279\u5b9a\u7684\u529f\u80fd\u3002\u8fd9\u4e9b\u53ea\u8bfb\u955c\u50cf\u5c42\u6839\u636e\u5176\u4f4d\u7f6e\u4e0e\u529f\u80fd\u4e0d\u540c\u53ef\u4ee5\u5206\u4e3a\u57fa\u7840\u955c\u50cf\u5c42\u548c\u6269\u5c55\u955c\u50cf\u5c42\u3002</p>"},{"location":"DevOps/Docker/Image/#21","title":"2.1 \u57fa\u7840\u955c\u50cf\u5c42","text":"<p>\u6240\u6709\u955c\u50cf\u7684\u6700\u4e0b\u5c42\u90fd\u5177\u6709\u4e00\u4e2a\u53ef\u4ee5\u770b\u5f97\u5230\u7684\u57fa\u7840\u955c\u50cf\u5c42Base Image\uff0c\u57fa\u7840\u955c\u50cf\u5c42\u7684\u6587\u4ef6\u7cfb\u7edf\u79f0\u4e3a\u6839\u6587\u4ef6\u7cfb\u7edfrootfs\u3002\u800crootfs\u5219\u662f\u5efa\u7acb\u5728Linux\u7cfb\u7edf\u4e2d\u770b\u4e0d\u5230\u7684\u5f15\u5bfc\u6587\u4ef6\u7cfb\u7edfbootfs\u4e4b\u4e0a\u3002</p>"},{"location":"DevOps/Docker/Image/#22","title":"2.2 \u6269\u5c55\u8fdb\u884c\u5c42","text":"<p>\u5728\u57fa\u7840\u955c\u50cf\u5c42\u4e4b\u4e0a\u7684\u955c\u50cf\u5c42\u79f0\u4e3a\u6269\u5c55\u955c\u50cf\u5c42\uff0c\u5728Dockerfile\u4e2d\uff0c\u6bcf\u6761\u6307\u4ee4\u90fd\u662f\u7528\u4e8e\u5b8c\u6210\u67d0\u9879\u7279\u5b9a\u529f\u80fd\u7684\uff0c\u6bcf\u6761\u6307\u4ee4\u90fd\u4f1a\u751f\u6210\u4e00\u4e2a\u6269\u5c55\u955c\u50cf\u5c42\u3002</p>"},{"location":"DevOps/Docker/Image/#23","title":"2.3 \u5bb9\u5668\u5c42","text":"<p>\u4e00\u65e6\u955c\u50cf\u8fd0\u884c\u8d77\u6765\u5c31\u5f62\u6210\u4e86\u5bb9\u5668\uff0c\u800c\u5bb9\u5668\u5c31\u662f\u4e00\u4e2a\u8fd0\u884c\u4e2d\u7684Linux\u7cfb\u7edf\uff0c\u5176\u4e5f\u5177\u6709\u6587\u4ef6\u7cfb\u7edf\u3002\u5bb9\u5668\u7684\u6587\u4ef6\u7cfb\u7edf\u5c31\u662f\u5728Docker\u955c\u50cf\u6700\u5916\u5c42\u4e4b\u4e0a\u52a0\u4e86\u4e00\u4e2a\u53ef\u8bfb\u5199\u7684\u5bb9\u5668\u5c42\uff0c\u5bf9\u6587\u4ef6\u7684\u4efb\u4f55\u4fee\u6539\u90fd\u53ea\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\uff0c\u56e0\u6b64\u4efb\u4f55\u5bf9\u5bb9\u5668\u7684\u64cd\u4f5c\u90fd\u4e0d\u4f1a\u5f71\u54cd\u5230\u955c\u50cf\u672c\u8eab\u3002</p> <p>\u5bb9\u5668\u5c42\u5982\u679c\u8981\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6\uff0c\u7cfb\u7edf\u4f1a\u4ece\u5bb9\u5668\u5c42\u5f00\u59cb\u5411\u4e0b\u4e00\u5c42\u5c42\u7684\u67e5\u627e\u8be5\u6587\u4ef6\uff0c\u76f4\u5230\u627e\u5230\u4f4d\u7f6e\u3002\u4efb\u4f55\u5bf9\u4e8e\u6587\u4ef6\u7684\u64cd\u4f5c\u90fd\u4f1a\u8bb0\u5f55\u5728\u5bb9\u5668\u5c42\uff0c\u4f8b\u5982\u8981\u4fee\u6539\u67d0\u6587\u4ef6\uff0c\u5bb9\u5668\u5c42\u4f1a\u9996\u5148\u628a\u5728\u955c\u50cf\u5c42\u627e\u5230\u7684\u6587\u4ef6copy\u5230\u5bb9\u5668\u5c42\uff0c\u7136\u540e\u518d\u8fdb\u884c\u4fee\u6539\u3002</p> <p>\u53ef\u4ee5\u770b\u51fa\u5bb9\u5668\u5c31\u662f\u4e00\u4e2a\u53e0\u52a0\u540e\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u800c\u8fd9\u4e2a\u5bb9\u5668\u5c42\u79f0\u4e3aUnion File System\u3002</p>"},{"location":"DevOps/Docker/Image/#3","title":"3. \u955c\u50cf\u6458\u8981","text":"<p>\u6458\u8981\u662f\u955c\u50cf\u5185\u5bb9\u7684\u4e00\u4e2aHash\u503c\uff0c\u53ea\u8981\u955c\u50cf\u5185\u5bb9\u53d1\u751f\u53d8\u66f4\uff0c\u5176\u6458\u8981\u5c31\u4e00\u5b9a\u4f1a\u53d1\u751f\u53d8\u5316\u3002Docker\u9ed8\u8ba4\u91c7\u7528SHA256\u7b97\u6cd5\uff0c\u5176Hash\u503c\u65f6\u4e00\u4e2a\u957f\u5ea6256\u4f4d\u7684\u4e8c\u8fdb\u5236\uff0cDocker\u4f7f\u752816\u8fdb\u5236\u8868\u793a\uff0c\u5373\u957f\u5ea6\u4e3a64\u7684\u5b57\u7b26\u4e32\u3002</p> <p>\u6458\u8981\u7684\u4e3b\u8981\u4f5c\u7528\u662f\u7528\u6765\u533a\u5206\u76f8\u540c<code>&lt;repository&gt;:&lt;tag&gt;</code>\u7684\u4e0d\u540c\u955c\u50cf\u3002</p> <p>\u5728push\u6216pull\u955c\u50cf\u65f6\uff0c\u90fd\u4f1a\u5bf9\u955c\u50cf\u8fdb\u884c\u538b\u7f29\u4ee5\u8f83\u5c11\u7f51\u7edc\u5e26\u5bbd\u548c\u4f20\u8f93\u65f6\u957f\uff0c\u4f46\u538b\u7f29\u4f1a\u6539\u53d8\u955c\u50cf\u5185\u5bb9\uff0c\u5bfc\u81f4\u7ecf\u8fc7\u7f51\u7edc\u4f20\u8f93\u540e\u955c\u50cf\u5185\u5bb9\u4e0e\u5176digest\u4e0d\u7b26\u3002\u4e3a\u4e86\u907f\u514d\u8be5\u95ee\u9898\uff0cdocker\u53c8\u4e3a\u955c\u50cf\u914d\u7f6e\u4e86Distribution Hash\uff0c\u5728\u955c\u50cf\u88ab\u538b\u7f29\u540e\u7acb\u5373\u8ba1\u7b97\u5206\u53d1\u6563\u5217\u503c\uff0c\u7136\u540e\u4f7f\u8be5\u503c\u968f\u538b\u7f29\u8fc7\u7684\u955c\u50cf\u4e00\u540c\u8fdb\u884c\u53d1\u9001\uff0c\u5728\u63a5\u6536\u65b9\u6536\u5230\u540e\uff0c\u7acb\u5373\u8ba1\u7b97\u538b\u7f29\u955c\u50cf\u7684\u5206\u53d1\u6563\u5217\u503c\uff0c\u518d\u4e0e\u643a\u5e26\u7684\u5206\u53d1\u6563\u5217\u503c\u8fdb\u884c\u5bf9\u6bd4\uff0c\u5982\u679c\u76f8\u540c\u8bf4\u660e\u4f20\u8f93\u6ca1\u6709\u95ee\u9898\u3002</p>"},{"location":"DevOps/Docker/Image/#4","title":"4. \u591a\u67b6\u6784\u955c\u50cf","text":"<p>\u591a\u67b6\u6784\u955c\u50cf\uff0c\u662f\u67d0<code>&lt;repository&gt;</code>\u4e2d\u7684\u67d0<code>&lt;tag&gt;</code>\u955c\u50cf\u9488\u5bf9\u4e0d\u540c\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784\u7684\u4e0d\u540c\u955c\u50cf\u5b9e\u73b0\u3002\u5373\u591a\u67b6\u6784\u955c\u50cf\u4e2d\u5305\u542b\u7684\u955c\u50cf\u7684<code>&lt;repository&gt;:&lt;tag&gt;</code>\u90fd\u662f\u76f8\u540c\u7684\uff0c\u4f46\u5b83\u4eec\u9488\u5bf9\u7684\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784\u662f\u4e0d\u540c\u7684\u3002 \u65e0\u8bba\u7528\u6237\u4f7f\u7528\u7684\u662f\u4ec0\u4e48\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784\uff0c\u5176\u901a\u8fc7<code>docker pull</code>\u547d\u4ee4\u62c9\u53d6\u5230\u7684\u4e00\u5b9a\u662f\u9488\u5bf9\u8be5\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784\u7684\u955c\u50cf\uff0c\u65e0\u9700\u7528\u6237\u81ea\u5df1\u8003\u8651\u64cd\u4f5c\u7cfb\u7edf/\u7cfb\u7edf\u67b6\u6784\u95ee\u9898\u3002DockerHub\u80fd\u591f\u6839\u636e\u63d0\u4ea4pull\u8bf7\u6c42\u7684Docker\u7cfb\u7edf\u7684\u67b6\u6784\u81ea\u52a8\u9009\u62e9\u5176\u5bf9\u5e94\u7684\u955c\u50cf\u3002 \u5728DockerHub\u4e2d\uff0c\u955c\u50cf\u7684\u591a\u67b6\u6784\u4fe1\u606f\u4fdd\u5b58\u5728Manifest\u6587\u4ef6\u4e2d\u3002\u5728\u62c9\u53d6\u955c\u50cf\u65f6\uff0cDocker\u4f1a\u968f\u7740pull\u547d\u4ee4\u5c06\u5f53\u524dDocker\u7cfb\u7edf\u7684OS\u4e0e\u67b6\u6784\u4fe1\u606f\u4e00\u5e76\u63d0\u4ea4\u7ed9DockerHub\u3002DockerHub\u9996\u5148\u4f1a\u6839\u636e\u955c\u50cf\u7684<code>&lt;repository&gt;:&lt;tag&gt;</code>\u67e5\u627e\u662f\u5426\u5b58\u5728Manifest\u3002\u5982\u679c\u4e0d\u5b58\u5728\uff0c\u5219\u76f4\u63a5\u67e5\u627e\u5e76\u8fd4\u56de<code>&lt;repository&gt;:&lt;tag&gt;</code>\u955c\u50cf\u5373\u53ef\uff1b\u5982\u679c\u5b58\u5728\uff0c\u5219\u4f1a\u5728Manifest\u4e2d\u67e5\u627e\u662f\u5426\u5b58\u5728\u6307\u5b9a\u7cfb\u7edf/\u67b6\u6784\u7684\u955c\u50cf\u3002\u5982\u679c\u5b58\u5728\u8be5\u7cfb\u7edf/\u67b6\u6784\uff0c\u5219\u6839\u636eManifest\u4e2d\u8bb0\u5f55\u7684\u5730\u5740\u627e\u5230\u8be5\u955c\u50cf\u7684\u4f4d\u7f6e\u3002</p> <pre><code># \u67e5\u770b manifest\n$ docker manifest inspect busybox\n</code></pre>"},{"location":"DevOps/Docker/Image/#5","title":"5. \u60ac\u865a\u955c\u50cf","text":"<p>\u200b     \u60ac\u865a\u955c\u50cf\u662f\u6307\u65e2\u6ca1\u6709Repository\u53c8\u6ca1\u6709Tag\u7684\u50cf\u3002\u5f53\u65b0\u5efa\u4e86\u4e00\u4e2a\u955c\u50cf\u540e\uff0c\u4e3a\u8be5\u955c\u50cf\u6307\u5b9a\u4e86\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684TAG\uff0c\u90a3\u4e48\u539f\u6765\u7684\u955c\u50cf\u5c31\u4f1a\u53d8\u4e3a\u7a7a\u955c\u50cf\u3002</p> <p>```bash</p>"},{"location":"DevOps/Docker/Image/#_2","title":"\u5220\u9664\u60ac\u865a\u955c\u50cf,\u53ea\u80fd\u5220\u9664\u6ca1\u6709\u5bb9\u5668\u4f7f\u7528\u7684\u955c\u50cf\u3002","text":"<p>docker image prune  ```</p>"},{"location":"DevOps/Docker/Image/#_3","title":"\u4e8c\u3001\u5e38\u7528\u547d\u4ee4","text":""},{"location":"DevOps/Docker/Image/#1-docker-pull","title":"1. docker pull","text":""},{"location":"DevOps/Docker/Image/#11","title":"1.1 \u62c9\u53d6\u6700\u65b0\u955c\u50cf","text":"<pre><code>$ docker pull busybox\n\nUsing default tag: latest\nlatest: Pulling from library/busybox\n3f4d90098f5b: Pull complete \nDigest: sha256:3fbc632167424a6d997e74f52b878d7cc478225cffac6bc977eedfe51c7f4e79\nStatus: Downloaded newer image for busybox:latest\n</code></pre>"},{"location":"DevOps/Docker/Image/#12-tag","title":"1.2 \u62c9\u53d6\u6307\u5b9atag\u7684\u955c\u50cf","text":"<pre><code>docker pull ubuntu:22.04\n</code></pre>"},{"location":"DevOps/Docker/Image/#13-digest","title":"1.3 \u62c9\u53d6\u6307\u5b9aDigest\u7684\u955c\u50cf","text":"<pre><code>docker pull busybox@sha256:3fbc632167424a6d997e74f52b878d7cc478225cffac6bc977eedfe51c7f4e79\n</code></pre> <p>\u66f4\u591a\u7528\u6cd5\uff1ahttps://docs.docker.com/engine/reference/commandline/pull/</p>"},{"location":"DevOps/Docker/Image/#2-docker-images","title":"2. docker images","text":""},{"location":"DevOps/Docker/Image/#21_1","title":"2.1 \u5217\u51fa\u672c\u5730\u6240\u6709\u955c\u50cf","text":"<pre><code>$ docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nbusybox             latest              a416a98b71e2        2 months ago        4.26MB\nhello-world         latest              9c7a54a9a43c        5 months ago        13.3kB\n</code></pre>"},{"location":"DevOps/Docker/Image/#22-degests","title":"2.2 \u663e\u793a\u955c\u50cf\u7684degests","text":"<pre><code>$ docker images --digests\nREPOSITORY          TAG                 DIGEST                                                                    IMAGE ID            CREATED             SIZE\nbusybox             latest              sha256:3fbc632167424a6d997e74f52b878d7cc478225cffac6bc977eedfe51c7f4e79   a416a98b71e2        2 months ago        4.26MB\nhello-world         latest              sha256:88ec0acaa3ec199d3b7eaf73588f4518c25f9d34f58ce9a0df68429c5af48e8d   9c7a54a9a43c        5 months ago        13.3kB\n</code></pre>"},{"location":"DevOps/Docker/Image/#23-id","title":"2.3 \u663e\u793a\u5b8c\u6574\u955c\u50cfID","text":"<pre><code>$ docker images --no-trunc\nREPOSITORY          TAG                 IMAGE ID                                                                  CREATED             SIZE\nbusybox             latest              sha256:a416a98b71e224a31ee99cff8e16063554498227d2b696152a9c3e0aa65e5824   2 months ago        4.26MB\nhello-world         latest              sha256:9c7a54a9a43cca047013b82af109fe963fde787f63f9e016fdc3384500c2823d   5 months ago        13.3kB\n</code></pre>"},{"location":"DevOps/Docker/Image/#24-id","title":"2.4 \u53ea\u663e\u793a\u955c\u50cfID","text":"<pre><code>$ docker images -q\na416a98b71e2\n9c7a54a9a43c\n</code></pre>"},{"location":"DevOps/Docker/Image/#25-tag","title":"2.5 \u5217\u51fa\u6307\u5b9a\u540d\u79f0\u548ctag\u7684\u955c\u50cf","text":"<pre><code>$ docker images busybox:latest\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nbusybox             latest              a416a98b71e2        2 months ago        4.26MB\n</code></pre>"},{"location":"DevOps/Docker/Image/#26-tag","title":"2.6 \u5217\u51fa\u6240\u6709\u60ac\u865a\uff08\u6ca1\u6709tag\uff09\u955c\u50cf","text":"<pre><code>docker images --filter \"dangling=true\"\n</code></pre>"},{"location":"DevOps/Docker/Image/#27","title":"2.7 \u6309\u65f6\u95f4\u8fc7\u6ee4\u955c\u50cf","text":"<pre><code>$ docker images\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nnginx               latest              bc649bab30d1        4 days ago          187MB\nbusybox             latest              a416a98b71e2        2 months ago        4.26MB\nhello-world         latest              9c7a54a9a43c        5 months ago        13.3kB\n$ docker images -f before=busybox\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nhello-world         latest              9c7a54a9a43c        5 months ago        13.3kB\n$ docker images -f since=busybox\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nnginx               latest              bc649bab30d1        4 days ago          187MB\n</code></pre>"},{"location":"DevOps/Docker/Image/#28","title":"2.8 \u6b63\u5219\u5339\u914d\u67e5\u627e\u955c\u50cf","text":"<pre><code>$ docker images -f reference=*x:*\nREPOSITORY          TAG                 IMAGE ID            CREATED             SIZE\nnginx               latest              bc649bab30d1        4 days ago          187MB\nbusybox             latest              a416a98b71e2        2 months ago        4.26MB\n</code></pre>"},{"location":"DevOps/Docker/Image/#29","title":"2.9 \u683c\u5f0f\u5316\u663e\u793a","text":"<pre><code>$ docker images --format \"table {{.ID}}: {{.Repository}}: {{.Tag}}: {{.Digest}}: {{.CreatedSince}}: {{.CreatedAt}}: {{.Size}}\"\nIMAGE ID: REPOSITORY: TAG: DIGEST: CREATED: CREATED AT: SIZE\nbc649bab30d1: nginx: latest: sha256:b4af4f8b6470febf45dc10f564551af682a802eda1743055a7dfc8332dffa595: 4 days ago: 2023-10-12 11:14:44 +0800 CST: 187MB\na416a98b71e2: busybox: latest: sha256:3fbc632167424a6d997e74f52b878d7cc478225cffac6bc977eedfe51c7f4e79: 2 months ago: 2023-07-19 07:19:33 +0800 CST: 4.26MB\n9c7a54a9a43c: hello-world: latest: sha256:88ec0acaa3ec199d3b7eaf73588f4518c25f9d34f58ce9a0df68429c5af48e8d: 5 months ago: 2023-05-05 01:37:03 +0800 CST: 13.3kB\n\n# table \u662f\u6807\u9898\n</code></pre> <p>\u66f4\u591a\u7528\u6cd5\uff1ahttps://docs.docker.com/engine/reference/commandline/images/</p>"},{"location":"DevOps/Docker/Image/#3-docker-search","title":"3. docker search","text":""},{"location":"DevOps/Docker/Image/#31","title":"3.1 \u67e5\u627e\u955c\u50cf","text":"<pre><code>$ docker search busybox\nNAME                                DESCRIPTION                                     STARS               OFFICIAL            AUTOMATED\nbusybox                             Busybox base image.                             3115                [OK]                \nradial/busyboxplus                  Full-chain, Internet enabled, busybox made f\u2026   54                                      [OK]\n...\n</code></pre> <p>AUTOMATED\u8868\u793aDocker Hub\u8fde\u63a5\u4e86\u4e00\u4e2a\u5305\u542bDockerfile\u6587\u4ef6\u7684GitHub\u4ed3\u5e93\u6216\u8005BitBucket\u4ed3\u5e93\uff0cDocker Hub\u4f1a\u81ea\u52a8\u6784\u5efa\u955c\u50cf\uff0c\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u6784\u5efa\u51fa\u6765\u7684\u955c\u50cf\u4f1a\u88ab\u6807\u8bb0\u4e3aAutomated Build\uff0c\u4e5f\u79f0\u4e4b\u4e3a\u53d7\u4fe1\u6784\u5efa\uff08Trusted Build\uff09\uff0c\u8fd9\u79cd\u6784\u5efa\u65b9\u5f0f\u6784\u5efa\u51fa\u6765\u7684\u955c\u50cf\uff0c\u5176\u4ed6\u4eba\u5728\u4f7f\u7528\u65f6\u53ef\u4ee5\u81ea\u7531\u7684\u67e5\u770bDockerfile\u5185\u5bb9\uff0c\u77e5\u9053\u8be5\u955c\u50cf\u662f\u600e\u4e48\u6765\u7684\uff0c\u540c\u65f6\uff0c\u7531\u4e8e\u6784\u5efa\u8fc7\u7a0b\u662f\u81ea\u52a8\u7684\uff0c\u6240\u4ee5\u80fd\u591f\u786e\u4fdd\u4ed3\u5e93\u4e2d\u7684\u955c\u50cf\u90fd\u662f\u6700\u65b0\u7684\u3002</p>"},{"location":"DevOps/Docker/Image/#32","title":"3.2 \u6309\u6761\u4ef6\u7b5b\u9009","text":"<pre><code>$ docker search -f stars=3 -f is-automated=false -f is-official=true busybox --limit 1\nNAME                DESCRIPTION           STARS               OFFICIAL            AUTOMATED\nbusybox             Busybox base image.   3115                [OK]                \n</code></pre>"},{"location":"DevOps/Docker/Image/#33","title":"3.3 \u683c\u5f0f\u5316\u663e\u793a","text":"<pre><code>docker search --format \"table {{.Name}}\\t{{.StarCount}}\\t{{.IsAutomated}}\\t{{.IsOfficial}}\\t{{.Description}}\" nginx\n</code></pre>"},{"location":"DevOps/Docker/Image/#4-docker-rmi","title":"4. docker rmi","text":""},{"location":"DevOps/Docker/Image/#41","title":"4.1 \u5220\u9664\u955c\u50cf\u65f6\u6307\u5b9a\u955c\u50cf\u540d","text":"<pre><code>$ docker rmi hello-world:latest\n</code></pre> <p>4.2 \u5220\u9664\u955c\u50cf\u65f6\u6307\u5b9a\u955c\u50cfID</p> <pre><code>$ docker rmi a416a98b71e2\n</code></pre> <p>4.3 \u5f3a\u5236\u5220\u9664</p> <pre><code>$ docker rmi -f bc649bab30d1\n</code></pre>"},{"location":"DevOps/Docker/Image/#5_1","title":"5. \u955c\u50cf\u5bfc\u5165\u5bfc\u51fa","text":""},{"location":"DevOps/Docker/Image/#51","title":"5.1 \u5bfc\u51fa","text":"<pre><code>$ docker save -o busybox.tar busybox:latest\n# \u6216\n$ docker save busybox:latest &gt; busybox.tar\n</code></pre>"},{"location":"DevOps/Docker/Image/#52","title":"5.2 \u5bfc\u5165","text":"<pre><code>$ docker load -i busybox.tar \n3d24ee258efc: Loading layer [==================================================&gt;]  4.492MB/4.492MB\nLoaded image: busybox:latest\n# \u6216\n$ docker load &lt; busybox.tar \n</code></pre>"},{"location":"DevOps/Docker/Install/","title":"\u5b89\u88c5","text":""},{"location":"DevOps/Docker/Install/#_1","title":"\u4e00\u3001\u73af\u5883\u51c6\u5907","text":"<pre><code>CentOS Linux release 7.9.2009 (Core)\n</code></pre>"},{"location":"DevOps/Docker/Install/#_2","title":"\u4e8c\u3001\u5378\u8f7d\u8001\u7248\u672c","text":"<pre><code>yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n</code></pre>"},{"location":"DevOps/Docker/Install/#yum","title":"\u4e09\u3001\u6dfb\u52a0YUM\u6e90","text":"<pre><code>yum install -y yum-utils\n# \u5b98\u65b9\u7684\u6e90\uff0c\u8bbf\u95ee\u53d7\u9650\n# yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n# \u963f\u91cc\u4e91\u7684\u6e90\nyum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n</code></pre>"},{"location":"DevOps/Docker/Install/#_3","title":"\u56db\u3001\u67e5\u8be2\u53ef\u5b89\u88c5\u7684\u7248\u672c","text":"<pre><code>yum list docker-ce --showduplicates | sort -r\n</code></pre>"},{"location":"DevOps/Docker/Install/#docker","title":"\u4e94\u3001\u5b89\u88c5docker","text":""},{"location":"DevOps/Docker/Install/#1","title":"1. \u5b89\u88c5\u6307\u5b9a\u7248\u672c","text":"<pre><code>yum install -y docker-ce-18.09.9-3.el7  docker-ce-cli-18.09.9-3.el7 containerd.io docker-buildx-plugin docker-compose-plugin\n</code></pre>"},{"location":"DevOps/Docker/Install/#2-docker","title":"2. \u542f\u52a8docker","text":"<pre><code>systemctl start docker\n</code></pre>"},{"location":"DevOps/Docker/Install/#3-docker","title":"3. \u786e\u8ba4docker\u662f\u5426\u542f\u52a8\u6210\u529f","text":"<p>\u8fd0\u884chello-world\u5bb9\u5668</p> <pre><code>docker run hello-world\n</code></pre> <p>https://docs.docker.com/engine/install/centos/</p> <p>https://developer.aliyun.com/mirror/docker-ce</p>"},{"location":"DevOps/Docker/Network/","title":"\u7f51\u7edc","text":""},{"location":"DevOps/Docker/Network/#docker","title":"\u4e00\u3001Docker\u7f51\u7edc\u7684\u7ec4\u6210","text":""},{"location":"DevOps/Docker/Network/#1-cnm","title":"1. CNM","text":"<p>CNM\uff0c Container Netwyork Model\uff0c\u5bb9\u5668\u7f51\u7edc\u6a21\u578b\uff0c\u5176\u662f\u4e00\u79cd\u7f51\u7edc\u8fde\u63a5\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u4e00\u79cd\u8bbe\u8ba1\u89c4\u8303\u3001\u8bbe\u8ba1\u6807\u51c6\uff0c\u5176\u89c4\u5b9a\u4e86Docker\u7f51\u7edc\u7684\u57fa\u7840\u7ec4\u6210\u8981\u7d20\u3002 CNM\u4e2d\u5b9a\u4e49\u4e86\u4e09\u4e2a\u57fa\u672c\u8981\u7d20\uff1a\u6c99\u76d2Sandbox\uff0c\u7ec8\u7aefEndpoint\u4e0e\u7f51\u7edcNetwork\u3002</p> <ol> <li>\u6c99\u76d2\uff1a\u4e00\u4e2a\u72ec\u7acb\u7684\u7f51\u7edc\u6808\uff0c\u5176\u4e2d\u5305\u62ec\u4ee5\u592a\u7f51\u63a5\u53e3\u3001\u7aef\u53e3\u53f7\u3001\u8def\u7531\u8868\u3001DNS\u914d\u7f6e\u7b49\u3002Linux Network Namespace\u662f\u6c99\u76d2\u7684\u6807\u51c6\u5b9e\u73b0\u3002</li> <li>\u7ec8\u7aef\uff1a\u865a\u62df\u7f51\u7edc\u63a5\u53e3\uff0c\u4e3b\u8981\u8d1f\u8d23\u521b\u5efa\u8fde\u63a5\uff0c\u5373\u5c06\u6c99\u76d2\u8fde\u63a5\u5230\u7f51\u7edc\u4e0a\u3002\u4e00\u4e2a\u7ec8\u7aef\u53ea\u80fd\u63a5\u5165\u67d0\u4e00\u4e2a\u7f51\u7edc\u3002</li> <li>\u7f51\u7edc\uff1a802.1d\u7f51\u6865\u7684\u8f6f\u4ef6\u5b9e\u73b0\uff0c\u662f\u9700\u8981\u4ea4\u4e92\u7684\u7ec8\u7aef\u7684\u96c6\u5408\u3002</li> </ol> <pre><code>$ docker inspect busybox\n...\n        \"NetworkSettings\": {\n            \"Bridge\": \"\",\n            \"SandboxID\": \"60c7abc71309c2711b4d55e9729cd3becff2701a21158add723c5785b58ea020\",\n            \"HairpinMode\": false,\n            \"LinkLocalIPv6Address\": \"\",\n            \"LinkLocalIPv6PrefixLen\": 0,\n            \"Ports\": {},\n            \"SandboxKey\": \"/var/run/docker/netns/60c7abc71309\",\n            \"SecondaryIPAddresses\": null,\n            \"SecondaryIPv6Addresses\": null,\n            \"EndpointID\": \"cafa17b4fc516fc2e800fbb5bdf9bae8e2b6921a54f7ae41c3c3707f6fb15537\",\n            \"Gateway\": \"172.17.0.1\",\n            \"GlobalIPv6Address\": \"\",\n            \"GlobalIPv6PrefixLen\": 0,\n            \"IPAddress\": \"172.17.0.2\",\n            \"IPPrefixLen\": 16,\n            \"IPv6Gateway\": \"\",\n            \"MacAddress\": \"02:42:ac:11:00:02\",\n            \"Networks\": {\n                \"bridge\": {\n                    \"IPAMConfig\": null,\n                    \"Links\": null,\n                    \"Aliases\": null,\n                    \"NetworkID\": \"9759401112f20439cac9e5441a88203fa3088b020eb026b96c07809d066d807c\",\n                    \"EndpointID\": \"cafa17b4fc516fc2e800fbb5bdf9bae8e2b6921a54f7ae41c3c3707f6fb15537\",\n                    \"Gateway\": \"172.17.0.1\",\n                    \"IPAddress\": \"172.17.0.2\",\n                    \"IPPrefixLen\": 16,\n                    \"IPv6Gateway\": \"\",\n                    \"GlobalIPv6Address\": \"\",\n                    \"GlobalIPv6PrefixLen\": 0,\n                    \"MacAddress\": \"02:42:ac:11:00:02\",\n                    \"DriverOpts\": null\n                }\n            }\n...\n[root@localhost ~]# ls -l /var/run/docker/netns\ntotal 0\n-r--r--r--. 1 root root 0 Oct 17 13:53 60c7abc71309\n</code></pre>"},{"location":"DevOps/Docker/Network/#2-libnetwork","title":"2. Libnetwork","text":"<p>\u200b     CNM\u662f\u8bbe\u8ba1\u89c4\u8303\uff0c\u800cLibnetwork\u662f\u5f00\u6e90\u7684\u3001\u7531Go\u8bed\u8a00\u7f16\u5199\u7684\u3001\u8de8\u5e73\u53f0\u7684CNM\u7684\u6807\u51c6\u5b9e\u73b0\u3002 \u200b     Libnetwork\u9664\u4e86\u5b9e\u73b0\u4e86CNM\u7684\u4e09\u4e2a\u7ec4\u4ef6\uff0c\u8fd8\u5b9e\u73b0\u4e86\u672c\u5730\u670d\u52a1\u53d1\u73b0\u3001\u5bb9\u5668\u8d1f\u8f7d\u5747\u8861\uff0c\u4ee5\u53ca\u7f51\u7edc\u63a7\u5236\u5c42\u4e0e\u7ba1\u7406\u5c42\u529f\u80fd\u3002</p>"},{"location":"DevOps/Docker/Network/#3-driver","title":"3. Driver","text":"<p>\u6bcf\u79cd\u4e0d\u540c\u7684\u7f51\u7edc\u7c7b\u578b\u90fd\u6709\u5bf9\u5e94\u7684\u4e0d\u540c\u7684\u5e95\u5c42Driver\uff0c\u8fd9\u4e9bDriver\u8d1f\u8d23\u5728\u4e3b\u673a\u4e0a\u771f\u6b63\u5b9e\u73b0\u9700\u8981\u7684\u7f51\u7edc\u529f\u80fd\uff0c\u4f8b\u5982\u521b\u5efaveth pair\u8bbe\u5907\u7b49\u3002 \u4e0d\u8fc7\uff0c\u65e0\u8bba\u54ea\u79cd\u7f51\u7edc\u7c7b\u578b\uff0c\u5176\u5de5\u4f5c\u65b9\u5f0f\u90fd\u662f\u7c7b\u4f3c\u7684\u3002\u901a\u8fc7\u8c03\u7528Docker\u5f15\u64ceAPI\u53d1\u51fa\u8bf7\u6c42\uff0c\u7136\u540e\u7531Libnetwork\u505a\u51fa\u6846\u67b6\u6027\u7684\u5904\u7406\uff0c\u7136\u540e\u5c06\u8bf7\u6c42\u8f6c\u53d1\u7ed9\u76f8\u5e94\u7684Driver\u3002 \u901a\u8fc7<code>docker network ls</code>\u547d\u4ee4\u53ef\u4ee5\u67e5\u770b\u5f53\u524d\u4e3b\u673a\u6240\u8fde\u63a5\u7684\u7f51\u7edc\u53ca\u7f51\u7edc\u7c7b\u578b\u3002</p> <pre><code>$ docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\n9759401112f2        bridge              bridge              local\n5f276e46d24d        host                host                local\n53ce2abc7503        none                null                local\n</code></pre>"},{"location":"DevOps/Docker/Network/#docker_1","title":"\u4e8c\u3001Docker\u7f51\u7edc\u9a71\u52a8","text":""},{"location":"DevOps/Docker/Network/#1-bridge","title":"1. bridge","text":""},{"location":"DevOps/Docker/Network/#11-docker0","title":"1.1 Docker0\u7f51\u6865","text":"<p>bridge\u7f51\u7edc\u6a21\u5f0f\u4e2d\u5177\u6709\u4e00\u4e2a\u9ed8\u8ba4\u7684\u865a\u62df\u7f51\u6865dockero\uff0c\u901a\u8fc7<code>ip a</code>\u6216<code>ifconfig</code>\u547d\u4ee4\u90fd\u53ef\u67e5\u770b</p> <pre><code>[root@localhost ~]# ifconfig docker0\ndocker0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500\n        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255\n        inet6 fe80::42:16ff:fe66:8da  prefixlen 64  scopeid 0x20&lt;link&gt;\n        ether 02:42:16:66:08:da  txqueuelen 0  (Ethernet)\n        RX packets 104  bytes 87724 (85.6 KiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 94  bytes 10682 (10.4 KiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n</code></pre> <p>\u5728Linux\u4e3b\u673a\u4e0a\uff0cDocker\u7684bridge\u7f51\u7edc\u7531Bridge\u9a71\u52a8\u521b\u5efa\uff0c\u5176\u5728\u521b\u5efa\u65f6\u4f1a\u521b\u5efa\u4e00\u4e2a\u9ed8\u8ba4\u7684\u7f51\u6865dockero0\u3002\u5bb9\u5668\u4e0e\u7f51\u6865\u95f4\u662f\u901a\u8fc7veth pair\u6280\u672f\u5b9e\u73b0\u7684\u8fde\u63a5\uff0c\u7f51\u6865\u4e0e\u5916\u7f51\u95f4\u662f\u901a\u8fc7\u201c\u7f51\u7edc\u5730\u5740\u8f6c\u6362NAT\u6280\u672f\u201d\u5b9e\u73b0\u7684\u8fde\u63a5\uff0c\u5373\u5c06\u901a\u4fe1\u7684\u6570\u636e\u5305\u4e2d\u7684\u5185\u7f51\u5730\u5740\u8f6c\u6362\u4e3a\u5916\u7f51\u5730\u5740\u3002Bridge\u9a71\u52a8\u7684\u5e95\u5c42\u662f\u57fa\u4e8eLinux\u5185\u6838\u7684LinuxBridge\u6280\u672f\u3002</p> <pre><code>[root@localhost ~]# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 00:0c:29:a8:63:dc brd ff:ff:ff:ff:ff:ff\n    inet 192.168.1.136/24 brd 192.168.1.255 scope global noprefixroute dynamic ens33\n       valid_lft 1359sec preferred_lft 1359sec\n    inet6 fe80::f4d6:a364:587f:861b/64 scope link noprefixroute \n       valid_lft forever preferred_lft forever\n3: docker0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default \n    link/ether 02:42:16:66:08:da brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::42:16ff:fe66:8da/64 scope link \n       valid_lft forever preferred_lft forever\n91: vethebd420b@if90: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue master docker0 state UP group default \n    link/ether 12:05:94:bd:9e:45 brd ff:ff:ff:ff:ff:ff link-netnsid 2\n    inet6 fe80::1005:94ff:febd:9e45/64 scope link \n       valid_lft forever preferred_lft forever\n[root@localhost ~]# docker exec  busybox ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n90: eth0@if91: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n</code></pre> <p>\u5bbf\u4e3b\u673a\u768491\u53f7\u63a5\u53e3\u4e0e\u5bb9\u5668\u4e2d\u768490\u53f7\u63a5\u53e3\u4e3a\u4e00\u5bf9veth pair\u3002</p> <pre><code>[root@localhost ~]# brctl show\nbridge name bridge id       STP enabled interfaces\ndocker0     8000.0242166608da   no      vethebd420b\n</code></pre> <p>\u7f51\u5361<code>91: vethebd420b@if90</code>\u5c5e\u4e8e<code>docker0</code>\u7f51\u6865\u3002</p> <p>bridge\u7f51\u7edc\uff0c\u4e5f\u79f0\u4e3a\u5355\u673a\u6865\u63a5\u7f51\u7edc\uff0c\u662fDocker\u9ed8\u8ba4\u7684\u7f51\u7edc\u6a21\u5f0f\u3002\u8be5\u7f51\u7edc\u6a21\u5f0f\u53ea\u80fd\u5b58\u5728\u4e8e\u5355\u4e2aDocker\u4e3b\u673a\u4e0a\uff0c\u5176\u53ea\u80fd\u7528\u4e8e\u8fde\u63a5\u6240\u5728Docker\u4e3b\u673a\u4e0a\u7684\u5bb9\u5668\u3002</p>"},{"location":"DevOps/Docker/Network/#12","title":"1.2 \u521b\u5efa\u7f51\u6865","text":"<p>\u521b\u5efa\u4e00\u4e2a\u7f51\u6865</p> <pre><code>[root@localhost ~]# docker network create -d bridge bridge2\nb5a98b1b2f8565b2d8b95ed7a2e4a8a81ed47fa771122f6ca6628450a7f7c002\n[root@localhost ~]# docker network ls\nNETWORK ID          NAME                DRIVER              SCOPE\nc101138aa733        bridge              bridge              local\nb5a98b1b2f85        bridge2             bridge              local\n5f276e46d24d        host                host                local\n53ce2abc7503        none                null                local\n[root@localhost ~]# brctl show\nbridge name bridge id       STP enabled interfaces\nbr-b5a98b1b2f85     8000.02423a222e46   no      \ndocker0     8000.0242cb20dcd7   no  \n</code></pre> <p>\u521b\u5efa\u4e24\u4e2a\u5bb9\u5668\u5206\u522b\u5c5e\u4e8e\u4e24\u4e2a\u4e0d\u540c\u7684\u7f51\u7edc</p> <pre><code>[root@localhost ~]# docker run -itd --name busybox1 busybox\nb76bbd92872a57fcd29245bab390616be19cf24d2890367f7168aa3c7f8b9216\n[root@localhost ~]# docker run -itd --name busybox2 --network bridge2 busybox\n755ebadaaaa53c2520ef7c4e45433bd5d6bbd270d52b7ab75462dfefd7c089ed\n[root@localhost ~]# docker exec -it busybox1 ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n9: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n[root@localhost ~]# docker exec -it busybox2 ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n11: eth0@if12: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue \n    link/ether 02:42:ac:12:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.18.0.2/16 brd 172.18.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n</code></pre> <p>\u5c06busybox1\u6dfb\u52a0\u5230bridge2\u7f51\u7edc\u4e2d</p> <pre><code>[root@localhost ~]# docker network connect bridge2 busybox1\n[root@localhost ~]# docker exec -it busybox1 ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n9: eth0@if10: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue \n    link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0\n       valid_lft forever preferred_lft forever\n13: eth1@if14: &lt;BROADCAST,MULTICAST,UP,LOWER_UP,M-DOWN&gt; mtu 1500 qdisc noqueue \n    link/ether 02:42:ac:12:00:03 brd ff:ff:ff:ff:ff:ff\n    inet 172.18.0.3/16 brd 172.18.255.255 scope global eth1\n       valid_lft forever preferred_lft forever\n[root@localhost ~]# brctl show\nbridge name bridge id       STP enabled interfaces\nbr-b5a98b1b2f85     8000.02423a222e46   no      veth8b12f44\n                            vethff75d14\ndocker0     8000.0242cb20dcd7   no      vethfe81d3f\n</code></pre> <p>\u81ea\u5b9a\u4e49\u7f51\u6865\u7f51\u7edc\u4e2d\u5bb9\u5668\u53ef\u4ee5\u4f7f\u7528\u5bb9\u5668\u540d\u4f5c\u4e3a\u57df\u540dping\uff0c\u9ed8\u8ba4\u7f51\u6865\u4e0d\u53ef\u4ee5</p>"},{"location":"DevOps/Docker/Network/#2-none","title":"2. none","text":"<p>none\u7f51\u7edc\uff0c\u5373\u6ca1\u6709\u7f51\u7edc\u3002\u5bb9\u5668\u4ecd\u662f\u4e00\u4e2a\u72ec\u7acb\u7684Network Namespace\uff0c\u4f46\u6ca1\u6709\u7f51\u7edc\u63a5\u53e3\uff0c\u6ca1\u6709IP\u3002</p> <pre><code>[root@localhost ~]# docker run -itd --name busybox --network none busybox\ndd32c1c7780982184de6b120a9479d7cb86232f4e72fd59f75ebb120175abac0\n[root@localhost ~]# docker exec  busybox ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n</code></pre>"},{"location":"DevOps/Docker/Network/#3-host","title":"3. host","text":"<p>host\u7f51\u7edc\uff0c\u5373\u4e0e\u5bbf\u4e3b\u673ahost\u5171\u7528\u4e00\u4e2aNetwork Namespace\u3002\u8be5\u7f51\u7edc\u7c7b\u578b\u7684\u5bb9\u5668\u6ca1\u6709\u72ec\u7acb\u7684\u7f51\u7edc\u7a7a\u95f4\uff0c\u6ca1\u6709\u72ec\u7acb\u7684IP\uff0c\u5168\u90e8\u4e0ehost\u5171\u7528\u3002</p> <pre><code>[root@localhost ~]# docker run -itd --name busybox --network host busybox\ndc70395908bb810e3a81593a63bc01cd7a5dc6821dfcff4422490d1b9fd36628\n[root@localhost ~]# docker exec  busybox ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast qlen 1000\n    link/ether 00:0c:29:a8:63:dc brd ff:ff:ff:ff:ff:ff\n    inet 192.168.1.136/24 brd 192.168.1.255 scope global dynamic noprefixroute ens33\n       valid_lft 1438sec preferred_lft 1438sec\n    inet6 fe80::f4d6:a364:587f:861b/64 scope link noprefixroute \n       valid_lft forever preferred_lft forever\n3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue \n    link/ether 02:42:cb:20:dc:d7 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n    inet6 fe80::42:cbff:fe20:dcd7/64 scope link \n       valid_lft forever preferred_lft forever\n</code></pre>"},{"location":"DevOps/Docker/Networking/","title":"\u7f51\u7edc\u539f\u7406","text":""},{"location":"DevOps/Docker/Networking/#1network-namespace","title":"1\u3001Network Namespace","text":"<p>\u200b    Network Namespace\u662fLinux\u5185\u6838\u63d0\u4f9b\u7684\u7528\u4e8e\u5b9e\u73b0\u7f51\u7edc\u865a\u62df\u5316\u7684\u91cd\u8981\u529f\u80fd\uff0c\u5b83\u80fd\u521b\u5efa\u591a\u4e2a\u9694\u79bb\u7684\u7f51\u7edc\u7a7a\u95f4\uff0c\u6bcf\u4e2a\u72ec\u7acb\u7684\u7f51\u7edc\u7a7a\u95f4\u5185\u7684\u9632\u706b\u5899\u3001\u7f51\u5361\u3001\u8def\u7531\u8868\u3001\u90bb\u5c45\u8868\u3001\u534f\u8bae\u90fd\u662f\u72ec\u7acb\u7684\u3002\u4e0d\u7ba1\u662f\u865a\u62df\u673a\u8fd8\u662f\u5bb9\u5668\uff0c\u5f53\u8fd0\u884c\u5728\u72ec\u7acb\u7684\u547d\u540d\u7a7a\u95f4\u65f6\uff0c\u5c31\u50cf\u662f\u4e00\u53f0\u5355\u72ec\u7684\u4e3b\u673a\u4e00\u6837\u3002 \u5b9e\u4f8b\uff1a\u521b\u5efa\u4e24\u4e2aNetwork Namespace\uff0c\u5e76\u6700\u7ec8\u8ba9\u5b83\u4eec\u76f8\u4e92\u8fde\u901a\u3002</p>"},{"location":"DevOps/Docker/Networking/#1","title":"1. \u521b\u5efa\u4e24\u4e2a\u547d\u540d\u7a7a\u95f4","text":"<pre><code>[root@localhost ~]# ip netns add ns1\n[root@localhost ~]# ip netns add ns2\n[root@localhost ~]# ip netns list\nns2\nns1\n[root@localhost ~]# ip netns exec ns1 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n[root@localhost ~]# ip netns exec ns2 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n</code></pre>"},{"location":"DevOps/Docker/Networking/#2-veth-pair","title":"2. \u521b\u5efa\u7f51\u7edc\u63a5\u53e3veth pair","text":"<p>\u5982\u679c\u8981\u8ba9\u4e24\u4e2a\u547d\u540d\u7a7a\u95f4\u8fde\u901a\uff0c\u5219\u9700\u8981\u7528\u5230\u865a\u62df\u8bbe\u5907\u63a5\u53e3\u6280\u672fveth pair\u3002\u8be5\u6280\u672f\u9700\u8981\u4e00\u5bf9\u7f51\u7edc\u63a5\u53e3\u5206\u522b\u7f6e\u4e8e\u4e24\u4e2a\u547d\u540d\u7a7a\u95f4\u4e2d\u3002 \u521b\u5efa\u4e00\u5bf9\u7f51\u7edc\u63a5\u53e3veth-ns1\u4e0eveth-ns2</p> <pre><code>[root@localhost ~]# ip link add veth-ns1 type veth peer name veth-ns2\n[root@localhost ~]# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 00:0c:29:a8:63:dc brd ff:ff:ff:ff:ff:ff\n    inet 192.168.1.136/24 brd 192.168.1.255 scope global noprefixroute dynamic ens33\n       valid_lft 1585sec preferred_lft 1585sec\n    inet6 fe80::f4d6:a364:587f:861b/64 scope link noprefixroute \n       valid_lft forever preferred_lft forever\n88: veth-ns2@veth-ns1: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 22:b2:59:0a:60:20 brd ff:ff:ff:ff:ff:ff\n89: veth-ns1@veth-ns2: &lt;BROADCAST,MULTICAST,M-DOWN&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether f2:d0:46:7b:0d:fe brd ff:f f:ff:ff:ff:ff\n</code></pre> <p>\u6b64\u65f6\u901a\u8fc7ip 1\u67e5\u770b\u5f53\u524d\u7684\u7f51\u7edc\u5730\u5740\u60c5\u51b5\uff0c\u53ef\u4ee5\u770b\u5230\u65b0\u589e\u4e86\u4e24\u4e2a\u76f8\u4e92\u8fde\u901a\u7684veth pair\u5b83\u4eec\u90fd\u5177\u6709MAC\u5730\u5740\uff0c\u4f46\u5b83\u4eec\u7684\u72b6\u6001\u90fd\u662fDOWN\uff0c \u90fd\u4e0d\u5177\u6709P</p>"},{"location":"DevOps/Docker/Networking/#3-veth-pair","title":"3. \u547d\u540d\u7a7a\u95f4\u6dfb\u52a0veth pair","text":"<pre><code>[root@localhost ~]# ip link set veth-ns1 netns ns1\n[root@localhost ~]# ip link set veth-ns2 netns ns2\n[root@localhost ~]# ip netns exec ns1 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n89: veth-ns1@if88: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether f2:d0:46:7b:0d:fe brd ff:ff:ff:ff:ff:ff link-netnsid 1\n[root@localhost ~]# ip netns exec ns2 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n88: veth-ns2@if89: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 22:b2:59:0a:60:20 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n</code></pre>"},{"location":"DevOps/Docker/Networking/#4-vethip","title":"4. \u4e3aveth\u63a5\u53e3\u5206\u914dIP","text":"<pre><code>[root@localhost ~]# ip netns exec ns1 ip a add 172.16.0.1/16 dev veth-ns1\n[root@localhost ~]# ip netns exec ns2 ip a add 172.16.0.2/16 dev veth-ns2\n[root@localhost ~]# ip netns exec ns1 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n89: veth-ns1@if88: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether f2:d0:46:7b:0d:fe brd ff:ff:ff:ff:ff:ff link-netnsid 1\n    inet 172.16.0.1/16 scope global veth-ns1\n       valid_lft forever preferred_lft forever\n[root@localhost ~]# ip netns exec ns2 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n88: veth-ns2@if89: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc noop state DOWN group default qlen 1000\n    link/ether 22:b2:59:0a:60:20 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.16.0.2/16 scope global veth-ns2\n       valid_lft forever preferred_lft forever\n</code></pre>"},{"location":"DevOps/Docker/Networking/#5-veth","title":"5. \u542f\u52a8veth\u63a5\u53e3","text":"<pre><code>[root@localhost ~]# ip netns exec ns1 ip link set dev veth-ns1 up\n[root@localhost ~]# ip netns exec ns2 ip link set dev veth-ns2 up\n[root@localhost ~]# ip netns exec ns1 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n89: veth-ns1@if88: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000\n    link/ether f2:d0:46:7b:0d:fe brd ff:ff:ff:ff:ff:ff link-netnsid 1\n    inet 172.16.0.1/16 scope global veth-ns1\n       valid_lft forever preferred_lft forever\n    inet6 fe80::f0d0:46ff:fe7b:dfe/64 scope link \n       valid_lft forever preferred_lft forever\n[root@localhost ~]# ip netns exec ns2 ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n88: veth-ns2@if89: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000\n    link/ether 22:b2:59:0a:60:20 brd ff:ff:ff:ff:ff:ff link-netnsid 0\n    inet 172.16.0.2/16 scope global veth-ns2\n       valid_lft forever preferred_lft forever\n    inet6 fe80::20b2:59ff:fe0a:6020/64 scope link \n       valid_lft forever preferred_lft forever\n</code></pre>"},{"location":"DevOps/Docker/Networking/#6","title":"6. \u9a8c\u8bc1\u4e24\u4e2a\u547d\u540d\u7a7a\u95f4\u7684\u8054\u901a\u6027","text":"<pre><code>[root@localhost ~]# ip netns exec ns1 ping 172.16.0.2 -c 1\nPING 172.16.0.2 (172.16.0.2) 56(84) bytes of data.\n64 bytes from 172.16.0.2: icmp_seq=1 ttl=64 time=1.19 ms\n\n--- 172.16.0.2 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 0ms\nrtt min/avg/max/mdev = 1.198/1.198/1.198/0.000 ms\n[root@localhost ~]# ip netns exec ns2 ping 172.16.0.1 -c 1\nPING 172.16.0.1 (172.16.0.1) 56(84) bytes of data.\n64 bytes from 172.16.0.1: icmp_seq=1 ttl=64 time=0.103 ms\n\n--- 172.16.0.1 ping statistics ---\n1 packets transmitted, 1 received, 0% packet loss, time 0ms\nrtt min/avg/max/mdev = 0.103/0.103/0.103/0.000 ms\n</code></pre>"},{"location":"DevOps/Docker/Security/","title":"\u5bb9\u5668\u5b89\u5168","text":"<p>\u5c3d\u7ba1\u76ee\u524dNamespace\u5df2\u7ecf\u63d0\u4f9b\u4e86\u975e\u5e38\u591a\u7684\u8d44\u6e90\u9694\u79bb\u7c7b\u578b\uff0c\u4f46\u662f\u4ecd\u6709\u90e8\u5206\u5173\u952e\u5185\u5bb9\u6ca1\u6709\u88ab\u5b8c\u5168\u9694\u79bb\uff0c \u5176\u4e2d\u5305\u62ec\u4e00\u4e9b\u7cfb\u7edf\u7684\u5173\u952e\u6027\u76ee\u5f55\uff08\u5982/sys\u3001/proc\u7b49\uff09\u3002</p> <p>\u7531\u4e8e\u540c\u4e00\u5bbf\u4e3b\u673a\u4e0a\u6240\u6709\u5bb9\u5668\u5171\u4eab\u4e3b\u673a\u5185\u6838\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u4e00\u4e9b\u7279\u6b8a\u624b\u6bb5\u5bfc\u81f4\u5185\u6838\u5d29\uff0c\u8fdb\u800c\u5bfc\u81f4\u4e3b\u673a\u5ca9\u673a\u5f71\u54cd\u4e3b\u673a\u4e0a\u5176\u4ed6\u670d\u52a1\u3002</p> <p>User Namespace\u4e3b\u8981\u662f\u7528\u6765\u505a\u5bb9\u5668\u5185\u7528\u6237\u548c\u4e3b\u673a\u7684\u7528\u6237\u9694\u79bb\u7684\u3002</p> <p>Docker\u4ece1.10\u7248\u672c\u5f00\u59cb\uff0c\u4f7f\u7528User Namespace\u505a\u7528\u6237\u9694\u79bb\u5b9e\u73b0\u4e86\u5bb9\u5668\u4e2d\u7684root\u7528\u6237\u6620\u5c04\u5230\u4e3b\u673a\u4e0a\u7684\u975eroot\u7528\u6237</p>"},{"location":"DevOps/Docker/StorageDriver/","title":"\u5b58\u50a8\u9a71\u52a8","text":"<p>\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\uff08Union File System\uff0cUnionfs\uff09\u662f\u4e00\u79cd\u5206\u5c42\u7684\u8f7b\u91cf\u7ea7\u6587\u4ef6\u7cfb\u7edf\uff0c\u5b83\u53ef\u4ee5\u628a\u591a\u4e2a\u76ee\u5f55\u5185\u5bb9\u8054\u5408\u6302\u8f7d\u5230\u540c\u4e00\u76ee\u5f55\u4e0b\uff0c\u4ece\u800c\u5f62\u6210\u4e00\u4e2a\u5355\u4e00\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u8fd9\u79cd\u7279\u6027\u53ef\u4ee5\u8ba9\u4f7f\u7528\u8005\u50cf\u662f\u4f7f\u7528\u4e00\u4e2a\u76ee\u5f55\u4e00\u6837\u4f7f\u7528\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u3002</p> <p>\u90a3\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u53ef\u4ee5\u8bf4\u662f Docker \u955c\u50cf\u548c\u5bb9\u5668\u7684\u57fa\u7840\uff0c\u56e0\u4e3a\u5b83\u53ef\u4ee5\u4f7f Docker \u53ef\u4ee5\u628a\u955c\u50cf\u505a\u6210\u5206\u5c42\u7684\u7ed3\u6784\uff0c\u4ece\u800c\u4f7f\u5f97\u955c\u50cf\u7684\u6bcf\u4e00\u5c42\u53ef\u4ee5\u88ab\u5171\u4eab\u3002\u4f8b\u5982\u4e24\u4e2a\u4e1a\u52a1\u955c\u50cf\u90fd\u662f\u57fa\u4e8eCentOS7\u955c\u50cf\u6784\u5efa\u7684\uff0c\u90a3\u4e48\u8fd9\u4e24\u4e2a\u4e1a\u52a1\u955c\u50cf\u5728\u7269\u7406\u673a\u4e0a\u53ea\u9700\u8981\u5b58\u50a8\u4e00\u6b21CentOS7\u8fd9\u4e2a\u57fa\u7840\u955c\u50cf\u5373\u53ef\uff0c\u4ece\u800c\u8282\u7701\u5927\u91cf\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u5728\u4e3b\u673a\u4e0a\u4f7f\u7528\u591a\u5c42\u76ee\u5f55\u5b58\u50a8\uff0c\u4f46\u6700\u7ec8\u5448\u73b0\u7ed9\u7528\u6237\u7684\u5219\u662f\u4e00\u4e2a\u666e\u901a\u5355\u5c42\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u6211\u4eec\u628a\u591a\u5c42\u4ee5\u5355\u4e00\u5c42\u7684\u65b9\u5f0f\u5448\u73b0\u51fa\u6765\u7684\u8fc7\u7a0b\u53eb\u4f5c\u8054\u5408\u6302\u8f7d\u3002</p> <p>\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u53ea\u662f\u4e00\u4e2a\u6982\u5ff5\uff0c\u771f\u6b63\u5b9e\u73b0\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u624d\u662f\u5173\u952e\uff0cDocker \u4e2d\u6700\u5e38\u7528\u7684\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\u6709\u4e09\u79cd\uff1aAUFS\u3001Devicemapper \u548c OverlayFS\u3002</p> <p>AUFS\u76ee\u524d\u5e76\u672a\u88ab\u5408\u5e76\u5230 Linux \u5185\u6838\u4e3b\u7ebf\uff0c\u56e0\u6b64\u53ea\u6709Ubuntu\u548cDebian\u7b49\u5c11\u6570\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301AUFS\u3002\u5b83\u5728\u4e3b\u673a\u4e0a\u4f7f\u7528\u591a\u5c42\u76ee\u5f55\u5b58\u50a8\u3002</p> <p>\u76f8\u6bd4\u5bf9\u6587\u4ef6\u7cfb\u7edf\u52a0\u9501\u7684\u673a\u5236\uff0cDevicemapper\u5de5\u4f5c\u5728\u5757\u7ea7\u522b\uff0c\u56e0\u6b64\u53ef\u4ee5\u5b9e\u73b0\u540c\u65f6\u4fee\u6539\u548c\u8bfb\u5199\u5c42\u4e2d\u7684\u591a\u4e2a\u5757\u8bbe\u5907\uff0c\u6bd4AUFS\u6587\u4ef6\u7cfb\u7edf\u6548\u7387\u66f4\u9ad8\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c overlay2\u4f1a\u6bd4AUFS\u548cDevicemapper\u6027\u80fd\u66f4\u597d\uff0c\u800c\u4e14\u66f4\u52a0\u7a33\u5b9a\uff0c\u56e0\u4e3aoverlay2\u5728inode \u4f18\u5316\u4e0a\u66f4\u52a0\u9ad8\u6548\u3002\u56e0\u6b64\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u63a8\u8350\u4f7f\u7528overlay2\u4f5c\u4e3aDocker\u7684\u6587\u4ef6\u9a71\u52a8\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#aufs","title":"\u4e00  AUFS","text":"<p>AUFS\u662fDocker\u6700\u65e9\u4f7f\u7528\u7684\u6587\u4ef6\u7cfb\u7edf\u9a71\u52a8\uff0c\u591a\u7528\u4e8eUbuntu\u548c Debian\u7cfb\u7edf\u4e2d\u3002\u5728Docker\u65e9\u671f\uff0cOverlayFS\u548cDevicemapper\u76f8\u5bf9\u4e0d\u591f\u6210\u719f\uff0cAUFS\u662f\u6700\u65e9\u4e5f\u662f\u6700\u7a33\u5b9a\u7684\u6587\u4ef6\u7cfb\u7edf\u9a71\u52a8 </p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u67e5\u770b\u7cfb\u7edf\u662f\u5426\u652f\u6301 AUFS\uff1a</p> <pre><code>$ grep aufs /proc/filesystems\nnodev   aufs\n</code></pre> <p>\u6267\u884c\u4ee5\u4e0a\u547d\u4ee4\u540e\uff0c\u5982\u679c\u8f93\u51fa\u7ed3\u679c\u5305\u542baufs\uff0c\u5219\u4ee3\u8868\u5f53\u524d\u64cd\u4f5c\u7cfb\u7edf\u652f\u6301AUFS\u3002AUFS\u63a8\u8350\u5728Ubuntu\u6216Debian\u64cd\u4f5c\u7cfb\u7edf\u4e0b\u4f7f\u7528</p>"},{"location":"DevOps/Docker/StorageDriver/#1-aufs","title":"1. AUFS\u5de5\u4f5c\u539f\u7406","text":"<p>AUFS \u662f\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\uff0c\u610f\u5473\u7740\u5b83\u5728\u4e3b\u673a\u4e0a\u4f7f\u7528\u591a\u5c42\u76ee\u5f55\u5b58\u50a8\uff0c\u6bcf\u4e00\u4e2a\u76ee\u5f55\u5728AUFS\u4e2d\u90fd\u53eb\u4f5c\u5206\u652f\uff0c\u800c\u5728Docker\u4e2d\u5219\u79f0\u4e4b\u4e3a\u5c42\uff08layer\uff09\uff0c\u4f46\u6700\u7ec8\u5448\u73b0\u7ed9\u7528\u6237\u7684\u5219\u662f\u4e00\u4e2a\u666e\u901a\u5355\u5c42\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u6211\u4eec\u628a\u591a\u5c42\u4ee5\u5355\u4e00\u5c42\u7684\u65b9\u5f0f\u5448\u73b0\u51fa\u6765\u7684\u8fc7\u7a0b\u53eb\u4f5c\u8054\u5408\u6302\u8f7d\u3002</p> <p> </p> <p>\u6bcf\u4e00\u4e2a\u955c\u50cf\u5c42\u548c\u5bb9\u5668\u5c42\u90fd\u662f/var/lib/docker\u4e0b\u7684\u4e00\u4e2a\u5b50\u76ee\u5f55\uff0c\u955c\u50cf\u5c42\u548c\u5bb9\u5668\u5c42\u90fd\u5728aufs/diff\u76ee\u5f55\u4e0b\uff0c\u6bcf\u4e00\u5c42\u7684\u76ee\u5f55\u540d\u79f0\u662f\u955c\u50cf\u6216\u5bb9\u5668\u7684ID\u503c\uff0c\u8054\u5408\u6302\u8f7d\u70b9\u5728aufs/mnt\u76ee\u5f55\u4e0b\uff0cmnt\u76ee\u5f55\u662f\u771f\u6b63\u7684\u5bb9\u5668\u5de5\u4f5c\u76ee\u5f55\u3002</p> <pre><code>root@ubuntu:/var/lib/docker/aufs# tree -L 3\n.\n\u251c\u2500\u2500 diff\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 db42bf0ae2bf105e70c2aef7702b18b9256723cd8fa2cfe88e1d91d23e8225de\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 boot\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 dev\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 etc\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 home\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 lib64\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 media\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 mnt\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 opt\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 proc\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 root\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 run\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 sbin\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 srv\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 sys\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 tmp\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 usr\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 var\n\u251c\u2500\u2500 layers\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 db42bf0ae2bf105e70c2aef7702b18b9256723cd8fa2cfe88e1d91d23e8225de\n\u2514\u2500\u2500 mnt\n    \u2514\u2500\u2500 db42bf0ae2bf105e70c2aef7702b18b9256723cd8fa2cfe88e1d91d23e8225de\n\n24 directories, 1 file\n</code></pre> <p>\u5f53\u4e00\u4e2a\u955c\u50cf\u672a\u751f\u6210\u5bb9\u5668\u65f6\uff0cAUFS\u7684\u5b58\u50a8\u7ed3\u6784\u5982\u4e0b\u3002</p> <ul> <li>diff \u6587\u4ef6\u5939\uff1a\u5b58\u50a8\u955c\u50cf\u5185\u5bb9\uff0c\u6bcf\u4e00\u5c42\u90fd\u5b58\u50a8\u5728\u4ee5\u955c\u50cf\u5c42ID\u547d\u540d\u7684\u5b50\u6587\u4ef6\u5939\u4e2d\u3002</li> <li>layers\u6587\u4ef6\u5939\uff1a\u5b58\u50a8\u955c\u50cf\u5c42\u5173\u7cfb\u7684\u5143\u6570\u636e\uff0c\u5728diif\u6587\u4ef6\u5939\u4e0b\u7684\u6bcf\u4e2a\u955c\u50cf\u5c42\u5728\u8fd9\u91cc\u90fd\u4f1a\u6709\u4e00\u4e2a\u6587\u4ef6\uff0c\u6587\u4ef6\u7684\u5185\u5bb9\u4e3a\u8be5\u5c42\u955c\u50cf\u7684\u7236\u7ea7\u955c\u50cf\u7684ID\u3002</li> <li>mnt\u6587\u4ef6\u5939\uff1a\u8054\u5408\u6302\u8f7d\u70b9\u76ee\u5f55\uff0c\u672a\u751f\u6210\u5bb9\u5668\u65f6\uff0c\u8be5\u76ee\u5f55\u4e3a\u7a7a\u3002</li> </ul> <pre><code>root@ubuntu:/var/lib/docker/aufs# docker run -itd --name ubuntu ubuntu:18.04\nc66dfb480910564ee54d668c4a44ecedd92c32bf028f83bf02483d75dd89ad70\nroot@ubuntu:/var/lib/docker/aufs# tree -L 3\n.\n\u251c\u2500\u2500 diff\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262-init\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 dev\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 etc\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 db42bf0ae2bf105e70c2aef7702b18b9256723cd8fa2cfe88e1d91d23e8225de\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 boot\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 dev\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 etc\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 home\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 lib\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 lib64\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 media\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 mnt\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 opt\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 proc\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 root\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 run\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 sbin\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 srv\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 sys\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 tmp\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 usr\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 var\n\u251c\u2500\u2500 layers\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262-init\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 db42bf0ae2bf105e70c2aef7702b18b9256723cd8fa2cfe88e1d91d23e8225de\n\u2514\u2500\u2500 mnt\n    \u251c\u2500\u2500 8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 bin\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 boot\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 dev\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 etc\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 home\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 lib\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 lib64\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 media\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 mnt\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 opt\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 proc\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 root\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 run\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 sbin\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 srv\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 sys\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 tmp\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 usr\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 var\n    \u251c\u2500\u2500 8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262-init\n    \u2514\u2500\u2500 db42bf0ae2bf105e70c2aef7702b18b9256723cd8fa2cfe88e1d91d23e8225de\n\n49 directories, 3 files\n</code></pre> <p>\u5f53\u4e00\u4e2a\u955c\u50cf\u5df2\u7ecf\u751f\u6210\u5bb9\u5668\u65f6\uff0cAUFS \u5b58\u50a8\u7ed3\u6784\u4f1a\u53d1\u751f\u5982\u4e0b\u53d8\u5316\u3002</p> <ul> <li>diff\u6587\u4ef6\u5939\uff1a\u5f53\u5bb9\u5668\u8fd0\u884c\u65f6\uff0c\u4f1a\u5728diff\u76ee\u5f55\u4e0b\u751f\u6210\u5bb9\u5668\u5c42\u3002</li> <li>layers\u6587\u4ef6\u5939\uff1a\u589e\u52a0\u5bb9\u5668\u5c42\u76f8\u5173\u7684\u5143\u6570\u636e\u3002</li> <li>mnt\u6587\u4ef6\u5939\uff1a\u5bb9\u5668\u7684\u8054\u5408\u6302\u8f7d\u70b9\uff0c\u8fd9\u548c\u5bb9\u5668\u4e2d\u770b\u5230\u7684\u6587\u4ef6\u5185\u5bb9\u4e00\u81f4\u3002</li> </ul> <pre><code>root@ubuntu:~# mount -t aufs\nnone on /var/lib/docker/aufs/mnt/8daeb1a08fb3e942d0de8a17dd9524d90fd03e407c15e3466138ef300a200262 type aufs (rw,relatime,si=e5aaa9ec4fb54aab,dio,dirperm1)\n</code></pre>"},{"location":"DevOps/Docker/StorageDriver/#2-aufs","title":"2. AUFS\u8bfb\u5199\u539f\u7406","text":""},{"location":"DevOps/Docker/StorageDriver/#21","title":"2.1 \u8bfb\u53d6\u6587\u4ef6","text":"<p>\u5f53\u6211\u4eec\u5728\u5bb9\u5668\u4e2d\u8bfb\u53d6\u6587\u4ef6\u65f6\uff0c\u53ef\u80fd\u4f1a\u6709\u4ee5\u4e0b\u573a\u666f\u3002</p> <ul> <li>\u6587\u4ef6\u5728\u5bb9\u5668\u5c42\u4e2d\u5b58\u5728\u65f6\uff1a\u5f53\u6587\u4ef6\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\u65f6\uff0c\u76f4\u63a5\u4ece\u5bb9\u5668\u5c42\u8bfb\u53d6\u3002</li> <li>\u5f53\u6587\u4ef6\u5728\u5bb9\u5668\u5c42\u4e2d\u4e0d\u5b58\u5728\u65f6\uff1a\u5f53\u5bb9\u5668\u8fd0\u884c\u65f6\u9700\u8981\u8bfb\u53d6\u67d0\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u5bb9\u5668\u5c42\u4e2d\u4e0d\u5b58\u5728\u65f6\uff0c\u5219\u4ece\u955c\u50cf\u5c42\u67e5\u627e\u8be5\u6587\u4ef6\uff0c\u7136\u540e\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002</li> <li>\u6587\u4ef6\u65e2\u5b58\u5728\u4e8e\u955c\u50cf\u5c42\uff0c\u53c8\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\uff1a\u5f53\u6211\u4eec\u8bfb\u53d6\u7684\u6587\u4ef6\u65e2\u5b58\u5728\u4e8e\u955c\u50cf\u5c42\uff0c\u53c8\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\u65f6\uff0c\u5c06\u4f1a\u4ece\u5bb9\u5668\u5c42\u8bfb\u53d6\u8be5\u6587\u4ef6\u3002(\u7531\u4e8e\u5199\u65f6\u590d\u5236\uff0c\u6240\u4ee5\u6b64\u65f6\u80af\u5b9a\u662f\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u624d\u4f1a\u590d\u5236\u5230\u5bb9\u5668\u5c42\uff0c\u6240\u4ee5\u5e94\u8be5\u8bfb\u53d6\u5bb9\u5668\u5c42\u7684\u6587\u4ef6)</li> </ul>"},{"location":"DevOps/Docker/StorageDriver/#22","title":"2.2 \u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55","text":"<p>AUFS\u5bf9\u6587\u4ef6\u7684\u4fee\u6539\u91c7\u7528\u7684\u662f\u5199\u65f6\u590d\u5236\u7684\u5de5\u4f5c\u673a\u5236\uff0c\u8fd9\u79cd\u5de5\u4f5c\u673a\u5236\u53ef\u4ee5\u6700\u5927\u7a0b\u5ea6\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u3002</p> <p>\u5177\u4f53\u7684\u6587\u4ef6\u64cd\u4f5c\u673a\u5236\u5982\u4e0b\u3002</p> <ul> <li>\u7b2c\u4e00\u6b21\u4fee\u6539\u6587\u4ef6\uff1a\u5f53\u6211\u4eec\u7b2c\u4e00\u6b21\u5728\u5bb9\u5668\u4e2d\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6\u65f6\uff0cAUFS\u4f1a\u89e6\u53d1\u5199\u65f6\u590d\u5236\u64cd\u4f5c\uff0cAUFS\u9996\u5148\u4ece\u955c\u50cf\u5c42\u590d\u5236\u6587\u4ef6\u5230\u5bb9\u5668\u5c42\uff0c\u7136\u540e\u518d\u6267\u884c\u5bf9\u5e94\u7684\u4fee\u6539\u64cd\u4f5c\u3002</li> </ul> <p>AUFS\u5199\u65f6\u590d\u5236\u7684\u64cd\u4f5c\u5c06\u4f1a\u590d\u5236\u6574\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u6587\u4ef6\u8fc7\u5927\uff0c\u5c06\u4f1a\u5927\u5927\u964d\u4f4e\u6587\u4ef6\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u56e0\u6b64\u5f53\u6211\u4eec\u6709\u5927\u91cf\u6587\u4ef6\u9700\u8981\u88ab\u4fee\u6539\u65f6\uff0cAUFS\u53ef\u80fd\u4f1a\u51fa\u73b0\u660e\u663e\u7684\u5ef6\u8fdf\u3002\u597d\u5728\uff0c\u5199\u65f6\u590d\u5236\u64cd\u4f5c\u53ea\u5728\u7b2c\u4e00\u6b21\u4fee\u6539\u6587\u4ef6\u65f6\u89e6\u53d1\uff0c\u5bf9\u65e5\u5e38\u4f7f\u7528\u6ca1\u6709\u592a\u5927\u5f71\u54cd\u3002</p> <ul> <li>\u5220\u9664\u6587\u4ef6\u6216\u76ee\u5f55\uff1a\u5f53\u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u5220\u9664\u65f6\uff0cAUFS\u5e76\u4e0d\u4f1a\u771f\u6b63\u4ece\u955c\u50cf\u4e2d\u5220\u9664\u5b83\uff0c\u56e0\u4e3a\u955c\u50cf\u5c42\u662f\u53ea\u8bfb\u7684\uff0cAUFS\u4f1a\u521b\u5efa\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\uff0c\u8fd9\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\u6216\u6587\u4ef6\u5939\u4f1a\u963b\u6b62\u5bb9\u5668\u7684\u8bbf\u95ee\u3002</li> </ul>"},{"location":"DevOps/Docker/StorageDriver/#3-aufs","title":"3. AUFS\u6f14\u793a","text":""},{"location":"DevOps/Docker/StorageDriver/#31","title":"3.1 \u51c6\u5907\u6f14\u793a\u76ee\u5f55\u548c\u6587\u4ef6","text":"<p>\u9996\u5148\u6211\u4eec\u5728 /tmp \u76ee\u5f55\u4e0b\u521b\u5efa aufs \u76ee\u5f55\uff1a</p> <pre><code>ubuntu@ubuntu:~$ cd /tmp\nubuntu@ubuntu:/tmp$ mkdir aufs\n</code></pre> <p>\u51c6\u5907\u6302\u8f7d\u70b9\u76ee\u5f55\uff1a</p> <pre><code>ubuntu@ubuntu:/tmp$ cd aufs\nubuntu@ubuntu:/tmp/aufs$ mkdir mnt\n</code></pre> <p>\u63a5\u4e0b\u6765\u51c6\u5907\u5bb9\u5668\u5c42\u5185\u5bb9\uff1a</p> <pre><code># \u521b\u5efa\u5bb9\u5668\u5c42\u76ee\u5f55\nubuntu@ubuntu:/tmp/aufs$ mkdir container1\n# \u5728\u5bb9\u5668\u5c42\u76ee\u5f55\u4e0b\u51c6\u5907\u4e00\u4e2a\u6587\u4ef6\nubuntu@ubuntu:/tmp/aufs$ echo Hello, Container layer! &gt; container1/container1.txt\n</code></pre> <p>\u6700\u540e\u51c6\u5907\u955c\u50cf\u5c42\u5185\u5bb9\uff1a</p> <pre><code># \u521b\u5efa\u4e24\u4e2a\u955c\u50cf\u5c42\u76ee\u5f55\nubuntu@ubuntu:/tmp/aufs$ mkdir image1 image2\n# \u5206\u522b\u5199\u5165\u6570\u636e\nubuntu@ubuntu:/tmp/aufs$ echo Hello, Image layer1! &gt; image1/image1.txt\nubuntu@ubuntu:/tmp/aufs$ echo Hello, Image layer2! &gt; image2/image2.txt\n</code></pre> <p>\u51c6\u5907\u597d\u7684\u76ee\u5f55\u548c\u6587\u4ef6\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>ubuntu@ubuntu:/tmp/aufs$ tree .\n.\n\u251c\u2500\u2500 container1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 container1.txt\n\u251c\u2500\u2500 image1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 image1.txt\n\u251c\u2500\u2500 image2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 image2.txt\n\u2514\u2500\u2500 mnt\n\n4 directories, 3 files\n</code></pre>"},{"location":"DevOps/Docker/StorageDriver/#32-aufs","title":"3.2 \u521b\u5efa AUFS \u8054\u5408\u6587\u4ef6\u7cfb\u7edf","text":"<p>\u4f7f\u7528 mount \u547d\u4ee4\u53ef\u4ee5\u521b\u5efa AUFS \u7c7b\u578b\u7684\u6587\u4ef6\u7cfb\u7edf\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>sudo mount -t aufs -o dirs=./container1:./image2:./image1  none ./mnt\n</code></pre> <p>mount\u547d\u4ee4\u521b\u5efaAUFS\u7c7b\u578b\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0c\u8fd9\u91cc\u8981\u6ce8\u610f\uff0c\u5192\u53f7\u662f\u5206\u9694\u7b26\uff0cdirs\u53c2\u6570\u7b2c\u4e00\u4e2a\u76ee\u5f55\u9ed8\u8ba4\u4e3a\u8bfb\u5199\u6743\u9650\uff0c\u540e\u9762\u7684\u76ee\u5f55\u5747\u4e3a\u53ea\u8bfb\u6743\u9650\uff0c\u4e0eDocker\u5bb9\u5668\u4f7f\u7528AUFS\u7684\u6a21\u5f0f\u4e00\u81f4\u3002</p> <p>\u6267\u884c\u5b8c\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0cmnt\u53d8\u6210\u4e86AUFS\u7684\u8054\u5408\u6302\u8f7d\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528mount\u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u5df2\u7ecf\u521b\u5efa\u7684 AUFS \u6587\u4ef6\u7cfb\u7edf\uff1a</p> <pre><code>ubuntu@ubuntu:/tmp/aufs$ mount -t aufs\nnone on /tmp/aufs/mnt type aufs (rw,relatime,si=e5aaa9ec4cc9d2ab)\n</code></pre> <p>\u6211\u4eec\u6bcf\u521b\u5efa\u4e00\u4e2a AUFS \u6587\u4ef6\u7cfb\u7edf\uff0cAUFS \u90fd\u4f1a\u4e3a\u6211\u4eec\u751f\u6210\u4e00\u4e2a ID\uff0c\u8fd9\u4e2a ID \u5728 /sys/fs/aufs/ \u4f1a\u521b\u5efa\u5bf9\u5e94\u7684\u76ee\u5f55\uff0c\u5728\u8fd9\u4e2a ID \u7684\u76ee\u5f55\u4e0b\u53ef\u4ee5\u67e5\u770b\u6587\u4ef6\u6302\u8f7d\u7684\u6743\u9650\u3002</p> <pre><code>ubuntu@ubuntu:/tmp/aufs$ cat /sys/fs/aufs/si_e5aaa9ec4cc9d2ab/*\n/tmp/aufs/container1=rw\n/tmp/aufs/image2=ro\n/tmp/aufs/image1=ro\n64\n65\n66\n/tmp/aufs/container1/.aufs.xino\nubuntu@ubuntu:/tmp/aufs$ ls -l /sys/fs/aufs/si_e5aaa9ec4cc9d2ab\ntotal 0\n-r--r--r-- 1 root root 4096 Oct 31 15:12 br0\n-r--r--r-- 1 root root 4096 Oct 31 15:12 br1\n-r--r--r-- 1 root root 4096 Oct 31 15:12 br2\n-r--r--r-- 1 root root 4096 Oct 31 15:12 brid0\n-r--r--r-- 1 root root 4096 Oct 31 15:12 brid1\n-r--r--r-- 1 root root 4096 Oct 31 15:12 brid2\n-r--r--r-- 1 root root 4096 Oct 31 15:12 xi_path\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230container1\u76ee\u5f55\u7684\u6743\u9650\u4e3arw\uff08\u4ee3\u8868\u53ef\u8bfb\u5199\uff09\uff0cimage1\u548cimage2\u7684\u6743\u9650\u4e3aro\uff08\u4ee3\u8868\u53ea\u8bfb\uff09\u3002</p> <p>\u4e3a\u4e86\u9a8c\u8bc1 mnt \u76ee\u5f55\u4e0b\u53ef\u4ee5\u770b\u5230 container1\u3001image1 \u548c image2 \u76ee\u5f55\u4e0b\u7684\u6240\u6709\u5185\u5bb9\uff0c\u6211\u4eec\u4f7f\u7528 ls \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b mnt \u76ee\u5f55\uff1a</p> <pre><code>ubuntu@ubuntu:/tmp/aufs$ ls -l mnt/\ntotal 12\n-rw-rw-r-- 1 ubuntu ubuntu 24 Oct 31 15:09 container1.txt\n-rw-rw-r-- 1 ubuntu ubuntu 21 Oct 31 15:10 image1.txt\n-rw-rw-r-- 1 ubuntu ubuntu 21 Oct 31 15:10 image2.txt\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 mnt \u76ee\u5f55\u4e0b\u5df2\u7ecf\u51fa\u73b0\u4e86\u6211\u4eec\u51c6\u5907\u7684\u6240\u6709\u955c\u50cf\u5c42\u548c\u5bb9\u5668\u5c42\u7684\u6587\u4ef6\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#33-aufs","title":"3.3 \u9a8c\u8bc1 AUFS \u7684\u5199\u65f6\u590d\u5236","text":"<p>AUFS\u7684\u5199\u65f6\u590d\u5236\u662f\u6307\u5728\u5bb9\u5668\u4e2d\uff0c\u53ea\u6709\u9700\u8981\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6\u65f6\uff0c\u624d\u4f1a\u628a\u6587\u4ef6\u4ece\u955c\u50cf\u5c42\u590d\u5236\u5230\u5bb9\u5668\u5c42\uff0c\u4e0b\u9762\u6211\u4eec\u901a\u8fc7\u4fee\u6539\u8054\u5408\u6302\u8f7d\u76ee\u5f55 mnt \u4e0b\u7684\u5185\u5bb9\u6765\u9a8c\u8bc1\u4e0b\u8fd9\u4e2a\u8fc7\u7a0b\u3002</p> <p>\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539 mnt \u76ee\u5f55\u4e0b\u7684 image1.txt \u6587\u4ef6\uff1a</p> <pre><code>/tmp/aufs$ echo Hello, Image layer1 changed! &gt; mnt/image1.txt\n</code></pre> <p>\u7136\u540e\u6211\u4eec\u67e5\u770b\u4e0b image1/image1.txt \u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>ubuntu@ubuntu:/tmp/aufs$ echo Hello, Image layer1 changed! &gt; mnt/image1.txt\nubuntu@ubuntu:/tmp/aufs$ cat image1/image1.txt\nHello, Image layer1!\n</code></pre> <p>\u53d1\u73b0\u201c\u955c\u50cf\u5c42\u201d\u7684 image1.txt \u6587\u4ef6\u5e76\u672a\u88ab\u4fee\u6539\u3002 \u7136\u540e\u6211\u4eec\u67e5\u770b\u4e00\u4e0b\"\u5bb9\u5668\u5c42\"\u5bf9\u5e94\u7684 image1.txt \u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>ubuntu@ubuntu:/tmp/aufs$ ls -l container1/\ntotal 8\n-rw-rw-r-- 1 ubuntu ubuntu 24 Oct 31 15:09 container1.txt\n-rw-rw-r-- 1 ubuntu ubuntu 29 Oct 31 15:13 image1.txt\nubuntu@ubuntu:/tmp/aufs$ cat container1/image1.txt\nHello, Image layer1 changed!\n</code></pre> <p>\u53d1\u73b0 AUFS \u5728\u201c\u5bb9\u5668\u5c42\u201d\u81ea\u52a8\u521b\u5efa\u4e86 image1.txt \u6587\u4ef6\uff0c\u5e76\u4e14\u5185\u5bb9\u4e3a\u6211\u4eec\u521a\u624d\u5199\u5165\u7684\u5185\u5bb9\u3002\u6211\u4eec\u5728\u7b2c\u4e00\u6b21\u4fee\u6539\u955c\u50cf\u5185\u67d0\u4e2a\u6587\u4ef6\u65f6\uff0cAUFS \u4f1a\u590d\u5236\u8fd9\u4e2a\u6587\u4ef6\u5230\u5bb9\u5668\u5c42\uff0c\u7136\u540e\u5728\u5bb9\u5668\u5c42\u5bf9\u8be5\u6587\u4ef6\u8fdb\u884c\u4fee\u6539\u64cd\u4f5c\uff0c\u8fd9\u5c31\u662f AUFS \u6700\u5178\u578b\u7684\u7279\u6027\u5199\u65f6\u590d\u5236\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#overlay2","title":"\u4e8c\u3001Overlay2","text":"<p>OverlayFS \u7684\u53d1\u5c55\u5206\u4e3a\u4e24\u4e2a\u9636\u6bb5\u30022014 \u5e74\uff0cOverlayFS\u7b2c\u4e00\u4e2a\u7248\u672c\u88ab\u5408\u5e76\u5230Linux\u5185\u68383.18\u7248\u672c\u4e2d\uff0c\u6b64\u65f6\u7684OverlayFS\u5728Docker\u4e2d\u88ab\u79f0\u4e3aoverlay\u6587\u4ef6\u9a71\u52a8\u3002\u7531\u4e8e\u7b2c\u4e00\u7248\u7684overlay\u6587\u4ef6\u7cfb\u7edf\u5b58\u5728\u5f88\u591a\u5f0a\u7aef\uff08\u4f8b\u5982\u8fd0\u884c\u4e00\u6bb5\u65f6\u95f4\u540eDocker \u4f1a\u62a5 \"too many links problem\" \u7684\u9519\u8bef\uff09\uff0c Linux\u5185\u6838\u57284.0\u7248\u672c\u5bf9overlay\u505a\u4e86\u5f88\u591a\u5fc5\u8981\u7684\u6539\u8fdb\uff0c\u6b64\u65f6\u7684OverlayFS\u88ab\u79f0\u4e4b\u4e3aoverlay2\u3002</p> <p>\u56e0\u6b64\uff0c\u5728 Docker \u4e2d OverlayFS \u6587\u4ef6\u9a71\u52a8\u88ab\u5206\u4e3a\u4e86\u4e24\u79cd\uff0c\u4e00\u79cd\u662f\u65e9\u671f\u7684overlay\uff0c\u4e0d\u63a8\u8350\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\uff0c\u53e6\u4e00\u79cd\u662f\u66f4\u65b0\u548c\u66f4\u7a33\u5b9a\u7684overlay2\uff0c\u63a8\u8350\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u4f7f\u7528\u3002\u4e0b\u9762\u7684\u5185\u5bb9\u6211\u4eec\u4e3b\u8981\u56f4\u7ed5overlay2\u5c55\u5f00\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#1-overlay2","title":"1. \u4f7f\u7528 overlay2 \u7684\u5148\u51b3\u6761\u4ef6","text":"<p>overlay2\u867d\u7136\u5f88\u597d\uff0c\u4f46\u662f\u5b83\u7684\u4f7f\u7528\u662f\u6709\u4e00\u5b9a\u6761\u4ef6\u9650\u5236\u7684\u3002</p> <ul> <li>\u8981\u60f3\u4f7f\u7528overlay2\uff0cDocker \u7248\u672c\u5fc5\u987b\u9ad8\u4e8e 17.06.02\u3002</li> <li>\u5982\u679c\u4f60\u7684\u64cd\u4f5c\u7cfb\u7edf\u662fRHEL\u6216CentOS\uff0cLinux\u5185\u6838\u7248\u672c\u5fc5\u987b\u4f7f\u7528<code>3.10.0-514</code>\u6216\u8005\u66f4\u9ad8\u7248\u672c\uff0c\u5176\u4ed6 Linux \u53d1\u884c\u7248\u7684\u5185\u6838\u7248\u672c\u5fc5\u987b\u9ad8\u4e8e4.0\uff08\u4f8b\u5982Ubuntu\u6216Debian\uff09\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528<code>uname -a</code>\u67e5\u770b\u5f53\u524d\u7cfb\u7edf\u7684\u5185\u6838\u7248\u672c\u3002</li> <li>overlay2\u6700\u597d\u642d\u914dxfs\u6587\u4ef6\u7cfb\u7edf\u4f7f\u7528\uff0c\u5e76\u4e14\u4f7f\u7528xfs\u4f5c\u4e3a\u5e95\u5c42\u6587\u4ef6\u7cfb\u7edf\u65f6\uff0cd_type\u5fc5\u987b\u5f00\u542f\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9a8c\u8bc1 d_type \u662f\u5426\u5f00\u542f\uff1a</li> </ul> <pre><code>[root@localhost ~]# xfs_info /var/lib/docker | grep ftype\nnaming   =version 2              bsize=4096   ascii-ci=0 ftype=1\n</code></pre> <p>\u5f53\u8f93\u51fa\u7ed3\u679c\u4e2d\u6709 ftype=1 \u65f6\uff0c\u8868\u793a d_type \u5df2\u7ecf\u5f00\u542f\u3002\u5982\u679c\u4f60\u7684\u8f93\u51fa\u7ed3\u679c\u4e3a ftype=0\uff0c\u5219\u9700\u8981\u91cd\u65b0\u683c\u5f0f\u5316\u78c1\u76d8\u76ee\u5f55\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>mkfs.xfs -f -n ftype=1 /path/to/disk\n</code></pre> <p>\u53e6\u5916\uff0c\u5728\u751f\u4ea7\u73af\u5883\u4e2d\uff0c\u63a8\u8350\u6302\u8f7d<code>/var/lib/docker</code>\u76ee\u5f55\u5230\u5355\u72ec\u7684\u78c1\u76d8\u6216\u8005\u78c1\u76d8\u5206\u533a\uff0c\u8fd9\u6837\u53ef\u4ee5\u907f\u514d\u8be5\u76ee\u5f55\u5199\u6ee1\u5f71\u54cd\u4e3b\u673a\u7684\u6587\u4ef6\u5199\u5165\uff0c\u5e76\u4e14\u628a\u6302\u8f7d\u4fe1\u606f\u5199\u5165\u5230<code>/etc/fstab</code>\uff0c\u9632\u6b62\u673a\u5668\u91cd\u542f\u540e\u6302\u8f7d\u4fe1\u606f\u4e22\u5931\u3002</p> <p>\u6302\u8f7d\u914d\u7f6e\u4e2d\u63a8\u8350\u5f00\u542fpquota\uff0c\u8fd9\u6837\u53ef\u4ee5\u9632\u6b62\u67d0\u4e2a\u5bb9\u5668\u5199\u6587\u4ef6\u6ea2\u51fa\u5bfc\u81f4\u6574\u4e2a\u5bb9\u5668\u76ee\u5f55\u7a7a\u95f4\u88ab\u5360\u6ee1\u3002\u5199\u5165\u5230 <code>/etc/fstab</code>\u4e2d\u7684\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>$UUID /var/lib/docker xfs defaults,pquota 0 0\n</code></pre> <p>\u5176\u4e2dUUID\u4e3a/var/lib/docker\u6240\u5728\u78c1\u76d8\u6216\u8005\u5206\u533a\u7684UUID\u6216\u8005\u78c1\u76d8\u8def\u5f84\u3002</p> <p>\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c overlay2\u4f1a\u6bd4AUFS\u548cDevicemapper\u6027\u80fd\u66f4\u597d\uff0c\u800c\u4e14\u66f4\u52a0\u7a33\u5b9a\uff0c\u56e0\u4e3aoverlay2\u5728 inode \u4f18\u5316\u4e0a\u66f4\u52a0\u9ad8\u6548\u3002\u56e0\u6b64\u5728\u751f\u4ea7\u73af\u5883\u4e2d\u63a8\u8350\u4f7f\u7528overlay2\u4f5c\u4e3aDocker\u7684\u6587\u4ef6\u9a71\u52a8\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#2-overlay2","title":"2. overlay2\u5de5\u4f5c\u539f\u7406","text":""},{"location":"DevOps/Docker/StorageDriver/#21-overlay2","title":"2.1 overlay2\u662f\u5982\u4f55\u5b58\u50a8\u6587\u4ef6\u7684","text":"<p>overlay2\u548cAUFS\u7c7b\u4f3c\uff0c\u5b83\u5c06\u6240\u6709\u76ee\u5f55\u79f0\u4e4b\u4e3a\u5c42\uff08layer\uff09\uff0coverlay2\u7684\u76ee\u5f55\u662f\u955c\u50cf\u548c\u5bb9\u5668\u5206\u5c42\u7684\u57fa\u7840\uff0c\u800c\u628a\u8fd9\u4e9b\u5c42\u7edf\u4e00\u5c55\u73b0\u5230\u540c\u4e00\u7684\u76ee\u5f55\u4e0b\u7684\u8fc7\u7a0b\u79f0\u4e3a\u8054\u5408\u6302\u8f7d\uff08union mount\uff09\u3002overlay2\u628a\u76ee\u5f55\u7684\u4e0b\u4e00\u5c42\u53eb\u4f5clowerdir\uff0c\u4e0a\u4e00\u5c42\u53eb\u4f5cupperdir\uff0c\u8054\u5408\u6302\u8f7d\u540e\u7684\u7ed3\u679c\u53eb\u4f5cmerged\u3002</p> <p>\u603b\u4f53\u6765\u8bf4\uff0coverlay2\u662f\u8fd9\u6837\u50a8\u5b58\u6587\u4ef6\u7684\uff1aoverlay2\u5c06\u955c\u50cf\u5c42\u548c\u5bb9\u5668\u5c42\u90fd\u653e\u5728\u5355\u72ec\u7684\u76ee\u5f55\uff0c\u5e76\u4e14\u6709\u552f\u4e00ID\uff0c\u6bcf\u4e00\u5c42\u4ec5\u5b58\u50a8\u53d1\u751f\u53d8\u5316\u7684\u6587\u4ef6\uff0c\u6700\u7ec8\u4f7f\u7528\u8054\u5408\u6302\u8f7d\u6280\u672f\u5c06\u5bb9\u5668\u5c42\u548c\u955c\u50cf\u5c42\u7684\u6240\u6709\u6587\u4ef6\u7edf\u4e00\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\uff0c\u4f7f\u5f97\u5bb9\u5668\u4e2d\u770b\u5230\u5b8c\u6574\u7684\u7cfb\u7edf\u6587\u4ef6\u3002</p> <p>overlay2\u6587\u4ef6\u7cfb\u7edf\u6700\u591a\u652f\u6301128\u4e2a\u5c42\u6570\u53e0\u52a0\uff0c\u4e5f\u5c31\u662f\u8bf4\u4f60\u7684Dockerfile\u6700\u591a\u53ea\u80fd\u5199128\u884c\uff0c\u4e0d\u8fc7\u8fd9\u5728\u65e5\u5e38\u4f7f\u7528\u4e2d\u8db3\u591f\u4e86\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u901a\u8fc7\u62c9\u53d6\u4e00\u4e2aUbuntu\u64cd\u4f5c\u7cfb\u7edf\u7684\u955c\u50cf\u6765\u770b\u4e0boverlay2\u662f\u5982\u4f55\u5b58\u653e\u955c\u50cf\u6587\u4ef6\u7684\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u901a\u8fc7\u4ee5\u4e0b\u547d\u4ee4\u62c9\u53d6Ubuntu\u955c\u50cf\uff1a</p> <pre><code>$ docker --version\nDocker version 18.09.9, build 039a7df9ba\n$ docker pull ubuntu:16.04\n16.04: Pulling from library/ubuntu\n58690f9b18fc: Pull complete \nb51569e7c507: Pull complete \nda8ef40b9eca: Pull complete \nfb15d46c38dc: Pull complete \nDigest: sha256:1f1a2d56de1d604801a9671f301190704c25d604a416f59e03c04f5c6ffee0d6\nStatus: Downloaded newer image for ubuntu:16.04\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u955c\u50cf\u4e00\u5171\u88ab\u5206\u4e3a\u56db\u5c42\u62c9\u53d6\uff0c\u62c9\u53d6\u5b8c\u955c\u50cf\u540e\u6211\u4eec\u67e5\u770b\u4e00\u4e0boverlay2\u7684\u76ee\u5f55\uff1a</p> <pre><code>$ ls -l /var/lib/docker/overlay2/\ntotal 0\ndrwx------. 3 root root     30 Nov 12 21:25 0df618e818f09a3420989495cdb3c5fc9bb5c2623c7f523ecc6e8fee41eec1c1\ndrwx------. 4 root root     55 Nov 12 21:25 923c3563222a069f138a383448f1fc5ab4ef01026b3aee12bd69f3c4f0ccb950\ndrwx------. 4 root root     55 Nov 12 21:25 b1acf1f3788eca03ca64ac6fd25643c93f4665f2d509f65162bf84651c8446d9\nbrw-------. 1 root root 253, 0 Nov 12 21:12 backingFsBlockDev\ndrwx------. 4 root root     55 Nov 12 21:25 c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f\ndrwx------. 2 root root    142 Nov 12 21:25 l\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230overlay2\u76ee\u5f55\u4e0b\u51fa\u73b0\u4e86\u56db\u4e2a\u955c\u50cf\u5c42\u76ee\u5f55\u548c\u4e00\u4e2al\u76ee\u5f55\uff0c\u6211\u4eec\u9996\u5148\u6765\u67e5\u770b\u4e00\u4e0bl\u76ee\u5f55\u7684\u5185\u5bb9\uff1a</p> <pre><code>$ ls -l /var/lib/docker/overlay2/l\ntotal 0\nlrwxrwxrwx. 1 root root 72 Nov 12 21:25 4WOL22ELV2PGPPXHCK7LKD5TEO -&gt; ../b1acf1f3788eca03ca64ac6fd25643c93f4665f2d509f65162bf84651c8446d9/diff\nlrwxrwxrwx. 1 root root 72 Nov 12 21:25 BCREAASVZ4I54L5EVXPIJUEFG3 -&gt; ../0df618e818f09a3420989495cdb3c5fc9bb5c2623c7f523ecc6e8fee41eec1c1/diff\nlrwxrwxrwx. 1 root root 72 Nov 12 21:25 EZ4C2MA53DQFJ46GJZUJZASYX6 -&gt; ../923c3563222a069f138a383448f1fc5ab4ef01026b3aee12bd69f3c4f0ccb950/diff\nlrwxrwxrwx. 1 root root 72 Nov 12 21:25 HI543YYQQUURRL3MEIUFYTTGO2 -&gt; ../c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/diff\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230l\u76ee\u5f55\u662f\u4e00\u5806\u8f6f\u8fde\u63a5\uff0c\u628a\u4e00\u4e9b\u8f83\u77ed\u7684\u968f\u673a\u4e32\u8f6f\u8fde\u5230\u955c\u50cf\u5c42\u7684diff\u6587\u4ef6\u5939\u4e0b\uff0c\u8fd9\u6837\u505a\u662f\u4e3a\u4e86\u907f\u514d\u8fbe\u5230mount\u547d\u4ee4\u53c2\u6570\u7684\u957f\u5ea6\u9650\u5236\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u67e5\u770b\u4efb\u610f\u4e00\u4e2a\u955c\u50cf\u5c42\u4e0b\u7684\u6587\u4ef6\u5185\u5bb9\uff1a</p> <pre><code>$ ls -l /var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f\ntotal 8\ndrwxr-xr-x. 3 root root 17 Nov 12 21:25 diff\n-rw-r--r--. 1 root root 26 Nov 12 21:25 link\n-rw-r--r--. 1 root root 86 Nov 12 21:25 lower\ndrwx------. 2 root root  6 Nov 12 21:25 work\n</code></pre> <p>\u955c\u50cf\u5c42\u7684link\u6587\u4ef6\u5185\u5bb9\u4e3a\u8be5\u955c\u50cf\u5c42\u7684\u77edID\uff0cdiff\u6587\u4ef6\u5939\u4e3a\u8be5\u955c\u50cf\u5c42\u7684\u6539\u52a8\u5185\u5bb9\uff0clower\u6587\u4ef6\u4e3a\u8be5\u5c42\u7684\u6240\u6709\u7236\u5c42\u955c\u50cf\u7684\u77edID\uff0c\u591a\u4e2a\u955c\u50cf\u7528\u5192\u53f7\u5206\u5272\u3002</p> <pre><code>$ cat /var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/link \nHI543YYQQUURRL3MEIUFYTTGO2\n$ cat /var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/lower \nl/EZ4C2MA53DQFJ46GJZUJZASYX6:l/4WOL22ELV2PGPPXHCK7LKD5TEO:l/BCREAASVZ4I54L5EVXPIJUEFG3\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>docker image inspect</code>\u547d\u4ee4\u6765\u67e5\u770b\u67d0\u4e2a\u955c\u50cf\u7684\u5c42\u7ea7\u5173\u7cfb\uff0c\u4f8b\u5982\u6211\u60f3\u67e5\u770b\u521a\u521a\u4e0b\u8f7d\u7684Ubuntu\u955c\u50cf\u4e4b\u95f4\u7684\u5c42\u7ea7\u5173\u7cfb\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>$ docker image inspect ubuntu:16.04\n...\u7701\u7565\u90e8\u5206\u8f93\u51fa\n        \"GraphDriver\": {\n            \"Data\": {\n                \"LowerDir\": \"/var/lib/docker/overlay2/923c3563222a069f138a383448f1fc5ab4ef01026b3aee12bd69f3c4f0ccb950/diff:/var/lib/docker/overlay2/b1acf1f3788eca03ca64ac6fd25643c93f4665f2d509f65162bf84651c8446d9/diff:/var/lib/docker/overlay2/0df618e818f09a3420989495cdb3c5fc9bb5c2623c7f523ecc6e8fee41eec1c1/diff\",\n                \"MergedDir\": \"/var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/merged\",\n                \"UpperDir\": \"/var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/diff\",\n                \"WorkDir\": \"/var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/work\"\n            },\n            \"Name\": \"overlay2\"\n        },\n...\u7701\u7565\u90e8\u5206\u8f93\u51fa\n</code></pre> <p>\u5176\u4e2dMergedDir\u4ee3\u8868\u5f53\u524d\u955c\u50cf\u5c42\u5728overlay2\u5b58\u50a8\u4e0b\u7684\u76ee\u5f55\uff0cLowerDir\u4ee3\u8868\u5f53\u524d\u955c\u50cf\u7684\u7236\u5c42\u5173\u7cfb\uff0c\u4f7f\u7528\u5192\u53f7\u5206\u9694\uff0c\u5192\u53f7\u6700\u540e\u4ee3\u8868\u8be5\u955c\u50cf\u7684\u6700\u5e95\u5c42\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u5c06\u955c\u50cf\u8fd0\u884c\u8d77\u6765\u6210\u4e3a\u5bb9\u5668\uff1a</p> <pre><code>$ docker run --name=ubuntu -d ubuntu:16.04 sleep 3600\n</code></pre> <p>\u6211\u4eec\u4f7f\u7528docker inspect\u547d\u4ee4\u6765\u67e5\u770b\u4e00\u4e0b\u5bb9\u5668\u7684\u5de5\u4f5c\u76ee\u5f55\uff1a</p> <pre><code>$ docker inspect ubuntu\n...\u7701\u7565\u90e8\u5206\u8f93\u51fa\n        \"GraphDriver\": {\n            \"Data\": {\n                \"LowerDir\": \"/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2-init/diff:/var/lib/docker/overlay2/c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f/diff:/var/lib/docker/overlay2/923c3563222a069f138a383448f1fc5ab4ef01026b3aee12bd69f3c4f0ccb950/diff:/var/lib/docker/overlay2/b1acf1f3788eca03ca64ac6fd25643c93f4665f2d509f65162bf84651c8446d9/diff:/var/lib/docker/overlay2/0df618e818f09a3420989495cdb3c5fc9bb5c2623c7f523ecc6e8fee41eec1c1/diff\",\n                \"MergedDir\": \"/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2/merged\",\n                \"UpperDir\": \"/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2/diff\",\n                \"WorkDir\": \"/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2/work\"\n            },\n            \"Name\": \"overlay2\"\n        },\n...\u7701\u7565\u90e8\u5206\u8f93\u51fa\n</code></pre> <p>MergedDir \u7684\u5185\u5bb9\u5373\u4e3a\u5bb9\u5668\u5c42\u7684\u5de5\u4f5c\u76ee\u5f55\uff0cLowerDir \u4e3a\u5bb9\u5668\u6240\u4f9d\u8d56\u7684\u955c\u50cf\u5c42\u76ee\u5f55\u3002 \u7136\u540e\u6211\u4eec\u67e5\u770b\u4e0b overlay2 \u76ee\u5f55\u4e0b\u7684\u5185\u5bb9\uff1a</p> <pre><code>$ ls -l /var/lib/docker/overlay2/\ntotal 0\ndrwx------. 3 root root     30 Nov 12 21:25 0df618e818f09a3420989495cdb3c5fc9bb5c2623c7f523ecc6e8fee41eec1c1\ndrwx------. 4 root root     55 Nov 12 21:25 923c3563222a069f138a383448f1fc5ab4ef01026b3aee12bd69f3c4f0ccb950\ndrwx------. 4 root root     55 Nov 12 21:25 b1acf1f3788eca03ca64ac6fd25643c93f4665f2d509f65162bf84651c8446d9\nbrw-------. 1 root root 253, 0 Nov 12 21:12 backingFsBlockDev\ndrwx------. 5 root root     69 Nov 12 21:38 c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2\ndrwx------. 4 root root     55 Nov 12 21:38 c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2-init\ndrwx------. 4 root root     55 Nov 12 21:25 c558a491fd13d3023d1196eb16ce303010e1216ee480b17e27e6115daa268c4f\ndrwx------. 2 root root    210 Nov 12 21:38 l\n</code></pre> <p>\u8fd0\u884c\u5bb9\u5668\u540e\u751f\u6210\u4e86\u4e24\u4e2a\u65b0\u7684\u5c42\uff0c\u5176\u4e2d\u4e00\u4e2a\u4e3aiit\u5c42\uff0c\u8fd9\u662f\u7528\u6765\u5b58\u50a8\u548c\u5bb9\u5668\u73af\u5883\u76f8\u5173\u5185\u5bb9\u7684\u53ea\u8bfb\u5c42\uff0c\u7531\u4e8e\u8fd9\u4e9b\u73af\u5883\u5728\u6bcf\u53f0\u673a\u5668\u4e0a\u90fd\u53ef\u80fd\u4e0d\u540c\uff0cdocker\u7684\u7b56\u7565\u662f\u653e\u5728init\u5c42\uff0c\u6bcf\u4e2a\u955c\u50cf\u751f\u6210\u5bb9\u5668\u65f6\u53bb\u751f\u6210\u73af\u5883\u76f8\u5173\u7684\u914d\u7f6e\u3002\u6211\u4eec\u5728<code>docker commit</code>\u65f6\uff0c\u4e0d\u63d0\u4ea4init\u5c42\u7684\u5185\u5bb9\u3002</p> <pre><code>$ tree /var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2-init/\n/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2-init/\n\u251c\u2500\u2500 diff\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 dev\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 console\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 etc\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 hostname\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 hosts\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 mtab -&gt; /proc/mounts\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 resolv.conf\n\u251c\u2500\u2500 link\n\u251c\u2500\u2500 lower\n\u2514\u2500\u2500 work\n    \u2514\u2500\u2500 work\n\n6 directories, 7 files\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 overlay2 \u76ee\u5f55\u4e0b\u589e\u52a0\u4e86\u5bb9\u5668\u5c42\u76f8\u5173\u7684\u76ee\u5f55\uff0c\u6211\u4eec\u518d\u6765\u67e5\u770b\u4e00\u4e0b\u5bb9\u5668\u5c42\u4e0b\u7684\u5185\u5bb9\uff1a</p> <pre><code>$ ls -l /var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2\ntotal 8\ndrwxr-xr-x. 2 root root   6 Nov 12 21:38 diff\n-rw-r--r--. 1 root root  26 Nov 12 21:38 link\n-rw-r--r--. 1 root root 144 Nov 12 21:38 lower\ndrwxr-xr-x. 1 root root   6 Nov 12 21:38 merged\ndrwx------. 3 root root  18 Nov 12 21:38 work\n</code></pre> <p>link\u548clower\u6587\u4ef6\u4e0e\u955c\u50cf\u5c42\u7684\u529f\u80fd\u4e00\u81f4\uff0clink\u6587\u4ef6\u5185\u5bb9\u4e3a\u8be5\u5bb9\u5668\u5c42\u7684\u77edID\uff0clower\u6587\u4ef6\u4e3a\u8be5\u5c42\u7684\u6240\u6709\u7236\u5c42\u955c\u50cf\u7684\u77edID \u3002diff\u76ee\u5f55\u4e3a\u5bb9\u5668\u7684\u8bfb\u5199\u5c42\uff0c\u5bb9\u5668\u5185\u4fee\u6539\u7684\u6587\u4ef6\u90fd\u4f1a\u5728diff\u4e2d\u51fa\u73b0\uff0cmerged\u76ee\u5f55\u4e3a\u5206\u5c42\u6587\u4ef6\u8054\u5408\u6302\u8f7d\u540e\u7684\u7ed3\u679c\uff0c\u4e5f\u662f\u5bb9\u5668\u5185\u7684\u5de5\u4f5c\u76ee\u5f55\u3002</p> <pre><code>mount | grep overlay\noverlay on /var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2/merged type overlay (rw,relatime,seclabel,\nlowerdir=/var/lib/docker/overlay2/l/DTOYMUCW6MGKJF32MJ6L427QC5:\n/var/lib/docker/overlay2/l/HI543YYQQUURRL3MEIUFYTTGO2:\n/var/lib/docker/overlay2/l/EZ4C2MA53DQFJ46GJZUJZASYX6:\n/var/lib/docker/overlay2/l/4WOL22ELV2PGPPXHCK7LKD5TEO:\n/var/lib/docker/overlay2/l/BCREAASVZ4I54L5EVXPIJUEFG3,\nupperdir=/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2/diff,\nworkdir=/var/lib/docker/overlay2/c36895c9b4a4de011c85b69b548d5fddebe3175a3597d489386a6fef71c932b2/work)\n</code></pre> <p>\u603b\u4f53\u6765\u8bf4\uff0coverlay2\u662f\u8fd9\u6837\u50a8\u5b58\u6587\u4ef6\u7684\uff1aoverlay2\u5c06\u955c\u50cf\u5c42\u548c\u5bb9\u5668\u5c42\u90fd\u653e\u5728\u5355\u72ec\u7684\u76ee\u5f55\uff0c\u5e76\u4e14\u6709\u552f\u4e00ID\uff0c\u6bcf\u4e00\u5c42\u4ec5\u5b58\u50a8\u53d1\u751f\u53d8\u5316\u7684\u6587\u4ef6\uff0c\u6700\u7ec8\u4f7f\u7528\u8054\u5408\u6302\u8f7d\u6280\u672f\u5c06\u5bb9\u5668\u5c42\u548c\u955c\u50cf\u5c42\u7684\u6240\u6709\u6587\u4ef6\u7edf\u4e00\u6302\u8f7d\u5230\u5bb9\u5668\u4e2d\uff0c\u4f7f\u5f97\u5bb9\u5668\u4e2d\u770b\u5230\u5b8c\u6574\u7684\u7cfb\u7edf\u6587\u4ef6\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#22-overlay2","title":"2.2 overlay2\u5982\u4f55\u8bfb\u53d6\u3001\u4fee\u6539\u6587\u4ef6\uff1f","text":"<p>overlay2\u7684\u5de5\u4f5c\u8fc7\u7a0b\u4e2d\u5bf9\u6587\u4ef6\u7684\u64cd\u4f5c\u5206\u4e3a\u8bfb\u53d6\u6587\u4ef6\u548c\u4fee\u6539\u6587\u4ef6\u3002</p>"},{"location":"DevOps/Docker/StorageDriver/#221","title":"2.2.1 \u8bfb\u53d6\u6587\u4ef6","text":"<p>\u5bb9\u5668\u5185\u8fdb\u7a0b\u8bfb\u53d6\u6587\u4ef6\u5206\u4e3a\u4ee5\u4e0b\u4e09\u79cd\u60c5\u51b5\u3002</p> <ul> <li>\u6587\u4ef6\u5728\u5bb9\u5668\u5c42\u4e2d\u5b58\u5728\uff1a\u5f53\u6587\u4ef6\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\u5e76\u4e14\u4e0d\u5b58\u5728\u4e8e\u955c\u50cf\u5c42\u65f6\uff0c\u76f4\u63a5\u4ece\u5bb9\u5668\u5c42\u8bfb\u53d6\u6587\u4ef6\uff1b</li> <li>\u5f53\u6587\u4ef6\u5728\u5bb9\u5668\u5c42\u4e2d\u4e0d\u5b58\u5728\uff1a\u5f53\u5bb9\u5668\u4e2d\u7684\u8fdb\u7a0b\u9700\u8981\u8bfb\u53d6\u67d0\u4e2a\u6587\u4ef6\u65f6\uff0c\u5982\u679c\u5bb9\u5668\u5c42\u4e2d\u4e0d\u5b58\u5728\u8be5\u6587\u4ef6\uff0c\u5219\u4ece\u955c\u50cf\u5c42\u67e5\u627e\u8be5\u6587\u4ef6\uff0c\u7136\u540e\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff1b</li> <li>\u6587\u4ef6\u65e2\u5b58\u5728\u4e8e\u955c\u50cf\u5c42\uff0c\u53c8\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\uff1a\u5f53\u6211\u4eec\u8bfb\u53d6\u7684\u6587\u4ef6\u65e2\u5b58\u5728\u4e8e\u955c\u50cf\u5c42\uff0c\u53c8\u5b58\u5728\u4e8e\u5bb9\u5668\u5c42\u65f6\uff0c\u5c06\u4f1a\u4ece\u5bb9\u5668\u5c42\u8bfb\u53d6\u8be5\u6587\u4ef6\u3002(\u7531\u4e8e\u5199\u65f6\u590d\u5236\uff0c\u6240\u4ee5\u6b64\u65f6\u80af\u5b9a\u662f\u4fee\u6539\u8fc7\u7684\u6587\u4ef6\u624d\u4f1a\u590d\u5236\u5230\u5bb9\u5668\u5c42\uff0c\u6240\u4ee5\u5e94\u8be5\u8bfb\u53d6\u5bb9\u5668\u5c42\u7684\u6587\u4ef6)</li> </ul>"},{"location":"DevOps/Docker/StorageDriver/#222","title":"2.2.2 \u4fee\u6539\u6587\u4ef6\u6216\u76ee\u5f55","text":"<p>overlay2\u5bf9\u6587\u4ef6\u7684\u4fee\u6539\u91c7\u7528\u7684\u662f\u5199\u65f6\u590d\u5236\u7684\u5de5\u4f5c\u673a\u5236\uff0c\u8fd9\u79cd\u5de5\u4f5c\u673a\u5236\u53ef\u4ee5\u6700\u5927\u7a0b\u5ea6\u8282\u7701\u5b58\u50a8\u7a7a\u95f4\u3002\u5177\u4f53\u7684\u6587\u4ef6\u64cd\u4f5c\u673a\u5236\u5982\u4e0b\u3002</p> <ul> <li>\u7b2c\u4e00\u6b21\u4fee\u6539\u6587\u4ef6\uff1a\u5f53\u6211\u4eec\u7b2c\u4e00\u6b21\u5728\u5bb9\u5668\u4e2d\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6\u65f6\uff0coverlay2\u4f1a\u89e6\u53d1\u5199\u65f6\u590d\u5236\u64cd\u4f5c\uff0coverlay2 \u9996\u5148\u4ece\u955c\u50cf\u5c42\u590d\u5236\u6587\u4ef6\u5230\u5bb9\u5668\u5c42\uff0c\u7136\u540e\u5728\u5bb9\u5668\u5c42\u6267\u884c\u5bf9\u5e94\u7684\u6587\u4ef6\u4fee\u6539\u64cd\u4f5c\u3002</li> </ul> <p>overlay2\u5199\u65f6\u590d\u5236\u7684\u64cd\u4f5c\u5c06\u4f1a\u590d\u5236\u6574\u4e2a\u6587\u4ef6\uff0c\u5982\u679c\u6587\u4ef6\u8fc7\u5927\uff0c\u5c06\u4f1a\u5927\u5927\u964d\u4f4e\u6587\u4ef6\u7cfb\u7edf\u7684\u6027\u80fd\uff0c\u56e0\u6b64\u5f53\u6211\u4eec\u6709\u5927\u91cf\u6587\u4ef6\u9700\u8981\u88ab\u4fee\u6539\u65f6\uff0coverlay2\u53ef\u80fd\u4f1a\u51fa\u73b0\u660e\u663e\u7684\u5ef6\u8fdf\u3002\u597d\u5728\uff0c\u5199\u65f6\u590d\u5236\u64cd\u4f5c\u53ea\u5728\u7b2c\u4e00\u6b21\u4fee\u6539\u6587\u4ef6\u65f6\u89e6\u53d1\uff0c\u5bf9\u65e5\u5e38\u4f7f\u7528\u6ca1\u6709\u592a\u5927\u5f71\u54cd\u3002</p> <ul> <li>\u5220\u9664\u6587\u4ef6\u6216\u76ee\u5f55\uff1a\u5f53\u6587\u4ef6\u6216\u76ee\u5f55\u88ab\u5220\u9664\u65f6\uff0coverlay2\u5e76\u4e0d\u4f1a\u771f\u6b63\u4ece\u955c\u50cf\u4e2d\u5220\u9664\u5b83\uff0c\u56e0\u4e3a\u955c\u50cf\u5c42\u662f\u53ea\u8bfb\u7684\uff0coverlay2\u4f1a\u521b\u5efa\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u8fd9\u79cd\u7279\u6b8a\u7684\u6587\u4ef6\u6216\u76ee\u5f55\u4f1a\u963b\u6b62\u5bb9\u5668\u7684\u8bbf\u95ee\u3002</li> </ul>"},{"location":"DevOps/Docker/StorageDriver/#3-overlay2","title":"3. Overlay2\u6f14\u793a","text":""},{"location":"DevOps/Docker/StorageDriver/#31_1","title":"3.1 \u51c6\u5907\u6f14\u793a\u76ee\u5f55\u548c\u6587\u4ef6","text":"<p>\u521b\u5efa\u5bf9\u5e94\u7684\u76ee\u5f55\u548c\u6587\u4ef6</p> <pre><code>[root@host151 ~]# mkdir -p overlay2/{lower1,lower2,merged,upper,work}\n[root@host151 ~]# tree overlay2\noverlay2\n\u251c\u2500\u2500 lower1\n\u251c\u2500\u2500 lower2\n\u251c\u2500\u2500 merged\n\u251c\u2500\u2500 upper\n\u2514\u2500\u2500 work\n\n5 directories, 0 files\n[root@host151 overlay2]# echo \"I'm file1, belong to lower1\" &gt; lower1/file1.txt\n[root@host151 overlay2]# echo \"I'm file2, belong to lower2\" &gt; lower2/file2.txt\n[root@host151 overlay2]# echo \"I'm file3, belong to upper\" &gt; upper/file3.txt \n</code></pre> <p>\u73b0\u5728lower\u548cupper\u90fd\u6709\u5404\u81ea\u7684\u6587\u4ef6</p> <pre><code>[root@host151 overlay2]# tree\n.\n\u251c\u2500\u2500 lower1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file1.txt\n\u251c\u2500\u2500 lower2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file2.txt\n\u251c\u2500\u2500 merged\n\u251c\u2500\u2500 upper\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u2514\u2500\u2500 work\n\n5 directories, 3 files\n</code></pre>"},{"location":"DevOps/Docker/StorageDriver/#32-overlay2","title":"3.2 \u521b\u5efaoverlay2\u6587\u4ef6\u7cfb\u7edf","text":"<pre><code>[root@host151 overlay2]# mount | grep overlay\n[root@host151 overlay2]# mount -t overlay overlay -olowerdir=lower1:lower2,upperdir=upper,workdir=work merged\n[root@host151 overlay2]# mount | grep overlay\noverlay on /root/overlay2/merged type overlay (rw,relatime,seclabel,lowerdir=lower1:lower2,upperdir=upper,workdir=work)\n</code></pre> <p>\u67e5\u770b\u5f53\u524d\u76ee\u5f55\u7ed3\u6784</p> <pre><code>[root@host151 overlay2]# tree\n.\n\u251c\u2500\u2500 lower1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file1.txt\n\u251c\u2500\u2500 lower2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file2.txt\n\u251c\u2500\u2500 merged\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.txt\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u251c\u2500\u2500 upper\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u2514\u2500\u2500 work\n    \u2514\u2500\u2500 work\n</code></pre>"},{"location":"DevOps/Docker/StorageDriver/#33","title":"3.3 \u9a8c\u8bc1\u5199\u65f6\u590d\u5236","text":"<p>\u4fee\u6539lowerdir\u4e2d\u7684\u5185\u5bb9</p> <pre><code>[root@host151 overlay2]# echo 'file1 has been changed' &gt; merged/file1.txt\n[root@host151 overlay2]# cat merged/*\nfile1 has been changed\nI'm file2, belong to lower2\nI'm file3, belong to upper\n[root@host151 overlay2]# cat lower1/file1.txt\nI'm file1, belong to lower1\n[root@host151 overlay2]# tree\n.\n\u251c\u2500\u2500 lower1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file1.txt\n\u251c\u2500\u2500 lower2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file2.txt\n\u251c\u2500\u2500 merged\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.txt\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u251c\u2500\u2500 upper\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.txt\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u2514\u2500\u2500 work\n    \u2514\u2500\u2500 work\n\n6 directories, 7 files\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230merged\u76ee\u5f55\u4e2d\u7684\u6587\u4ef6\u88ab\u4fee\u6539\u4e86\uff0c\u4f46\u662flower1\u4e2d\u7684\u6587\u4ef6\u5185\u5bb9\u6ca1\u6709\u53d8\u5316\uff0c\u5728upper\u4e0b\u65b0\u751f\u6210\u4e86\u4e00\u4e2afile1.txt.</p> <p>\u5220\u9664lower2\u4e2d\u7684file2.txt</p> <pre><code>[root@host151 overlay2]# rm merged/file2.txt \nrm: remove regular file \u2018merged/file2.txt\u2019? y\n[root@host151 overlay2]# tree\n.\n\u251c\u2500\u2500 lower1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file1.txt\n\u251c\u2500\u2500 lower2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file2.txt\n\u251c\u2500\u2500 merged\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.txt\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u251c\u2500\u2500 upper\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file1.txt\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 file2.txt\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 file3.txt\n\u2514\u2500\u2500 work\n    \u2514\u2500\u2500 work\n\n6 directories, 7 files\n[root@host151 overlay2]# cat merged/*\nfile1 has been changed\nI'm file3, belong to upper\n[root@host151 overlay2]# ls -l upper/\ntotal 8\n-rw-r--r--. 1 root root   23 Nov 12 22:05 file1.txt\nc---------. 1 root root 0, 0 Nov 12 22:08 file2.txt\n-rw-r--r--. 1 root root   27 Nov 12 21:58 file3.txt\n</code></pre> <p>\u5728merged\u76ee\u5f55\u4e0b\u5df2\u7ecf\u770b\u4e0d\u5230file2.txt\uff0c\u4f46\u5728upperdir\u4e2d\uff0c\u53ef\u4ee5\u770b\u5230\u751f\u6210\u4e00\u4e2a\u7279\u6b8a\u7684\u5b57\u7b26\u8bbe\u5907\u6587\u4ef6\u3002</p>"},{"location":"DevOps/Docker/Volume/","title":"\u6570\u636e\u5377","text":"<p>\u5728\u5bb9\u5668\u5c42\u7684UnionFs\uff08\u8054\u5408\u6587\u4ef6\u7cfb\u7edf\uff09\u4e2d\u5bf9\u6587\u4ef6/\u76ee\u5f55\u7684\u4efb\u4f55\u4fee\u6539\uff0c\u65e0\u8bba\u662f\u624b\u5de5\u4fee\u6539\u8fd8\u662f\u5bb9\u5668\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u7684\u4fee\u6539\uff0c\u5728\u8be5\u5bb9\u5668\u4e22\u5931\u6216\u88ab\u9664\u540e\u8fd9\u4e9b\u4fee\u6539\u5c06\u5168\u90e8\u4e22\u5931\u3002\u5373\u8fd9\u4e9b\u4fee\u6539\u662f\u65e0\u6cd5\u4fdd\u5b58\u4e0b\u6765\u7684\u3002\u82e5\u8981\u4fdd\u5b58\u4e0b\u6765\u8fd9\u4e9b\u4fee\u6539\uff0c\u901a\u5e38\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ol> <li>\u5b9a\u5236\u955c\u50cf\u6301\u4e45\u5316\uff1a\u5c06\u8fd9\u4e2a\u4fee\u6539\u8fc7\u7684\u5bb9\u5668\u751f\u6210\u4e00\u4e2a\u65b0\u7684\u955c\u50cf\uff0c\u8ba9\u8fd9\u4e9b\u4fee\u6539\u53d8\u4e3a\u53ea\u8bfb\u7684\u955c\u50cf\u3002</li> <li>\u6570\u636e\u5377\u6301\u4e45\u5316\uff1a\u5c06\u8fd9\u4e9b\u4fee\u6539\u901a\u8fc7\u6570\u636e\u5377\u540c\u6b65\u5230\u5bbf\u4e3b\u673a\u3002</li> </ol> <p>Docker\u63d0\u4f9b\u4e86\u4e09\u79cd\u5b9e\u65f6\u540c\u6b65\uff08\u5bbf\u4e3b\u673a\u4e0e\u5bb9\u5668FS\u95f4\u6570\u636e\u7684\u540c\u6b65\uff09\u65b9\u5f0f\uff1a</p> <ol> <li>\u6570\u636e\u5377</li> <li>bind mounts\uff08\u7ed1\u5b9a\u6302\u8f7d\uff09</li> <li>tmpfs\uff08\u4e34\u65f6\u6587\u4ef6\u7cfb\u7edf\uff09  </li> </ol>"},{"location":"DevOps/Docker/Volume/#1","title":"1. \u6570\u636e\u5377\u6982\u8ff0","text":""},{"location":"DevOps/Docker/Volume/#11","title":"1.1 \u6570\u636e\u5377\u7b80\u4ecb","text":"<p>\u6570\u636e\u5377\u662f\u5bbf\u4e3b\u673a\u4e2d\u7684\u4e00\u4e2a\u7279\u6b8a\u7684\u6587\u4ef6/\u76ee\u5f55\uff0c\u8fd9\u4e2a\u6587\u4ef6/\u76ee\u5f55\u4e0e\u5bb9\u5668\u4e2d\u7684\u53e6\u4e00\u4e2a\u6587\u4ef6/\u76ee\u5f55\u8fdb\u884c\u4e86\u76f4\u63a5\u5173\u8054\uff0c\u5728\u4efb\u4f55\u4e00\u7aef\u5bf9\u6587\u4ef6/\u76ee\u5f55\u7684\u5199\u64cd\u4f5c\uff0c\u5728\u53e6\u4e00\u7aef\u90fd\u4f1a\u540c\u65f6\u53d1\u751f\u76f8\u5e94\u53d8\u5316\u3002\u5728\u5bbf\u4e3b\u4e2d\u7684\u8fd9\u4e2a\u6587\u4ef6/\u76ee\u5f55\u5c31\u79f0\u4e3a\u6570\u636e\u5377\u800c\u5bb9\u5668\u4e2d\u7684\u8fd9\u4e2a\u5173\u8054\u6587\u4ef6/\u76ee\u5f55\u5219\u79f0\u4e3a\u8be5\u6570\u636e\u5377\u5728\u8be5\u5bb9\u5668\u4e2d\u7684\u6302\u8f7d\u70b9\u3002 \u6570\u636e\u5377\u7684\u8bbe\u8ba1\u76ee\u7684\u5c31\u662f\u4e3a\u4e86\u5b9e\u73b0\u6570\u636e\u6301\u4e45\u5316\uff0c\u5176\u5b8c\u5168\u72ec\u7acb\u4e8e\u5bb9\u5668\u7684\u751f\u547d\u5468\u671f\uff0c\u5c5e\u4e8e\u5bbf\u4e3b\u673a\u6587\u4ef6\u7cfb\u7edf\uff0c\u4f46\u4e0d\u5c5e\u4e8eUnionFs\u3002\u56e0\u6b64\uff0c\u5bb9\u5668\u88ab\u9664\u65f6\uff0c\u4e0d\u4f1a\u9664\u5176\u6302\u7684\u6570\u636e\u5377\u3002</p>"},{"location":"DevOps/Docker/Volume/#12","title":"1.2 \u6570\u636e\u5377\u7684\u7279\u6027","text":"<p>\u6570\u636e\u5377\u5177\u6709\u5982\u4e0b\u660e\u663e\u7279\u6027\uff1a</p> <ol> <li>\u6570\u636e\u5377\u5728\u5bb9\u5668\u542f\u52a8\u65f6\u521d\u59cb\u5316\uff0c\u5982\u679c\u5bb9\u5668\u542f\u52a8\u540e\u5bb9\u5668\u672c\u8eab\u5df2\u7ecf\u5305\u542b\u4e86\u6570\u636e\uff0c\u90a3\u4e48\uff0c\u8fd9\u4e9b\u6570\u636e\u4f1a\u5728\u5bb9\u5668\u542f\u52a8\u540e\u76f4\u63a5\u51fa\u73b0\u5728\u6570\u636e\u5377\u4e2d\uff0c\u53cd\u4e4b\u4ea6\u7136</li> <li>\u53ef\u4ee5\u5bf9\u6570\u636e\u5377\u6216\u6302\u8f7d\u70b9\u4e2d\u7684\u5185\u5bb9\u76f4\u63a5\u4fee\u6539\uff0c\u4fee\u6539\u540e\u5bf9\u65b9\u7acb\u5373\u53ef\u770b\u5230</li> <li>\u6570\u636e\u5377\u4f1a\u4e00\u76f4\u5b58\u5728\uff0c\u5373\u4f7f\u6302\u8f7d\u6570\u636e\u5377\u7684\u5bb9\u5668\u5df2\u7ecf\u88ab\u5220\u9664</li> <li>\u6570\u636e\u5377\u53ef\u4ee5\u5728\u5bb9\u5668\u4e4b\u95f4\u5171\u4eab\u548c\u91cd\u7528</li> </ol>"},{"location":"DevOps/Docker/Volume/#2","title":"2. \u6570\u636e\u5377\u7684\u521b\u5efa","text":"<p>\u6570\u636e\u5377\u662f\u5728\u4f7f\u7528docker run\u542f\u52a8\u5bb9\u5668\u65f6\u6307\u5b9a\u7684\uff0c\u5176\u8bed\u6cd5\u683c\u5f0f\u4e3a\uff1a</p>"},{"location":"DevOps/Docker/Volume/#1_1","title":"1. \u8bfb\u5199\u6743\u9650","text":"<pre><code>docker run -it -v /\u5bbf\u4e3b\u673a\u76ee\u5f55\u7edd\u5bf9\u8def\u5f84:/\u5bb9\u5668\u5185\u76ee\u5f55\u7edd\u5bf9\u8def\u5f84\u955c\u50cf\n</code></pre> <p>\u65e0\u8bba\u662f\u5bbf\u4e3b\u673a\u4e2d\u7684\u6570\u636e\u5377\u8fd8\u662f\u5bb9\u5668\u4e2d\u7684\u6302\u8f7d\u70b9\uff0c\u5982\u679c\u6307\u5b9a\u7684\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u90a3\u4e48docker\u5f15\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u3002\u5373\u4f7f\u662f\u591a\u7ea7\u76ee\u5f55\u4e0d\u5b58\u5728\u3002</p>"},{"location":"DevOps/Docker/Volume/#2_1","title":"2. \u53ea\u8bfb\u6743\u9650","text":"<p>\u53ea\u8bfb\u6570\u636e\u5377\uff0c\u6307\u7684\u662f\u5bb9\u5668\u5bf9\u6302\u8f7d\u70b9\u7684\u64cd\u4f5c\u6743\u9650\u662f\u53ea\u8bfb\u7684\u3002\u5bbf\u4e3b\u673a\u5bf9\u6570\u636e\u5377\u7684\u64cd\u4f5c\u6743\u9650\u59cb\u7ec8\u662f\u8bfb\u5199\u7684\u3002 \u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u4e3a\u4e86\u9632\u6b62\u5bb9\u5668\u5728\u8fd0\u884c\u8fc7\u7a0b\u4e2d\u5bf9\u6587\u4ef6\u4ea7\u751f\u4fee\u6539\uff0c\u5c31\u9700\u8981\u521b\u5efa\u53ea\u8bfb\u6570\u636e\u5377\u3002</p> <pre><code>docker run -it -v /\u5bbf\u4e3b\u673a\u76ee\u5f55\u7edd\u5bf9\u8def\u5f84:/\u5bb9\u5668\u5185\u76ee\u5f55\u7edd\u5bf9\u8def\u5f84:ro \u955c\u50cf\n</code></pre>"},{"location":"DevOps/Docker/Volume/#3","title":"3. \u6570\u636e\u5377\u5171\u4eab","text":"<p>\u5f53\u4e00\u4e2a\u5bb9\u5668\u4e0e\u53e6\u4e00\u4e2a\u5bb9\u5668\u4f7f\u7528\u76f8\u540c\u7684\u6570\u636e\u5377\u65f6\uff0c\u5c31\u79f0\u8fd9\u4e24\u4e2a\u5bb9\u5668\u5b9e\u73b0\u4e86\u201c\u6570\u636e\u5377\u5171\u4eab\u201d\u3002</p> <p>\u6570\u636e\u5377\u5bb9\u5668\u662f\u5b9e\u73b0\u6570\u636e\u5377\u5171\u4eab\u7684\u4e00\u79cd\u975e\u5e38\u6709\u6548\u7684\u65b9\u6848\u3002 \u5f53\u4e00\u4e2a\u5bb9\u5668C\u542f\u52a8\u8fd0\u884c\u65f6\u521b\u5efa\u5e76\u6302\u8f7d\u4e86\u6570\u636e\u5377\uff0c\u82e5\u5176\u5b83\u5bb9\u5668\u4e5f\u9700\u8981\u5171\u4eab\u8be5\u5bb9\u5668C\u6302\u8f7d\u7684\u6570\u636e\u5377\uff0c\u8fd9\u4e9b\u5bb9\u5668\u53ea\u9700\u5728<code>docker run</code>\u52a8\u65f6\u901a\u8fc7<code>--volumes-from [\u5bb9\u5668C]</code>\u9009\u9879\u5373\u53ef\u5b9e\u73b0\u6570\u636e\u5377\u5171\u4eab\u3002\u6b64\u65f6\u5bb9\u5668C\u5c31\u79f0\u4e3a\u6570\u636e\u5377\u5bb9\u5668\u3002</p>"},{"location":"DevOps/Docker/Volume/#4-dockerfile","title":"4. Dockerfile\u521b\u5efa\u6301\u4e45\u5316\u6570\u636e\u5377","text":"<p>\u521b\u5efaDockerfile</p> <pre><code>FROM busybox\nVOLUME /opt/xxx\nCMD /bin/sh\n</code></pre> <p>\u521b\u5efa\u955c\u50cf</p> <pre><code>docker build -t vol:v1 .\n</code></pre> <p>\u542f\u52a8\u5bb9\u5668\uff0c\u68c0\u67e5\u8def\u5f84\u662f\u5426\u521b\u5efa</p> <pre><code>$ docker run --name myvol -it vol:v1 \n/ # \n/ # ls /opt/\nxxx\n/ # exit\n</code></pre> <p>\u67e5\u770b\u6570\u636e\u5377\u7684\u4f4d\u7f6e</p> <pre><code>$ docker inspect myval\n...\n        \"Mounts\": [\n            {\n                \"Type\": \"volume\",\n                \"Name\": \"9a89d604cfc3743f1d9219bb575e1cd76f45465b6c409038759d7eb5403d7082\",\n                \"Source\": \"/var/lib/docker/volumes/9a89d604cfc3743f1d9219bb575e1cd76f45465b6c409038759d7eb5403d7082/_data\",\n                \"Destination\": \"/opt/xxx\",\n                \"Driver\": \"local\",\n                \"Mode\": \"\",\n                \"RW\": true,\n                \"Propagation\": \"\"\n            }\n        ],\n...\n</code></pre>"},{"location":"DevOps/Docker/system%E5%AD%90%E5%91%BD%E4%BB%A4/","title":"system\u5b50\u547d\u4ee4","text":""},{"location":"DevOps/Docker/system%E5%AD%90%E5%91%BD%E4%BB%A4/#1-docker-system-df","title":"1 docker system df","text":"<pre><code>$ docker system df\nTYPE                TOTAL               ACTIVE              SIZE                RECLAIMABLE\nImages              4                   1                   926.4MB             848.5MB (91%)\nContainers          1                   1                   28B                 0B (0%)\nLocal Volumes       0                   0                   0B                  0B\nBuild Cache         0                   0                   0B                  0B\n</code></pre>"},{"location":"DevOps/Docker/system%E5%AD%90%E5%91%BD%E4%BB%A4/#2-docker-system-events","title":"2. docker system events","text":"<p>\u83b7\u53d6docker daemon\u65f6\u95f4</p> <pre><code>$ docker system events\n2023-10-17T06:18:35.991401205+08:00 container kill 27d70becba3afdbfdf51ce7b879bf3dc9276332b7db8c537baf683cdf01f50d1 (image=ubuntu, name=myubuntu, org.opencontainers.image.ref.name=ubuntu, org.opencontainers.image.version=22.04, signal=15)\n</code></pre>"},{"location":"DevOps/Docker/system%E5%AD%90%E5%91%BD%E4%BB%A4/#3-docker-system-info","title":"3. docker system info","text":"<pre><code>$ docker system info\nContainers: 1\n Running: 0\n Paused: 0\n Stopped: 1\nImages: 4\nServer Version: 18.09.9\nStorage Driver: overlay2\n Backing Filesystem: xfs\n Supports d_type: true\n Native Overlay Diff: true\nLogging Driver: json-file\nCgroup Driver: cgroupfs\nPlugins:\n Volume: local\n Network: bridge host macvlan null overlay\n Log: awslogs fluentd gcplogs gelf journald json-file local logentries splunk syslog\nSwarm: inactive\nRuntimes: runc\nDefault Runtime: runc\nInit Binary: docker-init\ncontainerd version: 61f9fd88f79f081d64d6fa3bb1a0dc71ec870523\nrunc version: N/A\ninit version: fec3683\nSecurity Options:\n seccomp\n  Profile: default\nKernel Version: 3.10.0-1160.el7.x86_64\nOperating System: CentOS Linux 7 (Core)\nOSType: linux\nArchitecture: x86_64\nCPUs: 2\nTotal Memory: 1.777GiB\nName: host136\nID: HP3F:VDSB:UNQB:RFI2:VIOV:H6UG:TQ6M:T6DE:XVIP:XDM7:DNVD:OOAH\nDocker Root Dir: /var/lib/docker\nDebug Mode (client): false\nDebug Mode (server): false\nRegistry: https://index.docker.io/v1/\nLabels:\nExperimental: false\nInsecure Registries:\n 127.0.0.0/8\nLive Restore Enabled: false\nProduct License: Community Engine\n\nWARNING: bridge-nf-call-iptables is disabled\nWARNING: bridge-nf-call-ip6tables is disabled\n</code></pre>"},{"location":"DevOps/Docker/system%E5%AD%90%E5%91%BD%E4%BB%A4/#4-docker-system-prune","title":"4. docker system prune","text":"<p>\u5f3a\u5236\u5220\u9664\u6240\u6709\u672a\u4f7f\u7528\u7684\u5bb9\u5668\u548c\u955c\u50cf</p> <pre><code>$ docker system prune -a -f\n</code></pre>"},{"location":"DevOps/Docker/underlyingtechnology/","title":"\u5e95\u5c42\u6280\u672f","text":""},{"location":"DevOps/Docker/underlyingtechnology/#namespace","title":"\u4e00\u3001Namespace","text":"<p>Namespace\u662fLinux\u5185\u6838\u7684\u4e00\u9879\u529f\u80fd\uff0c\u8be5\u529f\u80fd\u5bf9\u5185\u6838\u8d44\u6e90\u8fdb\u884c\u5206\u533a\uff0c\u4ee5\u4f7f\u4e00\u7ec4\u8fdb\u7a0b\u770b\u5230\u4e00\u7ec4\u8d44\u6e90\uff0c\u800c\u53e6\u4e00\u7ec4\u8fdb\u7a0b\u770b\u5230\u53e6\u4e00\u7ec4\u8d44\u6e90\u3002Namespace\u7684\u5de5\u4f5c\u65b9\u5f0f\u901a\u8fc7\u4e3a\u4e00\u7ec4\u8d44\u6e90\u548c\u8fdb\u7a0b\u8bbe\u7f6e\u76f8\u540c\u7684Namespace\u800c\u8d77\u4f5c\u7528\uff0c\u4f46\u662f\u8fd9\u4e9bNamespace\u5f15\u7528\u4e86\u4e0d\u540c\u7684\u8d44\u6e90\u3002\u8d44\u6e90\u53ef\u80fd\u5b58\u5728\u4e8e\u591a\u4e2aNamespace\u4e2d\u3002\u8fd9\u4e9b\u8d44\u6e90\u53ef\u4ee5\u662f\u8fdb\u7a0bID\u3001\u4e3b\u673a\u540d\u3001\u7528\u6237ID\u3001\u6587\u4ef6\u540d\u3001\u4e0e\u7f51\u7edc\u8bbf\u95ee\u76f8\u5173\u7684\u540d\u79f0\u548c\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002</p> <p>Linux 5.6 \u5185\u6838\u4e2d\u63d0\u4f9b\u4e86 8 \u79cd\u7c7b\u578b\u7684 Namespace\uff1a</p> Namespace \u4f5c\u7528 \u5185\u6838\u7248\u672c Mount\uff08mnt\uff09 \u9694\u79bb\u6302\u8f7d\u70b9 2.4.19 Process ID\uff08pid\uff09 \u9694\u79bb\u8fdb\u7a0bID 2.6.24 Network(net\uff09 \u9694\u79bb\u7f51\u7edc\u8bbe\u5907\uff0c\u7aef\u53e3\u53f7\u7b49 2.6.29 Interprocess Communication \uff08ipc\uff09 \u9694\u79bbSystemVIPC\u548cPOSIX message queues 2.6.19 UTS Namespace(uts\uff09 \u9694\u79bb\u4e3b\u673a\u540d\u548c\u57df\u540d 2.6.19 User Namespace(user\uff09 \u9694\u79bb\u7528\u6237\u548c\u7528\u6237\u7ec4 3.8 Control group (cgroup) Namespace \u9694\u79bbCgroups\u6839\u76ee\u5f55 4.6 Time Namespace \u9694\u79bb\u7cfb\u7edf\u65f6\u95f4 5.6 <p>\u867d\u7136 Linux \u5185\u6838\u63d0\u4f9b\u4e868\u79cd Namespace\uff0c\u4f46\u662f\u6700\u65b0\u7248\u672c\u7684 Docker \u53ea\u4f7f\u7528\u4e86\u5176\u4e2d\u7684\u524d6 \u79cd\uff0c\u5206\u522b\u4e3aMount Namespace\u3001PID Namespace\u3001Net Namespace\u3001IPC Namespace\u3001UTS Namespace\u3001User Namespace\u3002 </p> <p>\u4ece3.8\u7248\u672c\u7684\u5185\u6838\u5f00\u59cb\uff0c\u7528\u6237\u53ef\u4ee5\u5728/proc/[pid]/ns\u76ee\u5f55\u4e0b\u770b\u5230\u6307\u5411\u4e0d\u540cnamespace\u7684\u6587\u4ef6\uff0c\u6548\u679c\u5982\u4e0b\u56fe\uff0c\u5f62\u5982[4026531839]\u8005\u5373\u4e3anamespace\u53f7\u3002</p> <pre><code>[root@localhost ~]# ls -l /proc/1061/ns\ntotal 0\nlrwxrwxrwx. 1 root root 0 Oct 29 23:12 ipc -&gt; ipc:[4026531839]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:12 mnt -&gt; mnt:[4026531840]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:12 net -&gt; net:[4026531956]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:12 pid -&gt; pid:[4026531836]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:12 user -&gt; user:[4026531837]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:12 uts -&gt; uts:[4026531838]\n</code></pre> <p>\u5982\u679c\u4e24\u4e2a\u8fdb\u7a0b\u6307\u5411\u7684namespace\u7f16\u53f7\u76f8\u540c\uff0c\u5c31\u8bf4\u660e\u5b83\u4eec\u5728\u540c\u4e00\u4e2anamespace\u4e0b\uff0c\u5426\u5219\u4fbf\u5728\u4e0d\u540cnamespace\u91cc\u9762\u3002 </p>"},{"location":"DevOps/Docker/underlyingtechnology/#1-mount-namespace","title":"1. Mount Namespace","text":"<p>Mount Namespace \u662f Linux \u5185\u6838\u5b9e\u73b0\u7684\u7b2c\u4e00\u4e2a Namespace\uff0c\u4ece\u5185\u6838\u7684 2.4.19 \u7248\u672c\u5f00\u59cb\u52a0\u5165\u3002\u5b83\u53ef\u4ee5\u7528\u6765\u9694\u79bb\u4e0d\u540c\u7684\u8fdb\u7a0b\u6216\u8fdb\u7a0b\u7ec4\u770b\u5230\u7684\u6302\u8f7d\u70b9\u3002\u901a\u4fd7\u5730\u8bf4\uff0c\u5c31\u662f\u53ef\u4ee5\u5b9e\u73b0\u5728\u4e0d\u540c\u7684\u8fdb\u7a0b\u4e2d\u770b\u5230\u4e0d\u540c\u7684\u6302\u8f7d\u76ee\u5f55\u3002\u4f7f\u7528 Mount Namespace \u53ef\u4ee5\u5b9e\u73b0\u5bb9\u5668\u5185\u53ea\u80fd\u770b\u5230\u81ea\u5df1\u7684\u6302\u8f7d\u4fe1\u606f\uff0c\u5728\u5bb9\u5668\u5185\u7684\u6302\u8f7d\u64cd\u4f5c\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u673a\u7684\u6302\u8f7d\u76ee\u5f55\u3002</p> <p>Mount Namespace\u6f14\u793a</p> <p>unshare \u662f util-linux \u5de5\u5177\u5305\u4e2d\u7684\u4e00\u4e2a\u5de5\u5177\uff0cCentOS 7 \u7cfb\u7edf\u9ed8\u8ba4\u5df2\u7ecf\u96c6\u6210\u4e86\u8be5\u5de5\u5177\uff0c\u4f7f\u7528 unshare \u547d\u4ee4\u53ef\u4ee5\u5b9e\u73b0\u521b\u5efa\u5e76\u8bbf\u95ee\u4e0d\u540c\u7c7b\u578b\u7684 Namespace\u3002</p> <p>\u9996\u5148\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a bash \u8fdb\u7a0b\u5e76\u4e14\u65b0\u5efa\u4e00\u4e2a Mount Namespace\uff1a</p> <pre><code>unshare --mount --fork /bin/bash\n</code></pre> <p>\u6267\u884c\u5b8c\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0c\u8fd9\u65f6\u6211\u4eec\u5df2\u7ecf\u5728\u4e3b\u673a\u4e0a\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 Mount Namespace\uff0c\u5e76\u4e14\u5f53\u524d\u547d\u4ee4\u884c\u7a97\u53e3\u52a0\u5165\u4e86\u65b0\u521b\u5efa\u7684 Mount Namespace\u3002</p> <p>\u5728\u72ec\u7acb\u7684 Mount Namespace \u5185\u521b\u5efa\u6302\u8f7d\u76ee\u5f55\u662f\u4e0d\u5f71\u54cd\u4e3b\u673a\u7684\u6302\u8f7d\u76ee\u5f55\u7684\u3002</p> <pre><code>[root@localhost ~]# mkdir /tmp/tmpfs\n[root@localhost ~]# # \u4f7f\u7528 mount \u547d\u4ee4\u6302\u8f7d\u4e00\u4e2a tmpfs \u7c7b\u578b\u7684\u76ee\u5f55\n[root@localhost ~]# mount -t tmpfs -o size=20m tmpfs /tmp/tmpfs\n[root@localhost ~]# df -h\nFilesystem               Size  Used Avail Use% Mounted on\n/dev/mapper/centos-root   37G  2.5G   35G   7% /\ndevtmpfs                 898M     0  898M   0% /dev\ntmpfs                    910M     0  910M   0% /dev/shm\ntmpfs                    910M     0  910M   0% /sys/fs/cgroup\ntmpfs                    910M  9.6M  901M   2% /run\ntmpfs                    182M     0  182M   0% /run/user/0\n/dev/sda1               1014M  151M  864M  15% /boot\ntmpfs                     20M     0   20M   0% /tmp/tmpfs\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 /tmp/tmpfs \u76ee\u5f55\u5df2\u7ecf\u88ab\u6b63\u786e\u6302\u8f7d\u3002</p> <p>\u65b0\u6253\u5f00\u4e00\u4e2a\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u540c\u6837\u6267\u884c df -h\u547d\u4ee4\u67e5\u770b\u4e3b\u673a\u7684\u6302\u8f7d\u4fe1\u606f\uff1a</p> <pre><code>[root@localhost ~]# df -h\nFilesystem               Size  Used Avail Use% Mounted on\ndevtmpfs                 898M     0  898M   0% /dev\ntmpfs                    910M     0  910M   0% /dev/shm\ntmpfs                    910M  9.6M  901M   2% /run\ntmpfs                    910M     0  910M   0% /sys/fs/cgroup\n/dev/mapper/centos-root   37G  2.5G   35G   7% /\n/dev/sda1               1014M  151M  864M  15% /boot\ntmpfs                    182M     0  182M   0% /run/user/0\n</code></pre> <p>\u901a\u8fc7\u4e0a\u9762\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\u4e3b\u673a\u4e0a\u5e76\u6ca1\u6709\u6302\u8f7d /tmp/tmpfs\uff0c\u53ef\u89c1\u6211\u4eec\u72ec\u7acb\u7684 Mount Namespace \u4e2d\u6267\u884c mount \u64cd\u4f5c\u5e76\u4e0d\u4f1a\u5f71\u54cd\u4e3b\u673a\u3002</p> <p>\u6211\u4eec\u7ee7\u7eed\u5728\u5f53\u524d\u547d\u4ee4\u884c\u7a97\u53e3\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u8fdb\u7a0b\u7684 Namespace \u4fe1\u606f\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@localhost ~]# ls -l /proc/$$/ns/\ntotal 0\nlrwxrwxrwx. 1 root root 0 Oct 29 23:21 ipc -&gt; ipc:[4026531839]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:21 mnt -&gt; mnt:[4026532494]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:21 net -&gt; net:[4026531956]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:21 pid -&gt; pid:[4026531836]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:21 user -&gt; user:[4026531837]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:21 uts -&gt; uts:[4026531838]\n</code></pre> <p>\u7136\u540e\u65b0\u6253\u5f00\u4e00\u4e2a\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u4f7f\u7528\u76f8\u540c\u7684\u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u4e3b\u673a\u4e0a\u7684 Namespace \u4fe1\u606f\uff1a</p> <pre><code>[root@localhost ~]# ls -l /proc/$$/ns/\ntotal 0\nlrwxrwxrwx. 1 root root 0 Oct 29 23:22 ipc -&gt; ipc:[4026531839]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:22 mnt -&gt; mnt:[4026531840]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:22 net -&gt; net:[4026531956]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:22 pid -&gt; pid:[4026531836]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:22 user -&gt; user:[4026531837]\nlrwxrwxrwx. 1 root root 0 Oct 29 23:22 uts -&gt; uts:[4026531838]\n</code></pre> <p>\u901a\u8fc7\u5bf9\u6bd4\u4e24\u6b21\u547d\u4ee4\u7684\u8f93\u51fa\u7ed3\u679c\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u9664\u4e86 Mount Namespace \u7684 ID \u503c\u4e0d\u4e00\u6837\u5916\uff0c\u5176\u4ed6Namespace \u7684 ID \u503c\u5747\u4e00\u81f4\u3002</p> <p>\u901a\u8fc7\u4ee5\u4e0a\u7ed3\u679c\u6211\u4eec\u53ef\u4ee5\u5f97\u51fa\u7ed3\u8bba\uff0c\u4f7f\u7528 unshare \u547d\u4ee4\u53ef\u4ee5\u65b0\u5efa Mount Namespace\uff0c\u5e76\u4e14\u5728\u65b0\u5efa\u7684 Mount Namespace \u5185 mount \u662f\u548c\u5916\u90e8\u5b8c\u5168\u9694\u79bb\u7684\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#2-pid-namespace","title":"2. PID Namespace","text":"<p>PID Namespace \u7684\u4f5c\u7528\u662f\u7528\u6765\u9694\u79bb\u8fdb\u7a0b\u3002\u5728\u4e0d\u540c\u7684 PID Namespace \u4e2d\uff0c\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709\u76f8\u540c\u7684 PID \u53f7\uff0c\u5229\u7528 PID Namespace \u53ef\u4ee5\u5b9e\u73b0\u6bcf\u4e2a\u5bb9\u5668\u7684\u4e3b\u8fdb\u7a0b\u4e3a 1 \u53f7\u8fdb\u7a0b\uff0c\u800c\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b\u5728\u4e3b\u673a\u4e0a\u5374\u62e5\u6709\u4e0d\u540c\u7684PID\u3002\u4f8b\u5982\u4e00\u4e2a\u8fdb\u7a0b\u5728\u4e3b\u673a\u4e0a PID \u4e3a 122\uff0c\u4f7f\u7528 PID Namespace \u53ef\u4ee5\u5b9e\u73b0\u8be5\u8fdb\u7a0b\u5728\u5bb9\u5668\u5185\u770b\u5230\u7684 PID \u4e3a 1\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a bash \u8fdb\u7a0b\uff0c\u5e76\u4e14\u65b0\u5efa\u4e00\u4e2a PID Namespace\uff1a</p> <pre><code>unshare --pid --fork --mount-proc /bin/bash\n</code></pre> <p>\u6267\u884c\u5b8c\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0c\u6211\u4eec\u5728\u4e3b\u673a\u4e0a\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 PID Namespace\uff0c\u5e76\u4e14\u5f53\u524d\u547d\u4ee4\u884c\u7a97\u53e3\u52a0\u5165\u4e86\u65b0\u521b\u5efa\u7684 PID Namespace\u3002\u5728\u5f53\u524d\u7684\u547d\u4ee4\u884c\u7a97\u53e3\u4f7f\u7528 ps aux \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u8fdb\u7a0b\u4fe1\u606f\uff1a</p> <pre><code>root@localhost ~]# ps aux\nUSER        PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot          1  0.0  0.1 115548  2096 pts/0    S    23:24   0:00 /bin/bash\nroot         12  0.0  0.0 155452  1856 pts/0    R+   23:24   0:00 ps aux\n</code></pre> <p>\u901a\u8fc7\u4e0a\u8ff0\u547d\u4ee4\u8f93\u51fa\u7ed3\u679c\u53ef\u4ee5\u770b\u5230\u5f53\u524d Namespace \u4e0b bash \u4e3a 1 \u53f7\u8fdb\u7a0b\uff0c\u800c\u4e14\u6211\u4eec\u4e5f\u770b\u4e0d\u5230\u4e3b\u673a\u4e0a\u7684\u5176\u4ed6\u8fdb\u7a0b\u4fe1\u606f\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#3-uts-namespace","title":"3. UTS Namespace","text":"<p>UTS Namespace \u4e3b\u8981\u662f\u7528\u6765\u9694\u79bb\u4e3b\u673a\u540d\u7684\uff0c\u5b83\u5141\u8bb8\u6bcf\u4e2a UTS Namespace \u62e5\u6709\u4e00\u4e2a\u72ec\u7acb\u7684\u4e3b\u673a\u540d\u3002\u4f8b\u5982\u6211\u4eec\u7684\u4e3b\u673a\u540d\u79f0\u4e3a docker\uff0c\u4f7f\u7528UTS Namespace\u53ef\u4ee5\u5b9e\u73b0\u5728\u5bb9\u5668\u5185\u7684\u4e3b\u673a\u540d\u79f0\u4e3a mydocker\u6216\u8005\u5176\u4ed6\u4efb\u610f\u81ea\u5b9a\u4e49\u4e3b\u673a\u540d\u3002</p> <p>\u4f7f\u7528 unshare \u547d\u4ee4\u6765\u521b\u5efa\u4e00\u4e2a UTS Namespace\uff1a</p> <pre><code>unshare --uts --fork /bin/bash\n</code></pre> <p>\u521b\u5efa\u597d UTS Namespace \u540e\uff0c\u5f53\u524d\u547d\u4ee4\u884c\u7a97\u53e3\u5df2\u7ecf\u5904\u4e8e\u4e00\u4e2a\u72ec\u7acb\u7684 UTS Namespace \u4e2d\uff0c\u4f7f\u7528 hostname \u547d\u4ee4\u8bbe\u7f6e\u4e00\u4e0b\u4e3b\u673a\u540d\uff1a</p> <pre><code>[root@localhost ~]# hostname -b docker\n[root@localhost ~]# hostname\ndocker\n</code></pre> <p>\u901a\u8fc7\u4e0a\u9762\u547d\u4ee4\u7684\u8f93\u51fa\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5f53\u524dUTS Namespace \u5185\u7684\u4e3b\u673a\u540d\u5df2\u7ecf\u88ab\u4fee\u6539\u4e3adocker\u3002\u7136\u540e\u6211\u4eec\u65b0\u6253\u5f00\u4e00\u4e2a\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u4f7f\u7528\u76f8\u540c\u7684\u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u4e3b\u673a\u7684 hostname\uff1a</p> <pre><code>[root@localhost ~]# hostname\nlocalhost\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u4e3b\u673a\u7684\u540d\u79f0\u4ecd\u7136\u4e3a localhost\uff0c\u5e76\u6ca1\u6709\u88ab\u4fee\u6539\u3002\u53ef\u89c1UTS Namespace\u53ef\u4ee5\u7528\u6765\u9694\u79bb\u4e3b\u673a\u540d\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#4-ipc-namespace","title":"4. IPC Namespace","text":"<p>IPC Namespace \u4e3b\u8981\u662f\u7528\u6765\u9694\u79bb\u8fdb\u7a0b\u95f4\u901a\u4fe1\u7684\u3002\u4f8b\u5982 PID Namespace \u548c IPC Namespace \u4e00\u8d77\u4f7f\u7528\u53ef\u4ee5\u5b9e\u73b0\u540c\u4e00 IPC Namespace \u5185\u7684\u8fdb\u7a0b\u5f7c\u6b64\u53ef\u4ee5\u901a\u4fe1\uff0c\u4e0d\u540c IPC Namespace \u7684\u8fdb\u7a0b\u5374\u4e0d\u80fd\u901a\u4fe1\u3002</p> <p>\u4f7f\u7528 unshare \u547d\u4ee4\u6765\u521b\u5efa\u4e00\u4e2a IPC Namespace\uff1a</p> <pre><code>unshare --ipc --fork /bin/bash\n</code></pre> <p>\u67e5\u770b\u7cfb\u7edf\u95f4\u901a\u4fe1\u961f\u5217\u5217\u8868</p> <pre><code>[root@localhost ~]# ipcs -q\n\n------ Message Queues --------\nkey        msqid      owner      perms      used-bytes   messages \n</code></pre> <p>\u521b\u5efa\u7cfb\u7edf\u95f4\u901a\u4fe1\u961f\u5217</p> <pre><code>[root@localhost ~]# ipcmk -Q\nMessage queue id: 0\n</code></pre> <p>\u518d\u6b21\u67e5\u770b\u5f53\u524dIPC Namespace\u4e0b\u7684\u7cfb\u7edf\u901a\u4fe1\u961f\u5217\u5217\u8868\uff1a</p> <pre><code>[root@localhost ~]# ipcs -q\n\n------ Message Queues --------\nkey        msqid      owner      perms      used-bytes   messages    \n0x255268e0 0          root       644        0            0 \n</code></pre> <p>\u5f53\u524d\u5df2\u7ecf\u6210\u529f\u521b\u5efa\u4e86\u4e00\u4e2a\u7cfb\u7edf\u901a\u4fe1\u961f\u5217\u3002\u65b0\u6253\u5f00\u4e00\u4e2a\u547d\u4ee4\u884c\u7a97\u53e3\uff0c\u4f7f\u7528ipcs -q \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u4e3b\u673a\u7684\u7cfb\u7edf\u901a\u4fe1\u961f\u5217\uff1a</p> <pre><code>[root@192 ~]# ipcs -q \n\n------ Message Queues --------\nkey        msqid      owner      perms      used-bytes   messages\n</code></pre> <p>\u5728\u5355\u72ec\u7684 IPC Namespace\u5185\u521b\u5efa\u7684\u7cfb\u7edf\u901a\u4fe1\u961f\u5217\u5728\u4e3b\u673a\u4e0a\u65e0\u6cd5\u770b\u5230\u3002\u5373 IPC Namespace \u5b9e\u73b0\u4e86\u7cfb\u7edf\u901a\u4fe1\u961f\u5217\u7684\u9694\u79bb\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#5-user-namespace","title":"5. User Namespace","text":"<p>User Namespace\u4e3b\u8981\u662f\u7528\u6765\u9694\u79bb\u7528\u6237\u548c\u7528\u6237\u7ec4\u7684\u3002\u4e00\u4e2a\u6bd4\u8f83\u5178\u578b\u7684\u5e94\u7528\u573a\u666f\u5c31\u662f\u5728\u4e3b\u673a\u4e0a\u4ee5\u975eroot\u7528\u6237\u8fd0\u884c\u7684\u8fdb\u7a0b\u53ef\u4ee5\u5728\u4e00\u4e2a\u5355\u72ec\u7684User Namespace\u4e2d\u6620\u5c04\u6210root\u7528\u6237\u3002\u4f7f\u7528User Namespace\u53ef\u4ee5\u5b9e\u73b0\u8fdb\u7a0b\u5728\u5bb9\u5668\u5185\u62e5\u6709 root \u6743\u9650\uff0c\u800c\u5728\u4e3b\u673a\u4e0a\u5374\u53ea\u662f\u666e\u901a\u7528\u6237\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a User Namespace\uff1a</p> <pre><code>[centos@localhost ~]$ unshare --user -r /bin/bash\n[root@localhost ~]# \n</code></pre> <p>CentOS7 \u9ed8\u8ba4\u5141\u8bb8\u521b\u5efa\u7684 User Namespace \u4e3a 0\uff0c\u5982\u679c\u6267\u884c\u4e0a\u8ff0\u547d\u4ee4\u5931\u8d25\uff08 unshare \u547d\u4ee4\u8fd4\u56de\u7684\u9519\u8bef\u4e3a unshare: unshare failed: Invalid argument \uff09\uff0c\u9700\u8981\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4fee\u6539\u7cfb\u7edf\u5141\u8bb8\u521b\u5efa\u7684 User Namespace \u6570\u91cf\uff0c\u547d\u4ee4\u4e3a\uff1aecho 65535 &gt; /proc/sys/user/max_user_namespaces\uff0c\u7136\u540e\u518d\u6b21\u5c1d\u8bd5\u521b\u5efa User Namespace\u3002</p> <p>\u7136\u540e\u6267\u884c id \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u7684\u7528\u6237\u4fe1\u606f\uff1a</p> <pre><code>[root@localhost ~]# id\nuid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\n</code></pre> <p>\u901a\u8fc7\u4e0a\u9762\u7684\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\u5728\u65b0\u7684User Namespace\u5185\u5df2\u7ecf\u662froot\u7528\u6237\u4e86\u3002\u4f7f\u7528\u53ea\u6709\u4e3b\u673aroot\u7528\u6237\u624d\u53ef\u4ee5\u6267\u884c\u7684reboot\u547d\u4ee4\u6765\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u5728\u5f53\u524d\u547d\u4ee4\u884c\u7a97\u53e3\u6267\u884c reboot \u547d\u4ee4\uff1a</p> <pre><code>[root@localhost ~]# reboot\nFailed to open /dev/initctl: Permission denied\nFailed to talk to init daemon.\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u65b0\u521b\u5efa\u7684User Namespace\u5185\u867d\u7136\u662f root \u7528\u6237\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u6743\u9650\u6267\u884creboot\u547d\u4ee4\u3002\u8fd9\u8bf4\u660e\u5728\u9694\u79bb\u7684User Namespace\u4e2d\uff0c\u5e76\u4e0d\u80fd\u83b7\u53d6\u5230\u4e3b\u673a\u7684root\u6743\u9650\uff0c\u4e5f\u5c31\u662f\u8bf4User Namespace\u5b9e\u73b0\u4e86\u7528\u6237\u548c\u7528\u6237\u7ec4\u7684\u9694\u79bb\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#6-net-namespace","title":"6. Net Namespace","text":"<p>Net Namespace \u662f\u7528\u6765\u9694\u79bb\u7f51\u7edc\u8bbe\u5907\u3001IP \u5730\u5740\u548c\u7aef\u53e3\u7b49\u4fe1\u606f\u7684\u3002Net Namespace \u53ef\u4ee5\u8ba9\u6bcf\u4e2a\u8fdb\u7a0b\u62e5\u6709\u81ea\u5df1\u72ec\u7acb\u7684 IP \u5730\u5740\uff0c\u7aef\u53e3\u548c\u7f51\u5361\u4fe1\u606f\u3002\u4f8b\u5982\u4e3b\u673a IP \u5730\u5740\u4e3a 172.16.4.1 \uff0c\u5bb9\u5668\u5185\u53ef\u4ee5\u8bbe\u7f6e\u72ec\u7acb\u7684 IP \u5730\u5740\u4e3a 192.168.1.1\u3002</p> <p>\u540c\u6837\u7528\u5b9e\u4f8b\u9a8c\u8bc1\uff0c\u6211\u4eec\u9996\u5148\u4f7f\u7528 ip a \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u4e3b\u673a\u4e0a\u7684\u7f51\u7edc\u4fe1\u606f\uff1a</p> <pre><code>[root@localhost ~]# ip a\n1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000\n    link/ether 00:0c:29:a8:63:dc brd ff:ff:ff:ff:ff:ff\n    inet 192.168.1.136/24 brd 192.168.1.255 scope global noprefixroute dynamic ens33\n       valid_lft 1092sec preferred_lft 1092sec\n    inet6 fe80::f4d6:a364:587f:861b/64 scope link noprefixroute \n       valid_lft forever preferred_lft forever\n3: docker0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc noqueue state DOWN group default \n    link/ether 02:42:42:44:05:d1 brd ff:ff:ff:ff:ff:ff\n    inet 172.17.0.1/16 brd 172.17.255.255 scope global docker0\n       valid_lft forever preferred_lft forever\n</code></pre> <p>\u521b\u5efa\u4e00\u4e2a Net Namespace\uff1a</p> <pre><code>unshare --net --fork /bin/bash\n</code></pre> <p>\u4f7f\u7528 ip a \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u7f51\u7edc\u4fe1\u606f\uff1a</p> <pre><code>[root@localhost ~]# ip a\n1: lo: &lt;LOOPBACK&gt; mtu 65536 qdisc noop state DOWN group default qlen 1000\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5bbf\u4e3b\u673a\u4e0a\u6709 lo\u3001eth0\u3001docker0 \u7b49\u7f51\u7edc\u8bbe\u5907\uff0c\u800c\u65b0\u5efa\u7684 Net Namespace \u5185\u5219\u4e0e\u4e3b\u673a\u4e0a\u7684\u7f51\u7edc\u8bbe\u5907\u4e0d\u540c\u3002</p> <p>\u4f7f\u7528\u4e0d\u540c\u7684 Namespace\uff0c\u53ef\u4ee5\u5b9e\u73b0\u5bb9\u5668\u4e2d\u7684\u8fdb\u7a0b\u770b\u4e0d\u5230\u522b\u7684\u5bb9\u5668\u7684\u8d44\u6e90\uff0c\u4f46\u662f\u6709\u4e00\u4e2a\u95ee\u9898\u4f60\u662f\u5426\u6ce8\u610f\u5230\uff1f\u5bb9\u5668\u5185\u7684\u8fdb\u7a0b\u4ecd\u7136\u53ef\u4ee5\u4efb\u610f\u5730\u4f7f\u7528\u4e3b\u673a\u7684 CPU \u3001\u5185\u5b58\u7b49\u8d44\u6e90\uff0c\u5982\u679c\u67d0\u4e00\u4e2a\u5bb9\u5668\u4f7f\u7528\u7684\u4e3b\u673a\u8d44\u6e90\u8fc7\u591a\uff0c\u53ef\u80fd\u5bfc\u81f4\u4e3b\u673a\u7684\u8d44\u6e90\u7ade\u4e89\uff0c\u8fdb\u800c\u5f71\u54cd\u4e1a\u52a1\u3002\u90a3\u5982\u679c\u6211\u4eec\u60f3\u9650\u5236\u4e00\u4e2a\u5bb9\u5668\u8d44\u6e90\u7684\u4f7f\u7528\uff08\u5982 CPU\u3001\u5185\u5b58\u7b49\uff09\u5e94\u8be5\u5982\u4f55\u505a\u5462\uff1f</p> <p>\u8fd9\u91cc\u5c31\u9700\u8981\u7528\u5230 Linux \u5185\u6838\u7684\u53e6\u4e00\u4e2a\u6838\u5fc3\u6280\u672fcgroups\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#cgroups","title":"\u4e8c\u3001cgroups","text":"<p>cgroups\uff08\u5168\u79f0\uff1acontrol groups\uff09\u662f Linux \u5185\u6838\u7684\u4e00\u4e2a\u529f\u80fd\uff0c\u5b83\u53ef\u4ee5\u5b9e\u73b0\u9650\u5236\u8fdb\u7a0b\u6216\u8005\u8fdb\u7a0b\u7ec4\u7684\u8d44\u6e90\uff08\u5982 CPU\u3001\u5185\u5b58\u3001\u78c1\u76d8 IO \u7b49\uff09\u3002</p> <p>\u5728 2006 \u5e74\uff0cGoogle \u7684\u5de5\u7a0b\u5e08\uff08 Rohit Seth \u548c Paul Menage \u4e3a\u4e3b\u8981\u53d1\u8d77\u4eba\uff09 \u53d1\u8d77\u4e86\u8fd9\u4e2a\u9879\u76ee\uff0c\u8d77\u521d\u9879\u76ee\u540d\u79f0\u5e76\u4e0d\u662fcgroups\uff0c\u800c\u88ab\u79f0\u4e3a\u8fdb\u7a0b\u5bb9\u5668\uff08process containers\uff09\u3002\u5728 2007 \u5e74cgroups\u4ee3\u7801\u8ba1\u5212\u5408\u5165Linux \u5185\u6838\uff0c\u4f46\u662f\u5f53\u65f6\u5728 Linux \u5185\u6838\u4e2d\uff0c\u5bb9\u5668\uff08container\uff09\u8fd9\u4e2a\u8bcd\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c\u5e76\u4e14\u62e5\u6709\u4e0d\u540c\u7684\u542b\u4e49\u3002\u4e3a\u4e86\u907f\u514d\u547d\u540d\u6df7\u4e71\u548c\u6b67\u4e49\uff0c\u8fdb\u7a0b\u5bb9\u5668\u88ab\u91cd\u540d\u4e3acgroups\uff0c\u5e76\u5728 2008 \u5e74\u6210\u529f\u5408\u5165 Linux 2.6.24 \u7248\u672c\u4e2d\u3002cgroups\u76ee\u524d\u5df2\u7ecf\u6210\u4e3a systemd\u3001Docker\u3001Linux Containers\uff08LXC\uff09 \u7b49\u6280\u672f\u7684\u57fa\u7840\u3002</p> <p>cgroups \u4e3b\u8981\u63d0\u4f9b\u4e86\u5982\u4e0b\u529f\u80fd\uff1a</p> <ol> <li>\u8d44\u6e90\u9650\u5236\uff1a \u9650\u5236\u8d44\u6e90\u7684\u4f7f\u7528\u91cf\uff0c\u4f8b\u5982\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u9650\u5236\u67d0\u4e2a\u4e1a\u52a1\u7684\u5185\u5b58\u4e0a\u9650\uff0c\u4ece\u800c\u4fdd\u62a4\u4e3b\u673a\u5176\u4ed6\u4e1a\u52a1\u7684\u5b89\u5168\u8fd0\u884c\u3002</li> <li>\u4f18\u5148\u7ea7\u63a7\u5236\uff1a\u4e0d\u540c\u7684\u7ec4\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u8d44\u6e90\uff08 CPU \u3001\u78c1\u76d8 IO \u7b49\uff09\u4f7f\u7528\u4f18\u5148\u7ea7\u3002</li> <li>\u5ba1\u8ba1\uff1a\u8ba1\u7b97\u63a7\u5236\u7ec4\u7684\u8d44\u6e90\u4f7f\u7528\u60c5\u51b5\u3002</li> <li>\u63a7\u5236\uff1a\u63a7\u5236\u8fdb\u7a0b\u7684\u6302\u8d77\u6216\u6062\u590d\u3002</li> </ol> <p>cgroups\u529f\u80fd\u7684\u5b9e\u73b0\u4f9d\u8d56\u4e8e\u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5\uff1a\u5b50\u7cfb\u7edf\u3001\u63a7\u5236\u7ec4\u3001\u5c42\u7ea7\u6811\u3002</p> <ol> <li> <p>\u5b50\u7cfb\u7edf\uff08subsystem\uff09\uff1a\u662f\u4e00\u4e2a\u5185\u6838\u7684\u7ec4\u4ef6\uff0c\u4e00\u4e2a\u5b50\u7cfb\u7edf\u4ee3\u8868\u4e00\u7c7b\u8d44\u6e90\u8c03\u5ea6\u63a7\u5236\u5668\u3002\u4f8b\u5982\u5185\u5b58\u5b50\u7cfb\u7edf\u53ef\u4ee5\u9650\u5236\u5185\u5b58\u7684\u4f7f\u7528\u91cf\uff0cCPU \u5b50\u7cfb\u7edf\u53ef\u4ee5\u9650\u5236 CPU \u7684\u4f7f\u7528\u65f6\u95f4\u3002</p> </li> <li> <p>\u63a7\u5236\u7ec4\uff08cgroup\uff09\uff1a\u8868\u793a\u4e00\u7ec4\u8fdb\u7a0b\u548c\u4e00\u7ec4\u5e26\u6709\u53c2\u6570\u7684\u5b50\u7cfb\u7edf\u7684\u5173\u8054\u5173\u7cfb\u3002\u4f8b\u5982\uff0c\u4e00\u4e2a\u8fdb\u7a0b\u4f7f\u7528\u4e86 CPU \u5b50\u7cfb\u7edf\u6765\u9650\u5236 CPU \u7684\u4f7f\u7528\u65f6\u95f4\uff0c\u5219\u8fd9\u4e2a\u8fdb\u7a0b\u548c CPU \u5b50\u7cfb\u7edf\u7684\u5173\u8054\u5173\u7cfb\u79f0\u4e3a\u63a7\u5236\u7ec4\u3002</p> </li> <li> <p>\u5c42\u7ea7\u6811\uff08hierarchy\uff09\uff1a\u662f\u7531\u4e00\u7cfb\u5217\u7684\u63a7\u5236\u7ec4\u6309\u7167\u6811\u72b6\u7ed3\u6784\u6392\u5217\u7ec4\u6210\u7684\u3002\u8fd9\u79cd\u6392\u5217\u65b9\u5f0f\u53ef\u4ee5\u4f7f\u5f97\u63a7\u5236\u7ec4\u62e5\u6709\u7236\u5b50\u5173\u7cfb\uff0c\u5b50\u63a7\u5236\u7ec4\u9ed8\u8ba4\u62e5\u6709\u7236\u63a7\u5236\u7ec4\u7684\u5c5e\u6027\uff0c\u4e5f\u5c31\u662f\u5b50\u63a7\u5236\u7ec4\u4f1a\u7ee7\u627f\u4e8e\u7236\u63a7\u5236\u7ec4\u3002\u6bd4\u5982\uff0c\u7cfb\u7edf\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u63a7\u5236\u7ec4c1\uff0c\u9650\u5236\u4e86CPU\u53ef\u4ee5\u4f7f\u75281\u6838\uff0c\u7136\u540e\u53e6\u5916\u4e00\u4e2a\u63a7\u5236\u7ec4c2\u60f3\u5b9e\u73b0\u65e2\u9650\u5236CPU \u4f7f\u75281\u6838\uff0c\u540c\u65f6\u9650\u5236\u5185\u5b58\u4f7f\u75282G\uff0c\u90a3\u4e48c2\u5c31\u53ef\u4ee5\u76f4\u63a5\u7ee7\u627fc1\uff0c\u65e0\u987b\u91cd\u590d\u5b9a\u4e49CPU\u9650\u5236\u3002</p> </li> </ol> <p>cgroups \u7684\u4e09\u4e2a\u6838\u5fc3\u6982\u5ff5\u4e2d\uff0c\u5b50\u7cfb\u7edf\u662f\u6700\u6838\u5fc3\u7684\u6982\u5ff5\uff0c\u56e0\u4e3a\u5b50\u7cfb\u7edf\u662f\u771f\u6b63\u5b9e\u73b0\u67d0\u7c7b\u8d44\u6e90\u7684\u9650\u5236\u7684\u57fa\u7840\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#1-cgroups","title":"1. cgroups \u5b50\u7cfb\u7edf\u5b9e\u4f8b","text":"<p>mount \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u5f53\u524d\u7cfb\u7edf\u5df2\u7ecf\u6302\u8f7d\u7684cgroups\u4fe1\u606f\uff1a</p> <pre><code>[root@localhost ~]# mount -t cgroup\ncgroup on /sys/fs/cgroup/systemd type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,xattr,release_agent=/usr/lib/systemd/systemd-cgroups-agent,name=systemd)\ncgroup on /sys/fs/cgroup/freezer type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,freezer)\ncgroup on /sys/fs/cgroup/net_cls,net_prio type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,net_prio,net_cls)\ncgroup on /sys/fs/cgroup/perf_event type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,perf_event)\ncgroup on /sys/fs/cgroup/devices type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,devices)\ncgroup on /sys/fs/cgroup/cpu,cpuacct type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,cpuacct,cpu)\ncgroup on /sys/fs/cgroup/pids type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,pids)\ncgroup on /sys/fs/cgroup/hugetlb type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,hugetlb)\ncgroup on /sys/fs/cgroup/memory type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,memory)\ncgroup on /sys/fs/cgroup/cpuset type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,cpuset)\ncgroup on /sys/fs/cgroup/blkio type cgroup (rw,nosuid,nodev,noexec,relatime,seclabel,blkio)\n</code></pre> <p>\u901a\u8fc7\u8f93\u51fa\uff0c\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7cfb\u7edf\u5df2\u7ecf\u6302\u8f7d\u4e86\u6211\u4eec\u5e38\u7528\u7684cgroups\u5b50\u7cfb\u7edf\uff0c\u4f8b\u5982 cpu\u3001memory\u3001pids \u7b49\u6211\u4eec\u5e38\u7528\u7684cgroups\u5b50\u7cfb\u7edf\u3002</p> <p>\u8fd9\u4e9b\u5b50\u7cfb\u7edf\u4e2d\uff0ccpu \u548c memory \u5b50\u7cfb\u7edf\u662f\u5bb9\u5668\u73af\u5883\u4e2d\u4f7f\u7528\u6700\u591a\u7684\u5b50\u7cfb\u7edf\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#11-cpu","title":"1.1 cpu \u5b50\u7cfb\u7edf","text":""},{"location":"DevOps/Docker/underlyingtechnology/#cpu-cgroup","title":"\u7b2c\u4e00\u6b65\uff1a\u5728 cpu \u5b50\u7cfb\u7edf\u4e0b\u521b\u5efa cgroup","text":"<p>\u5728\u76f8\u5e94\u7684\u5b50\u7cfb\u7edf\u4e0b\u521b\u5efa\u76ee\u5f55\u5373\u53ef</p> <pre><code>mkdir /sys/fs/cgroup/cpu/mydocker\n</code></pre> <p>\u67e5\u770b\u4e00\u4e0b\u65b0\u521b\u5efa\u7684\u76ee\u5f55\u53d8\u5316</p> <pre><code>[root@localhost ~]# ls -l /sys/fs/cgroup/cpu/mydocker\ntotal 0\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cgroup.clone_children\n--w--w--w-. 1 root root 0 Oct 30 22:41 cgroup.event_control\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cgroup.procs\n-r--r--r--. 1 root root 0 Oct 30 22:41 cpuacct.stat\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cpuacct.usage\n-r--r--r--. 1 root root 0 Oct 30 22:41 cpuacct.usage_percpu\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cpu.cfs_period_us\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cpu.cfs_quota_us\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cpu.rt_period_us\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cpu.rt_runtime_us\n-rw-r--r--. 1 root root 0 Oct 30 22:41 cpu.shares\n-r--r--r--. 1 root root 0 Oct 30 22:41 cpu.stat\n-rw-r--r--. 1 root root 0 Oct 30 22:41 notify_on_release\n-rw-r--r--. 1 root root 0 Oct 30 22:41 tasks\n</code></pre> <p>\u7531\u4e0a\u53ef\u4ee5\u770b\u5230\u6211\u4eec\u65b0\u5efa\u7684\u76ee\u5f55\u4e0b\u88ab\u81ea\u52a8\u521b\u5efa\u4e86\u5f88\u591a\u6587\u4ef6\uff0c\u5176\u4e2d cpu.cfs_quota_us \u6587\u4ef6\u4ee3\u8868\u5728\u67d0\u4e00\u4e2a\u9636\u6bb5\u9650\u5236\u7684 CPU \u65f6\u95f4\u603b\u91cf\uff0c\u5355\u4f4d\u4e3a\u5fae\u79d2\u3002\u4f8b\u5982\uff0c\u6211\u4eec\u60f3\u9650\u5236\u67d0\u4e2a\u8fdb\u7a0b\u6700\u591a\u4f7f\u7528 1 \u6838 CPU\uff0c\u5c31\u5728\u8fd9\u4e2a\u6587\u4ef6\u91cc\u5199\u5165 100000\uff08100000 \u4ee3\u8868\u9650\u5236 1 \u4e2a\u6838\uff09 \uff0ctasks \u6587\u4ef6\u4e2d\u5199\u5165\u8fdb\u7a0b\u7684 ID \u5373\u53ef\uff08\u5982\u679c\u8981\u9650\u5236\u591a\u4e2a\u8fdb\u7a0b ID\uff0c\u5728 tasks \u6587\u4ef6\u4e2d\u7528\u6362\u884c\u7b26\u5206\u9694\u5373\u53ef\uff09\u3002</p> <p>\u6b64\u65f6\uff0c\u6211\u4eec\u6240\u9700\u8981\u7684 cgroup \u5c31\u521b\u5efa\u597d\u4e86\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#cgroup","title":"\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u8fdb\u7a0b\uff0c\u52a0\u5165 cgroup","text":"<p>\u628a\u5f53\u524d\u8fd0\u884c\u7684 shell \u8fdb\u7a0b\u52a0\u5165 cgroup\uff0c\u7136\u540e\u5728\u5f53\u524d shell \u8fd0\u884c cpu \u8017\u65f6\u4efb\u52a1\uff08\u8fd9\u91cc\u5229\u7528\u5230\u4e86\u7ee7\u627f\uff0c\u5b50\u8fdb\u7a0b\u4f1a\u7ee7\u627f\u7236\u8fdb\u7a0b\u7684 cgroup\uff09\u3002</p> <p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06 shell \u8fdb\u7a0b\u52a0\u5165 cgroup \u4e2d\uff1a</p> <pre><code>[root@localhost ~]# cd /sys/fs/cgroup/cpu/mydocker\n[root@localhost mydocker]# echo $$ &gt; tasks\n[root@localhost mydocker]# cat tasks\n1727\n1777\n</code></pre> <p>\u5176\u4e2d\u7b2c\u4e00\u4e2a\u8fdb\u7a0b ID \u4e3a\u5f53\u524d shell \u7684\u4e3b\u8fdb\u7a0b\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5f53\u524d shell \u4e3b\u8fdb\u7a0b\u4e3a 1727\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#cpu-cgroup-cpu","title":"\u7b2c\u4e09\u6b65\uff1a\u6267\u884c CPU \u8017\u65f6\u4efb\u52a1\uff0c\u9a8c\u8bc1 cgroup \u662f\u5426\u53ef\u4ee5\u9650\u5236 cpu \u4f7f\u7528\u65f6\u95f4","text":"<p>\u4e0b\u9762\uff0c\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5236\u9020\u4e00\u4e2a\u6b7b\u5faa\u73af\uff0c\u6765\u63d0\u5347 cpu \u4f7f\u7528\u7387\uff1a</p> <pre><code>while true;do echo;done;\n</code></pre> <p>\u6267\u884c\u5b8c\u4e0a\u8ff0\u547d\u4ee4\u540e\uff0c\u6211\u4eec\u65b0\u6253\u5f00\u4e00\u4e2a shell \u7a97\u53e3\uff0c\u4f7f\u7528 top -p \u547d\u4ee4\u67e5\u770b\u5f53\u524d cpu \u4f7f\u7528\u7387\uff0c-p \u53c2\u6570\u540e\u9762\u8ddf\u8fdb\u7a0b ID\uff0c\u6211\u8fd9\u91cc\u662f 3485\u3002</p> <pre><code>[root@localhost ~]# top -p 1727\ntop - 22:46:43 up 29 min,  2 users,  load average: 0.89, 0.22, 0.11\nTasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie\n%Cpu(s): 34.6 us,  7.7 sy,  0.0 ni, 57.7 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st\nKiB Mem :  1863032 total,  1339788 free,   275472 used,   247772 buff/cache\nKiB Swap:  2097148 total,  2097148 free,        0 used.  1434404 avail Mem \n\n   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                         \n  1727 root      20   0  115672   2140   1660 R 100.0  0.1   0:24.58 bash \n</code></pre> <p>\u901a\u8fc7\u4e0a\u9762\u8f93\u51fa\u53ef\u4ee5\u770b\u52301727\u8fd9\u4e2a\u8fdb\u7a0b\u88ab\u9650\u5236\u5230\u4e86\u53ea\u80fd\u4f7f\u7528100 % \u7684 cpu\uff0c\u4e5f\u5c31\u662f1\u4e2a\u6838\u3002\u8bf4\u660e\u6211\u4eec\u4f7f\u7528 cgroup\u6765\u9650\u5236cpu\u4f7f\u7528\u65f6\u95f4\u5df2\u7ecf\u751f\u6548\u3002\u6b64\u65f6\uff0c\u6267\u884cwhile\u5faa\u73af\u7684\u547d\u4ee4\u884c\u7a97\u53e3\u53ef\u4ee5\u4f7f\u7528Ctrl+C\u9000\u51fa\u5faa\u73af\u3002</p> <p>\u4e3a\u4e86\u8fdb\u4e00\u6b65\u8bc1\u5b9ecgroup\u9650\u5236cpu\u7684\u51c6\u786e\u6027\uff0c\u6211\u4eec\u4fee\u6539cpu\u9650\u5236\u65f6\u95f4\u4e3a 0.5 \u6838\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@localhost ~]# cd /sys/fs/cgroup/cpu/mydocker\n[root@localhost mydocker]# echo 50000 &gt; cpu.cfs_quota_us\n</code></pre> <p>\u540c\u6837\u4f7f\u7528\u4e0a\u9762\u7684\u547d\u4ee4\u6765\u5236\u9020\u6b7b\u5faa\u73af\uff1a</p> <pre><code># while true;do echo;done;\n</code></pre> <p>\u4fdd\u6301\u5f53\u524d\u7a97\u53e3\uff0c\u65b0\u6253\u5f00\u4e00\u4e2a shell \u7a97\u53e3\uff0c\u4f7f\u7528 top -p \u53c2\u6570\u67e5\u770b cpu \u4f7f\u7528\u7387\uff1a</p> <pre><code>[root@localhost ~]# top -p 1727\ntop - 22:49:42 up 31 min,  2 users,  load average: 0.31, 0.42, 0.22\nTasks:   1 total,   1 running,   0 sleeping,   0 stopped,   0 zombie\n%Cpu(s): 15.3 us,  5.1 sy,  0.0 ni, 79.3 id,  0.0 wa,  0.0 hi,  0.4 si,  0.0 st\nKiB Mem :  1863032 total,  1337872 free,   277124 used,   248036 buff/cache\nKiB Swap:  2097148 total,  2097148 free,        0 used.  1432736 avail Mem \n\n   PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                         \n  1727 root      20   0  115672   2152   1672 R  50.0  0.1   1:27.29 bash   \n</code></pre> <p>\u901a\u8fc7\u4e0a\u9762\u8f93\u51fa\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6 cpu \u4f7f\u7528\u7387\u5df2\u7ecf\u88ab\u9650\u5236\u5230\u4e86 50%\uff0c\u5373 0.5 \u4e2a\u6838\u3002 \u9a8c\u8bc1\u5b8c cgroup \u9650\u5236 cpu\uff0c\u6211\u4eec\u4f7f\u7528\u76f8\u4f3c\u7684\u65b9\u6cd5\u6765\u9a8c\u8bc1 cgroup \u5bf9\u5185\u5b58\u7684\u9650\u5236\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#12-memroy","title":"1.2 memroy \u5b50\u7cfb\u7edf","text":""},{"location":"DevOps/Docker/underlyingtechnology/#memory-cgroup","title":"\u7b2c\u4e00\u6b65\uff1a\u5728 memory \u5b50\u7cfb\u7edf\u4e0b\u521b\u5efa cgroup","text":"<pre><code>mkdir /sys/fs/cgroup/memory/mydocker\n</code></pre> <p>\u67e5\u770b\u4e00\u4e0b\u65b0\u521b\u5efa\u7684\u76ee\u5f55</p> <pre><code>[root@localhost ~]# ls -l /sys/fs/cgroup/memory/mydocker\ntotal 0\n-rw-r--r--. 1 root root 0 Oct 30 22:51 cgroup.clone_children\n--w--w--w-. 1 root root 0 Oct 30 22:51 cgroup.event_control\n-rw-r--r--. 1 root root 0 Oct 30 22:51 cgroup.procs\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.failcnt\n--w-------. 1 root root 0 Oct 30 22:51 memory.force_empty\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.failcnt\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.limit_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.max_usage_in_bytes\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.slabinfo\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.tcp.failcnt\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.tcp.limit_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.tcp.max_usage_in_bytes\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.tcp.usage_in_bytes\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.kmem.usage_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.limit_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.max_usage_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.memsw.failcnt\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.memsw.limit_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.memsw.max_usage_in_bytes\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.memsw.usage_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.move_charge_at_immigrate\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.numa_stat\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.oom_control\n----------. 1 root root 0 Oct 30 22:51 memory.pressure_level\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.soft_limit_in_bytes\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.stat\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.swappiness\n-r--r--r--. 1 root root 0 Oct 30 22:51 memory.usage_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 22:51 memory.use_hierarchy\n-rw-r--r--. 1 root root 0 Oct 30 22:51 notify_on_release\n-rw-r--r--. 1 root root 0 Oct 30 22:51 tasks\n</code></pre> <p>\u5176\u4e2d<code>memory.limit_in_bytes</code>\u6587\u4ef6\u4ee3\u8868\u5185\u5b58\u4f7f\u7528\u603b\u91cf\uff0c\u5355\u4f4d\u4e3a byte\u3002</p> <p>\u4f8b\u5982\uff0c\u8fd9\u91cc\u6211\u5e0c\u671b\u5bf9\u5185\u5b58\u4f7f\u7528\u9650\u5236\u4e3a 1G\uff0c\u5219\u5411 memory.limit_in_bytes \u6587\u4ef6\u5199\u5165 1073741824\uff0c\u547d\u4ee4\u5982\u4e0b\uff1a</p> <pre><code>[root@localhost ~]# cd /sys/fs/cgroup/memory/mydocker\n[root@localhost mydocker]# cat memory.limit_in_bytes\n9223372036854771712\n[root@localhost mydocker]# echo 1073741824 &gt; memory.limit_in_bytes\n[root@localhost mydocker]# cat memory.limit_in_bytes\n1073741824\n</code></pre>"},{"location":"DevOps/Docker/underlyingtechnology/#cgroup_1","title":"\u7b2c\u4e8c\u6b65\uff1a\u521b\u5efa\u8fdb\u7a0b\uff0c\u52a0\u5165 cgroup","text":"<p>\u540c\u6837\u628a\u5f53\u524d shell \u8fdb\u7a0b ID \u5199\u5165 tasks \u6587\u4ef6\u5185\uff1a</p> <pre><code>[root@localhost mydocker]# cd /sys/fs/cgroup/memory/mydocker\n[root@localhost mydocker]# echo $$ &gt; tasks\n[root@localhost mydocker]# cat tasks\n2033\n2049\n</code></pre>"},{"location":"DevOps/Docker/underlyingtechnology/#_1","title":"\u7b2c\u4e09\u6b65\uff0c\u6267\u884c\u5185\u5b58\u6d4b\u8bd5\u5de5\u5177\uff0c\u7533\u8bf7\u5185\u5b58","text":"<p>\u9700\u8981\u5b89\u88c5\u5de5\u5177 memtester</p> <pre><code>[root@localhost mydocker]# memtester 1500M 1\nmemtester version 4.3.0 (64-bit)\nCopyright (C) 2001-2012 Charles Cazabon.\nLicensed under the GNU General Public License version 2 (only).\n\npagesize is 4096\npagesizemask is 0xfffffffffffff000\nwant 1500MB (1572864000 bytes)\ngot  1500MB (1572864000 bytes), trying mlock ...Killed\n</code></pre> <p>\u8be5\u547d\u4ee4\u4f1a\u7533\u8bf7 1500 M \u5185\u5b58\uff0c\u5e76\u4e14\u505a\u5185\u5b58\u6d4b\u8bd5\u3002\u7531\u4e8e\u4e0a\u9762\u6211\u4eec\u5bf9\u5f53\u524d shell \u8fdb\u7a0b\u5185\u5b58\u9650\u5236\u4e3a 1 G\uff0c\u5f53 memtester \u4f7f\u7528\u7684\u5185\u5b58\u8fbe\u5230 1G \u65f6\uff0ccgroup \u4fbf\u5c06 memtester \u6740\u6b7b\u3002</p> <p>\u4e0a\u9762\u6700\u540e\u4e00\u884c\u7684\u8f93\u51fa\u7ed3\u679c\u8868\u793a memtester \u60f3\u8981 1500 M \u5185\u5b58\uff0c\u4f46\u662f\u7531\u4e8e cgroup \u9650\u5236\uff0c\u8fbe\u5230\u4e86\u5185\u5b58\u4f7f\u7528\u4e0a\u9650\uff0c\u88ab\u6740\u6b7b\u4e86\uff0c\u4e0e\u6211\u4eec\u7684\u9884\u671f\u4e00\u81f4\u3002</p> <p>\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\uff0c\u964d\u4f4e\u4e00\u4e0b\u5185\u5b58\u7533\u8bf7\uff0c\u5c06\u5185\u5b58\u7533\u8bf7\u8c03\u6574\u4e3a 500M\uff1a</p> <pre><code>[root@localhost mydocker]# memtester 500M 1\nmemtester version 4.3.0 (64-bit)\nCopyright (C) 2001-2012 Charles Cazabon.\nLicensed under the GNU General Public License version 2 (only).\n\npagesize is 4096\npagesizemask is 0xfffffffffffff000\nwant 500MB (524288000 bytes)\ngot  500MB (524288000 bytes), trying mlock ...locked.\n\nLoop 1/1:\n  Stuck Address       : ok\n  Random Value        : ok\n  Compare XOR         : ok\n  Compare SUB         : ok\n  Compare MUL         : ok\n  Compare DIV         : ok\n  Compare OR          : ok\n  Compare AND         : ok\n  Sequential Increment: ok\n  Solid Bits          : ok\n  Block Sequential    : ok\n  Checkerboard        : ok\n  Bit Spread          : ok\n  Bit Flip            : ok\n  Walking Ones        : ok\n  Walking Zeroes      : ok\n  8-bit Writes        : ok\n  16-bit Writes       : ok\nDone.\n</code></pre> <p>\u8fd9\u91cc\u53ef\u4ee5\u770b\u5230\uff0c\u6b64\u65f6 memtester \u5df2\u7ecf\u6210\u529f\u7533\u8bf7\u5230 500M \u5185\u5b58\u5e76\u4e14\u6b63\u5e38\u5b8c\u6210\u4e86\u5185\u5b58\u6d4b\u8bd5\u3002</p> <p>\u4e0a\u9762\u521b\u5efa\u7684cgroups\u5982\u679c\u4e0d\u60f3\u4f7f\u7528\u4e86\uff0c\u76f4\u63a5\u5220\u9664\u521b\u5efa\u7684\u6587\u4ef6\u5939\u5373\u53ef\u3002</p>"},{"location":"DevOps/Docker/underlyingtechnology/#2-dockercgroups","title":"2. Docker\u662f\u5982\u4f55\u4f7f\u7528cgroups","text":"<p>\u9996\u5148\uff0c\u6211\u4eec\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a nginx \u5bb9\u5668\uff1a</p> <pre><code>[root@localhost ~]# docker run -itd -m=1g busybox\n3444837506a982a90ff805a1974242a1e2357ceac52307c7dbac8898f985c3c1\n</code></pre> <p>\u4e0a\u8ff0\u547d\u4ee4\u521b\u5efa\u5e76\u542f\u52a8\u4e86\u4e00\u4e2a nginx \u5bb9\u5668\uff0c\u5e76\u4e14\u9650\u5236\u5185\u5b58\u4e3a 1G\u3002\u7136\u540e\u6211\u4eec\u8fdb\u5165cgroups\u5185\u5b58\u5b50\u7cfb\u7edf\u7684\u76ee\u5f55\uff0c\u4f7f\u7528 ls \u547d\u4ee4\u67e5\u770b\u4e00\u4e0b\u8be5\u76ee\u5f55\u4e0b\u7684\u5185\u5bb9\uff1a</p> <pre><code>[root@localhost ~]# ls -l /sys/fs/cgroup/memory/docker/ | head\ntotal 0\ndrwxr-xr-x. 2 root root 0 Oct 30 23:21 3444837506a982a90ff805a1974242a1e2357ceac52307c7dbac8898f985c3c1\n-rw-r--r--. 1 root root 0 Oct 30 23:18 cgroup.clone_children\n--w--w--w-. 1 root root 0 Oct 30 23:18 cgroup.event_control\n-rw-r--r--. 1 root root 0 Oct 30 23:18 cgroup.procs\n-rw-r--r--. 1 root root 0 Oct 30 23:18 memory.failcnt\n--w-------. 1 root root 0 Oct 30 23:18 memory.force_empty\n-rw-r--r--. 1 root root 0 Oct 30 23:18 memory.kmem.failcnt\n-rw-r--r--. 1 root root 0 Oct 30 23:18 memory.kmem.limit_in_bytes\n-rw-r--r--. 1 root root 0 Oct 30 23:18 memory.kmem.max_usage_in_bytes\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230 docker \u7684\u76ee\u5f55\u4e0b\u6709\u4e00\u4e2a\u4e00\u4e32\u968f\u673a ID \u7684\u76ee\u5f55\uff0c\u8be5\u76ee\u5f55\u5373\u4e3a\u6211\u4eec\u4e0a\u9762\u521b\u5efa\u7684 busybox\u5bb9\u5668\u7684 ID\u3002\u7136\u540e\u6211\u4eec\u8fdb\u5165\u8be5\u76ee\u5f55\uff0c\u67e5\u770b\u4e00\u4e0b\u8be5\u5bb9\u5668\u7684 memory.limit_in_bytes \u6587\u4ef6\u7684\u5185\u5bb9\u3002</p> <pre><code>[root@localhost ~]# cd /sys/fs/cgroup/memory/docker/3444837506a982a90ff805a1974242a1e2357ceac52307c7dbac8898f985c3c1\n[root@localhost 3444837506a982a90ff805a1974242a1e2357ceac52307c7dbac8898f985c3c1]# cat memory.limit_in_bytes\n1073741824\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u5185\u5b58\u9650\u5236\u503c\u6b63\u597d\u4e3a 1G\u3002 \u4e8b\u5b9e\u4e0a\uff0cDocker \u521b\u5efa\u5bb9\u5668\u65f6\uff0cDocker \u4f1a\u6839\u636e\u542f\u52a8\u5bb9\u5668\u7684\u53c2\u6570\uff0c\u5728\u5bf9\u5e94\u7684 cgroups \u5b50\u7cfb\u7edf\u4e0b\u521b\u5efa\u4ee5\u5bb9\u5668 ID \u4e3a\u540d\u79f0\u7684\u76ee\u5f55, \u7136\u540e\u6839\u636e\u5bb9\u5668\u542f\u52a8\u65f6\u8bbe\u7f6e\u7684\u8d44\u6e90\u9650\u5236\u53c2\u6570, \u4fee\u6539\u5bf9\u5e94\u7684 cgroups \u5b50\u7cfb\u7edf\u8d44\u6e90\u9650\u5236\u6587\u4ef6, \u4ece\u800c\u8fbe\u5230\u8d44\u6e90\u9650\u5236\u7684\u6548\u679c\u3002</p> <p>cgroups \u867d\u7136\u53ef\u4ee5\u5b9e\u73b0\u8d44\u6e90\u7684\u9650\u5236\uff0c\u4f46\u662f\u4e0d\u80fd\u4fdd\u8bc1\u8d44\u6e90\u7684\u4f7f\u7528\u3002\u4f8b\u5982\uff0ccgroups \u9650\u5236\u67d0\u4e2a\u5bb9\u5668\u6700\u591a\u4f7f\u7528 1 \u6838 CPU\uff0c\u4f46\u4e0d\u4fdd\u8bc1\u603b\u662f\u80fd\u4f7f\u7528\u5230 1 \u6838 CPU\uff0c\u5f53 CPU \u8d44\u6e90\u53d1\u751f\u7ade\u4e89\u65f6\uff0c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5b9e\u9645\u4f7f\u7528\u7684 CPU \u8d44\u6e90\u4ea7\u751f\u7ade\u4e89\u3002</p>"},{"location":"DevOps/Docker/%E5%AE%B9%E5%99%A8%E4%B8%8E%E9%95%9C%E5%83%8F%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E5%8C%BA%E5%88%AB/","title":"\u5bb9\u5668\u4e0e\u955c\u50cf\u7684\u5bfc\u5165\u5bfc\u51fa\u533a\u522b","text":""},{"location":"DevOps/Docker/%E5%AE%B9%E5%99%A8%E4%B8%8E%E9%95%9C%E5%83%8F%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E5%8C%BA%E5%88%AB/#exportsave","title":"\u4e00\u3001export\u4e0esave\uff1a","text":"<ol> <li>export\u7528\u5230\u5bfc\u51fa\u5bb9\u5668\uff0csave\u7528\u4e8e\u5bfc\u51fa\u955c\u50cf\uff0c\u90fd\u662f\u90fd\u662f\u5bfc\u51fatar\u6587\u4ef6\u3002</li> <li>export\u4e00\u6b21\u53ea\u80fd\u5bfc\u51fa\u4e00\u4e2a\u5bb9\u5668\uff0csave\u4e00\u6b21\u53ef\u4ee5\u5bfc\u51fa\u591a\u4e2a\u955c\u50cf\u3002</li> <li>export\u5c06\u5f53\u524d\u5bb9\u5668\u72b6\u6001\u5bfc\u51fa\u5230\u6587\u4ef6\uff0c\u7c7b\u4f3c\u5feb\u7167\uff0c\u4e0d\u5305\u542b\u5143\u6570\u636e\u548c\u5386\u53f2\u4fe1\u606f\uff0c\u4f53\u79ef\u66f4\u5c0f\uff1bsave \u5bfc\u51fa\u7684\u955c\u50cf\u5305\u542b\u955c\u50cf\u5143\u6570\u636e\u548c\u5386\u53f2\u4fe1\u606f\u3002</li> </ol> <p>\u6bd4\u8f83export\u548csave\u5bfc\u51fatar\u5305\u7684\u5185\u5bb9\uff1a</p> <pre><code>$ docker save -o ubuntu-img.tar ubuntu:latest\n$ docker export -o ubuntu-container.tar myubuntu\n</code></pre> <p>\u67e5\u770bsave\u5bfc\u51fa\u7684ubuntu-img.tar\u5185\u5bb9</p> <pre><code>$ tar -tf ubuntu-img.tar \n15c50011d28601e04214355466ea8b179c4566bbd357c098376a534139efb5a9/\n15c50011d28601e04214355466ea8b179c4566bbd357c098376a534139efb5a9/VERSION\n15c50011d28601e04214355466ea8b179c4566bbd357c098376a534139efb5a9/json\n15c50011d28601e04214355466ea8b179c4566bbd357c098376a534139efb5a9/layer.tar\ne4c58958181a5925816faa528ce959e487632f4cfd192f8132f71b32df2744b4.json\nmanifest.json\nrepositories\n</code></pre> <p>\u67e5\u770bexport\u5bfc\u51fa\u7684ubuntu-container.tar\u5185\u5bb9</p> <pre><code>$ tar -tf  ubuntu-container.tar --exclude='*/*'\n.dockerenv\nbin\nboot/\ndev/\netc/\nhome/\nlib\nlib32\nlib64\nlibx32\nmedia/\nmnt/\nopt/\nproc/\nroot/\nrun/\nsbin\nsrv/\nsys/\ntmp/\nusr/\nvar/\n</code></pre>"},{"location":"DevOps/Docker/%E5%AE%B9%E5%99%A8%E4%B8%8E%E9%95%9C%E5%83%8F%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E5%8C%BA%E5%88%AB/#importload","title":"\u4e8c\u3001import\u4e0eload","text":"<ol> <li>import\u5bfc\u5165\u7684\u662f\u5bb9\u5668\u5305\uff0cload\u5bfc\u5165\u7684\u662f\u955c\u50cf\u5305\uff0c\u4e24\u8005\u90fd\u4f1a\u6062\u590d\u4e3a\u955c\u50cf</li> <li>import\u53ef\u4ee5\u4e3a\u955c\u50cf\u6307\u5b9a\u65b0\u540d\u79f0\uff0cload\u4e0d\u80fd\u5bf9\u5bfc\u5165\u955c\u50cf\u91cd\u547d\u540d</li> <li>import\u4f1a\u4e22\u5931\u5386\u53f2\uff0c\u6062\u590d\u540e\u4e2d\u5305\u542b\u4e00\u5c42\uff0cload\u4e0d\u4f1a\u4e22\u5931\u5386\u53f2\u548c\u5c42</li> </ol>"},{"location":"DevOps/Docker/%E5%AE%B9%E5%99%A8%E4%B8%8E%E9%95%9C%E5%83%8F%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA%E5%8C%BA%E5%88%AB/#commitexportimport","title":"\u4e09\u3001commit\u4e0eexport+import","text":"<ol> <li>export+import\u4e0ecommit\u90fd\u53ef\u4ee5\u5c06\u5bb9\u5668\u8f6c\u4e3a\u955c\u50cf</li> <li>export+import\u6062\u590d\u7684\u955c\u50cf\u4ec5\u5305\u542b\u4e00\u5c42\uff0ccommit\u5305\u542b\u539f\u955c\u50cf\u6240\u6709\u5c42</li> </ol>"},{"location":"DevOps/Git/Git/","title":"Git","text":"<p>2014\u7531Linus Torvalds\u5f00\u53d1\u7684\u5206\u652f\u7ba1\u7406\u7cfb\u7edf\u3002</p>"},{"location":"DevOps/Git/Git/#git_1","title":"\u4e00\u3001git\u57fa\u672c\u6982\u5ff5","text":""},{"location":"DevOps/Git/Git/#1-3","title":"1. 3\u4e2a\u533a\u57df","text":"<ol> <li>\u5de5\u4f5c\u533a\uff1a<code>.git</code>\u7248\u672c\u5e93\u6240\u5728\u7684\u76ee\u5f55</li> <li>\u6682\u5b58\u533a\uff1a\u4e5f\u53eb\u7f13\u5b58\u533a\uff0c\u6216\u7d22\u5f15(<code>.git/index</code>)\u3002\u662f\u4e00\u4e2a\u6587\u4ef6\uff0c\u4fdd\u5b58\u4e86\u4e0b\u6b21\u5c06\u63d0\u4ea4\u7684\u6587\u4ef6\u5217\u8868\u4fe1\u606f\uff0c\u4e00\u822c\u5728 Git \u4ed3\u5e93\u76ee\u5f55\u4e2d</li> <li>\u7248\u672c\u5e93\uff1a\u7528\u6765\u4fdd\u5b58\u9879\u76ee\u7684\u5143\u6570\u636e\u548c\u5bf9\u8c61\u6570\u636e\u5e93\u7684\u5730\u65b9\uff0c<code>.git</code>\u76ee\u5f55\u5c31\u662f\u7248\u672c\u5e93\u3002</li> </ol>"},{"location":"DevOps/Git/Git/#2-3","title":"2. 3\u4e2a\u5bf9\u8c61","text":"<ol> <li>git\u5bf9\u8c61</li> <li>\u6811\u5bf9\u8c61</li> <li>\u63d0\u4ea4\u5bf9\u8c61</li> </ol>"},{"location":"DevOps/Git/Git/#3-3","title":"3. 3\u79cd\u72b6\u6001","text":"<ol> <li>\u5df2\u4fee\u6539\uff08modified\uff09\uff1a\u8868\u793a\u4fee\u6539\u4e86\u6587\u4ef6\uff0c\u4f46\u8fd8\u6ca1\u4fdd\u5b58\u5230\u6570\u636e\u5e93\u4e2d\u3002</li> <li>\u5df2\u6682\u5b58\uff08staged\uff09\uff1a\u8868\u793a\u5bf9\u4e00\u4e2a\u5df2\u4fee\u6539\u6587\u4ef6\u7684\u5f53\u524d\u7248\u672c\u505a\u4e86\u6807\u8bb0\uff0c\u4f7f\u4e4b\u5305\u542b\u5728\u4e0b\u6b21\u63d0\u4ea4\u7684\u5feb\u7167\u4e2d\u3002</li> <li>\u5df2\u63d0\u4ea4\uff08committed\uff09\uff1a\u8868\u793a\u6570\u636e\u5df2\u7ecf\u5b89\u5168\u7684\u4fdd\u5b58\u5728\u672c\u5730\u6570\u636e\u5e93\u4e2d\u3002</li> </ol>"},{"location":"DevOps/Git/Git/#4-git","title":"4. Git\u57fa\u672c\u7684\u5de5\u4f5c\u6d41\u7a0b","text":"<ol> <li>\u5728\u5de5\u4f5c\u76ee\u5f55\u4e2d\u4fee\u6539\u6587\u4ef6\u3002</li> <li>\u6682\u5b58\u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u7684\u5feb\u7167\u653e\u5165\u6682\u5b58\u533a\u57df\u3002</li> <li>\u63d0\u4ea4\u66f4\u65b0\uff0c\u627e\u5230\u6682\u5b58\u533a\u57df\u7684\u6587\u4ef6\uff0c\u5c06\u5feb\u7167\u6c38\u4e45\u6027\u5b58\u50a8\u5230 Git \u4ed3\u5e93\u76ee\u5f55\u3002</li> </ol>"},{"location":"DevOps/Git/Git/#5-git","title":"5. Git\u5de5\u4f5c\u533a\u76ee\u5f55","text":"<pre><code>$ tree -FL 1 .git\n.git\n\u251c\u2500\u2500 branches/\n\u251c\u2500\u2500 config      # \u9879\u76ee\u7279\u6709\u7684\u914d\u7f6e\u9879\n\u251c\u2500\u2500 description # \u5bf9\u4ed3\u5e93\u7684\u63cf\u8ff0\u4fe1\u606f\n\u251c\u2500\u2500 HEAD        # \u76ee\u524d\u88ab\u68c0\u51fa\u7684\u5206\u652f\n\u251c\u2500\u2500 hooks/      # \u5305\u542b\u5ba2\u6237\u7aef\u6216\u670d\u52a1\u7aef\u7684\u94a9\u5b50\u811a\u672c\n\u251c\u2500\u2500 info/       # \u5305\u542b\u5168\u5c40\u6027\u7684\u6392\u51fa\u6587\u4ef6\n\u251c\u2500\u2500 objects/    # \u5b58\u50a8\u6240\u6709\u7684\u6570\u636e\u5185\u5bb9\n\u251c\u2500\u2500 index       # \u5305\u542b\u6587\u4ef6\u7d22\u5f15\u7684\u76ee\u5f55\u6811\uff0c\u8bb0\u5f55\u4e86\u6587\u4ef6\u540d\u548c\u6587\u4ef6\u7684\u72b6\u6001\u4fe1\u606f\uff08\u65f6\u95f4\u6233\u548c\u6587\u4ef6\u957f\u5ea6\u7b49\uff09\n\u2514\u2500\u2500 refs/       # \u5b58\u50a8\u6307\u5411\u6570\u636e\uff08\u5206\u652f\uff09\u63d0\u4ea4\u5bf9\u8c61\u7684\u6307\u9488\n</code></pre>"},{"location":"DevOps/Git/Git/#git_2","title":"\u4e8c\u3001Git\u914d\u7f6e","text":""},{"location":"DevOps/Git/Git/#1-git","title":"1. Git\u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6\u7684\u4e09\u4e2a\u5b58\u50a8\u4f4d\u7f6e</p> <ol> <li><code>/etc/gitconfig</code> \uff1a\u9488\u5bf9\u6240\u6709\u7528\u6237\u7684\u901a\u7528\u914d\u7f6e\uff0c\u4f7f\u7528<code>git config --system</code>\u914d\u7f6e</li> <li><code>~/.gitconfig</code> \u6216 <code>~/.config/git/config</code> \uff1a\u9488\u5bf9\u5f53\u524d\u7528\u6237\uff0c\u4f7f\u7528<code>git config --global</code>\u914d\u7f6e</li> <li><code>.git/config</code>\uff1a\u9488\u5bf9\u672c\u4ed3\u5e93\uff0c\u4f7f\u7528<code>git config --local</code>\u914d\u7f6e</li> </ol> <p>\u8fd9\u4e09\u4e2a\u914d\u7f6e\u6587\u4ef6\u7684\u4f18\u5148\u7ea7\u7531\u4f4e\u5230\u9ad8</p>"},{"location":"DevOps/Git/Git/#2-git","title":"2. \u67e5\u770bgit\u5f53\u524d\u914d\u7f6e","text":"<pre><code>git config --list\n</code></pre>"},{"location":"DevOps/Git/Git/#3","title":"3. \u5e38\u7528\u914d\u7f6e","text":""},{"location":"DevOps/Git/Git/#1","title":"1. \u7528\u6237\u540d\u79f0\u4e0e\u90ae\u4ef6\u5730\u5740","text":"<pre><code>git config --global user.name 'yuanzhigao'\ngit config --global user.email 'gaopeng0214@126.com\n</code></pre>"},{"location":"DevOps/Git/Git/#2","title":"2. \u914d\u7f6e\u9ed8\u8ba4\u6587\u672c\u7f16\u8f91\u5668","text":"<pre><code>git config --global core.editor vim\n</code></pre>"},{"location":"DevOps/Git/Git/#3_1","title":"3. \u67e5\u770b\u5177\u4f53\u67d0\u4e00\u9879\u914d\u7f6e","text":"<pre><code>$ git config user.name\nyuanzhigao\n</code></pre>"},{"location":"DevOps/Git/Git/#4","title":"4. \u522b\u540d","text":"<pre><code>git config --global alias.co checkout\ngit config --global alias.br branch\ngit config --global alias.ci commit\ngit config --global alias.st status\n</code></pre>"},{"location":"DevOps/Git/Git/#5","title":"5. \u5176\u4ed6\u914d\u7f6e","text":"<pre><code># \u89e3\u51b3\u4e2d\u6587\u540d\u7684\u663e\u793a\u95ee\u9898\ngit config --global core.quotepath false\n# \u8f93\u51fa\u4e2d\u5f00\u542f\u989c\u8272\u663e\u793a\ngit config --global color.ui true\n</code></pre>"},{"location":"DevOps/Git/Git/#_1","title":"\u4e09\u3001\u4ed3\u5e93\u7ba1\u7406","text":""},{"location":"DevOps/Git/Git/#1-git_1","title":"1. \u65b0\u5efaGit\u4ed3\u5e93","text":""},{"location":"DevOps/Git/Git/#1-git_2","title":"1. \u5728\u5f53\u524d\u76ee\u5f55\u521d\u59cb\u5316Git\u4ed3\u5e93","text":"<pre><code>git init\n</code></pre>"},{"location":"DevOps/Git/Git/#2-git_1","title":"2. \u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\u5e76\u5c06\u5176\u521d\u59cb\u5316\u4e3aGit\u4ed3\u5e93","text":"<pre><code>git init Demo\n</code></pre>"},{"location":"DevOps/Git/Git/#3-git","title":"3. \u514b\u9686\u4e00\u4e2aGit\u4ed3\u5e93","text":"<pre><code># git\u534f\u8bae\ngit clone git@gitee.com:gaoyuanzhi/Demo.git\n# https\u534f\u8bae\ngit clone https://gitee.com/gaoyuanzhi/python3-notes.git\n</code></pre>"},{"location":"DevOps/Git/Git/#_2","title":"\u56db\u3001\u6587\u4ef6\u7ba1\u7406","text":""},{"location":"DevOps/Git/Git/#1_1","title":"1. \u67e5\u770b\u5f53\u524d\u6587\u4ef6\u72b6\u6001","text":"<pre><code># \u8be6\u7ec6\u72b6\u6001\n$ git status\n# \u7b80\u77ed\u72b6\u6001\n$ git status -s\nM README            # \u6587\u4ef6\u88ab\u4fee\u6539\u4e86\u5e76\u653e\u5165\u4e86\u6682\u5b58\u533a\nA lib/git.rb        # \u65b0\u6dfb\u52a0\u5230\u6682\u5b58\u533a\u4e2d\u7684\u6587\u4ef6\n M lib/simplegit.rb # \u6587\u4ef6\u88ab\u4fee\u6539\u4e86\u4f46\u662f\u8fd8\u6ca1\u653e\u5165\u6682\u5b58\u533a\n?? LICENSE.txt      # \u65b0\u6dfb\u52a0\u7684\u672a\u8ddf\u8e2a\u6587\u4ef6\n</code></pre> <p><code>git status</code> \u7684\u51e0\u79cd\u72b6\u6001</p> <ol> <li>changes to be commited(\u88ab\u63d0\u4ea4\u7684\u4fee\u6539)\uff1a\u4e0b\u6b21\u63d0\u4ea4\u4e2d\u88ab\u7eb3\u5165\u7248\u672c\u5e93\u4e2d\u7684\u88ab\u4fee\u6539\u7684\u6587\u4ef6\u3002</li> <li>changed but not updated(\u4e0d\u4f1a\u88ab\u66f4\u65b0\u7684\u4fee\u6539)\uff1a\u5df2\u7ecf\u88ab\u4fee\u6539\u4f46\u5c1a\u672a\u6ce8\u518c\u5230\u4e0b\u6b21\u63d0\u4ea4\u4e2d\u7684\u6587\u4ef6\u3002</li> <li>untracked files(\u672a\u88ab\u8ddf\u8e2a\u7684\u6587\u4ef6)\uff1a\u65b0\u589e\u6587\u4ef6</li> </ol> <p>\u5f53\u6267\u884c<code>git status</code> \u6216<code>git diff</code>\u626b\u63cf\u5de5\u4f5c\u533a\u6539\u52a8\u7684\u65f6\u5019\uff0c\u5148\u4f9d\u636e.git/index\u6587\u4ef6\u4e2d\u8bb0\u5f55\u7684\u65f6\u95f4\u6233\uff0c\u957f\u5ea6\u7b49\u4fe1\u606f\u5224\u65ad\u5de5\u4f5c\u533a\u6587\u4ef6\u662f\u5426\u6539\u53d8\uff0c\u5982\u679c\u5de5\u4f5c\u533a\u6587\u4ef6\u7684\u65f6\u95f4\u6233\u6539\u53d8\u4e86\uff0c\u8bf4\u660e\u6587\u4ef6\u7684\u5185\u5bb9\u53ef\u80fd\u88ab\u53d8\u4e86\uff0c\u9700\u8981\u6253\u5f00\u6587\u4ef6\uff0c\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u4e0e\u66f4\u6539\u524d\u7684\u539f\u59cb\u6587\u4ef6\u76f8\u6bd4\u8f83\uff0c\u5224\u65ad\u6587\u4ef6\u662f\u5426\u6539\u53d8\u3002\u5982\u679c\u6587\u4ef6\u5185\u5bb9\u6ca1\u6709\u6539\u53d8\uff0c\u5219\u5c06\u6587\u4ef6\u65b0\u7684\u65f6\u95f4\u6233\u8bb0\u5f55\u5230.git/index\u6587\u4ef6\u4e2d\u3002</p>"},{"location":"DevOps/Git/Git/#2_1","title":"2. \u6dfb\u52a0\u5185\u5bb9\u5230\u6682\u5b58\u533a","text":"<pre><code># \u6dfb\u52a0\u6307\u5b9a\u6587\u4ef6\u5230\u6682\u5b58\u533a\uff0c\u4e00\u6b21\u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u6587\u4ef6\n$ git add [file1] [file2]\n# \u6dfb\u52a0\u6307\u5b9a\u76ee\u5f55\u5230\u6682\u5b58\u533a\n$ git add [dir]\n# \u6dfb\u52a0\u5f53\u524d\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u5230\u6682\u5b58\u533a\n$ git add .\n</code></pre>"},{"location":"DevOps/Git/Git/#_3","title":"\u6e05\u9664\u5de5\u4f5c\u533a","text":"<pre><code># \u6e05\u9664\u5de5\u4f5c\u533a\u5f53\u524d\u7684\u6539\u52a8\ngit clean -df\n</code></pre>"},{"location":"DevOps/Git/Git/#3_2","title":"3. \u5ffd\u7565\u6587\u4ef6","text":"<p>\u4e00\u822c\u6211\u4eec\u603b\u4f1a\u6709\u4e9b\u6587\u4ef6\u65e0\u9700\u7eb3\u5165 Git \u7684\u7ba1\u7406\uff0c\u4e5f\u4e0d\u5e0c\u671b\u5b83\u4eec\u603b\u51fa\u73b0\u5728\u672a\u8ddf\u8e2a\u6587\u4ef6\u5217\u8868\u3002 \u901a\u5e38 \u90fd\u662f\u4e9b\u81ea\u52a8\u751f\u6210\u7684\u6587\u4ef6\uff0c\u6bd4\u5982\u65e5\u5fd7\u6587\u4ef6\uff0c\u6216\u8005\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u521b\u5efa\u7684\u4e34\u65f6\u6587\u4ef6\u7b49\u3002 \u5728\u8fd9\u79cd\u60c5\u51b5 \u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a .gitignore \u7684\u6587\u4ef6\uff0c\u5217\u51fa\u8981\u5ffd\u7565\u7684\u6587\u4ef6\u6a21\u5f0f\u3002</p> <p>\u6587\u4ef6 .gitignore \u7684\u683c\u5f0f\u89c4\u8303\u5982\u4e0b\uff1a</p> <ol> <li>\u6240\u6709\u7a7a\u884c\u6216\u8005\u4ee5 <code>\uff03</code>\u5f00\u5934\u7684\u884c\u90fd\u4f1a\u88ab Git \u5ffd\u7565\u3002</li> <li>\u53ef\u4ee5\u4f7f\u7528shell \u6240\u4f7f\u7528\u7684\u7b80\u5316\u4e86\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u6a21\u5f0f\u5339\u914d\u3002</li> <li>\u5339\u914d\u6a21\u5f0f\u53ef\u4ee5\u4ee5\uff08<code>/</code>\uff09\u5f00\u5934\u9632\u6b62\u9012\u5f52\u3002</li> <li>\u5339\u914d\u6a21\u5f0f\u53ef\u4ee5\u4ee5\uff08<code>/</code>\uff09\u7ed3\u5c3e\u6307\u5b9a\u76ee\u5f55\u3002</li> <li>\u8981\u5ffd\u7565\u6307\u5b9a\u6a21\u5f0f\u4ee5\u5916\u7684\u6587\u4ef6\u6216\u76ee\u5f55\uff0c\u53ef\u4ee5\u5728\u6a21\u5f0f\u524d\u52a0\u4e0a\u60ca\u53f9\u53f7\uff08<code>!</code>\uff09\u53d6\u53cd\u3002</li> </ol> <p>https://github.com/github/gitignore \u6709\u5341\u79cd\u9879\u76ee\u53ca\u8bed\u8a00\u7684 .gitignore \u6587\u4ef6\u5217\u8868</p>"},{"location":"DevOps/Git/Git/#_4","title":"\u5dee\u5f02","text":"<pre><code># \u5de5\u4f5c\u533a\u548c\u6682\u5b58\u533a\u4e2d\u7684\u5dee\u5f02\ngit diff\n# \u6682\u5b58\u533a\u548c\u7248\u672c\u5e93\u4e2d\u7684\u5dee\u5f02\ngit diff --cached\n# \u5de5\u4f5c\u533a\u548cHEAD\uff08\u5f53\u524d\u5de5\u4f5c\u5206\u652f\uff09\u7684\u5dee\u5f02\ngit diff HEAD\n</code></pre>"},{"location":"DevOps/Git/Git/#4_1","title":"4. \u79fb\u9664\u6587\u4ef6","text":"<pre><code># \u540c\u65f6\u5220\u9664\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u7684\u6587\u4ef6\n$ git rm [file]\n# \u4ece\u6682\u5b58\u533a\u57df\u79fb\u9664\u4f46\u662f\u5728\u5de5\u4f5c\u533a\u4fdd\u7559\n$ git rm --cached [file]\n</code></pre>"},{"location":"DevOps/Git/Git/#5_1","title":"5. \u79fb\u52a8\u6587\u4ef6","text":"<pre><code># \u91cd\u547d\u540d\u6216\u79fb\u52a8\u6587\u4ef6\n$ git mv &lt;src&gt; &lt;dest&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#_5","title":"\u4fdd\u5b58\u5de5\u4f5c\u8fdb\u5ea6","text":"<pre><code>$ git stash\n</code></pre>"},{"location":"DevOps/Git/Git/#_6","title":"\u4e94\u3001\u63d0\u4ea4\u66f4\u65b0","text":""},{"location":"DevOps/Git/Git/#1_2","title":"1. \u63d0\u4ea4\u66f4\u65b0","text":"<pre><code># \u542f\u52a8\u6587\u672c\u7f16\u8f91\u5668\u4ee5\u4fbf\u8f93\u5165\u672c\u6b21\u63d0\u4ea4\u7684\u8bf4\u660e\n$ git commit\n# \u5c06\u63d0\u4ea4\u4fe1\u606f\u4e0e\u547d\u4ee4\u653e\u5728\u540c\u4e00\u884c\n$ git commit -m \"Story 182: Fix benchmarks for speed\"\n# \u628a\u6240\u6709\u5df2\u7ecf\u8ddf\u8e2a\u8fc7\u7684\u6587\u4ef6\u6682\u5b58\u8d77\u6765\u4e00\u5e76\u63d0\u4ea4\uff0c\u4ece\u800c\u8df3\u8fc7 git add \u6b65\u9aa4\n$ git commit -a -m 'added new benchmarks'\n# \u4ece\u65b0\u63d0\u4ea4\n$ git commit --amend\n</code></pre>"},{"location":"DevOps/Git/Git/#2_2","title":"2. \u67e5\u770b\u5386\u53f2\u63d0\u4ea4","text":"<pre><code># \u67e5\u770b\u5386\u53f2\u63d0\u4ea4\n$ git log\n</code></pre> <p>\u5e38\u7528\u9009\u9879</p> \u9009\u9879 \u8bf4\u660e <code>-p</code> \u6309\u8865\u4e01\u683c\u5f0f\u663e\u793a\u6bcf\u4e2a\u66f4\u65b0\u4e4b\u95f4\u7684\u5dee\u5f02 <code>--stat</code> \u663e\u793a\u6bcf\u6b21\u66f4\u65b0\u7684\u6587\u4ef6\u4fee\u6539\u7edf\u8ba1\u4fe1\u606f\u3002 <code>--shortstat</code> \u53ea\u663e\u793a --stat \u4e2d\u6700\u540e\u7684\u884c\u6570\u4fee\u6539\u6dfb\u52a0\u79fb\u9664\u7edf\u8ba1 <code>--name-only</code> \u4ec5\u5728\u63d0\u4ea4\u4fe1\u606f\u540e\u663e\u793a\u5df2\u4fee\u6539\u7684\u6587\u4ef6\u6e05\u5355\u3002 <code>--name- status</code> \u663e\u793a\u65b0\u589e\u3001\u4fee\u6539\u3001\u5220\u9664\u7684\u6587\u4ef6\u6e05\u5355 <code>--relative-date</code> \u4f7f\u7528\u8f83\u77ed\u7684\u76f8\u5bf9\u65f6\u95f4\u663e\u793a\uff08\u6bd4\u5982\uff0c\u201c2 weeks ago\u201d\uff09 <code>--graph</code> \u663e\u793a ASCII \u56fe\u5f62\u8868\u793a\u7684\u5206\u652f\u5408\u5e76\u5386\u53f2 <code>--pretty</code> \u4f7f\u7528\u5176\u4ed6\u683c\u5f0f\u663e\u793a\u5386\u53f2\u63d0\u4ea4\u4fe1\u606f\u3002\u53ef\u7528\u7684\u9009\u9879\u5305\u62ec oneline\uff0cshort\uff0c full\uff0cfuller \u548c format\uff08\u540e\u8ddf\u6307\u5b9a\u683c\u5f0f\uff09 <code>--decorate</code> \u67e5\u770b\u5404\u4e2a\u5206\u652f\u5f53\u524d\u6240\u6307\u7684\u5bf9\u8c61 <code>-(n)</code> \u4ec5\u663e\u793a\u6700\u8fd1\u7684 n \u6761\u63d0\u4ea4 <code>--since</code> ,<code>--after</code> \u4ec5\u663e\u793a\u6307\u5b9a\u65f6\u95f4\u4e4b\u540e\u7684\u63d0\u4ea4 <code>--until</code> , <code>--before</code> \u4ec5\u663e\u793a\u6307\u5b9a\u65f6\u95f4\u4e4b\u524d\u7684\u63d0\u4ea4 <code>--author</code> \u4ec5\u663e\u793a\u6307\u5b9a\u4f5c\u8005\u76f8\u5173\u7684\u63d0\u4ea4 <code>--committer</code> \u4ec5\u663e\u793a\u6307\u5b9a\u63d0\u4ea4\u8005\u76f8\u5173\u7684\u63d0\u4ea4 <code>--grep</code> \u4ec5\u663e\u793a\u542b\u6307\u5b9a\u5173\u952e\u5b57\u7684\u63d0\u4ea4 <code>-S</code> \u4ec5\u663e\u793a\u6dfb\u52a0\u6216\u79fb\u9664\u4e86\u67d0\u4e2a\u5173\u952e\u5b57\u7684\u63d0\u4ea4 <pre><code># \u4f8b\n$ git log --since='2020-2-10' --until='2020-2-15' --pretty=oneline\n</code></pre>"},{"location":"DevOps/Git/Git/#_7","title":"\u516d\u3001\u8fdc\u7a0b\u4ed3\u5e93","text":""},{"location":"DevOps/Git/Git/#1_3","title":"1. \u67e5\u770b\u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code>$ git remote\n# \u663e\u793a\u8fdc\u7a0b\u4ed3\u5e93URL\n$ git remote -v\n# \u67e5\u770b\u66f4\u591a\u4fe1\u606f\uff0cURL\u548c\u5206\u652f\u7b49\n$ git remote show origin\n</code></pre>"},{"location":"DevOps/Git/Git/#2_3","title":"2. \u6dfb\u52a0\u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code># \u6dfb\u52a0\u8fdc\u7a0b\u4ed3\u5e93\u5e76\u8d77\u4e00\u4e2a\u522b\u540d\n$ git remote add python3-notes git@gitee.com:gaoyuanzhi/python3-notes.git\n</code></pre>"},{"location":"DevOps/Git/Git/#3_3","title":"3. \u62c9\u53d6\u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code># \u65b9\u6cd5\u4e00\n$ git pull\n# \u65b9\u6cd5\u4e8c\n$ git fetch &lt;remote_name&gt;\n$ git merge\n</code></pre> <p>\u4e24\u79cd\u65b9\u5f0f\u7684\u533a\u522b\uff1a</p> <ol> <li>\u5f53 <code>git fetch</code> \u547d\u4ee4\u4ece\u670d\u52a1\u5668\u4e0a\u6293\u53d6\u672c\u5730\u6ca1\u6709\u7684\u6570\u636e\u65f6\uff0c\u5b83\u5e76\u4e0d\u4f1a\u4fee\u6539\u5de5\u4f5c\u76ee\u5f55\u4e2d\u7684\u5185\u5bb9\u3002 \u5b83\u53ea\u4f1a\u83b7\u53d6\u6570\u636e\u7136\u540e\u8ba9\u4f60\u81ea\u5df1\u5408\u5e76\u30022.</li> <li><code>git pull</code> \u5728\u5927\u591a\u6570\u60c5\u51b5\u4e0b\u5b83\u7684\u542b\u4e49\u662f\u4e00\u4e2a <code>git fetch</code> \u7d27\u63a5\u7740\u4e00\u4e2a <code>git merge</code> \u547d\u4ee4\uff0c<code>git pull</code> \u4f1a\u67e5\u627e\u5f53\u524d\u5206\u652f\u6240\u8ddf\u8e2a\u7684\u670d\u52a1\u5668\u4e0e\u5206\u652f\uff0c\u4ece\u670d\u52a1\u5668\u4e0a\u6293\u53d6\u6570\u636e\u7136\u540e\u5c1d\u8bd5\u5408\u5e76\u5165\u90a3\u4e2a\u8fdc\u7a0b\u5206\u652f\u3002</li> </ol>"},{"location":"DevOps/Git/Git/#4_2","title":"4. \u63a8\u9001\u5230\u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code>$ git push origin &lt;\u5206\u652f\u540d\u79f0&gt;\n# git\u4f1a\u5c06&lt;\u5206\u652f\u540d\u79f0&gt;\u5c55\u5f00refs/heads/&lt;\u5206\u652f\u540d\u79f0&gt;:refs/heads/&lt;\u5206\u652f\u540d\u79f0&gt;\n# \u5982\u679c\u672c\u5730\u5206\u652f\u548c\u8fdc\u7a0b\u5206\u652f\u540d\u5b57\u4e0d\u540c\uff0c\u53ef\u4ee5\u5199\u6210\u5982\u4e0b\u65b9\u5f0f\n$ git push origin &lt;\u672c\u5730\u5206\u652f\u540d\u79f0&gt;:&lt;\u8fdc\u7a0b\u5206\u652f\u540d\u79f0&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#5_2","title":"5. \u91cd\u547d\u540d\u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code>git remote rename old_name new_name\n</code></pre>"},{"location":"DevOps/Git/Git/#6","title":"6. \u5220\u9664\u8fdc\u7a0b\u4ed3\u5e93","text":"<pre><code>git remote rm python3-notes\n</code></pre>"},{"location":"DevOps/Git/Git/#_8","title":"\u4e03\u3001\u6807\u7b7e","text":""},{"location":"DevOps/Git/Git/#1_4","title":"1. \u6807\u7b7e\u7684\u5206\u7c7b","text":"<ol> <li>\u8f7b\u91cf\u6807\u7b7e\uff1a\u4e00\u4e2a\u8f7b\u91cf\u6807\u7b7e\u5f88\u50cf\u4e00\u4e2a\u4e0d\u4f1a\u6539\u53d8\u7684\u5206\u652f\uff0c\u5b83\u53ea\u662f\u4e00\u4e2a\u7279\u5b9a\u63d0\u4ea4\u7684\u5f15\u7528</li> <li>\u9644\u6ce8\u6807\u7b7e\uff1a\u5b58\u50a8\u5728Git\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u4e2a\u5b8c\u6574\u5bf9\u8c61</li> </ol> <p>\u9644\u6ce8\u6807\u7b7e\u5305\u542b\u6253\u6807\u7b7e\u8005\u7684\u540d\u5b57\u3001\u7535\u5b50\u90ae\u4ef6\u5730\u5740\u3001\u65e5\u671f\u65f6\u95f4\uff1b\u8fd8\u6709\u4e00\u4e2a\u6807\u7b7e\u4fe1\u606f\uff1b\u5e76\u4e14\u53ef\u4ee5\u4f7f\u7528 GNU Privacy Guard \uff08GPG\uff09\u7b7e\u540d\u4e0e\u9a8c\u8bc1\u3002 \u8f7b\u91cf\u6807\u7b7e\u672c\u8d28\u4e0a\u662f\u5c06\u63d0\u4ea4\u6821\u9a8c\u548c\u5b58\u50a8\u5230\u4e00\u4e2a\u6587 \u4ef6\u4e2d - \u6ca1\u6709\u4fdd\u5b58\u4efb\u4f55\u5176\u4ed6\u4fe1\u606f</p>"},{"location":"DevOps/Git/Git/#2_4","title":"2. \u67e5\u770b\u6807\u7b7e","text":"<pre><code># \u5217\u51fa\u6240\u6709\u6807\u7b7e\n$ git tag\n# \u67e5\u770b\u6807\u7b7e\u7684\u8be6\u7ec6\u4fe1\u606f\ngit show v1.4\n</code></pre>"},{"location":"DevOps/Git/Git/#3_4","title":"3. \u521b\u5efa\u6807\u7b7e","text":"<pre><code># \u521b\u5efa\u9644\u6ce8\u6807\u7b7e\n$ git tag -a v1.4 -m 'my version 1.4'\n# \u521b\u5efa\u8f7b\u91cf\u6807\u7b7e\ngit tag v1.4-lw\n# \u7ed9\u4e4b\u524d\u7684\u63d0\u4ea4\u6253\u6807\u7b7e\n$ git tag -a v1.2 9fceb02\n</code></pre>"},{"location":"DevOps/Git/Git/#4_3","title":"4. \u5171\u4eab\u6807\u7b7e","text":"<pre><code># \u628a\u6307\u5b9a\u6807\u7b7e\u63a8\u9001\u7684\u8fdc\u7a0b\u4ed3\u5e93\n$ git push origin [tagname]\n# \u63a8\u9001\u6240\u6709\u4e0d\u5728\u8fdc\u7a0b\u4ed3\u5e93\u670d\u52a1\u5668\u4e0a\u7684\u6807\u7b7e\n$ git push origin --tags\n</code></pre>"},{"location":"DevOps/Git/Git/#5_3","title":"5. \u68c0\u51fa\u6807\u7b7e","text":"<pre><code># \u5e76\u4e0d\u80fd\u771f\u7684\u68c0\u51fa\u4e00\u4e2a\u6807\u7b7e\uff0c\u53ea\u80fd\u5728\u7279\u5b9a\u7684\u6807\u7b7e\u4e0a\u521b\u5efa\u4e00\u4e2a\u65b0\u5206\u652f\n$ git checkout -b version2 v2.0.0\n</code></pre>"},{"location":"DevOps/Git/Git/#_9","title":"\u516b\u3001\u5206\u652f","text":""},{"location":"DevOps/Git/Git/#1_5","title":"1. \u672c\u5730\u5206\u652f","text":""},{"location":"DevOps/Git/Git/#1_6","title":"1. \u521b\u5efa\u5206\u652f","text":"<pre><code># \u521b\u5efa\u5206\u652f\n$ git branch &lt;\u5206\u652f\u540d\u79f0&gt; # \u5728\u5f53\u524d\u6240\u5728\u7684\u63d0\u4ea4\u5bf9\u8c61\u4e0a\u521b\u5efa\u4e00\u4e2a\u6307\u9488\n</code></pre>"},{"location":"DevOps/Git/Git/#2_5","title":"2. \u67e5\u770b\u5206\u652f\u5217\u8868","text":"<pre><code>$ git branch\n  gh-pages\n* master # `*`\u8868\u793a\u5f53\u524d\u5206\u652f\n# \u67e5\u770b\u6bcf\u4e00\u4e2a\u5206\u652f\u7684\u6700\u540e\u4e00\u6b21\u63d0\u4ea4\n$ git branch -v\n# \u8981\u67e5\u770b\u54ea\u4e9b\u5206\u652f\u5df2\u7ecf\u5408\u5e76\u5230\u5f53\u524d\u5206\u652f\n$ git branch --merged\n# \u67e5\u770b\u6240\u6709\u5305\u542b\u672a\u5408\u5e76\u5de5\u4f5c\u7684\u5206\u652f\n$ git branch --no-merged\n</code></pre>"},{"location":"DevOps/Git/Git/#3_5","title":"3. \u5207\u6362\u5206\u652f","text":"<pre><code>$ git checkout &lt;\u5206\u652f\u540d\u79f0&gt; # HEAD \u6307\u5411\u5f53\u524d\u5206\u652f\n# \u65b0\u5efa\u4e00\u4e2a\u5206\u652f\u5e76 \u540c\u65f6\u5207\u6362\u5230\u90a3\u4e2a\u5206\u652f\u4e0a\n$ git checkout -b iss53\n</code></pre> <p><code>git checkout master</code>\u505a\u4e86\u4e24\u4ef6\u4e8b\uff1a1.\u662f\u4f7f HEAD \u6307\u56de master \u5206\u652f\uff0c2\u3001\u5c06\u5de5\u4f5c\u76ee\u5f55\u6062\u590d\u6210 master \u5206\u652f\u6240\u6307\u5411\u7684\u5feb\u7167\u5185\u5bb9</p>"},{"location":"DevOps/Git/Git/#4_4","title":"4. \u5408\u5e76\u5206\u652f","text":"<pre><code>$ git merge &lt;\u5206\u652f\u540d\u79f0&gt;\n# \u5408\u5e76\u8fdc\u7a0b\u5206\u652f\u5230\u5f53\u524d\u5206\u652f\n$ git merge origin/&lt;\u8fdc\u7a0b\u5206\u652f\u540d\u79f0&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#5_4","title":"5. \u5220\u9664\u5206\u652f","text":"<pre><code># \u5220\u9664\u5206\u652f\n$ git branch -d &lt;\u5206\u652f\u540d\u79f0&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#2_6","title":"2.\u8fdc\u7a0b\u5206\u652f","text":"<p>\u8fdc\u7a0b\u5f15\u7528\uff1a\u662f\u5bf9\u8fdc\u7a0b\u4ed3\u5e93\u7684\u5f15\u7528\uff08\u6307\u9488\uff09\uff0c\u5305\u62ec\u5206\u652f\u3001\u6807\u7b7e\u7b49\u7b49\u3002</p> <p>\u8fdc\u7a0b\u8ddf\u8e2a\u5206\u652f\uff1a\u662f\u8fdc\u7a0b\u5206\u652f\u72b6\u6001\u7684\u5f15\u7528\uff0c\u4ee5 <code>(remote)/(branch)</code> \u5f62\u5f0f\u547d\u540d</p>"},{"location":"DevOps/Git/Git/#1_7","title":"1. \u67e5\u770b\u8fdc\u7a0b\u5206\u652f","text":"<pre><code>$ git remote\n# \u67e5\u770b\u6240\u6709\u7684\u8ddf\u8e2a\u5206\u652f\n$ git branch -vv\n</code></pre>"},{"location":"DevOps/Git/Git/#2_7","title":"2. \u66f4\u65b0\u8fdc\u7a0b\u4ed3\u5e93\u7684\u5f15\u7528","text":"<pre><code># \u4ece\u8fdc\u5904\u4ed3\u5e93\u62c9\u53d6\n$ git fetch &lt;\u8fdc\u7a0b\u4ed3\u5e93\u540d&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#3_6","title":"3. \u5408\u5e76\u5206\u652f","text":"<pre><code># \u5408\u5e76\u5206\u652f\n$ git merge origin/&lt;\u8fdc\u7a0b\u5206\u652f\u540d&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#4_5","title":"4. \u57fa\u4e8e\u8fdc\u7a0b\u8ddf\u8e2a\u5206\u652f\u521b\u5efa\u672c\u5730\u5206\u652f","text":"<pre><code>$ git checkout -b &lt;\u5206\u652f\u540d\u79f0&gt; origin/&lt;\u5206\u652f\u540d\u79f0&gt;\n# \u6216\u8005\u4f7f\u7528\n$ git checkout --track origin/&lt;\u5206\u652f\u540d\u79f0&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#5_5","title":"5. \u4fee\u6539\u6b63\u5728\u8ddf\u8e2a\u7684\u4e0a\u6e38\u5206\u652f\u6216\u8bbe\u7f6e\u5df2\u6709\u7684\u672c\u5730\u5206\u652f\u8ddf\u8e2a\u4e00\u4e2a\u521a\u521a\u62c9\u53d6\u4e0b\u6765\u7684\u8fdc\u7a0b\u5206\u652f","text":"<pre><code>#\n$ git branch -u origin/&lt;\u5206\u652f\u540d\u79f0&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#6_1","title":"6. \u5220\u9664\u8fdc\u7a0b\u5206\u652f","text":"<pre><code># \u5220\u9664\u8fdc\u7a0b\u5206\u652f\n$ git push origin --delete &lt;\u5206\u652f\u540d\u79f0&gt;\n</code></pre>"},{"location":"DevOps/Git/Git/#3_7","title":"3.\u5408\u5e76\u5206\u652f","text":""},{"location":"DevOps/Git/Git/#1_8","title":"1. \u5408\u5e76\u7b97\u6cd5","text":"<ol> <li>\u9012\u5f52\u7b97\u6cd5</li> <li>3\u8def\u7b97\u6cd5</li> <li>\u201coctpus\u201d\u7b97\u6cd5</li> </ol>"},{"location":"DevOps/Git/Git/#_10","title":"\u53d8\u57fa","text":"<p>\u5c06\u63d0\u4ea4\u5230\u67d0\u4e00\u5206\u652f\u4e0a\u7684\u6240\u6709\u4fee\u6539\u90fd\u79fb\u81f3\u53e6\u4e00\u5206\u652f\u4e0a</p>"},{"location":"DevOps/Git/Git/#git_3","title":"Git\u539f\u7406","text":"<p>git\u7684\u6838\u5fc3\u662f\u4e00\u4e2a\u5bf9\u8c61\u6570\u636e\u5e93\uff0c\u8be5\u6570\u636e\u5e93\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u6587\u672c\u6216\u4e8c\u8fdb\u5236\u6570\u636e\u3002</p>"},{"location":"DevOps/Git/Git/#_11","title":"\u5e95\u5c42\u547d\u540d","text":""},{"location":"DevOps/Git/Git/#1-git-rev-parse","title":"1. <code>git rev-parse</code>","text":"<pre><code># \u663e\u793a\u7248\u672c\u5e93\u76ee\u5f55\u6240\u5728\u4f4d\u7f6e\n$ git rev-parse --git-dir\nE:/notes/python3-notes/.git\n# \u663e\u793a\u5de5\u4f5c\u533a\u6839\u76ee\u5f55\n$ git rev-parse --show-toplevel\nE:/notes/python3-notes\n# \u663e\u793a\u76f8\u5bf9\u4e8e\u8ddf\u76ee\u5f55\u7684\u76f8\u5bf9\u76ee\u5f55\n$ git rev-parse --show-prefix\ndocs/img/\n# \u663e\u793a\u4ece\u5f53\u524d\u76ee\u5f55\u540e\u9000\u5230\u5de5\u4f5c\u76ee\u5f55\u7684\u6df1\u5ea6\n$ git rev-parse --show-cdup\n../../\n</code></pre> <p>\u6267\u884c<code>git add</code>\u64cd\u4f5c\u65f6\uff0c\u6682\u5b58\u533a\u7684\u76ee\u5f55\u6811\u5c06\u88ab\u66f4\u65b0\uff0c\u540c\u65f6\u5de5\u4f5c\u533a\u4fee\u6539\u7684\u6587\u4ef6\u5185\u5bb9\u4f1a\u88ab\u5199\u5165\u5230\u5bf9\u8c61\u5e93\u4e2d\u7684\u4e00\u4e2a\u65b0\u7684\u5bf9\u8c61\u4e2d\u3002</p> <p>\u5f53\u6267\u884c<code>git commit</code>\u65f6\uff0c\u6682\u5b58\u533a\u7684\u76ee\u5f55\u6811\u4f1a\u5199\u5165\u5230\u7248\u672c\u5e93\u4e2d\uff0cmaster\u5206\u652f\u4f1a\u505a\u76f8\u5e94\u7684\u66f4\u65b0\uff0c\u5373master\u6700\u65b0\u6307\u5411\u7684\u76ee\u5f55\u6811\u5c31\u662f\u63d0\u4ea4\u65f6\u539f\u6682\u5b58\u533a\u7684\u76ee\u5f55\u6811\u3002</p> <p>\u5f53\u6267\u884c<code>git reset HEAD</code>\u65f6\uff0c\u6682\u5b58\u533a\u7684\u76ee\u5f55\u6811\u4f1a\u88ab\u91cd\u65b0\uff0c\u4f1a\u88abmaster\u5206\u652f\u6307\u5411\u7684\u76ee\u5f55\u6811\u6240\u66ff\u6362\uff0c\u5de5\u4f5c\u533a\u4e0d\u53d7\u5f71\u54cd\u3002</p> <p>\u5f53\u6267\u884c<code>git rm --cached &lt;file&gt;</code>\u65f6\uff0c\u4f1a\u76f4\u63a5\u4ece\u6682\u5b58\u533a\u5220\u9664\u6587\u4ef6\uff0c\u5de5\u4f5c\u533a\u5219\u4e0d\u505a\u51fa\u6539\u53d8\u3002</p> <p>\u5f53\u6267\u884c<code>git checkout .</code>\u6216<code>git checkout -- &lt;file&gt;</code>\u65f6\uff0c\u4f1a\u7528\u6682\u5b58\u533a\u5168\u90e8\u7684\u6587\u4ef6\u6216\u6307\u5b9a\u7684\u6587\u4ef6\u66ff\u6362\u5de5\u4f5c\u533a\u7684\u6587\u4ef6\u3002</p> <p>\u5f53\u6267\u884c<code>git checkout HEAD .</code>\u6216<code>git checkout HEAD &lt;file&gt;</code>\u65f6\uff0c\u4f1a\u7528HEAD\u6307\u5411\u7684master\u5206\u652f\u4e2d\u7684\u5168\u90e8\u6216\u90e8\u5206\u6587\u4ef6\u66ff\u6362\u6682\u5b58\u533a\u548c\u5de5\u4f5c\u533a\u4e2d\u7684\u6587\u4ef6\u3002</p> <pre><code># \u663e\u793aHEAD\u6307\u5411\u7684\u76ee\u5f55\u6811\n$ git ls-tree -l HEAD\n100644 blob 4eeb754bb5131ccbe8de9cd73907a5215901aa15      15    .gitignore\n040000 tree 46fee821db1551e8341cf406271062eff4718c64       -    docs\n100644 blob 38d625ec66862f756ebe09b4af1a9b057f226e54    1249    mkdocs.yml\n#\u6587\u4ef6\u5c5e\u6027 blob\u5bf9\u8c61 SHA1\u683c\u5f0f\u7684ID\u503c                         \u6587\u4ef6\u5927\u5c0f  \u6587\u4ef6\u540d\n</code></pre> <pre><code># \u663e\u793a\u6682\u5b58\u533a\u76ee\u5f55\u6811\n$ git ls-files -s\n100644 4eeb754bb5131ccbe8de9cd73907a5215901aa15 0       .gitignore\n100644 5c53539c2d6ec00fe3335ba9b86339ab2cdbc705 0       docs/about.md\n                                            \u6682\u5b58\u533a\u7f16\u53f7\n</code></pre> <p>Git\u5bf9\u8c61</p>"},{"location":"DevOps/Git/Git/#git-lfs","title":"Git LFS","text":""},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/","title":"pipeline-syntax","text":""},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#declarative-pipeline","title":"Declarative Pipeline","text":"<p>Declarative Pipeline is a relatively recent addition to Jenkins Pipeline [1] which presents a more simplified and opinionated syntax on top of the Pipeline sub-systems.</p> <p>All valid Declarative Pipelines must be enclosed within a <code>pipeline</code> block, for example:</p> <p><code>groovy pipeline {     /* insert Declarative Pipeline here */ }</code></p> <p>The basic statements and expressions which are valid in Declarative Pipeline follow the same rules as Groovy\u2019s syntax with the following exceptions:</p> <ul> <li>The top-level of the Pipeline must be a block, specifically: <code>pipeline { }</code>.</li> <li>No semicolons as statement separators. Each statement has to be on its own line.</li> <li>Blocks must only consist of Sections, Directives, Steps, or assignment statements.</li> <li>A property reference statement is treated as a no-argument method invocation. So, for example, <code>input</code> is treated as <code>input()</code>.</li> </ul> <p>You can use the Declarative Directive Generator to help you get started with configuring the directives and sections in your Declarative Pipeline.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#sections","title":"Sections","text":"<p>Sections in Declarative Pipeline typically contain one or more Directives or Steps.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#agent","title":"agent","text":"<p>The <code>agent</code> section specifies where the entire Pipeline, or a specific stage, will execute in the Jenkins environment depending on where the <code>agent</code> section is placed. The section must be defined at the top-level inside the <code>pipeline</code> block, but stage-level usage is optional.</p> Required Yes Parameters Described below Allowed In the top-level <code>pipeline</code> block and each <code>stage</code> block."},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#differences-between-top-and-stage-level-agents","title":"Differences between top and stage level Agents","text":"<p>There are some nuances when adding an agent to the top level or a stage level, and this when the <code>options</code> directive is applied.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#top-level-agents","title":"Top Level Agents","text":"<p>In <code>agents</code> declared at the outermost level of the Pipeline, the options are invoked after entering the agent. As an example, when using <code>timeout</code> it will be only applied to the execution within the agent.</p> <pre><code>node(\"myAgent\") {\n    timeout(unit: 'SECONDS', time: 5) {\n        stage(\"One\"){\n            sleep 10\n            echo 'hello'\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#stage-agents","title":"Stage Agents","text":"<p>In <code>agents</code> declared within a stage, the options are invoked before entering the <code>agent</code> and before checking any <code>when</code> conditions. In this case, when using <code>timeout</code>, it is applied before the <code>agent</code> is allocated.</p> <pre><code>timeout(unit: 'SECONDS', time: 5) {\n    stage(\"One\"){\n        node {\n            sleep 10\n            echo 'Hello'\n        }\n    }\n}\n</code></pre> <p>This timeout will include the agent provisioning time. Because the timeout includes the agent provisioning time, the Pipeline may fail in cases where agent allocation is delayed.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#parameters","title":"Parameters","text":"<p>In order to support the wide variety of use-cases Pipeline authors may have, the <code>agent</code> section supports a few different types of parameters. These parameters can be applied at the top-level of the <code>pipeline</code> block, or within each <code>stage</code> directive.</p> <ul> <li>any</li> </ul> <p>Execute the Pipeline, or stage, on any available agent. For example: <code>agent any</code></p> <ul> <li>none</li> </ul> <p>When applied at the top-level of the <code>pipeline</code> block no global agent will be allocated for the entire Pipeline run and each <code>stage</code> section will need to contain its own <code>agent</code> section. For example: <code>agent none</code></p> <ul> <li>label</li> </ul> <p>Execute the Pipeline, or stage, on an agent available in the Jenkins environment with the provided label. For example: <code>agent { label 'my-defined-label' }</code>Label conditions can also be used. For example: <code>agent { label 'my-label1 &amp;&amp; my-label2' }</code> or <code>agent { label 'my-label1 || my-label2' }</code></p> <ul> <li>node</li> </ul> <p><code>agent { node { label 'labelName' } }</code> behaves the same as <code>agent { label 'labelName' }</code>, but <code>node</code> allows for additional options (such as <code>customWorkspace</code>).</p> <ul> <li>docker</li> </ul> <p>Execute the Pipeline, or stage, with the given container which will be dynamically provisioned on a node pre-configured to accept Docker-based Pipelines, or on a node matching the optionally defined <code>label</code> parameter. <code>docker</code> also optionally accepts an <code>args</code> parameter which may contain arguments to pass directly to a <code>docker run</code> invocation, and an <code>alwaysPull</code> option, which will force a <code>docker pull</code> even if the image name is already present. For example: <code>agent { docker 'maven:3-alpine' }</code> or</p> <pre><code>```groovy\nagent {    \n    docker {        \n        image 'maven:3-alpine'        \n        label 'my-defined-label'        \n        args  '-v /tmp:/tmp'    \n    } \n}\n```\n</code></pre> <p><code>docker</code> also optionally accepts a <code>registryUrl</code> and <code>registryCredentialsId</code> parameters which will help to specify the Docker Registry to use and its credentials. The parameter <code>registryCredentialsId</code> could be used alone for private repositories within the docker hub. For example:</p> <pre><code>agent {    \n    docker {        \n        image 'myregistry.com/node'        \n        label 'my-defined-label'        \n        registryUrl 'https://myregistry.com/'        \n        registryCredentialsId 'myPredefinedCredentialsInJenkins'    \n    } \n}\n</code></pre> <ul> <li>dockerfile</li> </ul> <p>Execute the Pipeline, or stage, with a container built from a <code>Dockerfile</code> contained in the source repository. In order to use this option, the <code>Jenkinsfile</code> must be loaded from either a Multibranch Pipeline or a Pipeline from SCM. Conventionally this is the <code>Dockerfile</code> in the root of the source repository: <code>agent { dockerfile true }</code>. If building a <code>Dockerfile</code> in another directory, use the <code>dir</code> option: <code>agent { dockerfile { dir 'someSubDir' } }</code>. If your <code>Dockerfile</code> has another name, you can specify the file name with the <code>filename</code> option. You can pass additional arguments to the <code>docker build \u2026</code>command with the <code>additionalBuildArgs</code> option, like <code>agent { dockerfile { additionalBuildArgs '--build-arg foo=bar' } }</code>. For example, a repository with the file <code>build/Dockerfile.build</code>, expecting a build argument <code>version</code>:</p> <pre><code>agent {    \n// Equivalent to \"docker build -f Dockerfile.build --build-arg version=1.0.2 ./build/    \n  dockerfile {        \n        filename 'Dockerfile.build'        \n      dir 'build'        \n        label 'my-defined-label'        \n        additionalBuildArgs  '--build-arg version=1.0.2'         args '-v /tmp:/tmp'    \n        } \n}\n</code></pre> <p><code>dockerfile</code> also optionally accepts a <code>registryUrl</code> and <code>registryCredentialsId</code> parameters which will help to specify the Docker Registry to use and its credentials. For example:</p> <pre><code>agent {\n  dockerfile {\n      filename 'Dockerfile.build'\n      dir 'build'\n      label 'my-defined-label'\n      registryUrl 'https://myregistry.com/'\n      registryCredentialsId 'myPredefinedCredentialsInJenkins'\n  }\n}\n</code></pre> <ul> <li>kubernetes</li> </ul> <p>Execute the Pipeline, or stage, inside a pod deployed on a Kubernetes cluster. In order to use this option, the <code>Jenkinsfile</code> must be loaded from either a Multibranch Pipeline or a Pipeline from SCM. The Pod template is defined inside the kubernetes { } block. For example, if you want a pod with a Kaniko container inside it, you would define it as follows:</p> <p><code>groovy agent { kubernetes { label podlabel yaml  \"\"\"  kind: Pod  metadata:       name: jenkins-agent  spec:       containers:       - name: kaniko           image: gcr.io/kaniko-project/executor:debug           imagePullPolicy: Always           command:           - /busybox/cat           tty: true           volumeMounts:               - name: aws-secret                   mountPath: /root/.aws/               - name: docker-registry-config                   mountPath: /kaniko/.docker       restartPolicy: Never       volumes:           - name: aws-secret               secret:                   secretName: aws-secret           - name: docker-registry-config               configMap:                   name: docker-registry-config  \"\"\"      }</code></p> <p>You will need to create a secret <code>aws-secret</code> for Kaniko to be able to authenticate with ECR. This secret should contain the contents of <code>~/.aws/credentials</code>. The other volume is a ConfigMap which should contain the endpoint of your ECR registry. For example:</p> <p><code>groovy {           \"credHelpers\": {         \".dkr.ecr.eu-central-1.amazonaws.com\": \"ecr-login\"               }  }</code></p> <p>Refer to the following example for reference: https://github.com/jenkinsci/kubernetes-plugin/blob/master/examples/kaniko.groovy</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#common-options","title":"Common Options","text":"<p>These are a few options that can be applied to two or more <code>agent</code> implementations. They are not required unless explicitly stated.</p> <ul> <li>label</li> </ul> <p>A string. The label or label condition on which to run the Pipeline or individual <code>stage</code>.This option is valid for <code>node</code>, <code>docker</code>, and <code>dockerfile</code>, and is required for <code>node</code>.</p> <ul> <li>customWorkspace</li> </ul> <p>A string. Run the Pipeline or individual <code>stage</code> this <code>agent</code> is applied to within this custom workspace, rather than the default. It can be either a relative path, in which case the custom workspace will be under the workspace root on the node, or an absolute path. For example:</p> <pre><code>agent {    \n    node {        \n        label 'my-defined-label'        \n        customWorkspace '/some/other/path'    \n    } \n}\n</code></pre> <p>This option is valid for <code>node</code>, <code>docker</code>, and <code>dockerfile</code>.</p> <ul> <li>reuseNode</li> </ul> <p>A boolean, false by default. If true, run the container on the node specified at the top-level of the Pipeline, in the same workspace, rather than on a new node entirely.This option is valid for <code>docker</code> and <code>dockerfile</code>, and only has an effect when used on an <code>agent</code> for an individual <code>stage</code>.</p> <ul> <li>args</li> </ul> <p>A string. Runtime arguments to pass to <code>docker run</code>.This option is valid for <code>docker</code> and <code>dockerfile</code>.</p> <p>Example 1. Docker Agent, Declarative Pipeline</p> <pre><code>pipeline {\n    agent { docker 'maven:3-alpine' }  // \u2460\n    stages {\n        stage('Example Build') {\n            steps {\n                sh 'mvn -B clean verify'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460Execute all the steps defined in this Pipeline within a newly created container of the given name and tag (<code>maven:3-alpine</code>).</p> <p>Example 2. Stage-level Agent Section</p> <pre><code>pipeline {\n    agent none // \u2460\n    stages {\n        stage('Example Build') {\n            agent { docker 'maven:3-alpine' } // \u2461\n            steps {\n                echo 'Hello, Maven'\n                sh 'mvn --version'\n            }\n        }\n        stage('Example Test') {\n            agent { docker 'openjdk:8-jre' } //\u2462\n            steps {\n                echo 'Hello, JDK'\n                sh 'java -version'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460 Defining <code>agent none</code> at the top-level of the Pipeline ensures that an Executor will not be assigned unnecessarily. Using <code>agent none</code> also forces each <code>stage</code> section to contain its own <code>agent</code> section. </p> <p>\u2461 Execute the steps in this stage in a newly created container using this image.  \u2462 Execute the steps in this stage in a newly created container using a different image from the previous stage.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#post","title":"post","text":"<p>The <code>post</code> section defines one or more additional steps that are run upon the completion of a Pipeline\u2019s or stage\u2019s run (depending on the location of the <code>post</code> section within the Pipeline). <code>post</code> can support any of the following post-condition blocks: <code>always</code>, <code>changed</code>, <code>fixed</code>, <code>regression</code>, <code>aborted</code>, <code>failure</code>, <code>success</code>, <code>unstable</code>, <code>unsuccessful</code>, and <code>cleanup</code>. These condition blocks allow the execution of steps inside each condition depending on the completion status of the Pipeline or stage. The condition blocks are executed in the order shown below.</p> Required No Parameters None Allowed In the top-level <code>pipeline</code> block and each <code>stage</code> block."},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#conditions","title":"Conditions","text":"<ul> <li><code>always</code></li> </ul> <p>Run the steps in the <code>post</code> section regardless of the completion status of the Pipeline\u2019s or stage\u2019s run.</p> <ul> <li><code>changed</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run has a different completion status from its previous run.</p> <ul> <li><code>fixed</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run is successful and the previous run failed or was unstable.</p> <ul> <li><code>regression</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run\u2019s status is failure, unstable, or aborted and the previous run was successful.</p> <ul> <li><code>aborted</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run has an \"aborted\" status, usually due to the Pipeline being manually aborted. This is typically denoted by gray in the web UI.</p> <ul> <li><code>failure</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run has a \"failed\" status, typically denoted by red in the web UI.</p> <ul> <li><code>success</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run has a \"success\" status, typically denoted by blue or green in the web UI.</p> <ul> <li><code>unstable</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run has an \"unstable\" status, usually caused by test failures, code violations, etc. This is typically denoted by yellow in the web UI.</p> <ul> <li><code>unsuccessful</code></li> </ul> <p>Only run the steps in <code>post</code> if the current Pipeline\u2019s or stage\u2019s run has not a \"success\" status. This is typically denoted in the web UI depending on the status previously mentioned.</p> <ul> <li><code>cleanup</code></li> </ul> <p>Run the steps in this <code>post</code> condition after every other <code>post</code> condition has been evaluated, regardless of the Pipeline or stage\u2019s status.</p> <p>Example 3. Post Section, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n    }\n    post {  // \u2460\n        always { // \u2461\n            echo 'I will always say Hello again!'\n        }\n    }\n}\n</code></pre> <p>\u2460 Conventionally, the <code>post</code> section should be placed at the end of the Pipeline.  \u2461 Post-condition blocks contain steps the same as the steps section.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#stages","title":"stages","text":"<p>Containing a sequence of one or more stage directives, the <code>stages</code> section is where the bulk of the \"work\" described by a Pipeline will be located. At a minimum, it is recommended that <code>stages</code> contain at least one stage directive for each discrete part of the continuous delivery process, such as Build, Test, and Deploy.</p> Required Yes Parameters None Allowed Only once, inside the <code>pipeline</code> block. <p>Example 4. Stages, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages { // \u2460\n        stage('Example') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460  The <code>stages</code> section will typically follow the directives such as <code>agent</code>, <code>options</code>, etc.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#steps","title":"steps","text":"<p>The <code>steps</code> section defines a series of one or more steps to be executed in a given <code>stage</code> directive.</p> Required Yes Parameters None Allowed Inside each <code>stage</code> block. <p>Example 5. Single Step, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example') {\n            steps { // \u2460\n                echo 'Hello World'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460 The <code>steps</code> section must contain one or more steps.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#directives","title":"Directives","text":""},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#environment","title":"environment","text":"<p>The <code>environment</code> directive specifies a sequence of key-value pairs which will be defined as environment variables for all steps, or stage-specific steps, depending on where the <code>environment</code> directive is located within the Pipeline.</p> <p>This directive supports a special helper method <code>credentials()</code> which can be used to access pre-defined Credentials by their identifier in the Jenkins environment.</p> Required No Parameters None Allowed Inside the <code>pipeline</code> block, or within <code>stage</code> directives."},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#supported-credentials-type","title":"Supported Credentials Type","text":"<ul> <li>Secret Text</li> </ul> <p>the environment variable specified will be set to the Secret Text content</p> <ul> <li>Secret File</li> </ul> <p>the environment variable specified will be set to the location of the File file that is temporarily created</p> <ul> <li>Username and password</li> </ul> <p>the environment variable specified will be set to <code>username:password</code> and two additional environment variables will be automatically defined: <code>MYVARNAME_USR</code> and <code>MYVARNAME_PSW</code> respectively.</p> <ul> <li>SSH with Private Key</li> </ul> <p>the environment variable specified will be set to the location of the SSH key file that is temporarily created and two additional environment variables may be automatically defined: <code>MYVARNAME_USR</code> and <code>MYVARNAME_PSW</code> (holding the passphrase).</p> <p>Unsupported credentials type causes the pipeline to fail with the message: <code>org.jenkinsci.plugins.credentialsbinding.impl.CredentialNotFoundException: No suitable binding handler could be found for type .</code></p> <p>Example 6. Secret Text Credentials, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    environment { // \u2460\n        CC = 'clang'\n    }\n    stages {\n        stage('Example') {\n            environment { // \u2461\n                AN_ACCESS_KEY = credentials('my-predefined-secret-text') // \u2462\n            }\n            steps {\n                sh 'printenv'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460 An <code>environment</code> directive used in the top-level <code>pipeline</code> block will apply to all steps within the Pipeline. \u2461 An <code>environment</code> directive defined within a <code>stage</code> will only apply the given environment variables to steps within the <code>stage</code>. \u2462 The <code>environment</code> block has a helper method <code>credentials()</code> defined which can be used to access pre-defined Credentials by their identifier in the Jenkins environment.</p> <p>Example 7. Username and Password Credentials</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example Username/Password') {\n            environment {\n                SERVICE_CREDS = credentials('my-predefined-username-password')\n            }\n            steps {\n                sh 'echo \"Service user is $SERVICE_CREDS_USR\"'\n                sh 'echo \"Service password is $SERVICE_CREDS_PSW\"'\n                sh 'curl -u $SERVICE_CREDS https://myservice.example.com'\n            }\n        }\n        stage('Example SSH Username with private key') {\n            environment {\n                SSH_CREDS = credentials('my-predefined-ssh-creds')\n            }\n            steps {\n                sh 'echo \"SSH private key is located at $SSH_CREDS\"'\n                sh 'echo \"SSH user is $SSH_CREDS_USR\"'\n                sh 'echo \"SSH passphrase is $SSH_CREDS_PSW\"'\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#options","title":"options","text":"<p>The <code>options</code> directive allows configuring Pipeline-specific options from within the Pipeline itself. Pipeline provides a number of these options, such as <code>buildDiscarder</code>, but they may also be provided by plugins, such as <code>timestamps</code>.</p> Required No Parameters None Allowed Only once, inside the <code>pipeline</code> block."},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#available-options","title":"Available Options","text":"<ul> <li>buildDiscarder</li> </ul> <p>Persist artifacts and console output for the specific number of recent Pipeline runs. For example: <code>options { buildDiscarder(logRotator(numToKeepStr: '1')) }</code></p> <ul> <li>checkoutToSubdirectory</li> </ul> <p>Perform the automatic source control checkout in a subdirectory of the workspace. For example: <code>options { checkoutToSubdirectory('foo') }</code></p> <ul> <li>disableConcurrentBuilds</li> </ul> <p>Disallow concurrent executions of the Pipeline. Can be useful for preventing simultaneous accesses to shared resources, etc. For example: <code>options { disableConcurrentBuilds() }</code></p> <ul> <li>disableResume</li> </ul> <p>Do not allow the pipeline to resume if the controller restarts. For example: <code>options { disableResume() }</code></p> <ul> <li>newContainerPerStage</li> </ul> <p>Used with <code>docker</code> or <code>dockerfile</code> top-level agent. When specified, each stage will run in a new container instance on the same node, rather than all stages running in the same container instance.</p> <ul> <li>overrideIndexTriggers</li> </ul> <p>Allows overriding default treatment of branch indexing triggers. If branch indexing triggers are disabled at the multibranch or organization label, <code>options { overrideIndexTriggers(true) }</code> will enable them for this job only. Otherwise, <code>options { overrideIndexTriggers(false) }</code> will disable branch indexing triggers for this job only.</p> <ul> <li>preserveStashes</li> </ul> <p>Preserve stashes from completed builds, for use with stage restarting. For example: <code>options { preserveStashes() }</code> to preserve the stashes from the most recent completed build, or <code>options { preserveStashes(buildCount: 5) }</code> to preserve the stashes from the five most recent completed builds.</p> <ul> <li>quietPeriod</li> </ul> <p>Set the quiet period, in seconds, for the Pipeline, overriding the global default. For example: <code>options { quietPeriod(30) }</code></p> <ul> <li>retry</li> </ul> <p>On failure, retry the entire Pipeline the specified number of times. For example: <code>options { retry(3) }</code></p> <ul> <li>skipDefaultCheckout</li> </ul> <p>Skip checking out code from source control by default in the <code>agent</code> directive. For example: <code>options { skipDefaultCheckout() }</code></p> <ul> <li>skipStagesAfterUnstable</li> </ul> <p>Skip stages once the build status has gone to UNSTABLE. For example: <code>options { skipStagesAfterUnstable() }</code></p> <ul> <li>timeout</li> </ul> <p>Set a timeout period for the Pipeline run, after which Jenkins should abort the Pipeline. For example: <code>options { timeout(time: 1, unit: 'HOURS') }</code></p> <p>Example 8. Global Timeout, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    options {\n        timeout(time: 1, unit: 'HOURS')  // \u2460\n    }\n    stages {\n        stage('Example') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460 Specifying a global execution timeout of one hour, after which Jenkins will abort the Pipeline run.</p> <ul> <li>timestamps</li> </ul> <p>Prepend all console output generated by the Pipeline run with the time at which the line was emitted. For example: <code>options { timestamps() }</code></p> <ul> <li>parallelsAlwaysFailFast</li> </ul> <p>Set failfast true for all subsequent parallel stages in the pipeline. For example: <code>options { parallelsAlwaysFailFast() }</code></p> <p>A comprehensive list of available options is pending the completion of INFRA-1503.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#stage-options","title":"stage options","text":"<p>The <code>options</code> directive for a <code>stage</code> is similar to the <code>options</code> directive at the root of the Pipeline. However, the <code>stage</code>-level <code>options</code> can only contain steps like <code>retry</code>, <code>timeout</code>, or <code>timestamps</code>, or Declarative options that are relevant to a <code>stage</code>, like <code>skipDefaultCheckout</code>.</p> <p>Inside a <code>stage</code>, the steps in the <code>options</code> directive are invoked before entering the <code>agent</code> or checking any <code>when</code> conditions.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#available-stage-options","title":"Available Stage Options","text":"<ul> <li>skipDefaultCheckout</li> </ul> <p>Skip checking out code from source control by default in the <code>agent</code> directive. For example: <code>options { skipDefaultCheckout() }</code></p> <ul> <li>timeout</li> </ul> <p>Set a timeout period for this stage, after which Jenkins should abort the stage. For example: <code>options { timeout(time: 1, unit: 'HOURS') }</code></p> <p>Example 9. Stage Timeout, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example') {\n            options {\n                timeout(time: 1, unit: 'HOURS') // \u2460\n            }\n            steps {\n                echo 'Hello World'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460 Specifying an execution timeout of one hour for the <code>Example</code> stage, after which Jenkins will abort the Pipeline run.</p> <ul> <li>retry</li> </ul> <p>On failure, retry this stage the specified number of times. For example: <code>options { retry(3) }</code></p> <ul> <li>timestamps</li> </ul> <p>Prepend all console output generated during this stage with the time at which the line was emitted. For example: <code>options { timestamps() }</code></p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#parameters_1","title":"parameters","text":"<p>The <code>parameters</code> directive provides a list of parameters that a user should provide when triggering the Pipeline. The values for these user-specified parameters are made available to Pipeline steps via the <code>params</code> object, see the Parameters, Declarative Pipeline for its specific usage.</p> Required No Parameters None Allowed Only once, inside the <code>pipeline</code> block."},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#available-parameters","title":"Available Parameters","text":"<ul> <li>string</li> </ul> <p>A parameter of a string type, for example: <code>parameters { string(name: 'DEPLOY_ENV', defaultValue: 'staging', description: '') }</code></p> <ul> <li>text</li> </ul> <p>A text parameter, which can contain multiple lines, for example: <code>parameters { text(name: 'DEPLOY_TEXT', defaultValue: 'One\\nTwo\\nThree\\n', description: '') }</code></p> <ul> <li>booleanParam</li> </ul> <p>A boolean parameter, for example: <code>parameters { booleanParam(name: 'DEBUG_BUILD', defaultValue: true, description: '') }</code></p> <ul> <li>choice</li> </ul> <p>A choice parameter, for example: <code>parameters { choice(name: 'CHOICES', choices: ['one', 'two', 'three'], description: '') }</code></p> <ul> <li>password</li> </ul> <p>A password parameter, for example: <code>parameters { password(name: 'PASSWORD', defaultValue: 'SECRET', description: 'A secret password') }</code></p> <p>Example 10. Parameters, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    parameters {\n        string(name: 'PERSON', defaultValue: 'Mr Jenkins', description: 'Who should I say hello to?')\n\n        text(name: 'BIOGRAPHY', defaultValue: '', description: 'Enter some information about the person')\n\n        booleanParam(name: 'TOGGLE', defaultValue: true, description: 'Toggle this value')\n\n        choice(name: 'CHOICE', choices: ['One', 'Two', 'Three'], description: 'Pick something')\n\n        password(name: 'PASSWORD', defaultValue: 'SECRET', description: 'Enter a password')\n    }\n    stages {\n        stage('Example') {\n            steps {\n                echo \"Hello ${params.PERSON}\"\n\n                echo \"Biography: ${params.BIOGRAPHY}\"\n\n                echo \"Toggle: ${params.TOGGLE}\"\n\n                echo \"Choice: ${params.CHOICE}\"\n\n                echo \"Password: ${params.PASSWORD}\"\n            }\n        }\n    }\n}\n</code></pre> <p>A comprehensive list of available parameters is pending the completion of INFRA-1503. </p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#triggers","title":"triggers","text":"<p>The <code>triggers</code> directive defines the automated ways in which the Pipeline should be re-triggered. For Pipelines which are integrated with a source such as GitHub or BitBucket, <code>triggers</code> may not be necessary as webhooks-based integration will likely already be present. The triggers currently available are <code>cron</code>, <code>pollSCM</code> and <code>upstream</code>.</p> Required No Parameters None Allowed Only once, inside the <code>pipeline</code> block. <ul> <li>cron</li> </ul> <p>Accepts a cron-style string to define a regular interval at which the Pipeline should be re-triggered, for example: <code>triggers { cron('H */4 * * 1-5') }</code></p> <ul> <li>pollSCM</li> </ul> <p>Accepts a cron-style string to define a regular interval at which Jenkins should check for new source changes. If new changes exist, the Pipeline will be re-triggered. For example: <code>triggers { pollSCM('H */4 * * 1-5') }</code></p> <ul> <li>upstream</li> </ul> <p>Accepts a comma-separated string of jobs and a threshold. When any job in the string finishes with the minimum threshold, the Pipeline will be re-triggered. For example: <code>triggers { upstream(upstreamProjects: 'job1,job2', threshold: hudson.model.Result.SUCCESS) }</code></p> <p>The <code>pollSCM</code> trigger is only available in Jenkins 2.22 or later.</p> <p>Example 11. Triggers, Declarative Pipeline</p> <pre><code>// Declarative //\npipeline {\n    agent any\n    triggers {\n        cron('H */4 * * 1-5')\n    }\n    stages {\n        stage('Example') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#jenkins-cron-syntax","title":"Jenkins cron syntax","text":"<p>The Jenkins cron syntax follows the syntax of the cron utility (with minor differences). Specifically, each line consists of 5 fields separated by TAB or whitespace:</p> MINUTE HOUR DOM MONTH DOW Minutes within the hour (0\u201359) The hour of the day (0\u201323) The day of the month (1\u201331) The month (1\u201312) The day of the week (0\u20137) where 0 and 7 are Sunday. <p>To specify multiple values for one field, the following operators are available. In the order of precedence,</p> <ul> <li><code>*</code> specifies all valid values</li> <li><code>M-N</code> specifies a range of values</li> <li><code>M-N/X</code> or <code>*/X</code> steps by intervals of <code>X</code> through the specified range or whole valid range</li> <li><code>A,B,\u2026,Z</code> enumerates multiple values</li> </ul> <p>To allow periodically scheduled tasks to produce even load on the system, the symbol <code>H</code> (for \u201chash\u201d) should be used wherever possible. For example, using <code>0 0 * * *</code> for a dozen daily jobs will cause a large spike at midnight. In contrast, using <code>H H * * *</code> would still execute each job once a day, but not all at the same time, better using limited resources.</p> <p>The <code>H</code> symbol can be used with a range. For example, <code>H H(0-7) * * *</code> means some time between 12:00 AM (midnight) to 7:59 AM. You can also use step intervals with <code>H</code>, with or without ranges.</p> <p>The <code>H</code> symbol can be thought of as a random value over a range, but it actually is a hash of the job name, not a random function, so that the value remains stable for any given project.</p> <p>Beware that for the day of month field, short cycles such as <code>*/3</code> or <code>H/3</code> will not work consistently near the end of most months, due to variable month lengths. For example, <code>*/3</code> will run on the 1st, 4th, \u202631st days of a long month, then again the next day of the next month. Hashes are always chosen in the 1-28 range, so <code>H/3</code> will produce a gap between runs of between 3 and 6 days at the end of a month. (Longer cycles will also have inconsistent lengths but the effect may be relatively less noticeable.)</p> <p>Empty lines and lines that start with <code>#</code> will be ignored as comments.</p> <p>In addition, <code>@yearly</code>, <code>@annually</code>, <code>@monthly</code>, <code>@weekly</code>, <code>@daily</code>, <code>@midnight</code>, and <code>@hourly</code> are supported as convenient aliases. These use the hash system for automatic balancing. For example, <code>@hourly</code> is the same as <code>H * * * *</code> and could mean at any time during the hour. <code>@midnight</code> actually means some time between 12:00 AM and 2:59 AM.</p> example every fifteen minutes (perhaps at :07, :22, :37, :52) <code>triggers{ cron('H/15 * * * *') }</code> every ten minutes in the first half of every hour (three times, perhaps at :04, :14, :24) <code>triggers{ cron('H(0-29)/10 * * * *') }</code> once every two hours at 45 minutes past the hour starting at 9:45 AM and finishing at 3:45 PM every weekday. <code>triggers{ cron('45 9-16/2 * * 1-5') }</code> once in every two hours slot between 9 AM and 5 PM every weekday (perhaps at 10:38 AM, 12:38 PM, 2:38 PM, 4:38 PM) <code>triggers{ cron('H H(9-16)/2 * * 1-5') }</code> once a day on the 1st and 15th of every month except December <code>triggers{ cron('H H 1,15 1-11 *') }</code>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#stage","title":"stage","text":"<p>The <code>stage</code> directive goes in the <code>stages</code> section and should contain a steps section, an optional <code>agent</code> section, or other stage-specific directives. Practically speaking, all of the real work done by a Pipeline will be wrapped in one or more <code>stage</code> directives.</p> Required At least one Parameters One mandatory parameter, a string for the name of the stage. Allowed Inside the <code>stages</code> section. <p>Example 12. Stage, Declarative Pipeline</p> <pre><code>// Declarative //\npipeline {\n    agent any\n    stages {\n        stage('Example') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#tools","title":"tools","text":"<p>A section defining tools to auto-install and put on the <code>PATH</code>. This is ignored if <code>agent none</code> is specified.</p> Required No Parameters None Allowed Inside the <code>pipeline</code> block or a <code>stage</code> block."},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#supported-tools","title":"Supported Tools","text":"<ul> <li>maven</li> <li>jdk</li> <li>gradle</li> </ul> <p>Example 13. Tools, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    tools {\n        maven 'apache-maven-3.0.1' // \u2460\n    }\n    stages {\n        stage('Example') {\n            steps {\n                sh 'mvn --version'\n            }\n        }\n    }\n}\n</code></pre> <p>The tool name must be pre-configured in Jenkins under Manage Jenkins \u2192 Global Tool Configuration. </p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#input","title":"input","text":"<p>The <code>input</code> directive on a <code>stage</code> allows you to prompt for input, using the <code>input</code> step. The <code>stage</code> will pause after any <code>options</code> have been applied, and before entering the <code>agent</code> block for that <code>stage</code> or evaluating the <code>when</code> condition of the <code>stage</code>. If the <code>input</code> is approved, the <code>stage</code> will then continue. Any parameters provided as part of the <code>input</code> submission will be available in the environment for the rest of the <code>stage</code>.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#configuration-options","title":"Configuration options","text":"<ul> <li>message</li> </ul> <p>Required. This will be presented to the user when they go to submit the <code>input</code>.</p> <ul> <li>id</li> </ul> <p>An optional identifier for this <code>input</code>. Defaults to the <code>stage</code> name.</p> <ul> <li>ok</li> </ul> <p>Optional text for the \"ok\" button on the <code>input</code> form.</p> <ul> <li>submitter</li> </ul> <p>An optional comma-separated list of users or external group names who are allowed to submit this <code>input</code>. Defaults to allowing any user.</p> <ul> <li>submitterParameter</li> </ul> <p>An optional name of an environment variable to set with the <code>submitter</code> name, if present.</p> <ul> <li>parameters</li> </ul> <p>An optional list of parameters to prompt the submitter to provide. See parameters for more information.</p> <p>Example 14. Input Step, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example') {\n            input {\n                message \"Should we continue?\"\n                ok \"Yes, we should.\"\n                submitter \"alice,bob\"\n                parameters {\n                    string(name: 'PERSON', defaultValue: 'Mr Jenkins', description: 'Who should I say hello to?')\n                }\n            }\n            steps {\n                echo \"Hello, ${PERSON}, nice to meet you.\"\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#when","title":"when","text":"<p>The <code>when</code> directive allows the Pipeline to determine whether the stage should be executed depending on the given condition. The <code>when</code> directive must contain at least one condition. If the <code>when</code> directive contains more than one condition, all the child conditions must return true for the stage to execute. This is the same as if the child conditions were nested in an <code>allOf</code> condition (see the examples below). If an <code>anyOf</code> condition is used, note that the condition skips remaining tests as soon as the first \"true\" condition is found.</p> <p>More complex conditional structures can be built using the nesting conditions: <code>not</code>, <code>allOf</code>, or <code>anyOf</code>. Nesting conditions may be nested to any arbitrary depth.</p> Required No Parameters None Allowed Inside a <code>stage</code> directive"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#built-in-conditions","title":"Built-in Conditions","text":"<ul> <li>branch</li> </ul> <p>Execute the stage when the branch being built matches the branch pattern (ANT style path glob) given, for example: <code>when { branch 'master' }</code>. Note that this only works on a multibranch Pipeline.The optional parameter <code>comparator</code> may be added after an attribute to specify how any patterns are evaluated for a match: <code>EQUALS</code> for a simple string comparison, <code>GLOB</code> (the default) for an ANT style path glob (same as for example <code>changeset</code>), or <code>REGEXP</code> for regular expression matching. For example: <code>when { branch pattern: \"release-\\\\d+\", comparator: \"REGEXP\"}</code></p> <ul> <li>buildingTag</li> </ul> <p>Execute the stage when the build is building a tag. Example: <code>when { buildingTag() }</code></p> <ul> <li>changelog</li> </ul> <p>Execute the stage if the build\u2019s SCM changelog contains a given regular expression pattern, for example: <code>when { changelog '.*^\\\\[DEPENDENCY\\\\] .+$' }</code></p> <ul> <li>changeset</li> </ul> <p>Execute the stage if the build\u2019s SCM changeset contains one or more files matching the given pattern. Example: <code>when { changeset \"**/*.js\" }</code>The optional parameter <code>comparator</code> may be added after an attribute to specify how any patterns are evaluated for a match: <code>EQUALS</code> for a simple string comparison, <code>GLOB</code> (the default) for an ANT style path glob case insensitive, this can be turned off with the <code>caseSensitive</code> parameter, or <code>REGEXP</code> for regular expression matching. For example: <code>when { changeset pattern: \".**TEST\\\\.java\", comparator: \"REGEXP\" }**</code> or <code>when { changeset pattern: \"</code><code>*/*TEST.java\", caseSensitive: true }</code></p> <ul> <li>changeRequest</li> </ul> <p>Executes the stage if the current build is for a \"change request\" (a.k.a. Pull Request on GitHub and Bitbucket, Merge Request on GitLab, Change in Gerrit, etc.). When no parameters are passed the stage runs on every change request, for example: <code>when { changeRequest() }</code>.By adding a filter attribute with parameter to the change request, the stage can be made to run only on matching change requests. Possible attributes are <code>id</code>, <code>target</code>, <code>branch</code>, <code>fork</code>, <code>url</code>, <code>title</code>, <code>author</code>, <code>authorDisplayName</code>, and <code>authorEmail</code>. Each of these corresponds to a <code>CHANGE_*</code> environment variable, for example: <code>when { changeRequest target: 'master' }</code>.The optional parameter <code>comparator</code> may be added after an attribute to specify how any patterns are evaluated for a match: <code>EQUALS</code> for a simple string comparison (the default), <code>GLOB</code> for an ANT style path glob (same as for example <code>changeset</code>), or <code>REGEXP</code> for regular expression matching. Example: <code>when { changeRequest authorEmail: \"[\\\\w_-.]+@example.com\", comparator: 'REGEXP' }</code></p> <ul> <li>environment</li> </ul> <p>Execute the stage when the specified environment variable is set to the given value, for example: <code>when { environment name: 'DEPLOY_TO', value: 'production' }</code></p> <ul> <li>equals</li> </ul> <p>Execute the stage when the expected value is equal to the actual value, for example: <code>when { equals expected: 2, actual: currentBuild.number }</code></p> <ul> <li>expression</li> </ul> <p>Execute the stage when the specified Groovy expression evaluates to true, for example: <code>when { expression { return params.DEBUG_BUILD } }</code> Note that when returning strings from your expressions they must be converted to booleans or return <code>null</code> to evaluate to false. Simply returning \"0\" or \"false\" will still evaluate to \"true\".</p> <ul> <li>tag</li> </ul> <p>Execute the stage if the <code>TAG_NAME</code> variable matches the given pattern. Example: <code>when { tag \"release-*\" }</code>. If an empty pattern is provided the stage will execute if the <code>TAG_NAME</code> variable exists (same as <code>buildingTag()</code>).The optional parameter <code>comparator</code> may be added after an attribute to specify how any patterns are evaluated for a match: <code>EQUALS</code> for a simple string comparison, <code>GLOB</code> (the default) for an ANT style path glob (same as for example <code>changeset</code>), or <code>REGEXP</code> for regular expression matching. For example: <code>when { tag pattern: \"release-\\\\d+\", comparator: \"REGEXP\"}</code></p> <ul> <li>not</li> </ul> <p>Execute the stage when the nested condition is false. Must contain one condition. For example: <code>when { not { branch 'master' } }</code></p> <ul> <li>allOf</li> </ul> <p>Execute the stage when all of the nested conditions are true. Must contain at least one condition. For example: <code>when { allOf { branch 'master'; environment name: 'DEPLOY_TO', value: 'production' } }</code></p> <ul> <li>anyOf</li> </ul> <p>Execute the stage when at least one of the nested conditions is true. Must contain at least one condition. For example: <code>when { anyOf { branch 'master'; branch 'staging' } }</code></p> <ul> <li>triggeredBy</li> </ul> <p>Execute the stage when the current build has been triggered by the param given. For example:</p> <ul> <li><code>when { triggeredBy 'SCMTrigger' }</code></li> <li><code>when { triggeredBy 'TimerTrigger' }</code></li> <li><code>when { triggeredBy 'UpstreamCause' }</code></li> <li><code>when { triggeredBy cause: \"UserIdCause\", detail: \"vlinde\" }</code></li> </ul>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#evaluating-when-before-entering-agent-in-a-stage","title":"Evaluating <code>when</code> before entering <code>agent</code> in a <code>stage</code>","text":"<p>By default, the <code>when</code> condition for a <code>stage</code> will be evaluated after entering the <code>agent</code> for that <code>stage</code>, if one is defined. However, this can be changed by specifying the <code>beforeAgent</code> option within the <code>when</code> block. If <code>beforeAgent</code> is set to <code>true</code>, the <code>when</code> condition will be evaluated first, and the <code>agent</code> will only be entered if the <code>when</code> condition evaluates to true.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#evaluating-when-before-the-input-directive","title":"Evaluating <code>when</code> before the <code>input</code> directive","text":"<p>By default, the when condition for a stage will not be evaluated before the input, if one is defined. However, this can be changed by specifying the <code>beforeInput</code> option within the when block. If <code>beforeInput</code> is set to true, the when condition will be evaluated first, and the input will only be entered if the when condition evaluates to true.</p> <p><code>beforeInput true</code> takes precedence over <code>beforeAgent true</code>.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#evaluating-when-before-the-options-directive","title":"Evaluating <code>when</code> before the <code>options</code> directive","text":"<p>By default, the <code>when</code> condition for a <code>stage</code> will be evaluated after entering the <code>options</code> for that <code>stage</code>, if any are defined. However, this can be changed by specifying the <code>beforeOptions</code> option within the <code>when</code> block. If <code>beforeOptions</code> is set to <code>true</code>, the <code>when</code> condition will be evaluated first, and the <code>options</code> will only be entered if the <code>when</code> condition evaluates to true.</p> <p><code>beforeOptions true</code> takes precedence over <code>beforeInput true</code> and <code>beforeAgent true</code>.</p> <p>Example 15. Single Condition, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                branch 'production'\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 16. Multiple Condition, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                branch 'production'\n                environment name: 'DEPLOY_TO', value: 'production'\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 17. Nested condition (same behavior as previous example)</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                allOf {\n                    branch 'production'\n                    environment name: 'DEPLOY_TO', value: 'production'\n                }\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 18. Multiple condition and nested condition</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                branch 'production'\n                anyOf {\n                    environment name: 'DEPLOY_TO', value: 'production'\n                    environment name: 'DEPLOY_TO', value: 'staging'\n                }\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 19. Expression condition and nested condition</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                expression { BRANCH_NAME ==~ /(production|staging)/ }\n                anyOf {\n                    environment name: 'DEPLOY_TO', value: 'production'\n                    environment name: 'DEPLOY_TO', value: 'staging'\n                }\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 20. <code>beforeAgent</code></p> <pre><code>pipeline {\n    agent none\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            agent {\n                label \"some-label\"\n            }\n            when {\n                beforeAgent true\n                branch 'production'\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 21. <code>beforeInput</code></p> <pre><code>pipeline {\n    agent none\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                beforeInput true\n                branch 'production'\n            }\n            input {\n                message \"Deploy to production?\"\n                id \"simple-input\"\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre> <p>Example 22. <code>beforeOptions</code></p> <pre><code>pipeline {\n    agent none\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                beforeOptions true\n                branch 'testing'\n            }\n            options {\n                lock label: 'testing-deploy-envs', quantity: 1, variable: 'deployEnv'\n            }\n            steps {\n                echo \"Deploying to ${deployEnv}\"\n            }\n        }\n    }\n}\n</code></pre> <p>Example 23. <code>triggeredBy</code></p> <pre><code>pipeline {\n    agent none\n    stages {\n        stage('Example Build') {\n            steps {\n                echo 'Hello World'\n            }\n        }\n        stage('Example Deploy') {\n            when {\n                triggeredBy \"TimerTrigger\"\n            }\n            steps {\n                echo 'Deploying'\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#sequential-stages","title":"Sequential Stages","text":"<p>Stages in Declarative Pipeline may have a <code>stages</code> section containing a list of nested stages to be run in sequential order. Note that a stage must have one and only one of <code>steps</code>, <code>stages</code>, <code>parallel</code>, or <code>matrix</code>. It is not possible to nest a <code>parallel</code> or <code>matrix</code> block within a <code>stage</code> directive if that <code>stage</code> directive is nested within a <code>parallel</code> or <code>matrix</code> block itself. However, a <code>stage</code> directive within a <code>parallel</code> or <code>matrix</code> block can use all other functionality of a <code>stage</code>, including <code>agent</code>, <code>tools</code>, <code>when</code>, etc.</p> <p>Example 24. Sequential Stages, Declarative Pipeline</p> <pre><code>pipeline {\n    agent none\n    stages {\n        stage('Non-Sequential Stage') {\n            agent {\n                label 'for-non-sequential'\n            }\n            steps {\n                echo \"On Non-Sequential Stage\"\n            }\n        }\n        stage('Sequential') {\n            agent {\n                label 'for-sequential'\n            }\n            environment {\n                FOR_SEQUENTIAL = \"some-value\"\n            }\n            stages {\n                stage('In Sequential 1') {\n                    steps {\n                        echo \"In Sequential 1\"\n                    }\n                }\n                stage('In Sequential 2') {\n                    steps {\n                        echo \"In Sequential 2\"\n                    }\n                }\n                stage('Parallel In Sequential') {\n                    parallel {\n                        stage('In Parallel 1') {\n                            steps {\n                                echo \"In Parallel 1\"\n                            }\n                        }\n                        stage('In Parallel 2') {\n                            steps {\n                                echo \"In Parallel 2\"\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#parallel","title":"Parallel","text":"<p>Stages in Declarative Pipeline may have a <code>parallel</code> section containing a list of nested stages to be run in parallel. Note that a stage must have one and only one of <code>steps</code>, <code>stages</code>, <code>parallel</code>, or <code>matrix</code>. It is not possible to nest a <code>parallel</code> or <code>matrix</code> block within a <code>stage</code> directive if that <code>stage</code> directive is nested within a <code>parallel</code> or <code>matrix</code> block itself. However, a <code>stage</code> directive within a <code>parallel</code> or <code>matrix</code> block can use all other functionality of a <code>stage</code>, including <code>agent</code>, <code>tools</code>, <code>when</code>, etc.</p> <p>In addition, you can force your <code>parallel</code> stages to all be aborted when any one of them fails, by adding <code>failFast true</code> to the <code>stage</code> containing the <code>parallel</code>. Another option for adding <code>failfast</code> is adding an option to the pipeline definition: <code>parallelsAlwaysFailFast()</code></p> <p>Example 25. Parallel Stages, Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Non-Parallel Stage') {\n            steps {\n                echo 'This stage will be executed first.'\n            }\n        }\n        stage('Parallel Stage') {\n            when {\n                branch 'master'\n            }\n            failFast true\n            parallel {\n                stage('Branch A') {\n                    agent {\n                        label \"for-branch-a\"\n                    }\n                    steps {\n                        echo \"On Branch A\"\n                    }\n                }\n                stage('Branch B') {\n                    agent {\n                        label \"for-branch-b\"\n                    }\n                    steps {\n                        echo \"On Branch B\"\n                    }\n                }\n                stage('Branch C') {\n                    agent {\n                        label \"for-branch-c\"\n                    }\n                    stages {\n                        stage('Nested 1') {\n                            steps {\n                                echo \"In stage Nested 1 within Branch C\"\n                            }\n                        }\n                        stage('Nested 2') {\n                            steps {\n                                echo \"In stage Nested 2 within Branch C\"\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Example 26. <code>parallelsAlwaysFailFast</code></p> <pre><code>pipeline {\n    agent any\n    options {\n        parallelsAlwaysFailFast()\n    }\n    stages {\n        stage('Non-Parallel Stage') {\n            steps {\n                echo 'This stage will be executed first.'\n            }\n        }\n        stage('Parallel Stage') {\n            when {\n                branch 'master'\n            }\n            parallel {\n                stage('Branch A') {\n                    agent {\n                        label \"for-branch-a\"\n                    }\n                    steps {\n                        echo \"On Branch A\"\n                    }\n                }\n                stage('Branch B') {\n                    agent {\n                        label \"for-branch-b\"\n                    }\n                    steps {\n                        echo \"On Branch B\"\n                    }\n                }\n                stage('Branch C') {\n                    agent {\n                        label \"for-branch-c\"\n                    }\n                    stages {\n                        stage('Nested 1') {\n                            steps {\n                                echo \"In stage Nested 1 within Branch C\"\n                            }\n                        }\n                        stage('Nested 2') {\n                            steps {\n                                echo \"In stage Nested 2 within Branch C\"\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#matrix","title":"Matrix","text":"<p>Stages in Declarative Pipeline may have a <code>matrix</code> section defining a multi-dimensional matrix of name-value combinations to be run in parallel. We\u2019ll refer these combinations as \"cells\" in a matrix. Each cell in a matrix can include one or more stages to be run sequentially using the configuration for that cell. Note that a stage must have one and only one of <code>steps</code>, <code>stages</code>, <code>parallel</code>, or <code>matrix</code>. It is not possible to nest a <code>parallel</code> or <code>matrix</code> block within a <code>stage</code> directive if that <code>stage</code> directive is nested within a <code>parallel</code> or <code>matrix</code> block itself. However, a <code>stage</code> directive within a <code>parallel</code> or <code>matrix</code> block can use all other functionality of a <code>stage</code>, including <code>agent</code>, <code>tools</code>, <code>when</code>, etc.</p> <p>In addition, you can force your <code>matrix</code> cells to all be aborted when any one of them fails, by adding <code>failFast true</code> to the <code>stage</code> containing the <code>matrix</code>. Another option for adding <code>failfast</code> is adding an option to the pipeline definition: <code>parallelsAlwaysFailFast()</code></p> <p>The <code>matrix</code> section must include an <code>axes</code> section and a <code>stages</code> section. The <code>axes</code> section defines the values for each <code>axis</code> in the matrix. The <code>stages</code> section defines a list of <code>stage</code>s to run sequentially in each cell. A <code>matrix</code> may have an <code>excludes</code> section to remove invalid cells from the matrix. Many of the directives available on <code>stage</code>, including <code>agent</code>, <code>tools</code>, <code>when</code>, etc., can also be added to <code>matrix</code> to control the behavior of each cell.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#axes","title":"axes","text":"<p>The <code>axes</code> section specifies one or more <code>axis</code> directives. Each <code>axis</code> consists of a <code>name</code> and a list of <code>values</code>. All the values from each axis are combined with the others to produce the cells.</p> <p>Example 27. One-axis with 3 cells</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n    }\n    // ...\n}\n</code></pre> <p>Example 28. Two-axis with 12 cells (three by four)</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n        axis {\n            name 'BROWSER'\n            values 'chrome', 'edge', 'firefox', 'safari'\n        }\n    }\n    // ...\n}\n</code></pre> <p>Example 29. Three-axis matrix with 24 cells (three by four by two)</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n        axis {\n            name 'BROWSER'\n            values 'chrome', 'edge', 'firefox', 'safari'\n        }\n        axis {\n            name 'ARCHITECTURE'\n            values '32-bit', '64-bit'\n        }\n    }\n    // ...\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#stages_1","title":"stages","text":"<p>The <code>stages</code> section specifies one or more <code>stage</code>s to be executed sequentially in each cell. This section is identical to any other <code>stages</code> section.</p> <p>Example 30. One-axis with 3 cells, each cell runs three stages - \"build\", \"test\", and \"deploy\"</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n    }\n    stages {\n        stage('build') {\n            // ...\n        }\n        stage('test') {\n            // ...\n        }\n        stage('deploy') {\n            // ...\n        }\n    }\n}\n</code></pre> <p>Example 31. Two-axis with 12 cells (three by four)</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n        axis {\n            name 'BROWSER'\n            values 'chrome', 'edge', 'firefox', 'safari'\n        }\n    }\n    stages {\n        stage('build-and-test') {\n            // ...\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#excludes-optional","title":"excludes (optional)","text":"<p>The optional <code>excludes</code> section lets authors specify one or more <code>exclude</code> filter expressions that select cells to be excluded from the expanded set of matrix cells (aka, sparsening). Filters are constructed using a basic directive structure of one or more of exclude <code>axis</code> directives each with a <code>name</code> and <code>values</code> list.</p> <p>The <code>axis</code> directives inside an <code>exclude</code> generate a set of combinations (similar to generating the matrix cells). The matrix cells that match all the values from an <code>exclude</code> combination are removed from the matrix. If more than one <code>exclude</code> directive is supplied, each is evaluated separately to remove cells.</p> <p>When dealing with a long list of values to exclude, exclude <code>axis</code> directives can use <code>notValues</code> instead of <code>values</code>. These will exclude cells that do not match one of the values passed to <code>notValues</code>.</p> <p>Example 32. Three-axis matrix with 24 cells, exclude '32-bit, mac' (4 cells excluded)</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n        axis {\n            name 'BROWSER'\n            values 'chrome', 'edge', 'firefox', 'safari'\n        }\n        axis {\n            name 'ARCHITECTURE'\n            values '32-bit', '64-bit'\n        }\n    }\n    excludes {\n        exclude {\n            axis {\n                name 'PLATFORM'\n                values 'mac'\n            }\n            axis {\n                name 'ARCHITECTURE'\n                values '32-bit'\n            }\n        }\n    }\n    // ...\n}\n</code></pre> <p>Exclude the <code>linux, safari</code> combination and exclude any platform that is not <code>windows</code> with the <code>edge</code> browser.</p> <p>Example 33. Three-axis matrix with 24 cells, exclude '32-bit, mac' and invalid browser combinations (9 cells excluded)</p> <pre><code>matrix {\n    axes {\n        axis {\n            name 'PLATFORM'\n            values 'linux', 'mac', 'windows'\n        }\n        axis {\n            name 'BROWSER'\n            values 'chrome', 'edge', 'firefox', 'safari'\n        }\n        axis {\n            name 'ARCHITECTURE'\n            values '32-bit', '64-bit'\n        }\n    }\n    excludes {\n        exclude {\n            // 4 cells\n            axis {\n                name 'PLATFORM'\n                values 'mac'\n            }\n            axis {\n                name 'ARCHITECTURE'\n                values '32-bit'\n            }\n        }\n        exclude {\n            // 2 cells\n            axis {\n                name 'PLATFORM'\n                values 'linux'\n            }\n            axis {\n                name 'BROWSER'\n                values 'safari'\n            }\n        }\n        exclude {\n            // 3 more cells and '32-bit, mac' (already excluded)\n            axis {\n                name 'PLATFORM'\n                notValues 'windows'\n            }\n            axis {\n                name 'BROWSER'\n                values 'edge'\n            }\n        }\n    }\n    // ...\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#matrix-cell-level-directives-optional","title":"Matrix cell-level directives (optional)","text":"<p>Matrix lets users efficiently configure the overall environment for each cell, by adding stage-level directives under <code>matrix</code> itself. These directives behave the same as they would on a stage but they can also accept values provided by the matrix for each cell.</p> <p>The <code>axis</code> and <code>exclude</code> directives define the static set of cells that make up the matrix. That set of combinations is generated before the start of the pipeline run. The \"per-cell\" directives, on the other hand, are evaluated at runtime.</p> <p>These directives include:</p> <ul> <li>agent</li> <li>environment</li> <li>input</li> <li>options</li> <li>post</li> <li>tools</li> <li>when</li> </ul> <p>Example 34. Complete Matrix Example, Declarative Pipeline</p> <pre><code>pipeline {\n    parameters {\n        choice(name: 'PLATFORM_FILTER', choices: ['all', 'linux', 'windows', 'mac'], description: 'Run on specific platform')\n    }\n    agent none\n    stages {\n        stage('BuildAndTest') {\n            matrix {\n                agent {\n                    label \"${PLATFORM}-agent\"\n                }\n                when { anyOf {\n                    expression { params.PLATFORM_FILTER == 'all' }\n                    expression { params.PLATFORM_FILTER == env.PLATFORM }\n                } }\n                axes {\n                    axis {\n                        name 'PLATFORM'\n                        values 'linux', 'windows', 'mac'\n                    }\n                    axis {\n                        name 'BROWSER'\n                        values 'firefox', 'chrome', 'safari', 'edge'\n                    }\n                }\n                excludes {\n                    exclude {\n                        axis {\n                            name 'PLATFORM'\n                            values 'linux'\n                        }\n                        axis {\n                            name 'BROWSER'\n                            values 'safari'\n                        }\n                    }\n                    exclude {\n                        axis {\n                            name 'PLATFORM'\n                            notValues 'windows'\n                        }\n                        axis {\n                            name 'BROWSER'\n                            values 'edge'\n                        }\n                    }\n                }\n                stages {\n                    stage('Build') {\n                        steps {\n                            echo \"Do Build for ${PLATFORM} - ${BROWSER}\"\n                        }\n                    }\n                    stage('Test') {\n                        steps {\n                            echo \"Do Test for ${PLATFORM} - ${BROWSER}\"\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#steps_1","title":"Steps","text":"<p>Declarative Pipelines may use all the available steps documented in the Pipeline Steps reference, which contains a comprehensive list of steps, with the addition of the steps listed below which are only supported in Declarative Pipeline.</p>"},{"location":"DevOps/Jenkins/jenkins-pipeline-syntax/#script","title":"script","text":"<p>The <code>script</code> step takes a block of Scripted Pipeline and executes that in the Declarative Pipeline. For most use-cases, the <code>script</code> step should be unnecessary in Declarative Pipelines, but it can provide a useful \"escape hatch.\" <code>script</code> blocks of non-trivial size and/or complexity should be moved into Shared Libraries instead.</p> <p>Example 35. Script Block in Declarative Pipeline</p> <pre><code>pipeline {\n    agent any\n    stages {\n        stage('Example') {\n            steps {\n                echo 'Hello World'\n\n                script {\n                    def browsers = ['chrome', 'firefox']\n                    for (int i = 0; i &lt; browsers.size(); ++i) {\n                        echo \"Testing the ${browsers[i]} browser\"\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkinsfile/","title":"Using a Jenkinsfile","text":"<p>This section builds on the information covered in Getting started with Pipeline and introduces more useful steps, common patterns, and demonstrates some non-trivial <code>Jenkinsfile</code> examples.</p> <p>Creating a <code>Jenkinsfile</code>, which is checked into source control [1], provides a number of immediate benefits:</p> <ul> <li>Code review/iteration on the Pipeline</li> <li>Audit trail for the Pipeline</li> <li>Single source of truth [2] for the Pipeline, which can be viewed and edited by multiple members of the project.</li> </ul> <p>Pipeline supports two syntaxes, Declarative (introduced in Pipeline 2.5) and Scripted Pipeline. Both of which support building continuous delivery pipelines. Both may be used to define a Pipeline in either the web UI or with a <code>Jenkinsfile</code>, though it\u2019s generally considered a best practice to create a <code>Jenkinsfile</code> and check the file into the source control repository.</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#creating-a-jenkinsfile","title":"Creating a Jenkinsfile","text":"<p>As discussed in the Defining a Pipeline in SCM, a <code>Jenkinsfile</code> is a text file that contains the definition of a Jenkins Pipeline and is checked into source control. Consider the following Pipeline which implements a basic three-stage continuous delivery pipeline.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n\n    stages {\n        stage('Build') {\n            steps {\n                echo 'Building..'\n            }\n        }\n        stage('Test') {\n            steps {\n                echo 'Testing..'\n            }\n        }\n        stage('Deploy') {\n            steps {\n                echo 'Deploying....'\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p> <p>Not all Pipelines will have these same three stages, but it is a good starting point to define them for most projects. The sections below will demonstrate the creation and execution of a simple Pipeline in a test installation of Jenkins.</p> <p>It is assumed that there is already a source control repository set up for the project and a Pipeline has been defined in Jenkins following these instructions.</p> <p>Using a text editor, ideally one which supports Groovy syntax highlighting, create a new <code>Jenkinsfile</code> in the root directory of the project.</p> <p>The Declarative Pipeline example above contains the minimum necessary structure to implement a continuous delivery pipeline. The agent directive, which is required, instructs Jenkins to allocate an executor and workspace for the Pipeline. Without an <code>agent</code> directive, not only is the Declarative Pipeline not valid, it would not be capable of doing any work! By default the <code>agent</code> directive ensures that the source repository is checked out and made available for steps in the subsequent stages`</p> <p>The stages directive, and steps directives are also required for a valid Declarative Pipeline as they instruct Jenkins what to execute and in which stage it should be executed.</p> <p>For more advanced usage with Scripted Pipeline, the example above <code>node</code> is a crucial first step as it allocates an executor and workspace for the Pipeline. In essence, without <code>node</code>, a Pipeline cannot do any work! From within <code>node</code>, the first order of business will be to checkout the source code for this project. Since the <code>Jenkinsfile</code> is being pulled directly from source control, Pipeline provides a quick and easy way to access the right revision of the source code</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\nnode {\n    checkout scm // \u2460\n    /* .. snip .. */\n}\n</code></pre> <p>\u2460 The <code>checkout</code> step will checkout code from source control; <code>scm</code> is a special variable which instructs the <code>checkout</code> step to clone the specific revision which triggered this Pipeline run.</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#build","title":"Build","text":"<p>For many projects the beginning of \"work\" in the Pipeline would be the \"build\" stage. Typically this stage of the Pipeline will be where source code is assembled, compiled, or packaged. The <code>Jenkinsfile</code> is not a replacement for an existing build tool such as GNU/Make, Maven, Gradle, etc, but rather can be viewed as a glue layer to bind the multiple phases of a project\u2019s development lifecycle (build, test, deploy, etc) together.</p> <p>Jenkins has a number of plugins for invoking practically any build tool in general use, but this example will simply invoke <code>make</code> from a shell step (<code>sh</code>). The <code>sh</code> step assumes the system is Unix/Linux-based, for Windows-based systems the <code>bat</code> could be used instead.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n\n    stages {\n        stage('Build') {\n            steps {\n                sh 'make' // \u2460\n                archiveArtifacts artifacts: '**/target/*.jar', fingerprint: true // \u2461\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced) </p> <p>\u2460 The <code>sh</code> step invokes the <code>make</code> command and will only continue if a zero exit code is returned by the command. Any non-zero exit code will fail the Pipeline. </p> <p>\u2461 <code>archiveArtifacts</code> captures the files built matching the include pattern (<code>**/target/*.jar</code>) and saves them to the Jenkins controller for later retrieval.</p> <p>\u26a0 Archiving artifacts is not a substitute for using external artifact repositories such as Artifactory or Nexus and should be considered only for basic reporting and file archival.    </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#test","title":"Test","text":"<p>Running automated tests is a crucial component of any successful continuous delivery process. As such, Jenkins has a number of test recording, reporting, and visualization facilities provided by a number of plugins. At a fundamental level, when there are test failures, it is useful to have Jenkins record the failures for reporting and visualization in the web UI. The example below uses the <code>junit</code> step, provided by the JUnit plugin.</p> <p>In the example below, if tests fail, the Pipeline is marked \"unstable\", as denoted by a yellow ball in the web UI. Based on the recorded test reports, Jenkins can also provide historical trend analysis and visualization.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n\n    stages {\n        stage('Test') {\n            steps {\n                /* `make check` returns non-zero on test failures,\n                * using `true` to allow the Pipeline to continue nonetheless\n                */\n                sh 'make check || true' // \u2460\n                junit '**/target/*.xml' // \u2461\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p> <p>\u2460 Using an inline shell conditional (<code>sh 'make check || true'</code>) ensures that the <code>sh</code> step always sees a zero exit code, giving the <code>junit</code> step the opportunity to capture and process the test reports. Alternative approaches to this are covered in more detail in the Handling failure section below.</p> <p>\u2461 <code>junit</code> captures and associates the JUnit XML files matching the inclusion pattern (<code>**/target/*.xml</code>). </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#deploy","title":"Deploy","text":"<p>Deployment can imply a variety of steps, depending on the project or organization requirements, and may be anything from publishing built artifacts to an Artifactory server, to pushing code to a production system.</p> <p>At this stage of the example Pipeline, both the \"Build\" and \"Test\" stages have successfully executed. In essence, the \"Deploy\" stage will only execute assuming previous stages completed successfully, otherwise the Pipeline would have exited early.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n\n    stages {\n        stage('Deploy') {\n            when {\n              expression {\n                currentBuild.result == null || currentBuild.result == 'SUCCESS' // \u2460\n              }\n            }\n            steps {\n                sh 'make publish'\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p> <p>\u2460  Accessing the <code>currentBuild.result</code> variable allows the Pipeline to determine if there were any test failures. In which case, the value would be <code>UNSTABLE</code>. </p> <p>Assuming everything has executed successfully in the example Jenkins Pipeline, each successful Pipeline run will have associated build artifacts archived, test results reported upon and the full console output all in Jenkins.</p> <p>A Scripted Pipeline can include conditional tests (shown above), loops, try/catch/finally blocks and even functions. The next section will cover this advanced Scripted Pipeline syntax in more detail.</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#working-with-your-jenkinsfile","title":"Working with your Jenkinsfile","text":"<p>The following sections provide details about handling:</p> <ul> <li>specific Pipeline syntax in your <code>Jenkinsfile</code> and</li> <li>features and functionality of Pipeline syntax which are essential in building your application or Pipeline project.</li> </ul>"},{"location":"DevOps/Jenkins/jenkinsfile/#using-environment-variables","title":"Using environment variables","text":"<p>Jenkins Pipeline exposes environment variables via the global variable <code>env</code>, which is available from anywhere within a <code>Jenkinsfile</code>. The full list of environment variables accessible from within Jenkins Pipeline is documented at ${YOUR_JENKINS_URL}/pipeline-syntax/globals#env and includes:</p> <ul> <li>BUILD_ID</li> </ul> <p>The current build ID, identical to BUILD_NUMBER for builds created in Jenkins versions 1.597+</p> <ul> <li>BUILD_NUMBER</li> </ul> <p>The current build number, such as \"153\"</p> <ul> <li>BUILD_TAG</li> </ul> <p>String of jenkins-\\({JOB_NAME}-\\){BUILD_NUMBER}. Convenient to put into a resource file, a jar file, etc for easier identification</p> <ul> <li>BUILD_URL</li> </ul> <p>The URL where the results of this build can be found (for example http://buildserver/jenkins/job/MyJobName/17/ )</p> <ul> <li>EXECUTOR_NUMBER</li> </ul> <p>The unique number that identifies the current executor (among executors of the same machine) performing this build. This is the number you see in the \"build executor status\", except that the number starts from 0, not 1</p> <ul> <li>JAVA_HOME</li> </ul> <p>If your job is configured to use a specific JDK, this variable is set to the JAVA_HOME of the specified JDK. When this variable is set, PATH is also updated to include the bin subdirectory of JAVA_HOME</p> <ul> <li>JENKINS_URL</li> </ul> <p>Full URL of Jenkins, such as https://example.com:port/jenkins/ (NOTE: only available if Jenkins URL set in \"System Configuration\")</p> <ul> <li>JOB_NAME</li> </ul> <p>Name of the project of this build, such as \"foo\" or \"foo/bar\".</p> <ul> <li>NODE_NAME</li> </ul> <p>The name of the node the current build is running on. Set to 'master' for the Jenkins controller.</p> <ul> <li>WORKSPACE</li> </ul> <p>The absolute path of the workspace</p> <p>Referencing or using these environment variables can be accomplished like accessing any key in a Groovy Map, for example:</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n    stages {\n        stage('Example') {\n            steps {\n                echo \"Running ${env.BUILD_ID} on ${env.JENKINS_URL}\"\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#setting-environment-variables","title":"Setting environment variables","text":"<p>Setting an environment variable within a Jenkins Pipeline is accomplished differently depending on whether Declarative or Scripted Pipeline is used.</p> <p>Declarative Pipeline supports an environment directive, whereas users of Scripted Pipeline must use the <code>withEnv</code> step.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n    environment { // \u2460\n        CC = 'clang'\n    }\n    stages {\n        stage('Example') {\n            environment { // \u2461\n                DEBUG_FLAGS = '-g'\n            }\n            steps {\n                sh 'printenv'\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p> <p>\u2460  An <code>environment</code> directive used in the top-level <code>pipeline</code> block will apply to all steps within the Pipeline. </p> <p>\u2461  An <code>environment</code> directive defined within a <code>stage</code> will only apply the given environment variables to steps within the <code>stage</code>. </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#setting-environment-variables-dynamically","title":"Setting environment variables dynamically","text":"<p>Environment variables can be set at run time and can be used by shell scripts (<code>sh</code>), Windows batch scripts (<code>bat</code>) and PowerShell scripts (<code>powershell</code>). Each script can either <code>returnStatus</code> or <code>returnStdout</code>. More information on scripts.</p> <p>Below is an example in a declarative pipeline using <code>sh</code> (shell) with both <code>returnStatus</code> and <code>returnStdout</code>.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any  // \u2460\n    environment {\n        // Using returnStdout\n        CC = \"\"\"${sh(\n                returnStdout: true,\n                script: 'echo \"clang\"'\n            )}\"\"\" // \u2461\n        // Using returnStatus\n        EXIT_STATUS = \"\"\"${sh(\n                returnStatus: true,\n                script: 'exit 1'\n            )}\"\"\"\n    }\n    stages {\n        stage('Example') {\n            environment {\n                DEBUG_FLAGS = '-g'\n            }\n            steps {\n                sh 'printenv'\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460  An <code>agent</code> must be set at the top level of the pipeline. This will fail if agent is set as <code>agent none</code>.</p> <p>\u2461 When using <code>returnStdout</code> a trailing whitespace will be appended to the returned string. Use <code>.trim()</code> to remove this. </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#handling-credentials","title":"Handling credentials","text":"<p>Credentials configured in Jenkins can be handled in Pipelines for immediate use. Read more about using credentials in Jenkins on the Using credentials page.</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#for-secret-text-usernames-and-passwords-and-secret-files","title":"For secret text, usernames and passwords, and secret files","text":"<p>Jenkins' declarative Pipeline syntax has the <code>credentials()</code> helper method (used within the <code>environment</code> directive) which supports secret text, username and password, as well as secret file credentials. If you want to handle other types of credentials, refer to the For other credential types section (below).</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#secret-text","title":"Secret text","text":"<p>The following Pipeline code shows an example of how to create a Pipeline using environment variables for secret text credentials.</p> <p>In this example, two secret text credentials are assigned to separate environment variables to access Amazon Web Services (AWS). These credentials would have been configured in Jenkins with their respective credential IDs <code>jenkins-aws-secret-key-id</code> and <code>jenkins-aws-secret-access-key</code>.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent {\n        // Define agent details here\n    }\n    environment {\n        AWS_ACCESS_KEY_ID     = credentials('jenkins-aws-secret-key-id')\n        AWS_SECRET_ACCESS_KEY = credentials('jenkins-aws-secret-access-key')\n    }\n    stages {\n        stage('Example stage 1') {\n            steps {\n                // \u2460\n            }\n        }\n        stage('Example stage 2') {\n            steps {\n                // \u2461\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460  You can reference the two credential environment variables (defined in this Pipeline\u2019s <code>environment</code> directive), within this stage\u2019s steps using the syntax <code>$AWS_ACCESS_KEY_ID</code> and <code>$AWS_SECRET_ACCESS_KEY</code>. For example, here you can authenticate to AWS using the secret text credentials assigned to these credential variables. To maintain the security and anonymity of these credentials, if the job displays the value of these credential variables from within the Pipeline (e.g. <code>echo $AWS_SECRET_ACCESS_KEY</code>), Jenkins only returns the value \u201c\u201d to reduce the risk of secret information being disclosed to the console output and any logs. Any sensitive information in credential IDs themselves (such as usernames) are also returned as \u201c\u201d in the Pipeline run\u2019s output. This only reduces the risk of accidental exposure. It does not prevent a malicious user from capturing the credential value by other means. A Pipeline that uses credentials can also disclose those credentials. Don\u2019t allow untrusted Pipeline jobs to use trusted credentials. </p> <p>\u2461  In this Pipeline example, the credentials assigned to the two <code>AWS_\u2026</code>environment variables are scoped globally for the entire Pipeline, so these credential variables could also be used in this stage\u2019s steps. If, however, the <code>environment</code> directive in this Pipeline were moved to a specific stage (as is the case in the Usernames and passwords Pipeline example below), then these <code>AWS_\u2026</code> environment variables would only be scoped to the steps in that stage. </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#usernames-and-passwords","title":"Usernames and passwords","text":"<p>The following Pipeline code snippets show an example of how to create a Pipeline using environment variables for username and password credentials.</p> <p>In this example, username and password credentials are assigned to environment variables to access a Bitbucket repository in a common account or team for your organization; these credentials would have been configured in Jenkins with the credential ID <code>jenkins-bitbucket-common-creds</code>.</p> <p>When setting the credential environment variable in the <code>environment</code> directive:</p> <pre><code>environment {\n    BITBUCKET_COMMON_CREDS = credentials('jenkins-bitbucket-common-creds')\n}\n</code></pre> <p>this actually sets the following three environment variables:</p> <ul> <li><code>BITBUCKET_COMMON_CREDS</code> - contains a username and a password separated by a colon in the format <code>username:password</code>.</li> <li><code>BITBUCKET_COMMON_CREDS_USR</code> - an additional variable containing the username component only.</li> <li><code>BITBUCKET_COMMON_CREDS_PSW</code> - an additional variable containing the password component only.</li> </ul> <p>\u2139 By convention, variable names for environment variables are typically specified in capital case, with individual words separated by underscores. You can, however, specify any legitimate variable name using lower case characters. Bear in mind that the additional environment variables created by the <code>credentials()</code> method (above) will always be appended with <code>_USR</code> and <code>_PSW</code> (i.e. in the format of an underscore followed by three capital letters).</p> <p>The following code snippet shows the example Pipeline in its entirety:</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent {\n        // Define agent details here\n    }\n    stages {\n        stage('Example stage 1') {\n            environment {\n                BITBUCKET_COMMON_CREDS = credentials('jenkins-bitbucket-common-creds')\n            }\n            steps {\n                // \u2460\n            }\n        }\n        stage('Example stage 2') {\n            steps {\n                // \u2461\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460The following credential environment variables (defined in this Pipeline\u2019s <code>environment</code> directive) are available within this stage\u2019s steps and can be referenced using the syntax:<code>$BITBUCKET_COMMON_CREDS``$BITBUCKET_COMMON_CREDS_USR``$BITBUCKET_COMMON_CREDS_PSW</code>For example, here you can authenticate to Bitbucket with the username and password assigned to these credential variables. To maintain the security and anonymity of these credentials, if the job displays the value of these credential variables from within the Pipeline the same behavior described in the Secret text example above applies to these username and password credential variable types too. This only reduces the risk of accidental exposure. It does not prevent a malicious user from capturing the credential value by other means. A Pipeline that uses credentials can also disclose those credentials. Don\u2019t allow untrusted Pipeline jobs to use trusted credentials.  \u2461  In this Pipeline example, the credentials assigned to the three <code>COMMON_BITBUCKET_CREDS\u2026</code> environment variables are scoped only to <code>Example stage 1</code>, so these credential variables are not available for use in this <code>Example stage 2</code> stage\u2019s steps. If, however, the <code>environment</code> directive in this Pipeline were moved immediately within the <code>pipeline</code> block (as is the case in the Secret text Pipeline example above), then these <code>COMMON_BITBUCKET_CREDS\u2026</code> environment variables would be scoped globally and could be used in any stage\u2019s steps. </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#secret-files","title":"Secret files","text":"<p>A secret file is a credential which is stored in a file and uploaded to Jenkins. Secret files are used for credentials that are:</p> <ul> <li>too unwieldy to enter directly into Jenkins, and/or</li> <li>in binary format, such as a GPG file.</li> </ul> <p>In this example, we use a Kubernetes config file that has been configured as a secret file credential named <code>my-kubeconfig</code>.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent {\n        // Define agent details here\n    }\n    environment {\n        // The MY_KUBECONFIG environment variable will be assigned\n        // the value of a temporary file.  For example:\n        //   /home/user/.jenkins/workspace/cred_test@tmp/secretFiles/546a5cf3-9b56-4165-a0fd-19e2afe6b31f/kubeconfig.txt\n        MY_KUBECONFIG = credentials('my-kubeconfig')\n    }\n    stages {\n        stage('Example stage 1') {\n            steps {\n                sh(\"kubectl --kubeconfig $MY_KUBECONFIG get pods\")\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkinsfile/#for-other-credential-types","title":"For other credential types","text":"<p>If you need to set credentials in a Pipeline for anything other than secret text, usernames and passwords, or secret files (above) - i.e SSH keys or certificates, then use Jenkins' Snippet Generator feature, which you can access through Jenkins' classic UI.</p> <p>To access the Snippet Generator for your Pipeline project/item:</p> <ol> <li>From the Jenkins home page (i.e. the Dashboard of Jenkins' classic UI), click the name of your Pipeline project/item.</li> <li>On the left, click Pipeline Syntax and ensure that the Snippet Generator link is in bold at the top-left. (If not, click its link.)</li> <li>From the Sample Step field, choose withCredentials: Bind credentials to variables.</li> <li>Under Bindings, click Add and choose from the dropdown:</li> <li>SSH User Private Key - to handle SSH public/private key pair credentials, from which you can specify:<ul> <li>Key File Variable - the name of the environment variable that will be bound to these credentials. Jenkins actually assigns this temporary variable to the secure location of the private key file required in the SSH public/private key pair authentication process.</li> <li>Passphrase Variable ( Optional ) - the name of the environment variable that will be bound to the passphrase associated with the SSH public/private key pair.</li> <li>Username Variable ( Optional ) - the name of the environment variable that will be bound to username associated with the SSH public/private key pair.</li> <li>Credentials - choose the SSH public/private key credentials stored in Jenkins. The value of this field is the credential ID, which Jenkins writes out to the generated snippet.</li> </ul> </li> <li>Certificate - to handle PKCS#12 certificates, from which you can specify:<ul> <li>Keystore Variable - the name of the environment variable that will be bound to these credentials. Jenkins actually assigns this temporary variable to the secure location of the certificate\u2019s keystore required in the certificate authentication process.</li> <li>Password Variable ( Optional ) - the name of the environment variable that will be bound to the password associated with the certificate.</li> <li>Alias Variable ( Optional ) - the name of the environment variable that will be bound to the unique alias associated with the certificate.</li> <li>Credentials - choose the certificate credentials stored in Jenkins. The value of this field is the credential ID, which Jenkins writes out to the generated snippet.</li> </ul> </li> <li>Docker client certificate - to handle Docker Host Certificate Authentication.</li> <li>Click Generate Pipeline Script and Jenkins generates a <code>withCredentials( \u2026 ) { \u2026 }</code> Pipeline step snippet for the credentials you specified, which you can then copy and paste into your Declarative or Scripted Pipeline code.    Notes:</li> <li>The Credentials fields (above) show the names of credentials configured in Jenkins. However, these values are converted to credential IDs after clicking Generate Pipeline Script.</li> <li>To combine more than one credential in a single <code>withCredentials( \u2026 ) { \u2026 }</code> Pipeline step, see Combining credentials in one step (below) for details.</li> </ol> <p>SSH User Private Key example</p> <pre><code>withCredentials(bindings: [sshUserPrivateKey(credentialsId: 'jenkins-ssh-key-for-abc', \\\n                                             keyFileVariable: 'SSH_KEY_FOR_ABC', \\\n                                             passphraseVariable: '', \\\n                                             usernameVariable: '')]) {\n  // some block\n}\n</code></pre> <p>The optional <code>passphraseVariable</code> and <code>usernameVariable</code> definitions can be deleted in your final Pipeline code.</p> <p>Certificate example</p> <pre><code>withCredentials(bindings: [certificate(aliasVariable: '', \\\n                                       credentialsId: 'jenkins-certificate-for-xyz', \\\n                                       keystoreVariable: 'CERTIFICATE_FOR_XYZ', \\\n                                       passwordVariable: 'XYZ-CERTIFICATE-PASSWORD')]) {\n  // some block\n}\n</code></pre> <p>The optional <code>aliasVariable</code> and <code>passwordVariable</code> variable definitions can be deleted in your final Pipeline code.</p> <p>The following code snippet shows an example Pipeline in its entirety, which implements the SSH User Private Key and Certificate snippets above:</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent {\n        // define agent details\n    }\n    stages {\n        stage('Example stage 1') {\n            steps {\n                withCredentials(bindings: [sshUserPrivateKey(credentialsId: 'jenkins-ssh-key-for-abc', \\\n                                                             keyFileVariable: 'SSH_KEY_FOR_ABC')]) {\n                  // \u2460\n                }\n                withCredentials(bindings: [certificate(credentialsId: 'jenkins-certificate-for-xyz', \\\n                                                       keystoreVariable: 'CERTIFICATE_FOR_XYZ', \\\n                                                       passwordVariable: 'XYZ-CERTIFICATE-PASSWORD')]) {\n                  // \u2461\n                }\n            }\n        }\n        stage('Example stage 2') {\n            steps {\n                // \u2462\n            }\n        }\n    }\n}\n</code></pre> <p>\u2460 Within this step, you can reference the credential environment variable with the syntax <code>$SSH_KEY_FOR_ABC</code>. For example, here you can authenticate to the ABC application with its configured SSH public/private key pair credentials, whose SSH User Private Key file is assigned to <code>$SSH_KEY_FOR_ABC</code>.</p> <p>\u2461 Within this step, you can reference the credential environment variable with the syntax <code>$CERTIFICATE_FOR_XYZ</code> and <code>$XYZ-CERTIFICATE-PASSWORD</code>. For example, here you can authenticate to the XYZ application with its configured certificate credentials, whose Certificate's keystore file and password are assigned to the variables <code>$CERTIFICATE_FOR_XYZ</code> and <code>$XYZ-CERTIFICATE-PASSWORD</code>, respectively. </p> <p>\u2462 In this Pipeline example, the credentials assigned to the <code>$SSH_KEY_FOR_ABC</code>, <code>$CERTIFICATE_FOR_XYZ</code> and <code>$XYZ-CERTIFICATE-PASSWORD</code> environment variables are scoped only within their respective <code>withCredentials( \u2026 ) { \u2026 }</code> steps, so these credential variables are not available for use in this <code>Example stage 2</code> stage\u2019s steps. </p> <p>To maintain the security and anonymity of these credentials, if you attempt to retrieve the value of these credential variables from within these <code>withCredentials( \u2026 ) { \u2026 }</code> steps, the same behavior described in the Secret text example (above) applies to these SSH public/private key pair credential and certificate variable types too. This only reduces the risk of accidental exposure. It does not prevent a malicious user from capturing the credential value by other means. A Pipeline that uses credentials can also disclose those credentials. Don\u2019t allow untrusted Pipeline jobs to use trusted credentials.</p> <ul> <li> <p>When using the Sample Step field\u2019s withCredentials: Bind credentials to variables option in the Snippet Generator, only credentials which your current Pipeline project/item has access to can be selected from any Credentials field\u2019s list. While you can manually write a <code>withCredentials( \u2026 ) { \u2026 }</code> step for your Pipeline (like the examples above), using the Snippet Generator is recommended to avoid specifying credentials that are out of scope for this Pipeline project/item, which when run, will make the step fail.</p> </li> <li> <p>You can also use the Snippet Generator to generate <code>withCredentials( \u2026 ) { \u2026 }</code> steps to handle secret text, usernames and passwords and secret files. However, if you only need to handle these types of credentials, it is recommended you use the relevant procedure described in the section above for improved Pipeline code readability.</p> </li> <li> <p>The use of single-quotes instead of double-quotes to define the <code>script</code> (the implicit parameter to <code>sh</code>) in Groovy above. The single-quotes will cause the secret to be expanded by the shell as an environment variable. The double-quotes are potentially less secure as the secret is interpolated by Groovy, and so typical operating system process listings will accidentally disclose it :</p> </li> </ul> <pre><code>node {  \n    withCredentials([string(credentialsId: 'mytoken', variable: 'TOKEN')]) {        sh /* WRONG! */ \"\"\"      \n           set +x      \n           curl -H 'Token: $TOKEN' https://some.api/    \n       \"\"\"\n       sh /* CORRECT */ '''      \n       set +x      \n       curl -H 'Token: $TOKEN' https://some.api/\n       ''' \n    } \n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkinsfile/#combining-credentials-in-one-step","title":"Combining credentials in one step","text":"<p>Using the Snippet Generator, you can make multiple credentials available within a single <code>withCredentials( \u2026 ) { \u2026 }</code> step by doing the following:</p> <ol> <li>From the Jenkins home page (i.e. the Dashboard of Jenkins' classic UI), click the name of your Pipeline project/item.</li> <li>On the left, click Pipeline Syntax and ensure that the Snippet Generator link is in bold at the top-left. (If not, click its link.)</li> <li>From the Sample Step field, choose withCredentials: Bind credentials to variables.</li> <li>Click Add under Bindings.</li> <li>Choose the credential type to add to the <code>withCredentials( \u2026 ) { \u2026 }</code> step from the dropdown list.</li> <li>Specify the credential Bindings details. Read more above these in the procedure under For other credential types (above).</li> <li>Repeat from \"Click Add \u2026\" (above) for each (set of) credential/s to add to the <code>withCredentials( \u2026 ) { \u2026 }</code> step.</li> <li>Click Generate Pipeline Script to generate the final <code>withCredentials( \u2026 ) { \u2026 }</code> step snippet.</li> </ol>"},{"location":"DevOps/Jenkins/jenkinsfile/#string-interpolation","title":"String interpolation","text":"<p>Jenkins Pipeline uses rules identical to Groovy for string interpolation. Groovy\u2019s String interpolation support can be confusing to many newcomers to the language. While Groovy supports declaring a string with either single quotes, or double quotes, for example:</p> <pre><code>def singlyQuoted = 'Hello'\ndef doublyQuoted = \"World\"\n</code></pre> <p>Only the latter string will support the dollar-sign (<code>$</code>) based string interpolation, for example:</p> <pre><code>def username = 'Jenkins'\necho 'Hello Mr. ${username}'\necho \"I said, Hello Mr. ${username}\"\n</code></pre> <p>Would result in:</p> <pre><code>Hello Mr. ${username}\nI said, Hello Mr. Jenkins\n</code></pre> <p>Understanding how to use string interpolation is vital for using some of Pipeline\u2019s more advanced features.</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#interpolation-of-sensitive-environment-variables","title":"Interpolation of sensitive environment variables","text":"<p>\u26a0 Groovy string interpolation should never be used with credentials</p> <p>Groovy string interpolation can leak sensitive environment variables (i.e. credentials, see: Handling credentials). This is because the sensitive environment variable will be interpolated during Groovy evaluation, and the environment variable\u2019s value could be made available earlier than intended, resulting in sensitive data leaking in various contexts.</p> <p>For example, consider a sensitive environment variable passed to the <code>sh</code> step.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n    environment {\n        EXAMPLE_CREDS = credentials('example-credentials-id')\n    }\n    stages {\n        stage('Example') {\n            steps {\n                /* WRONG! */\n                sh(\"curl -u ${EXAMPLE_CREDS_USR}:${EXAMPLE_CREDS_PSW} https://example.com/\")\n            }\n        }\n    }\n}\n</code></pre> <p>Should Groovy perform the interpolation, the sensitive value will be injected directly into the arguments of the <code>sh</code> step, which among other issues, means that the literal value will be visible as an argument to the <code>sh</code> process on the agent in OS process listings. Using single-quotes instead of double-quotes when referencing these sensitive environment variables prevents this type of leaking.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n    environment {\n        EXAMPLE_CREDS = credentials('example-credentials-id')\n    }\n    stages {\n        stage('Example') {\n            steps {\n                /* CORRECT */\n                sh('curl -u $EXAMPLE_CREDS_USR:$EXAMPLE_CREDS_PSW https://example.com/')\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkinsfile/#injection-via-interpolation","title":"Injection via interpolation","text":"<p>\u26a0 Groovy string interpolation can inject rogue commands into command interpreters via special characters.</p> <p>Another note of caution. Using Groovy string interpolation for user-controlled variables with steps that pass their arguments to command interpreters such as the <code>sh</code>, <code>bat</code>, <code>powershell</code>, or <code>pwsh</code> steps can result in problems analogous to SQL injection. This occurs when a user-controlled variable (generally an environment variable, usually a parameter passed to the build) that contains special characters (e.g. <code>/ \\ $ &amp; % ^ &gt; &lt; | ;</code>) is passed to the <code>sh</code>, <code>bat</code>, <code>powershell</code>, or <code>pwsh</code> steps using Groovy interpolation. For a simple example:</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n  agent any\n  parameters {\n    string(name: 'STATEMENT', defaultValue: 'hello; ls /', description: 'What should I say?')\n  }\n  stages {\n    stage('Example') {\n      steps {\n        /* WRONG! */\n        sh(\"echo ${STATEMENT}\")\n      }\n    }\n  }\n}\n</code></pre> <p>In this example, the argument to the <code>sh</code> step is evaluated by Groovy, and <code>STATEMENT</code> is interpolated directly into the argument as if <code>sh('echo hello; ls /')</code> has been written in the Pipeline. When this is processed on the agent, rather than echoing the value <code>hello; ls /</code>, it will echo <code>hello</code> then proceed to list the entire root directory of the agent. Any user able to control a variable interpolated by such a step would be able to make the <code>sh</code> step run arbitrary code on the agent. To avoid this problem, make sure arguments to steps such as <code>sh</code> or <code>bat</code> that reference parameters or other user-controlled environment variables use single quotes to avoid Groovy interpolation.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n  agent any\n  parameters {\n    string(name: 'STATEMENT', defaultValue: 'hello; ls /', description: 'What should I say?')\n  }\n  stages {\n    stage('Example') {\n      steps {\n        /* CORRECT */\n        sh('echo ${STATEMENT}')\n      }\n    }\n  }\n}\n</code></pre> <p>Credential mangling is another issue that can occur when credentials that contain special characters are passed to a step using Groovy interpolation. When the credential value is mangled, it is no longer valid and will no longer be masked in the console log.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n  agent any\n  environment {\n    EXAMPLE_KEY = credentials('example-credentials-id') // Secret value is 'sec%ret'\n  }\n  stages {\n    stage('Example') {\n      steps {\n          /* WRONG! */\n          bat \"echo ${EXAMPLE_KEY}\"\n      }\n    }\n  }\n}\n</code></pre> <p>Here, the <code>bat</code> step receives <code>echo sec%ret</code> and the Windows batch shell will simply drop the <code>%</code> and print out the value <code>secret</code>. Because there is a single character difference, the value <code>secret</code> will not be masked. Though the value is not the same as the actual credential, this is still a significant exposure of sensitive information. Again, single-quotes avoids this issue.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n  agent any\n  environment {\n    EXAMPLE_KEY = credentials('example-credentials-id') // Secret value is 'sec%ret'\n  }\n  stages {\n    stage('Example') {\n      steps {\n          /* CORRECT */\n          bat 'echo %SECRET_VALUE%'\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"DevOps/Jenkins/jenkinsfile/#handling-parameters","title":"Handling parameters","text":"<p>Declarative Pipeline supports parameters out-of-the-box, allowing the Pipeline to accept user-specified parameters at runtime via the parameters directive. Configuring parameters with Scripted Pipeline is done with the <code>properties</code> step, which can be found in the Snippet Generator.</p> <p>If you configured your pipeline to accept parameters using the Build with Parameters option, those parameters are accessible as members of the <code>params</code> variable.</p> <p>Assuming that a String parameter named \"Greeting\" has been configuring in the <code>Jenkinsfile</code>, it can access that parameter via <code>${params.Greeting}</code>:</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n    parameters {\n        string(name: 'Greeting', defaultValue: 'Hello', description: 'How should I greet the world?')\n    }\n    stages {\n        stage('Example') {\n            steps {\n                echo \"${params.Greeting} World!\"\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#handling-failure","title":"Handling failure","text":"<p>Declarative Pipeline supports robust failure handling by default via its post section which allows declaring a number of different \"post conditions\" such as: <code>always</code>, <code>unstable</code>, <code>success</code>, <code>failure</code>, and <code>changed</code>. The Pipeline Syntax section provides more detail on how to use the various post conditions.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent any\n    stages {\n        stage('Test') {\n            steps {\n                sh 'make check'\n            }\n        }\n    }\n    post {\n        always {\n            junit '**/target/*.xml'\n        }\n        failure {\n            mail to: team@example.com, subject: 'The Pipeline failed :('\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p> <p>Scripted Pipeline however relies on Groovy\u2019s built-in <code>try</code>/<code>catch</code>/<code>finally</code> semantics for handling failures during execution of the Pipeline.</p> <p>In the Test example above, the <code>sh</code> step was modified to never return a non-zero exit code (<code>sh 'make check || true'</code>). This approach, while valid, means the following stages need to check <code>currentBuild.result</code> to know if there has been a test failure or not.</p> <p>An alternative way of handling this, which preserves the early-exit behavior of failures in Pipeline, while still giving <code>junit</code> the chance to capture test reports, is to use a series of <code>try</code>/<code>finally</code> blocks:</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#using-multiple-agents","title":"Using multiple agents","text":"<p>In all the previous examples, only a single agent has been used. This means Jenkins will allocate an executor wherever one is available, regardless of how it is labeled or configured. Not only can this behavior be overridden, but Pipeline allows utilizing multiple agents in the Jenkins environment from within the same <code>Jenkinsfile</code>, which can helpful for more advanced use-cases such as executing builds/tests across multiple platforms.</p> <p>In the example below, the \"Build\" stage will be performed on one agent and the built results will be reused on two subsequent agents, labelled \"linux\" and \"windows\" respectively, during the \"Test\" stage.</p> <pre><code>// Jenkinsfile (Declarative Pipeline)\npipeline {\n    agent none\n    stages {\n        stage('Build') {\n            agent any\n            steps {\n                checkout scm\n                sh 'make'\n                stash includes: '**/target/*.jar', name: 'app' // \u2460\n            }\n        }\n        stage('Test on Linux') {\n            agent { // \u2461\n                label 'linux'\n            }\n            steps {\n                unstash 'app' // \u2462\n                sh 'make check'\n            }\n            post {\n                always {\n                    junit '**/target/*.xml'\n                }\n            }\n        }\n        stage('Test on Windows') {\n            agent {\n                label 'windows'\n            }\n            steps {\n                unstash 'app'\n                bat 'make check' // \u2463\n            }\n            post {\n                always {\n                    junit '**/target/*.xml'\n                }\n            }\n        }\n    }\n}\n</code></pre> <p>Toggle Scripted Pipeline (Advanced)</p> <p>\u2460 <code>stash</code> step allows capturing files matching an inclusion pattern (<code>**/target/*.jar</code>) for reuse within the same Pipeline. Once the Pipeline has completed its execution, stashed files are deleted from the Jenkins controller. </p> <p>\u2461 parameter in <code>agent</code>/<code>node</code> allows for any valid Jenkins label expression. Consult the Pipeline Syntax section for more details. </p> <p>\u2462  <code>unstash</code> will retrieve the named \"stash\" from the Jenkins controller into the Pipeline\u2019s current workspace. </p> <p>\u2463  The <code>bat</code> script allows for executing batch scripts on Windows-based platforms. </p>"},{"location":"DevOps/Jenkins/jenkinsfile/#optional-step-arguments","title":"Optional step arguments","text":"<p>Pipeline follows the Groovy language convention of allowing parentheses to be omitted around method arguments.</p> <p>Many Pipeline steps also use the named-parameter syntax as a shorthand for creating a Map in Groovy, which uses the syntax <code>[key1: value1, key2: value2]</code>. Making statements like the following functionally equivalent:</p> <pre><code>git url: 'git://example.com/amazing-project.git', branch: 'master'\ngit([url: 'git://example.com/amazing-project.git', branch: 'master'])\n</code></pre> <p>For convenience, when calling steps taking only one parameter (or only one mandatory parameter), the parameter name may be omitted, for example:</p> <pre><code>sh 'echo hello' /* short form  */\nsh([script: 'echo hello'])  /* long form */\n</code></pre>"},{"location":"DevOps/Jenkins/jenkinsfile/#advanced-scripted-pipeline","title":"Advanced Scripted Pipeline","text":"<p>Scripted Pipeline is a domain-specific language [3] based on Groovy, most Groovy syntax can be used in Scripted Pipeline without modification.</p>"},{"location":"DevOps/Jenkins/jenkinsfile/#parallel-execution","title":"Parallel execution","text":"<p>The example in the section above runs tests across two different platforms in a linear series. In practice, if the <code>make check</code> execution takes 30 minutes to complete, the \"Test\" stage would now take 60 minutes to complete!</p> <p>Fortunately, Pipeline has built-in functionality for executing portions of Scripted Pipeline in parallel, implemented in the aptly named <code>parallel</code> step.</p> <p>Refactoring the example above to use the <code>parallel</code> step:</p> <pre><code>// Jenkinsfile (Scripted Pipeline)\nstage('Build') {\n    /* .. snip .. */\n}\n\nstage('Test') {\n    parallel linux: {\n        node('linux') {\n            checkout scm\n            try {\n                unstash 'app'\n                sh 'make check'\n            }\n            finally {\n                junit '**/target/*.xml'\n            }\n        }\n    },\n    windows: {\n        node('windows') {\n            /* .. snip .. */\n        }\n    }\n}\n</code></pre> <p>Instead of executing the tests on the \"linux\" and \"windows\" labelled nodes in series, they will now execute in parallel assuming the requisite capacity exists in the Jenkins environment.</p>"},{"location":"databases/MySQL/SQL/","title":"SQL","text":""},{"location":"databases/MySQL/SQL/#sql","title":"SQL\u7b80\u4ecb","text":"<p>\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u67e5\u8be2\u548c\u4fee\u6539\u64cd\u4f5c\u7684\u8bed\u8a00\u53ebSQL(Structured Quary Language, \u7ed3\u6784\u5316\u67e5\u8be2\u8bed\u8a00)\u3002</p>"},{"location":"databases/MySQL/SQL/#1-sql","title":"1. SQL\u6807\u51c6","text":"<ol> <li>ANSI SQL</li> <li>SQL-92</li> <li>SQL-99</li> </ol>"},{"location":"databases/MySQL/SQL/#2-sql","title":"2. SQL\u5206\u7c7b","text":"<ol> <li>\u6570\u636e\u5b9a\u4e49\u8bed\u8a00\uff08DDL, Data Definition Language\uff09\uff1aDROP\u3001CREATE\u3001ALTER\u7b49</li> <li>\u6570\u636e\u64cd\u4f5c\u8bed\u8a00\uff08DML, Data Manipulation Language\uff09\uff1aINSERT\u3001UPDATE\u3001DELETE</li> <li>\u6570\u636e\u67e5\u8be2\u8bed\u8a00\uff08DQL, Data Query Language\uff09\uff1aSELECT</li> <li>\u6570\u636e\u63a7\u5236\u8bed\u8a00\uff08DCL, Data Control Language\uff09: GRANT\u3001REOVKE\u3001</li> <li>\u4e8b\u52a1\u63a7\u5236\u8bed\u8a00\uff08TCL, Tansaction Control Language\uff09\uff1aCOMMIT\u3001ROLLBACK\u7b49</li> </ol>"},{"location":"databases/MySQL/SQL/#3","title":"3. \u8bed\u6cd5\u89c4\u8303","text":"<ol> <li>\u4e0d\u533a\u5206\u5927\u5c0f\u5199\uff0c\u5efa\u8bae\u5173\u952e\u5b57\u5927\u5199\uff0c\u8868\u540d\u3001\u5217\u540d\u5c0f\u5199</li> <li>\u6bcf\u53e5\u8bdd\u7528<code>;</code>\u6216<code>\\g</code>\u7ed3\u5c3e</li> <li>\u6bcf\u6761\u547d\u4ee4\u6839\u636e\u9700\u8981\uff0c\u5404\u5b50\u53e5\u4e00\u822c\u5206\u884c\u5199\uff0c\u5173\u952e\u5b57\u4e0d\u80fd\u7f29\u5199\u4e5f\u4e0d\u80fd\u5206\u884c</li> <li>\u6ce8\u91ca<ol> <li>\u5355\u884c\u6ce8\u91ca\uff1a<code># \u6ce8\u91ca\u6587\u5b57</code> </li> <li>\u5355\u884c\u6ce8\u91ca\uff1a<code>-- \u6ce8\u91ca\u6587\u5b57\uff08\u8981\u6709\u7a7a\u683c\uff09</code></li> <li>\u591a\u884c\u6ce8\u91ca\uff1a<code>/* \u6ce8\u91ca\u6587\u5b57 */</code></li> </ol> </li> </ol>"},{"location":"databases/MySQL/SQL/#4-sql","title":"4. SQL\u8bed\u53e5\u7684\u6267\u884c\u8fc7\u7a0b","text":""},{"location":"databases/MySQL/SQL/#1","title":"1. \u8fde\u63a5\u5c42","text":"<ol> <li>\u63d0\u4f9b\u8fde\u63a5\u534f\u8bae\uff1aTCP/IP\uff0cSOCKET</li> <li>\u63d0\u4f9b\u9a8c\u8bc1\uff1a\u7528\u6237\u3001\u5bc6\u7801\u3001IP\u3001SOCKET</li> <li>\u63d0\u4f9b\u4e13\u7528\u8fde\u63a5\u7ebf\u7a0b\uff1a\u63a5\u6536\u7528\u6237SQL\uff0c\u8fd4\u56de\u7ed3\u679c</li> </ol>"},{"location":"databases/MySQL/SQL/#2-sql_1","title":"2. SQL\u5c42","text":"<ol> <li>\u63a5\u6536\u4e0a\u5c42\u4f20\u9001\u7684SQL\u8bed\u53e5</li> <li>\u8bed\u6cd5\u9a8c\u8bc1</li> <li>\u8bed\u4e49\u68c0\u67e5\uff1a\u5224\u65adSQL\u8bed\u53e5\u7684\u7c7b\u578b</li> <li>\u6743\u9650\u68c0\u67e5\uff1a\u7528\u6237\u5bf9\u5e93\u3001\u8868\u6709\u6ca1\u6709\u6743\u9650</li> <li>\u89e3\u6790\u5668\uff1a\u8fdb\u884cSQL\u9884\u5904\u7406\uff0c\u4ea7\u751f\u6267\u884c\u8ba1\u5212</li> <li>\u4f18\u5316\u5668\uff1a\u6839\u636e\u89e3\u6790\u5668\u5f97\u51fa\u7684\u591a\u79cd\u6267\u884c\u8ba1\u5212\u8fdb\u884c\u5224\u65ad\uff0c\u9009\u62e9\u6700\u4f18\u7684\u6267\u884c\u8ba1\u5212\u4ee3\u4ef7\u6a21\u5f0f</li> <li>\u6267\u884c\u5668\uff1a\u6839\u636e\u6700\u4f18\u6267\u884c\u8ba1\u5212\uff0c\u6267\u884cSQL\u8bed\u53e5\uff0c\u4ea7\u751f\u6267\u884c\u7ed3\u679c</li> <li>\u63d0\u4f9b\u67e5\u8be2\u7f13\u5b58\uff08\u9ed8\u8ba4\u4e0d\u5f00\u542f\uff09</li> <li>\u63d0\u4f9b\u65e5\u5fd7\u8bb0\u5f55\uff08\u9ed8\u8ba4\u4e0d\u5f00\u542f\uff09</li> </ol>"},{"location":"databases/MySQL/SQL/#3_1","title":"3. \u5b58\u50a8\u5f15\u64ce\u5c42","text":"<p>\u8d1f\u8d23\u6839\u636eSQL\u5c42\u6267\u884c\u7684\u7ed3\u679c\uff0c\u4ece\u78c1\u76d8\u4e0a\u62ff\u6570\u636e</p>"},{"location":"databases/MySQL/SQL/#ddl","title":"\u4e00\u3001DDL","text":""},{"location":"databases/MySQL/SQL/#1_1","title":"1. \u5e93","text":""},{"location":"databases/MySQL/SQL/#11","title":"1.1 \u6570\u636e\u5e93\u521b\u5efa","text":"<pre><code>mysql&gt; CREATE DATABASE IF NOT EXISTS \u6570\u636e\u5e93\u540d\u79f0;\n# \u6216\nmysql&gt; CREATE SCHEMA \u6570\u636e\u5e93\u540d\u79f0;\n# \u521b\u5efa\u6570\u636e\u65f6\u540c\u65f6\u6307\u5b9a\u5b57\u7b26\u96c6\nmysql&gt; CREATE DATABASE \u6570\u636e\u5e93\u540d\u79f0 CHARSET utf8;\n# \u521b\u5efa\u6570\u636e\u5e93\u662f\u6307\u5b9a\u6821\u5bf9\u89c4\u5219\nmysql&gt; CREATE DATABASE test CHARSET utf8mb4 COLLATE utf8mb4_bin;\n</code></pre> <p>\u67e5\u770b\u652f\u6301\u7684\u5b57\u7b26\u96c6</p> <pre><code>SHOW CHARSET;\n</code></pre> <p>collation\u672b\u5c3e\u5e26ci\u7684\u5b57\u7b26\u96c6\u90fd\u662f\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u7684\u3002\u4f7f\u7528<code>SHOW COLLATION;</code>\u53ef\u4ee5\u67e5\u8be2\u5927\u5c0f\u5199\u540d\u7684\u5b57\u7b26\u96c6\u3002</p> <p>\u6570\u636e\u5e93\u547d\u4ee4\u89c4\u5219\uff1a</p> <ol> <li>\u5e93\u540d\u4e0d\u80fd\u5927\u5199</li> <li>\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934</li> <li>\u5efa\u5e93\u65f6\u9700\u8981\u52a0\u5b57\u7b26\u96c6</li> </ol>"},{"location":"databases/MySQL/SQL/#12","title":"1.2 \u6570\u636e\u5e93\u4fee\u6539","text":"<pre><code>ALTER DATABASE \u6570\u636e\u5e93\u540d\u79f0 CHARSET utf8;\n</code></pre> <p>\u4fee\u6539\u524d\u7684\u5b57\u7b26\u96c6\u5e94\u8be5\u662f\u4fee\u6539\u540e\u5b57\u7b26\u524d\u7684\u5b50\u96c6</p>"},{"location":"databases/MySQL/SQL/#13","title":"1.3 \u6570\u636e\u5e93\u5220\u9664","text":"<pre><code>DROP DATABASE IF EXISTS \u6570\u636e\u5e93\u540d\u79f0;\n</code></pre>"},{"location":"databases/MySQL/SQL/#2","title":"2. \u8868","text":""},{"location":"databases/MySQL/SQL/#21","title":"2.1 \u8868\u5b9a\u4e49","text":"<pre><code>CREATE TABLE \u8868\u540d(\n            \u5b57\u6bb5\u540d1 \u6570\u636e\u7c7b\u578b[\u5b8c\u6574\u7684\u7ea6\u675f\u6761\u4ef6] [\u9ed8\u8ba4\u503c],\n            \u5b57\u6bb5\u540d2 \u6570\u636e\u7c7b\u578b[\u5b8c\u6574\u7684\u7ea6\u675f\u6761\u4ef6] [\u9ed8\u8ba4\u503c],\n            ...\n            [\u8868\u7ea7\u522b\u7684\u7ea6\u675f\u6761\u4ef6]\n            );\n</code></pre> <p>\u5b9e\u4f8b\uff1a</p> <pre><code>CREATE TABLE students(\n    id INT NOT NULL PRIMARY KEY AUTO_INCREMENT COMMENT '\u5b66\u53f7',\n    name VARCHAR(255) NOT NULL COMMENT '\u59d3\u540d',\n    age TINYINT UNSIGNED NOT NULL DEFAULT 0 COMMENT '\u5e74\u9f84',\n    sex ENUM('f','m','n') NOT NULL DEFAULT 'n' COMMENT '\u6027\u522b',\n    id_card CHAR(18) NOT NULL UNIQUE COMMENT '\u8eab\u4efd\u8bc1',\n    enrollment_time TIMESTAMP NOT NULL DEFAULT NOW() COMMENT '\u62a5\u540d\u65f6\u95f4'\n) ENGINE=INNODB CHARSET=utf8 COMMENT '\u5b66\u751f\u8868';\n</code></pre> <p>\u5efa\u8868\u89c4\u8303\uff1a</p> <ol> <li>\u8868\u540d\u5c0f\u5199</li> <li>\u4e0d\u80fd\u6570\u5b57\u5f00\u5934</li> <li>\u6ce8\u610f\u5b57\u7b26\u96c6\u548c\u5b58\u50a8\u5f15\u64ce</li> <li>\u8868\u540d\u548c\u4e1a\u52a1\u6709\u5173</li> <li>\u6bcf\u4e2a\u5217\u90fd\u8981\u6709\u6ce8\u91ca</li> <li>\u9009\u62e9\u5408\u9002\u7684\u6570\u636e\u7c7b\u578b</li> </ol>"},{"location":"databases/MySQL/SQL/#22","title":"2.2 \u4fee\u6539\u8868","text":"<p>DDL\u4f1a\u5f15\u8d77\u6570\u636e\u5e93\u9501\u8868\uff0c\u53ef\u4ee5\u4f7f\u7528\u5728\u7ebfDDL\u5de5\u5177pt-osc(pt-online-schema-change)\u89e3\u51b3</p>"},{"location":"databases/MySQL/SQL/#1_2","title":"1. \u6dfb\u52a0\u5b57\u6bb5","text":""},{"location":"databases/MySQL/SQL/#121","title":"1.2.1 \u5728\u672b\u5c3e\u6dfb\u52a0\u5b57\u6bb5","text":"<pre><code>ALTER TABLE students ADD qq VARCHAR(20) NOT NULL UNIQUE COMMENT 'QQ\u53f7';\n</code></pre>"},{"location":"databases/MySQL/SQL/#122","title":"1.2.2 \u5728\u6307\u5b9a\u5b57\u6bb5\u540e\u6dfb\u52a0\u5b57\u6bb5","text":"<pre><code>ALTER TABLE students ADD wechat VARCHAR(20) NOT NULL UNIQUE COMMENT '\u5fae\u4fe1\u53f7' AFTER name;\n</code></pre>"},{"location":"databases/MySQL/SQL/#123","title":"1.2.3 \u5728\u7b2c\u4e00\u5217\u524d\u6dfb\u52a0\u5b57\u6bb5","text":"<pre><code>ALTER TABLE students ADD num INT NOT NULL  COMMENT '\u6570\u5b57' FIRST;\n</code></pre>"},{"location":"databases/MySQL/SQL/#2_1","title":"2. \u5220\u9664\u5b57\u6bb5","text":"<pre><code>ALTER TABLE students DROP num;\n</code></pre>"},{"location":"databases/MySQL/SQL/#3_2","title":"3. \u4fee\u6539\u5b57\u6bb5\u5c5e\u6027","text":"<p>\u4fee\u6539\u65f6\u628a\u6240\u6709\u9700\u8981\u7684\u5c5e\u6027\u90fd\u52a0\u4e0a</p> <pre><code>ALTER TABLE students MODIFY name VARCHAR(128) NOT NULL;\n</code></pre>"},{"location":"databases/MySQL/SQL/#4","title":"4. \u4fee\u6539\u5b57\u6bb5\u540d\u79f0","text":"<p>\u540d\u79f0\u548c\u5c5e\u6027\u90fd\u53ef\u4ee5\u4fee\u6539</p> <pre><code>ALTER TABLE students CHANGE qq email VARCHAR(125);\n</code></pre>"},{"location":"databases/MySQL/SQL/#23","title":"2.3 \u5220\u9664\u8868","text":"<pre><code>DROP TABLE \u8868\u540d;\n</code></pre>"},{"location":"databases/MySQL/SQL/#24","title":"2.4 \u67e5\u770b\u8868","text":""},{"location":"databases/MySQL/SQL/#1_3","title":"1 \u67e5\u770b\u8868\u7ed3\u6784","text":"<pre><code>mysql&gt; DESC students;\n+-----------------+---------------------+------+-----+-------------------+----------------+\n| Field           | Type                | Null | Key | Default           | Extra          |\n+-----------------+---------------------+------+-----+-------------------+----------------+\n| id              | int(11)             | NO   | PRI | NULL              | auto_increment |\n| name            | varchar(255)        | NO   |     | NULL              |                |\n| age             | tinyint(3) unsigned | NO   |     | 0                 |                |\n| sex             | enum('f','m','n')   | NO   |     | n                 |                |\n| id_card         | char(18)            | NO   | UNI | NULL              |                |\n| enrollment_time | timestamp           | NO   |     | CURRENT_TIMESTAMP |                |\n+-----------------+---------------------+------+-----+-------------------+----------------+\n6 rows in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#2_2","title":"2 \u67e5\u770b\u5efa\u8868\u8bed\u53e5","text":"<pre><code>mysql&gt; SHOW CREATE TABLE students\\G;\n*************************** 1. row ***************************\n       Table: students\nCreate Table: CREATE TABLE `students` (\n  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '\u5b66\u53f7',\n  `name` varchar(255) NOT NULL COMMENT '\u59d3\u540d',\n  `age` tinyint(3) unsigned NOT NULL DEFAULT '0' COMMENT '\u5e74\u9f84',\n  `sex` enum('f','m','n') NOT NULL DEFAULT 'n' COMMENT '\u6027\u522b',\n  `id_card` char(18) NOT NULL COMMENT '\u8eab\u4efd\u8bc1',\n  `enrollment_time` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '\u62a5\u540d\u65f6\u95f4',\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `id_card` (`id_card`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='\u5b66\u751f\u8868'\n1 row in set (0.00 sec)\n\nERROR:\nNo query specified\n</code></pre>"},{"location":"databases/MySQL/SQL/#25","title":"2.5 \u590d\u5236\u8868","text":""},{"location":"databases/MySQL/SQL/#251","title":"2.5.1 \u4ec5\u590d\u5236\u8868\u7ed3\u6784","text":"<pre><code>CREATE TABLE stu1 LIKE students;\n</code></pre>"},{"location":"databases/MySQL/SQL/#252","title":"2.5.2 \u590d\u5236\u8868\u7ed3\u6784\u548c\u5168\u90e8\u6570\u636e","text":"<pre><code>CREATE TABLE stu2 SELECT * FROM students;\n</code></pre>"},{"location":"databases/MySQL/SQL/#252_1","title":"2.5.2 \u590d\u5236\u8868\u7ed3\u6784\u548c\u90e8\u5206\u6570\u636e","text":"<pre><code>CREATE TABLE stu3 SELECT * FROM students WHERE id &gt; 5;\n</code></pre>"},{"location":"databases/MySQL/SQL/#dml","title":"\u4e8c\u3001DML","text":"<p>\u5bf9\u8868\u7684\u589e\u5220\u6539</p>"},{"location":"databases/MySQL/SQL/#1_4","title":"1. \u63d2\u5165","text":""},{"location":"databases/MySQL/SQL/#11_1","title":"1.1\u65b9\u5f0f\u4e00","text":""},{"location":"databases/MySQL/SQL/#111","title":"1.1.1 \u4e3a\u8868\u7684\u6240\u6709\u5b57\u6bb5\u63d2\u5165\u6570\u636e","text":"<pre><code>INSERT INTO \u8868\u540d VALUES (\u503c1,\u503c2,...\u503cn);\n</code></pre>"},{"location":"databases/MySQL/SQL/#112","title":"1.1.2 \u4e3a\u8868\u7684\u6307\u5b9a\u5b57\u6bb5\u63d2\u5165\u6570\u636e","text":"<pre><code># \u8981\u4fdd\u8bc1\u6bcf\u4e2a\u63d2\u5165\u7684\u503c\u5f97\u7c7b\u578b\u548c\u5bf9\u5e94\u7c7b\u7684\u6570\u636e\u7c7b\u578b\u5339\u914d\nINSERT INTO \u8868\u540d(\u5b57\u6bb51,\u5b57\u6bb52,...\u5b57\u6bb5n) VALUES (\u503c1,\u503c2,...\u503cn);\n</code></pre>"},{"location":"databases/MySQL/SQL/#113","title":"1.1.3 \u540c\u65f6\u63d2\u5165\u591a\u6761\u8bb0\u5f55","text":"<pre><code>INSERT INTO \u8868\u540d(\u5b57\u6bb51,\u5b57\u6bb52,...\u5b57\u6bb5n) VALUES (\u503c1,\u503c2,...\u503cn),(\u503c1,\u503c2,...\u503cn);\n</code></pre>"},{"location":"databases/MySQL/SQL/#12_1","title":"1.2 \u65b9\u5f0f\u4e8c","text":""},{"location":"databases/MySQL/SQL/#121_1","title":"1.2.1  \u4e3a\u8868\u7684\u6307\u5b9a\u5b57\u6bb5\u63d2\u5165\u6570\u636e","text":"<pre><code>INSERT INTO \u8868\u540d SET \u5b57\u6bb51 = \u503c1,\n\u5b57\u6bb52 = \u503c2,\n\u5b57\u6bb53 = \u503c3;\n</code></pre> <p>\u4e24\u79cd\u65b9\u5f0f\u7684\u533a\u522b\uff1a</p> <ol> <li>\u65b9\u5f0f1\u652f\u6301\u63d2\u5165\u591a\u884c\uff0c\u4f46\u662f\u65b9\u5f0f2\u4e0d\u652f\u6301 </li> <li>\u65b9\u5f0f1\u652f\u6301\u5b50\u67e5\u8be2\uff0c\u65b9\u5f0f2\u4e0d\u652f\u6301 </li> </ol>"},{"location":"databases/MySQL/SQL/#2_3","title":"2. \u4fee\u6539","text":""},{"location":"databases/MySQL/SQL/#21_1","title":"2.1 \u4fee\u6539\u5355\u8868\u7684\u8bb0\u5f55","text":"<pre><code>UPDATE \u8868\u540d\nSET \u5217=\u65b0\u503c\uff0c\u5217=\u65b0\u503c\u2026\nWHERE \u7b5b\u9009\u6761\u4ef6\uff1b\n</code></pre>"},{"location":"databases/MySQL/SQL/#22_1","title":"2.2 \u4fee\u6539\u591a\u8868\u7684\u8bb0\u5f55","text":"<p>sql92\u8bed\u6cd5</p> <pre><code>UPDATE \u88681 \u522b\u540d\uff0c\u88682 \u522b\u540d\nSET \u5217=\u503c\u2026\nWHERE \u7b5b\u9009\u6761\u4ef6\nAND \u7b5b\u9009\u6761\u4ef6\uff1b\n</code></pre> <p>sql99\u8bed\u6cd5\uff1a </p> <pre><code>UPDATE \u88681 \u522b\u540d\n[INNER|LEFT|RIGHT] JOIN \u88682 \u522b\u540d\nON \u8fde\u63a5\u6761\u4ef6\nSET \u5217=\u503c\uff0c\u2026\nWHERE \u7b5b\u9009\u6761\u4ef6\uff1b\n</code></pre>"},{"location":"databases/MySQL/SQL/#3_3","title":"3. \u5220\u9664","text":""},{"location":"databases/MySQL/SQL/#31-delete","title":"3.1 <code>DELETE</code>","text":""},{"location":"databases/MySQL/SQL/#311","title":"3.1.1 \u5355\u8868\u5220\u9664","text":"<pre><code>DELETE FROM \u8868\u540d WHERE \u7b5b\u9009\u6761\u4ef6;\n</code></pre>"},{"location":"databases/MySQL/SQL/#312","title":"3.1.2 \u591a\u8868\u5220\u9664","text":"<p>sql92\u8bed\u6cd5</p> <pre><code>DELETE \u522b\u540d\uff08\u8981\u5220\u54ea\u4e2a\u8868\u5c31\u5199\u54ea\u4e2a\u8868\u7684\u522b\u540d\uff0c\u90fd\u5220\u5c31\u90fd\u5199\uff09\nFROM \u88681 \u522b\u540d\uff0c\u88682 \u522b\u540d\nWHERE \u8fde\u63a5\u6761\u4ef6\nAND \u7b5b\u9009\u6761\u4ef6\nLIMIT \u6761\u76ee\u6570\uff1b\n</code></pre> <p>sql99\u8bed\u6cd5</p> <pre><code>DELETE \u522b\u540d\uff08\u8981\u5220\u54ea\u4e2a\u8868\u5c31\u5199\u54ea\u4e2a\u8868\u7684\u522b\u540d\uff0c\u90fd\u5220\u5c31\u90fd\u5199\uff09\nFROM \u88681 \u522b\u540d\n[INNER|LEFT|RIGHT] JOIN \u88682 \u522b\u540d \nON \u8fde\u63a5\u6761\u4ef6\nWHERE \u7b5b\u9009\u6761\u4ef6\nLIMIT \u6761\u76ee\u6570\uff1b\n</code></pre>"},{"location":"databases/MySQL/SQL/#312_1","title":"3.1.2 \u5168\u8868\u5220\u9664","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>DELETE FROM students;\n# DML\u64cd\u4f5c\uff0c\u903b\u8f91\u6027\u5220\u9664\uff0c\u9010\u884c\u5220\u9664\uff0c\u901f\u5ea6\u6162\n</code></pre>"},{"location":"databases/MySQL/SQL/#32-truncate","title":"3.2 <code>TRUNCATE</code>","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>TRUNCATE TABLE students;\n# DDL\u64cd\u4f5c\uff0c\u8868\u6bb5\u4fdd\u7559\uff0c\u6570\u636e\u9875\u88ab\u6e05\u7a7a\uff0c\u901f\u5ea6\u5feb\n</code></pre> <p><code>DELETE</code>\u548c<code>TRUNCATE</code>\u7684\u533a\u522b\uff1a</p> <ol> <li>delete\u53ef\u4ee5\u52a0where\u6761\u4ef6\uff0ctruncate\u4e0d\u53ef\u4ee5</li> <li>truncate\u5220\u9664\u6548\u7387\u9ad8\u4e00\u4e9b</li> <li>\u5047\u5982\u8981\u5220\u9664\u7684\u8868\u4e2d\u6709\u81ea\u589e\u957f\u5217\uff0c\u5982\u679c\u7528delete\u5220\u9664\u540e\uff0c\u518d\u63d2\u5165\u6570\u636e\uff0c\u81ea\u589e\u957f\u5217\u7684\u503c\u4ece\u65ad\u70b9\u5f00\u59cb\uff0c\u800ctruncate\u5220\u9664\u540e\uff0c\u518d\u63d2\u5165\u6570\u636e\uff0c\u81ea\u589e\u957f\u5217\u7684\u503c\u4ece1\u5f00\u59cb\u3002</li> <li>truncate\u5220\u9664\u6ca1\u6709\u8fd4\u56de\u503c\uff0cdelete\u5220\u9664\u6709\u8fd4\u56de\u503c</li> <li>truncate\u5220\u9664\u4e0d\u80fd\u56de\u6eda\uff0cdelete\u5220\u9664\u53ef\u4ee5\u56de\u6eda</li> </ol>"},{"location":"databases/MySQL/SQL/#33","title":"3.3 \u4f2a\u5220\u9664","text":"<p>\u6dfb\u52a0\u4e00\u4e2a\u72b6\u6001\u5b57\u6bb5\uff0c\u7528\u6765\u6807\u8bc6\u662f\u5426\u5220\u9664</p> <pre><code># \u6dfb\u52a0\u72b6\u6001\u5b57\u6bb5\nALTER TABLE students ADD state TINYINT NOT NULL DEFAULT 1;\n# \u7528UPDATE\u4ee3\u66ffDELETE\nUPDATE students SET state=0 WHERE id=6;\n# \u4e1a\u52a1\u67e5\u8be2\nSELECT * FROM students WHERE state=1;\n</code></pre>"},{"location":"databases/MySQL/SQL/#dql","title":"\u4e09\u3001DQL","text":""},{"location":"databases/MySQL/SQL/#1_5","title":"1. \u57fa\u7840\u67e5\u8be2","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>SELECT \u67e5\u8be2\u5217\u8868\nfrom \u8868\u540d;\n</code></pre> <p>\u7279\u70b9\uff1a</p> <ol> <li> <p>\u67e5\u8be2\u5217\u8868\u53ef\u4ee5\u662f\u8868\u4e2d\u7684\u5b57\u6bb5\u3001\u5e38\u91cf\u3001\u8868\u8fbe\u5f0f\u3001\u51fd\u6570</p> </li> <li> <p>\u67e5\u8be2\u7684\u7ed3\u679c\u662f\u4e00\u4e2a\u865a\u62df\u7684\u8868\u683c</p> </li> </ol>"},{"location":"databases/MySQL/SQL/#11-select","title":"1.1 <code>SELECT</code>\u5355\u72ec\u4f7f\u7528","text":""},{"location":"databases/MySQL/SQL/#111_1","title":"1.1.1 \u67e5\u770b\u7cfb\u7edf\u53c2\u6570","text":"<pre><code>mysql [(none)]&gt;SELECT @@port;\n+--------+\n| @@port |\n+--------+\n|   3306 |\n+--------+\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#112_1","title":"1.1.2 \u4f7f\u7528\u5185\u7f6e\u51fd\u6570","text":"<pre><code>mysql [(none)]&gt;SELECT NOW();\n+---------------------+\n| NOW()               |\n+---------------------+\n| 2020-12-07 22:30:03 |\n+---------------------+\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#113_1","title":"1.1.3 \u67e5\u8be2\u8868\u8fbe\u5f0f","text":"<pre><code>mysql [(none)]&gt;SELECT 3*5;\n+-----+\n| 3*5 |\n+-----+\n|  15 |\n+-----+\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#12-from","title":"1.2  \u5355\u8868\u5b50\u53e5 - <code>FROM</code>","text":""},{"location":"databases/MySQL/SQL/#121_2","title":"1.2.1 \u67e5\u8be2\u6240\u6709\u5b57\u6bb5","text":"<pre><code>mysql [world]&gt;SELECT * FROM country;\n# \u4e0d\u8981\u5bf9\u5927\u8868\u8fdb\u884c\u64cd\u4f5c\n</code></pre>"},{"location":"databases/MySQL/SQL/#122_1","title":"1.2.2 \u67e5\u8be2\u6307\u5b9a\u5b57\u6bb5","text":"<pre><code>mysql [world]&gt;SELECT name FROM country;\n</code></pre>"},{"location":"databases/MySQL/SQL/#123_1","title":"1.2.3 \u67e5\u8be2\u591a\u4e2a\u5b57\u6bb5","text":"<pre><code>mysql [world]&gt;SELECT name, population FROM country;\n</code></pre>"},{"location":"databases/MySQL/SQL/#2-where","title":"2. \u6761\u4ef6\u67e5\u8be2 - <code>WHERE</code>","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>SELECT \u5b57\u6bb5\u540d1,\u5b57\u6bb5\u540d2,...\u5b57\u6bb5\u540dn\nFROM \u8868\u540d\nWHERE \u67e5\u8be2\u6761\u4ef6;\n</code></pre>"},{"location":"databases/MySQL/SQL/#21_2","title":"2.1 \u6309\u6761\u4ef6\u8868\u8fbe\u5f0f\u7b5b\u9009\uff08=\u3001&lt;&gt; \u3001!=\u3001 &lt;\u3001 &lt;=\u3001 &gt;\u3001 &gt;=\uff09","text":"<pre><code># \u67e5\u8be2\u6e56\u5317\u7684\u57ce\u5e02\nSELECT * FROM city WHERE District='HuBei';\n# \u67e5\u8be2\u4eba\u53e3\u5c0f\u4e8e100\u7684\u57ce\u5e02\nSELECT * FROM city WHERE Population &lt; 100;\n</code></pre>"},{"location":"databases/MySQL/SQL/#22-andor","title":"2.2 \u6309\u903b\u8f91\u903b\u8f91\u8868\u8fbe\u5f0f\u7b5b\u9009\uff08AND\u3001OR\uff09","text":"<p>\u4e3b\u8981\u4f5c\u7528\uff1a\u7528\u4e8e\u8fde\u63a5\u6761\u4ef6\u8868\u8fbe\u5f0f</p> <pre><code># \u67e5\u8be2\u4e2d\u56fd\u4eba\u53e3\u5927\u4e8e500\u4e07\u7684\u57ce\u5e02\nSELECT * FROM city WHERE CountryCode='CHN' AND Population &gt; 5000000;\n# \u67e5\u8be2\u4e2d\u56fd\u548c\u7f8e\u56fd\u7684\u57ce\u5e02\u4fe1\u606f\nSELECT * FROM city WHERE CountryCode='CHN' OR CountryCode='USA';\n</code></pre>"},{"location":"databases/MySQL/SQL/#23_1","title":"2.3 \u6a21\u7cca\u67e5\u8be2","text":""},{"location":"databases/MySQL/SQL/#231-wherelike","title":"2.3.1 WHERE\u914d\u5408<code>LIKE</code>\u8bed\u53e5","text":"<ol> <li>\u4e00\u822c\u548c\u901a\u914d\u7b26\u642d\u914d\u4f7f\u7528\uff0c\u53ef\u4ee5\u5224\u65ad\u5b57\u7b26\u578b\u6570\u503c\u6216\u6570\u503c\u578b</li> <li><code>%</code>\u5339\u914d\u4efb\u610f\u591a\u4e2a\u5b57\u7b26\uff0c\u5305\u542b0\u4e2a\u5b57\u7b26</li> <li><code>_</code>\u5339\u914d\u4efb\u610f\u5355\u4e2a\u5b57\u7b26</li> </ol> <pre><code># \u540d\u5b57\u4ee5guang\u5f00\u5934\u7684\u7701\nSELECT * FROM city WHERE District LIKE 'guang%'\n</code></pre> <p><code>%</code>\u4e0d\u80fd\u653e\u5728\u524d\u9762\uff0c\u56e0\u4e3a\u4e0d\u8d70\u7d22\u5f15</p>"},{"location":"databases/MySQL/SQL/#232-wherein","title":"2.3.2 WHERE\u914d\u5408<code>IN</code>\u8bed\u53e5","text":"<ol> <li>\u542b\u4e49\uff1a\u5224\u65ad\u67d0\u5b57\u6bb5\u7684\u503c\u662f\u5426\u5c5e\u4e8e<code>IN</code>\u5217\u8868\u4e2d\u7684\u67d0\u4e00\u9879 </li> <li>\u4f7f\u7528<code>IN</code>\u63d0\u9ad8\u8bed\u53e5\u7b80\u6d01\u5ea6 </li> <li><code>IN</code>\u76f8\u5f53\u4e8e\u7b49\u4e8e\uff0c\u6240\u4ee5\u4e0d\u652f\u6301\u901a\u914d\u7b26\uff08<code>like</code>\u624d\u652f\u6301\uff09 </li> </ol> <pre><code># \u67e5\u8be2\u4e2d\u56fd\u548c\u7f8e\u56fd\u7684\u57ce\u5e02\u4fe1\u606f,\u4e0eOR\u7c7b\u4f3c\nSELECT * FROM city WHERE CountryCode IN ('CHN','USA');\n</code></pre>"},{"location":"databases/MySQL/SQL/#234-wherebetreen-and","title":"2.3.4 WHERE\u914d\u5408<code>BETREEN AND</code>","text":"<ol> <li>\u4f7f\u7528between and\u53ef\u4ee5\u63d0\u9ad8\u8bed\u53e5\u7684\u7b80\u6d01\u5ea6</li> <li>\u5305\u542b\u4e34\u754c\u503c\uff1b </li> <li>\u4e24\u4e2a\u4e34\u754c\u503c\u4e0d\u80fd\u66ff\u6362\u987a\u5e8f\uff1b </li> </ol> <pre><code># \u67e5\u8be2\u4eba\u53e3\u5927\u4e8e100\u4e07\u5c0f\u4e8e200\u4e07\u57ce\u5e02\u4fe1\u606f\nSELECT * FROM city WHERE Population BETWEEN 1000000 AND 2000000;\n</code></pre>"},{"location":"databases/MySQL/SQL/#235-whereis-not-null","title":"2.3.5 WHERE\u914d\u5408<code>IS [NOT] NULL</code>","text":"<ol> <li>\u7528\u4e8e\u5224\u65ad<code>null</code>\u503c </li> <li><code>=</code>\u6216\u8005<code>&lt;&gt;</code>\u4e0d\u80fd\u7528\u4e8e\u5224\u65ad<code>null</code>\u503c </li> </ol> <pre><code>SELECT name FROM country WHERE indepyear IS NULL;\n</code></pre>"},{"location":"databases/MySQL/SQL/#3_4","title":"3. \u6392\u5e8f\u67e5\u8be2","text":"<p>\u8bed\u6cd5</p> <pre><code>SELECT \u67e5\u8be2\u5217\u8868\nFROM \u8868\n[WHERE \u7b5b\u9009\u6761\u4ef6]\nORDER BY \u6392\u5e8f\u5217\u8868 [ASC|DESC]\n</code></pre> <ol> <li><code>ASC</code>\u4ee3\u8868\u7684\u662f\u5347\u5e8f\uff0c<code>DESC</code> \u4ee3\u8868\u7684\u662f\u964d\u5e8f\uff0c\u5982\u679c\u4e0d\u5199\uff0c\u9ed8\u8ba4\u662f\u5347\u5e8f</li> <li><code>ORDER BY</code>\u5b50\u53e5\u4e2d\u53ef\u4ee5\u652f\u6301\u5355\u4e2a\u5b57\u6bb5\u3001\u591a\u4e2a\u5b57\u6bb5\u3001\u8868\u8fbe\u5f0f\u3001\u51fd\u6570\u3001\u522b\u540d </li> <li><code>ORDER BY</code>\u5b50\u53e5\u4e00\u822c\u662f\u653e\u5728\u67e5\u8be2\u8bed\u53e5\u7684\u6700\u540e\u9762\uff0c\u4f46<code>limit</code>\u5b50\u53e5\u9664\u5916 </li> </ol> <pre><code># \u67e5\u8be2\u4e2d\u56fd\u7684\u57ce\u5e02\u4fe1\u606f\uff0c\u5e76\u6309\u4eba\u53e3\u6570\u91cf\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\nSELECT * FROM city\nWHERE CountryCode='CHN'\nORDER BY Population DESC;\n</code></pre>"},{"location":"databases/MySQL/SQL/#4_1","title":"4. \u5206\u7ec4\u67e5\u8be2","text":"<p>\u8bed\u6cd5</p> <pre><code>SELECT\u5b50\u53e5 \u5206\u7ec4\u51fd\u6570\uff0c\u5217\uff08\u8981\u6c42\u51fa\u73b0\u5728group by\u7684\u540e\u9762\uff09\nFROM \u8868\n[WHERE \u7b5b\u9009\u6761\u4ef6]\nGROUP BY \u5206\u7ec4\u5217\u8868\n[HAVING \u5206\u7ec4\u540e\u7684\u7b5b\u9009]\n[ORDER BY \u6392\u5e8f\u5217\u8868]\n# \u6267\u884c\u987a\u5e8f\uff1aFROM-&gt;WHERE-&gt;GROUP BY\u5b50\u53e5-&gt;HAVING\u5b50\u53e5-&gt;SELECT\u5b50\u53e5-&gt;ORDER BY\u5b50\u53e5\n</code></pre> <p>\u6ce8\u610f\uff1a\u67e5\u8be2\u5217\u8868\u6bd4\u8f83\u7279\u6b8a\uff0c\u8981\u6c42\u662f\u5206\u7ec4\u51fd\u6570\u548cgroup by\u540e\u51fa\u73b0\u7684\u5b57\u6bb5 </p> <p>\u7279\u70b9\uff1a</p> <ol> <li> <p>\u5206\u7ec4\u67e5\u8be2\u4e2d\u7684\u7b5b\u9009\u6761\u4ef6\u5206\u4e3a\u4e24\u7c7b\uff1a</p> <ul> <li> <p>\u5206\u7ec4\u524d\u7b5b\u9009 \u57fa\u4e8e\u539f\u59cb\u8868\u7b5b\u9009\uff0c\u5728<code>group by</code>\u5b50\u53e5\u7684\u524d\u9762\uff0c\u4f7f\u7528\u5173\u952e\u8bcd<code>where</code></p> </li> <li> <p>\u5206\u7ec4\u540e\u7b5b\u9009 \u57fa\u4e8e\u5206\u7ec4\u540e\u7684\u7ed3\u679c\u96c6\u7b5b\u9009\uff0c\u5728<code>group by</code>\u5b50\u53e5\u7684\u540e\u9762 \u4f7f\u7528\u5173\u952e\u8bcd<code>having</code></p> </li> </ul> </li> <li> <p>\u5206\u7ec4\u51fd\u6570\u505a\u6761\u4ef6\u80af\u5b9a\u662f\u653e\u5728having\u5b50\u53e5\u4e2d</p> </li> <li> <p>\u80fd\u7528\u5206\u7ec4\u524d\u7b5b\u9009\u7684\uff0c\u5c31\u4f18\u5148\u8003\u8651\u4f7f\u7528\u5206\u7ec4\u524d\u7b5b\u9009</p> </li> <li> <p>group by\u5b50\u53e5\u652f\u6301\u5355\u4e2a\u5b57\u6bb5\u5206\u7ec4\uff0c\u591a\u4e2a\u5b57\u6bb5\u5206\u7ec4\uff08\u591a\u4e2a\u5b57\u6bb5\u4e4b\u95f4\u7528\u9017\u53f7\u9694\u5f00\u6ca1\u6709\u987a\u5e8f\u8981\u6c42\uff09\uff0c\u8868\u8fbe\u5f0f\u6216\u51fd\u6570\uff08\u7528\u5f97\u8f83\u5c11\uff09</p> </li> <li> <p>\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u6392\u5e8f\uff08\u6392\u5e8f\u653e\u5728\u6574\u4e2a\u5206\u7ec4\u67e5\u8be2\u6700\u540e\u4f4d\u7f6e\uff09</p> </li> </ol>"},{"location":"databases/MySQL/SQL/#41","title":"4.1 \u7b80\u5355\u5206\u7ec4","text":"<p>\u4f8b  \u67e5\u8be2\u6bcf\u4e2a\u5de5\u79cd\u7684\u6700\u9ad8\u5de5\u8d44</p> <pre><code>SELECT \n  MAX(salary),\n  job_id \nFROM\n  employees \nGROUP BY job_id ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#42","title":"4.2 \u5206\u7ec4\u524d\u7b5b\u9009","text":"<p>\u4f8b \u67e5\u8be2\u6bcf\u4e2a\u9886\u5bfc\u624b\u4e0b\u6709\u5956\u91d1\u7684\u5458\u5de5\u7684\u5e73\u5747\u5de5\u8d44</p> <pre><code>SELECT AVG(salary) \u5e73\u5747\u5de5\u8d44,manager_id\nFROM employees\nWHERE commission_pct IS NOT NULL\nGROUP BY manager_id;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+--------------+------------+\n| \u5e73\u5747\u5de5\u8d44     | manager_id |\n+--------------+------------+\n| 12200.000000 |        100 |\n|  8500.000000 |        145 |\n|  8500.000000 |        146 |\n|  7766.666667 |        147 |\n|  8650.000000 |        148 |\n|  8333.333333 |        149 |\n+--------------+------------+\n</code></pre>"},{"location":"databases/MySQL/SQL/#43","title":"4.3 \u5206\u7ec4\u540e\u7b5b\u9009","text":"<p>\u540e\u8fc7\u6ee4\uff0c\u7528\u5728GROUP BY\u4e4b\u540e\uff0cHAVING\u6761\u4ef6\u662f\u4e0d\u8d70\u7d22\u5f15\u7684\uff0c\u4e00\u822c\u53ef\u4ee5\u7528\u4e34\u65f6\u8868\u89e3\u51b3\u3002</p> <p>\u4f8b1 \u67e5\u8be2\u54ea\u4e2a\u90e8\u95e8\u7684\u5458\u5de5\u4e2a\u6570&gt;5</p> <pre><code>SELECT COUNT(*) \u5458\u5de5\u4e2a\u6570,department_id\nFROM employees\nGROUP BY department_id\nHAVING  COUNT(*)&gt;5;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+--------------+---------------+\n| \u5458\u5de5\u4e2a\u6570     | department_id |\n+--------------+---------------+\n|            6 |            30 |\n|           45 |            50 |\n|           34 |            80 |\n|            6 |           100 |\n+--------------+---------------+\n</code></pre> <p>\u4f8b2 \u6bcf\u4e2a\u5de5\u79cd\u6709\u5956\u91d1\u7684\u5458\u5de5\u7684\u6700\u9ad8\u5de5\u8d44&gt;12000\u7684\u5de5\u79cd\u7f16\u53f7\u548c\u6700\u9ad8\u5de5\u8d44</p> <pre><code>SELECT job_id,MAX(salary)\nFROM employees\nWHERE commission_pct  IS NOT NULL\nGROUP BY job_id\nHAVING MAX(salary)&gt;12000;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+--------+-------------+\n| job_id | MAX(salary) |\n+--------+-------------+\n| SA_MAN |    14000.00 |\n+--------+-------------+\n</code></pre>"},{"location":"databases/MySQL/SQL/#44","title":"4.4  \u5206\u7ec4\u540e\u6392\u5e8f","text":"<p>\u4f8b \u67e5\u8be2\u6ca1\u6709\u5956\u91d1\u7684\u5458\u5de5\u7684\u6700\u9ad8\u5de5\u8d44&gt;6000\u7684\u5de5\u79cd\u7f16\u53f7\u548c\u6700\u9ad8\u5de5\u8d44,\u6309\u6700\u9ad8\u5de5\u8d44\u5347\u5e8f</p> <pre><code># \u7b2c\u4e00\u6b65\uff1a\u6309\u5de5\u79cd\u5206\u7ec4\uff0c\u67e5\u8be2\u6bcf\u4e2a\u5de5\u79cd\u6709\u5956\u91d1\u7684\u5458\u5de5\u7684\u6700\u9ad8\u5de5\u8d44\nSELECT MAX(salary) \u6700\u9ad8\u5de5\u8d44,job_id\nFROM employees\nWHERE commission_pct IS  NULL\nGROUP BY job_id\nHAVING MAX(salary)&gt;6000   # \u7b2c\u4e8c\u6b65\uff1a\u7b5b\u9009\u521a\u624d\u7684\u7ed3\u679c\uff0c\u770b\u54ea\u4e2a\u6700\u9ad8\u5de5\u8d44&gt;6000\nORDER BY MAX(salary) ASC; # \u7b2c\u4e09\u6b65\uff1a\u6309\u6700\u9ad8\u5de5\u8d44\u5347\u5e8f\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+--------------+------------+\n| \u6700\u9ad8\u5de5\u8d44     | job_id     |\n+--------------+------------+\n|      6500.00 | HR_REP     |\n|      8200.00 | ST_MAN     |\n|      8300.00 | AC_ACCOUNT |\n|      9000.00 | FI_ACCOUNT |\n|      9000.00 | IT_PROG    |\n|     10000.00 | PR_REP     |\n|     11000.00 | PU_MAN     |\n|     12000.00 | FI_MGR     |\n|     12000.00 | AC_MGR     |\n|     13000.00 | MK_MAN     |\n|     17000.00 | AD_VP      |\n|     24000.00 | AD_PRES    |\n+--------------+------------+\n</code></pre>"},{"location":"databases/MySQL/SQL/#45","title":"4.5 \u6309\u591a\u4e2a\u5b57\u6bb5\u5206\u7ec4","text":"<p>\u4f8b  \u67e5\u8be2\u6bcf\u4e2a\u90e8\u95e8\u6bcf\u4e2a\u5de5\u79cd\u7684\u5458\u5de5\u7684\u5e73\u5747\u5de5\u8d44 </p> <pre><code>SELECT \n  AVG(salary),\n  department_id,\n  job_id \nFROM\n  employees \nGROUP BY department_id, job_id ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#46","title":"4.6  \u6309\u8868\u8fbe\u5f0f\u6216\u51fd\u6570\u5206\u7ec4","text":"<p>\u4f8b  \u6309\u5458\u5de5\u59d3\u540d\u7684\u957f\u5ea6\u5206\u7ec4\uff0c\u67e5\u8be2\u6bcf\u4e00\u7ec4\u7684\u5458\u5de5\u4e2a\u6570\uff0c\u7b5b\u9009\u5458\u5de5\u4e2a\u6570&gt;5\u7684\u6709\u54ea\u4e9b</p> <pre><code>SELECT \n  COUNT(*) \u5458\u5de5\u4e2a\u6570,\n  LENGTH(last_name) \u59d3\u540d\u957f\u5ea6 \nFROM\n  employees \nGROUP BY \u59d3\u540d\u957f\u5ea6     # \u67e5\u8be2\u6bcf\u4e2a\u957f\u5ea6\u7684\u5458\u5de5\u4e2a\u6570 \nHAVING \u5458\u5de5\u4e2a\u6570 &gt; 5 ; # \u6dfb\u52a0\u7b5b\u9009\u6761\u4ef6\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+--------------+--------------+\n| \u5458\u5de5\u4e2a\u6570     | \u59d3\u540d\u957f\u5ea6     |\n+--------------+--------------+\n|           11 |            4 |\n|           29 |            5 |\n|           28 |            6 |\n|           15 |            7 |\n|            7 |            8 |\n|            8 |            9 |\n+--------------+--------------+\n</code></pre>"},{"location":"databases/MySQL/SQL/#3_5","title":"3. \u8fde\u63a5\u67e5\u8be2","text":"<p>\u53c8\u79f0\u591a\u8868\u67e5\u8be2\uff0c\u5f53\u67e5\u8be2\u7684\u5b57\u6bb5\u6765\u81ea\u4e8e\u591a\u4e2a\u8868\u65f6\uff0c\u5c31\u4f1a\u7528\u5230\u8fde\u63a5\u67e5\u8be2\u3002</p> <p>\u7b1b\u5361\u5c14\u79ef\u73b0\u8c61\uff1a\u5f53\u4e24\u5f20\u8868\u8fdb\u884c\u8fde\u63a5\u67e5\u8be2\u7684\u65f6\u5019\uff0c\u6ca1\u6709\u4efb\u4f55\u6761\u4ef6\u8fdb\u884c\u9650\u5236\uff0c\u6700\u7ec8\u7684\u67e5\u8be2\u7ed3\u679c\u6761\u6570\u662f\u4e24\u5f20\u8868\u8bb0\u5f55\u6761\u6570\u7684\u4e58\u79ef\u3002</p>"},{"location":"databases/MySQL/SQL/#31","title":"3.1 \u5206\u7c7b","text":"<ol> <li>\u6309\u5e74\u4ee3\u5206\u7c7b<ul> <li>SQL92\u6807\u51c6\uff1a \u4ec5\u652f\u6301\u5185\u8fde\u63a5 </li> <li>SQL99\u6807\u51c6\uff1a\u63a8\u8350\u4f7f\u7528\uff0c\u652f\u6301\u5185\u8fde\u63a5\u3001\u5916\u8fde\u63a5\uff08\u5de6\u5916\u548c\u53f3\u5916\uff09\u3001\u4ea4\u53c9\u8fde\u63a5</li> </ul> </li> <li>\u6309\u8fde\u63a5\u65b9\u5f0f\u5206\u7c7b<ol> <li>\u5185\u8fde\u63a5<ol> <li>\u7b49\u503c\u8fde\u63a5</li> <li>\u975e\u7b49\u503c\u8fde\u63a5</li> <li>\u81ea\u8fde\u63a5</li> </ol> </li> <li>\u5916\u8fde\u63a5<ol> <li>\u5de6\u5916\u8fde\u63a5</li> <li>\u53f3\u5916\u8fde\u63a5</li> <li>\u5168\u5916\u8fde\u63a5\uff08MySQL\u4e0d\u652f\u6301\uff09</li> </ol> </li> </ol> </li> <li>\u4ea4\u53c9\u8fde\u63a5</li> </ol>"},{"location":"databases/MySQL/SQL/#32-sql92","title":"3.2 SQL92\u8bed\u6cd5","text":""},{"location":"databases/MySQL/SQL/#1_6","title":"1. \u7b49\u503c\u8fde\u63a5","text":"<p>\u7279\u70b9\uff1a</p> <ol> <li> <p>\u591a\u8868\u7b49\u503c\u8fde\u63a5\u7684\u7ed3\u679c\u4e3a\u591a\u8868\u7684\u4ea4\u96c6\u90e8\u5206</p> </li> <li> <p>n\u8868\u8fde\u63a5\uff0c\u81f3\u5c11\u9700\u8981n-1\u4e2a\u8fde\u63a5\u6761\u4ef6</p> </li> <li> <p>\u591a\u8868\u7684\u987a\u5e8f\u6ca1\u6709\u8981\u6c42</p> </li> <li> <p>\u4e00\u822c\u9700\u8981\u4e3a\u8868\u8d77\u522b\u540d</p> </li> <li> <p>\u53ef\u4ee5\u642d\u914d\u524d\u9762\u4ecb\u7ecd\u7684\u6240\u6709\u5b50\u53e5\u4f7f\u7528\uff0c\u6bd4\u5982\u6392\u5e8f\u3001\u5206\u7ec4\u3001\u7b5b\u9009</p> </li> </ol>"},{"location":"databases/MySQL/SQL/#11_2","title":"1.1 \u7b80\u5355\u67e5\u8be2","text":"<pre><code>SELECT \n  last_name,\n  department_name \nFROM\n  employees,\n  departments \nWHERE employees.`department_id` = departments.`department_id` ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#12_2","title":"1.2 \u4e3a\u8868\u8d77\u522b\u540d","text":"<pre><code># \u67e5\u8be2\u5458\u5de5\u540d\u3001\u5de5\u79cd\u53f7\u3001\u5de5\u79cd\u540d\nSELECT \n  last_name,\n  e.`job_id`,\n  job_title \nFROM\n  employees e,\n  jobs j \nWHERE e.`job_id` = j.`job_id` ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#13_1","title":"1.3 \u8868\u7684\u987a\u5e8f\u53ef\u4ee5\u8c03\u6362","text":"<pre><code># \u67e5\u8be2\u5458\u5de5\u540d\u3001\u5de5\u79cd\u53f7\u3001\u5de5\u79cd\u540d\nSELECT \n  last_name,\n  e.`job_id`,\n  job_title \nFROM\n  jobs j ,\n  employees e\nWHERE e.`job_id` = j.`job_id` ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#14","title":"1.4 \u52a0\u7b5b\u9009\u6761\u4ef6","text":"<pre><code># \u67e5\u8be2\u6709\u5956\u91d1\u7684\u5458\u5de5\u540d\u3001\u90e8\u95e8\u540d\nSELECT \n  last_name,\n  department_name \nFROM\n  employees AS e,\n  departments AS d \nWHERE e.`department_id` = d.`department_id` \n  AND e.`commission_pct` IS NOT NULL ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#15","title":"1.5 \u52a0\u5206\u7ec4","text":"<pre><code># \u67e5\u8be2\u6bcf\u4e2a\u57ce\u5e02\u7684\u90e8\u95e8\u4e2a\u6570\nSELECT \n  COUNT(*) \u4e2a\u6570,\n  city \nFROM\n  departments d,\n  locations l \nWHERE d.`location_id` = l.`location_id` \nGROUP BY city ;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+--------+---------------------+\n| \u4e2a\u6570   | city                |\n+--------+---------------------+\n|      1 | London              |\n|      1 | Munich              |\n|      1 | Oxford              |\n|     21 | Seattle             |\n|      1 | South San Francisco |\n|      1 | Southlake           |\n|      1 | Toronto             |\n+--------+---------------------+\n7 rows in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#16","title":"1.6 \u52a0\u6392\u5e8f","text":"<pre><code># \u67e5\u8be2\u6bcf\u4e2a\u5de5\u79cd\u7684\u5de5\u79cd\u540d\u548c\u5458\u5de5\u7684\u4e2a\u6570\uff0c\u5e76\u4e14\u6309\u5458\u5de5\u4e2a\u6570\u964d\u5e8f\nSELECT \n  job_title,\n  COUNT(*) AS \u4e2a\u6570 \nFROM\n  employees e,\n  jobs j \nWHERE e.`job_id` = j.`job_id` \nGROUP BY job_title \nORDER BY \u4e2a\u6570 DESC ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#17","title":"1.7 \u4e09\u8868\u8fde\u63a5","text":"<pre><code># \u67e5\u8be2\u5458\u5de5\u540d\u3001\u90e8\u95e8\u540d\u548c\u6240\u5728\u7684\u57ce\u5e02\nSELECT \n  last_name,\n  department_name,\n  city \nFROM\n  employees e,\n  departments d,\n  locations l \nWHERE e.`department_id` = d.`department_id` \n  AND d.`location_id` = l.`location_id` ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#2_4","title":"2. \u975e\u7b49\u503c\u8fde\u63a5","text":"<pre><code># \u67e5\u8be2\u5458\u5de5\u7684\u5de5\u8d44\u548c\u5de5\u8d44\u7ea7\u522b\nSELECT \n  salary,\n  grade_level \nFROM\n  employees e,\n  job_grades g \nWHERE salary BETWEEN g.lowest_sal \n  AND g.highest_sal ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#3_6","title":"3. \u81ea\u8fde\u63a5","text":"<pre><code># \u67e5\u8be2\u5458\u5de5\u540d\u548c\u4e0a\u7ea7\u7684\u540d\u79f0\nSELECT e.employee_id,e.last_name,m.employee_id,m.last_name\nFROM employees e,employees m\nWHERE e.`manager_id`=m.`employee_id`;\n</code></pre>"},{"location":"databases/MySQL/SQL/#33-sql99","title":"3.3 SQL99\u8bed\u6cd5","text":"<p>SQL92\u548cSQL99\u7684\u533a\u522b\uff1a</p> <p>\u200b        SQL99\uff0c\u4f7f\u7528JOIN\u5173\u952e\u5b57\u4ee3\u66ff\u4e86\u4e4b\u524d\u7684\u9017\u53f7\uff0c\u5e76\u4e14\u5c06\u8fde\u63a5\u6761\u4ef6\u548c\u7b5b\u9009\u6761\u4ef6\u8fdb\u884c\u4e86\u5206\u79bb\uff0c\u63d0\u9ad8\u9605\u8bfb\u6027</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>SELECT  \u67e5\u8be2\u5217\u8868\nFROM  \u88681 \u522b\u540d [\u8fde\u63a5\u7c7b\u578b]\nJOIN \u88682 \u522b\u540d\nON   \u8fde\u63a5\u6761\u4ef6\n[WHERE  \u7b5b\u9009\u6761\u4ef6]\n[GROUP BY \u5206\u7ec4]\n[HAVING  \u7b5b\u9009\u6761\u4ef6]\n[ORDER BY \u6392\u5e8f\u5217\u8868]\n# \u8fde\u63a5\u7c7b\u578b\n# \u5185\u8fde\u63a5\uff1ainner\n# \u5916\u8fde\u63a5\n#    \u5de6\u5916\uff1aleft  [outer]\n#    \u53f3\u5916\uff1aright [outer]\n#    \u5168\u5916\uff1afull  [outer]\n# \u4ea4\u53c9\u8fde\u63a5\uff1across\n</code></pre>"},{"location":"databases/MySQL/SQL/#1_7","title":"1. \u5185\u8fde\u63a5","text":"<p>\u7279\u70b9\uff1a</p> <ol> <li>\u6dfb\u52a0\u6392\u5e8f\u3001\u5206\u7ec4\u3001\u7b5b\u9009</li> <li>inner\u53ef\u4ee5\u7701\u7565</li> <li>\u7b5b\u9009\u6761\u4ef6\u653e\u5728where\u540e\u9762\uff0c\u8fde\u63a5\u6761\u4ef6\u653e\u5728on\u540e\u9762\uff0c\u63d0\u9ad8\u5206\u79bb\u6027\uff0c\u4fbf\u4e8e\u9605\u8bfb</li> <li>inner join\u8fde\u63a5\u548csql92\u8bed\u6cd5\u4e2d\u7684\u7b49\u503c\u8fde\u63a5\u6548\u679c\u662f\u4e00\u6837\u7684\uff0c\u90fd\u662f\u67e5\u8be2\u591a\u8868\u7684\u4ea4\u96c6</li> </ol>"},{"location":"databases/MySQL/SQL/#11_3","title":"1.1 \u7b49\u503c\u8fde\u63a5","text":"<p>\u4f8b1 \u67e5\u8be2\u5458\u5de5\u540d\u3001\u90e8\u95e8\u540d </p> <pre><code>SELECT \n  last_name,\n  department_name \nFROM\n  employees e \n  INNER JOIN departments d \n    ON e.`department_id` = d.`department_id` ;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+-------------+-----------------+\n| last_name   | department_name |\n+-------------+-----------------+\n| Whalen      | Adm             |\n...\n| Higgins     | Acc             |\n| Gietz       | Acc             |\n+-------------+-----------------+\n106 rows in set (0.01 sec)\n</code></pre> <p>\u4f8b2  \u67e5\u8be2\u54ea\u4e2a\u90e8\u95e8\u7684\u90e8\u95e8\u5458\u5de5\u4e2a\u6570&gt;3\u7684\u90e8\u95e8\u540d\u548c\u5458\u5de5\u4e2a\u6570\uff0c\u5e76\u6309\u4e2a\u6570\u964d\u5e8f\u6392\u5e8f </p> <pre><code>SELECT \n  department_name,\n  COUNT(*) \u5458\u5de5\u4e2a\u6570 \nFROM\n  departments d \n  INNER JOIN employees e \n    ON d.`department_id` = e.`department_id` \nGROUP BY d.`department_id` \nHAVING \u5458\u5de5\u4e2a\u6570 &gt; 3 \nORDER BY \u5458\u5de5\u4e2a\u6570 DESC ;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+-----------------+--------------+\n| department_name | \u5458\u5de5\u4e2a\u6570     |\n+-----------------+--------------+\n| Shi             |           45 |\n| Sal             |           34 |\n| Fin             |            6 |\n| Pur             |            6 |\n| IT              |            5 |\n+-----------------+--------------+\n5 rows in set (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#12_3","title":"1.2 \u975e\u7b49\u503c\u8fde\u63a5","text":"<p>\u4f8b1  \u67e5\u8be2\u5458\u5de5\u7684\u5de5\u8d44\u7ea7\u522b </p> <pre><code>SELECT \n  salary,\n  grade_level \nFROM\n  employees e \n  INNER JOIN job_grades g \n    ON e.`salary` BETWEEN g.`lowest_sal` \n    AND g.`highest_sal` ;\n</code></pre> <p>\u4f8b2  \u67e5\u8be2\u6bcf\u4e2a\u5de5\u8d44\u7ea7\u522b&gt;20\u7684\u4e2a\u6570\uff0c\u5e76\u4e14\u6309\u5de5\u8d44\u7ea7\u522b\u964d\u5e8f </p> <pre><code>SELECT \n  COUNT(*),\n  grade_level \nFROM\n  employees e \n  INNER JOIN job_grades g \n    ON e.`salary` BETWEEN g.`lowest_sal` \n    AND g.`highest_sal` \nGROUP BY grade_level \nHAVING COUNT(*) &gt; 20 \nORDER BY grade_level DESC ;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+----------+-------------+\n| COUNT(*) | grade_level |\n+----------+-------------+\n|       38 | C           |\n|       26 | B           |\n|       24 | A           |\n+----------+-------------+\n3 rows in set (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#13_2","title":"1.3 \u81ea\u8fde\u63a5","text":"<p>\u4f8b1  \u67e5\u8be2\u5458\u5de5\u7684\u540d\u5b57\u3001\u4e0a\u7ea7\u7684\u540d\u5b57</p> <pre><code>SELECT \n  e.last_name,\n  m.last_name \nFROM\n  employees e \nINNER JOIN employees m \n  ON e.`manager_id` = m.`employee_id` ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#2_5","title":"2. \u5916\u8fde\u63a5","text":"<p>\u5e94\u7528\u573a\u666f\uff1a\u7528\u4e8e\u67e5\u8be2\u4e00\u4e2a\u8868\u4e2d\u6709\uff0c\u53e6\u4e00\u4e2a\u8868\u6ca1\u6709\u7684\u8bb0\u5f55 </p> <p>\u7279\u70b9\uff1a </p> <ol> <li> <p>\u5916\u8fde\u63a5\u7684\u67e5\u8be2\u7ed3\u679c\u4e3a\u4e3b\u8868\u4e2d\u7684\u6240\u6709\u8bb0\u5f55\uff0c\u5982\u679c\u4ece\u8868\u4e2d\u6709\u548c\u5b83\u5339\u914d\u7684\uff0c\u5219\u663e\u793a\u5339\u914d\u7684\u503c\uff0c\u5982\u679c\u4ece\u8868\u4e2d\u6ca1\u6709\u548c\u5b83\u5339\u914d\u7684\uff0c\u5219\u663e\u793anull</p> </li> <li> <p>\u5916\u8fde\u63a5\u67e5\u8be2\u7ed3\u679c=\u5185\u8fde\u63a5\u7ed3\u679c+\u4e3b\u8868\u4e2d\u6709\u800c\u4ece\u8868\u4e2d\u6ca1\u6709\u7684\u8bb0\u5f55</p> </li> <li> <p>\u5de6\u5916\u8fde\u63a5\uff1aleft join\u5de6\u8fb9\u7684\u662f\u4e3b\u8868</p> </li> <li> <p>\u53f3\u5916\u8fde\u63a5\uff1aright join\u53f3\u8fb9\u7684\u662f\u4e3b\u8868</p> </li> <li> <p>\u5de6\u5916\u548c\u53f3\u5916\u4ea4\u6362\u4e24\u4e2a\u8868\u7684\u987a\u5e8f\uff0c\u53ef\u4ee5\u5b9e\u73b0\u540c\u6837\u7684\u6548\u679c</p> </li> <li> <p>\u5168\u5916\u8fde\u63a5=\u5185\u8fde\u63a5\u7684\u7ed3\u679c+\u88681\u4e2d\u6709\u4f46\u88682\u4e2d\u6ca1\u6709\u7684+\u88682\u4e2d\u6709\u4f46\u88681\u4e2d\u6ca1\u6709\u7684</p> </li> </ol>"},{"location":"databases/MySQL/SQL/#21_3","title":"2.1 \u5de6\u5916\u8fde\u63a5","text":"<pre><code># \u67e5\u8be2\u54ea\u4e2a\u90e8\u95e8\u6ca1\u6709\u5458\u5de5\nSELECT \n  d.*,\n  e.employee_id \nFROM\n  departments d \n  LEFT OUTER JOIN employees e \n    ON d.`department_id` = e.`department_id` \nWHERE e.`employee_id` IS NULL ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#22_2","title":"2.2 \u53f3\u5916\u8fde\u63a5","text":"<pre><code>SELECT \n  d.*,\n  e.employee_id \nFROM\n  employees e \n  RIGHT OUTER JOIN departments d \n    ON d.`department_id` = e.`department_id` \nWHERE e.`employee_id` IS NULL ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#33-mysql","title":"3.3 \u5168\u5916\u8fde\u63a5\uff08mysql\u4e0d\u652f\u6301\uff09","text":""},{"location":"databases/MySQL/SQL/#3_7","title":"3. \u4ea4\u53c9\u8fde\u63a5\uff08\u7b1b\u5361\u5c14\u4e58\u79ef\uff09","text":""},{"location":"databases/MySQL/SQL/#4_2","title":"4.\u5b50\u67e5\u8be2","text":"<p>\u5f53\u4e00\u4e2a\u67e5\u8be2\u8bed\u53e5\u4e2d\u53c8\u5d4c\u5957\u4e86\u53e6\u4e00\u4e2a\u5b8c\u6574\u7684select\u8bed\u53e5\uff0c\u5219\u88ab\u5d4c\u5957\u7684select\u8bed\u53e5\u79f0\u4e3a\u5b50\u67e5\u8be2\u6216\u5185\u67e5\u8be2\uff0c\u5916\u9762\u7684select\u8bed\u53e5\u79f0\u4e3a\u4e3b\u67e5\u8be2\u6216\u5916\u67e5\u8be2\u3002</p> <p>\u5206\u7c7b\uff1a</p> <ol> <li> <p>\u6309\u5b50\u67e5\u8be2\u51fa\u73b0\u7684\u4f4d\u7f6e\uff1a</p> <ul> <li>select\u540e\u9762\uff1a\u8981\u6c42\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u4e3a\u5355\u884c\u5355\u5217\uff08\u79f0\u4e3a\u6807\u91cf\u5b50\u67e5\u8be2\uff09</li> <li>from\u540e\u9762\uff1a\u8981\u6c42\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u53ef\u4ee5\u4e3a\u591a\u884c\u591a\u5217</li> <li>where\u6216having\u540e\u9762\uff1a\u8981\u6c42\u5b50\u67e5\u8be2\u7684\u7ed3\u679c\u5fc5\u987b\u4e3a\u5355\u5217\uff08\u5355\u5217\u53c8\u5206\u4e3a\u5355\u884c\u5b50\u67e5\u8be2\u548c\u591a\u884c\u5b50\u67e5\u8be2\uff09</li> <li>exists\u540e\u9762\uff08\u76f8\u5173\u5b50\u67e5\u8be2\uff09\uff1a\u8981\u6c42\u5b50\u67e5\u8be2\u7ed3\u679c\u5fc5\u987b\u4e3a\u5355\u5217\uff08\u76f8\u5173\u5b50\u67e5\u8be2\uff09</li> </ul> </li> <li> <p>\u6309\u529f\u80fd\u3001\u7ed3\u679c\u96c6\u7684\u884c\u5217\u6570\u4e0d\u540c\uff1a</p> <ul> <li>\u6807\u91cf\u5b50\u67e5\u8be2\uff08\u7ed3\u679c\u96c6\u53ea\u6709\u4e00\u884c\u4e00\u5217\uff09</li> <li>\u5217\u5b50\u67e5\u8be2\uff08\u7ed3\u679c\u96c6\u53ea\u6709\u4e00\u5217\u591a\u884c\uff09</li> <li>\u884c\u5b50\u67e5\u8be2\uff08\u7ed3\u679c\u96c6\u6709\u4e00\u884c\u591a\u5217\uff09</li> <li>\u8868\u5b50\u67e5\u8be2\uff08\u7ed3\u679c\u96c6\u4e00\u822c\u4e3a\u591a\u884c\u591a\u5217\uff09</li> </ul> </li> </ol> <p>\u7279\u70b9\uff1a</p> <ol> <li>\u5b50\u67e5\u8be2\u653e\u5728\u6761\u4ef6\u4e2d\uff0c\u8981\u6c42\u5fc5\u987b\u653e\u5728\u6761\u4ef6\u7684\u53f3\u4fa7</li> <li>\u5b50\u67e5\u8be2\u4e00\u822c\u653e\u5728\u5c0f\u62ec\u53f7\u4e2d</li> <li>\u5b50\u67e5\u8be2\u7684\u6267\u884c\u4f18\u5148\u4e8e\u4e3b\u67e5\u8be2</li> <li>\u5355\u884c\u5b50\u67e5\u8be2\u642d\u914d\u5355\u884c\u64cd\u4f5c\u7b26\uff1a<code>&gt; &lt; &gt;= &lt;= = &lt;&gt;</code></li> <li>\u591a\u884c\u5b50\u67e5\u8be2\u642d\u914d\u591a\u884c\u64cd\u4f5c\u7b26\uff1a<code>any/some  all in</code></li> </ol>"},{"location":"databases/MySQL/SQL/#41-wherehaving","title":"4.1 where\u6216HAVING\u540e\u9762","text":""},{"location":"databases/MySQL/SQL/#411","title":"4.1.1 \u6807\u91cf\u5b50\u67e5\u8be2\uff08\u5355\u884c\u5b50\u67e5\u8be2\uff09","text":"<p>\u4f8b1\uff1a\u8c01\u7684\u5de5\u8d44\u6bd4 Abel \u9ad8</p> <pre><code>SELECT last_name,salary\nFROM employees\nWHERE salary&gt;(\n    SELECT salary\n    FROM employees\n    WHERE last_name  = 'Abel'\n\n);\n</code></pre> <p>\u4f8b2\uff1a\u8fd4\u56dejob_id\u4e0e141\u53f7\u5458\u5de5\u76f8\u540c\uff0csalary\u6bd4143\u5458\u5de5\u591a\u7684\u5458\u5de5\uff0c\u59d3\u540d\uff0cjob_id\uff0c\u5de5\u8d44 </p> <p>\u2460\u67e5\u8be2141\u53f7\u5458\u5de5\u7684job_id</p> <pre><code>SELECT job_id\nFROM employees\nWHERE employee_id = 141;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+----------+\n| job_id   |\n+----------+\n| ST_CLERK |\n+----------+\n</code></pre> <p>\u2461\u67e5\u8be2143\u53f7\u5458\u5de5\u7684salary</p> <pre><code>SELECT salary\nFROM employees\nWHERE employee_id = 143;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+---------+\n| salary  |\n+---------+\n| 2600.00 |\n+---------+\n</code></pre> <p>\u2462\u67e5\u8be2job_id=\u2460 and salary&gt;\u2461\u7684\u4fe1\u606f</p> <pre><code>SELECT last_name,job_id,salary\nFROM employees\nWHERE job_id = (\n    SELECT job_id\n    FROM employees\n    WHERE employee_id = 141\n) AND salary&gt;(\n\n    SELECT salary\n    FROM employees\n    WHERE employee_id = 143\n);\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+-------------+----------+---------+\n| last_name   | job_id   | salary  |\n+-------------+----------+---------+\n| Nayer       | ST_CLERK | 3200.00 |\n| Mikkilineni | ST_CLERK | 2700.00 |\n| Bissot      | ST_CLERK | 3300.00 |\n| Atkinson    | ST_CLERK | 2800.00 |\n| Mallin      | ST_CLERK | 3300.00 |\n| Rogers      | ST_CLERK | 2900.00 |\n| Ladwig      | ST_CLERK | 3600.00 |\n| Stiles      | ST_CLERK | 3200.00 |\n| Seo         | ST_CLERK | 2700.00 |\n| Rajs        | ST_CLERK | 3500.00 |\n| Davies      | ST_CLERK | 3100.00 |\n+-------------+----------+---------+\n</code></pre> <p>\u4f8b3\uff1a\u8fd4\u56de\u516c\u53f8\u5de5\u8d44\u6700\u5c11\u7684\u5458\u5de5\u7684last_name,job_id\u548csalary</p> <pre><code>SELECT last_name,job_id,salary\nFROM employees\nWHERE salary=(\n    SELECT MIN(salary)\n    FROM employees\n);\n</code></pre> <p>\u4f8b4\uff1a\u67e5\u8be2\u6700\u4f4e\u5de5\u8d44\u5927\u4e8e50\u53f7\u90e8\u95e8\u6700\u4f4e\u5de5\u8d44\u7684\u90e8\u95e8id\u548c\u5176\u6700\u4f4e\u5de5\u8d44</p> <pre><code>SELECT MIN(salary),department_id\nFROM employees\nGROUP BY department_id\nHAVING MIN(salary)&gt;(\n\n    SELECT MIN(salary)\n    FROM employees\n    WHERE department_id = 50\n);\n</code></pre>"},{"location":"databases/MySQL/SQL/#412","title":"4.1.2 \u5217\u5b50\u67e5\u8be2\uff08\u591a\u884c\u5b50\u67e5\u8be2\uff09","text":"<p>\u591a\u884c\u6bd4\u8f83\u64cd\u4f5c\u7b26\uff1a </p> <ol> <li> <p><code>IN</code>/<code>NOT IN</code>\uff1a\u7b49\u4e8e\u5217\u8868\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a</p> </li> <li> <p><code>ANY</code>|<code>SOME</code>\uff1a\u548c\u5b50\u67e5\u8be2\u8fd4\u56de\u7684\u67d0\u4e00\u4e2a\u503c\u6bd4\u8f83\uff0c\u7528\u7684\u8f83\u5c11</p> </li> <li> <p><code>ALL</code>\uff1a\u548c\u5b50\u67e5\u8be2\u8fd4\u56de\u7684\u6240\u6709\u503c\u6bd4\u8f83</p> </li> </ol> <p>\u5176\u4e2dIN\u548cNOT IN\u7528\u7684\u6bd4\u8f83\u591a\uff0c\u5176\u4ed6\u4e24\u4e2a\u7528\u7684\u6bd4\u8f83\u5c11\uff0c\u56e0\u4e3a\u5176\u53ef\u8bfb\u6027\u8f83\u5dee\uff0c\u53ef\u4ee5\u7528\u5176\u4ed6\u65b9\u5f0f\u6765\u66ff\u4ee3\u3002\u6bd4\u5982\u4ee5\u4e0b\uff1a</p> <pre><code># 1. any/some:\u5224\u65ad\u67d0\u5b57\u6bb5\u7684\u503c\u662f\u5426\u6ee1\u8db3\u5176\u4e2d\u4efb\u610f\u4e00\u4e2a\nx&gt;any(10,30,50) \u53ef\u4ee5\u7528 x&gt;min(10,30,50) \u66ff\u4ee3\nx=any(10,30,50) \u53ef\u4ee5\u7528 x in(10,30,50) \u66ff\u4ee3\n\n# 2. all:\u5224\u65ad\u67d0\u5b57\u6bb5\u7684\u503c\u662f\u5426\u6ee1\u8db3\u91cc\u9762\u6240\u6709\u7684\nx &gt;all(10,30,50) \u53ef\u4ee5\u7528 x &gt;max(10,30,50) \u66ff\u4ee3\n</code></pre> <p>\u4f8b1\uff1a\u8fd4\u56delocation_id\u662f1400\u62161700\u7684\u90e8\u95e8\u4e2d\u7684\u6240\u6709\u5458\u5de5\u59d3\u540d</p> <pre><code>SELECT last_name\nFROM employees\nWHERE department_id IN(\n    SELECT DISTINCT department_id\n    FROM departments\n    WHERE location_id IN(1400,1700)\n);\n</code></pre> <p>\u4f8b2\uff1a\u8fd4\u56de\u5176\u4ed6\u5de5\u79cd\u4e2d\u6bd4job_id\u4e3a\u2018IT_PROG\u2019\u5de5\u79cd\u4efb\u4e00\u5de5\u8d44\u4f4e\u7684\u5458\u5de5\u7684\u5458\u5de5\u53f7\u3001\u59d3\u540d\u3001job_id\u4ee5\u53casalary </p> <pre><code>SELECT employee_id,last_name,job_id,salary\nFROM employees\nWHERE salary&lt;ANY(\n    SELECT DISTINCT salary\n    FROM employees\n    WHERE job_id = 'IT_PROG'\n);\n# \u7528max\u4ee3\u66ffany\nSELECT employee_id,last_name,job_id,salary\nFROM employees\nWHERE salary&lt;(\n    SELECT MAX(salary)\n    FROM employees\n    WHERE job_id = 'IT_PROG'\n);\n</code></pre> <p>\u4f8b3\uff1a\u8fd4\u56de\u5176\u4ed6\u5de5\u79cd\u4e2d\u6bd4job_id\u4e3a\u2018IT_PROG\u2019\u5de5\u79cd\u6240\u6709\u5de5\u8d44\u90fd\u4f4e\u7684\u5458\u5de5\u7684\u5458\u5de5\u53f7\u3001\u59d3\u540d\u3001job_id\u4ee5\u53casalary </p> <pre><code>SELECT employee_id,last_name,job_id,salary\nFROM employees\nWHERE salary&lt;ALL(\n    SELECT DISTINCT salary\n    FROM employees\n    WHERE job_id = 'IT_PROG'\n);\n# \u7528min\u4ee3\u66ffall\nSELECT employee_id,last_name,job_id,salary\nFROM employees\nWHERE salary&lt;(\n    SELECT MIN(salary)\n    FROM employees\n    WHERE job_id = 'IT_PROG'\n);\n</code></pre>"},{"location":"databases/MySQL/SQL/#413","title":"4.1.3 \u884c\u5b50\u67e5\u8be2\uff08\u4e00\u884c\u591a\u7d2f\u6216\u591a\u884c\u591a\u5217\uff09","text":"<p>\u4f8b1\uff1a\u67e5\u8be2\u5458\u5de5\u7f16\u53f7\u6700\u5c0f\u5e76\u4e14\u5de5\u8d44\u6700\u9ad8\u7684\u5458\u5de5\u4fe1\u606f </p> <pre><code>SELECT \n  * \nFROM\n  employees \nWHERE (employee_id, salary) = (\n    SELECT MIN(employee_id),MAX(salary) \n    FROM employees\n) ;\n</code></pre> <p>\u7528\u7684\u60c5\u51b5\u8f83\u5c11</p>"},{"location":"databases/MySQL/SQL/#42-select","title":"4.2 select\u540e\u9762","text":"<p>\u4f8b1\uff1a\u67e5\u8be2\u6bcf\u4e2a\u90e8\u95e8\u7684\u5458\u5de5\u4e2a\u6570 </p> <pre><code>SELECT d.*,\n  (SELECT COUNT(*) \n  FROM  employees e \n  WHERE e.department_id = d.department_Id) \u4e2a\u6570 \nFROM\n  departments d ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#43-from","title":"4.3 from\u540e\u9762","text":"<p>\u4f8b\uff1a\u67e5\u8be2\u6bcf\u4e2a\u90e8\u95e8\u7684\u5e73\u5747\u5de5\u8d44\u7684\u5de5\u8d44\u7ea7\u522b</p> <pre><code>SELECT \n  ag_dep.*,\n  g.`grade_level` \nFROM\n  (SELECT \n    AVG(salary) ag,\n    department_id \n  FROM\n    employees \n  GROUP BY department_id) ag_dep \n  INNER JOIN job_grades g \n    ON ag_dep.ag BETWEEN g.`lowest_sal` \n    AND g.`highest_sal` ;\n</code></pre> <p>\u5c06\u5b50\u67e5\u8be2\u7ed3\u679c\u5145\u5f53\u4e00\u5f20\u8868\uff0c\u8981\u6c42\u5fc5\u987b\u8d77\u522b\u540d </p>"},{"location":"databases/MySQL/SQL/#44-exists","title":"4.4 exists\u540e\u9762","text":"<p>\u8bed\u6cd5\uff1a<code>exists\uff08\u5b8c\u6574\u7684\u67e5\u8be2\u8bed\u53e5\uff09</code>\uff0c\u67e5\u8be2\u6709\u7ed3\u679c\u8fd4\u56de1\uff0c\u5426\u5219\u8fd4\u56de0</p> <p>\u4f8b1\uff1a\u67e5\u8be2\u6709\u5458\u5de5\u7684\u90e8\u95e8\u540d </p> <pre><code>SELECT \n  department_name \nFROM\n  departments d \nWHERE EXISTS \n  (SELECT \n    * \n  FROM\n    employees e \n  WHERE d.`department_id` = e.`department_id`) ;\n# \u7528in\u66f4\u7b80\u5355\nSELECT \n  department_name \nFROM\n  departments d \nWHERE d.`department_id` IN \n  (SELECT \n    department_id \n  FROM\n    employees e) ;\n</code></pre> <p>\u53ef\u4ee5\u7528\u5176\u4ed6\u65b9\u5f0f\u4ee3\u66ff\uff0c\u7528\u7684\u8f83\u5c11</p>"},{"location":"databases/MySQL/SQL/#5","title":"5. \u5206\u9875\u67e5\u8be2","text":"<p>\u5e94\u7528\u573a\u666f\uff1a\u5f53\u8981\u663e\u793a\u7684\u6570\u636e\uff0c\u4e00\u9875\u663e\u793a\u4e0d\u5168\uff0c\u9700\u8981\u5206\u9875\u63d0\u4ea4sql\u8bf7\u6c42 </p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>select \u67e5\u8be2\u5217\u8868\nfrom \u8868\n[join type] join \u88682\non \u8fde\u63a5\u6761\u4ef6\nwhere \u7b5b\u9009\u6761\u4ef6\ngroup by \u5206\u7ec4\u5b57\u6bb5\nhaving \u5206\u7ec4\u540e\u7684\u7b5b\u9009\norder by \u6392\u5e8f\u7684\u5b57\u6bb5\u3011\nlimit [offset\uff0c] size\uff1b\n# offset\uff1a\u8981\u663e\u793a\u6761\u76ee\u7684\u8d77\u59cb\u7d22\u5f15\uff08\u4e0d\u5199\u4ece0\u5f00\u59cb\uff09\n# size\uff1a\u8981\u663e\u793a\u7684\u6761\u76ee\u4e2a\u6570\n</code></pre> <p>\u516c\u5f0f\uff1a</p> <pre><code>select \u67e5\u8be2\u5217\u8868\nfrom \u8868\nlimit (page - 1)* size\uff0c size\uff1b\n# \u8981\u663e\u793a\u7684\u9875\u6570page\uff0c\u6bcf\u9875\u7684\u6761\u76ee\u6570size\n</code></pre> <p>\u4f8b1\uff1a\u67e5\u8be2\u524d5\u6761\u5458\u5de5\u4fe1\u606f </p> <pre><code>SELECT * FROM employees LIMIT 0, 5;\n\u6216\u8005\nSELECT * FROM employees LIMIT 5;\n</code></pre> <p>\u4f8b2\uff1a\u67e5\u8be2\u7b2c11\u6761-\u7b2c25\u6761</p> <pre><code>SELECT * FROM employees LIMIT 10, 15;\n</code></pre>"},{"location":"databases/MySQL/SQL/#6","title":"6. \u8054\u5408\u67e5\u8be2","text":"<p><code>union</code>\uff1a\u5c06\u591a\u6761\u67e5\u8be2\u8bed\u53e5\u7684\u7ed3\u679c\u5408\u5e76\u6210\u4e00\u4e2a\u7ed3\u679c </p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>\u67e5\u8be2\u8bed\u53e51\nunion [ALL]\n\u67e5\u8be2\u8bed\u53e52\n</code></pre> <p>\u5e94\u7528\u573a\u666f\uff1a\u8981\u67e5\u8be2\u7684\u7ed3\u679c\u6765\u81ea\u4e8e\u591a\u4e2a\u8868\uff0c\u4e14\u591a\u4e2a\u8868\u6ca1\u6709\u76f4\u63a5\u7684\u8fde\u63a5\u5173\u7cfb\uff0c\u4f46\u67e5\u8be2\u7684\u4fe1\u606f\u4e00\u81f4 \u3002</p> <p>\u7279\u70b9\uff1a</p> <ol> <li>\u8981\u6c42\u591a\u6761\u67e5\u8be2\u8bed\u53e5\u7684\u67e5\u8be2\u5217\u6570\u662f\u4e00\u81f4\u7684</li> <li>\u8981\u6c42\u591a\u6761\u67e5\u8be2\u8bed\u53e5\u7684\u67e5\u8be2\u7684\u6bcf\u4e00\u5217\u7684\u7c7b\u578b\u548c\u987a\u5e8f\u6700\u597d\u662f\u4e00\u81f4\u7684</li> <li>union\u5173\u952e\u5b57\u9ed8\u8ba4\u53bb\u91cd\uff0c\u5982\u679c\u4f7f\u7528union all\u53ef\u4ee5\u5305\u542b\u91cd\u590d\u9879</li> </ol> <p>\u4f8b\uff1a\u67e5\u8be2\u90e8\u95e8\u7f16\u53f7&gt;90\u6216\u90ae\u7bb1\u5305\u542ba\u7684\u5458\u5de5\u4fe1\u606f </p> <pre><code>SELECT \n  * \nFROM\n  employees \nWHERE email LIKE \"%a%\" \nUNION\nSELECT \n  * \nFROM\n  employees \nWHERE department_id &gt; 90;\n</code></pre>"},{"location":"databases/MySQL/SQL/#7","title":"7. \u522b\u540d","text":"<p>\u4f5c\u7528\uff1a</p> <ol> <li>\u63d0\u9ad8\u8bed\u53e5\u7684\u7b80\u6d01\u5ea6 </li> <li>\u533a\u5206\u591a\u4e2a\u91cd\u540d\u7684\u5b57\u6bb5 </li> <li>\u5982\u679c\u4e3a\u8868\u8d77\u4e86\u522b\u540d\uff0c\u5219\u67e5\u8be2 \u7684\u5b57\u6bb5\u5c31\u4e0d\u80fd\u4f7f\u7528\u539f\u59cb\u7684\u8868\u660e\u53bb\u9650\u5b9a </li> </ol>"},{"location":"databases/MySQL/SQL/#71","title":"7.1 \u5b57\u6bb5\u522b\u540d","text":"<pre><code>SELECT\ncity.name AS \u57ce\u5e02,\ncountry.name AS \u56fd\u5bb6,\ncountry.SurfaceArea  AS \u9762\u79ef,\ncity.Population AS \u57ce\u5e02\u4eba\u53e3\nFROM city JOIN country\nON city.CountryCode=country.Code\nWHERE  city.name='shenyang';\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+----------+--------+------------+--------------+\n| \u57ce\u5e02     | \u56fd\u5bb6   | \u9762\u79ef       | \u57ce\u5e02\u4eba\u53e3     |\n+----------+--------+------------+--------------+\n| Shenyang | China  | 9572900.00 |      4265200 |\n+----------+--------+------------+--------------+\n1 row in set (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL/#72","title":"7.2 \u8868\u522b\u540d","text":"<pre><code>SELECT\na.name AS \u57ce\u5e02,\nb.name AS \u56fd\u5bb6,\nb.SurfaceArea  AS \u9762\u79ef,\na.Population AS \u57ce\u5e02\u4eba\u53e3\nFROM city AS a JOIN country AS b\nON a.CountryCode=b.Code\nWHERE a.name='shenyang';\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c <pre><code>+----------+--------+------------+--------------+\n| \u57ce\u5e02     | \u56fd\u5bb6   | \u9762\u79ef       | \u57ce\u5e02\u4eba\u53e3     |\n+----------+--------+------------+--------------+\n| Shenyang | China  | 9572900.00 |      4265200 |\n+----------+--------+------------+--------------+\n1 row in set (0.01 sec)\n</code></pre></p> <p>AS \u53ef\u4ee5\u7701\u7565</p> <p>\u5982\u679c\u522b\u540d\u6709\u7279\u6b8a\u7b26\u53f7\u8981\u52a0\u53cc\u5f15\u53f7</p>"},{"location":"databases/MySQL/SQL/#tcl","title":"\u56db\u3001TCL","text":""},{"location":"databases/MySQL/SQL/#1_8","title":"1. \u4e8b\u52a1","text":""},{"location":"databases/MySQL/SQL/#11_4","title":"1.1 \u4e8b\u52a1\u7684\u542b\u4e49","text":"<p>\u4e00\u4e2a\u6216\u4e00\u7ec4sql\u8bed\u53e5\u7ec4\u6210\u4e00\u4e2a\u6267\u884c\u5355\u5143\uff0c\u8fd9\u4e2a\u6267\u884c\u5355\u5143\u8981\u4e48\u5168\u90e8\u6267\u884c\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u6267\u884c\u3002</p>"},{"location":"databases/MySQL/SQL/#12-acid","title":"1.2  \u4e8b\u52a1\u7684ACID\u5c5e\u6027","text":"<ol> <li>\u539f\u5b50\u6027\uff08Atomicity\uff09\uff1a\u539f\u5b50\u6027\u662f\u6307\u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u4f4d\uff0c\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u90fd\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f\u3002</li> <li>\u4e00\u81f4\u6027\uff08Consistency\uff09\uff1a\u4e8b\u52a1\u5fc5\u987b\u4f7f\u6570\u636e\u5e93\u4ece\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u53d8\u6362\u5230\u53e6\u5916\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u3002</li> <li>\u9694\u79bb\u6027\uff08Isolation\uff09\uff1a\u4e8b\u52a1\u7684\u9694\u79bb\u6027\u662f\u6307\u4e00\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\u4e0d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u5e72\u6270\uff0c\u5373\u4e00\u4e2a\u4e8b\u52a1\u5185\u90e8\u7684\u64cd\u4f5c\u53ca\u4f7f\u7528\u7684\u6570\u636e\u5bf9\u5e76\u53d1\u7684\u5176\u4ed6\u4e8b\u52a1\u662f\u9694\u79bb\u7684\uff0c\u5e76\u53d1\u6267\u884c\u7684\u5404\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u4e0d\u80fd\u4e92\u76f8\u5e72\u6270\u3002</li> <li>\u6301\u4e45\u6027\uff08Durability\uff09\uff1a\u6301\u4e45\u6027\u662f\u6307\u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u5b83\u5bf9\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u6539\u53d8\u5c31\u662f\u6c38\u4e45\u6027\u7684\uff0c\u63a5\u4e0b\u6765\u7684\u5176\u4ed6\u64cd\u4f5c\u548c\u6570\u636e\u5e93\u6545\u969c\u4e0d\u5e94\u8be5\u5bf9\u5176\u6709\u4efb\u4f55\u5f71\u54cd\u3002</li> </ol>"},{"location":"databases/MySQL/SQL/#12_4","title":"1.2 \u4e8b\u52a1\u7684\u5206\u7c7b","text":"<ol> <li>\u9690\u5f0f\u4e8b\u52a1\uff1a\u4e8b\u52a1\u6ca1\u6709\u660e\u663e\u7684\u5f00\u542f\u548c\u7ed3\u675f\u7684\u6807\u8bb0\u3002\u6bd4\u5982insert\u3001update\u3001delete\u8bed\u53e5</li> <li>\u663e\u5f0f\u4e8b\u52a1\uff1a\u4e8b\u52a1\u5177\u6709\u660e\u663e\u7684\u5f00\u542f\u548c\u7ed3\u675f\u7684\u6807\u8bb0</li> </ol>"},{"location":"databases/MySQL/SQL/#13_3","title":"1.3 \u4e8b\u52a1\u7684\u521b\u5efa","text":""},{"location":"databases/MySQL/SQL/#131","title":"1.3.1  \u5f00\u542f\u4e8b\u52a1","text":"<pre><code>SET autocommit=0; # \u5148\u8bbe\u7f6e\u81ea\u52a8\u63d0\u4ea4\u529f\u80fd\u4e3a\u7981\u7528 \nSTART TRANSACTION;\uff08\u53ef\u9009\uff09\n</code></pre>"},{"location":"databases/MySQL/SQL/#132-sql","title":"1.3.2  \u7f16\u5199\u4e8b\u52a1\u4e2d\u7684sql\u8bed\u53e5","text":"<p>\u5305\u62ec<code>select</code>\uff0c<code>insert</code>\uff0c<code>update</code>\uff0c<code>delete</code>\uff08\u53ea\u6709\u589e\u5220\u6539\u67e5\uff0c\u4e0d\u5305\u62ecDDL\u8bed\u8a00\uff09</p>"},{"location":"databases/MySQL/SQL/#133","title":"1.3.3 \u7ed3\u675f\u4e8b\u52a1","text":"<p>\u6709\u4e24\u79cd\u7ed3\u675f\u4e8b\u52a1\u7684\u65b9\u5f0f</p> <ol> <li><code>commit</code>\uff1b\u63d0\u4ea4\u4e8b\u52a1</li> <li><code>rollback</code>\uff1b\u56de\u6eda\u4e8b\u52a1</li> </ol>"},{"location":"databases/MySQL/SQL/#14_1","title":"1.4  \u8bbe\u7f6e\u4fdd\u5b58\u70b9","text":"<p><code>savepoint \u7ed3\u70b9\u540d</code></p> <pre><code>\n</code></pre>"},{"location":"databases/MySQL/SQL/#2_6","title":"2. \u6570\u636e\u5e93\u7684\u9694\u79bb\u7ea7\u522b","text":""},{"location":"databases/MySQL/SQL/#21_4","title":"2.1 \u6ca1\u6709\u9694\u79bb\u5e26\u6765\u7684\u95ee\u9898","text":"<p>\u5bf9\u4e8e\u540c\u65f6\u8fd0\u884c\u7684\u591a\u4e2a\u4e8b\u52a1\uff0c\u5f53\u8fd9\u4e9b\u4e8b\u52a1\u8bbf\u95ee\u6570\u636e\u5e93\u4e2d\u76f8\u540c\u7684\u6570\u636e\u65f6\uff0c\u5982\u679c\u6ca1\u6709\u91c7\u53d6\u5fc5\u8981\u7684\u9694\u79bb\u673a\u5236\uff0c\u5c31\u4f1a\u5bfc\u81f4\u5404\u79cd\u5e76\u53d1\u95ee\u9898\uff1a </p> <ol> <li>\u810f\u8bfb\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u4e8b\u52a1T1\uff0cT2\u3002T1\u8bfb\u53d6\u4e86\u5df2\u7ecf\u88abT2\u66f4\u65b0\u4f46\u8fd8\u6ca1\u6709\u88ab\u63d0\u4ea4\u7684\u5b57\u6bb5\u4e4b\u540e\uff0c\u82e5T2\u56de\u6eda\uff0cT1\u8bfb\u53d6\u7684\u5185\u5bb9\u5c31\u662f\u4e34\u65f6\u4e14\u65e0\u6548\u7684\u3002\u4e3b\u8981\u662f\u5176\u4ed6\u4e8b\u52a1\u66f4\u65b0\u7684\u6570\u636e</li> <li>\u4e0d\u53ef\u91cd\u590d\u8bfb\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u4e8b\u52a1T1\uff0cT2\u3002T1\u8bfb\u53d6\u4e86\u4e00\u4e2a\u5b57\u6bb5\uff0c\u7136\u540eT2\u66f4\u65b0\u4e86\u8be5\u5b57\u6bb5\u4e4b\u540e\uff0cT1\u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u4e2a\u5b57\u6bb5\uff0c\u503c\u5c31\u4e0d\u540c\u4e86\u3002</li> <li>\u5e7b\u8bfb\uff1a\u5bf9\u4e8e\u4e24\u4e2a\u4e8b\u52a1T1\uff0cT2\u3002T1\u4ece\u4e00\u4e2a\u8868\u4e2d\u8bfb\u53d6\u4e86\u4e00\u4e2a\u5b57\u6bb5\uff0c\u7136\u540eT2\u5728\u8be5\u8868\u4e2d\u63d2\u5165\u4e86\u4e00\u4e9b\u65b0\u7684\u884c\u4e4b\u540e\uff0c\u5982\u679cT1\u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u4e2a\u8868\uff0c\u5c31\u4f1a\u591a\u51fa\u51e0\u884c\u3002\u4e3b\u8981\u662f\u5176\u4ed6\u4e8b\u52a1\u63d2\u5165\u7684\u6570\u636e</li> </ol> <p>\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u9694\u79bb\u6027\uff1a\u6570\u636e\u5e93\u7cfb\u7edf\u5fc5\u987b\u5177\u6709\u9694\u79bb\u5e76\u53d1\u8fd0\u884c\u5404\u4e2a\u4e8b\u52a1\u7684\u80fd\u529b\uff0c\u4f7f\u4ed6\u4eec\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd\uff0c\u907f\u514d\u5404\u79cd\u5e76\u53d1\u95ee\u9898\u3002</p>"},{"location":"databases/MySQL/SQL/#22_3","title":"2.2 \u9694\u79bb\u7ea7\u522b","text":"<p>\u4e00\u4e2a\u4e8b\u52a1\u4e0e\u5176\u4ed6\u4e8b\u52a1\u9694\u79bb\u7684\u7a0b\u5ea6\u79f0\u4e3a\u9694\u79bb\u7ea7\u522b\u3002\u6570\u636e\u5e93\u89c4\u5b9a\u4e86\u591a\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u4e0d\u540c\u9694\u79bb\u7ea7\u522b\u5bf9\u5e94\u4e0d\u540c\u7684\u5e72\u6270\u7a0b\u5ea6\uff0c\u9694\u79bb\u7ea7\u522b\u8d8a\u9ad8\uff0c\u6570\u636e\u4e00\u81f4\u6027\u5c31\u8d8a\u597d\uff0c\u4f46\u5e76\u53d1\u6027\u5f31\u3002</p> <p>\u6570\u636e\u5e93\u63d0\u4f9b\u76844\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff1a</p> \u9694\u79bb\u7ea7\u522b \u63cf\u8ff0 READ UNCOMMITTED(\u8bfb\u672a\u63d0\u4ea4\u6570\u636e) \u5141\u8bb8\u4e8b\u52a1\u8bfb\u53d6\u672a\u88ab\u5176\u4ed6\u4e8b\u52a1\u63d0\u4ea4\u7684\u53d8\u66f4\u3002\u810f\u8bfb\uff0c\u4e0d\u53ef\u91cd\u590d\u8bfb\u548c\u5e7b\u8bfb\u7684\u95ee\u9898\u90fd\u4f1a\u51fa\u73b0\u3002 READ COMMITED(\u8bfb\u5df2\u63d0\u4ea4\u6570\u636e) \u53ea\u5141\u8bb8\u4e8b\u52a1\u8bfb\u53d6\u5df2\u7ecf\u88ab\u5176\u4ed6\u4e8b\u52a1\u63d0\u4ea4\u7684\u53d8\u66f4\u3002\u53ef\u4ee5\u907f\u514d\u810f\u8bfb\uff0c\u4f46\u4e0d\u53ef\u91cd\u590d\u8bfb\u548c\u5e7b\u8bfb\u95ee\u9898\u4ecd\u7136\u53ef\u80fd\u51fa\u73b0\u3002 REPEATABLE READ(\u53ef\u91cd\u590d\u8bfb) \u786e\u4fdd\u4e8b\u52a1\u53ef\u4ee5\u591a\u6b21\u4ece\u4e00\u4e2a\u5b57\u6bb5\u4e2d\u8bfb\u53d6\u76f8\u540c\u7684\u503c\u3002\u5728\u8fd9\u4e2a\u4e8b\u52a1\u6301\u7eed\u671f\u95f4\uff0c\u7981\u6b62\u5176\u4ed6\u4e8b\u52a1\u5bf9\u8fd9\u4e2a\u5b57\u6bb5\u8fdb\u884c\u66f4\u65b0\u3002\u53ef\u4ee5\u907f\u514d\u810f\u8bfb\u548c\u4e0d\u53ef\u91cd\u590d\u8bfb\uff0c\u4f46\u5e7b\u8bfb\u7684\u95ee\u9898\u4ecd\u7136\u5b58\u5728\u3002 SERIALLIZABLE(\u4e32\u884c\u5316) \u786e\u4fdd\u4e8b\u52a1\u53ef\u4ee5\u4ece\u4e00\u4e2a\u8868\u4e2d\u8bfb\u53d6\u76f8\u540c\u7684\u884c\uff0c\u5728\u8fd9\u4e2a\u4e8b\u52a1\u6301\u7eed\u671f\u95f4\uff0c\u7981\u6b62\u5176\u4ed6\u4e8b\u52a1\u5bf9\u8be5\u8868\u6267\u884c\u63d2\u5165\uff0c\u66f4\u65b0\u548c\u5220\u9664\u64cd\u4f5c\u3002\u6240\u6709\u5e76\u53d1\u95ee\u9898\u90fd\u53ef\u4ee5\u907f\u514d\uff0c\u4f46\u6027\u80fd\u5341\u5206\u4f4e\u4e0b\u3002 <p>Oracle\u652f\u63012\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff1aREAD COMMITED\uff0cSERIALIZABLE\u3002Oracle\u9ed8\u8ba4\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u662f\uff1aREAD COMMITED\u3002</p> <p>Mysql\u652f\u63014\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u3002Mysql\u9ed8\u8ba4\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3a\uff1aREPEATABLE READ\u3002</p> <p>\u6bcf\u542f\u52a8\u4e00\u4e2amysql\u7a0b\u5e8f\uff0c\u5c31\u4f1a\u83b7\u5f97\u4e00\u4e2a\u5355\u72ec\u7684\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u90fd\u6709\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf<code>@@tx_isolation</code>\uff0c\u8868\u793a\u5f53\u524d\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u3002</p> <p>\u67e5\u770b\u5f53\u524d\u7684\u9694\u79bb\u7ea7\u522b\uff1a<code>select @@tx_isolation;</code></p> <p>\u8bbe\u7f6e\u5f53\u524dmysql\u8fde\u63a5\u7684\u9694\u79bb\u7ea7\u522b\uff1a<code>set transaction isolation level read committed;</code></p> <p>\u8bbe\u7f6e\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u5168\u5c40\u7684\u9694\u79bb\u7ea7\u522b\uff1a<code>set global transaction isolation level read committed;</code></p>"},{"location":"databases/MySQL/SQL/#_1","title":"\u4e94\u3001\u5e38\u89c1\u7ea6\u675f","text":"<p>\u542b\u4e49\uff1a\u4e00\u79cd\u9650\u5236\uff0c\u7528\u4e8e\u9650\u5236\u8868\u4e2d\u7684\u6570\u636e\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u8868\u4e2d\u7684\u6570\u636e\u7684\u51c6\u786e\u548c\u53ef\u9760\u6027</p>"},{"location":"databases/MySQL/SQL/#1_9","title":"1. \u5206\u7c7b","text":""},{"location":"databases/MySQL/SQL/#11_5","title":"1.1  \u6309\u4f5c\u7528\u5206\u7c7b","text":"<ol> <li>not null\uff1a\u975e\u7a7a\uff0c\u7528\u4e8e\u4fdd\u8bc1\u8be5\u5b57\u6bb5\u7684\u503c\u4e0d\u80fd\u4e3a\u7a7a\u3002\u6bd4\u5982\u59d3\u540d\u3001\u5b66\u53f7\u7b49\u3002</li> <li>default\uff1a\u9ed8\u8ba4\uff0c\u7528\u4e8e\u4fdd\u8bc1\u8be5\u5b57\u6bb5\u6709\u9ed8\u8ba4\u503c\u3002\u6bd4\u5982\u6027\u522b\u3002</li> <li>primary key\uff1a\u4e3b\u952e\uff0c\u7528\u4e8e\u4fdd\u8bc1\u8be5\u5b57\u6bb5\u7684\u503c\u5177\u6709\u552f\u4e00\u6027\uff0c\u5e76\u4e14\u975e\u7a7a\u3002\u6bd4\u5982\u5b66\u53f7\u3001\u5458\u5de5\u7f16\u53f7\u7b49\u3002</li> <li>unique\uff1a\u552f\u4e00\uff0c\u7528\u4e8e\u4fdd\u8bc1\u8be5\u5b57\u6bb5\u7684\u503c\u5177\u6709\u552f\u4e00\u6027\uff0c\u53ef\u4ee5\u4e3a\u7a7a\u3002\u6bd4\u5982\u5ea7\u4f4d\u53f7\u3002</li> <li>check\uff1a\u68c0\u67e5\u7ea6\u675f\uff08mysql\u4e2d\u4e0d\u652f\u6301\uff09\u3002\u6bd4\u5982\u5e74\u9f84\u3001\u6027\u522b\u3002</li> <li>foreign key\uff1a\u5916\u952e\uff0c\u7528\u4e8e\u9650\u5236\u4e24\u4e2a\u8868\u7684\u5173\u7cfb\uff0c\u7528\u4e8e\u4fdd\u8bc1\u8be5\u5b57\u6bb5\u7684\u503c\u5fc5\u987b\u6765\u81ea\u4e8e\u4e3b\u8868\u7684\u5173\u8054\u5217\u7684\u503c\u3002\u5728\u4ece\u8868\u6dfb\u52a0\u5916\u952e\u7ea6\u675f\uff0c\u7528\u4e8e\u5e94\u7528\u4e3b\u8868\u4e2d\u67d0\u5217\u7684\u503c\u3002\u6bd4\u5982\u5b66\u751f\u8868\u7684\u4e13\u4e1a\u7f16\u53f7\uff0c\u5458\u5de5\u8868\u7684\u90e8\u95e8\u7f16\u53f7\uff0c\u5458\u5de5\u8868\u7684\u5de5\u79cd\u7f16\u53f7\u3002</li> </ol>"},{"location":"databases/MySQL/SQL/#12_5","title":"1.2 \u6309\u4f4d\u7f6e\u5206\u7c7b","text":"<ol> <li>\u5217\u7ea7\u7ea6\u675f\uff1a\u516d\u5927\u7ea6\u675f\u8bed\u6cd5\u4e0a\u90fd\u652f\u6301\uff0c\u4f46\u5916\u952e\u7ea6\u675f\u6ca1\u6709\u6548\u679c </li> <li>\u8868\u7ea7\u7ea6\u675f\uff1a\u9664\u4e86\u975e\u7a7a\u3001\u9ed8\u8ba4\uff0c\u5176\u4ed6\u7684\u90fd\u652f\u6301 </li> </ol> \u7ea6\u675f\u7c7b\u578b \u4f4d\u7f6e \u652f\u6301\u7684\u7ea6\u675f\u7c7b\u578b \u662f\u5426\u53ef\u4ee5\u8d77\u7ea6\u675f\u540d \u5217\u7ea7\u7ea6\u675f \u5217\u7684\u540e\u9762 \u8bed\u6cd5\u90fd\u652f\u6301\uff0c\u4f46\u5916\u952e\u6ca1\u6709\u6548\u679c \u4e0d\u53ef\u4ee5 \u8868\u7ea7\u7ea6\u675f \u6240\u6709\u5217\u7684\u4e0b\u9762 \u9ed8\u8ba4\u548c\u975e\u7a7a\u4e0d\u652f\u6301\uff0c\u5176\u4ed6\u90fd\u652f\u6301 \u53ef\u4ee5\uff08\u4e3b\u952e\u6ca1\u6709\u6548\u679c\uff0c\u9ed8\u8ba4\u540d\u5b57\u662fPRIMARY\uff09"},{"location":"databases/MySQL/SQL/#_2","title":"\u4e3b\u952e\u548c\u552f\u4e00\u7684\u533a\u522b","text":"\u7ea6\u675f \u4fdd\u8bc1\u552f\u4e00\u6027 \u662f\u5426\u5141\u8bb8\u4e3a\u7a7a \u4e00\u4e2a\u8868\u4e2d\u53ef\u4ee5\u6709\u591a\u5c11\u4e2a \u662f\u5426\u5141\u8bb8\u7ec4\u5408\uff08\u591a\u4e2a\u5217\u7ec4\u5408\u6210\u4e00\u4e2a\u4e3b\u952e/\u552f\u4e00\uff09 \u4e3b\u952e \u662f \u5426 \u81f3\u591a\u4e00\u4e2a \u53ef\u4ee5\uff0c\u4f46\u4e0d\u63a8\u8350 \u552f\u4e00 \u662f \u662f \u53ef\u4ee5\u6709\u591a\u4e2a \u53ef\u4ee5\uff0c\u4f46\u4e0d\u63a8\u8350"},{"location":"databases/MySQL/SQL/#_3","title":"\u5916\u952e\u7279\u70b9","text":"<ol> <li> <p>\u8981\u6c42\u5728\u4ece\u8868\u8bbe\u7f6e\u5916\u952e\u5173\u7cfb</p> </li> <li> <p>\u4ece\u8868\u7684\u5916\u952e\u5217\u7684\u7c7b\u578b\u548c\u4e3b\u8868\u7684\u5173\u8054\u5217\u7684\u7c7b\u578b\u8981\u6c42\u4e00\u81f4\u6216\u517c\u5bb9\uff0c\u540d\u79f0\u65e0\u8981\u6c42</p> </li> <li> <p>\u4e3b\u8868\u7684\u5173\u8054\u5217\u5fc5\u987b\u662f\u4e00\u4e2akey\uff08\u4e00\u822c\u662f\u4e3b\u952e\u6216\u552f\u4e00\uff09</p> </li> <li> <p>\u63d2\u5165\u6570\u636e\u65f6\uff0c\u5148\u63d2\u5165\u4e3b\u8868\uff0c\u518d\u63d2\u5165\u4ece\u8868</p> </li> <li> <p>\u5220\u9664\u6570\u636e\u65f6\uff0c\u5148\u5220\u9664\u4ece\u8868\uff0c\u518d\u5220\u9664\u4e3b\u8868</p> </li> </ol> <p>\u65b9\u5f0f\u4e00\uff1a\u7ea7\u8054\u5220\u9664</p> <pre><code>ALTER TABLE stuinfo ADD CONSTRAINT fk_stu_major FOREIGN KEY(majorid) REFERENCES major(id) ON DELETE CASCADE;\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a\u7ea7\u8054\u7f6e\u7a7a</p> <pre><code>ALTER TABLE stuinfo ADD CONSTRAINT fk_stu_major FOREIGN KEY(majorid) REFERENCES major(id) ON DELETE SET NULL;\n# \u5220\u9664\u7684\u65f6\u5019\uff0c\u4e3b\u8868\u5bf9\u5e94\u7684\u884c\u88ab\u5220\u9664\u4e86\uff0c\u4ece\u8868\u5f15\u5165\u7684\u5730\u65b9\u53d8\u4e3a\u7a7a\u503cnull\u3002\n</code></pre>"},{"location":"databases/MySQL/SQL/#2_7","title":"2. \u6dfb\u52a0\u7ea6\u675f","text":""},{"location":"databases/MySQL/SQL/#21_5","title":"2.1 \u521b\u5efa\u8868\u65f6\u6dfb\u52a0\u7ea6\u675f","text":""},{"location":"databases/MySQL/SQL/#211","title":"2.1.1 \u6dfb\u52a0\u5217\u7ea7\u7ea6\u675f","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>\u76f4\u63a5\u5728\u5b57\u6bb5\u540d\u548c\u7c7b\u578b\u540e\u9762\u8ffd\u52a0\u7ea6\u675f\u7c7b\u578b\u5373\u53ef\u3002\n\u53ea\u652f\u6301\uff1a\u9ed8\u8ba4\u3001\u975e\u7a7a\u3001\u4e3b\u952e\u3001\u552f\u4e00\uff08\u9664\u4e86\u5916\u952e\u90fd\u652f\u6301\uff09\n</code></pre> <pre><code>CREATE DATABASE students;\nUSE students;\n\nCREATE TABLE stuinfo (\n  id INT PRIMARY KEY,\n  stuname VARCHAR (20) NOT NULL,    # \u975e\u7a7a\n  gender CHAR(1) CHECK (gender = '\u7537' \n    OR gender = '\u5973'),  # CHECK\u5728mysql\u4e2d\u4e0d\u751f\u6548\n  seat INT UNIQUE,  # \u552f\u4e00\n  age INT DEFAULT 18,   # \u9ed8\u8ba4\n  majorID INT REFERENCES major (id) # \u8bed\u6cd5\u4e0d\u62a5\u9519\uff0c\u4f46\u662f\u6ca1\u6709\u6548\u679c\n) ;\n\nCREATE TABLE major (\n  id INT PRIMARY KEY,\n  majorName VARCHAR (20)\n) ;\n\nDESC stuinfo; # \u67e5\u770b\u8868\u7ed3\u6784\nSHOW INDEX FROM stuinfo;\n</code></pre>"},{"location":"databases/MySQL/SQL/#212","title":"2.1.2 \u6dfb\u52a0\u8868\u7ea7\u7ea6\u675f","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code># \u5728\u5404\u4e2a\u5b57\u6bb5\u7684\u6700\u4e0b\u9762\n[ CONSTRAINT  \u7ea6\u675f\u540d] \u7ea6\u675f\u7c7b\u578b (\u5b57\u6bb5\u540d)\n# \u9664\u4e86\u975e\u7a7a\u3001\u9ed8\u8ba4\uff0c\u5176\u4ed6\u7684\u90fd\u652f\u6301\n</code></pre> <pre><code>CREATE TABLE stuinfo(\nid INT,\nstuname VARCHAR(20),\ngender CHAR(1),\nseat INT,\nage INT,\nmajorid INT,\n\nCONSTRAINT pk PRIMARY KEY(id), # \u4e3b\u952e\u7684\u540d\u5b57\u662fPRIMARY\uff0c\u8d77\u522b\u540d\u6ca1\u6548\u679c\nCONSTRAINT uq UNIQUE(seat),\nCONSTRAINT ck CHECK(gender='\u7537' OR gender='\u5973'),\nCONSTRAINT fk_stuinfo_major FOREIGN KEY(majorid) REFERENCES major(id)\n);\n\nSHOW INDEX FROM stuinfo;\n</code></pre> <p>\u67e5\u8be2\u7ed3\u679c</p> <pre><code>+---------+------------+------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table   | Non_unique | Key_name         | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+---------+------------+------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| stuinfo |          0 | PRIMARY          |            1 | id          | A         |           0 |     NULL | NULL   |      | BTREE      |         |               |\n| stuinfo |          0 | uq               |            1 | seat        | A         |           0 |     NULL | NULL   | YES  | BTREE      |         |               |\n| stuinfo |          1 | fk_stuinfo_major |            1 | majorid     | A         |           0 |     NULL | NULL   | YES  | BTREE      |         |               |\n+---------+------------+------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n</code></pre>"},{"location":"databases/MySQL/SQL/#213","title":"2.1.3 \u901a\u7528\u5199\u6cd5","text":"<pre><code>CREATE TABLE IF NOT EXISTS stuinfo (\n  id INT PRIMARY KEY,\n  stuname VARCHAR (20) NOT NULL,\n  gender CHAR(1),\n  seat INT UNIQUE,\n  age INT DEFAULT 18,\n  majorID INT,\n  CONSTRAINT fk_stuinfo_major FOREIGN KEY (majorid) REFERENCES major (id)\n) ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#22_4","title":"2.2 \u4fee\u6539\u8868\u65f6\u6dfb\u52a0\u7ea6\u675f","text":""},{"location":"databases/MySQL/SQL/#221","title":"2.2.1  \u6dfb\u52a0\u975e\u7a7a\u7ea6\u675f","text":"<pre><code>ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20) NOT NULL;\n</code></pre>"},{"location":"databases/MySQL/SQL/#222","title":"2.2.2 \u6dfb\u52a0\u9ed8\u8ba4\u7ea6\u675f","text":"<pre><code>ALTER TABLE stuinfo MODIFY COLUMN age INT DEFAULT 18;\n</code></pre>"},{"location":"databases/MySQL/SQL/#223","title":"2.2.3 \u6dfb\u52a0\u4e3b\u952e\u7ea6\u675f","text":"<pre><code># \u5217\u7ea7\u7ea6\u675f\u7684\u5199\u6cd5\nALTER TABLE stuinfo MODIFY COLUMN id INT PRIMARY KEY;\n# \u8868\u7ea7\u7ea6\u675f\u7684\u5199\u6cd5\nALTER TABLE stuinfo ADD PRIMARY KEY(id);\n</code></pre> <p>2.2.4 \u6dfb\u52a0\u552f\u4e00\u7ea6\u675f</p> <pre><code># \u5217\u7ea7\u7ea6\u675f\u7684\u5199\u6cd5\nALTER TABLE stuinfo MODIFY COLUMN seat INT UNIQUE;\n# \u8868\u7ea7\u7ea6\u675f\u7684\u5199\u6cd5\nALTER TABLE stuinfo ADD UNIQUE(seat);\n</code></pre>"},{"location":"databases/MySQL/SQL/#225","title":"2.2.5 \u6dfb\u52a0\u5916\u952e\u7ea6\u675f","text":"<pre><code>ALTER TABLE (CONSTRAINT fk_stuinfo_major) stuinfo ADD FOREIGN KEY(majorid) REFERENCES major(id);\n</code></pre>"},{"location":"databases/MySQL/SQL/#3_8","title":"3. \u5220\u9664\u7ea6\u675f","text":""},{"location":"databases/MySQL/SQL/#31_1","title":"3.1 \u4fee\u6539\u8868\u65f6\u5220\u9664\u7ea6\u675f","text":""},{"location":"databases/MySQL/SQL/#311_1","title":"3.1.1 \u5220\u9664\u975e\u7a7a\u7ea6\u675f","text":"<pre><code>ALTER TABLE stuinfo MODIFY COLUMN stuname VARCHAR(20) NULL;\n</code></pre>"},{"location":"databases/MySQL/SQL/#312_2","title":"3.1.2 \u5220\u9664\u9ed8\u8ba4\u7ea6\u675f","text":"<pre><code>ALTER TABLE stuinfo MODIFY COLUMN age INT;\n</code></pre>"},{"location":"databases/MySQL/SQL/#313","title":"3.1.3 \u5220\u9664\u4e3b\u952e","text":"<pre><code>ALTER TABLE stuinfo DROP PRIMARY KEY;\n</code></pre>"},{"location":"databases/MySQL/SQL/#314","title":"3.1.4 \u5220\u9664\u552f\u4e00","text":"<pre><code>ALTER TABLE stuinfo DROP INDEX seat;\n</code></pre>"},{"location":"databases/MySQL/SQL/#315","title":"3.1.5 \u5220\u9664\u5916\u952e","text":"<pre><code>ALTER TABLE stuinfo DROP FOREIGN KEY fk_stuinfo_major;\n</code></pre>"},{"location":"databases/MySQL/SQL/#4_3","title":"4. \u6807\u8bc6\u5217","text":""},{"location":"databases/MySQL/SQL/#41_1","title":"4.1 \u542b\u4e49","text":"<p>\u53c8\u79f0\u4e3a\u81ea\u589e\u957f\u5217,\u53ef\u4ee5\u4e0d\u7528\u624b\u52a8\u7684\u63d2\u5165\u503c\uff0c\u7cfb\u7edf\u63d0\u4f9b\u9ed8\u8ba4\u7684\u5e8f\u5217\u503c</p>"},{"location":"databases/MySQL/SQL/#42_1","title":"4.2 \u7279\u70b9","text":"<ol> <li>\u6807\u8bc6\u5217\u5fc5\u987b\u548c\u4e3b\u952e\u642d\u914d\u5417\uff1f\u4e0d\u4e00\u5b9a\uff0c\u4f46\u8981\u6c42\u662f\u4e00\u4e2akey\u3002</li> <li>\u4e00\u4e2a\u8868\u53ef\u4ee5\u6709\u51e0\u4e2a\u6807\u8bc6\u5217\uff1f\u81f3\u591a\u4e00\u4e2a\u3002</li> <li>\u6807\u8bc6\u5217\u7684\u7c7b\u578b\uff1f\u53ea\u80fd\u662f\u6570\u503c\u578b\uff08int\uff08\u4e00\u822c\u662fint\uff09\uff0cfloat\uff0cdouble\uff09</li> <li>\u6807\u8bc6\u5217\u53ef\u4ee5\u901a\u8fc7<code>SET auto_increment_increment = 1;</code>\u8bbe\u7f6e\u6b65\u957f\uff1b\u53ef\u4ee5\u901a\u8fc7\u624b\u52a8\u63d2\u5165\u503c\u8bbe\u7f6e\u8d77\u59cb\u503c\u3002</li> </ol>"},{"location":"databases/MySQL/SQL/#43_1","title":"4.3  \u521b\u5efa\u8868\u65f6\u8bbe\u7f6e\u6807\u8bc6\u5217","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>CREATE TABLE \u8868(\n  \u5b57\u6bb5\u540d \u5b57\u6bb5\u7c7b\u578b \u7ea6\u675f AUTO_INCREMENT\n);\n</code></pre> <p>\u4f8b\uff1a</p> <pre><code>CREATE TABLE tab_identity (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  NAME VARCHAR(20)\n) ;\n</code></pre>"},{"location":"databases/MySQL/SQL/#44_1","title":"4.4  \u521b\u5efa\u8868\u65f6\u8bbe\u7f6e\u6807\u8bc6\u5217","text":"<pre><code>ALTER TABLE tab_identity MODIFY COLUMN id INT PRIMARY KEY AUTO_INCREMENT;\n</code></pre>"},{"location":"databases/MySQL/SQL/#45_1","title":"4.5  \u4fee\u6539\u8868\u65f6\u5220\u9664\u6807\u8bc6\u5217","text":"<pre><code>ALTER TABLE tab_identity MODIFY COLUMN id INT;\n</code></pre>"},{"location":"databases/MySQL/SQL/#46_1","title":"4.6 \u8bbe\u7f6e\u6807\u8bc6\u5217\u7684\u6b65\u957f","text":"<pre><code>SHOW VARIABLES LIKE '%auto_increment%';\nSET auto_increment_increment = 3;\n</code></pre>"},{"location":"databases/MySQL/SQL/#_4","title":"SQL","text":"<p>\u7528\u5230\u7684\u6570\u636e\u5e93\uff1a</p> <p>myemployees\u6570\u636e\u5e93</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/","title":"SQL\u4f18\u5316","text":""},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#sql","title":"\u4e00\u3001SQL\u6267\u884c\u7edf\u8ba1\u4fe1\u606f","text":"<p>MySQL \u5ba2\u6237\u7aef\u8fde\u63a5\u6210\u529f\u540e\uff0c\u901a\u8fc7<code>show [session|global] status</code>\u547d\u4ee4\u53ef\u4ee5\u63d0\u4f9b\u670d\u52a1\u5668\u72b6\u6001\u4fe1\u606f\u3002</p> <p>session\uff1a\u5f53\u524d\u8fde\u63a5\u7684\u7edf\u8ba1\u8ba1\u7ed3\u679c\u3002\u9ed8\u8ba4\u4e3a\u8be5\u53c2\u6570</p> <p>global\uff1a\u81ea\u6570\u636e\u5e93\u4e0a\u6b21\u542f\u52a8\u81f3\u4eca\u7684\u7edf\u8ba1\u7ed3\u679c\u3002</p> <p>\u4e0b\u9762\u7684\u547d\u4ee4\u663e\u793a\u4e86\u5f53\u524d session \u4e2d\u6240\u6709\u7edf\u8ba1\u53c2\u6570\u7684\u503c\uff1a</p> <pre><code>mysql [(none)]&gt;show status like 'Com_______';\n+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| Com_binlog    | 0     |\n| Com_commit    | 0     |\n| Com_delete    | 0     |\n| Com_insert    | 0     |\n| Com_repair    | 0     |\n| Com_revoke    | 0     |\n| Com_select    | 1     |\n| Com_signal    | 0     |\n| Com_update    | 0     |\n| Com_xa_end    | 0     |\n+---------------+-------+\n10 rows in set (0.01 sec)\n</code></pre> <p>Com_xxx \u8868\u793a\u6bcf\u4e2a xxx \u8bed\u53e5\u6267\u884c\u7684\u6b21\u6570\uff0c\u6211\u4eec\u901a\u5e38\u6bd4\u8f83\u5173\u5fc3\u7684\u662f\u4ee5\u4e0b\u51e0\u4e2a\u7edf\u8ba1\u53c2\u6570\u3002</p> \u53c2\u6570 \u542b\u4e49 Com_select \u6267\u884c select \u64cd\u4f5c\u7684\u6b21\u6570\uff0c\u4e00\u6b21\u67e5\u8be2\u53ea\u7d2f\u52a0 1\u3002 Com_insert \u6267\u884c INSERT \u64cd\u4f5c\u7684\u6b21\u6570\uff0c\u5bf9\u4e8e\u6279\u91cf\u63d2\u5165\u7684 INSERT \u64cd\u4f5c\uff0c\u53ea\u7d2f\u52a0\u4e00\u6b21\u3002 Com_update \u6267\u884c UPDATE \u64cd\u4f5c\u7684\u6b21\u6570\u3002 Com_delete \u6267\u884c DELETE \u64cd\u4f5c\u7684\u6b21\u6570\u3002 <pre><code>mysql [(none)]&gt;show status like 'Innodb_rows_%';\n+----------------------+-------+\n| Variable_name        | Value |\n+----------------------+-------+\n| Innodb_rows_deleted  | 0     |\n| Innodb_rows_inserted | 0     |\n| Innodb_rows_read     | 8     |\n| Innodb_rows_updated  | 0     |\n+----------------------+-------+\n4 rows in set (0.00 sec)\n</code></pre> \u53c2\u6570 \u542b\u4e49 Innodb_rows_read select \u67e5\u8be2\u8fd4\u56de\u7684\u884c\u6570\u3002 Innodb_rows_inserted \u6267\u884c INSERT \u64cd\u4f5c\u63d2\u5165\u7684\u884c\u6570\u3002 Innodb_rows_updated \u6267\u884c UPDATE \u64cd\u4f5c\u66f4\u65b0\u7684\u884c\u6570\u3002 Innodb_rows_deleted \u6267\u884c DELETE \u64cd\u4f5c\u5220\u9664\u7684\u884c\u6570\u3002"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#sql_1","title":"\u4e8c\u3001\u4f4e\u6548\u7387\u6267\u884cSQL\u5b9a\u4f4d","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\u5b9a\u4f4d\u6267\u884c\u6548\u7387\u8f83\u4f4e\u7684 SQL \u8bed\u53e5\u3002</p> <ul> <li>\u6162\u67e5\u8be2\u65e5\u5fd7 : \u901a\u8fc7\u6162\u67e5\u8be2\u65e5\u5fd7\u5b9a\u4f4d\u90a3\u4e9b\u6267\u884c\u6548\u7387\u8f83\u4f4e\u7684SQL\u8bed\u53e5\uff0c\u7528<code>--log-slow-queries[=ile_name]</code>\u9009\u9879\u542f\u52a8\u65f6\uff0cmysqld \u5199\u4e00\u4e2a\u5305\u542b\u6240\u6709\u6267\u884c\u65f6\u95f4\u8d85\u8fc7<code>long_query_time</code>\u79d2\u7684 SQL \u8bed\u53e5\u7684\u65e5\u5fd7\u6587\u4ef6\u3002</li> <li><code>show processlist</code> : \u6162\u67e5\u8be2\u65e5\u5fd7\u5728\u67e5\u8be2\u7ed3\u675f\u4ee5\u540e\u624d\u7eaa\u5f55\uff0c\u6240\u4ee5\u5728\u5e94\u7528\u53cd\u6620\u6267\u884c\u6548\u7387\u51fa\u73b0\u95ee\u9898\u7684\u65f6\u5019\u67e5\u8be2\u6162\u67e5\u8be2\u65e5\u5fd7\u5e76\u4e0d\u80fd\u5b9a\u4f4d\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528<code>show processlist</code>\u547d\u4ee4\u67e5\u770b\u5f53\u524dMySQL\u5728\u8fdb\u884c\u7684\u7ebf\u7a0b\uff0c\u5305\u62ec\u7ebf\u7a0b\u7684\u72b6\u6001\u3001\u662f\u5426\u9501\u8868\u7b49\uff0c\u53ef\u4ee5\u5b9e\u65f6\u5730\u67e5\u770b SQL \u7684\u6267\u884c\u60c5\u51b5\uff0c\u540c\u65f6\u5bf9\u4e00\u4e9b\u9501\u8868\u64cd\u4f5c\u8fdb\u884c\u4f18\u5316\u3002</li> </ul> <pre><code>mysql [(none)]&gt;SHOW PROCESSLIST;\n+----+------+-----------+------+---------+------+----------+------------------+\n| Id | User | Host      | db   | Command | Time | State    | Info             |\n+----+------+-----------+------+---------+------+----------+------------------+\n|  2 | root | localhost | NULL | Query   |    0 | starting | show processlist |\n+----+------+-----------+------+---------+------+----------+------------------+\n1 row in set (0.00 sec)\n</code></pre> \u5217\u540d \u542b\u4e49 <code>Id</code> \u7528\u6237\u767b\u5f55mysql\u65f6\uff0c\u7cfb\u7edf\u5206\u914d\u7684\u00b7connection_id\u00b7\uff0c\u53ef\u4ee5\u4f7f\u7528\u51fd\u6570<code>SELECT connection_id();</code>\u67e5\u770b <code>User</code> \u663e\u793a\u5f53\u524d\u7528\u6237\u3002\u5982\u679c\u4e0d\u662froot\uff0c\u8fd9\u4e2a\u547d\u4ee4\u5c31\u53ea\u663e\u793a\u7528\u6237\u6743\u9650\u8303\u56f4\u7684sql\u8bed\u53e5 <code>Host</code> \u663e\u793a\u8fd9\u4e2a\u8bed\u53e5\u662f\u4ece\u54ea\u4e2aip\u7684\u54ea\u4e2a\u7aef\u53e3\u4e0a\u53d1\u7684\uff0c\u53ef\u4ee5\u7528\u6765\u8ddf\u8e2a\u51fa\u73b0\u95ee\u9898\u8bed\u53e5\u7684\u7528\u6237 <code>db</code> \u663e\u793a\u8fd9\u4e2a\u8fdb\u7a0b\u76ee\u524d\u8fde\u63a5\u7684\u662f\u54ea\u4e2a\u6570\u636e\u5e93 <code>Command</code> \u663e\u793a\u5f53\u524d\u8fde\u63a5\u7684\u6267\u884c\u7684\u547d\u4ee4\uff0c\u4e00\u822c\u53d6\u503c\u4e3a\u4f11\u7720\uff08sleep\uff09\uff0c\u67e5\u8be2\uff08query\uff09\uff0c\u8fde\u63a5\uff08connect\uff09\u7b49 <code>Time</code> \u663e\u793a\u8fd9\u4e2a\u72b6\u6001\u6301\u7eed\u7684\u65f6\u95f4\uff0c\u5355\u4f4d\u662f\u79d2 <code>State</code> <code>\u663e\u793a\u4f7f\u7528\u5f53\u524d\u8fde\u63a5\u7684sql\u8bed\u53e5\u7684\u72b6\u6001\uff0c\u5f88\u91cd\u8981\u7684\u5217\u3002state\u63cf\u8ff0\u7684\u662f\u8bed\u53e5\u6267\u884c\u4e2d\u7684\u67d0\u4e00\u4e2a\u72b6\u6001\u3002\u4e00\u4e2asql\u8bed\u53e5\uff0c\u4ee5\u67e5\u8be2\u4e3a\u4f8b\uff0c\u53ef\u80fd\u9700\u8981\u7ecf\u8fc7</code>copying to tmp table<code>\u3001</code>sorting result<code>\u3001sending data</code>\u7b49\u72b6\u6001\u624d\u53ef\u4ee5\u5b8c\u6210 <code>Info</code> \u663e\u793a\u8fd9\u4e2asql\u8bed\u53e5\uff0c\u662f\u5224\u65ad\u95ee\u9898\u8bed\u53e5\u7684\u4e00\u4e2a\u91cd\u8981\u4f9d\u636e"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#show-profilesql","title":"\u4e09\u3001<code>show profile</code>\u5206\u6790SQL","text":"<p><code>show profiles</code> \u80fd\u591f\u5728\u505aSQL\u4f18\u5316\u65f6\u5e2e\u52a9\u6211\u4eec\u4e86\u89e3\u65f6\u95f4\u90fd\u8017\u8d39\u5230\u54ea\u91cc\u53bb\u4e86\u3002</p> <p>\u5224\u65ad\u5f53\u524dMySQL\u662f\u5426\u652f\u6301<code>profile</code></p> <pre><code>mysql [(none)]&gt;select @@profiling;\n+-------------+\n| @@profiling |\n+-------------+\n|           0 |\n+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u9ed8\u8ba4<code>profiling</code>\u662f\u5173\u95ed\u7684\uff0c\u53ef\u4ee5\u901a\u8fc7set\u8bed\u53e5\u5728Session\u7ea7\u522b\u5f00\u542f<code>profiling</code></p> <pre><code>set profiling=1;\n</code></pre> <p>\u901a\u8fc7<code>profile</code>\uff0c\u6211\u4eec\u80fd\u591f\u66f4\u6e05\u695a\u5730\u4e86\u89e3SQL\u6267\u884c\u7684\u8fc7\u7a0b\u3002</p> <p>\u9996\u5148\uff0c\u6211\u4eec\u53ef\u4ee5\u6267\u884c\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u547d\u4ee4\u4e4b\u540e\uff0c\u518d\u6267\u884c<code>show profiles</code>\u6307\u4ee4\uff0c \u6765\u67e5\u770bSQL\u8bed\u53e5\u6267\u884c\u7684\u8017\u65f6\uff1a</p> <pre><code>mysql [employees]&gt;show profiles;\n+----------+------------+--------------------------------------------+\n| Query_ID | Duration   | Query                                      |\n+----------+------------+--------------------------------------------+\n|        1 | 0.00937200 | show databases                             |\n|        2 | 0.00908050 | SELECT DATABASE()                          |\n|        3 | 0.00044250 | show databases                             |\n|        4 | 0.00033250 | show tables                                |\n|        5 | 0.00035800 | show tables                                |\n|        6 | 0.00056600 | select * from employees where emp_no=10001 |\n|        7 | 0.19425375 | select count(*) from employees             |\n+----------+------------+--------------------------------------------+\n</code></pre> <p>\u901a\u8fc7<code>show  profile for  query &lt;query_id&gt;</code>\u8bed\u53e5\u53ef\u4ee5\u67e5\u770b\u5230\u8be5SQL\u6267\u884c\u8fc7\u7a0b\u4e2d\u6bcf\u4e2a\u7ebf\u7a0b\u7684\u72b6\u6001\u548c\u6d88\u8017\u7684\u65f6\u95f4</p> <pre><code>mysql [employees]&gt;show  profile for  query 7;\n+----------------------+----------+\n| Status               | Duration |\n+----------------------+----------+\n| starting             | 0.000057 |\n| checking permissions | 0.000008 |\n| Opening tables       | 0.000017 |\n| init                 | 0.000015 |\n| System lock          | 0.000009 |\n| optimizing           | 0.000012 |\n| statistics           | 0.000014 |\n| preparing            | 0.000011 |\n| executing            | 0.000004 |\n| Sending data         | 0.194021 |\n| end                  | 0.000017 |\n| query end            | 0.000009 |\n| closing tables       | 0.000008 |\n| freeing items        | 0.000036 |\n| cleaning up          | 0.000019 |\n+----------------------+----------+\n15 rows in set, 1 warning (0.00 sec)\n</code></pre> <p>Sending data \u8868\u793aMySQL\u7ebf\u7a0b\u5f00\u59cb\u8bbf\u95ee\u6570\u636e\u884c\u5e76\u628a\u7ed3\u679c\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u800c\u4e0d\u4ec5\u4ec5\u662f\u8fd4\u56de\u4e2a\u5ba2\u6237\u7aef\u3002\u7531\u4e8e\u5728Sending data\u72b6\u6001\u4e0b\uff0cMySQL\u7ebf\u7a0b\u5f80\u5f80\u9700\u8981\u505a\u5927\u91cf\u7684\u78c1\u76d8\u8bfb\u53d6\u64cd\u4f5c\uff0c\u6240\u4ee5\u7ecf\u5e38\u662f\u6574\u5404\u67e5\u8be2\u4e2d\u8017\u65f6\u6700\u957f\u7684\u72b6\u6001\u3002</p> <p>\u5982\u679c\u60f3\u67e5\u770b\u66f4\u5b8c\u6574\u7684\u4fe1\u606f\u53ef\u4ee5\u4f7f\u7528<code>show  profile all for  query 7;</code></p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#trace","title":"\u56db\u3001<code>trace</code>\u5206\u6790\u4f18\u5316\u5668\u6267\u884c\u8ba1\u5212","text":"<p>MySQL5.6\u63d0\u4f9b\u4e86\u5bf9SQL\u7684\u8ddf\u8e2atrace, \u901a\u8fc7trace\u6587\u4ef6\u80fd\u591f\u8fdb\u4e00\u6b65\u4e86\u89e3\u4e3a\u4ec0\u4e48\u4f18\u5316\u5668\u9009\u62e9A\u8ba1\u5212, \u800c\u4e0d\u662f\u9009\u62e9B\u8ba1\u5212\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1-trace","title":"1. \u5f00\u542f<code>trace</code>","text":"<p>\u6253\u5f00trace\uff0c\u8bbe\u7f6e\u683c\u5f0f\u4e3a JSON\uff0c</p> <pre><code>SET optimizer_trace=\"enabled=on\",end_markers_in_json=on;\n</code></pre> <p>\u8bbe\u7f6etrace\u6700\u5927\u80fd\u591f\u4f7f\u7528\u7684\u5185\u5b58\u5927\u5c0f\uff0c\u907f\u514d\u89e3\u6790\u8fc7\u7a0b\u4e2d\u56e0\u4e3a\u9ed8\u8ba4\u5185\u5b58\u8fc7\u5c0f\u800c\u4e0d\u80fd\u591f\u5b8c\u6574\u5c55\u793a\u3002</p> <pre><code>SET optimizer_trace_max_mem_size=1000000;\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2-sql","title":"2. \u6267\u884cSQL\u8bed\u53e5","text":"<pre><code>select * from employees where emp_no=10001\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#3-information_schemaoptimizer_trace","title":"3. \u68c0\u67e5<code>information_schema.optimizer_trace</code>","text":"<p>\u68c0\u67e5<code>information_schema.optimizer_trace</code>\u5c31\u53ef\u4ee5\u77e5\u9053MySQL\u662f\u5982\u4f55\u6267\u884cSQL\u7684 </p> <pre><code>mysql [employees]&gt;select * from information_schema.optimizer_trace\\G;\n*************************** 1. row ***************************\n                            QUERY: select * from employees where emp_no=10001\n                            TRACE: {\n  \"steps\": [\n    {\n      \"join_preparation\": {\n        \"select#\": 1,\n        \"steps\": [\n          {\n            \"expanded_query\": \"/* select#1 */ select `employees`.`emp_no` AS `emp_no`,`employees`.`birth_date` AS `birth_date`,`employees`.`first_name` AS `first_name`,`employees`.`last_name` AS `last_name`,`employees`.`gender` AS `gender`,`employees`.`hire_date` AS `hire_date` from `employees` where (`employees`.`emp_no` = 10001)\"\n          }\n        ] /* steps */\n      } /* join_preparation */\n    },\n    {\n      \"join_optimization\": {\n        \"select#\": 1,\n        \"steps\": [\n          {\n            \"condition_processing\": {\n              \"condition\": \"WHERE\",\n              \"original_condition\": \"(`employees`.`emp_no` = 10001)\",\n              \"steps\": [\n                {\n                  \"transformation\": \"equality_propagation\",\n                  \"resulting_condition\": \"multiple equal(10001, `employees`.`emp_no`)\"\n                },\n                {\n                  \"transformation\": \"constant_propagation\",\n                  \"resulting_condition\": \"multiple equal(10001, `employees`.`emp_no`)\"\n                },\n                {\n                  \"transformation\": \"trivial_condition_removal\",\n                  \"resulting_condition\": \"multiple equal(10001, `employees`.`emp_no`)\"\n                }\n              ] /* steps */\n            } /* condition_processing */\n          },\n          {\n            \"substitute_generated_columns\": {\n            } /* substitute_generated_columns */\n          },\n          {\n            \"table_dependencies\": [\n              {\n                \"table\": \"`employees`\",\n                \"row_may_be_null\": false,\n                \"map_bit\": 0,\n                \"depends_on_map_bits\": [\n                ] /* depends_on_map_bits */\n              }\n            ] /* table_dependencies */\n          },\n          {\n            \"ref_optimizer_key_uses\": [\n              {\n                \"table\": \"`employees`\",\n                \"field\": \"emp_no\",\n                \"equals\": \"10001\",\n                \"null_rejecting\": false\n              }\n            ] /* ref_optimizer_key_uses */\n          },\n          {\n            \"rows_estimation\": [\n              {\n                \"table\": \"`employees`\",\n                \"rows\": 1,\n                \"cost\": 1,\n                \"table_type\": \"const\",\n                \"empty\": false\n              }\n            ] /* rows_estimation */\n          },\n          {\n            \"condition_on_constant_tables\": \"1\",\n            \"condition_value\": true\n          },\n          {\n            \"attaching_conditions_to_tables\": {\n              \"original_condition\": \"1\",\n              \"attached_conditions_computation\": [\n              ] /* attached_conditions_computation */,\n              \"attached_conditions_summary\": [\n              ] /* attached_conditions_summary */\n            } /* attaching_conditions_to_tables */\n          },\n          {\n            \"refine_plan\": [\n            ] /* refine_plan */\n          }\n        ] /* steps */\n      } /* join_optimization */\n    },\n    {\n      \"join_execution\": {\n        \"select#\": 1,\n        \"steps\": [\n        ] /* steps */\n      } /* join_execution */\n    }\n  ] /* steps */\n}\nMISSING_BYTES_BEYOND_MAX_MEM_SIZE: 0\n          INSUFFICIENT_PRIVILEGES: 0\n1 row in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#sql_2","title":"\u4e94\u3001SQL\u8bed\u53e5\u4f18\u5316","text":""},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1","title":"1. \u5927\u6279\u91cf\u5bfc\u5165\u6570\u636e","text":""},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1_1","title":"1. \u4e3b\u952e\u987a\u5e8f\u63d2\u5165","text":"<p>\u56e0\u4e3a<code>InnoDB</code>\u7c7b\u578b\u7684\u8868\u662f\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u4fdd\u5b58\u7684\uff0c\u6240\u4ee5\u5c06\u5bfc\u5165\u7684\u6570\u636e\u6309\u7167\u4e3b\u952e\u7684\u987a\u5e8f\u6392\u5217\uff0c\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387\u3002\u5982\u679c<code>InnoDB</code>\u8868\u6ca1\u6709\u4e3b\u952e\uff0c\u90a3\u4e48\u7cfb\u7edf\u4f1a\u81ea\u52a8\u9ed8\u8ba4\u521b\u5efa\u4e00\u4e2a\u5185\u90e8\u5217\u4f5c\u4e3a\u4e3b\u952e\uff0c\u6240\u4ee5\u5982\u679c\u53ef\u4ee5\u7ed9\u8868\u521b\u5efa\u4e00\u4e2a\u4e3b\u952e\uff0c\u5c06\u53ef\u4ee5\u5229\u7528\u8fd9\u70b9\uff0c\u6765\u63d0\u9ad8\u5bfc\u5165\u6570\u636e\u7684\u6548\u7387\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2","title":"2. \u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c","text":"<p>\u5728\u5bfc\u5165\u6570\u636e\u524d\u6267\u884c<code>SET UNIQUE_CHECKS=0</code>\uff0c\u5173\u95ed\u552f\u4e00\u6027\u6821\u9a8c\uff0c</p> <p>\u5728\u5bfc\u5165\u7ed3\u675f\u540e\u6267\u884c<code>SET UNIQUE_CHECKS=1</code>\uff0c\u6062\u590d\u552f\u4e00\u6027\u6821\u9a8c\uff0c</p> <p>\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#3","title":"3. \u624b\u52a8\u63d0\u4ea4\u4e8b\u52a1","text":"<p>\u5982\u679c\u5e94\u7528\u4f7f\u7528\u81ea\u52a8\u63d0\u4ea4\u7684\u65b9\u5f0f\uff0c\u5efa\u8bae\u5728\u5bfc\u5165\u524d\u6267\u884c<code>SET AUTOCOMMIT=0</code>\uff0c\u5173\u95ed\u81ea\u52a8\u63d0\u4ea4\uff1b\u5bfc\u5165\u7ed3\u675f\u540e\u518d\u6267\u884c<code>SET AUTOCOMMIT=1</code>\uff0c\u6253\u5f00\u81ea\u52a8\u63d0\u4ea4\uff0c\u4e5f\u53ef\u4ee5\u63d0\u9ad8\u5bfc\u5165\u7684\u6548\u7387\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2-insert","title":"2. \u4f18\u5316<code>INSERT</code>","text":""},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1-insert","title":"1. \u4f7f\u7528<code>INSERT</code>\u4e00\u6b21\u63d2\u5165\u591a\u4e2a\u503c","text":"<pre><code>INSERT INTO tb_test VALUES(1,'Tom'),(2,'Cat')\uff0c(3,'Jerry');\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2_1","title":"2. \u5728\u4e8b\u52a1\u4e2d\u63d2\u5165\u6570\u636e","text":"<pre><code>start transaction;\n# \u5982\u679c\u6570\u636e\u91cf\u6bd4\u8f83\u5927\uff0c\u53ef\u4ee5\u5206\u6bb5\u63d0\u4ea4\nINSERT INTO tb_test VALUES(1,'Tom');\nINSERT INTO tb_test VALUES(2,'Cat');\nINSERT INTO tb_test VALUES(3,'Jerry');\ncommit;\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#3_1","title":"3. \u6570\u636e\u6709\u5e8f\u63d2\u5165","text":"<pre><code>INSERT INTO tb_test VALUES(1,'Tom');\nINSERT INTO tb_test VALUES(2,'Cat');\nINSERT INTO tb_test VALUES(3,'Jerry');\nINSERT INTO tb_test VALUES(4,'Tim');\nINSERT INTO tb_test VALUES(5,'Rose');\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#3-order-by","title":"3. \u4f18\u5316<code>ORDER\u00a0BY</code>","text":"<pre><code>CREATE TABLE `emp` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `name` varchar(100) NOT NULL,\n  `age` int(3) NOT NULL,\n  `salary` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8mb4;\n\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('1','Tom','25','2300');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('2','Jerry','30','3500');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('3','Luci','25','2800');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('4','Jay','36','3500');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('5','Tom2','21','2200');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('6','Jerry2','31','3300');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('7','Luci2','26','2700');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('8','Jay2','33','3500');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('9','Tom3','23','2400');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('10','Jerry3','32','3100');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('11','Luci3','26','2900');\nINSERT INTO `emp` (`id`, `name`, `age`, `salary`) VALUES('12','Jay3','37','4500');\n\ncreate index idx_emp_age_salary on emp(age,salary);\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1_2","title":"1. \u6392\u5e8f\u65b9\u5f0f","text":""},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#11-filesort","title":"1.1 <code>filesort</code>","text":"<p>\u6240\u6709\u4e0d\u662f\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6392\u5e8f\u7ed3\u679c\u7684\u6392\u5e8f\u90fd\u53eb<code>filesort</code>\u6392\u5e8f\u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * from emp ORDER BY age;\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra          |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |   100.00 | Using `filesort`|\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * from emp ORDER BY age, salary;\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra          |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |   100.00 | Using `filesort`|\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+----------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#12-using-index","title":"1.2 <code>using index</code>","text":"<p>\u901a\u8fc7\u6709\u5e8f\u7d22\u5f15\u987a\u5e8f\u626b\u63cf\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e\uff0c\u8fd9\u79cd\u60c5\u51b5\u5373\u4e3a using index\uff0c\u4e0d\u9700\u8981\u989d\u5916\u6392\u5e8f\uff0c\u64cd\u4f5c\u6548\u7387\u9ad8\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#121","title":"1.2.1 \u5355\u5b57\u6bb5\u6392\u5e8f","text":"<pre><code># \u8fd4\u56de\u7684\u5b57\u6bb5\u662f\u8986\u76d6\u7d22\u5f15\uff0c\nmysql [test]&gt;EXPLAIN SELECT id from emp ORDER BY age;\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key                | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | index | NULL          | idx_emp_age_salary | 9       | NULL |   12 |   100.00 | Using index |\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#122","title":"1.2.2 \u591a\u5b57\u6bb5\u6392\u5e8f","text":"<pre><code># \u5982\u679c\u6392\u5e8f\u65b9\u5f0f\u76f8\u540c\u5219\u4f7f\u7528using index\nmysql [test]&gt;EXPLAIN SELECT id, age, salary FROM emp ORDER BY age, salary;\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key                | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | index | NULL          | idx_emp_age_salary | 9       | NULL |   12 |   100.00 | Using index |\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n\n# \u5982\u679c\u6392\u5e8f\u65b9\u5f0f\u4e0d\u540c\uff0c\u5219\u51fa\u73b0filesort\nmysql [test]&gt;EXPLAIN SELECT id, age, salary FROM emp ORDER BY age, salary desc;\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-----------------------------+\n| id | select_type | table | partitions | type  | possible_keys | key                | key_len | ref  | rows | filtered | Extra                       |\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-----------------------------+\n|  1 | SIMPLE      | emp   | NULL       | index | NULL          | idx_emp_age_salary | 9       | NULL |   12 |   100.00 | Using index; Using `filesort`|\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-----------------------------+\n1 row in set, 1 warning (0.00 sec)\n\n# \u5982\u679c\u6392\u5e8f\u5b57\u6bb5\u548c\u7d22\u5f15\u5b57\u6bb5\u4e0d\u4e00\u81f4\uff0c\u5219\u51fa\u73b0filesort\nmysql [test]&gt;EXPLAIN SELECT id, age, salary FROM emp ORDER BY salary, age;\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-----------------------------+\n| id | select_type | table | partitions | type  | possible_keys | key                | key_len | ref  | rows | filtered | Extra                       |\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-----------------------------+\n|  1 | SIMPLE      | emp   | NULL       | index | NULL          | idx_emp_age_salary | 9       | NULL |   12 |   100.00 | Using index; Using `filesort`|\n+----+-------------+-------+------------+-------+---------------+--------------------+---------+------+------+----------+-----------------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u5c3d\u91cf\u51cf\u5c11\u989d\u5916\u7684\u6392\u5e8f\uff0c\u901a\u8fc7\u7d22\u5f15\u76f4\u63a5\u8fd4\u56de\u6709\u5e8f\u6570\u636e\u3002<code>WHERE</code>\u6761\u4ef6\u548c<code>order by</code>\u4f7f\u7528\u76f8\u540c\u7684\u7d22\u5f15\uff0c\u5e76\u4e14<code>order by</code>\u7684\u987a\u5e8f\u548c\u7d22\u5f15\u987a\u5e8f\u76f8\u540c\uff0c \u5e76\u4e14<code>order  by</code>\u7684\u5b57\u6bb5\u90fd\u662f\u5347\u5e8f\uff0c\u6216\u8005\u90fd\u662f\u964d\u5e8f\u3002\u5426\u5219\u80af\u5b9a\u9700\u8981\u989d\u5916\u7684\u64cd\u4f5c\uff0c\u8fd9\u6837\u5c31\u4f1a\u51fa\u73b0<code>filesort</code>\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2-filesort","title":"2. <code>filesort</code>\u4f18\u5316","text":"<p>\u901a\u8fc7\u521b\u5efa\u5408\u9002\u7684\u7d22\u5f15\uff0c\u80fd\u591f\u51cf\u5c11 <code>filesort</code>\u7684\u51fa\u73b0\uff0c\u4f46\u662f\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c\u6761\u4ef6\u9650\u5236\u4e0d\u80fd\u8ba9<code>filesort</code>\u6d88\u5931\uff0c\u90a3\u5c31\u9700\u8981\u52a0\u5feb<code>filesort</code>\u7684\u6392\u5e8f\u64cd\u4f5c\u3002\u5bf9\u4e8e<code>filesort</code>\uff0c MySQL \u6709\u4e24\u79cd\u6392\u5e8f\u7b97\u6cd5\uff1a</p> <p>1\uff09 \u4e24\u6b21\u626b\u63cf\u7b97\u6cd5 \uff1aMySQL4.1 \u4e4b\u524d\uff0c\u4f7f\u7528\u8be5\u65b9\u5f0f\u6392\u5e8f\u3002\u9996\u5148\u6839\u636e\u6761\u4ef6\u53d6\u51fa\u6392\u5e8f\u5b57\u6bb5\u548c\u884c\u6307\u9488\u4fe1\u606f\uff0c\u7136\u540e\u5728\u6392\u5e8f\u533asort buffer\u4e2d\u6392\u5e8f\uff0c\u5982\u679csort buffer\u4e0d\u591f\uff0c\u5219\u5728\u4e34\u65f6\u8868 temporary table \u4e2d\u5b58\u50a8\u6392\u5e8f\u7ed3\u679c\u3002\u5b8c\u6210\u6392\u5e8f\u4e4b\u540e\uff0c\u518d\u6839\u636e\u884c\u6307\u9488\u56de\u8868\u8bfb\u53d6\u8bb0\u5f55\uff0c\u8be5\u64cd\u4f5c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5927\u91cf\u968f\u673aI/O\u64cd\u4f5c\u3002</p> <p>2\uff09\u4e00\u6b21\u626b\u63cf\u7b97\u6cd5\uff1a\u4e00\u6b21\u6027\u53d6\u51fa\u6ee1\u8db3\u6761\u4ef6\u7684\u6240\u6709\u5b57\u6bb5\uff0c\u7136\u540e\u5728\u6392\u5e8f\u533a sort  buffer \u4e2d\u6392\u5e8f\u540e\u76f4\u63a5\u8f93\u51fa\u7ed3\u679c\u96c6\u3002\u6392\u5e8f\u65f6\u5185\u5b58\u5f00\u9500\u8f83\u5927\uff0c\u4f46\u662f\u6392\u5e8f\u6548\u7387\u6bd4\u4e24\u6b21\u626b\u63cf\u7b97\u6cd5\u8981\u9ad8\u3002</p> <p>MySQL \u901a\u8fc7\u6bd4\u8f83\u7cfb\u7edf\u53d8\u91cf<code>max_length_for_sort_data</code>\u7684\u5927\u5c0f\u548cQuery\u8bed\u53e5\u53d6\u51fa\u7684\u5b57\u6bb5\u603b\u5927\u5c0f\uff0c \u6765\u5224\u5b9a\u662f\u5426\u90a3\u79cd\u6392\u5e8f\u7b97\u6cd5\uff0c\u5982\u679c<code>max_length_for_sort_data</code>\u66f4\u5927\uff0c\u90a3\u4e48\u4f7f\u7528\u7b2c\u4e8c\u79cd\u4f18\u5316\u4e4b\u540e\u7684\u7b97\u6cd5\uff1b\u5426\u5219\u4f7f\u7528\u7b2c\u4e00\u79cd\u3002</p> <p>\u53ef\u4ee5\u9002\u5f53\u63d0\u9ad8<code>sort_buffer_size</code>\u548c<code>max_length_for_sort_data</code>\u7cfb\u7edf\u53d8\u91cf\uff0c\u6765\u589e\u5927\u6392\u5e8f\u533a\u7684\u5927\u5c0f\uff0c\u63d0\u9ad8\u6392\u5e8f\u7684\u6548\u7387\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#4-group-by","title":"4. \u4f18\u5316<code>GROUP BY</code>\u8bed\u53e5","text":"<p>\u7531\u4e8e<code>GROUP BY</code>\u5b9e\u9645\u4e0a\u4e5f\u540c\u6837\u4f1a\u8fdb\u884c\u6392\u5e8f\u64cd\u4f5c\uff0c\u800c\u4e14\u4e0e<code>ORDER BY</code>\u76f8\u6bd4\uff0c<code>GROUP BY</code>\u4e3b\u8981\u53ea\u662f\u591a\u4e86\u6392\u5e8f\u4e4b\u540e\u7684\u5206\u7ec4\u64cd\u4f5c\u3002\u5f53\u7136\uff0c\u5982\u679c\u5728\u5206\u7ec4\u7684\u65f6\u5019\u8fd8\u4f7f\u7528\u4e86\u5176\u4ed6\u7684\u4e00\u4e9b\u805a\u5408\u51fd\u6570\uff0c\u90a3\u4e48\u8fd8\u9700\u8981\u4e00\u4e9b\u805a\u5408\u51fd\u6570\u7684\u8ba1\u7b97\u3002\u6240\u4ee5\uff0c\u5728<code>GROUP BY</code>\u7684\u5b9e\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u4e0e<code>ORDER BY</code>\u4e00\u6837\u4e5f\u53ef\u4ee5\u5229\u7528\u5230\u7d22\u5f15\u3002</p> <p>\u5982\u679c\u67e5\u8be2\u5305\u542b group by \u4f46\u662f\u7528\u6237\u60f3\u8981\u907f\u514d\u6392\u5e8f\u7ed3\u679c\u7684\u6d88\u8017\uff0c \u5219\u53ef\u4ee5\u6267\u884c<code>order by null</code>\u7981\u6b62\u6392\u5e8f\u3002\u5982\u4e0b \uff1a</p> <pre><code># \u5148\u5220\u9664\u5b58\u5728\u7684\u7d22\u5f15\nmysql [test]&gt;drop index idx_emp_age_salary on emp;\nQuery OK, 0 rows affected (0.03 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n# extra\u4e2d\u51fa\u73b0\u4e86Using filesort\uff0c\u8bf4\u660egroup by\u5e95\u5c42\u8fdb\u884c\u4e86\u6392\u5e8f\u64cd\u4f5c\nmysql [test]&gt;explain select age,count(*) from emp group by age;\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+---------------------------------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra                           |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+---------------------------------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |   100.00 | Using temporary; Using filesort |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+---------------------------------+\n1 row in set, 1 warning (0.00 sec)\n# \u5728SQL\u540e\u9762\u52a0order by null\uff0cExtra\u4e2dUsing filesort\u6d88\u5931\nmysql [test]&gt;explain select age,count(*) from emp group by age order by null;\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-----------------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra           |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-----------------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |   100.00 | Using temporary |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-----------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u4e0a\u8ff0\u7684SQL\u4ecd\u7136\u4f7f\u7528\u4e86\u4e34\u65f6\u8868\uff0c\u53ef\u4ee5\u901a\u8fc7\u521b\u5efa\u7d22\u5f15\u6765\u4f18\u5316\u3002</p> <pre><code>mysql [test]&gt;create index idx_emp_age_salary on emp(age,salary);\nQuery OK, 0 rows affected (0.05 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\nmysql [test]&gt;mysql [test]&gt;explain select age,count(*) from emp group by age order by null;\n+----+-------------+-------+------------+-------+--------------------+--------------------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys      | key                | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+--------------------+--------------------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | index | idx_emp_age_salary | idx_emp_age_salary | 9       | NULL |   12 |   100.00 | Using index |\n+----+-------------+-------+------------+-------+--------------------+--------------------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#5","title":"5. \u4f18\u5316\u5d4c\u5957\u67e5\u8be2","text":"<p>Mysql4.1\u7248\u672c\u4e4b\u540e\uff0c\u5f00\u59cb\u652f\u6301SQL\u7684\u5b50\u67e5\u8be2\u3002\u8fd9\u4e2a\u6280\u672f\u53ef\u4ee5\u4f7f\u7528SELECT\u8bed\u53e5\u6765\u521b\u5efa\u4e00\u4e2a\u5355\u5217\u7684\u67e5\u8be2\u7ed3\u679c\uff0c\u7136\u540e\u628a\u8fd9\u4e2a\u7ed3\u679c\u4f5c\u4e3a\u8fc7\u6ee4\u6761\u4ef6\u7528\u5728\u53e6\u4e00\u4e2a\u67e5\u8be2\u4e2d\u3002\u4f7f\u7528\u5b50\u67e5\u8be2\u53ef\u4ee5\u4e00\u6b21\u6027\u7684\u5b8c\u6210\u5f88\u591a\u903b\u8f91\u4e0a\u9700\u8981\u591a\u4e2a\u6b65\u9aa4\u624d\u80fd\u5b8c\u6210\u7684SQL\u64cd\u4f5c\uff0c\u540c\u65f6\u4e5f\u53ef\u4ee5\u907f\u514d\u4e8b\u52a1\u6216\u8005\u8868\u9501\u6b7b\uff0c\u5e76\u4e14\u5199\u8d77\u6765\u4e5f\u5f88\u5bb9\u6613\u3002\u4f46\u662f\uff0c\u6709\u4e9b\u60c5\u51b5\u4e0b\uff0c\u5b50\u67e5\u8be2\u662f\u53ef\u4ee5\u88ab\u66f4\u9ad8\u6548\u7684\u8fde\u63a5\uff08JOIN\uff09\u66ff\u4ee3\u3002</p> <p>\u793a\u4f8b \uff0c\u67e5\u627e\u6709\u89d2\u8272\u7684\u6240\u6709\u7684\u7528\u6237\u4fe1\u606f : </p> <pre><code>mysql [test]&gt; explain select * from t_user where id in (select user_id from user_role);\n+----+--------------+-------------+------------+--------+---------------+---------------+---------+----------------+------+----------+-------------+\n| id | select_type  | table       | partitions | type   | possible_keys | key           | key_len | ref            | rows | filtered | Extra       |\n+----+--------------+-------------+------------+--------+---------------+---------------+---------+----------------+------+----------+-------------+\n|  1 | SIMPLE       | t_user      | NULL       | ALL    | PRIMARY       | NULL          | NULL    | NULL           |    6 |   100.00 | Using where |\n|  1 | SIMPLE       | &lt;subquery2&gt; | NULL       | eq_ref | &lt;auto_key&gt;    | &lt;auto_key&gt;    | 99      | test.t_user.id |    1 |   100.00 | NULL        |\n|  2 | MATERIALIZED | user_role   | NULL       | index  | fk_ur_user_id | fk_ur_user_id | 99      | NULL           |    6 |   100.00 | Using index |\n+----+--------------+-------------+------------+--------+---------------+---------------+---------+----------------+------+----------+-------------+\n3 rows in set, 1 warning (0.00 sec)\n</code></pre> <p>\u4f7f\u7528JOIN\u6765\u4f18\u5316\u67e5\u8be2</p> <pre><code>mysql [test]&gt;explain select * from t_user u , user_role ur where u.id = ur.user_id;\n+----+-------------+-------+------------+--------+---------------+---------+---------+-----------------+------+----------+-------------+\n| id | select_type | table | partitions | type   | possible_keys | key     | key_len | ref             | rows | filtered | Extra       |\n+----+-------------+-------+------------+--------+---------------+---------+---------+-----------------+------+----------+-------------+\n|  1 | SIMPLE      | ur    | NULL       | ALL    | fk_ur_user_id | NULL    | NULL    | NULL            |    6 |   100.00 | Using where |\n|  1 | SIMPLE      | u     | NULL       | eq_ref | PRIMARY       | PRIMARY | 98      | test.ur.user_id |    1 |   100.00 | NULL        |\n+----+-------------+-------+------------+--------+---------------+---------+---------+-----------------+------+----------+-------------+\n2 rows in set, 1 warning (0.00 sec)\n</code></pre> <p>\u8fde\u63a5(Join)\u67e5\u8be2\u4e4b\u6240\u4ee5\u66f4\u6709\u6548\u7387\u4e00\u4e9b \uff0c\u662f\u56e0\u4e3aMySQL\u4e0d\u9700\u8981\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4e34\u65f6\u8868\u6765\u5b8c\u6210\u8fd9\u4e2a\u903b\u8f91\u4e0a\u9700\u8981\u4e24\u4e2a\u6b65\u9aa4\u7684\u67e5\u8be2\u5de5\u4f5c\u3002</p>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#6-or","title":"6. \u4f18\u5316<code>OR</code>\u67e5\u8be2","text":"<p>\u5bf9\u4e8e\u5305\u542bOR\u7684\u67e5\u8be2\u5b50\u53e5\uff0c\u5982\u679c\u8981\u5229\u7528\u7d22\u5f15\uff0c\u5219OR\u4e4b\u95f4\u7684\u6bcf\u4e2a\u6761\u4ef6\u5217\u90fd\u5fc5\u987b\u7528\u5230\u7d22\u5f15 \uff0c \u800c\u4e14\u4e0d\u80fd\u4f7f\u7528\u5230\u590d\u5408\u7d22\u5f15\uff1b \u5982\u679c\u6ca1\u6709\u7d22\u5f15\uff0c\u5219\u5e94\u8be5\u8003\u8651\u589e\u52a0\u7d22\u5f15\u3002</p> <p>\u67e5\u8be2<code>emp</code>\u8868\u4e2d\u7684\u7d22\u5f15</p> <pre><code>mysql [test]&gt;mysql [test]&gt;show index from emp;\n+-------+------------+--------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table | Non_unique | Key_name           | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+-------+------------+--------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| emp   |          0 | PRIMARY            |            1 | id          | A         |          12 |     NULL | NULL   |      | BTREE      |         |               |\n| emp   |          1 | idx_emp_age_salary |            1 | age         | A         |          10 |     NULL | NULL   |      | BTREE      |         |               |\n| emp   |          1 | idx_emp_age_salary |            2 | salary      | A         |          12 |     NULL | NULL   | YES  | BTREE      |         |               |\n+-------+------------+--------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n3 rows in set (0.00 sec)\n</code></pre> <p><code>OR</code>\u4e4b\u95f4\u7684\u6bcf\u4e00\u4e2a\u5b57\u6bb5\u90fd\u9700\u8981\u6709\u7d22\u5f15\uff0c\u5426\u5219\u7d22\u5f15\u5931\u6548\uff0c\u4f8b\u5982\uff1a</p> <pre><code># name\u5b57\u6bb5\u6ca1\u6709\u7d22\u5f15\uff0c\u6240\u6709\u5b57\u6bb5\u7684\u7d22\u5f15\u5931\u6548\nmysql [test]&gt;EXPLAIN SELECT * FROM emp WHERE id=1 OR name='TOM';\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | PRIMARY       | NULL | NULL    | NULL |   12 |    17.50 | Using where |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u5373\u4f7f\u6709\u590d\u5408\u7d22\u5f15\uff0c\u4f7f\u7528\u4e86<code>OR</code>\uff0c\u590d\u5408\u7d22\u5f15\u4e5f\u5931\u6548\u3002</p> <pre><code>mysql [test]&gt;mysql [test]&gt;EXPLAIN SELECT * FROM emp WHERE  age=20  OR salary=3500;\n+----+-------------+-------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type | possible_keys      | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | idx_emp_age_salary | NULL | NULL    | NULL |   12 |    19.00 | Using where |\n+----+-------------+-------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec) \n</code></pre> <p>\u5efa\u8bae\u4f7f\u7528<code>union</code>\u66ff\u6362<code>OR</code>\uff1a </p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM emp WHERE id = 1 OR id = 10;\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL |    2 |   100.00 | Using where |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n# \u4e0a\u8ff0SQl\u867d\u7136\u4f7f\u7528\u4e86\u7d22\u5f15\uff0c\u4f46\u662ftype\u7684\u503c\u4e3arange\uff0c\u6548\u7387\u4e0d\u662f\u5f88\u9ad8\u3002\u53ef\u4ee5\u4f7f\u7528UNION\u66ff\u6362\nmysql [test]&gt;mysql [test]&gt;EXPLAIN SELECT * FROM emp WHERE id = 1 UNION SELECT * FROM emp WHERE id = 10;\n+----+--------------+------------+------------+-------+---------------+---------+---------+-------+------+----------+-----------------+\n| id | select_type  | table      | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra           |\n+----+--------------+------------+------------+-------+---------------+---------+---------+-------+------+----------+-----------------+\n|  1 | PRIMARY      | emp        | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL            |\n|  2 | UNION        | emp        | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL            |\n| NULL | UNION RESULT | &lt;union1,2&gt; | NULL       | ALL   | NULL          | NULL    | NULL    | NULL  | NULL |     NULL | Using temporary |\n+----+--------------+------------+------------+-------+---------------+---------+---------+-------+------+----------+-----------------+\n3 rows in set, 1 warning (0.00 sec)\n# \u6b64\u65f6type\u7684\u503c\u4e3aconst\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#7","title":"7. \u4f18\u5316\u5206\u9875\u67e5\u8be2","text":"<p>\u4e00\u822c\u5206\u9875\u67e5\u8be2\u65f6\uff0c\u901a\u8fc7\u521b\u5efa\u8986\u76d6\u7d22\u5f15\u80fd\u591f\u6bd4\u8f83\u597d\u5730\u63d0\u9ad8\u6027\u80fd\u3002\u4e00\u4e2a\u5e38\u89c1\u53c8\u975e\u5e38\u5934\u75bc\u7684\u95ee\u9898\u5c31\u662f<code>limit 2000000,10</code>\uff0c\u6b64\u65f6\u9700\u8981MySQL\u6392\u5e8f\u524d2000010 \u8bb0\u5f55\uff0c\u4ec5\u4ec5\u8fd4\u56de2000000 - 2000010\u7684\u8bb0\u5f55\uff0c\u5176\u4ed6\u8bb0\u5f55\u4e22\u5f03\uff0c\u67e5\u8be2\u6392\u5e8f\u7684\u4ee3\u4ef7\u975e\u5e38\u5927 \u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM emp LIMIT 10,2;\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+\n|  1 | SIMPLE      | emp   | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |   100.00 | NULL  |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1_3","title":"1.  \u4f18\u5316\u601d\u8def\u4e00","text":"<p>\u5728\u7d22\u5f15\u4e0a\u5b8c\u6210\u6392\u5e8f\u5206\u9875\u64cd\u4f5c\uff0c\u6700\u540e\u6839\u636e\u4e3b\u952e\u5173\u8054\u56de\u539f\u8868\u67e5\u8be2\u6240\u9700\u8981\u7684\u5176\u4ed6\u5217\u5185\u5bb9\u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM emp e, ( SELECT id FROM emp ORDER BY id LIMIT 10, 2 ) t WHERE e.id = t.id;\n+----+-------------+------------+------------+--------+---------------+---------+---------+------+------+----------+-------------+\n| id | select_type | table      | partitions | type   | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+------------+------------+--------+---------------+---------+---------+------+------+----------+-------------+\n|  1 | PRIMARY     | &lt;derived2&gt; | NULL       | ALL    | NULL          | NULL    | NULL    | NULL |   12 |   100.00 | NULL        |\n|  1 | PRIMARY     | e          | NULL       | eq_ref | PRIMARY       | PRIMARY | 4       | t.id |    1 |   100.00 | NULL        |\n|  2 | DERIVED     | emp        | NULL       | index  | NULL          | PRIMARY | 4       | NULL |   12 |   100.00 | Using index |\n+----+-------------+------------+------------+--------+---------------+---------+---------+------+------+----------+-------------+\n3 rows in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2_2","title":"2. \u4f18\u5316\u601d\u8def\u4e8c","text":"<p>\u628a<code>limit</code>\u67e5\u8be2\u8f6c\u6362\u6210\u67d0\u4e2a\u4f4d\u7f6e\u7684\u67e5\u8be2\u3002\u8be5\u65b9\u6848\u9002\u7528\u4e8e\u4e3b\u952e\u81ea\u589e\u7684\u8868</p> <pre><code>mysql [test]&gt;mysql [test]&gt;explain select * from emp where id &gt; 10 limit 10;\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | emp   | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL |    2 |   100.00 | Using where |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#8-sql","title":"8. \u4f7f\u7528SQL\u63d0\u793a","text":"<p>SQL\u63d0\u793a\uff0c\u662f\u4f18\u5316\u6570\u636e\u5e93\u7684\u4e00\u4e2a\u91cd\u8981\u624b\u6bb5\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u5728SQL\u8bed\u53e5\u4e2d\u52a0\u5165\u4e00\u4e9b\u4eba\u4e3a\u7684\u63d0\u793a\u6765\u8fbe\u5230\u4f18\u5316\u64cd\u4f5c\u7684\u76ee\u7684\u3002</p> <pre><code>mysql [test]&gt;SHOW INDEX FROM tb_seller;\n+-----------+------------+--------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| Table     | Non_unique | Key_name                 | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |\n+-----------+------------+--------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n| tb_seller |          0 | PRIMARY                  |            1 | sellerid    | A         |          12 |     NULL | NULL   |      | BTREE      |         |               |\n| tb_seller |          1 | idx_seller_name_sta_addr |            1 | name        | A         |          12 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tb_seller |          1 | idx_seller_name_sta_addr |            2 | status      | A         |          12 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tb_seller |          1 | idx_seller_name_sta_addr |            3 | address     | A         |          12 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tb_seller |          1 | idx_seller_address       |            1 | address     | A         |           2 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tb_seller |          1 | idx_seller_name          |            1 | name        | A         |          12 |     NULL | NULL   | YES  | BTREE      |         |               |\n| tb_seller |          1 | idx_seller_status        |            1 | status      | A         |           3 |     NULL | NULL   | YES  | BTREE      |         |               |\n+-----------+------------+--------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+\n7 rows in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#1-use-index","title":"1. USE INDEX","text":"<p>\u5728\u67e5\u8be2\u8bed\u53e5\u4e2d\u8868\u540d\u7684\u540e\u9762\uff0c\u6dfb\u52a0<code>use index</code>\u6765\u63d0\u4f9b\u5e0c\u671bMySQL\u53bb\u53c2\u8003\u7684\u7d22\u5f15\u5217\u8868\uff0c\u5c31\u53ef\u4ee5\u8ba9MySQL\u4e0d\u518d\u8003\u8651\u5176\u4ed6\u53ef\u7528\u7684\u7d22\u5f15\u3002</p> <pre><code># name \u5217\u5305\u542b\u4e86\u4e24\u4e2a\u7d22\u5f15\uff0c\u4f46\u662f\u9ed8\u8ba4\u4f7f\u7528\u4e86idx_seller_name_sta_addr\nmysql [test]&gt;EXPLAIN  SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280';\n+----+-------------+-----------+------------+------+------------------------------------------+--------------------------+---------+-------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys                            | key                      | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+------------------------------------------+--------------------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr,idx_seller_name | idx_seller_name_sta_addr | 403     | const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+------------------------------------------+--------------------------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n# \u4f7f\u7528USE INDEX\u6307\u5b9a\u671f\u671b\u4f7f\u7528\u7684\u7d22\u5f15\nmysql [test]&gt;EXPLAIN  SELECT * FROM tb_seller USE INDEX (idx_seller_name) WHERE name = '\u5c0f\u7c73\u79d1\u6280';\n+----+-------------+-----------+------------+------+-----------------+-----------------+---------+-------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys   | key             | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+-----------------+-----------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name | idx_seller_name | 403     | const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+-----------------+-----------------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#2-ignore-index","title":"2. IGNORE INDEX","text":"<p>\u5982\u679c\u7528\u6237\u53ea\u662f\u5355\u7eaf\u7684\u60f3\u8ba9MySQL\u5ffd\u7565\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7d22\u5f15\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528<code>ignore index</code>\u4f5c\u4e3ahint \u3002</p> <pre><code>mysql [test]&gt;EXPLAIN  SELECT * FROM tb_seller IGNORE INDEX (idx_seller_name) WHERE name = '\u5c0f\u7c73\u79d1\u6280';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 403     | const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------+\n</code></pre>"},{"location":"databases/MySQL/SQL%E4%BC%98%E5%8C%96/#3-force-index","title":"3. FORCE INDEX","text":"<p>\u4e3a\u5f3a\u5236MySQL\u4f7f\u7528\u4e00\u4e2a\u7279\u5b9a\u7684\u7d22\u5f15\uff0c\u53ef\u5728\u67e5\u8be2\u4e2d\u4f7f\u7528 force index \u4f5c\u4e3ahint \u3002 </p> <pre><code># MySQL\u8bc4\u4f30\u4f7f\u7528\u7d22\u5f15\u6bd4\u5168\u8868\u66f4\u6162\uff0c\u5219\u4e0d\u4f7f\u7528\u7d22\u5f15\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys      | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | idx_seller_address | NULL | NULL    | NULL |   12 |    91.67 | Using where |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n# USE INDEX \u53ea\u662f\u63d0\u4f9b\u4e00\u4e2a\u53c2\u8003\uff0c\u4f46\u662f\u5168\u8868\u626b\u63cf\u66f4\u5feb\uff0c\u5e76\u662f\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller USE INDEX(idx_seller_address) WHERE address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys      | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | idx_seller_address | NULL | NULL    | NULL |   12 |    91.67 | Using where |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n# \u4f7f\u7528FORCE  INDEX\u5f3a\u5236mysql\u4f7f\u7528\u7d22\u5f15\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller FORCE  INDEX(idx_seller_address) WHERE address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys      | key                | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_address | idx_seller_address | 403     | const |   11 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/","title":"\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570","text":"<p>\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u662f  \u4e8b\u5148\u7ecf\u8fc7\u7f16\u8bd1\u5e76\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\u7684\u4e00\u6bb5 SQL \u8bed\u53e5\u7684\u96c6\u5408\uff0c\u8c03\u7528\u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u53ef\u4ee5\u7b80\u5316\u5e94\u7528\u5f00\u53d1\u4eba\u5458\u7684\u5f88\u591a\u5de5\u4f5c\uff0c\u51cf\u5c11\u6570\u636e\u5728\u6570\u636e\u5e93\u548c\u5e94\u7528\u670d\u52a1\u5668\u4e4b\u95f4\u7684\u4f20\u8f93\uff0c\u5bf9\u4e8e\u63d0\u9ad8\u6570\u636e\u5904\u7406\u7684\u6548\u7387\u662f\u6709\u597d\u5904\u7684\u3002    </p> <p>\u200b   \u5b58\u50a8\u8fc7\u7a0b\u548c\u51fd\u6570\u7684\u533a\u522b\u5728\u4e8e\u51fd\u6570\u5fc5\u987b\u6709\u8fd4\u56de\u503c\uff0c\u800c\u5b58\u50a8\u8fc7\u7a0b\u6ca1\u6709\u3002</p>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#_2","title":"\u4e00\u3001\u51fd\u6570","text":"<p>\u597d\u5904\uff1a</p> <ol> <li>\u9690\u85cf\u4e86\u5b9e\u73b0\u7ec6\u8282</li> <li>\u63d0\u9ad8\u4ee3\u7801\u7684\u91cd\u7528\u6027</li> </ol> <p>\u8c03\u7528\uff1a</p> <pre><code>SELECT \u51fd\u6570\u540d(\u5b9e\u53c2\u5217\u8868) [FROM \u8868];\n</code></pre> <p>\u5206\u7c7b\uff1a</p> <ol> <li>\u5355\u884c\u51fd\u6570\uff1a \u5982concat\u3001length\u3001ifnull\u7b49</li> <li>\u5206\u7ec4\u51fd\u6570\uff1a\u505a\u7edf\u8ba1\u4f7f\u7528\uff0c\u53c8\u79f0\u4e3a\u7edf\u8ba1\u51fd\u6570\u3001\u805a\u5408\u51fd\u6570\u3001\u7ec4\u51fd\u6570</li> </ol>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#1","title":"1. \u5355\u884c\u51fd\u6570","text":""},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#11","title":"1.1 \u5b57\u7b26\u51fd\u6570","text":""},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#1-concat","title":"1. <code>CONCAT</code>\u62fc\u63a5\u5b57\u7b26","text":"<pre><code>SELECT CONCAT(first_name,\" \",last_name) \u59d3\u540d FROM employees;\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#2length","title":"2.<code>LENGTH</code>\u83b7\u53d6\u5b57\u8282\u957f\u5ea6","text":"<pre><code>mysql [(none)]&gt;SELECT LENGTH('hello \u5317\u4eac');\n+------------------------+\n| LENGTH('hello \u5317\u4eac')   |\n+------------------------+\n|                     12 |\n+------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#3char_length","title":"3.<code>CHAR_LENGTH</code> \u83b7\u53d6\u5b57\u7b26\u4e2a\u6570","text":"<pre><code>mysql [(none)]&gt;SELECT CHAR_LENGTH('hello \u5317\u4eac');\n+-----------------------------+\n| CHAR_LENGTH('hello \u5317\u4eac')   |\n+-----------------------------+\n|                           8 |\n+-----------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#4-substring","title":"4. <code>SUBSTRING</code> \u622a\u53d6\u5b50\u4e32","text":"<p>\u6ce8\u610f\uff1a\u8d77\u59cb\u7d22\u5f15\u4ece1\u5f00\u59cb\uff01</p> <p><code>SUBSTR(str,\u8d77\u59cb\u7d22\u5f15\uff0c\u622a\u53d6\u7684\u5b57\u7b26\u957f\u5ea6)</code></p> <p><code>SUBSTR(str,\u8d77\u59cb\u7d22\u5f15)</code></p> <pre><code>mysql [(none)]&gt;SELECT SUBSTR('\u5f20\u4e09\u4e30\u7231\u4e0a\u4e86\u90ed\u8944',1,3);\n+----------------------------------------+\n| SUBSTR('\u5f20\u4e09\u4e30\u7231\u4e0a\u4e86\u90ed\u8944',1,3)         |\n+----------------------------------------+\n| \u5f20\u4e09\u4e30                                 |\n+----------------------------------------+\nmysql [(none)]&gt;SELECT SUBSTR('\u5f20\u4e09\u4e30\u7231\u4e0a\u4e86\u90ed\u8944',7);\n+--------------------------------------+\n| SUBSTR('\u5f20\u4e09\u4e30\u7231\u4e0a\u4e86\u90ed\u8944',7)         |\n+--------------------------------------+\n| \u90ed\u8944                                 |\n+--------------------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#5-instr","title":"5. <code>INSTR</code>\u83b7\u53d6\u5b57\u7b26\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u7d22\u5f15","text":"<pre><code>mysql [(none)]&gt;mysql [(none)]&gt;SELECT INSTR('\u5b59\u609f\u7a7a\u5927\u6218\u732a\u516b\u6212\uff0c\u732a\u516b\u6212\u5927\u6218\u5b59\u609f\u7a7a','\u732a\u516b\u6212') AS output;\n+--------+\n| output |\n+--------+\n|      6 |\n+--------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#6-trim","title":"6. <code>TRIM</code>\u53bb\u524d\u540e\u6307\u5b9a\u7684\u5b57\u7b26\uff0c\u9ed8\u8ba4\u662f\u53bb\u7a7a\u683c","text":"<pre><code>mysql [(none)]&gt;SELECT TRIM('    \u865a\u7af9    ')  AS output;\n+--------+\n| output |\n+--------+\n| \u865a\u7af9   |\n+--------+\nmysql [(none)]&gt;SELECT TRIM('x' FROM 'xxx\u865axxx\u7af9xxx')  AS output;\n+-----------+\n| output    |\n+-----------+\n| \u865axxx\u7af9   |\n+-----------+\n</code></pre> <p>7.<code>LPAD</code>/<code>RPAD</code> \u5de6\u586b\u5145/\u53f3\u586b\u5145</p> <pre><code>mysql [(none)]&gt;SELECT LPAD('\u6728\u5a49\u6e05',10,'x');\n+--------------------------+\n| LPAD('\u6728\u5a49\u6e05',10,'x')    |\n+--------------------------+\n| xxxxxxx\u6728\u5a49\u6e05            |\n+--------------------------+\nmysql [(none)]&gt;SELECT RPAD('\u6728\u5a49\u6e05',10,'x');\n+--------------------------+\n| RPAD('\u6728\u5a49\u6e05',10,'x')    |\n+--------------------------+\n| \u6728\u5a49\u6e05xxxxxxx            |\n+--------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#8upperlower","title":"8.<code>UPPER</code>/<code>LOWER</code> \u53d8\u5927\u5199/\u53d8\u5c0f\u5199","text":"<pre><code>SELECT CONCAT(UPPER(SUBSTR(first_name,1,1)),LOWER(SUBSTR(first_name,2)),'_',UPPER(last_name)) \"OUTPUT\" FROM myemployees.employees;\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#9strcmp","title":"9.<code>STRCMP</code> \u6bd4\u8f83\u4e24\u4e2a\u5b57\u7b26\u5927\u5c0f","text":"<pre><code>mysql [(none)]&gt;SELECT STRCMP('aec','aec');\n+---------------------+\n| STRCMP('aec','aec') |\n+---------------------+\n|                   0 |\n+---------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#10leftright","title":"10.<code>LEFT</code>/<code>RIGHT</code> \u622a\u53d6\u5b50\u4e32","text":"<pre><code>mysql [(none)]&gt;SELECT LEFT('\u9e20\u6469\u667a',1);\n+---------------------+\n| LEFT('\u9e20\u6469\u667a',1)    |\n+---------------------+\n| \u9e20                  |\n+---------------------+\nmysql [(none)]&gt;SELECT RIGHT('\u9e20\u6469\u667a',1);\n+----------------------+\n| RIGHT('\u9e20\u6469\u667a',1)    |\n+----------------------+\n| \u667a                   |\n+----------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#12","title":"1.2 \u6570\u5b66\u51fd\u6570","text":""},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#1-abs","title":"1. <code>ABS</code> \u7edd\u5bf9\u503c","text":"<pre><code>mysql [(none)]&gt;SELECT ABS(-2.4);\n+-----------+\n| ABS(-2.4) |\n+-----------+\n|       2.4 |\n+-----------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#2-cei","title":"2. <code>CEI</code> \u5411\u4e0a\u53d6\u6574 \u8fd4\u56de&gt;=\u8be5\u53c2\u6570\u7684\u6700\u5c0f\u6574\u6570","text":"<pre><code>mysql [(none)]&gt;SELECT CEIL(-1.09),CEIL(0.09),CEIL(1.00);\n+-------------+------------+------------+\n| CEIL(-1.09) | CEIL(0.09) | CEIL(1.00) |\n+-------------+------------+------------+\n|          -1 |          1 |          1 |\n+-------------+------------+------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#3-floor","title":"3. <code>FLOOR</code> \u5411\u4e0b\u53d6\u6574\uff0c\u8fd4\u56de&lt;=\u8be5\u53c2\u6570\u7684\u6700\u5927\u6574\u6570","text":"<pre><code>mysql [(none)]&gt;SELECT FLOOR(-1.09), FLOOR(0.09), FLOOR(1.00);\n+--------------+-------------+-------------+\n| FLOOR(-1.09) | FLOOR(0.09) | FLOOR(1.00) |\n+--------------+-------------+-------------+\n|           -2 |           0 |           1 |\n+--------------+-------------+-------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#4-round","title":"4. <code>ROUND</code> \u56db\u820d\u4e94\u5165","text":"<pre><code>mysql [(none)]&gt;SELECT ROUND(1.8712345), ROUND(1.8712345,2);\n+------------------+--------------------+\n| ROUND(1.8712345) | ROUND(1.8712345,2) |\n+------------------+--------------------+\n|                2 |               1.87 |\n+------------------+--------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#5-truncate","title":"5. <code>TRUNCATE</code> \u622a\u65ad","text":"<pre><code>mysql [(none)]&gt;SELECT TRUNCATE(1.8712345,1);\n+-----------------------+\n| TRUNCATE(1.8712345,1) |\n+-----------------------+\n|                   1.8 |\n+-----------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#6-mod","title":"6. <code>MOD</code> \u53d6\u4f59","text":"<pre><code># \u4e24\u79cd\u65b9\u5f0f\nmysql [(none)]&gt;SELECT MOD(-10,3), -10%3, 10%3;\n+------------+-------+------+\n| MOD(-10,3) | -10%3 | 10%3 |\n+------------+-------+------+\n|         -1 |    -1 |    1 |\n+------------+-------+------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#13","title":"1.3 \u65e5\u671f\u51fd\u6570","text":""},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#1-now","title":"1. <code>NOW()</code>","text":"<pre><code># \u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u65e5\u671f+\u65f6\u95f4 \nmysql [(none)]&gt;SELECT NOW();\n+---------------------+\n| NOW()               |\n+---------------------+\n| 2020-12-09 22:45:12 |\n+---------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#2curdate","title":"2.<code>CURDATE()</code>","text":"<pre><code># \u8fd4\u56de\u5f53\u524d\u7cfb\u7edf\u65e5\u671f\uff0c\u4e0d\u5305\u542b\u65f6\u95f4 \nmysql [(none)]&gt;SELECT CURDATE();\n+------------+\n| CURDATE()  |\n+------------+\n| 2020-12-09 |\n+------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#3-curtime","title":"3. <code>CURTIME()</code>","text":"<pre><code># \u8fd4\u56de\u5f53\u524d\u65f6\u95f4\uff0c\u4e0d\u5305\u542b\u65e5\u671f\nmysql [(none)]&gt;SELECT CURTIME();\n+-----------+\n| CURTIME() |\n+-----------+\n| 22:47:45  |\n+-----------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#4-datediff","title":"4. <code>DATEDIFF()</code>","text":"<pre><code># \u8fd4\u56de\u4e24\u4e2a\u65e5\u671f\u76f8\u5dee\u7684\u5929\u6570\nmysql [(none)]&gt;SELECT DATEDIFF('2018-7-16','2019-7-13');\n+-----------------------------------+\n| DATEDIFF('2018-7-16','2019-7-13') |\n+-----------------------------------+\n|                              -362 |\n+-----------------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#5-date_format","title":"5. <code>DATE_FORMAT()</code>","text":"<pre><code># \u5c06\u65e5\u671f\u8f6c\u6362\u6210\u5b57\u7b26\u4e32 \nmysql [(none)]&gt;SELECT DATE_FORMAT('1998-7-16','%Y\u5e74%m\u6708%d\u65e5 %H\u5c0f\u65f6%i\u5206\u949f%s\u79d2') \u51fa\u751f\u65e5\u671f;\n+-----------------------------------------+\n| \u51fa\u751f\u65e5\u671f                                |\n+-----------------------------------------+\n| 1998\u5e7407\u670816\u65e5 00\u5c0f\u65f600\u5206\u949f00\u79d2         |\n+-----------------------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#6-str_to_date","title":"6. <code>STR_TO_DATE()</code>","text":"<pre><code># \u6309\u6307\u5b9a\u683c\u5f0f\u89e3\u6790\u5b57\u7b26\u4e32\u4e3a\u65e5\u671f\u7c7b\u578b\nmysql [(none)]&gt;SELECT STR_TO_DATE('1998 3/2', '%Y %c/%d') AS output ;\n+------------+\n| output     |\n+------------+\n| 1998-03-02 |\n+------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#14","title":"1.4  \u7cfb\u7edf\u4fe1\u606f\u51fd\u6570","text":"<pre><code>SELECT VERSION();   # \u5f53\u524d\u6570\u636e\u5e93\u670d\u52a1\u5668\u7684\u7248\u672c\nSELECT DATABASE();  # \u5f53\u524d\u6253\u5f00\u7684\u6570\u636e\u5e93\nSELECT USER();      # \u5f53\u524d\u7528\u6237\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#15","title":"1.5 \u52a0\u5bc6\u51fd\u6570","text":"<pre><code>SELECT password('123456');\nSELECT md5('123456');\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#2","title":"2. \u6d41\u7a0b\u63a7\u5236\u51fd\u6570","text":""},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#1-if","title":"1. <code>IF</code>\u51fd\u6570","text":"<pre><code>mysql [(none)]&gt;SELECT IF(100&gt;9,'\u597d','\u574f');\n+-----------------------+\n| IF(100&gt;9,'\u597d','\u574f')   |\n+-----------------------+\n| \u597d                    |\n+-----------------------+\n# \u5982\u679c\u6709\u5956\u91d1\uff0c\u5219\u663e\u793a\u6700\u7ec8\u5956\u91d1\uff0c\u5982\u679c\u6ca1\u6709\uff0c\u5219\u663e\u793a0\nSELECT IF(commission_pct IS NULL,0,salary*12*commission_pct)  \u5956\u91d1,commission_pct\nFROM employees;\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#2-case","title":"2. <code>CASE</code>\u51fd\u6570","text":""},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#21-1switch","title":"2.1 \u4f7f\u75281\uff1a\u7c7b\u4f3c\u4e8eswitch\u8bed\u53e5\uff0c\u53ef\u4ee5\u5b9e\u73b0\u7b49\u503c\u5224\u65ad","text":"<p>\u8bed\u6cd5</p> <pre><code>CASE \u8981\u5224\u65ad\u7684\u5b57\u6bb5\u6216\u8868\u8fbe\u5f0f\nWHEN \u5e38\u91cf1 THEN \u8981\u663e\u793a\u7684\u503c1\u6216\u8bed\u53e51;\nWHEN \u5e38\u91cf2 THEN \u8981\u663e\u793a\u7684\u503c2\u6216\u8bed\u53e52;\n...\nELSE \u8981\u663e\u793a\u7684\u503cn\u6216\u8bed\u53e5n;\nEND\n</code></pre> <p>\u6848\u4f8b\uff1a</p> <pre><code># \u90e8\u95e8\u7f16\u53f7\u662f30\uff0c\u5de5\u8d44\u663e\u793a\u4e3a2\u500d\n# \u90e8\u95e8\u7f16\u53f7\u662f50\uff0c\u5de5\u8d44\u663e\u793a\u4e3a3\u500d\n# \u90e8\u95e8\u7f16\u53f7\u662f60\uff0c\u5de5\u8d44\u663e\u793a\u4e3a4\u500d\n# \u5426\u5219\u4e0d\u53d8\n\n# \u663e\u793a \u90e8\u95e8\u7f16\u53f7\uff0c\u65b0\u5de5\u8d44\uff0c\u65e7\u5de5\u8d44\nSELECT department_id,salary,\nCASE department_id\nWHEN 30 THEN salary*2\nWHEN 50 THEN salary*3\nWHEN 60 THEN salary*4\nELSE salary\nEND  newSalary\nFROM employees;\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#22-2if","title":"2.2 \u4f7f\u75282\uff1a\u7c7b\u4f3c\u4e8e\u591a\u91cdIF\u8bed\u53e5\uff0c\u5b9e\u73b0\u533a\u95f4\u5224\u65ad","text":"<p>\u8bed\u6cd5</p> <pre><code>CASE \nWHEN \u6761\u4ef61 THEN \u8981\u663e\u793a\u7684\u503c1\u6216\u8bed\u53e51\nWHEN \u6761\u4ef62 THEN \u8981\u663e\u793a\u7684\u503c2\u6216\u8bed\u53e52\n...\nELSE \u8981\u663e\u793a\u7684\u503cn\u6216\u8bed\u53e5n\nEND\n</code></pre> <p>\u6848\u4f8b\uff1a</p> <pre><code># \u5de5\u8d44&gt;20000,\u663e\u793a\u7ea7\u522bA\n# \u5de5\u8d44&gt;15000,\u663e\u793a\u7ea7\u522bB\n# \u5de5\u8d44&gt;10000,\u663e\u793a\u7ea7\u522bC\n# \u5426\u5219\uff0c\u663e\u793aD\nSELECT salary,\nCASE \nWHEN salary&gt;20000 THEN 'A'\nWHEN salary&gt;15000 THEN 'B'\nWHEN salary&gt;10000 THEN 'C'\nELSE 'D'\nEND\nAS  \u5de5\u8d44\u7ea7\u522b\nFROM employees;  \n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#3","title":"3. \u5206\u7ec4\u51fd\u6570","text":"<p>\u529f\u80fd\uff1a\u7528\u4f5c\u7edf\u8ba1\u4f7f\u7528\uff0c\u53c8\u79f0\u4e3a\u805a\u5408\u51fd\u6570\u6216\u7edf\u8ba1\u51fd\u6570\u6216\u7ec4\u51fd\u6570</p> <p>\u5206\u7c7b\uff1asum() \u6c42\u548c\u3001avg() \u5e73\u5747\u503c\u3001max() \u6700\u5927\u503c\u3001min() \u6700\u5c0f\u503c\u3001count() \u8ba1\u6570\uff08\u975e\u7a7a\uff09</p> <p>\u7279\u70b9\uff1a</p> <ol> <li>sum\u3001avg\u4e00\u822c\u7528\u4e8e\u5904\u7406\u6570\u503c\u578b\u6570\u636e</li> <li>max\u3001min\u3001count\u53ef\u4ee5\u5904\u7406\u4efb\u4f55\u7c7b\u578b\u6570\u636e</li> <li>\u4ee5\u4e0a\u5206\u7ec4\u51fd\u6570\u90fd\u5ffd\u7565null\u503c</li> </ol> <pre><code># \u67e5\u8be2\u5458\u5de5\u4fe1\u606f\u8868\u4e2d\uff0c\u6240\u6709\u5458\u5de5\u7684\u5de5\u8d44\u548c\u3001\u5de5\u8d44\u5e73\u5747\u503c\u3001\u6700\u4f4e\u5de5\u8d44\u3001\u6700\u9ad8\u5de5\u8d44\u3001\u6709\u5de5\u8d44\u7684\u4e2a\u6570\nmysql [myemployees]&gt;SELECT SUM(salary),AVG(salary),MIN(salary),MAX(salary),COUNT(salary) FROM employees;\n+-------------+-------------+-------------+-------------+---------------+\n| SUM(salary) | AVG(salary) | MIN(salary) | MAX(salary) | COUNT(salary) |\n+-------------+-------------+-------------+-------------+---------------+\n|   691400.00 | 6461.682243 |     2100.00 |    24000.00 |           107 |\n+-------------+-------------+-------------+-------------+---------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0/#31-count","title":"3.1 <code>COUNT()</code>","text":"<p>1 \u7edf\u8ba1\u7ed3\u679c\u96c6\u7684\u884c\u6570\uff0c\u63a8\u8350\u4f7f\u7528count(*)</p> <pre><code>mysql [myemployees]&gt;SELECT COUNT(*) FROM employees;\n+----------+\n| COUNT(*) |\n+----------+\n|      107 |\n+----------+\n</code></pre> <p>2 \u642d\u914ddistinct\u5b9e\u73b0\u53bb\u91cd\u7684\u7edf\u8ba1</p> <pre><code>mysql [myemployees]&gt;SELECT COUNT(DISTINCT department_id) FROM employees;\n+-------------------------------+\n| COUNT(DISTINCT department_id) |\n+-------------------------------+\n|                            11 |\n+-------------------------------+\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/","title":"\u5b89\u88c5","text":""},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#_1","title":"\u4e00\u3001\u5b89\u88c5","text":"<p>\u5b89\u88c5\u73af\u5883</p> <pre><code>root@ubuntu:~# lsb_release -ir\nDistributor ID: Ubuntu\nRelease:    18.04\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#1","title":"1. \u4e0b\u8f7d\u4e8c\u8fdb\u5236\u5305","text":"<p>\u5b98\u65b9\u4e0b\u8f7d\u5730\u5740\uff1ahttps://downloads.mysql.com/archives/community/</p> <p>\u6e05\u534e\u6e90\u4e0b\u8f7d\u5730\u5740\uff1ahttps://mirrors.tuna.tsinghua.edu.cn/mysql/downloads/MySQL-5.7/</p> <pre><code>root@ubuntu:~# wget https://cdn.mysql.com/archives/mysql-5.7/mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz\nroot@ubuntu:~# ls\nmysql-5.7.28-linux-glibc2.12-x86_64.tar.gz\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#2","title":"2. \u89e3\u538b","text":"<pre><code>root@ubuntu:~# mkdir /app\nroot@ubuntu:~# tar zxf mysql-5.7.28-linux-glibc2.12-x86_64.tar.gz -C /app/\nroot@ubuntu:~# mv /app/mysql-5.7.28-linux-glibc2.12-x86_64 /app/mysql\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#3","title":"3. \u6dfb\u52a0\u73af\u5883\u53d8\u91cf","text":"<pre><code>root@ubuntu:~# echo \"export PATH=/app/mysql/bin:$PATH\" &gt;&gt; /etc/profile\nroot@ubuntu:~# source /etc/profile\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#4-mysql","title":"4. \u521b\u5efa<code>mysql</code>\u7528\u6237","text":"<pre><code>root@ubuntu:~# groupadd mysql\nroot@ubuntu:~# useradd -r -g mysql -s /bin/false mysql\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#5","title":"5. \u521b\u5efa\u6570\u636e\u76ee\u5f55\u5e76\u6388\u6743","text":"<pre><code>root@ubuntu:~# mkdir -p /data/mysql\nroot@ubuntu:~# chown -R mysql:mysql /app/mysql/\nroot@ubuntu:~# chown -R mysql:mysql /data/mysql/\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#6","title":"6. \u521d\u59cb\u5316\u6570\u636e\u5e93","text":"<pre><code>root@ubuntu:/app/mysql# mysqld --initialize --user=mysql --basedir=/app/mysql --datadir=/data/mysql\n2020-12-07T13:18:00.977363Z 0 [Warning] TIMESTAMP with implicit DEFAULT value is deprecated. Please use --explicit_defaults_for_timestamp server option (see documentation for more details).\n2020-12-07T13:18:01.354479Z 0 [Warning] InnoDB: New log files created, LSN=45790\n2020-12-07T13:18:01.440633Z 0 [Warning] InnoDB: Creating foreign key constraint system tables.\n2020-12-07T13:18:01.517152Z 0 [Warning] No existing UUID has been found, so we assume that this is the first time that this server has been started. Generating a new UUID: a1c032f1-388e-11eb-8df1-000c2925b751.\n2020-12-07T13:18:01.518560Z 0 [Warning] Gtid table is not ready to be used. Table 'mysql.gtid_executed' cannot be opened.\n2020-12-07T13:18:04.839325Z 0 [Warning] CA certificate ca.pem is self signed.\n2020-12-07T13:18:05.874593Z 1 [Note] A temporary password is generated for root@localhost: /D+(Gsb&lt;w3hH\n</code></pre> <p>\u751f\u6210\u7684\u6570\u636e\u76ee\u5f55\u7ed3\u6784</p> <pre><code>root@ubuntu:/data/mysql# tree -LF 1\n.\n\u251c\u2500\u2500 auto.cnf\n\u251c\u2500\u2500 ca-key.pem\n\u251c\u2500\u2500 ca.pem\n\u251c\u2500\u2500 client-cert.pem\n\u251c\u2500\u2500 client-key.pem\n\u251c\u2500\u2500 ib_buffer_pool\n\u251c\u2500\u2500 ibdata1\n\u251c\u2500\u2500 ib_logfile0\n\u251c\u2500\u2500 ib_logfile1\n\u251c\u2500\u2500 mysql/\n\u251c\u2500\u2500 performance_schema/\n\u251c\u2500\u2500 private_key.pem\n\u251c\u2500\u2500 public_key.pem\n\u251c\u2500\u2500 server-cert.pem\n\u251c\u2500\u2500 server-key.pem\n\u2514\u2500\u2500 sys/\n\n3 directories, 13 files\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#7","title":"7. \u5b89\u88c5\u51fa\u73b0\u7684\u9519\u8bef","text":"<pre><code>root@ubuntu:/app/mysql# mysqld --initialize --user=mysql --basedir=/app/mysql --datadir=/data/mysql\nmysqld: error while loading shared libraries: libaio.so.1: cannot open shared object file: No such file or director\n# \u89e3\u51b3\u65b9\u6cd5\nroot@ubuntu:/app/mysql# apt install -y libaio-dev\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#8","title":"8. \u914d\u7f6e\u6587\u4ef6","text":"<pre><code>root@gp:~# cat /etc/my.cnf\n[mysqld]\nuser=mysql\nbasedir=/app/mysql # mysql\u8f6f\u4ef6\u6240\u5728\u4f4d\u7f6e\ndatadir=/data/mysql # mysql\u6570\u636e\u5b58\u653e\u8def\u5f84\nserver_id=1 # 1-65535\nport=3306\nlog_error=/var/log/mysql/mysql.err # \u9519\u8bef\u65e5\u5fd7\u6587\u4ef6\u4f4d\u7f6e\uff0c\u6ce8\u610f\u7ed9\u76ee\u5f55\u8d4b\u6743\nsocket=/tmp/mysql.sock # \u5957\u63a5\u5b57\u6587\u4ef6\u4f4d\u7f6e\n[mysql]\nsocket=/tmp/mysql.sock\nprompt=mysql [\\\\d]&gt; # \u8fde\u63a5\u5230mysql\u65f6\u663e\u793a\u7684\u540d\u79f0'3306 [(none)]&gt;'\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#9","title":"9. \u542f\u52a8\u4e0e\u505c\u6b62","text":""},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#91","title":"9.1 \u542f\u52a8","text":"<pre><code>root@ubuntu:~# mkdir  /var/log/mysql\nroot@ubuntu:~# chown mysql:mysql /var/log/mysql\nroot@ubuntu:~# /app/mysql/support-files/mysql.server start\nStarting MySQL\n.Logging to '/var/log/mysql/mysql.err'.\n *\nroot@ubuntu:~# ps aux | grep mysql\nroot      13521  0.1  0.0   4636  1820 pts/0    S    21:22   0:00 /bin/sh /app/mysql/bin/mysqld_safe --datadir=/data/mysql --pid-file=/data/mysql/ubuntu.pid\nmysql     13699  2.4  9.0 1324608 182216 pts/0  Sl   21:22   0:00 /app/mysql/bin/mysqld --basedir=/app/mysql --datadir=/data/mysql --plugin-dir=/app/mysql/lib/plugin --user=mysql --log-error=/var/log/mysql/mysql.err --pid-file=/data/mysql/ubuntu.pid --socket=/tmp/mysql.sock --port=3306\nroot      13729  0.0  0.0  13144  1076 pts/0    S+   21:23   0:00 grep --color=auto mysql \n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#92","title":"9.2 \u505c\u6b62","text":"<pre><code>root@ubuntu:~# /app/mysql/support-files/mysql.server stop\nShutting down MySQL\n.. * \n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#10","title":"10. \u4fee\u6539\u521d\u59cb\u5bc6\u7801","text":"<pre><code>root@ubuntu:~# mysqladmin -u root -p password\nEnter password:      # \u8f93\u5165\u521d\u59cb\u5316\u65f6\u65e5\u5fd7\u4e2d\u7684\u5bc6\u7801/D+(Gsb&lt;w3hH\nNew password:        # \u8f93\u5165\u65b0\u5bc6\u7801\nConfirm new password:  # \u518d\u6b21\u8f93\u5165\u65b0\u5bc6\u7801\nWarning: Since password will be sent to server in plain text, use ssl connection to ensure password safety.\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#11-mysql57","title":"11. MySQL5.7\u7684\u7279\u70b9","text":"<p>\u5f15\u5165\u4e86\u65b0\u7684\u5b89\u5168\u673a\u5236</p> <ol> <li>\u521d\u59cb\u5316\u5b8c\u6210\u540e\u4f1a\u751f\u6210\u4e34\u65f6\u5bc6\u7801</li> <li>\u5bc6\u7801\u590d\u6742\u5ea6\uff1a\u957f\u5ea6\u8d85\u8fc712\u4f4d</li> <li>\u5bc6\u7801\u8fc7\u671f\u65f6\u95f4180\u5929</li> </ol>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#mysql","title":"\u4e8c\u3001MySQL\u8fde\u63a5","text":""},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#1-socket","title":"1. socket\u8fde\u63a5","text":"<pre><code># \u9ed8\u8ba4\u4f7f\u7528socket\u8fde\u63a5 -S /tmp/mysql.sock\u53ef\u4ee5\u4e0d\u52a0\nroot@ubuntu:~# mysql -uroot -p -S /tmp/mysql.sock\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#2-tcpip","title":"2. TCP/IP\u8fde\u63a5","text":"<pre><code>root@ubuntu:~# mysql -h 10.0.0.131 -P 3306 -uroot -p\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#3-sql","title":"3. \u514d\u4ea4\u4e92\u6267\u884cSQL\u8bed\u53e5","text":"<pre><code>root@ubuntu:~# mysql -u root -proot -e \"show databases;\"\n</code></pre>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#_2","title":"\u4e09\u3001\u521d\u59cb\u5316\u914d\u7f6e","text":""},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#1_1","title":"1. \u521d\u59cb\u5316\u914d\u7f6e\u7684\u65b9\u6cd5","text":"<ol> <li>\u9884\u7f16\u8bd1</li> <li>\u914d\u7f6e\u6587\u4ef6</li> <li>\u547d\u4ee4\u884c\uff08\u4ec5\u9650\u4e8emysqld\u548cmysqld_safe\uff09</li> </ol>"},{"location":"databases/MySQL/%E5%AE%89%E8%A3%85/#2_1","title":"2. \u521d\u59cb\u5316\u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6\u8bfb\u53d6\u987a\u5e8f</p> <pre><code>root@ubuntu:~#:~# mysqld --help --verbose | grep my.cnf\n/etc/my.cnf /etc/mysql/my.cnf /usr/local/mysql/etc/my.cnf ~/.my.cnf\n                      my.cnf, $MYSQL_TCP_PORT, /etc/services, built-in default\n</code></pre> <p>\u5982\u679c--defaults-file\u6307\u5b9a\u4e86\u914d\u7f6e\u6587\u4ef6\uff0c\u4ee5\u4e0a\u6587\u4ef6\u90fd\u4e0d\u4f1a\u88ab\u8bfb\u53d6\u3002</p> <p>\u914d\u7f6e\u6587\u4ef6\u683c\u5f0f\uff1a</p> <pre><code>[\u6807\u7b7e]\n\u914d\u7f6e\u9879=\u503c\n# \u6807\u7b7e\u7c7b\u578b\uff1a\u670d\u52a1\u7aef\u3001\u5ba2\u6237\u7aef\n# \u670d\u52a1\u7aef\u6807\u7b7e\uff1a[mysqld]\u3001[mysqld_safe]\u3001[server]\n# \u5ba2\u6237\u7aef\u6807\u7b7e\uff1a[mysql]\u3001[mysqldump]\u3001[client]\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/","title":"\u6267\u884c\u8ba1\u5212","text":"<p>\u4f7f\u7528 <code>EXPLAIN</code> \u5173\u952e\u5b57\u53ef\u4ee5\u6a21\u62df\u4f18\u5316\u5668\u6267\u884c <code>SQL</code> \u8bed\u53e5\uff0c\u5e76\u5206\u6790\u67e5\u8be2\u8bed\u53e5\u7684\u6027\u80fd\u74f6\u9888\u3002 </p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#_1","title":"\u4e00\u3001\u73af\u5883\u51c6\u5907","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#1","title":"1. \u521b\u5efa\u8868","text":"<pre><code># \u521b\u5efa\u89d2\u8272\u8868\nCREATE TABLE `t_role` (\n  `id` varchar(32) NOT NULL,\n  `role_name` varchar(255) DEFAULT NULL,\n  `role_code` varchar(255) DEFAULT NULL,\n  `description` varchar(255) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `unique_role_name` (`role_name`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n# \u521b\u5efa\u7528\u6237\u8868\nCREATE TABLE `t_user` (\n  `id` varchar(32) NOT NULL,\n  `username` varchar(45) NOT NULL,\n  `password` varchar(96) NOT NULL,\n  `name` varchar(45) NOT NULL,\n  PRIMARY KEY (`id`),\n  UNIQUE KEY `unique_user_username` (`username`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n\n# \u521b\u5efa\u591a\u5bf9\u591a\u5173\u8054\u8868\nCREATE TABLE `user_role` (\n  `id` int(11) NOT NULL auto_increment ,\n  `user_id` varchar(32) DEFAULT NULL,\n  `role_id` varchar(32) DEFAULT NULL,\n  PRIMARY KEY (`id`),\n  KEY `fk_ur_user_id` (`user_id`),\n  KEY `fk_ur_role_id` (`role_id`),\n  CONSTRAINT `fk_ur_role_id` FOREIGN KEY (`role_id`) REFERENCES `t_role` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,\n  CONSTRAINT `fk_ur_user_id` FOREIGN KEY (`user_id`) REFERENCES `t_user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION\n) ENGINE=InnoDB DEFAULT CHARSET=utf8;\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#2","title":"2. \u63d2\u5165\u6570\u636e","text":"<pre><code>INSERT INTO `t_user` (`id`, `username`, `password`, `name`) VALUES('1','\u674e\u900d\u9065','$2a$10$TJ4TmCdK.X4wv/tCqHW14.w70U3CC33CeVncD3SLmyMXMknstqKRe','\u674e\u900d\u9065');\nINSERT INTO `t_user` (`id`, `username`, `password`, `name`) VALUES('2','\u91cd\u697c','$2a$10$TJ4TmCdK.X4wv/tCqHW14.w70U3CC33CeVncD3SLmyMXMknstqKRe','\u91cd\u697c');\nINSERT INTO `t_user` (`id`, `username`, `password`, `name`) VALUES('3','\u5f90\u957f\u537f','$2a$10$8qmaHgUFUAmPR5pOuWhYWOr291WJYjHelUlYn07k5ELF8ZCrW0Cui','\u5f90\u957f\u537f');\nINSERT INTO `t_user` (`id`, `username`, `password`, `name`) VALUES('4','\u7d2b\u8431','$2a$10$pLtt2KDAFpwTWLjNsmTEi.oU1yOZyIn9XkziK/y/spH5rftCpUMZa','\u7d2b\u8431');\nINSERT INTO `t_user` (`id`, `username`, `password`, `name`) VALUES('5','\u9f99\u8475','$2a$10$nxPKkYSez7uz2YQYUnwhR.z57km3yqKn3Hr/p1FR6ZKgc18u.Tvqm','\u9f99\u8475');\nINSERT INTO `t_user` (`id`, `username`, `password`, `name`) VALUES('6','\u8bb8\u8302\u5c71','$2a$10$TJ4TmCdK.X4wv/tCqHW14.w70U3CC33CeVncD3SLmyMXMknstqKRe','\u8bb8\u8302\u5c71');\n\nINSERT INTO `t_role` (`id`, `role_name`, `role_code`, `description`) VALUES('5','\u5b66\u751f','student','\u5b66\u751f');\nINSERT INTO `t_role` (`id`, `role_name`, `role_code`, `description`) VALUES('7','\u8001\u5e08','teacher','\u8001\u5e08');\nINSERT INTO `t_role` (`id`, `role_name`, `role_code`, `description`) VALUES('8','\u6559\u5b66\u7ba1\u7406\u5458','teachmanager','\u6559\u5b66\u7ba1\u7406\u5458');\nINSERT INTO `t_role` (`id`, `role_name`, `role_code`, `description`) VALUES('9','\u7ba1\u7406\u5458','admin','\u7ba1\u7406\u5458');\nINSERT INTO `t_role` (`id`, `role_name`, `role_code`, `description`) VALUES('10','\u8d85\u7ea7\u7ba1\u7406\u5458','super','\u8d85\u7ea7\u7ba1\u7406\u5458');\n\nINSERT INTO user_role(id,user_id,role_id) VALUES(NULL, '1', '5'),(NULL, '1', '7'),(NULL, '2', '8'),(NULL, '3', '9'),(NULL, '4', '8'),(NULL, '5', '10');\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#explain","title":"\u4e8c\u3001Explain \u7ed3\u679c\u5217","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#1-id","title":"1. <code>id</code>","text":"<p><code>id</code>\u5b57\u6bb5\u662f<code>select</code>\u67e5\u8be2\u7684\u5e8f\u5217\u53f7\uff0c\u662f\u4e00\u7ec4\u6570\u5b57\uff0c\u8868\u793a\u7684\u662f\u67e5\u8be2\u4e2d\u6267\u884c<code>select</code>\u5b50\u53e5\u6216\u8005\u662f\u64cd\u4f5c\u8868\u7684\u987a\u5e8f\u3002<code>id</code>\u60c5\u51b5\u6709\u4e09\u79cd </p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#11-id","title":"1.1 <code>id</code>\u76f8\u540c","text":"<p>\u6267\u884c\u987a\u5e8f\u4ece\u4e0a\u5230\u4e0b</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM t_role r, t_user u, user_role ur WHERE r.id = ur.role_id AND u.id = ur.user_id;\n+----+-------------+-------+------------+--------+-----------------------------+---------+---------+-----------------+------+----------+----------------------------------------------------+\n| id | select_type | table | partitions | type   | possible_keys               | key     | key_len | ref             | rows | filtered | Extra                                              |\n+----+-------------+-------+------------+--------+-----------------------------+---------+---------+-----------------+------+----------+----------------------------------------------------+\n|  1 | SIMPLE      | r     | NULL       | ALL    | PRIMARY                     | NULL    | NULL    | NULL            |    5 |   100.00 | NULL                                               |\n|  1 | SIMPLE      | ur    | NULL       | ALL    | fk_ur_user_id,fk_ur_role_id | NULL    | NULL    | NULL            |    6 |    20.00 | Using where; Using join buffer (Block Nested Loop) |\n|  1 | SIMPLE      | u     | NULL       | eq_ref | PRIMARY                     | PRIMARY | 98      | test.ur.user_id |    1 |   100.00 | NULL                                               |\n+----+-------------+-------+------------+--------+-----------------------------+---------+---------+-----------------+------+----------+----------------------------------------------------+\n3 rows in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#12-id","title":"1.2  <code>id</code>\u4e0d\u540c","text":"<p><code>id</code>\u503c\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u8d8a\u5148\u88ab\u6267\u884c\u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM t_role WHERE id = (SELECT role_id FROM user_role WHERE user_id = (SELECT id FROM t_user WHERE username = '\u9f99\u8475'));\n+----+-------------+-----------+------------+-------+----------------------+----------------------+---------+-------+------+----------+-------------+\n| id | select_type | table     | partitions | type  | possible_keys        | key                  | key_len | ref   | rows | filtered | Extra       |\n+----+-------------+-----------+------------+-------+----------------------+----------------------+---------+-------+------+----------+-------------+\n|  1 | PRIMARY     | t_role    | NULL       | const | PRIMARY              | PRIMARY              | 98      | const |    1 |   100.00 | NULL        |\n|  2 | SUBQUERY    | user_role | NULL       | ref   | fk_ur_user_id        | fk_ur_user_id        | 99      | const |    1 |   100.00 | Using where |\n|  3 | SUBQUERY    | t_user    | NULL       | const | unique_user_username | unique_user_username | 137     | const |    1 |   100.00 | Using index |\n+----+-------------+-----------+------------+-------+----------------------+----------------------+---------+-------+------+----------+-------------+\n3 rows in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#13-id","title":"1.3  <code>id</code>\u6709\u76f8\u540c\u4e5f\u6709\u4e0d\u540c","text":"<p>id\u76f8\u540c\u7684\u53ef\u4ee5\u8ba4\u4e3a\u662f\u4e00\u7ec4\uff0c\u4ece\u4e0a\u5f80\u4e0b\u987a\u5e8f\u6267\u884c\uff1b\u5728\u6240\u6709\u7684\u7ec4\u4e2d\uff0cid\u7684\u503c\u8d8a\u5927\uff0c\u4f18\u5148\u7ea7\u8d8a\u9ad8\uff0c\u8d8a\u5148\u6267\u884c\u3002</p> <pre><code># \u6ce8\u610f\uff1a\u5728Mysql5.7\u4e2d\uff0c \u4f1a\u5bf9\u884d\u751f\u8868\u8fdb\u884c\u5408\u5e76\u4f18\u5316\u3002 \u9700\u8981\u4e34\u65f6\u5173\u95ed\u8be5\u529f\u80fd\uff08\u9ed8\u8ba4\u662f\u6253\u5f00\u7684\uff09\uff0c\nmysql [test]&gt;set session optimizer_switch='derived_merge=off';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * FROM t_role r , (SELECT * FROM user_role ur WHERE ur.`user_id` = '2') a WHERE r.id = a.role_id;\n+----+-------------+------------+------------+--------+---------------+---------------+---------+-----------+------+----------+-------------+\n| id | select_type | table      | partitions | type   | possible_keys | key           | key_len | ref       | rows | filtered | Extra       |\n+----+-------------+------------+------------+--------+---------------+---------------+---------+-----------+------+----------+-------------+\n|  1 | PRIMARY     | &lt;derived2&gt; | NULL       | ALL    | NULL          | NULL          | NULL    | NULL      |    2 |   100.00 | Using where |\n|  1 | PRIMARY     | r          | NULL       | eq_ref | PRIMARY       | PRIMARY       | 98      | a.role_id |    1 |   100.00 | NULL        |\n|  2 | DERIVED     | ur         | NULL       | ref    | fk_ur_user_id | fk_ur_user_id | 99      | const     |    1 |   100.00 | NULL        |\n+----+-------------+------------+------------+--------+---------------+---------------+---------+-----------+------+----------+-------------+\n3 rows in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#2-select_type","title":"2. <code>select_type</code>","text":"<p>\u8868\u793a<code>SELECT</code>\u7684\u7c7b\u578b\uff0c\u5e38\u89c1\u7684\u53d6\u503c\uff0c\u5982\u4e0b\u8868\u6240\u793a\uff1a</p> select_type \u542b\u4e49 <code>SIMPLE</code> \u7b80\u5355\u7684<code>SELECT</code>\u67e5\u8be2\uff0c\u67e5\u8be2\u4e2d\u4e0d\u5305\u542b\u5b50\u67e5\u8be2\u6216\u8005<code>UNION</code> <code>PRIMARY</code> \u67e5\u8be2\u4e2d\u82e5\u5305\u542b\u4efb\u4f55\u590d\u6742\u7684\u5b50\u67e5\u8be2\uff0c\u6700\u5916\u5c42\u67e5\u8be2\u6807\u8bb0\u4e3a<code>PRIMARY</code> <code>SUBQUERY</code> \u5728<code>SELECT</code>\u6216 <code>WHERE</code>\u5217\u8868\u4e2d\u5305\u542b\u4e86\u5b50\u67e5\u8be2 <code>DERIVED</code> \u5728<code>FROM</code>\u5217\u8868\u4e2d\u5305\u542b\u7684\u5b50\u67e5\u8be2\uff0c\u88ab\u6807\u8bb0\u4e3a DERIVED\uff08\u884d\u751f\uff09\u3002MYSQL\u4f1a\u9012\u5f52\u6267\u884c\u8fd9\u4e9b\u5b50\u67e5\u8be2\uff0c\u628a\u7ed3\u679c\u653e\u5728\u4e34\u65f6\u8868\u4e2d <code>UNION</code> \u82e5\u7b2c\u4e8c\u4e2a<code>SELECT</code>\u51fa\u73b0\u5728<code>UNION</code>\u4e4b\u540e\uff0c\u5219\u6807\u8bb0\u4e3a<code>UNION</code>\uff1b \u82e5<code>UNION</code>\u5305\u542b\u5728<code>FROM</code>\u5b50\u53e5\u7684\u5b50\u67e5\u8be2\u4e2d\uff0c\u5916\u5c42<code>SELECT</code>\u5c06\u88ab\u6807\u8bb0\u4e3a \uff1a <code>DERIVED</code> <code>UNION RESULT</code> \u4ece<code>UNION</code>\u7684\u533f\u540d\u4e34\u65f6\u8868\u83b7\u53d6\u7ed3\u679c\u7684<code>SELECT</code>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#3-table","title":"3.  <code>table</code>","text":"<p>\u5bf9\u5e94\u884c\u67e5\u8be2\u7684\u8868\u3002 </p> <ul> <li>\u5f53 <code>from</code>\u5b50\u53e5\u4e2d\u6709\u5b50\u67e5\u8be2\u65f6\uff0ctable \u5217\u4e3a\u662f <code>&lt;derivenN&gt;</code> \u7684\u683c\u5f0f\uff0c\u8868\u793a\u8fd9\u4e00\u884c\u7684\u6267\u884c\u7684\u662f <code>id = N</code> \u884c\u7684\u67e5\u8be2\u3002</li> <li>\u5f53\u6709 <code>union</code> \u65f6\uff0ctable \u7684\u6570\u636e\u4e3a  <code>&lt;union M,N&gt;</code> \u7684\u683c\u5f0f\uff0c<code>M</code> \u548c <code>N</code> \u8868\u793a\u53c2\u4e0e <code>union</code> \u7684 <code>select</code> \u884c<code>id</code>\u3002</li> </ul>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#4-partitions","title":"4. <code>partitions</code>","text":"<p>\u67e5\u8be2\u5c06\u4e0e\u8bb0\u5f55\u76f8\u5339\u914d\u7684\u5206\u533a\u3002\u5bf9\u4e8e\u975e\u5206\u533a\u8868\uff0c\u8be5\u503c\u4e3a <code>NULL</code>\u3002</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#5-type","title":"5. <code>type</code>","text":"<p>type \u663e\u793a\u7684\u662f\u8bbf\u95ee\u7c7b\u578b\uff0c\u662f\u8f83\u4e3a\u91cd\u8981\u7684\u4e00\u4e2a\u6307\u6807\uff0c\u53ef\u53d6\u503c\u4e3a\uff1a </p> type \u542b\u4e49 <code>NULL</code> MySQL\u4e0d\u8bbf\u95ee\u4efb\u4f55\u8868\u3001\u7d22\u5f15\uff0c\u76f4\u63a5\u8fd4\u56de\u7ed3\u679c <code>system</code> \u8868\u53ea\u6709\u4e00\u884c\u8bb0\u5f55(\u7b49\u4e8e\u7cfb\u7edf\u8868)\uff0c\u8fd9\u662f<code>const</code>\u7c7b\u578b\u7684\u7279\u4f8b\uff0c\u4e00\u822c\u4e0d\u4f1a\u51fa\u73b0 <code>const</code> \u8868\u793a\u901a\u8fc7\u7d22\u5f15\u4e00\u6b21\u5c31\u627e\u5230\u4e86\uff0c<code>const</code>\u7528\u4e8e\u6bd4\u8f83<code>primary key</code>\u6216\u8005 <code>unique</code> \u7d22\u5f15\u3002\u56e0\u4e3a\u53ea\u5339\u914d\u4e00\u884c\u6570\u636e\uff0c\u6240\u4ee5\u5f88\u5feb\u3002\u5982\u5c06\u4e3b\u952e\u7f6e\u4e8e<code>where</code>\u5217\u8868\u4e2d\uff0cMySQL \u5c31\u80fd\u5c06\u8be5\u67e5\u8be2\u8f6c\u6362\u4e3a\u4e00\u4e2a\u5e38\u91cf\u3002 <code>eq_ref</code> \u5f53\u4e3b\u952e\u6216\u552f\u4e00\u952e\u7d22\u5f15\u7684\u76f8\u5173\u5217\u5e76\u8054\u63a5\u4f7f\u7528\u65f6\uff08\u8054\u8868\u67e5\u8be2\uff09\uff0c\u6700\u591a\u5339\u914d\u4e00\u6761\u7b26\u5408\u6761\u4ef6\u7684\u8bb0\u5f55\u3002\u8fd9\u662f\u9664\u4e86 <code>const</code>\u4e4b\u5916\u7684\u6700\u597d\u7684\u8054\u63a5\u7c7b\u578b\uff0c\u7b80\u5355\u7684 <code>select</code> \u67e5\u8be2\u4e0d\u4f1a\u51fa\u73b0 <code>req_ref</code>\uff0c\u66f4\u591a\u51fa\u73b0\u5728\u8054\u8868\u67e5\u8be2\u3002 <code>ref</code> \u672c\u8d28\u4e0a\u4e5f\u662f\u4e00\u79cd\u7d22\u5f15\u8bbf\u95ee\uff0c\u5b83\u8fd4\u56de\u6240\u6709\u5339\u914d\u67d0\u4e2a\u5355\u72ec\u503c\u7684\u884c\uff0c\u7136\u800c\uff0c\u5b83\u53ef\u80fd\u4f1a\u627e\u5230\u591a\u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u884c\uff0c\u6240\u4ee5\u5b83\u5e94\u8be5\u5c5e\u4e8e\u67e5\u627e\u548c\u626b\u63cf\u7684\u6df7\u5408\u4f53\u3002\u6b64\u7c7b\u7d22\u5f15\u8bbf\u95ee\u53ea\u6709\u5f53\u4f7f\u7528\u975e\u552f\u4e00\u6027\u7d22\u5f15\u6216\u8005\u552f\u4e00\u6027\u7d22\u5f15\u7684\u975e\u552f\u4e00\u6027\u524d\u7f00\u65f6\u624d\u4f1a\u53d1\u751f\u3002\u628a\u5b83\u53eb\u505a<code>ref</code>\u662f\u56e0\u4e3a\u7d22\u5f15\u8981\u8ddf\u67d0\u4e2a\u53c2\u8003\u503c\u76f8\u6bd4\u8f83\uff0c\u8fd9\u4e2a\u53c2\u8003\u503c\u662f\u4e00\u4e2a\u5e38\u6570\u6216\u8005\u662f\u6765\u81ea\u591a\u8868\u67e5\u8be2\u524d\u4e00\u4e2a\u8868\u91cc\u7684\u7ed3\u679c\u503c\u3002 <code>range</code> \u8303\u56f4\u626b\u63cf\uff0c\u901a\u5e38\u51fa\u73b0\u5728 <code>between</code>\u3001<code>&gt;</code>\u3001<code>&lt;</code>\u7b49\u64cd\u4f5c\u4e2d\uff0c\u4f7f\u7528\u4e00\u4e2a\u7d22\u5f15\u6765\u68c0\u7d22\u7ed9\u5b9a\u8303\u56f4\u7684\u884c\u3002 <code>index</code> <code>index</code> \u4e0e <code>ALL</code>\u7684\u533a\u522b\u4e3a: <code>index</code>\u7c7b\u578b\u53ea\u662f\u904d\u5386\u4e86\u7d22\u5f15\u6811\uff0c \u901a\u5e38\u6bd4<code>ALL</code>\u5feb\uff0c <code>ALL</code>\u662f\u904d\u5386\u6570\u636e\u6587\u4ef6\u3002 <code>ALL</code> \u5168\u8868\u626b\u63cf\uff0c\u626b\u63cf\u4e3b\u952e\uff08\u805a\u7c07\u3001\u805a\u96c6\uff09\u7d22\u5f15\u6811\u7684\u6240\u6709\u53f6\u5b50\u8282\u70b9\uff0c\u901a\u5e38\u8fd9\u79cd\u60c5\u51b5\u4e0b\u8981\u6839\u636e\u4e1a\u52a1\u573a\u666f\u6765\u589e\u52a0\u5176\u4ed6\u7d22\u5f15\u8fdb\u884c\u4f18\u5316\u3002\uff08\u4f8b\u5916\uff1a\u67e5\u8be2\u4e2d\u4f7f\u7528\u4e86LIMIT\u3001\u6216\u8005\u5728Extra\u5217\u4e2d\u663e\u793a\u201cUsing distinct/not exists\u201d\uff09\u3002 <p>\u7ed3\u679c\u503c\u4ece\u6700\u597d\u5230\u6700\u574f\u4f9d\u6b21\u662f\uff1a</p> <pre><code>system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt; ALL\n</code></pre> <p>\u4e00\u822c\u6765\u8bf4\uff0c \u6211\u4eec\u9700\u8981\u4fdd\u8bc1\u67e5\u8be2\u81f3\u5c11\u8fbe\u5230<code>range</code>\u7ea7\u522b\uff0c \u6700\u597d\u8fbe\u5230<code>ref</code> \u3002</p> <p>\u5176\u4ed6\u53ef\u80fd\u51fa\u73b0\u5b57\u6bb5\uff1a</p> <pre><code>NULL &gt; system &gt; const &gt; eq_ref &gt; ref &gt; fulltext &gt; ref_or_null &gt; index_merge &gt; unique_subquery &gt; index_subquery &gt; range &gt; index &gt; ALL\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#6possible_keys","title":"6.<code>possible_keys</code>","text":"<p>possible_keys \u4e3b\u8981\u663e\u793a\u67e5\u8be2\u53ef\u80fd\u7528\u5230\u54ea\u4e9b\u7d22\u5f15\u6765\u67e5\u627e\uff0c\u53ea\u662f\u53ef\u80fd\u4f1a\u4f7f\u7528\uff0c\u5e76\u4e0d\u4ee3\u8868\u4e00\u5b9a\u4f1a\u4f7f\u7528\u3002</p> <p>\u5e38\u89c1\u503c\u8bf4\u660e\uff1a</p> <p>NULL: \u6ca1\u6709\u76f8\u5173\u7d22\u5f15\uff0c\u5982\u679c\u662f NULL \u7684\u8bdd\uff0c\u53ef\u4ee5\u8003\u8651\u5728 where \u5b50\u53e5\u4e2d\u521b\u5efa\u4e00\u4e2a\u9002\u5f53\u7684\u7d22\u5f15\u6765\u63d0\u9ad8\u67e5\u8be2\u6027\u80fd\uff0c\u7136\u540e\u7ee7\u7eed\u7528 explain \u67e5\u770b\u5176\u6548\u679c\uff1b\u4e5f\u6709\u53ef\u80fd\u51fa\u73b0 possible_keys \u4e3a NULL\uff0c\u4f46\u662f key \u6709\u503c\uff0c\u5b9e\u9645\u8d70\u4e86\u7d22\u5f15\u3002 \u6709\u5217\u503c\uff1a\u5982\u679c\u663e\u793a\u8868\u4e2d\u7684\u67d0\u5217\uff0c\u5219\u8868\u793a\u53ef\u80fd\u4f1a\u8d70\u8fd9\u4e00\u5217\u5bf9\u5e94\u5217\u503c\u7684\u7d22\u5f15\uff1b\u5982\u679c possible_keys \u6709\u503c\uff0c\u4f46\u662f key \u663e\u793a NULL\uff0c\u8fd9\u79cd\u60c5\u51b5\u4e00\u822c\u5b58\u5728\u4e8e\u8868\u4e2d\u6570\u636e\u91cf\u4e0d\u5927\u7684\u60c5\u51b5\uff0c\u56e0\u4e3a MySQL \u8bed\u53e5\u4f18\u5316\u5668\u8ba4\u4e3a\u7d22\u5f15\u5bf9\u6b64\u67e5\u8be2\u7684\u5e2e\u52a9\u4e0d\u5927\uff0c\u4ece\u800c\u9009\u62e9\u4e86\u5168\u8868\u67e5\u8be2\u3002</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#7-key","title":"7. <code>key</code>","text":"<p><code>key</code> \u8868\u793a <code>MySQL</code> \u5b9e\u9645\u91c7\u7528\u54ea\u4e2a\u7d22\u5f15\u6765\u4f18\u5316\u5bf9\u8be5\u8868\u7684\u67e5\u8be2\u3002</p> <p>\u5982\u679c\u6ca1\u6709\u4f7f\u7528\u7d22\u5f15\uff0c\u5219\u8be5\u5217\u4e3a <code>NULL</code>\u3002</p> <p>\u67e5\u8be2\u4e2d\u82e5\u4f7f\u7528\u4e86\u8986\u76d6\u505a\u5f15\uff0c\u5219\u8be5\u7d22\u5f15\u4ec5\u51fa\u73b0\u5728key\u5217\u8868\u4e2d\u3002</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#8-key_len","title":"8. <code>key_len</code>","text":"<p>\u663e\u793a\u4e86 MySQL \u7d22\u5f15\u6240\u4f7f\u7528\u7684\u5b57\u8282\u6570\uff0c\u901a\u8fc7\u8fd9\u4e2a\u6570\u503c\u53ef\u4ee5\u8ba1\u7b97\u5177\u4f53\u4f7f\u7528\u4e86\u7d22\u5f15\u4e2d\u7684\u54ea\u4e9b\u5217\uff08\u4e3b\u8981\u7528\u4e8e\u8054\u5408\u7d22\u5f15\u7684\u4f18\u5316\uff09\u3002</p> <p>\u5982\u679c\u5b57\u6bb5\u5141\u8bb8\u8bbe\u7f6e\u4e3a <code>NULL</code>\uff0c\u5219\u9700\u8981 <code>1</code> \u5b57\u8282\u6765\u8bb0\u5f55\u662f\u5426\u4e3a <code>NULL</code>\uff1b <code>Not NULL</code> \u7684\u5217\u5219\u4e0d\u9700\u8981\u3002</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#9-ref","title":"9. <code>ref</code>","text":"<p>\u663e\u793a\u4e86\u4e4b\u524d\u7684\u8868\u5728key\u5217\u8bb0\u5f55\u7684\u7d22\u5f15\u4e2d\u67e5\u627e\u503c\u6240\u7528\u7684\u5217\u6216\u5e38\u91cf</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#10-row","title":"10. <code>row</code>","text":"<p>\u663e\u793a\u9884\u8ba1\u67e5\u8be2\u7684\u7ed3\u679c\u6570\uff0c\u5e76\u4e0d\u662f\u771f\u6b63\u7684\u7ed3\u679c\u96c6\u4e2d\u7684\u8bb0\u5f55\uff08\u884c\uff09\u6570\uff0c\u4ec5\u4f9b\u53c2\u8003\u3002</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#11filtered","title":"11<code>filtered</code>","text":"<p>\u67e5\u8be2\u7684\u7ed3\u679c\u884c\u6570\uff08\u8bb0\u5f55\uff09\u5360\u603b\u8bfb\u53d6\u884c\u6570\uff08\u8bb0\u5f55\uff09\u7684\u767e\u5206\u6bd4\uff0c\u6700\u5927\u4e3a <code>100</code> \uff08\u4e5f\u5c31\u662f <code>100%</code>\uff09\uff0c\u610f\u5473\u7740\u6ca1\u6709\u5bf9\u884c\u8fdb\u884c\u7b5b\u9009\u3002 </p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#12extra","title":"12.<code>extra</code>","text":"<p>\u5176\u4ed6\u7684\u989d\u5916\u7684\u6267\u884c\u8ba1\u5212\u4fe1\u606f\uff0c\u5728\u8be5\u5217\u5c55\u793a \u3002</p> <p><code>Using index</code>\uff1a\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\uff0c\u5728 <code>type</code> \u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c <code>Extra</code> \u7684\u503c\u4e3a <code>Using index</code> \u8981\u6bd4\u4e3a <code>NULL</code> \u6027\u80fd\u9ad8\u3002  \u8868\u793a\u76f8\u5e94\u7684<code>SELECT</code>\u64cd\u4f5c\u4e2d\u4f7f\u7528\u4e86\u8986\u76d6\u7d22\u5f15\uff08Covering Index\uff09\uff0c\u907f\u514d\u8bbf\u95ee\u4e86\u8868\u7684\u6570\u636e\u884c\uff0c\u6548\u7387\u4e0d\u9519\uff01\u5982\u679c\u540c\u65f6\u51fa\u73b0<code>using where</code>\uff0c\u8868\u660e\u7d22\u5f15\u88ab\u7528\u6765\u6267\u884c\u7d22\u5f15\u952e\u503c\u7684\u67e5\u627e\uff1b\u5982\u679c\u6ca1\u6709\u540c\u65f6\u51fa\u73b0<code>using where</code>\uff0c\u8868\u660e\u7d22\u5f15\u7528\u6765\u8bfb\u53d6\u6570\u636e\u800c\u975e\u6267\u884c\u67e5\u627e\u52a8\u4f5c\u3002 </p> <p><code>Using where</code>\uff1a\u4f7f\u7528 <code>where</code> \u5173\u952e\u5b57\u6765\u67e5\u8be2\uff0c\u5e76\u4e14\u5bf9\u5e94\u7684\u5217\u6ca1\u6709\u8bbe\u7f6e\u7d22\u5f15\uff0c\u5bf9\u5e94\u7684 <code>key</code> \u4e3a <code>NULL</code>\u3002 </p> <p><code>Using index condition</code>\uff1a\u975e\u8986\u76d6\u7d22\u5f15\u67e5\u8be2\u5e76\u8fdb\u884c\u4e86\u56de\u8868\uff0c\u5e76\u4e14\u8f85\u52a9\u7d22\u5f15\u4f7f\u7528\u4e86\u6761\u4ef6\u67e5\u8be2\u8bed\u53e5\uff08<code>where</code> \u6216\u5176\u4ed6\uff09\u3002 </p> <p><code>Using temporary</code>\uff1a<code>MySQL</code> \u9700\u8981\u521b\u5efa\u521b\u5efa\u4e00\u4e2a\u4e34\u65f6\u8868\u6765\u5904\u7406\u67e5\u8be2\uff0c\u51fa\u73b0\u8fd9\u79cd\u60c5\u51b5\u4e00\u822c\u8981\u6dfb\u52a0\u7d22\u5f15\u8fdb\u884c\u4f18\u5316\u5904\u7406\u3002  \u5e38\u89c1\u4e8e\u6392\u5e8forder by\u548c\u5206\u7ec4\u67e5\u8be2group by\u3002 </p> <p><code>Using filesort</code>\uff1a\u4f7f\u7528\u5916\u90e8\u6392\u5e8f\u800c\u4e0d\u662f\u7d22\u5f15\u6392\u5e8f\uff0c\u5f53\u6570\u636e\u8f83\u5c0f\u7684\u65f6\u5019\u91c7\u7528\u7684\u662f\u5185\u5b58\u6392\u5e8f\uff0c\u5f53\u6570\u636e\u91cf\u8f83\u5927\u7684\u65f6\u5019\u4f1a\u9891\u7e41\u7684\u8bbf\u95ee\u78c1\u76d8\uff0c\u5e76\u5c06\u6392\u5e8f\u540e\u7684\u6570\u636e\u5199\u5165\u78c1\u76d8\u3002</p> <p><code>Select tables optimized away</code>\uff1a\u4f7f\u7528<code>\u805a\u5408\u51fd\u6570</code>\uff08\u4f8b\u5982 <code>max</code>\u3001<code>min</code>\u7b49\uff09\u6765\u8bbf\u95ee\u5b58\u5728\u7d22\u5f15\u7684\u5b57\u6bb5\u65f6\uff0c\u53ea\u8bbf\u95ee\u7d22\u5f15\u6811\u4e2d\u5df2\u6392\u597d\u5e8f\u7684\u53f6\u5b50\uff0c\u8282\u70b9\u6027\u80fd\u5f88\u9ad8\u3002</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#_2","title":"\u516b\u3001\u6267\u884c\u8ba1\u5212","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#1_1","title":"1. \u83b7\u53d6\u6267\u884c\u8ba1\u5212","text":"<pre><code>mysql&gt; DESC SELECT name,population FROM city WHERE name='ChongQing';\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | city  | NULL       | ALL  | NULL          | NULL | NULL    | NULL | 4046 |    10.00 | Using where |\n+----+-------------+-------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#2_1","title":"2. \u5173\u952e\u5b57\u6bb5","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#21-table","title":"2.1 table\u67e5\u8be2\u7684\u8868","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#22-type","title":"2.2  type \u67e5\u8be2\u7684\u7c7b\u578b:\u5168\u8868\uff0c\u7d22\u5f15","text":"<p>type\u5b57\u6bb5\u53ef\u80fd\u51fa\u73b0\u7684\u503c</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#221-all","title":"2.2.1 ALL \u5168\u8868\u626b\u63cf\uff0c\u4e0d\u8d70\u7d22\u5f15","text":"<p>\u4f8b1\uff1a\u67e5\u8be2\u6761\u4ef6\u5217\u6ca1\u6709\u7d22\u5f15</p> <pre><code>SELECT name,population FROM city WHERE name='ChongQing';\n</code></pre> <p>\u4f8b2\uff1a\u67e5\u8be2\u6761\u4ef6\u51fa\u73b0\u4ee5\u4e0b\u8bed\u53e5\uff08\u8f85\u52a9\u7d22\u5f15\uff09</p> <pre><code>DESC SELECT * FROM city WHERE countrycode &lt;&gt; 'CHN';\nDESC SELECT * FROM city WHERE countrycode NOT IN ('CHN','USA');\n# \u5bf9\u4e8e\u805a\u96c6\u7d22\u5f15\uff0c\u4f7f\u7528\u4ee5\u4e0a\u8bed\u53e5\u4f9d\u7136\u4f1a\u8d70\u7d22\u5f15\nDESC SELECT * FROM city WHERE id &lt;&gt; 10;\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | city  | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL | 2032 |   100.00 | Using where |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#222-index","title":"2.2.2 INDEX \u5168\u7d22\u5f15","text":"<pre><code># 1. \u67e5\u8be2\u9700\u8981\u83b7\u53d6\u6574\u4e2a\u7d22\u5f15\u6811\u4e2d\u7684\u503c\u65f6\nmysql&gt; DESC SELECT countrycode FROM city;\n+----+-------------+-------+------------+-------+---------------+-------------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key         | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+-------------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | city  | NULL       | index | NULL          | CountryCode | 12      | NULL | 4046 |   100.00 | Using index |\n+----+-------------+-------+------------+-------+---------------+-------------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n# 2.\u8054\u5408\u7d22\u5f15\u4e2d\uff0c\u4efb\u4f55\u4e00\u4e2a\u975e\u6700\u5de6\u5217\u4f5c\u4e3a\u67e5\u8be2\u6761\u4ef6\u65f6\nSELECT * FROM t1 WHERE b\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#223-range","title":"2.2.3 RANGE \u7d22\u5f15\u8303\u56f4\u626b\u63cf","text":"<ol> <li>\u8f85\u52a9\u7d22\u5f15\uff1a&gt;\u3001 &gt;=\u3001 &lt;\u3001 &lt;= \u3001LIKE\u3001 IN\u3001 OR</li> <li>\u4e3b\u952e\uff1a&lt;&gt;\u3001 NOT IN</li> </ol> <p>\u4f8b\uff1a</p> <pre><code>mysql&gt; DESC SELECT * FROM city WHERE id&lt;5;\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | city  | NULL       | range | PRIMARY       | PRIMARY | 4       | NULL |    4 |   100.00 | Using where |\n+----+-------------+-------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u6ce8\u610f\uff1a</p>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#224-ref","title":"2.2.4 ref \u975e\u552f\u4e00\u6027\u7d22\u5f15\uff0c\u7b49\u503c\u67e5\u8be2","text":"<pre><code>mysql&gt; ALTER TABLE city ADD INDEX  idx_c_p(countrycode, population);\nQuery OK, 0 rows affected (0.19 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nmysql&gt; DESC SELECT * FROM city WHERE countrycode='CHN';\n+----+-------------+-------+------------+------+---------------------+-------------+---------+-------+------+----------+-------+\n| id | select_type | table | partitions | type | possible_keys       | key         | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-------+------------+------+---------------------+-------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | city  | NULL       | ref  | CountryCode,idx_c_p | CountryCode | 12      | const |  363 |   100.00 | NULL  |\n+----+-------------+-------+------------+------+---------------------+-------------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#225-eq_ref","title":"2.2.5 eq_ref \u5728\u591a\u8868\u8fde\u63a5\u65f6\uff0c\u8fde\u63a5\u6761\u4ef6\u4f7f\u7528\u4e86\u552f\u4e00\u7d22\u5f15","text":"<pre><code>mysql&gt; DESC SELECT city.name, country.name, country.SurfaceArea\n    -&gt; FROM city JOIN country\n    -&gt; ON city.countrycode=country.code\n    -&gt; WHERE city.Population&lt;100;\n+----+-------------+---------+------------+--------+---------------------+---------+---------+------------------------+------+----------+-------------+\n| id | select_type | table   | partitions | type   | possible_keys       | key     | key_len | ref                    | rows | filtered | Extra       |\n+----+-------------+---------+------------+--------+---------------------+---------+---------+------------------------+------+----------+-------------+\n|  1 | SIMPLE      | city    | NULL       | ALL    | CountryCode,idx_c_p | NULL    | NULL    | NULL                   | 4046 |    33.33 | Using where |\n|  1 | SIMPLE      | country | NULL       | eq_ref | PRIMARY             | PRIMARY | 12      | world.city.CountryCode |    1 |   100.00 | NULL        |\n+----+-------------+---------+------------+--------+---------------------+---------+---------+------------------------+------+----------+-------------+\n2 rows in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#226-systemconst","title":"2.2.6 system,const \u552f\u4e00\u7d22\u5f15\u7684\u7b49\u503c\u67e5\u8be2","text":"<pre><code>mysql&gt; DESC SELECT * FROM city WHERE id=5;\n+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+\n| id | select_type | table | partitions | type  | possible_keys | key     | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | city  | NULL       | const | PRIMARY       | PRIMARY | 4       | const |    1 |   100.00 | NULL  |\n+----+-------------+-------+------------+-------+---------------+---------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#23-possible_keys","title":"2.3 possible_keys \u53ef\u80fd\u4f1a\u7528\u5230\u7684\u7d22\u5f15","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#24-key","title":"2.4 key \u4f7f\u7528\u5230\u7684\u7d22\u5f15\uff0c\u5224\u65ad\u7d22\u5f15\u662f\u5426\u5408\u7406","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#25-extra","title":"2.5 extra \u989d\u5916\u4fe1\u606f","text":""},{"location":"databases/MySQL/%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92/#251-filesort","title":"2.5.1 filesort \u6587\u4ef6\u6392\u5e8f","text":"<p>\u8bf4\u660e\u5728SQL\u8bed\u53e5\u4e2d\u5b58\u5728\u6392\u5e8f</p> <pre><code>mysql&gt; DESC SELECT * FROM city WHERE countrycode='CHN' ORDER BY population;\n+----+-------------+-------+------------+------+---------------+-------------+---------+-------+------+----------+---------------------------------------+\n| id | select_type | table | partitions | type | possible_keys | key         | key_len | ref   | rows | filtered | Extra                                 |\n+----+-------------+-------+------------+------+---------------+-------------+---------+-------+------+----------+---------------------------------------+\n|  1 | SIMPLE      | city  | NULL       | ref  | CountryCode   | CountryCode | 12      | const |  363 |   100.00 | Using index condition; Using filesort |\n+----+-------------+-------+------------+------+---------------+-------------+---------+-------+------+----------+---------------------------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <pre><code>mysql&gt; ALTER TABLE city ADD INDEX  idx_c_p(countrycode, population);\nQuery OK, 0 rows affected (0.12 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n\nmysql&gt; DESC SELECT * FROM city WHERE countrycode='CHN' ORDER BY population;\n+----+-------------+-------+------------+------+---------------------+---------+---------+-------+------+----------+-----------------------+\n| id | select_type | table | partitions | type | possible_keys       | key     | key_len | ref   | rows | filtered | Extra                 |\n+----+-------------+-------+------------+------+---------------------+---------+---------+-------+------+----------+-----------------------+\n|  1 | SIMPLE      | city  | NULL       | ref  | CountryCode,idx_c_p | idx_c_p | 12      | const |  363 |   100.00 | Using index condition |\n+----+-------------+-------+------------+------+---------------------+---------+---------+-------+------+----------+-----------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u5f53\u770b\u5230\u6267\u884c\u8ba1\u5212extra\u4f4d\u7f6e\u51fa\u73b0filesort\uff0c\u8bf4\u660e\u6709\u6587\u4ef6\u6392\u5e8f\u51fa\u73b0</p> <p>\u89c2\u5bdf\u9700\u8981\u6392\u5e8f\uff08ORDER BY\uff0cGROUP BY\uff0cDISTINCT\uff09\u7684\u6761\u4ef6\u6709\u6ca1\u6709\u7d22\u5f15</p> <p>\u6839\u636e\u5b50\u53e5\u7684\u6307\u5411\u987a\u5e8f\u53bb\u521b\u5efa\u8054\u5408\u7d22\u5f15</p>"},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/","title":"\u6570\u636e\u7c7b\u578b\u548c\u8fd0\u7b97\u7b26","text":""},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#_2","title":"\u4e00\u3001\u6570\u636e\u7c7b\u578b","text":""},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#1","title":"1. \u6574\u6570\u7c7b\u578b","text":"<p>mysql\u4e2d\u6574\u6570\u578b\u6570\u636e\u7c7b\u578b</p> \u7c7b\u578b\u540d\u79f0 \u6709\u7b26\u53f7 \u65e0\u7b26\u53f7 TINYINT -128 ~ 127 0 ~ 255 SMALLINT -32768 ~ 32767 0 ~ 65535 MEDIUMINT -8388608 ~ 8388607 0 ~ 16777215 INT -2147483648 ~ 2147483647 0 ~ 4294967295 BIGINT -9223372036854775808  ~ 9223372036854775807. 0 ~ 18446744073709551615 <p>\u5728mysql\u4e2d\u6267\u884c<code>HELP \u7c7b\u578b\u540d\u79f0</code>\u53ef\u4ee5\u67e5\u770b\u5177\u4f53\u8303\u56f4\u3002</p>"},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#2","title":"2. \u6d6e\u70b9\u6570\u7c7b\u578b\u548c\u5b9a\u70b9\u6570\u7c7b\u578b","text":"\u7c7b\u578b\u540d\u79f0 \u65e0\u7b26\u53f7 \u6709\u7b26\u53f7 FLOAT 0\u548c1.175494351E-38 ~ 3.402823466E+38 -3.402823466E+38 ~ -1.175494351E-38 DOUBLE 0\u548c2.2250738585072014E-308 ~ 1.7976931348623157E+308 -1.7976931348623157E+308 ~ -2.2250738585072014E-308 DECIMAL(M,D), DEC(M,D) \u540cDOUBLE \u540cDOUBLE <p>\u7279\u70b9\uff1a</p> <ol> <li>M\uff1a\u6574\u6570\u90e8\u4f4d+\u5c0f\u6570\u90e8</li> <li>D\uff1a\u5c0f\u6570\u90e8\u4f4d</li> <li>\u5982\u679c\u8d85\u8fc7\u8303\u56f4\uff0c\u5219\u63d2\u5165\u4e34\u754c\u503c</li> <li>M\u548cD\u90fd\u53ef\u4ee5\u7701\u7565\uff0c\u5982\u679c\u662fdecimal\uff0c\u5219M\u9ed8\u8ba4\u4e3a10\uff0cD\u9ed8\u8ba4\u4e3a0</li> <li>\u5982\u679c\u662ffloat\u548cdouble\uff0c\u5219\u4f1a\u6839\u636e\u63d2\u5165\u7684\u6570\u503c\u7684\u7cbe\u5ea6\u6765\u51b3\u5b9a\u7cbe\u5ea6</li> <li>\u5b9a\u70b9\u578b\u7684\u7cbe\u786e\u5ea6\u8f83\u9ad8\uff0c\u5982\u679c\u8981\u6c42\u63d2\u5165\u6570\u503c\u7684\u7cbe\u5ea6\u8f83\u9ad8\u5982\u8d27\u5e01\u8fd0\u7b97\u7b49\u5219\u8003\u8651\u4f7f\u7528\u5b9a\u70b9\u578b</li> </ol>"},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#3","title":"3. \u65e5\u671f\u548c\u65f6\u95f4","text":"\u7c7b\u578b\u540d\u79f0 \u65e5\u671f\u683c\u5f0f \u65e5\u671f\u8303\u56f4 YEAR YYYY 1901 ~ 2155 TIME HH:MM:SS[.fraction] -838:59:59.000000 ~ 838:59:59.000000 DATE YYYY-MM-DD 1000-01-01 ~ 9999-12-31 DATETIME YYYY-MM-DD HH:MM:SS[.fraction] 1000-01-01 00:00:00.000000 ~ 9999-12-31 23:59:59.999999 TIMESTAMP YYYYMMDDHHMMSS 1970-01-01 00:00:01.000000 ~ 2038-01-19 03:14:07.999999"},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#4","title":"4. \u6587\u672c\u5b57\u7b26\u4e32\u7c7b\u578b","text":"\u7c7b\u578b\u540d\u79f0 \u5b58\u50a8\u9700\u6c42 CHAR(M) M\u5b57\u8282,1&lt;=M&lt;=255\uff08M\u8868\u793a\u5217\u957f\u5ea6\uff09 VARCHAR(M) L+1\u5b57\u8282\uff0cL&lt;=M\uff0c1&lt;=M&lt;=65535 TINYTEXT L+1\u5b57\u8282\uff0cL&lt;2^8 TEXT L+2\u5b57\u8282\uff0cL&lt;2^16 MEDIUMTEXT L+3\u5b57\u8282\uff0cL&lt;2^24 LONGTEXT L+4\u5b57\u8282\uff0cL&lt;2^32 ENUM 1\u62162\u4e2a\u5b57\u8282\uff0c\u53d6\u51b3\u4e8e\u679a\u4e3e\u503c\u7684\u6570\u636e(\u6700\u5927\u503c65535) SET 1,2,3,4\u62168\u4e2a\u5b57\u8282\uff0c\u53d6\u51b3\u4e8e\u96c6\u5408\u6210\u5458\u7684\u6570\u91cf(\u6700\u591a64\u4e2a\u6210\u5458) <p>L\uff1a\u5217\u503c\u7684\u5b9e\u9645\u957f\u5ea6</p>"},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#5","title":"5. \u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32","text":"\u7c7b\u578b\u540d\u79f0 BIT(M) M\u4f4d\u4e8c\u8fdb\u5236\u6570\uff0c\u6700\u5927\u503c\u4e3a64\uff0c\u9ed8\u8ba4\u4e3a1 BINARY(M) \u5b57\u8282\u6570\u4e3aM\uff0c\u5141\u8bb8\u957f\u5ea6\u4e3a0-M\u7684\u5b9a\u957f\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32 VARBINARY(M) \u5141\u8bb8\u957f\u5ea6\u4e3a0-M\u7684\u53d8\u957f\u4e8c\u8fdb\u5236\u5b57\u7b26\u4e32 TINYBLOB \u53ef\u8fb9\u957f\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6700\u591a255\u4e2a\u5b57\u8282 BLOB \u53ef\u8fb9\u957f\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6700\u591a2^16-1\u4e2a\u5b57\u8282 MEDIUMBLOB \u53ef\u8fb9\u957f\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6700\u591a2^24-1\u4e2a\u5b57\u8282 LONGBLOB \u53ef\u8fb9\u957f\u4e8c\u8fdb\u5236\u6570\u636e\uff0c\u6700\u591a2^32-1\u4e2a\u5b57\u8282 <p>\u6570\u636e\u7c7b\u578b\u7684\u9009\u62e9\uff1a</p> <ol> <li>\u5982\u679c\u8981\u5bf9\u5c0f\u6570\u8fdb\u884c\u6570\u503c\u6bd4\u8f83\uff0c\u6700\u597d\u7528DECIMAL</li> <li> <p>float(M,D)\u662f\u975e\u6807\u51c6SQL\u5b9a\u4e49\uff0c\u5c3d\u91cf\u4e0d\u8981\u4f7f\u7528</p> </li> <li> <p>\u5bf9\u4e8e\u5b58\u50a8\u4e0d\u5927\uff0c\u4f46\u5728\u901f\u5ea6\u4e0a\u6709\u8981\u6c42\u7684\u7528CHAR\uff0c\u53cd\u4e4b\u7528VARCHAR</p> </li> </ol>"},{"location":"databases/MySQL/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/#_3","title":"\u4e8c\u3001\u8fd0\u7b97\u7b26","text":""},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/","title":"\u7528\u6237\u7ba1\u7406","text":""},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#1","title":"1. \u8d26\u6237\u7ba1\u7406","text":""},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#11","title":"1.1 \u67e5\u770b\u5f53\u524d\u7528\u6237","text":"<pre><code>3306 [(none)]&gt;select user,authentication_string,host from mysql.user;\n+---------------+-------------------------------------------+-----------+\n| user          | authentication_string                     | host      |\n+---------------+-------------------------------------------+-----------+\n| root          | *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B | localhost |\n| mysql.session | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | localhost |\n| mysql.sys     | *THISISNOTAVALIDPASSWORDTHATCANBEUSEDHERE | localhost |\n+---------------+-------------------------------------------+-----------+\n3 rows in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#12","title":"1.2 \u7528\u6237\u767d\u540d\u5355","text":"<p>\u652f\u6301\u7684\u65b9\u5f0f\uff1a</p> <pre><code>username@'10.0.0.%'\nusername@'%'\nusername@'10.0.0.100'\nusername@'localhost'\nusername@'www.example.com'\nusername@'10.0.0.5%'\nusername@'10.0.0.%'\nusername@'10.0.0.0/255.255.254.0'\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#13","title":"1.3 \u7528\u6237\u521b\u5efa","text":"<pre><code>3306 [(none)]&gt;create user yuanzhi@'10.0.0.%' identified by '123456';\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#14","title":"1.4 \u4fee\u6539\u7528\u6237\u5bc6\u7801","text":"<pre><code>3306 [(none)]&gt;alter user yuanzhi@'10.0.0.%' identified by 'yuanzhi';\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#15","title":"1.5 \u5220\u9664\u7528\u6237","text":"<pre><code>3306 [(none)]&gt;drop user yuanzhi@'10.0.0.%';\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#2","title":"2. \u6743\u9650\u7ba1\u7406","text":""},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#21","title":"2.1 \u6388\u6743","text":""},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#1_1","title":"1 \u6388\u4e88\u6240\u6709\u6743\u9650","text":"<pre><code>3306 [(none)]&gt;grant all on *.* to root@'10.0.0.%' identified by 'root';\nQuery OK, 0 rows affected, 1 warning (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#2_1","title":"2 \u6388\u4e88\u6307\u5b9a\u6743\u9650","text":"<pre><code>3306 [(none)]&gt;grant select,update,insert,delete on wordpress.* to wordpress@'10.0.0.%' identified by 'wordpress';\nQuery OK, 0 rows affected, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#22","title":"2.2 \u67e5\u770b\u6743\u9650","text":"<pre><code>3306 [(none)]&gt;show grants for 'wordpress'@'10.0.0.%';\n+---------------------------------------------------------------------------------+\n| Grants for wordpress@10.0.0.%                                                   |\n+---------------------------------------------------------------------------------+\n| GRANT USAGE ON *.* TO 'wordpress'@'10.0.0.%'                                    |\n| GRANT SELECT, INSERT, UPDATE, DELETE ON `wordpress`.* TO 'wordpress'@'10.0.0.%' |\n+---------------------------------------------------------------------------------+\n2 rows in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#23","title":"2.3 \u56de\u6536\u6743\u9650","text":"<pre><code>3306 [(none)]&gt;revoke delete on wordpress.* from wordpress@'10.0.0.%';\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#3-root","title":"3. root\u5bc6\u7801\u4e22\u5931\u5904\u7406","text":""},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#1_2","title":"1. \u5173\u95ed\u6570\u636e\u5e93\u670d\u52a1","text":"<pre><code>root@ubuntu:~#:/app/mysql/support-files# ./mysql.server stop\nShutting down MySQL\n.... *\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#2-mysqld_safe","title":"2. mysqld_safe \u542f\u52a8","text":"<pre><code># \u5173\u95ed\u8ba4\u8bc1\uff0c\u5173\u95edTCP/IP\u8fde\u63a5\nroot@ubuntu:~#:/app/mysql/support-files# mysqld_safe --skip-grant-tables --skip-networking &amp;\n[1] 3991\nroot@ubuntu:~#:/app/mysql/support-files# 2020-04-20T15:32:55.026585Z mysqld_safe Logging to '/data/mysql/ubuntu.err'.\n2020-04-20T15:32:55.060397Z mysqld_safe Starting mysqld daemon with databases from /data/mysql\n</code></pre>"},{"location":"databases/MySQL/%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86/#3","title":"3. \u4fee\u6539\u5bc6\u7801","text":"<pre><code>root@ubuntu:~#:/app/mysql/support-files# mysql -uroot\n...\n3306 [(none)]&gt;flush privileges;\nQuery OK, 0 rows affected (0.01 sec)\n\n3306 [(none)]&gt;alter user root@'localhost' identified by 'root';\nQuery OK, 0 rows affected (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/","title":"\u7d22\u5f15","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#_1","title":"\u4e00\u3001\u6982\u8ff0","text":"<p>MySQL\u5b98\u65b9\u5bf9\u7d22\u5f15\u7684\u5b9a\u4e49\u4e3a\uff1a\u7d22\u5f15\uff08index\uff09\u662f\u5e2e\u52a9MySQL\u9ad8\u6548\u83b7\u53d6\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\uff08\u6709\u5e8f\uff09\u3002\u5728\u6570\u636e\u4e4b\u5916\uff0c\u6570\u636e\u5e93\u7cfb\u7edf\u8fd8\u7ef4\u62a4\u8005\u6ee1\u8db3\u7279\u5b9a\u67e5\u627e\u7b97\u6cd5\u7684\u6570\u636e\u7ed3\u6784\uff0c\u8fd9\u4e9b\u6570\u636e\u7ed3\u6784\u4ee5\u67d0\u79cd\u65b9\u5f0f\u5f15\u7528\uff08\u6307\u5411\uff09\u6570\u636e\uff0c \u8fd9\u6837\u5c31\u53ef\u4ee5\u5728\u8fd9\u4e9b\u6570\u636e\u7ed3\u6784\u4e0a\u5b9e\u73b0\u9ad8\u7ea7\u67e5\u627e\u7b97\u6cd5\uff0c\u8fd9\u79cd\u6570\u636e\u7ed3\u6784\u5c31\u662f\u7d22\u5f15\u3002\u5982\u4e0b\u9762\u7684==\u793a\u610f\u56fe==\u6240\u793a : </p> <p> </p> <p>\u5de6\u8fb9\u662f\u6570\u636e\u8868\uff0c\u4e00\u5171\u6709\u4e24\u5217\u4e03\u6761\u8bb0\u5f55\uff0c\u6700\u5de6\u8fb9\u7684\u662f\u6570\u636e\u8bb0\u5f55\u7684\u7269\u7406\u5730\u5740\uff08\u6ce8\u610f\u903b\u8f91\u4e0a\u76f8\u90bb\u7684\u8bb0\u5f55\u5728\u78c1\u76d8\u4e0a\u4e5f\u5e76\u4e0d\u662f\u4e00\u5b9a\u7269\u7406\u76f8\u90bb\u7684\uff09\u3002\u4e3a\u4e86\u52a0\u5febCol2\u7684\u67e5\u627e\uff0c\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u53f3\u8fb9\u6240\u793a\u7684\u4e8c\u53c9\u67e5\u627e\u6811\uff0c\u6bcf\u4e2a\u8282\u70b9\u5206\u522b\u5305\u542b\u7d22\u5f15\u952e\u503c\u548c\u4e00\u4e2a\u6307\u5411\u5bf9\u5e94\u6570\u636e\u8bb0\u5f55\u7269\u7406\u5730\u5740\u7684\u6307\u9488\uff0c\u8fd9\u6837\u5c31\u53ef\u4ee5\u8fd0\u7528\u4e8c\u53c9\u67e5\u627e\u5feb\u901f\u83b7\u53d6\u5230\u76f8\u5e94\u6570\u636e\u3002</p> <p>\u4e00\u822c\u6765\u8bf4\u7d22\u5f15\u672c\u8eab\u4e5f\u5f88\u5927\uff0c\u4e0d\u53ef\u80fd\u5168\u90e8\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0c\u56e0\u6b64\u7d22\u5f15\u5f80\u5f80\u4ee5\u7d22\u5f15\u6587\u4ef6\u7684\u5f62\u5f0f\u5b58\u50a8\u5728\u78c1\u76d8\u4e0a\u3002\u7d22\u5f15\u662f\u6570\u636e\u5e93\u4e2d\u7528\u6765\u63d0\u9ad8\u6027\u80fd\u7684\u6700\u5e38\u7528\u7684\u5de5\u5177\u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#_2","title":"\u4e8c\u3001\u7d22\u5f15\u4f5c\u7528","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#1","title":"1. \u4f18\u52bf","text":"<ol> <li>\u7c7b\u4f3c\u4e8e\u4e66\u7c4d\u7684\u76ee\u5f55\u7d22\u5f15\uff0c\u63d0\u9ad8\u6570\u636e\u68c0\u7d22\u7684\u6548\u7387\uff0c\u964d\u4f4e\u6570\u636e\u5e93\u7684IO\u6210\u672c\u3002</li> <li>\u901a\u8fc7\u7d22\u5f15\u5217\u5bf9\u6570\u636e\u8fdb\u884c\u6392\u5e8f\uff0c\u964d\u4f4e\u6570\u636e\u6392\u5e8f\u7684\u6210\u672c\uff0c\u964d\u4f4eCPU\u7684\u6d88\u8017\u3002</li> </ol>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#2","title":"2. \u52a3\u52bf","text":"<ol> <li> <p>\u5b9e\u9645\u4e0a\u7d22\u5f15\u4e5f\u662f\u4e00\u5f20\u8868\uff0c\u8be5\u8868\u4e2d\u4fdd\u5b58\u4e86\u4e3b\u952e\u4e0e\u7d22\u5f15\u5b57\u6bb5\uff0c\u5e76\u6307\u5411\u5b9e\u4f53\u7c7b\u7684\u8bb0\u5f55\uff0c\u6240\u4ee5\u7d22\u5f15\u5217\u4e5f\u662f\u8981\u5360\u7528\u7a7a\u95f4\u7684\u3002</p> </li> <li> <p>\u867d\u7136\u7d22\u5f15\u5927\u5927\u63d0\u9ad8\u4e86\u67e5\u8be2\u6548\u7387\uff0c\u540c\u65f6\u5374\u4e5f\u964d\u4f4e\u66f4\u65b0\u8868\u7684\u901f\u5ea6\uff0c\u5982\u5bf9\u8868\u8fdb\u884cINSERT\u3001UPDATE\u3001DELETE\u3002\u56e0\u4e3a\u66f4\u65b0\u8868\u65f6\uff0cMySQL \u4e0d\u4ec5\u8981\u4fdd\u5b58\u6570\u636e\uff0c\u8fd8\u8981\u4fdd\u5b58\u4e00\u4e0b\u7d22\u5f15\u6587\u4ef6\u6bcf\u6b21\u66f4\u65b0\u6dfb\u52a0\u4e86\u7d22\u5f15\u5217\u7684\u5b57\u6bb5\uff0c\u90fd\u4f1a\u8c03\u6574\u56e0\u4e3a\u66f4\u65b0\u6240\u5e26\u6765\u7684\u952e\u503c\u53d8\u5316\u540e\u7684\u7d22\u5f15\u4fe1\u606f\u3002</p> </li> </ol>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#_3","title":"\u4e09\u3001\u7d22\u5f15\u7ed3\u6784","text":"<p>\u7d22\u5f15\u662f\u5728MySQL\u7684\u5b58\u50a8\u5f15\u64ce\u5c42\u4e2d\u5b9e\u73b0\u7684\uff0c\u800c\u4e0d\u662f\u5728\u670d\u52a1\u5668\u5c42\u5b9e\u73b0\u7684\u3002\u6240\u4ee5\u6bcf\u79cd\u5b58\u50a8\u5f15\u64ce\u7684\u7d22\u5f15\u90fd\u4e0d\u4e00\u5b9a\u5b8c\u5168\u76f8\u540c\uff0c\u4e5f\u4e0d\u662f\u6240\u6709\u7684\u5b58\u50a8\u5f15\u64ce\u90fd\u652f\u6301\u6240\u6709\u7684\u7d22\u5f15\u7c7b\u578b\u7684\u3002MySQL\u76ee\u524d\u63d0\u4f9b\u4e86\u4ee5\u4e0b4\u79cd\u7d22\u5f15\uff1a</p> <ul> <li> <p>BTREE \u7d22\u5f15 \uff1a \u6700\u5e38\u89c1\u7684\u7d22\u5f15\u7c7b\u578b\uff0c\u5927\u90e8\u5206\u7d22\u5f15\u90fd\u652f\u6301 B \u6811\u7d22\u5f15\u3002</p> </li> <li> <p>HASH \u7d22\u5f15\uff1a\u53ea\u6709Memory\u5f15\u64ce\u652f\u6301 \uff0c \u4f7f\u7528\u573a\u666f\u7b80\u5355 \u3002</p> </li> <li>R-tree \u7d22\u5f15\uff08\u7a7a\u95f4\u7d22\u5f15\uff09\uff1a\u7a7a\u95f4\u7d22\u5f15\u662fMyISAM\u5f15\u64ce\u7684\u4e00\u4e2a\u7279\u6b8a\u7d22\u5f15\u7c7b\u578b\uff0c\u4e3b\u8981\u7528\u4e8e\u5730\u7406\u7a7a\u95f4\u6570\u636e\u7c7b\u578b\uff0c\u901a\u5e38\u4f7f\u7528\u8f83\u5c11\uff0c\u4e0d\u505a\u7279\u522b\u4ecb\u7ecd\u3002</li> <li>Full-text \uff08\u5168\u6587\u7d22\u5f15\uff09 \uff1a\u5168\u6587\u7d22\u5f15\u4e5f\u662fMyISAM\u7684\u4e00\u4e2a\u7279\u6b8a\u7d22\u5f15\u7c7b\u578b\uff0c\u4e3b\u8981\u7528\u4e8e\u5168\u6587\u7d22\u5f15\uff0cInnoDB\u4eceMysql5.6\u7248\u672c\u5f00\u59cb\u652f\u6301\u5168\u6587\u7d22\u5f15\u3002</li> </ul> MyISAM\u3001InnoDB\u3001Memory\u4e09\u79cd\u5b58\u50a8\u5f15\u64ce\u5bf9\u5404\u79cd\u7d22\u5f15\u7c7b\u578b\u7684\u652f\u6301 \u7d22\u5f15 InnoDB\u5f15\u64ce MyISAM\u5f15\u64ce Memory\u5f15\u64ce BTREE\u7d22\u5f15 \u652f\u6301 \u652f\u6301 \u652f\u6301 HASH \u7d22\u5f15 \u4e0d\u652f\u6301 \u4e0d\u652f\u6301 \u652f\u6301 R-tree \u7d22\u5f15 \u4e0d\u652f\u6301 \u652f\u6301 \u4e0d\u652f\u6301 Full-text 5.6\u7248\u672c\u4e4b\u540e\u652f\u6301 \u652f\u6301 \u4e0d\u652f\u6301 <p>\u6211\u4eec\u5e73\u5e38\u6240\u8bf4\u7684\u7d22\u5f15\uff0c\u5982\u679c\u6ca1\u6709\u7279\u522b\u6307\u660e\uff0c\u90fd\u662f\u6307B+\u6811\uff08\u591a\u8def\u641c\u7d22\u6811\uff0c\u5e76\u4e0d\u4e00\u5b9a\u662f\u4e8c\u53c9\u7684\uff09\u7ed3\u6784\u7ec4\u7ec7\u7684\u7d22\u5f15\u3002\u5176\u4e2d\u805a\u96c6\u7d22\u5f15\u3001\u590d\u5408\u7d22\u5f15\u3001\u524d\u7f00\u7d22\u5f15\u3001\u552f\u4e00\u7d22\u5f15\u9ed8\u8ba4\u90fd\u662f\u4f7f\u7528 B+tree \u7d22\u5f15\uff0c\u7edf\u79f0\u4e3a \u7d22\u5f15\u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#1-btree","title":"1. BTREE \u7ed3\u6784","text":"<p>BTree\u53c8\u53eb\u591a\u8def\u5e73\u8861\u641c\u7d22\u6811\uff0c\u4e00\u9897m\u53c9\u7684BTree\u7279\u6027\u5982\u4e0b\uff1a</p> <ul> <li>\u6811\u4e2d\u6bcf\u4e2a\u8282\u70b9\u6700\u591a\u5305\u542bm\u4e2a\u5b69\u5b50\u3002</li> <li>\u9664\u6839\u8282\u70b9\u4e0e\u53f6\u5b50\u8282\u70b9\u5916\uff0c\u6bcf\u4e2a\u8282\u70b9\u81f3\u5c11\u6709[ceil(m/2)]\u4e2a\u5b69\u5b50\u3002</li> <li>\u82e5\u6839\u8282\u70b9\u4e0d\u662f\u53f6\u5b50\u8282\u70b9\uff0c\u5219\u81f3\u5c11\u6709\u4e24\u4e2a\u5b69\u5b50\u3002</li> <li>\u6240\u6709\u7684\u53f6\u5b50\u8282\u70b9\u90fd\u5728\u540c\u4e00\u5c42\u3002</li> <li>\u6bcf\u4e2a\u975e\u53f6\u5b50\u8282\u70b9\u7531n\u4e2akey\u4e0en+1\u4e2a\u6307\u9488\u7ec4\u6210\uff0c\u5176\u4e2d[ceil(m/2)-1] &lt;= n &lt;= m-1 </li> </ul> <p>\u4ee55\u53c9BTree\u4e3a\u4f8b\uff0ckey\u7684\u6570\u91cf\uff1a\u516c\u5f0f\u63a8\u5bfc[ceil(m/2)-1] &lt;= n &lt;= m-1\u3002\u6240\u4ee5 2 &lt;= n &lt;=4 \u3002\u5f53n&gt;4\u65f6\uff0c\u4e2d\u95f4\u8282\u70b9\u5206\u88c2\u5230\u7236\u8282\u70b9\uff0c\u4e24\u8fb9\u8282\u70b9\u5206\u88c2\u3002</p> <p>\u63d2\u5165 C N G A H E K Q M F W L T Z D P R X Y S \u6570\u636e\u4e3a\u4f8b\u3002</p> <p>\u6f14\u53d8\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <p>1). \u63d2\u5165\u524d4\u4e2a\u5b57\u6bcd C N G A </p> <p> </p> <p>2). \u63d2\u5165H\uff0cn&gt;4\uff0c\u4e2d\u95f4\u5143\u7d20G\u5b57\u6bcd\u5411\u4e0a\u5206\u88c2\u5230\u65b0\u7684\u8282\u70b9</p> <p> </p> <p>3). \u63d2\u5165E\uff0cK\uff0cQ\u4e0d\u9700\u8981\u5206\u88c2</p> <p> </p> <p>4). \u63d2\u5165M\uff0c\u4e2d\u95f4\u5143\u7d20M\u5b57\u6bcd\u5411\u4e0a\u5206\u88c2\u5230\u7236\u8282\u70b9G</p> <p> </p> <p>5). \u63d2\u5165F\uff0cW\uff0cL\uff0cT\u4e0d\u9700\u8981\u5206\u88c2</p> <p> </p> <p>6). \u63d2\u5165Z\uff0c\u4e2d\u95f4\u5143\u7d20T\u5411\u4e0a\u5206\u88c2\u5230\u7236\u8282\u70b9\u4e2d </p> <p> </p> <p>7). \u63d2\u5165D\uff0c\u4e2d\u95f4\u5143\u7d20D\u5411\u4e0a\u5206\u88c2\u5230\u7236\u8282\u70b9\u4e2d\u3002\u7136\u540e\u63d2\u5165P\uff0cR\uff0cX\uff0cY\u4e0d\u9700\u8981\u5206\u88c2</p> <p> </p> <p>8). \u6700\u540e\u63d2\u5165S\uff0cNPQR\u8282\u70b9n&gt;5\uff0c\u4e2d\u95f4\u8282\u70b9Q\u5411\u4e0a\u5206\u88c2\uff0c\u4f46\u5206\u88c2\u540e\u7236\u8282\u70b9DGMT\u7684n&gt;5\uff0c\u4e2d\u95f4\u8282\u70b9M\u5411\u4e0a\u5206\u88c2</p> <p> </p> <p>\u5230\u6b64\uff0c\u8be5BTREE\u6811\u5c31\u5df2\u7ecf\u6784\u5efa\u5b8c\u6210\u4e86\uff0c BTREE\u6811 \u548c \u4e8c\u53c9\u6811 \u76f8\u6bd4\uff0c \u67e5\u8be2\u6570\u636e\u7684\u6548\u7387\u66f4\u9ad8\uff0c \u56e0\u4e3a\u5bf9\u4e8e\u76f8\u540c\u7684\u6570\u636e\u91cf\u6765\u8bf4\uff0cBTREE\u7684\u5c42\u7ea7\u7ed3\u6784\u6bd4\u4e8c\u53c9\u6811\u5c0f\uff0c\u56e0\u6b64\u641c\u7d22\u901f\u5ea6\u5feb\u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#2-btree","title":"2. B+TREE \u7ed3\u6784","text":"<p>B+Tree\u4e3aBTree\u7684\u53d8\u79cd\uff0cB+Tree\u4e0eBTree\u7684\u533a\u522b\u4e3a\uff1a</p> <p>1). n\u53c9B+Tree\u6700\u591a\u542b\u6709n\u4e2akey\uff0c\u800cBTree\u6700\u591a\u542b\u6709n-1\u4e2akey\u3002</p> <p>2). B+Tree\u7684\u53f6\u5b50\u8282\u70b9\u4fdd\u5b58\u6240\u6709\u7684key\u4fe1\u606f\uff0c\u4f9dkey\u5927\u5c0f\u987a\u5e8f\u6392\u5217\u3002</p> <p>3). \u6240\u6709\u7684\u975e\u53f6\u5b50\u8282\u70b9\u90fd\u53ef\u4ee5\u770b\u4f5c\u662fkey\u7684\u7d22\u5f15\u90e8\u5206\u3002</p> <p> </p> <p>\u7531\u4e8eB+Tree\u53ea\u6709\u53f6\u5b50\u8282\u70b9\u4fdd\u5b58key\u4fe1\u606f\uff0c\u67e5\u8be2\u4efb\u4f55key\u90fd\u8981\u4eceroot\u8d70\u5230\u53f6\u5b50\u3002\u6240\u4ee5B+Tree\u7684\u67e5\u8be2\u6548\u7387\u66f4\u52a0\u7a33\u5b9a\u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#3-mysqlbtree","title":"3. MySQL\u4e2d\u7684B+Tree","text":"<p>MySql\u7d22\u5f15\u6570\u636e\u7ed3\u6784\u5bf9\u7ecf\u5178\u7684B+Tree\u8fdb\u884c\u4e86\u4f18\u5316\u3002\u5728\u539fB+Tree\u7684\u57fa\u7840\u4e0a\uff0c\u589e\u52a0\u4e00\u4e2a\u6307\u5411\u76f8\u90bb\u53f6\u5b50\u8282\u70b9\u7684\u94fe\u8868\u6307\u9488\uff0c\u5c31\u5f62\u6210\u4e86\u5e26\u6709\u987a\u5e8f\u6307\u9488\u7684B+Tree\uff0c\u63d0\u9ad8\u533a\u95f4\u8bbf\u95ee\u7684\u6027\u80fd\u3002</p> <p>MySQL\u4e2d\u7684 B+Tree \u7d22\u5f15\u7ed3\u6784\u793a\u610f\u56fe: </p> <p> </p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#_4","title":"\u56db\u3001\u7d22\u5f15\u7684\u79cd\u7c7b","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#1_1","title":"1. \u805a\u7c07\u7d22\u5f15","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#2_1","title":"2. \u8f85\u52a9\u7d22\u5f15\uff08\u4e8c\u7ea7\u7d22\u5f15\uff09","text":"<p>\u8f85\u52a9\u7d22\u5f15\u548c\u805a\u7c07\u7d22\u5f15\u7684\u533a\u522b</p> <ol> <li>\u805a\u7c07\u7d22\u5f15\u53ea\u80fd\u6709\u4e00\u4e2a\uff0c\u975e\u7a7a\u552f\u4e00\uff0c\u4e00\u822c\u662f\u4e3b\u952e</li> <li>\u8f85\u52a9\u7d22\u5f15\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u662f\u914d\u5408\u805a\u7c07\u7d22\u5f15\u4f7f\u7528\u7684</li> <li>\u805a\u7c07\u7d22\u5f15\u53f6\u8282\u70b9\u5c31\u662f\u78c1\u76d8\u6570\u636e\u884c\u5b58\u50a8\u7684\u6570\u636e\u9875</li> <li>MySQL\u6839\u636e\u805a\u7c07\u7d22\u5f15\u7ec4\u7ec7\u5b58\u50a8\u7ed3\u6784\uff0c\u6570\u636e\u5b58\u50a8\u65f6\u5c31\u662f\u6309\u7167\u805a\u7c07\u7d22\u5f15\u7684\u987a\u5e8f\u8fdb\u884c\u5b58\u50a8\u6570\u636e</li> <li>\u8f85\u52a9\u7d22\u5f15\u53ea\u4f1a\u63d0\u53d6\u7d22\u5f15\u952e\u503c\u8fdb\u884c\u81ea\u52a8\u6392\u5e8f\u751f\u6210B\u6811</li> </ol>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#21","title":"2.1 \u8f85\u52a9\u7d22\u5f15\u7684\u5206\u7c7b","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#211","title":"2.1.1 \u666e\u901a\u7d22\u5f15","text":"<p>\u57fa\u672c\u7d22\u5f15\u7c7b\u578b\uff0c\u5141\u8bb8\u5728\u5b9a\u4e49\u7d22\u5f15\u7684\u5217\u4e2d\u63d2\u5165\u91cd\u590d\u503c\u548c\u7a7a\u503c\uff0c\u5176\u4f5c\u7528\u53ea\u662f\u52a0\u5feb\u6570\u636e\u7684\u8bbf\u95ee\u901f\u5ea6\u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#212","title":"2.1.2 \u552f\u4e00\u7d22\u5f15","text":"<p>\u7d22\u5f15\u5217\u7684\u503c\u5fc5\u987b\u552f\u4e00\uff0c\u53ef\u4ee5\u5141\u8bb8\u6709\u7a7a\u503c\uff0c\u53ef\u4ee5\u51cf\u5c11\u67e5\u8be2\u7d22\u5f15\u5217\u64cd\u4f5c\u7684\u65f6\u95f4\uff0c\u5c24\u5176\u662f\u5bf9\u6bd4\u8f83\u5e9e\u5927\u7684\u6570\u636e\u8868</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#213","title":"2.1.3 \u5355\u5217\u7d22\u5f15","text":"<p>\u4e00\u4e2a\u7d22\u5f15\u53ea\u5305\u542b\u5355\u4e2a\u5217\uff0c\u4e00\u4e2a\u8868\u53ef\u4ee5\u6709\u591a\u4e2a\u5355\u5217\u7d22\u5f15</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#214","title":"2.1.4 \u7ec4\u5408\u7d22\u5f15","text":"<p>\u5728\u8868\u7684\u591a\u4e2a\u5b57\u6bb5\u4e0a\u7ec4\u4e2a\u521b\u5efa\u7d22\u5f15\uff0c\u53ea\u6709\u5728\u67e5\u8be2\u6761\u4ef6\u4e2d\u4f7f\u7528\u4e86\u8fd9\u4e9b\u5b57\u6bb5\u7684\u5de6\u8fb9\u5b57\u6bb5\u65f6\uff0c\u7d22\u5f15\u624d\u4f1a\u88ab\u4f7f\u7528</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#_5","title":"\u4e94\u3001\u7d22\u5f15\u8bed\u6cd5","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#1_2","title":"1. \u521b\u5efa\u7d22\u5f15","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#11","title":"1.1 \u521b\u5efa\u8868\u7684\u65f6\u5019\u521b\u5efa\u7d22\u5f15","text":"<p>\u8bed\u6cd5\u89c4\u5219</p> <pre><code>CREATE TABLE \u8868\u540d(\u5b57\u6bb5\u540d \u6570\u636e\u7c7b\u578b [\u5b8c\u6574\u6027\u7ea6\u675f\u6761\u4ef6],\n[UNIQUE | FULLTEXT | SPATIAL ] INDEX | KEY\n[\u522b\u540d] (\u5b57\u6bb5\u540d [(\u957f\u5ea6)] [ASC | DESC ] )\n);\n\nUNIQUE:\u552f\u4e00\u6027\u7d22\u5f15\nFULLTEXT\uff1a\u5168\u6587\u7d22\u5f15\nSPATIAL\uff1a\u7a7a\u95f4\u7d22\u5f15\nINDEX|KEY \uff1a\u4f5c\u7528\u76f8\u540c\uff0c\u7528\u6765\u6267\u884c\u521b\u5efa\u7d22\u5f15\n\u957f\u5ea6\uff1a\u6307\u5b9a\u7d22\u5f15\u7684\u957f\u5ea6\nASC | DESC \uff1a \u5347\u5e8f\u6216\u964d\u5e8f\u7684\u7d22\u5f15\u503c\u5b58\u50a8\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#111","title":"1.1.1 \u521b\u5efa\u666e\u901a\u7d22\u5f15","text":"<pre><code>CREATE TABLE accounts(\n            id int PRIMARY KEY AUTO_INCREMENT,\n            username VARCHAR(20),\n            password VARCHAR(20),\n            INDEX(username)\n            );\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#112","title":"1.1.2 \u521b\u5efa\u552f\u4e00\u7d22\u5f15","text":"<pre><code>CREATE TABLE accounts(\n            id int PRIMARY KEY AUTO_INCREMENT,\n            username VARCHAR(20),\n            password VARCHAR(20),\n            UNIQUE INDEX(username)\n            );\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#113","title":"1.1.3 \u521b\u5efa\u5355\u5217\u7d22\u5f15","text":"<pre><code>CREATE TABLE accounts(\n            id int PRIMARY KEY AUTO_INCREMENT,\n            username VARCHAR(20),\n            password VARCHAR(20),\n            UNIQUE INDEX user(username)\n            );\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#114","title":"1.1.4 \u521b\u5efa\u7ec4\u5408\u7d22\u5f15","text":"<pre><code>CREATE TABLE accounts(\nusername VARCHAR(20),\nemail VARCHAR(50),\npassword VARCHAR(20),\nINDEX user(username,email)\n);\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#12","title":"1.2 \u5728\u5df2\u7ecf\u5b58\u5728\u7684\u8868\u4e0a\u521b\u5efa\u7d22\u5f15","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#121-alter-table","title":"1.2.1 \u4f7f\u7528ALTER TABLE\u8bed\u53e5\u521b\u5efa\u7d22\u5f15","text":"<p>\u8bed\u6cd5\u89c4\u5219</p> <pre><code>ALTER TABLE \u8868\u540d ADD [UNIQUE|FULLTEXT|SPATIAL] [INDEX|KEY] [\u7d22\u5f15\u540d] (\u5b57\u6bb5\u540d[(\u957f\u5ea6)] [ASC|DESC])\n</code></pre> <p>\u4f8b\uff1a</p> <pre><code>ALTER TABLE accounts ADD INDEX user (username);\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#122-create-index","title":"1.2.2 \u4f7f\u7528CREATE INDEX\u521b\u5efa\u7d22\u5f15","text":"<p>\u8bed\u6cd5\u89c4\u5219</p> <pre><code>CREATE [UNIQUE|FULLTEXT|SPATIAL] INDEX \u7d22\u5f15\u540d ON \u8868\u540d (\u5b57\u6bb5\u540d [(\u957f\u5ea6)] [ASC|DESC])\n</code></pre> <pre><code>CREATE UNIQUE INDEX user on accounts (username);\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#2_2","title":"2. \u5220\u9664\u7d22\u5f15","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#21-alter-table","title":"2.1 \u4f7f\u7528ALTER TABLE\u5220\u9664\u7d22\u5f15","text":"<p>\u8bed\u6cd5\u89c4\u5219</p> <pre><code>ALTER TABLE \u8868\u540d DROP INDEX \u7d22\u5f15\u540d;\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#22-drop-index","title":"2.2 \u4f7f\u7528DROP INDEX\u8bed\u53e5\u5220\u9664\u7d22\u5f15","text":"<pre><code>DROP INDEX \u7d22\u5f15\u540d ON \u8868\u540d;\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#3","title":"3. \u67e5\u770b\u7d22\u5f15","text":"<pre><code>SHOW INDEX FROM city;\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95/#_6","title":"\u516d\u3001 \u7d22\u5f15\u5efa\u7acb\u539f\u5219","text":"<p>\u7d22\u5f15\u7684\u8bbe\u8ba1\u53ef\u4ee5\u9075\u5faa\u4e00\u4e9b\u5df2\u6709\u7684\u539f\u5219\uff0c\u521b\u5efa\u7d22\u5f15\u7684\u65f6\u5019\u8bf7\u5c3d\u91cf\u8003\u8651\u7b26\u5408\u8fd9\u4e9b\u539f\u5219\uff0c\u4fbf\u4e8e\u63d0\u5347\u7d22\u5f15\u7684\u4f7f\u7528\u6548\u7387\uff0c\u66f4\u9ad8\u6548\u7684\u4f7f\u7528\u7d22\u5f15\u3002</p> <ul> <li> <p>\u5bf9\u67e5\u8be2\u9891\u6b21\u8f83\u9ad8\uff0c\u4e14\u6570\u636e\u91cf\u6bd4\u8f83\u5927\u7684\u8868\u5efa\u7acb\u7d22\u5f15\u3002</p> </li> <li> <p>\u7d22\u5f15\u5b57\u6bb5\u7684\u9009\u62e9\uff0c\u6700\u4f73\u5019\u9009\u5217\u5e94\u5f53\u4ecewhere\u5b50\u53e5\u7684\u6761\u4ef6\u4e2d\u63d0\u53d6\uff0c\u5982\u679cwhere\u5b50\u53e5\u4e2d\u7684\u7ec4\u5408\u6bd4\u8f83\u591a\uff0c\u90a3\u4e48\u5e94\u5f53\u6311\u9009\u6700\u5e38\u7528\u3001\u8fc7\u6ee4\u6548\u679c\u6700\u597d\u7684\u5217\u7684\u7ec4\u5408\u3002</p> </li> <li> <p>\u4f7f\u7528\u552f\u4e00\u7d22\u5f15\uff0c\u533a\u5206\u5ea6\u8d8a\u9ad8\uff0c\u4f7f\u7528\u7d22\u5f15\u7684\u6548\u7387\u8d8a\u9ad8\u3002</p> </li> <li> <p>\u7d22\u5f15\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u5347\u67e5\u8be2\u6570\u636e\u7684\u6548\u7387\uff0c\u4f46\u7d22\u5f15\u6570\u91cf\u4e0d\u662f\u591a\u591a\u76ca\u5584\uff0c\u7d22\u5f15\u8d8a\u591a\uff0c\u7ef4\u62a4\u7d22\u5f15\u7684\u4ee3\u4ef7\u81ea\u7136\u4e5f\u5c31\u6c34\u6da8\u8239\u9ad8\u3002\u5bf9\u4e8e\u63d2\u5165\u3001\u66f4\u65b0\u3001\u5220\u9664\u7b49DML\u64cd\u4f5c\u6bd4\u8f83\u9891\u7e41\u7684\u8868\u6765\u8bf4\uff0c\u7d22\u5f15\u8fc7\u591a\uff0c\u4f1a\u5f15\u5165\u76f8\u5f53\u9ad8\u7684\u7ef4\u62a4\u4ee3\u4ef7\uff0c\u964d\u4f4eDML\u64cd\u4f5c\u7684\u6548\u7387\uff0c\u589e\u52a0\u76f8\u5e94\u64cd\u4f5c\u7684\u65f6\u95f4\u6d88\u8017\u3002\u53e6\u5916\u7d22\u5f15\u8fc7\u591a\u7684\u8bdd\uff0cMySQL\u4e5f\u4f1a\u72af\u9009\u62e9\u56f0\u96be\u75c5\uff0c\u867d\u7136\u6700\u7ec8\u4ecd\u7136\u4f1a\u627e\u5230\u4e00\u4e2a\u53ef\u7528\u7684\u7d22\u5f15\uff0c\u4f46\u65e0\u7591\u63d0\u9ad8\u4e86\u9009\u62e9\u7684\u4ee3\u4ef7\u3002</p> </li> <li> <p>\u4f7f\u7528\u77ed\u7d22\u5f15\uff0c\u7d22\u5f15\u521b\u5efa\u4e4b\u540e\u4e5f\u662f\u4f7f\u7528\u786c\u76d8\u6765\u5b58\u50a8\u7684\uff0c\u56e0\u6b64\u63d0\u5347\u7d22\u5f15\u8bbf\u95ee\u7684I/O\u6548\u7387\uff0c\u4e5f\u53ef\u4ee5\u63d0\u5347\u603b\u4f53\u7684\u8bbf\u95ee\u6548\u7387\u3002\u5047\u5982\u6784\u6210\u7d22\u5f15\u7684\u5b57\u6bb5\u603b\u957f\u5ea6\u6bd4\u8f83\u77ed\uff0c\u90a3\u4e48\u5728\u7ed9\u5b9a\u5927\u5c0f\u7684\u5b58\u50a8\u5757\u5185\u53ef\u4ee5\u5b58\u50a8\u66f4\u591a\u7684\u7d22\u5f15\u503c\uff0c\u76f8\u5e94\u7684\u53ef\u4ee5\u6709\u6548\u7684\u63d0\u5347MySQL\u8bbf\u95ee\u7d22\u5f15\u7684I/O\u6548\u7387\u3002</p> </li> <li> <p>\u5229\u7528\u6700\u5de6\u524d\u7f00\uff0cN\u4e2a\u5217\u7ec4\u5408\u800c\u6210\u7684\u7ec4\u5408\u7d22\u5f15\uff0c\u90a3\u4e48\u76f8\u5f53\u4e8e\u662f\u521b\u5efa\u4e86N\u4e2a\u7d22\u5f15\uff0c\u5982\u679c\u67e5\u8be2\u65f6where\u5b50\u53e5\u4e2d\u4f7f\u7528\u4e86\u7ec4\u6210\u8be5\u7d22\u5f15\u7684\u524d\u51e0\u4e2a\u5b57\u6bb5\uff0c\u90a3\u4e48\u8fd9\u6761\u67e5\u8be2SQL\u53ef\u4ee5\u5229\u7528\u7ec4\u5408\u7d22\u5f15\u6765\u63d0\u5347\u67e5\u8be2\u6548\u7387\u3002</p> <pre><code>-- \u521b\u5efa\u590d\u5408\u7d22\u5f15:\n    CREATE INDEX idx_name_email_status ON tb_seller(NAME,email,STATUS);\n\n-- \u5c31\u76f8\u5f53\u4e8e\n--  \u5bf9name \u521b\u5efa\u7d22\u5f15 ;\n--  \u5bf9name , email \u521b\u5efa\u4e86\u7d22\u5f15 ;\n--  \u5bf9name , email, status \u521b\u5efa\u4e86\u7d22\u5f15 ;\n</code></pre> </li> </ul>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/","title":"\u7d22\u5f15\u4f18\u5316","text":""},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#_1","title":"\u4e00\u3001\u907f\u514d\u7d22\u5f15\u5931\u6548","text":"<p>\u73af\u5883\u51c6\u5907</p> <pre><code>create table `tb_seller` (\n    `sellerid` varchar (100),\n    `name` varchar (100),\n    `nickname` varchar (50),\n    `password` varchar (60),\n    `status` varchar (1),\n    `address` varchar (100),\n    `createtime` datetime,\n    primary key(`sellerid`)\n)engine=innodb default charset=utf8mb4; \n\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('alibaba','\u963f\u91cc\u5df4\u5df4','\u963f\u91cc\u5c0f\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('baidu','\u767e\u5ea6\u79d1\u6280\u6709\u9650\u516c\u53f8','\u767e\u5ea6\u5c0f\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('huawei','\u534e\u4e3a\u79d1\u6280\u6709\u9650\u516c\u53f8','\u534e\u4e3a\u5c0f\u5e97','e10adc3949ba59abbe56e057f20f883e','0','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('itcast','\u4f20\u667a\u64ad\u5ba2\u6559\u80b2\u79d1\u6280\u6709\u9650\u516c\u53f8','\u4f20\u667a\u64ad\u5ba2','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('itheima','\u9ed1\u9a6c\u7a0b\u5e8f\u5458','\u9ed1\u9a6c\u7a0b\u5e8f\u5458','e10adc3949ba59abbe56e057f20f883e','0','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('luoji','\u7f57\u6280\u79d1\u6280\u6709\u9650\u516c\u53f8','\u7f57\u6280\u5c0f\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('oppo','OPPO\u79d1\u6280\u6709\u9650\u516c\u53f8','OPPO\u5b98\u65b9\u65d7\u8230\u5e97','e10adc3949ba59abbe56e057f20f883e','0','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('ourpalm','\u638c\u8da3\u79d1\u6280\u80a1\u4efd\u6709\u9650\u516c\u53f8','\u638c\u8da3\u5c0f\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('qiandu','\u5343\u5ea6\u79d1\u6280','\u5343\u5ea6\u5c0f\u5e97','e10adc3949ba59abbe56e057f20f883e','2','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('sina','\u65b0\u6d6a\u79d1\u6280\u6709\u9650\u516c\u53f8','\u65b0\u6d6a\u5b98\u65b9\u65d7\u8230\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('xiaomi','\u5c0f\u7c73\u79d1\u6280','\u5c0f\u7c73\u5b98\u65b9\u65d7\u8230\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u897f\u5b89\u5e02','2088-01-01 12:00:00');\nINSERT INTO `tb_seller` (`sellerid`, `name`, `nickname`, `password`, `status`, `address`, `createtime`) VALUES('yijia','\u5b9c\u5bb6\u5bb6\u5c45','\u5b9c\u5bb6\u5bb6\u5c45\u65d7\u8230\u5e97','e10adc3949ba59abbe56e057f20f883e','1','\u5317\u4eac\u5e02','2088-01-01 12:00:00');\n\n\ncreate index idx_seller_name_sta_addr on tb_seller(name,status,address);\n</code></pre> <pre><code>mysql [test]&gt;select * from tb_seller;\n+----------+--------------------------------------+-----------------------+----------------------------------+--------+-----------+---------------------+\n| sellerid | name                                 | nickname              | password                         | status | address   | createtime          |\n+----------+--------------------------------------+-----------------------+----------------------------------+--------+-----------+---------------------+\n| alibaba  | \u963f\u91cc\u5df4\u5df4                             | \u963f\u91cc\u5c0f\u5e97              | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| baidu    | \u767e\u5ea6\u79d1\u6280\u6709\u9650\u516c\u53f8                     | \u767e\u5ea6\u5c0f\u5e97              | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| huawei   | \u534e\u4e3a\u79d1\u6280\u6709\u9650\u516c\u53f8                     | \u534e\u4e3a\u5c0f\u5e97              | e10adc3949ba59abbe56e057f20f883e | 0      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| itcast   | \u4f20\u667a\u64ad\u5ba2\u6559\u80b2\u79d1\u6280\u6709\u9650\u516c\u53f8             | \u4f20\u667a\u64ad\u5ba2              | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| itheima  | \u9ed1\u9a6c\u7a0b\u5e8f\u5458                           | \u9ed1\u9a6c\u7a0b\u5e8f\u5458            | e10adc3949ba59abbe56e057f20f883e | 0      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| luoji    | \u7f57\u6280\u79d1\u6280\u6709\u9650\u516c\u53f8                     | \u7f57\u6280\u5c0f\u5e97              | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| oppo     | OPPO\u79d1\u6280\u6709\u9650\u516c\u53f8                     | OPPO\u5b98\u65b9\u65d7\u8230\u5e97        | e10adc3949ba59abbe56e057f20f883e | 0      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| ourpalm  | \u638c\u8da3\u79d1\u6280\u80a1\u4efd\u6709\u9650\u516c\u53f8                 | \u638c\u8da3\u5c0f\u5e97              | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| qiandu   | \u5343\u5ea6\u79d1\u6280                             | \u5343\u5ea6\u5c0f\u5e97              | e10adc3949ba59abbe56e057f20f883e | 2      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| sina     | \u65b0\u6d6a\u79d1\u6280\u6709\u9650\u516c\u53f8                     | \u65b0\u6d6a\u5b98\u65b9\u65d7\u8230\u5e97        | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n| xiaomi   | \u5c0f\u7c73\u79d1\u6280                             | \u5c0f\u7c73\u5b98\u65b9\u65d7\u8230\u5e97        | e10adc3949ba59abbe56e057f20f883e | 1      | \u897f\u5b89\u5e02    | 2088-01-01 12:00:00 |\n| yijia    | \u5b9c\u5bb6\u5bb6\u5c45                             | \u5b9c\u5bb6\u5bb6\u5c45\u65d7\u8230\u5e97        | e10adc3949ba59abbe56e057f20f883e | 1      | \u5317\u4eac\u5e02    | 2088-01-01 12:00:00 |\n+----------+--------------------------------------+-----------------------+----------------------------------+--------+-----------+---------------------+\n12 rows in set (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#1","title":"1. \u5168\u503c\u5339\u914d","text":"<p>\u5bf9\u7d22\u5f15\u4e2d\u6240\u6709\u7684\u7c7b\u90fd\u6267\u884c\u5177\u4f53\u7684\u503c\uff0c\u8be5\u60c5\u51b5\u4e0b\uff0c\u7d22\u5f15\u751f\u6548\uff0c\u6267\u884c\u6548\u7387\u9ad8\u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1' AND address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref               | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 813     | const,const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u548c\u5b57\u6bb5\u7684\u5148\u540e\u987a\u5e8f\u6ca1\u6709\u5173\u7cfb\u3002</p> <pre><code># \u8c03\u6574WHERE\u5b57\u6bb5\u987a\u5e8f\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE  status = '1' AND address = '\u5317\u4eac\u5e02' AND name = '\u5c0f\u7c73\u79d1\u6280';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref               | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 813     | const,const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#2","title":"2. \u6700\u5de6\u524d\u7f00\u6cd5\u5219","text":"<p>\u5982\u679c\u7d22\u5f15\u4e86\u591a\u5217\uff0c\u8981\u9075\u5b88\u6700\u5de6\u524d\u7f00\u6cd5\u5219\u3002\u6307\u7684\u662f\u67e5\u8be2\u4ece\u7d22\u5f15\u7684\u6700\u5de6\u524d\u5217\u5f00\u59cb\uff0c\u5e76\u4e14\u4e0d\u8df3\u8fc7\u7d22\u5f15\u4e2d\u7684\u5217\u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#21","title":"2.1 \u5339\u914d\u6700\u5de6\u524d\u7f00\u6cd5\u5219\uff0c\u8d70\u7d22\u5f15","text":"<pre><code># \u6ce8\u610f\u89c2\u5bdfkey_len\u7684\u957f\u5ea6\uff0c\u7d22\u5f15\u7684\u957f\u5ea6\u53d1\u751f\u53d8\u5316\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 403     | const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref         | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 410     | const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1' AND address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref               | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 813     | const,const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#22","title":"2.2 \u8fdd\u6cd5\u6700\u5de6\u524d\u7f00\u6cd5\u5219 \uff0c \u7d22\u5f15\u5931\u6548","text":"<pre><code># \u6ce8\u610fkey\u7684\u503c\u6b64\u65f6\u4e3aNULL\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE status = '1' AND address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |     8.33 | Using where |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE status = '1';\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |    10.00 | Using where |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#23","title":"2.3 \u5982\u679c\u7b26\u5408\u6700\u5de6\u6cd5\u5219\uff0c\u4f46\u662f\u51fa\u73b0\u8df3\u8dc3\u67d0\u4e00\u5217\uff0c\u53ea\u6709\u6700\u5de6\u5217\u7d22\u5f15\u751f\u6548","text":"<pre><code># \u53ea\u7528\u5230name\u5b57\u6bb5\u7684\u6240\u6709\uff0caddress\u5e76\u6ca1\u6709\u7528\u5230\u3002\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-----------------------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref   | rows | filtered | Extra                 |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-----------------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 403     | const |    1 |    10.00 | Using index condition |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-----------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#3","title":"3. \u8303\u56f4\u67e5\u8be2\u53f3\u8fb9\u7684\u5217\uff0c\u4e0d\u80fd\u4f7f\u7528\u7d22\u5f15","text":"<pre><code># \u53ea\u6709name\u548caddress\u4f7f\u7528\u4e86\u7d22\u5f15\uff0caddress\u7684\u7d22\u5f15\u5931\u6548\u3002\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status &gt; '1' AND address = '\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+-------+--------------------------+--------------------------+---------+------+------+----------+-----------------------+\n| id | select_type | table     | partitions | type  | possible_keys            | key                      | key_len | ref  | rows | filtered | Extra                 |\n+----+-------------+-----------+------------+-------+--------------------------+--------------------------+---------+------+------+----------+-----------------------+\n|  1 | SIMPLE      | tb_seller | NULL       | range | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 410     | NULL |    1 |    10.00 | Using index condition |\n+----+-------------+-----------+------------+-------+--------------------------+--------------------------+---------+------+------+----------+-----------------------+\n1 row in set, 1 warning (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#4","title":"4. \u4e0d\u8981\u5728\u7d22\u5f15\u5217\u4e0a\u8fdb\u884c\u8fd0\u7b97\u64cd\u4f5c","text":"<p>\u5728\u7d22\u5f15\u5217\u4e0a\u4f5c\u4efb\u4f55\u8fd0\u7b97\u64cd\u4f5c\uff08\u8ba1\u7b97\u3001\u51fd\u6570\u3001\uff08\u81ea\u52a8or\u624b\u52a8\uff09\u7c7b\u578b\u8f6c\u6362\uff09\uff0c\u4f1a\u5bfc\u81f4\u7d22\u5f15\u5931\u6548\u800c\u8f6c\u5411\u5168\u8868\u626b\u63cf </p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE substring(name, 3, 2) = '\u79d1\u6280';\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |   100.00 | Using where |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#5","title":"5.  \u5b57\u7b26\u4e32\u4e0d\u52a0\u5355\u5f15\u53f7\u7d22\u5f15\u5931\u6548","text":"<p>\u5728\u67e5\u8be2\u65f6\uff0c\u6ca1\u6709\u5bf9\u5b57\u7b26\u4e32\u52a0\u5355\u5f15\u53f7\uff0cMySQL\u7684\u67e5\u8be2\u4f18\u5316\u5668\uff0c\u4f1a\u81ea\u52a8\u7684\u8fdb\u884c\u7c7b\u578b\u8f6c\u6362\uff0c\u9020\u6210\u7d22\u5f15\u5931\u6548\u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref         | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 410     | const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n# status = 1\u6ca1\u6709\u52a0\u5355\u5f15\u53f7\uff0cstatus\u7684\u7d22\u5f15\u5931\u6548\u3002\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = 1;\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-----------------------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref   | rows | filtered | Extra                 |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-----------------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 403     | const |    1 |    10.00 | Using index condition |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-----------------------+\n1 row in set, 2 warnings (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#6-select","title":"6. \u5c3d\u91cf\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\uff0c\u907f\u514d<code>select *</code>","text":"<p>\u53ea\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\uff08\u7d22\u5f15\u53f7\u5305\u542b\u67e5\u8be2\u5217\uff09\uff0c\u6548\u7387\u9ad8</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT name,status,address FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1' AND address = '\u897f\u5b89\u5e02';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref               | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 813     | const,const,const |    1 |   100.00 | Using index |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u67e5\u8be2\u5217\u8d85\u51fa\u7d22\u5f15\u5217\uff0c\u6027\u80fd\u964d\u4f4e</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT name,status,address,password FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1' AND address = '\u897f\u5b89\u5e02';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref               | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 813     | const,const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND status = '1' AND address = '\u897f\u5b89\u5e02';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref               | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 813     | const,const,const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------------------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>using index \uff1a\u4f7f\u7528\u8986\u76d6\u7d22\u5f15\u7684\u65f6\u5019\u5c31\u4f1a\u51fa\u73b0 using where\uff1a\u5728\u67e5\u627e\u4f7f\u7528\u7d22\u5f15\u7684\u60c5\u51b5\u4e0b\uff0c\u9700\u8981\u56de\u8868\u53bb\u67e5\u8be2\u6240\u9700\u7684\u6570\u636e using index condition\uff1a\u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15\uff0c\u4f46\u662f\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e using index ; using where\uff1a\u67e5\u627e\u4f7f\u7528\u4e86\u7d22\u5f15\uff0c\u4f46\u662f\u9700\u8981\u7684\u6570\u636e\u90fd\u5728\u7d22\u5f15\u5217\u4e2d\u80fd\u627e\u5230\uff0c\u6240\u4ee5\u4e0d\u9700\u8981\u56de\u8868\u67e5\u8be2\u6570\u636e</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#7-or","title":"7. \u4f7f\u7528<code>or</code>\u8fde\u63a5\u7d22\u5f15\u4f1a\u5931\u6548","text":"<p>\u7528or\u5206\u5272\u5f00\u7684\u6761\u4ef6\uff0c \u5982\u679cor\u524d\u7684\u6761\u4ef6\u4e2d\u7684\u5217\u6709\u7d22\u5f15\uff0c\u800c\u540e\u9762\u7684\u5217\u4e2d\u6ca1\u6709\u7d22\u5f15\uff0c\u90a3\u4e48\u6d89\u53ca\u7684\u7d22\u5f15\u90fd\u4e0d\u4f1a\u88ab\u7528\u5230\u3002</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' AND nickname = '\u5c0f\u7c73\u5b98\u65b9\u65d7\u8230\u5e97';\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys            | key                      | key_len | ref   | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_name_sta_addr | idx_seller_name_sta_addr | 403     | const |    1 |    10.00 | Using where |\n+----+-------------+-----------+------------+------+--------------------------+--------------------------+---------+-------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n# \u4f7f\u7528OR\u65f6:type\u4e3aALL\u3001key\u4e3aNULL\uff0c\u6ca1\u6709\u8d70\u7d22\u5f15\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name = '\u5c0f\u7c73\u79d1\u6280' OR nickname = '\u5c0f\u7c73\u5b98\u65b9\u65d7\u8230\u5e97';\n+----+-------------+-----------+------------+------+--------------------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys            | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | idx_seller_name_sta_addr | NULL | NULL    | NULL |   12 |    19.00 | Using where |\n+----+-------------+-----------+------------+------+--------------------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#8-like","title":"8. \u4ee5<code>%</code>\u5f00\u5934\u7684<code>LIKE</code>\u6a21\u7cca\u67e5\u8be2\uff0c\u7d22\u5f15\u4f1a\u5931\u6548","text":"<pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE name LIKE '%\u79d1\u6280';\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | NULL          | NULL | NULL    | NULL |   12 |    11.11 | Using where |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre> <p>\u89e3\u51b3\u65b9\u6848 \uff1a \u901a\u8fc7\u8986\u76d6\u7d22\u5f15\u6765\u89e3\u51b3 </p> <pre><code>mysql [test]&gt;EXPLAIN SELECT name FROM tb_seller WHERE name LIKE '%\u79d1\u6280';\n+----+-------------+-----------+------------+-------+---------------+--------------------------+---------+------+------+----------+--------------------------+\n| id | select_type | table     | partitions | type  | possible_keys | key                      | key_len | ref  | rows | filtered | Extra                    |\n+----+-------------+-----------+------------+-------+---------------+--------------------------+---------+------+------+----------+--------------------------+\n|  1 | SIMPLE      | tb_seller | NULL       | index | NULL          | idx_seller_name_sta_addr | 813     | NULL |   12 |    11.11 | Using where; Using index |\n+----+-------------+-----------+------------+-------+---------------+--------------------------+---------+------+------+----------+--------------------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#9-mysql","title":"9. \u5982\u679cMySQL\u8bc4\u4f30\u4f7f\u7528\u7d22\u5f15\u6bd4\u5168\u8868\u66f4\u6162\uff0c\u5219\u4e0d\u4f7f\u7528\u7d22\u5f15\u3002","text":"<pre><code>mysql [test]&gt;create index idx_seller_address on tb_seller(address);\nQuery OK, 0 rows affected (0.09 sec)\nRecords: 0  Duplicates: 0  Warnings: 0\n# \u67e5\u8be2\u5317\u4eac\u5e02\u6ca1\u6709\u8d70\u7d22\u5f15\nmysql [test]&gt;explain select * from tb_seller where address='\u5317\u4eac\u5e02';\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys      | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | idx_seller_address | NULL | NULL    | NULL |   12 |    91.67 | Using where |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n# \u67e5\u8be2\u897f\u5b89\u5e02\u8d70\u7d22\u5f15\nmysql [test]&gt;explain select * from tb_seller where address='\u897f\u5b89\u5e02';\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-------+\n| id | select_type | table     | partitions | type | possible_keys      | key                | key_len | ref   | rows | filtered | Extra |\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_address | idx_seller_address | 403     | const |    1 |   100.00 | NULL  |\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-------+\n1 row in set, 1 warning (0.00 sec)\n# \u5317\u4eac\u5e02\u5728\u8868\u4e2d\u7684\u8bb0\u5f55\u5360\u7684\u6bd4\u4f8b\u7279\u522b\u5927\uff0c\u6b64\u65f6mysql\u76f4\u63a5\u5168\u8868\u626b\u63cf\nmysql [test]&gt;select address,count(*) from tb_seller group by address;\n+-----------+----------+\n| address   | count(*) |\n+-----------+----------+\n| \u5317\u4eac\u5e02    |       11 |\n| \u897f\u5b89\u5e02    |        1 |\n+-----------+----------+\n2 rows in set (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#10-is-nullis-not-null","title":"10. <code>IS  NULL</code>\u3001<code>IS NOT NULL</code>\u6709\u65f6\u7d22\u5f15\u5931\u6548\u3002","text":"<p>\u6839\u636e\u8868\u4e2d\u6570\u636e\u91cf\u51b3\u5b9a\uff1a</p> <p>\u5982\u679c<code>NULL</code>\u503c\u6bd4\u8f83\u591a\uff0c<code>IS NOT NULL</code>\u8d70\u7d22\u5f15\uff1b</p> <p>\u5982\u679c<code>NULL</code>\u503c\u6bd4\u8f83\u5c11\uff0c<code>IS NULL</code>\u8d70\u7d22\u5f15\uff1b</p> <pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE address IS NULL;\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-----------------------+\n| id | select_type | table     | partitions | type | possible_keys      | key                | key_len | ref   | rows | filtered | Extra                 |\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-----------------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ref  | idx_seller_address | idx_seller_address | 403     | const |    1 |   100.00 | Using index condition |\n+----+-------------+-----------+------------+------+--------------------+--------------------+---------+-------+------+----------+-----------------------+\n1 row in set, 1 warning (0.00 sec)\n\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE address IS NOT NULL;\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys      | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | idx_seller_address | NULL | NULL    | NULL |   12 |   100.00 | Using where |\n+----+-------------+-----------+------------+------+--------------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.00 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#11-innot-in","title":"11. <code>IN</code>\u8d70\u7d22\u5f15\uff0c<code>NOT\u00a0IN</code> \u7d22\u5f15\u5931\u6548","text":"<pre><code>mysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE sellerid IN ('oppe', 'xiaomi', 'sina');\n+----+-------------+-----------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type  | possible_keys | key     | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | range | PRIMARY       | PRIMARY | 402     | NULL |    3 |   100.00 | Using where |\n+----+-------------+-----------+------------+-------+---------------+---------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.02 sec)\n# \u4f7f\u7528NOT IN\u7d22\u5f15\u5931\u6548\nmysql [test]&gt;EXPLAIN SELECT * FROM tb_seller WHERE sellerid NOT IN ('oppe', 'xiaomi', 'sina');\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n| id | select_type | table     | partitions | type | possible_keys | key  | key_len | ref  | rows | filtered | Extra       |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n|  1 | SIMPLE      | tb_seller | NULL       | ALL  | PRIMARY       | NULL | NULL    | NULL |   12 |    91.67 | Using where |\n+----+-------------+-----------+------------+------+---------------+------+---------+------+------+----------+-------------+\n1 row in set, 1 warning (0.01 sec)\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#_2","title":"\u4e8c\u3001\u5355\u5217\u7d22\u5f15\u548c\u590d\u5408\u7d22\u5f15","text":"<p>\u5c3d\u91cf\u4f7f\u7528\u590d\u5408\u7d22\u5f15\uff0c\u4e8c\u51cf\u5c11\u5355\u5217\u7d22\u5f15</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#1_1","title":"1. \u521b\u5efa\u590d\u5408\u7d22\u5f15","text":"<pre><code>create index idx_seller_name_sta_addr on tb_seller(name,status,address);\n# \u5c31\u76f8\u5f53\u4e8e\u521b\u5efa\u4e86\u4e09\u4e2a\u7d22\u5f15 \uff1a \n#     name\n#     name + status\n#     name + status + address\n</code></pre>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#2_1","title":"2. \u521b\u5efa\u5355\u5217\u7d22\u5f15","text":"<pre><code>create index idx_seller_name on tb_seller(name);\ncreate index idx_seller_status on tb_seller(status);\ncreate index idx_seller_address on tb_seller(address);\n</code></pre> <p>\u6570\u636e\u5e93\u4f1a\u9009\u62e9\u4e00\u4e2a\u6700\u4f18\u7684\u7d22\u5f15\uff08\u8fa8\u8bc6\u5ea6\u6700\u9ad8\u7d22\u5f15\uff09\u6765\u4f7f\u7528\uff0c\u5e76\u4e0d\u4f1a\u4f7f\u7528\u5168\u90e8\u7d22\u5f15 \u3002</p>"},{"location":"databases/MySQL/%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96/#_3","title":"\u4e09\u3001\u67e5\u770b\u7d22\u5f15\u4f7f\u7528\u60c5\u51b5","text":"<pre><code>mysql [test]&gt;show status like 'Handler_read%';\n+-----------------------+-------+\n| Variable_name         | Value |\n+-----------------------+-------+\n| Handler_read_first    | 5     |\n| Handler_read_key      | 8     |\n| Handler_read_last     | 0     |\n| Handler_read_next     | 25    |\n| Handler_read_prev     | 0     |\n| Handler_read_rnd      | 0     |\n| Handler_read_rnd_next | 61    |\n+-----------------------+-------+\n7 rows in set (0.05 sec)\n\nmysql [test]&gt;show global status like 'Handler_read%';\n+-----------------------+---------+\n| Variable_name         | Value   |\n+-----------------------+---------+\n| Handler_read_first    | 296     |\n| Handler_read_key      | 1840    |\n| Handler_read_last     | 0       |\n| Handler_read_next     | 300958  |\n| Handler_read_prev     | 0       |\n| Handler_read_rnd      | 92      |\n| Handler_read_rnd_next | 2896042 |\n+-----------------------+---------+\n7 rows in set (0.00 sec)\n</code></pre> <p>\u8f93\u51fa\u5217\u7684\u542b\u4e49</p> Variable_name \u542b\u4e49 <code>Handler_read_first</code> \u7d22\u5f15\u4e2d\u7b2c\u4e00\u6761\u88ab\u8bfb\u7684\u6b21\u6570\u3002\u5982\u679c\u8f83\u9ad8\uff0c\u8868\u793a\u670d\u52a1\u5668\u6b63\u6267\u884c\u5927\u91cf\u5168\u7d22\u5f15\u626b\u63cf\uff08\u8fd9\u4e2a\u503c\u8d8a\u4f4e\u8d8a\u597d\uff09 <code>Handler_read_key</code> \u5982\u679c\u7d22\u5f15\u6b63\u5728\u5de5\u4f5c\uff0c\u8fd9\u4e2a\u503c\u4ee3\u8868\u4e00\u4e2a\u884c\u88ab\u7d22\u5f15\u503c\u8bfb\u7684\u6b21\u6570\uff0c\u5982\u679c\u503c\u8d8a\u4f4e\uff0c\u8868\u793a\u7d22\u5f15\u5f97\u5230\u7684\u6027\u80fd\u6539\u5584\u4e0d\u9ad8\uff0c\u56e0\u4e3a\u7d22\u5f15\u4e0d\u7ecf\u5e38\u4f7f\u7528\uff08\u8fd9\u4e2a\u503c\u8d8a\u9ad8\u8d8a\u597d\uff09\u3002 <code>Handler_read_next</code> \u6309\u7167\u952e\u987a\u5e8f\u8bfb\u4e0b\u4e00\u884c\u7684\u8bf7\u6c42\u6570\u3002\u5982\u679c\u4f60\u7528\u8303\u56f4\u7ea6\u675f\u6216\u5982\u679c\u6267\u884c\u7d22\u5f15\u626b\u63cf\u6765\u67e5\u8be2\u7d22\u5f15\u5217\uff0c\u8be5\u503c\u589e\u52a0\u3002 <code>Handler_read_prev</code> \u6309\u7167\u952e\u987a\u5e8f\u8bfb\u524d\u4e00\u884c\u7684\u8bf7\u6c42\u6570\u3002\u8be5\u8bfb\u65b9\u6cd5\u4e3b\u8981\u7528\u4e8e\u4f18\u5316<code>ORDER BY ... DESC</code>\u3002 <code>Handler_read_rnd</code> \u6839\u636e\u56fa\u5b9a\u4f4d\u7f6e\u8bfb\u4e00\u884c\u7684\u8bf7\u6c42\u6570\u3002\u5982\u679c\u4f60\u6b63\u6267\u884c\u5927\u91cf\u67e5\u8be2\u5e76\u9700\u8981\u5bf9\u7ed3\u679c\u8fdb\u884c\u6392\u5e8f\u8be5\u503c\u8f83\u9ad8\u3002\u4f60\u53ef\u80fd\u4f7f\u7528\u4e86\u5927\u91cf\u9700\u8981MySQL\u626b\u63cf\u6574\u4e2a\u8868\u7684\u67e5\u8be2\u6216\u4f60\u7684\u8fde\u63a5\u6ca1\u6709\u6b63\u786e\u4f7f\u7528\u952e\u3002\u8fd9\u4e2a\u503c\u8f83\u9ad8\uff0c\u610f\u5473\u7740\u8fd0\u884c\u6548\u7387\u4f4e\uff0c\u5e94\u8be5\u5efa\u7acb\u7d22\u5f15\u6765\u8865\u6551\u3002 <code>Handler_read_rnd_next</code> \u5728\u6570\u636e\u6587\u4ef6\u4e2d\u8bfb\u4e0b\u4e00\u884c\u7684\u8bf7\u6c42\u6570\u3002\u5982\u679c\u4f60\u6b63\u8fdb\u884c\u5927\u91cf\u7684\u8868\u626b\u63cf\uff0c\u8be5\u503c\u8f83\u9ad8\u3002\u901a\u5e38\u8bf4\u660e\u4f60\u7684\u8868\u7d22\u5f15\u4e0d\u6b63\u786e\u6216\u5199\u5165\u7684\u67e5\u8be2\u6ca1\u6709\u5229\u7528\u7d22\u5f15\u3002"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/","title":"Checkpoint","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/#_1","title":"\u68c0\u67e5\u70b9","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/#1-checkpoint","title":"1. checkpoint\u8fdb\u7a0b","text":"<p>checkpoint\u8fdb\u7a0b\u7684\u4f5c\u7528\uff1a</p> <ol> <li>\u4e3a\u6570\u636e\u6062\u590d\u505a\u51c6\u5907\u5de5\u4f5c</li> <li>\u5171\u4eab\u7f13\u51b2\u6c60\u4e0a\u810f\u9875\u7684\u5237\u76d8</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/#11-checkpoint","title":"1.1 \u6570\u636e\u5e93\u6062\u590d\u65f6checkpoint\u6d41\u7a0b","text":"<ol> <li>\u5f53checkpoint\u8fdb\u7a0b\u542f\u52a8\u65f6\uff0c\u4f1a\u5c06REDO\u70b9\u5b58\u50a8\u5728\u5185\u5b58\u4e2d\uff0cREDO\u70b9\u662f\u4e0a\u6b21\u68c0\u67e5\u70b9\u5f00\u59cb\u65f6\u523bXLOG\u8bb0\u5f55\u7684\u5199\u5165\u4f4d\u7f6e\uff0c\u4e5f\u662f\u6570\u636e\u5e93\u6062\u590d\u7684\u5f00\u59cb\u4f4d\u7f6e\u3002</li> <li>\u8be5\u68c0\u67e5\u70b9\u76f8\u5e94\u7684XLOG\u8bb0\u5f55\uff08\u5373\u68c0\u67e5\u70b9\u8bb0\u5f55\uff09\u4f1a\u88ab\u5199\u5165WAL\u7f13\u51b2\u533a\uff0c\u8be5\u8bb0\u5f55\u7684\u6570\u636e\u90e8\u5206\u662f\u7531CheckPoint\u7ed3\u6784\u4f53\u5b9a\u4e49\u7684\uff0c\u5305\u542b\u4e86\u4e00\u4e9b\u53d8\u91cf\uff0c\u5982\u6b65\u9aa4\uff081\uff09\u4e2dREDO\u70b9\u7684\u4f4d\u7f6e\u3002\u53e6\u5916\uff0c\u5199\u5165\u68c0\u67e5\u70b9\u8bb0\u5f55\u7684\u4f4d\u7f6e\uff0c\u4e5f\u6309\u7167\u5b57\u9762\u610f\u4e49\u53eb\u4f5ccheckpoint\u3002</li> <li>\u5171\u4eab\u5185\u5b58\u4e2d\u7684\u6240\u6709\u6570\u636e\uff08\u4f8b\u5982\uff0cCLOG\u7684\u5185\u5bb9\uff09\u90fd\u4f1a\u88ab\u5237\u5165\u6301\u4e45\u5316\u5b58\u50a8\u4e2d\u3002</li> <li>\u5171\u4eab\u7f13\u51b2\u6c60\u4e2d\u7684\u6240\u6709\u810f\u9875\u90fd\u4f1a\u88ab\u9010\u6e10\u5237\u5199\u5230\u5b58\u50a8\u4e2d\u3002</li> <li>\u66f4\u65b0pg_control\u6587\u4ef6\uff0c\u8be5\u6587\u4ef6\u5305\u542b\u4e86\u4e00\u4e9b\u57fa\u7840\u4fe1\u606f\uff0c\u5982\u4e0a\u4e00\u6b21\u68c0\u67e5\u70b9\u7684\u4f4d\u7f6e\u3002</li> </ol> <p>checkpoint\u8fdb\u7a0b\u4f1a\u521b\u5efa\u5305\u542bREDO\u70b9\u7684\u68c0\u67e5\u70b9\uff0c\u5e76\u5c06\u68c0\u67e5\u70b9\u4f4d\u7f6e\u4e0e\u5176\u4ed6\u4fe1\u606f\u5b58\u50a8\u5230pg_control\u6587\u4ef6\u4e2d\u3002\u56e0\u6b64\uff0cPostgreSQL \u80fd\u591f\u901a\u8fc7\u4eceREDO\u70b9\u56de\u653eWAL\u6570\u636e\u6765\u8fdb\u884c\u6062\u590d\uff08REDO\u70b9\u662f\u4ece\u68c0\u67e5\u70b9\u4e2d\u83b7\u53d6\u7684\uff09.</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/#2-checkpointcheckpoint","title":"2. \u89e6\u53d1checkpoint\u8fdb\u7a0b\u6267\u884cCheckpoint\u7684\u60c5\u51b5","text":"<ol> <li>\u8fbe\u5230\u81ea\u4e0a\u4e00\u4e2a\u68c0\u67e5\u70b9\u5230\u53c2\u6570checkpoint_timeout\u914d\u7f6e\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u9ed8\u8ba4\u7684\u65f6\u95f4\u95f4\u9694\u4e3a300s\uff085min\uff09\u3002</li> <li>\u57289.4\u53ca\u66f4\u4f4e\u7248\u672c\u4e2d\uff0c\u81ea\u4e0a\u4e00\u6b21\u68c0\u67e5\u70b9\u4ee5\u6765\u6d88\u8017\u7684 WAL \u6bb5\u6587\u4ef6\u8d85\u51fa\u4e86\u53c2\u6570checkpoint_segments\u8bbe\u7f6e\u7684\u6570\u91cf\uff08\u9ed8\u8ba4\u503c\u4e3a3\uff09\u3002</li> <li>\u57289.5\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0cpg_xlog\uff0810.0\u7248\u672c\u4e4b\u540e\u662fpg_wal\uff09\u4e2d\u7684WAL\u6bb5\u6587\u4ef6\u603b\u5927\u5c0f\u8d85\u8fc7\u53c2\u6570max_wal_size\u8bbe\u7f6e\u7684\u503c\uff08\u9ed8\u8ba4\u503c\u4e3a1GB,64\u4e2a\u6bb5\u6587\u4ef6\uff09\u3002</li> <li>PostgreSQL\u670d\u52a1\u5668\u4ee5smart\u6216fast\u6a21\u5f0f\u5173\u95ed\u3002</li> <li>\u5f53\u8d85\u7ea7\u7528\u6237\u624b\u52a8\u6267\u884cCHECKPOINT\u547d\u4ee4\u65f6\uff0c\u8be5\u8fdb\u7a0b\u4e5f\u4f1a\u542f\u52a8\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/#3","title":"3. \u68c0\u67e5\u70b9\u7684\u4f5c\u7528","text":"<p>\u6240\u6709\u7684\u6570\u636e\u5e93\u51e0\u4e4e\u90fd\u6709\u68c0\u67e5\u70b9\u673a\u5236\uff0c\u4e3a\u4ec0\u4e48\u9700\u8981\u68c0\u67e5\u70b9\u5462\uff0c\u6709\u4ee5\u4e0b\u51e0\u4e2a\u4f5c\u7528\uff1a 1. \u5b9a\u671f\u4fdd\u5b58\u4fee\u6539\u8fc7\u7684\u6570\u636e\u5757\uff08\u4fdd\u62a4\u52b3\u52a8\u679c\u5b9e\uff09\u3002\u68c0\u67e5\u70b9\u53d1\u751f\u65f6\uff0c\u68c0\u67e5\u70b9\u8fdb\u7a0b\u4f1a\u628a\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u7684\u810f\u5757\uff08\u88ab\u4fee\u6539\u8fc7\u7684\u5757\uff09\u5199\u5165\u78c1\u76d8\uff0c\u6c38\u4e45\u4fdd\u5b58\uff0c\u5426\u5219\u5982\u679c\u53d1\u751f\u4e3b\u673a\u65ad\u7535\u7b49\u6545\u969c\uff0c\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5757\u5c31\u4f1a\u53bb\u5931\uff0c\u8be5\u68c0\u67e5\u70b9\u7684\u53d1\u751f\u9891\u7387\u7531checkpoint_timeout\u63a7\u5236\uff0c\u5b9a\u671f\u53d1\u751f\u3002 2. \u505a\u4e3a\u5b9e\u4f8b\u6062\u590d\u65f6\u8d77\u59cb\u4f4d\u7f6e\uff0c\u5982\u679c\u53d1\u751f\u5b9e\u4f8b\u5d29\u6e83\uff0c\u90a3\u4e48\u4e0b\u4e00\u6b21\u542f\u52a8\u65f6\u5219\u9700\u8981\u8fdb\u884c\u5b9e\u6062\u590d\uff0c\u6570\u636e\u5e93\u6839\u636e\u6700\u8fd1\u4e00\u6b21\u68c0\u67e5\u70b9\u7684\u4f4d\u7f6e\u505a\u4e3a\u8d77\u59cb\u4f4d\u7f6e\u5f00\u59cbrecovery 3. \u505a\u4e3a\u4ecb\u8d28\u6062\u590d\u65f6\u8d77\u59cb\u4f4d\u7f6e\uff0c\u6bcf\u6b21\u8fdb\u884c\u7269\u7406\u5404\u4efd\u65f6\u90fd\u4f1a\u53d1\u751f\u4e00\u4e2a\u68c0\u67e5\u70b9\uff0c\u7528\u6765\u5224\u65ad\u5c06\u6765\u8fdb\u884c\u6062\u590d\u65f6\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u56e0\u4e3a\u5404\u4efd\u65f6\u6570\u636e\u6587\u4ef6\u662f\u6709\u5148\u540e\u987a\u5e8f\uff0c\u5907\u4efd\u51fa\u6765\u7684\u6570\u636e\u6587\u4ef6\u662f\u4e0d\u4e00\u81f4\u7684\uff0c\u5c06\u6765\u6062\u590d\u51fa\u6765\u540e\u9700\u8981\u5e94\u7528\u5f52\u6863\u65e5\u5fd7\u628a\u4ed6\u4eec\u53d8\u6210\u540c\u6b65\uff0c\u5f00\u59cb\u5404\u4efd\u7684\u4f4d\u7f6e\u5c31\u662f\u5c06\u6765recovery\u7684\u4f4d\u7f6e\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Checkpoint/#4","title":"4. \u68c0\u67e5\u70b9\u8c03\u6574","text":"<ol> <li>\u68c0\u67e5\u70b9\u53d1\u751f\u7684\u95f4\u9694\u65f6\u95f4\u51b3\u5b9a\u4e86\u5b9e\u4f8b\u6062\u590d\u9700\u8981\u7684\u65f6\u957f\uff0c checkpoint_timeout\u8bbe\u7f6e\u7684\u503c\u5e94\u8be5\u6839\u636e\u4e1a\u52a1\u7684\u9700\u6c42\u8bbe\u7f6e\uff0c\u4ee5\u5b9e\u4f8b\u5d29\u65f6\uff0c\u4e0b\u4e00\u6b21\u6253\u5f00\u6570\u636e\u5e93\u65f6\u957f\u7684\u5bb9\u5fcd\u5ea6\u800c\u8bbe\u7f6e\u3002</li> <li>\u95f4\u9694\u65f6\u95f4\u77ed\uff0c\u5219\u5b9e\u4f8b\u6062\u590d\u9700\u8981\u7684\u65f6\u95f4\u5c31\u77ed\uff0c\u53ef\u63d0\u9ad8\u6570\u636e\u5e93\u7684\u53ef\u7528\u6027\uff0c\u4f46\u662f\u4f1a\u589e\u52a0IO\u64cd\u4f5c\uff0c\u964d\u4f4e\u6570\u636e\u5e93\u72b6\u6001\u6027\u80fd\uff0c\u68c0\u67e5\u70b9\u53d1\u751f\u65f6\u5c5e\u4e8e\u5bc6\u96c6\u578bO\u64cd\u4f5c\uff0c\u4f1a\u5360\u7528\u5927\u91cf\u7cfb\u7edf\u8d44\u6e90\u3002</li> <li>\u95f4\u9694\u65f6\u95f4\u957f\uff0c\u5219\u5b9e\u4f8b\u6062\u590d\u9700\u8981\u7684\u65f6\u95f4\u5c31\u957f\uff0c\u4f1a\u964d\u4f4e\u6570\u636e\u5e93\u7684\u53ef\u7528\u6027\uff0c\u4f46\u662f\u4f1a\u51cf\u5c11V/0\u64cd\u4f5c\uff0c\u63d0\u9ad8\u6570\u636e\u5e93\u72b6\u6001\u6027\u80fd</li> </ol> <p><code>checkpoint completion_target</code>\u6570\u636e\u5e93\u4e2d\u4e00\u4e2a\u81f3\u5173\u91cd\u8981\u7684\u53c2\u6570\uff0c\u4e3b\u8981\u4e0e\u53c2\u6570checkpoint_timeout\u914d\u5408\u4f7f\u7528\uff0c\u503c\u8d8a\u5c0f\u610f\u5473\u7740\u68c0\u67e5\u70b9\u8981\u8d8a\u5feb\u5b8c\u6210\uff0c\u8981\u6c42\u5199\u5f97\u8981\u5feb\u3002 \u63a7\u5236\u6bcf\u6b21\u68c0\u67e5\u70b9\u53d1\u751f\u65f6io\u7684\u541e\u5410\u91cf\uff0c\u503c\u8d8a\u9ad8\uff0c\u5219i/o\u5360\u7528\u7684\u8d44\u6e90\u8d8a\u5c11\uff0c\u6570\u636e\u5e93\u6027\u80fd\u8d8a\u597d\uff1a\u503c\u8d8a\u4f4e\uff0c\u5219io\u5360\u7528\u7684\u8d44\u6e90\u8d8a\u591a\uff0c\u5f71\u54cd\u6570\u636e\u5e93\u6027\u80fd\uff0c\u4f46\u662f\u63d0\u9ad8\u68c0\u67e5\u70b9\u5b8c\u6210\u901f\u5ea6\u3002</p> checkpoint_completion_target checkpoint timeout \uff08min\uff09 \u6bcf\u6b21\u68c0\u67e5\u70b9\u9700\u8981\u5199\u5165\u7684\u6570\u636e(GB) \u78c1\u76d8i/o\u901f\u5ea6/\u79d2 \uff08GB\uff09 \u5b9e\u9645\u5199\u5165\u901f\u5ea6(MB) 0.5 5 100 1 670 0.9 5 100 \u00b7 380 <p>\u5b9e\u9645\u6570\u636e\u5199\u5165\u901f\u5ea6=<code>100/(0.9*5*60*1024)\u2248380M/s</code></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/FullPageWrite/","title":"FullPageWrite","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/FullPageWrite/#_1","title":"\u4e00\u3001\u5168\u9875\u5199\u7684\u76ee\u7684","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\u901a\u5e38\u4f7f\u75284KB\u7684\u9875\u9762\uff0cPostgreSQL\u9ed8\u8ba4\u4f7f\u75288KB\u7684\u9875\u9762\uff0c\u5047\u8bbe\u540e\u53f0\u5199\u5165\u8fdb\u7a0b\u5728\u5199\u5165\u810f\u9875\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u64cd\u4f5c\u7cfb\u7edf\u6545\u969c\uff0c\u80fd\u51fa\u73b0\u53ea\u5199\u5165\u4e00\u4e2a4KB\u9875\u9762\u7684\u60c5\u51b5\uff0c\u5bfc\u81f4\u78c1\u76d8\u4e0a\u8868A\u7684\u9875\u9762\u6570\u636e\u635f\u574f\uff0c\u90a3\u4e48XLOG\u662f\u65e0\u6cd5\u5728\u635f\u574f\u7684\u9875\u9762\u4e0a\u91cd\u653e\u7684\uff0c\u5168\u9875\u5199\u7684\u529f\u80fd\u53ef\u4ee5\u9632\u6b62\u8fd9\u79cd\u5931\u6548\u3002\u5982\u679c\u542f\u7528\u5168\u9875\u5199\uff0cPostgreSQL\u4f1a\u5728\u6bcf\u4e2a\u68c0\u67e5\u70b9\u4e4b\u540e\uff0c\u5728\u6bcf\u4e2a\u9875\u9762\u7b2c\u4e00\u6b21\u53d1\u751f\u53d8\u66f4\u65f6\uff0c\u5c06\u6574\u4e2a\u9875\u9762\u53ca\u5176\u9996\u90e8\u5143\u4fe1\u606f\u5b57\u6bb5\u4f5c\u4e3a\u4e00\u6761XLOG\u8bb0\u5f55\u5199\u5165\uff0c\u8fd9\u4e2a\u529f\u80fd\u9ed8\u8ba4\u662f\u5f00\u542f\u7684\u3002\u5728PostgreSQL\u4e2d\uff0c\u8fd9\u79cd\u5305\u542b\u5b8c\u6574\u9875\u9762\u7684XLOG\u8bb0\u5f55\u88ab\u79f0\u4e3a\u5907\u4efd\u533a\u5757\u6216\u6574\u9875\u955c\u50cf\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/FullPageWrite/#_2","title":"\u4e8c\u3001\u5168\u9875\u5199\u7684\u8fc7\u7a0b","text":"<ol> <li>\u68c0\u67e5\u70b9\u7a0b\u5e8f\u542f\u52a8\u68c0\u67e5\u70b9\u8fdb\u7a0b\u3002</li> <li>\u5f53\u7b2c1\u6761INSERT\u8bed\u53e5\u6267\u884c\u63d2\u5165\u64cd\u4f5c\u65f6\uff0c\u8fd9\u91cc\u7684XLOG\u8bb0\u5f55\u662f\u5f53\u524d\u9875\u7684\u5907\u4efd\u533a\u5757\uff08\u5373\u5305\u542b\u4e86\u5b8c\u6574\u7684\u9875\u9762\uff09\uff0c\u56e0\u4e3a\u8fd9\u662f\u6700\u8fd1\u4e00\u6b21\u68c0\u67e5\u70b9\u4e4b\u540e\u8be5\u9875\u9762\u7684\u7b2c\u4e00\u6b21\u5199\u5165\u3002</li> <li>\u5f53\u4e8b\u52a1\u63d0\u4ea4\u65f6\u4e0e\u666e\u901a\u8fc7\u7a0b\u76f8\u540c\u3002</li> <li>\u5f53\u7b2c2\u6761INSERT\u8bed\u53e5\u8fdb\u884c\u63d2\u5165\u64cd\u4f5c\u65f6\uff0c\u4e0e\u666e\u901a\u64cd\u4f5c\u65e0\u5dee\u5f02\uff0c\u8fd9\u91cc\u7684XLOG\u8bb0\u5f55\u5c31\u4e0d\u662f\u5907\u4efd\u533a\u5757\u4e86\u3002</li> <li>\u5f53\u8fd9\u6761\u8bed\u53e5\u4e8b\u52a1\u63d0\u4ea4\u65f6\u4e0e\u666e\u901a\u8fc7\u7a0b\u76f8\u540c\u3002</li> <li>\u540e\u53f0\u5199\u5165\u8fdb\u7a0b\u5728\u5411\u78c1\u76d8\u5199\u5165\u810f\u9875\u7684\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u64cd\u4f5c\u7cfb\u7edf\u6545\u969c\uff0c\u5bfc\u81f4\u78c1\u76d8\u4e0a\u8868A\u7684\u9875\u9762\u6570\u636e\u635f\u574f\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/FullPageWrite/#_3","title":"\u4e09\u3001\u5907\u4efd\u533a\u5757\u6062\u590d\u8fc7\u7a0b","text":"<ol> <li>PostgreSQL\u8bfb\u53d6\u7b2c1\u6761INSERT\u8bed\u53e5\u7684XLOG\u8bb0\u5f55\uff0c\u5e76\u4ece\u6570\u636e\u5e93\u96c6\u7c07\u76ee\u5f55\u52a0\u8f7d\u8868A\u7684\u9875\u9762\u81f3\u5171\u4eab\u7f13\u51b2\u6c60\u4e2d\u3002\u5728\u672c\u4f8b\u4e2d\uff0c\u6309\u7167\u6574\u9875\u5199\u5165\u7684\u89c4\u5219\uff0c\u8fd9\u6761XLOG\u8bb0\u5f55\u662f\u4e00\u4e2a\u5907\u4efd\u533a\u5757\u3002</li> <li>\u5f53\u4e00\u6761XLOG\u8bb0\u5f55\u662f\u5907\u4efd\u533a\u5757\u65f6\uff0c\u4f1a\u4f7f\u7528\u53e6\u4e00\u6761\u91cd\u653e\u89c4\u5219\uff1aXLOG\u8bb0\u5f55\u7684\u6570\u636e\u90e8\u5206\u4f1a\u76f4\u63a5\u8986\u76d6\u5f53\u524d\u9875\u9762\uff0c\u65e0\u89c6\u9875\u9762\u6216XLOG\u8bb0\u5f55\u4e2d\u7684LSN\uff0c\u7136\u540e\u5c06\u9875\u9762\u7684LSN\u66f4\u65b0\u4e3aXLOG\u8bb0\u5f55\u7684LSN\u3002\u5c06TAIBLE_A\u7684LSN\u66f4\u65b0\u4e3aLSN_1\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u635f\u574f\u7684\u9875\u9762\u53ef\u4ee5\u901a\u8fc7\u5b83\u81ea\u5df1\u7684\u5907\u4efd\u533a\u5757\u6062\u590d\u3002</li> <li>\u56e0\u4e3a\u7b2c2\u6761XLOG\u8bb0\u5f55\u4e0d\u662f\u5907\u4efd\u533a\u5757\uff0c\u6062\u590d\u64cd\u4f5c\u4e0e\u666e\u901a\u6062\u590d\u6d41\u7a0b\u76f8\u540c</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/","title":"Toast","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast","title":"Toast\u6280\u672f\u4ea7\u751f\u80cc\u666f","text":"<p>\u5143\u7ec4\u4e0d\u5141\u8bb8\u8de8\u9875\u9762\u5b58\u50a8</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_1","title":"toast\u6280\u672f\u7279\u70b9","text":"<ol> <li>Toast\u662f\u8d85\u957f\u5b57\u6bb5\u5728PG\u7684\u4e00\u4e2a\u5b58\u50a8\u65b9\u5f0f</li> <li>\u5168\u79f0The OverSized Attribute Storage Technique(\u8d85\u5c3a\u5bf8\u5b57\u6bb5\u5b58\u50a8\u6280\u672f)</li> <li>\u5b83\u4f1a\u5c06\u5927\u5b57\u6bb5\u503c\u538b\u7f29\u6216\u8005\u5206\u6563\u4e3a\u591a\u4e2a\u7269\u7406\u884c\u6765\u5b58</li> <li>\u5bf9\u4e8e\u7528\u6237\u6765\u8bf4\u4e0d\u7528\u5173\u6ce8\u8fd9\u4e00\u6280\u672f\u5b9e\u73b0\uff0c\u5b8c\u5168\u662f\u900f\u660e\u7684</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_2","title":"Toast\u7684\u5b58\u50a8\u65b9\u5f0f","text":"<ol> <li>PG\u7684\u90e8\u5206\u7c7b\u578b\u6570\u636e\u652f\u6301toast\uff0c\u56e0\u4e3a\u6709\u4e9b\u5b57\u6bb5\u7c7b\u578b\u662f\u4e0d\u4f1a\u4ea7\u751f\u5927\u5b57\u6bb5\u6570\u636e(\u6bd4\u5982date,time,boolean\u7b49)</li> <li>\u652f\u6301Toast\u7684\u6570\u636e\u7c7b\u578b\u5e94\u5f53\u662f\u53ef\u53d8\u957f\u5ea6\u7684(variable-length)</li> <li>\u8868\u4e2d\u4efb\u4f55\u4e00\u4e2a\u5b57\u6bb5\u6709Toast\uff0c\u8fd9\u4e2a\u8868\u90fd\u4f1a\u6709\u8fd9\u4e00\u4e2a\u76f8\u5173\u8054\u7684Toast\u8868\uff0cOID\u88ab\u5b58\u50a8\u5728pg_class.reltoastrelid\u91cc</li> <li>\u8d85\u51fa\u7684\u7684\u6570\u503c\u5c06\u4f1a\u88ab\u5206\u5272\u6210chunks\uff0c\u5e76\u4e14\u6700\u591atoast_max_chunk_size \u4e2abyte(\u7f3a\u7701\u662f2KB)</li> <li>\u5f53\u5b58\u50a8\u7684\u5217\u957f\u5ea6\u8d85\u8fc7toast_tuple_threshold\u503c(\u901a\u5e38\u662f2KB)\uff0c\u5c31\u4f1a\u89e6\u53d1toast\u5b58\u50a8</li> <li>toast\u5c06\u4f1a\u538b\u7f29\u6216\u8005\u79fb\u52a8\u5b57\u6bb5\u503c\u76f4\u5230\u8d85\u51fa\u90e8\u5206\u6bd4toast_tuple_targer\u503c\u5c0f(\u8fd9\u4e2a\u503c\u901a\u5e38\u4e5f\u662f2KB)\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_3","title":"\u521b\u5efaToast\u8868","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_4","title":"\u5efa\u8868\u65f6\u81ea\u52a8\u521b\u5efaToast\u8868","text":"<pre><code>--\u521b\u5efa\u8868\ncreate table toast_t(id int,vname varchar(48),remark text);\n--\u5176\u4e2dremark\u6570\u636e\u7c7b\u578b\u662ftext\uff0c\u5217\u503c\u957f\u5ea6\u8d85\u8fc72KB\u5219\u5c31\u4f1a\u81ea\u52a8\u4ea7\u751ftoast\u8868\u6765\u5b58\u50a8\u3002\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_5","title":"\u66f4\u6539\u8868\u7684\u5b58\u50a8\u65b9\u5f0f\u4e3aToast","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>ALTER TABLE toast_t ALTER COLUMN vname\nSET STORAGE {PLAIN | EXTENDED | MAIN | EXTERNAL};\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>postgres=# create table toast_t1(dd character varying);\nCREATE TABLE\npostgres=# alter table toast_t1 alter column dd set storage main;\nALTER TABLE\npostgres=# \\d+ toast_t1\n                                      Table \"public.toast_t1\"\n Column |       Type        | Collation | Nullable | Default | Storage | Stats target | Description \n--------+-------------------+-----------+----------+---------+---------+--------------+-------------\n dd     | character varying |           |          |         | main    |              | \nAccess method: heap\npostgres=# select relname,relfilenode,reltoastrelid from pg_class where relname='toast_t1';\n relname  | relfilenode | reltoastrelid \n----------+-------------+---------------\n toast_t1 |       16811 |         16814\n(1 row)\npostgres=# --\u67e5\u770btoast\u8868\u7684oid\npostgres=# select relname,relfilenode,reltoastrelid from pg_class where relname='toast_t1';\n relname  | relfilenode | reltoastrelid \n----------+-------------+---------------\n toast_t1 |       16811 |         16814\n(1 row)\npostgres=# --\u6839\u636etoast\u8868oid\u67e5\u770b\u5176\u540d\u5b57\nselect relname from pg_class where oid = '16814';\n    relname     \n----------------\n pg_toast_16811\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast4","title":"Toast4\u79cd\u7b56\u7565","text":"\u7b56\u7565 \u8bf4\u660e PLAIN \u907f\u514d\u538b\u7f29\u548c\u884c\u5916\u5b58\u50a8\u3002\u53ea\u6709\u90a3\u4e9b\u4e0d\u9700\u8981TOAST\u7b56\u7565\u5c31\u80fd\u5b58\u653e\u7684\u6570\u636e\u7c7b\u578b\u5141\u8bb8\u9009\u62e9(\u4f8b\u5982 int \u7c7b\u578b)\uff0c\u800c\u5bf9\u4e8etext\u8fd9\u7c7b\u8981\u6c42\u5b58\u50a8\u957f\u5ea6\u8d85\u8fc7\u9875\u5927\u5c0f\u7684\u7c7b\u578b\uff0c\u662f\u4e0d\u5141\u8bb8\u91c7\u7528\u6b64\u7b56\u7565\u7684\u3002 MAIN \u5141\u8bb8\u538b\u7f29\uff0c\u4f46\u4e0d\u8bb8\u884c\u5916\u5b58\u50a8\u3002\u4e0d\u8fc7\u5b9e\u9645\u4e0a\uff0c\u4e3a\u4e86\u4fdd\u8bc1\u8fc7\u5927\u6570\u636e\u7684\u5b58\u50a8\uff0c\u884c\u5916\u5b58\u50a8\u5728\u5176\u5b83\u65b9\u5f0f(\u4f8b\u5982\u538b\u7f29)\u90fd\u65e0\u6cd5\u6ee1\u8db3\u9700\u6c42\u7684\u60c5\u51b5\u4e0b\uff0c\u4f5c\u4e3a\u6700\u540e\u624b\u6bb5\u8fd8\u662f\u4f1a\u88ab\u542f\u52a8\u3002\u56e0\u6b64\u7406\u89e3\u4e3a\u5c3d\u91cf\u4e0d\u4f7f\u7528\u884c\u5916\u5b58\u50a8\u66f4\u8d34\u5207\u3002 EXTENDED \u5141\u8bb8\u884c\u5916\u5b58\u50a8\u548c\u538b\u7f29\u3002\u4e00\u822c\u4f1a\u5148\u538b\u7f29\uff0c\u5982\u679c\u8fd8\u662f\u592a\u5927\uff0c\u5c31\u4f1a\u884c\u5916\u5b58\u50a8 EXTERNA \u5141\u8bb8\u884c\u5916\u5b58\u50a8\uff0c\u4f46\u4e0d\u8bb8\u538b\u7f29\u3002\u7c7b\u4f3c\u5b57\u7b26\u4e32\u8fd9\u79cd\u4f1a\u5bf9\u6570\u636e\u7684\u4e00\u90e8\u5206\u8fdb\u884c\u64cd\u4f5c\u7684\u5b57\u6bb5\uff0c\u91c7\u7528\u6b64\u7b56\u7565\u53ef\u80fd\u83b7\u5f97\u66f4\u9ad8\u7684\u6027\u80fd\uff0c\u56e0\u4e3a\u4e0d\u9700\u8981\u8bfb\u53d6\u51fa\u6574\u884c\u6570\u636e\u518d\u89e3\u538b\u3002"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_6","title":"Toast\u8868\u989d\u5916\u7684\u4e09\u4e2a\u5b57\u6bb5","text":"\u5b57\u6bb5\u540d \u5c5e\u6027 chunk_id \u6807\u8bc6TOAST\u8868\u7684OID\u5b57\u6bb5 chunk_seq chunk\u7684\u5e8f\u5217\u53f7\uff0c\u4e0echunk_id\u7684\u7ec4\u5408\u552f\u4e00\u7d22\u5f15\u53ef\u4ee5\u52a0\u901f\u8bbf\u95ee chunk_data \u5b58\u50a8TOAST\u8868\u7684\u5b9e\u9645\u6570\u636e <pre><code>postgres=# select relname,oid,reltoastrelid from pg_class where relname='toast_t1';\n relname  |  oid  | reltoastrelid \n----------+-------+---------------\n toast_t1 | 16811 |         16814\n(1 row)\n\npostgres=# --\u6839\u636etoast\u8868oid\u67e5\u770b\u5176\u540d\u5b57\npostgres=# select relname from pg_class where oid = '16814';\n    relname     \n----------------\n pg_toast_16811\n(1 row)\n\npostgres=# --\u67e5\u770btoast\u8868\u7ed3\u6784\uff0ctoast\u8868\u5c5e\u4e8epg_toast\u6a21\u5f0f\npostgres=# \\d+ pg_toast.pg_toast_16811\nTOAST table \"pg_toast.pg_toast_16811\"\n   Column   |  Type   | Storage \n------------+---------+---------\n chunk_id   | oid     | plain\n chunk_seq  | integer | plain\n chunk_data | bytea   | plain\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_7","title":"Toast\u8868\u7684\u8ba1\u7b97","text":"<p>\u8ba1\u7b97\u4e00\u4e2a\u8868\u7684\u5927\u5c0f\u65f6\u8981\u6ce8\u610f\u7edf\u8ba1Toast\u7684\u5927\u5c0f\uff0c\u56e0\u4e3a\u5bf9\u8d85\u957f\u5b57\u6bb5\u5b58\u50a8\u65f6\uff0c\u5728\u57fa\u7840\u8868\u4e0a\u53ef\u80fd\u53ea\u5b58\u4e8620%\uff0c\u53e6\u5916\u7684\u6570\u636e\u90fd\u5b58\u5230\u4e86Toast\u91cc\u9762\u53bb\u4e86\uff0c\u8ba1\u7b97\u5927\u5c0f\u65f6\u8981\u7ed3\u5408\u8d77\u6765\u770b \u7d22\u5f15\u4e5f\u662f\u4e00\u6837\uff0c\u5bf9\u4e8e\u8868\u91cc\u6709extended\u6216\u8005EXTERNA \u7c7b\u578b\u7684\u4f1a\u521b\u5efaToast\u8868\uff0c\u4e24\u8005\u7684\u5173\u8054\u662f\u901a\u8fc7pg_class\u91cc\u7684OID\u53bb\u5173\u8054\u7684</p> <pre><code>postgres=# create table toast_t(id int,vname varchar(48),remark text);\nCREATE TABLE\npostgres=# select relname,oid from pg_class where relname = 'toast_t';\n relname |  oid  \n---------+-------\n toast_t | 16817\n(1 row)\n\npostgres=# select relname,reltoastrelid from pg_class where relname = 'toast_t';\n relname | reltoastrelid \n---------+---------------\n toast_t |         16820\n(1 row)\n\npostgres=# select relname from pg_class where oid = '16820';\n    relname     \n----------------\n pg_toast_16817\n(1 row)\n\npostgres=# --\u63d2\u5165\u6570\u636e\uff0c\u6b64\u65f6remark\u5217\u503c\u957f\u5ea6\u5c0f\u4e8e2KB\uff0c\u6240\u4ee5\u4e0d\u4f1a\u89e6\u53d1toast\u5b58\u50a8\npostgres=# insert into toast_t select generate_series(1,4),repeat('kenyon here'||'^_^',2),repeat('^_^ Kenyon is not God,Remark here!!',2000);\nINSERT 0 4\npostgres=# --\u67e5\u770b\u8868\u4e2d\u5217\u503c\u5927\u5c0f\npostgres=# select pg_column_size(id),pg_column_size(vname),pg_column_size(remark) from toast_t limit 10;\n pg_column_size | pg_column_size | pg_column_size \n----------------+----------------+----------------\n              4 |             29 |            851\n              4 |             29 |            851\n              4 |             29 |            851\n              4 |             29 |            851\n(4 rows)\n\npostgres=# --\u67e5\u770b\u57fa\u7840\u8868\u548c Toast \u7684\u5927\u5c0f\npostgres=# select pg_size_pretty(pg_relation_size('toast_t'));\n pg_size_pretty \n----------------\n 8192 bytes\n(1 row)\n\npostgres=# --\u67e5\u770btoast\u8868\u5c3a\u5bf8\nselect pg_size_pretty(pg_relation_size('16820'));\n pg_size_pretty \n----------------\n 0 bytes\n(1 row)\n\npostgres=# --\u6b64\u65f6remark\u5217\u503c\u957f\u5ea6\u5c0f\u4e8e2KB\uff0c\u6240\u4ee5\u4e0d\u4f1a\u89e6\u53d1toast\u5b58\u50a8\npostgres=# --remark\u5217\u503c\u8d85\u8fc7 2kb \u5de6\u53f3\u65f6\u89e6\u53d1\u4e86toast\u5b58\u50a8\u65b9\u5f0f\npostgres=# insert into toast_t select generate_series(3,4),repeat('kenyon here'||'^_^',2),repeat('^_^ Kenyon is not God,Remark here!!',5500);\nINSERT 0 2\n\npostgres=# select pg_size_pretty(pg_relation_size('16820'));\n pg_size_pretty \n----------------\n 8192 bytes\n(1 row)\n\npostgres=# --\u67e5\u770b\u5404\u5217\u7684\u6570\u636e\u53d8\u5316\uff0c\u8bf4\u660e\u5728\u5217\u5c3a\u5bf8\u8d85\u8fc72k\u7684\u65f6\u5019\u5c31\u4f1a\u628a\u6570\u636e\u5b58\u653e\u5230toast\u8868\u4e2d\npostgres=# select pg_column_size(id),pg_column_size(vname),pg_column_size(remark) from toast_t;\n pg_column_size | pg_column_size | pg_column_size \n----------------+----------------+----------------\n              4 |             29 |            851\n              4 |             29 |            851\n              4 |             29 |            851\n              4 |             29 |            851\n              4 |             29 |           2247\n              4 |             29 |           2247\n(6 rows)\n\npostgres=# --\u7ee7\u7eed\u63d2\u5165\u66f4\u591a\u7684\u6570\u636e\npostgres=# insert into toast_t select generate_series(1,2),repeat('kenyon here'||'^_^',2),repeat('^_^ Kenyon is not God,Remark here!!',10000);\nINSERT 0 2\n\npostgres=# --\u67e5\u770btoast\u8868\u5927\u5c0f\npostgres=# select pg_size_pretty(pg_relation_size('16820'));\n pg_size_pretty \n----------------\n 16 kB\n(1 row)\n\npostgres=# --\u7ee7\u7eed\u63d2\u5165\u66f4\u591a\u7684\u6570\u636e\uff0c20000\npostgres=# insert into toast_t select generate_series(1,2),repeat('kenyon here'||'^_^',2),repeat('^_^ Kenyon is not God,Remark here!!',20000);\nINSERT 0 2\npostgres=# --\u67e5\u770btoast\u8868\u5927\u5c0f\npostgres=# select pg_size_pretty(pg_relation_size('16820'));\n pg_size_pretty \n----------------\n 32 kB\n(1 row)\n\npostgres=# --\u53ef\u4ee5\u770b\u5230\u540e\u63d2\u5165\u7684\u6570\u636e\u968f\u7740\u5b57\u6bb5\u5185\u5bb9\u7684\u589e\u591a\uff0ctoast \u6bb5\u4e00\u76f4\u5728\u53d8\u5927\u3002\u57fa\u7840\u8868\u7684\u5927\u5c0f\u6ca1\u6709\u53d8\u5316\u3002\u8fd9\u4e2a\u548c Oracle \u5b58\u50a8\u7684\u5927\u5b57\u6bb5\u5185\u5bb9\u6bd4\u8f83\u50cf\uff0cOracle \u5b58\u50a8 Blob\u548cclob \u7c7b\u7684\u6570\u636e\u65f6\u4e5f\u662f\u6307\u5b9a\u53e6\u5916\u7684 segment \u6765\u5b58\u50a8\uff0c\u800c\u4e0d\u662f\u5728\u539f\u8868\u4e2d\u5b58\u50a8\uff0c\u5f53\u7136\u53ef\u4ee5\u8bbe\u7f6e enable storage in row \u6765\u6307\u5b9a\u8868\u4e2d\u5b58\u50a8\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_8","title":"Toast\u8868\u7684\u4f18\u70b9","text":"<ol> <li>\u53ef\u4ee5\u5b58\u50a8\u8d85\u957f\u8d85\u5927\u5b57\u6bb5\uff0c\u907f\u514d\u4e4b\u524d\u4e0d\u80fd\u76f4\u63a5\u5b58\u50a8\u7684\u9650\u5236</li> <li>\u7269\u7406\u4e0a\u4e0e\u666e\u901a\u8868\u662f\u5206\u79bb\u7684\uff0c\u68c0\u7d22\u67e5\u8be2\u65f6\u4e0d\u68c0\u7d22\u5230\u8be5\u5b57\u6bb5\u4f1a\u6781\u5927\u5730\u52a0\u5feb\u901f\u5ea6</li> <li>\u66f4\u65b0\u666e\u901a\u8868\u65f6\uff0c\u8be5\u8868\u7684Toast\u6570\u636e\u6ca1\u6709\u88ab\u66f4\u65b0\u65f6\uff0c\u4e0d\u7528\u53bb\u66f4\u65b0Toast\u8868</li> <li>\u4f7f\u7528explain\u4e0d\u4f1a\u7edf\u8ba1toast\u8bbf\u95ee\u90e8\u5206\u7684\u4ee3\u4ef7\uff0c\u9700\u8981\u5355\u72ec\u7528explain\u7edf\u8ba1\u8bbf\u95eetoast\u8868\u7684\u4ee3\u4ef7</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/Toast/#toast_9","title":"Toast\u8868\u7684\u7f3a\u70b9","text":"<ol> <li>\u5bf9\u5927\u5b57\u6bb5\u7684\u7d22\u5f15\u521b\u5efa\u662f\u4e00\u4e2a\u95ee\u9898\uff0c\u6709\u53ef\u80fd\u4f1a\u5931\u8d25\uff0c\u901a\u5e38\u4e0d\u5efa\u8bae\u5728\u5927\u5b57\u6bb5\u4e0a\u521b\u5efa\uff0c\u5168\u6587\u68c0\u7d22\u662f\u4e00\u4e2a\u89e3\u51b3\u65b9\u6848</li> <li>\u5927\u5b57\u6bb5\u7684\u66f4\u65b0\u4f1a\u6709\u70b9\u6162\uff0c\u5176\u5b83DB\u4e5f\u5b58\u5728\u76f8\u540c\u95ee\u9898</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/","title":"WAL","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#wal","title":"\u4e00\u3001WAL\u673a\u5236","text":"<p>\u4e8b\u52a1\u65e5\u5fd7\u662f\u6570\u636e\u5e93\u81f3\u5173\u91cd\u8981\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u4e3a\u5728\u51fa\u73b0\u7cfb\u7edf\u6545\u969c\u65f6\uff0c\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u90fd\u4e0d\u5141\u8bb8\u4e22\u5931\u6570\u636e\u3002\u4e8b\u52a1\u65e5\u5fd7\u662f\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\u6240\u6709\u53d8\u66f4\u4e0e\u884c\u4e3a\u7684\u5386\u53f2\u8bb0\u5f55\uff0c\u5f53\u7535\u6e90\u6545\u969c\u6216\u5176\u4ed6\u670d\u52a1\u5668\u9519\u8bef\u7b49\u5bfc\u81f4\u670d\u52a1\u5668\u5d29\u6e83\u65f6\uff0c\u4f7f\u7528\u5b83\u53ef\u4ee5\u786e\u4fdd\u6570\u636e\u4e0d\u4f1a\u4e22\u5931\u3002\u7531\u4e8e\u4e8b\u52a1\u65e5\u5fd7\u5305\u542b\u6bcf\u4e2a\u5df2\u6267\u884c\u4e8b\u52a1\u7684\u76f8\u5173\u4fe1\u606f\uff0c\u56e0\u6b64\u5f53\u670d\u52a1\u5668\u5d29\u6e83\u65f6\uff0c\u6570\u636e\u5e93\u670d\u52a1\u5668\u80fd\u901a\u8fc7\u91cd\u653e\u4e8b\u52a1\u65e5\u5fd7\u4e2d\u7684\u53d8\u66f4\u4e0e\u884c\u4e3a\u6765\u6062\u590d\u6570\u636e\u5e93\u96c6\u7fa4\u3002 WAL(Write Ahead Logging)\uff0c\u6307\u7684\u662f\u5c06\u53d8\u66f4\u4e0e\u884c\u4e3a\u5199\u5165\u4e8b\u52a1\u65e5\u5fd7\u7684\u534f\u8bae\u6216\u89c4\u5219\uff0c\u800c\u5728PostgreSQL\u4e2d\uff0cWAL\u662fWrite Ahead Log\uff08\u9884\u5199\u5f0f\u65e5\u5fd7\uff09\u7684\u7f29\u5199\uff0c\u5b83\u88ab\u5f53\u6210\u4e8b\u52a1\u65e5\u5fd7\u7684\u540c\u4e49\u8bcd\uff0c\u800c\u4e14\u4e5f\u7528\u6765\u6307\u4ee3\u4e00\u79cd\u5c06\u884c\u4e3a\u5199\u5165\u4e8b\u52a1\u65e5\u5fd7\u7684\u5b9e\u73b0\u673a\u5236\u3002 WAL\u673a\u5236\u4f5c\u7528\uff1a 1. \u51cf\u8f7b\u670d\u52a1\u5668\u5d29\u6e83\u5e26\u6765\u7684\u5f71\u54cd\u3002 2. \u65f6\u95f4\u70b9\u6062\u590d\uff08Point-in-Time Recovery,PITR\uff09\u4e0e\u6d41\u590d\u5236\uff08Streaming Replication,SR\uff09\u5b9e\u73b0\u7684\u57fa\u7840\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#1-wal","title":"1. \u6ca1\u6709WAL\u7684\u63d2\u5165","text":"<ol> <li>\u53d1\u8d77\u7b2c1\u6761INSERT\u8bed\u53e5\u65f6\uff0cPostgreSQL\u4ece\u6570\u636e\u5e93\u96c6\u7c07\u6587\u4ef6\u4e2d\u52a0\u8f7dTABLE_A\u7684\u9875\u9762\u5230\u5185\u5b58\u4e2d\u7684\u5171\u4eab\u7f13\u51b2\u6c60\uff0c\u7136\u540e\u5411\u9875\u9762\u4e2d\u63d2\u5165\u4e00\u6761\u5143\u7ec4\u3002\u9875\u9762\u5e76\u6ca1\u6709\u88ab\u7acb\u523b\u5199\u56de\u5230\u6570\u636e\u5e93\u6587\u4ef6\u4e2d\u3002</li> <li>\u5f53\u53d1\u8d77\u7b2c2\u6761INSERT\u8bed\u53e5\u65f6\uff0cPostgreSQL\u76f4\u63a5\u5411\u7f13\u51b2\u6c60\u4e2d\u7684\u9875\u9762\u6dfb\u52a0\u4e86\u4e00\u6761\u65b0\u5143\u7ec4\uff0c\u8fd9\u4e00\u9875\u9762\u4ecd\u7136\u6ca1\u6709\u88ab\u5199\u56de\u6301\u4e45\u5316\u5b58\u50a8\u4e2d\u3002</li> <li>\u5982\u679c\u64cd\u4f5c\u7cfb\u7edf\u6216PostgreSQL\u670d\u52a1\u5668\u56e0\u4e3a\u5404\u79cd\u539f\u56e0\u5931\u6548\uff08\u5982\u7535\u6e90\u6545\u969c\uff09\uff0c\u90a3\u4e48\u6240\u6709\u63d2\u5165\u7684\u6570\u636e\u90fd\u4f1a\u4e22\u5931\u3002</li> </ol> <p>\u56e0\u6b64\uff0c\u6ca1\u6709WAL\u7684\u6570\u636e\u5e93\u5728\u7cfb\u7edf\u5d29\u6e83\u65f6\u662f\u5f88\u8106\u5f31\u7684\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#2-wal","title":"2. \u6709WAL\u7684\u63d2\u5165","text":"<p>\u4e3a\u4e86\u89e3\u51b3\u4e0a\u8ff0\u7cfb\u7edf\u6545\u969c\u95ee\u9898\uff0c\u540c\u65f6\u53c8\u4e0d\u5bfc\u81f4\u6027\u80fd\u635f\u5931\uff0cPostgreSQL\u5f15\u5165\u4e86WAL\u3002\u5c06\u6240\u6709\u4fee\u6539\u4f5c\u4e3a\u5386\u53f2\u6570\u636e\u5199\u5165\u6301\u4e45\u5316\u5b58\u50a8\u4e2d\u3002\u8fd9\u4efd\u5386\u53f2\u6570\u636e\u88ab\u79f0\u4e3aXLOG\u8bb0\u5f55\u6216WAL\u6570\u636e\u3002 \u5f53\u63d2\u5165\u3001\u5220\u9664\u3001\u63d0\u4ea4\u7b49\u53d8\u66f4\u52a8\u4f5c\u53d1\u751f\u65f6\uff0cPostgreSQL\u4f1a\u5c06XLOG\u8bb0\u5f55\u5199\u5165\u5185\u5b58\u4e2d\u7684WAL\u7f13\u51b2\u533a\u3002\u5f53\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e2d\u6b62\u65f6\uff0c\u5b83\u4eec\u4f1a\u88ab\u7acb\u5373\u5199\u5165\u6301\u4e45\u5316\u5b58\u50a8\u7684WAL\u6bb5\u6587\u4ef6\u4e2d\u3002XLOG\u8bb0\u5f55\u7684\u65e5\u5fd7\u5e8f\u5217\u53f7\uff08Log Sequence Number,LSN\uff09\u6807\u8bc6\u4e86\u8be5\u8bb0\u5f55\u5728\u4e8b\u52a1\u65e5\u5fd7\u4e2d\u7684\u4f4d\u7f6e\uff0c\u8bb0\u5f55\u7684LSN\u88ab\u7528\u4f5cXLOG\u8bb0\u5f55\u7684\u552f\u4e00\u6807\u8bc6\u7b26\u3002\u5f53\u6570\u636e\u5e93\u7cfb\u7edf\u6062\u590d\u65f6\uff0cPostgreSQL\u4eceREDO\u70b9\uff08\u5373\u6700\u65b0\u7684\u68c0\u67e5\u70b9\u5f00\u59cb\u65f6XLOG\u8bb0\u5f55\u5199\u5165\u7684\u4f4d\u7f6e\uff09\u5f00\u59cb\u6062\u590d\u3002</p> <p> </p> <ol> <li>checkpointer\u8fdb\u7a0b\u662f\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\uff0c\u5b9a\u671f\u6267\u884ccheckpoint\u3002\u5f53checkpointer\u8fdb\u7a0b\u542f\u52a8\u65f6\uff0c\u5b83\u4f1a\u5411\u5f53\u524dWAL\u6bb5\u6587\u4ef6\u5199\u5165\u4e00\u6761XLOG\u8bb0\u5f55\uff08\u8fd9\u4e2a\u8bb0\u5f55\u88ab\u79f0\u4e3acheckpoint record\uff09\u3002\u8fd9\u6761\u8bb0\u5f55\u5305\u542b\u4e86\u6700\u65b0\u7684REDO\u70b9\u7684\u4f4d\u7f6e\u3002</li> <li>\u5f53\u53d1\u8d77\u7b2c1\u6761INSERT\u8bed\u53e5\u65f6\uff0cPostgreSQL\u4ece\u6570\u636e\u5e93\u6587\u4ef6\u4e2d\u52a0\u8f7dTABLE_A\u7684\u9875\u9762\u81f3\u5185\u5b58\u4e2d\u7684\u5171\u4eab\u7f13\u51b2\u6c60\uff0c\u5411\u9875\u9762\u4e2d\u63d2\u5165\u4e00\u6761\u5143\u7ec4\uff0c\u7136\u540e\u5728LSN_1\u4f4d\u7f6e\u521b\u5efa\u5e76\u5199\u5165\u4e00\u6761\u76f8\u5e94\u7684XLOG\u8bb0\u5f55\uff0c\u518d\u5c06TABLE_A\u7684LSN\u4eceLSN_0\u66f4\u65b0\u4e3aLSN_1\u3002</li> <li>\u5f53\u8be5\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0cPostgreSQL\u5411WAL\u7f13\u51b2\u533a\u521b\u5efa\u5e76\u5199\u5165\u4e00\u6761\u5173\u4e8e\u8be5\u63d0\u4ea4\u884c\u4e3a\u7684XLOG\u8bb0\u5f55\uff0c\u518d\u5c06WAL\u7f13\u51b2\u533a\u4e2d\u7684\u6240\u6709XLOG\u8bb0\u5f55\u5199\u5165WAL\u6bb5\u6587\u4ef6\u4e2d\u3002</li> <li>\u5f53\u53d1\u8d77\u7b2c2\u6761INSERT\u8bed\u53e5\u65f6\uff0cPostgreSQL\u9996\u5148\u5411\u9875\u9762\u4e2d\u63d2\u5165\u4e00\u6761\u65b0\u5143\u7ec4\uff0c\u7136\u540e\u5728LSN_2\u4f4d\u7f6e\u521b\u5efa\u5e76\u5199\u5165\u4e00\u6761\u76f8\u5e94\u7684XLOG\u8bb0\u5f55\uff0c\u6700\u540e\u5c06TABLE_A\u7684LSN\u4eceLSN_1\u66f4\u65b0\u4e3aLSN_2\u3002</li> <li>\u5f53\u8fd9\u6761\u8bed\u53e5\u7684\u4e8b\u52a1\u63d0\u4ea4\u65f6\uff0cPostgreSQL\u6267\u884c\u540c\u7b2c3\u6b65\u7c7b\u4f3c\u7684\u64cd\u4f5c\u3002</li> <li>\u5047\u8bbe\u64cd\u4f5c\u7cfb\u7edf\u6b64\u65f6crash\uff0c\u5c3d\u7ba1\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u7684\u6240\u6709\u6570\u636e\u90fd\u4e22\u5931\u4e86\uff0c\u4f46\u662f\u6240\u6709\u9875\u9762\u4fee\u6539\u5df2\u7ecf\u4f5c\u4e3a\u5386\u53f2\u8bb0\u5f55\u88ab\u5199\u5165WAL\u6bb5\u6587\u4ef6\u4e2d\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#3-wal","title":"3. \u4e8b\u52a1\u65e5\u5fd7\u548cWAL\u6bb5\u6587\u4ef6","text":"<p>LSN\u753164\u4f4d\u7ec4\u6210\uff0c\u5373\u67092^64\u4e2a\u65e5\u5fd7\u7f16\u53f7.PostgreSQL\u4e2d\u7684\u4e8b\u52a1\u65e5\u5fd7\u9ed8\u8ba4\u88ab\u5212\u5206\u6210\u5927\u5c0f\u4e3a16MB\u7684\u6587\u4ef6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u88ab\u79f0\u4f5cWAL\u6bb5\uff0c\u5b58\u653e\u5728$PGDATA/pg_wal\u76ee\u5f55\u4e0b\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#1-wal_1","title":"1. WAL\u6587\u4ef6\u540d","text":"<p>WAL\u6bb5\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u662f\u753124\u4e2a\u5341\u516d\u8fdb\u5236\u6570\u7ec4\u6210\u7684\uff0c\u5176\u547d\u540d\u89c4\u5219\u5982\u4e0b\uff1a \u7b2c\u4e00\u4e2aWAL\u6bb5\u6587\u4ef6\u540d\u662f000000010000000000000001\uff0c\u5982\u679c\u7b2c\u4e00\u4e2a\u6bb5\u88abXLOG\u8bb0\u5f55\u5199\u6ee1\u4e86\uff0c\u5c31\u4f1a\u521b\u5efa\u7b2c\u4e8c\u4e2a\u6bb5000000010000000000000002\uff0c\u540e\u7eed\u7684\u6587\u4ef6\u540d\u5c06\u4f7f\u7528\u5347\u5e8f\u3002\u57280000000100000000000000FF\u88ab\u586b\u6ee1\u4e4b\u540e\uff0c\u5c31\u4f7f\u7528\u4e0b\u4e00\u4e2a\u6587\u4ef6000000010000000100000000\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0c\u6bcf\u5f53\u6700\u540e\u4e24\u4f4d\u6570\u5b57\u8981\u8fdb\u4f4d\u65f6\uff0c\u4e2d\u95f48\u4f4d\u6570\u5b57\u5c31\u4f1a\u52a01\u3002\u4e0e\u4e4b\u7c7b\u4f3c\uff0c\u57280000000100000001000000FF \u88ab\u586b\u6ee1\u540e\uff0c\u5c31\u4f1a\u5f00\u59cb\u4f7f\u7528000000010000000200000000\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002pg_wal\u4e0b\u6700\u5927\u7684wal\u6587\u4ef6\u4e0d\u4e00\u5b9a\u65f6\u5f53\u524d\u6b63\u5728\u4f7f\u7528\u7684\uff0cPostgreSQL\u4f1a\u63d0\u524d\u521b\u5efa\u51fa\u51e0\u4e2aWAL\u6587\u4ef6\u3002</p> <p> </p> <p>\u67e5\u770b\u5f53\u524d\u7684LSN\u4f7f\u7528\u7684\u54ea\u4e2awal\u6587\u4ef6</p> <pre><code>postgres=# select pg_current_wal_lsn();\n pg_current_wal_lsn \n--------------------\n 1/151FFF80\n(1 row)\n\npostgres=# select pg_walfile_name('1/151FFF80');\n     pg_walfile_name      \n--------------------------\n 000000040000000100000015\n(1 row)\n</code></pre> <p>WAL\u6bb5\u6587\u4ef6\u540d\u79f0\u542b\u4e49\uff1a</p> <pre><code>00000004 00000001 00000015\n-------- -------- --------\n\u65f6\u95f4\u7ebf\u6807\u8bc6  LogId    LogSeg\n</code></pre> <ul> <li>\u65f6\u95f4\u7ebf\u6807\u8bc6\uff1atimelineId,\u662f\u4ee51\u8d77\u59cb\u9012\u589e\u7684\u6b63\u6574\u6570</li> <li>LogId\uff1a\u903b\u8f91\u65e5\u5fd7\u6587\u4ef6\u53f7\uff0c\u662f\u4ee51\u8d77\u59cb\u9012\u589e\u7684\u6b63\u6574\u6570</li> <li>LogSeg\uff1a\u6bb5\u6587\u4ef6\u53f7\uff0c\u662f\u4ee51\u8d77\u59cb\u9012\u589e\u7684\u6b63\u6574\u6570</li> </ul> <p>LSN\u7f16\u53f7\u89c4\u5219\uff1a</p> <pre><code>1/151FFF80\n-- X/YYZZZZZZ\n-- (\u9ad832\u4f4d/\u4f4e32\u4f4d)\n</code></pre> <p>wal\u65e5\u5fd7\u7684logSeg\u524d6\u4f4d\u59cb\u7ec8\u662f0\uff0c\u540e\u4e24\u4f4d\u662fLSN\u4f4e32\u4f4d\u7684\u524d\u4e24\u4f4d\u3002\u5982\u4e0a\u4f8b\u4e2dlogSeg\u6700\u540e\u4e24\u4f4d\u662f15\uff0cLSN\u4f4e32\u524d\u4e24\u4f4d\u4e5f\u662f15\u3002LSN\u5728wal\u65e5\u5fd7\u4e2d\u7684\u504f\u79fb\u91cf\u5373LSN\u4f4e32\u4f4d\u4e2d\u540e24\u4f4d\u5bf9\u5e94\u7684\u5341\u8fdb\u5236\u503c\u3002</p> <pre><code>postgres=# SELECT ( x'1FFF80' )::int AS offset_computed, pg_walfile_name_offset( '1/151FFF80' );\n offset_computed |       pg_walfile_name_offset       \n-----------------+------------------------------------\n         2097024 | (000000010000000100000015,2097024)\n(1 row)\n</code></pre> <p>LogId\u548cLogSeg\u7684\u8ba1\u7b97</p> <pre><code>postgres=# select pg_current_wal_lsn();\n pg_current_wal_lsn \n--------------------\n 1/151FFF80\n(1 row)\n\n-- \u83b7\u53d6\u516c\u5f0f\u4e2dLSN\u53f7\npostgres=# select x'1151FFF80'::bigint;\n    int8    \n------------\n 4649385856\n(1 row)\n\n--\u5229\u7528\u516c\u5f0f\u8ba1\u7b97LogSeg\u6bb5\u6587\u4ef6\u53f7\npostgres=# select to_hex((4649385856-1)/(16*1024*1024) %256); \n to_hex \n--------\n 15\n(1 row)\n\n--\u5229\u7528\u516c\u5f0f\u8ba1\u7b97LogId\u903b\u8f91\u6587\u4ef6\u53f7\npostgres=# select to_hex((4649385856-1)/(16*1024*1024*256::bigint));\n to_hex \n--------\n 1\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#2-wal_1","title":"2. WAL\u7684\u5185\u90e8\u5e03\u5c40","text":"<p>\u4e00\u4e2aWAL\u6bb5\u6587\u4ef6\u7684\u9ed8\u8ba4\u5927\u5c0f\u4e3a16MB\uff0c\u5e76\u4e14\u5176\u5185\u90e8\u88ab\u5212\u5206\u6210\u5927\u5c0f\u4e3a8192B\uff088KB\uff09\u7684\u591a\u4e2a\u9875\u9762\u3002</p> <p> </p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#xlog","title":"XLOG\u8bb0\u5f55\u7684\u6570\u636e\u90e8\u5206","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#94","title":"9.4\u7248\u672c\u4ee5\u4e0b","text":"<p>XLOG\u8bb0\u5f55\u7684\u6570\u636e\u90e8\u5206\u53ef\u4ee5\u5206\u4e3a\u4e24\u7c7b\uff1a\u5907\u4efd\u533a\u5757\uff08\u5b8c\u6574\u7684\u9875\u9762\uff09\u6216\u975e\u5907\u4efd\u533a\u5757\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#95","title":"9.5\u7248\u672c\u4ee5\u4e0a","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#3-wal_1","title":"3. WAL\u8bb0\u5f55\u7684\u5199\u5165","text":"<pre><code>INSERT INTO tbl VALUES ('A');\n</code></pre> <p>\u5f53\u6267\u884cinsert\u65f6\u5185\u90e8\u51fd\u6570exec_simple_query()\u4f1a\u88ab\u8c03\u7528\uff0c\u5176\u5185\u90e8\u7684\u6267\u884c\u5982\u4e0b\uff1a</p> <ol> <li>\u51fd\u6570ExtendCLOG()\u5c06\u5f53\u524d\u4e8b\u52a1\u7684\u72b6\u6001IN_PROGRESS\u5199\u5165\u5185\u5b58\u4e2d\u7684CLOG\u3002</li> <li>\u51fd\u6570heap_insert()\u5411\u5171\u4eab\u7f13\u51b2\u6c60\u7684\u76ee\u6807\u9875\u9762\u4e2d\u63d2\u5165\u5806\u5143\u7ec4\uff0c\u521b\u5efa\u5f53\u524d\u9875\u9762\u7684XLOG\u8bb0\u5f55\uff0c\u5e76\u6267\u884c\u51fd\u6570XLogInsert()\u3002</li> <li>\u51fd\u6570XLogInsert()\u4f1a\u5c06heap_insert()\u521b\u5efa\u7684XLOG\u8bb0\u5f55\u5199\u5165WAL\u7f13\u51b2\u533aLSN_1\u5904\uff0c\u5e76\u5c06\u88ab\u4fee\u6539\u9875\u9762\u7684pd_lsn\u4eceLSN_0\u66f4\u65b0\u4e3aLSN_1\u3002</li> <li>\u51fd\u6570 finish_xact_command()\u4f1a\u5728\u63d0\u4ea4\u8be5\u4e8b\u52a1\u65f6\u88ab\u8c03\u7528\uff0c\u7528\u4e8e\u521b\u5efa\u8be5\u63d0\u4ea4\u52a8\u4f5c\u7684XLOG\u8bb0\u5f55\uff0c\u800c\u8fd9\u91cc\u7684XLogInsert()\u51fd\u6570\u4f1a\u5c06\u8be5\u8bb0\u5f55\u5199\u5165WAL\u7f13\u51b2\u533aLSN_2\u5904\u3002</li> <li>\u51fd\u6570 XLogWrite()\u4f1a\u5237\u5199WAL\u7f13\u51b2\u533a\uff0c\u5e76\u5c06\u6240\u6709\u5185\u5bb9\u5199\u5165WAL\u6bb5\u6587\u4ef6\u4e2d\u3002\u5982\u679cwal_sync_method\u53c2\u6570\u88ab\u914d\u7f6e\u4e3aopen_sync\u6216open_datasync\uff0c\u8bb0\u5f55\u4f1a\u88ab\u540c\u6b65\u5199\u5165\uff0c\u56e0\u4e3a\u51fd\u6570\u4f1a\u4f7f\u7528\u5e26\u6709O_SYNC\u6216O_DSYNC\u6807\u8bb0\u7684open()\u7cfb\u7edf\u8c03\u7528\u3002</li> <li>\u51fd\u6570TransactionIdCommitTree()\u5c06\u63d0\u4ea4\u65e5\u5fd7CLOG\u4e2d\u5f53\u524d\u4e8b\u52a1\u7684\u72b6\u6001\u4eceIN_PROGRESS\u66f4\u6539\u4e3aCOMMITTED\u3002</li> </ol> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0cCOMMIT\u64cd\u4f5c\u5bfc\u81f4XLOG\u8bb0\u5f55\u5199\u5165WAL\u6bb5\u6587\u4ef6\u3002\u4f46\u53d1\u751f\u4e0b\u5217\u4efb\u4e00\u60c5\u51b5\uff0c\u90fd\u4f1a\u6267\u884c\u8fd9\u79cd\u5199\u5165\u64cd\u4f5c\uff1a</p> <ol> <li>\u4e00\u4e2a\u8fd0\u884c\u4e2d\u7684\u4e8b\u52a1\u63d0\u4ea4\u6216\u4e2d\u6b62\u3002</li> <li>WAL\u7f13\u51b2\u533a\u88ab\u5199\u5165\u7684\u5143\u7ec4\u586b\u6ee1\uff08WAL\u7f13\u51b2\u533a\u7684\u5927\u5c0f\u7531\u53c2\u6570wal_buffers\u63a7\u5236\uff09\u3002</li> <li>WAL\u5199\u5165\u8fdb\u7a0b\u5468\u671f\u6027\u5730\u6267\u884c\u5199\u5165\u64cd\u4f5c</li> </ol> <p>\u5982\u679c\u51fa\u73b0\u4e0a\u8ff0\u60c5\u51b5\u4e4b\u4e00\uff0c\u65e0\u8bba\u5176\u4e8b\u52a1\u662f\u5426\u5df2\u63d0\u4ea4\uff0cWAL\u7f13\u51b2\u533a\u4e0a\u7684\u6240\u6709WAL\u8bb0\u5f55\u90fd\u5c06\u88ab\u5199\u5165WAL\u6bb5\u6587\u4ef6\u4e2d\u3002</p> <p>\u5176\u4ed6\u89e6\u53d1WAL\u5199\u7684\u64cd\u4f5c\uff1a</p> <ol> <li>COMMIT\u64cd\u4f5c\u4f1a\u5199\u5165\u5305\u542b\u63d0\u4ea4\u7684\u4e8b\u52a1ID\u7684XLOG\u8bb0\u5f55\u3002</li> <li>Checkpoint \u64cd\u4f5c\u4f1a\u5199\u5165\u5173\u4e8e\u8be5\u68c0\u67e5\u70b9\u6982\u8ff0\u4fe1\u606f\u7684XLOG\u8bb0\u5f55\u3002</li> <li>SELECT\u8bed\u53e5\u5728\u4e00\u4e9b\u7279\u6b8a\u60c5\u51b5\u4e0b\u4e5f\u4f1a\u521b\u5efaXLOG\u8bb0\u5f55\u3002\u4f8b\u5982\u5728SELECT\u8bed\u53e5\u7684\u5904\u7406\u8fc7\u7a0b\u4e2d\uff0c\u5982\u679cHOT (Heap Only Tuple) \u9700\u8981\u5220\u9664\u4e0d\u5fc5\u8981\u7684\u5143\u7ec4\u5e76\u62fc\u63a5\u5fc5\u8981\u7684\u5143\u7ec4\uff0c\u90a3\u4e48\u4fee\u6539\u5bf9\u5e94\u9875\u9762\u7684XLOG\u8bb0\u5f55\u5c31\u4f1a\u88ab\u5199\u5165WAL\u7f13\u51b2\u533a\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#4-wal","title":"4. \u67e5\u770bWAL\u7684\u65e5\u5fd7\u5185\u90e8","text":"<pre><code>-- \u5b89\u88c5\u6269\u5c55\npostgres=# create extension pageinspect;\nCREATE EXTENSION\n-- \u5148\u521b\u5efa\u4e00\u5f20\u8868\npostgres=# CREATE TABLE tbl(id integer);\nCREATE TABLE\npostgres=# INSERT INTO tbl VALUES (1);\nINSERT 0 1\n-- \u5f00\u59cb\u4e00\u4e2a\u4e8b\u52a1\uff0c\u5e76\u8bb0\u4f4f\u63d2\u5165WAL\u7684\u4f4d\u7f6e\uff1a\npostgres=# BEGIN;\nBEGIN\npostgres=# SELECT pg_current_wal_insert_lsn();\n pg_current_wal_insert_lsn \n---------------------------\n 1/17040218\n(1 row)\n-- \u66f4\u65b0\u4e00\u884c\u6570\u636e\npostgres=# UPDATE tbl set id = id + 1;\nUPDATE 1\n-- \u6b64\u66f4\u6539\u5df2\u88abWAL\u8bb0\u5f55\uff0c\u5e76\u4e14\u63d2\u5165\u4f4d\u7f6e\u5df2\u66f4\u6539\npostgres=# SELECT pg_current_wal_insert_lsn();\n pg_current_wal_insert_lsn \n---------------------------\n 1/17040298\n(1 row)\n-- \u4e3a\u4e86\u786e\u4fdd\u5728WAL\u8bb0\u5f55\u4e4b\u524d\u4e0d\u4f1a\u5c06\u66f4\u6539\u540e\u7684\u6570\u636e\u9875\u5237\u65b0\u5230\u78c1\u76d8\uff0c\u4e0e\u8be5\u9875\u76f8\u5173\u7684\u6700\u540e\u4e00\u4e2aWAL\u8bb0\u5f55\u7684LSN\u5b58\u50a8\u5728\u9875\u5934\u4e2d\npostgres=# SELECT lsn FROM page_header(get_raw_page('tbl',0));\n    lsn     \n------------\n 1/17040298\n(1 row)\n-- \u6b64\u65f6\u63d0\u4ea4\u4e8b\u52a1\npostgres=# COMMIT;\nCOMMIT\n-- \u63d0\u4ea4\u4e5f\u88abWAL\u8bb0\u5f55\uff0c\u5e76\u4e14\u4f4d\u7f6e\u518d\u6b21\u66f4\u6539\npostgres=# SELECT pg_current_wal_insert_lsn();\n pg_current_wal_insert_lsn \n---------------------------\n 1/17040330\n(1 row)\n-- \u521b\u5efa\u7684WAL\u8bb0\u5f55\u5c06\u88ab\u4e00\u6b21\u5199\u5165\u78c1\u76d8\npostgres=# SELECT pg_current_wal_lsn(), pg_current_wal_insert_lsn();\n pg_current_wal_lsn | pg_current_wal_insert_lsn \n--------------------+---------------------------\n 1/17040330         | 1/17040330\n(1 row)\n-- \u901a\u8fc7lsn\uff0c\u6211\u4eec\u53ef\u4ee5\u6bd4\u8f83\u4e24\u4e2alsn\u4e4b\u95f4\u7684wal\u8bb0\u5f55\u6570\u91cf\uff08\u5355\u4f4d\u662f\u5b57\u8282\uff09\uff0c\u73b0\u5728\u67e5\u4e00\u4e0bbegin\u5230commit\npostgres=# SELECT '1/17040330'::pg_lsn - '1/17040218'::pg_lsn;\n ?column? \n----------\n      280\n(1 row)\n-- \u53ef\u77e5\u6574\u4e2a\u8fc7\u7a0b\u5728WAL\u4e2d\u9700\u8981296\u4e2a\u5b57\u8282\uff0c\u8fd9\u53ef\u4ee5\u8bc4\u4f30\u670d\u52a1\u5668\u5728\u4e00\u5b9a\u8d1f\u8f7d\u4e0b\u6bcf\u5355\u4f4d\u65f6\u95f4\u751f\u6210\u7684WAL\u8bb0\u5f55\u7684\u6570\u91cf\n</code></pre> <p>\u53ef\u4ee5\u4f7f\u7528pg_waldump\u67e5\u770b\u521b\u5efa\u7684wal\u8bb0\u5f55\u60c5\u51b5 </p> <pre><code>postgres@ubuntu:~$ pg_waldump  -s 1/17040218 -e 1/17040330 -p $PGDATA/pg_wal  000000040000000100000017\nrmgr: Standby     len (rec/tot):     50/    50, tx:          0, lsn: 1/17040218, prev 1/170401F0, desc: RUNNING_XACTS nextXid 1049913 latestCompletedXid 1049912 oldestRunningXid 1049913\nrmgr: Heap        len (rec/tot):     69/    69, tx:    1049913, lsn: 1/17040250, prev 1/17040218, desc: HOT_UPDATE off 1 xmax 1049913 flags 0x40 ; new off 2 xmax 0, blkref #0: rel 1663/12675/25840 blk 0\nrmgr: Standby     len (rec/tot):     54/    54, tx:          0, lsn: 1/17040298, prev 1/17040250, desc: RUNNING_XACTS nextXid 1049914 latestCompletedXid 1049912 oldestRunningXid 1049913; 1 xacts: 1049913\nrmgr: Heap2       len (rec/tot):     56/    56, tx:    1049913, lsn: 1/170402D0, prev 1/17040298, desc: CLEAN remxid 0, blkref #0: rel 1663/12675/25350 blk 78\nrmgr: Transaction len (rec/tot):     34/    34, tx:    1049913, lsn: 1/17040308, prev 1/170402D0, desc: COMMIT 2023-05-11 22:42:27.878084 CST\n</code></pre> <p>\u7b2c\u4e8c\u884c\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u4e2a\u662fHOT_UPDATE\u64cd\u4f5c\uff0c\u4e0e\u5806\u8d44\u6e90\u7ba1\u7406\u5668\u6709\u5173\uff0c\u6587\u4ef6\u540d\u548c\u9875\u7801\u5728<code>blkref</code>\u5b57\u6bb5\u4e2d\u6307\u5b9a\uff0c\u6b64\u5904\u4e3a1663/12675/25840</p> <pre><code>postgres=# select pg_relation_filepath('tbl');\n pg_relation_filepath \n----------------------\n base/12675/25840\n(1 row)\n</code></pre> <p>\u7b2c\u4e09\u884c\u53ef\u4ee5\u770b\u5230COMMIT\uff0c\u4e0e\u4e8b\u52a1\u8d44\u6e90\u7ba1\u7406\u5668\u6709\u5173.</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#4-walwriter","title":"4. walwriter\u8fdb\u7a0b","text":"<p>walwriter\u662f\u4e00\u4e2a\u540e\u53f0\u8fdb\u7a0b\uff0c\u7528\u4e8e\u5b9a\u671f\u68c0\u67e5WAL\u7f13\u51b2\u533a\uff0c\u5e76\u5c06\u6240\u6709\u672a\u5199\u5165\u7684XLOG\u8bb0\u5f55\u5199\u5165WAL\u6bb5\u6587\u4ef6\u3002\u8fd9\u4e2a\u8fdb\u7a0b\u7684\u76ee\u7684\u662f\u907f\u514dXLOG\u8bb0\u5f55\u7684\u7a81\u53d1\u5199\u5165\u3002\u5982\u679c\u6ca1\u6709\u542f\u7528\u8be5\u8fdb\u7a0b\uff0c\u5219\u5728\u4e00\u6b21\u63d0\u4ea4\u5927\u91cf\u6570\u636e\u65f6\uff0cXLOG\u8bb0\u5f55\u7684\u5199\u5165\u53ef\u80fd\u4f1a\u6210\u4e3a\u74f6\u9888\u3002 walwriter\u9ed8\u8ba4\u662f\u542f\u7528\u7684\uff0c\u65e0\u6cd5\u7981\u7528\u3002\u4f46\u68c0\u67e5\u95f4\u9694\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570wal_writer_delay\u8fdb\u884c\u914d\u7f6e\uff0c\u9ed8\u8ba4\u503c\u4e3a200ms\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#5-wal","title":"5. WAL\u65e5\u5fd7\u5207\u6362","text":"<p>WAL\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u53d1\u751f\u65e5\u5fd7\u5207\u6362</p> <ol> <li>WAL\u6bb5\u5df2\u7ecf\u5199\u6ee1\u3002</li> <li>\u51fd\u6570pg_switch_xlog()\uff0810.0\u7248\u672c\u4ee5\u540e\u4e3apg_switch_wal()\uff09\u88ab\u8c03\u7528\u3002</li> <li>\u542f\u7528\u4e86archive_mode\uff0c\u4e14\u5df2\u7ecf\u8d85\u8fc7archive_timeout\u914d\u7f6e\u7684\u65f6\u95f4\u3002</li> </ol> <p>\u88ab\u5207\u6362\u7684\u6587\u4ef6\u901a\u5e38\u4f1a\u88ab\u56de\u6536\uff08\u91cd\u547d\u540d\u6216\u91cd\u7528\uff09\uff0c\u4ee5\u4f9b\u672a\u6765\u4f7f\u7528\u3002\u4f46\u5982\u679c\u4e0d\u9700\u8981\u7684\u8bdd\uff0c\u4e5f\u53ef\u80fd\u4f1a\u88ab\u79fb\u9664\u3002</p> <pre><code>postgres=# select pg_switch_wal();\n pg_switch_wal \n---------------\n 1/13043AD8\n(1 row)\n\npostgres=#\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#6-wal","title":"6. WAL\u6bb5\u7ba1\u7406","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#61-94","title":"6.1 9.4\u7248\u672c\u4ee5\u524d","text":"<p>WAL\u6bb5\u6587\u4ef6\u7684\u6570\u91cf\u4e3b\u8981\u7531\u4e0b\u52173\u4e2a\u53c2\u6570\u63a7\u5236\uff1a</p> <ol> <li>checkpoint_segments</li> <li>checkpoint_completion_target</li> <li>wal_keep_segments</li> </ol> <p>WAL\u6bb5\u6587\u4ef6\u7684\u6570\u91cf\u901a\u5e38\u6709\u4ee5\u4e0b\u51e0\u4e2a\u7279\u70b9\uff1a</p> <ol> <li>\u6bd4((2 + checkpoint_completion_target) \u00d7 checkpoint_segments + 1)\u5927.</li> <li>\u6bd4(checkpoint_segments + wal_keep_segments + 1)\u5927</li> <li>\u4e0d\u8d85\u8fc7(3\u00d7checkpoint_segments+1)\u4e2a\u6587\u4ef6</li> </ol> <p>\u5f53\u6d88\u8017\u4e86\u8d85\u8fc7checkpoint_segments\u4e2a\u6570\u91cf\u7684\u6587\u4ef6\u65f6\uff0c\u5c31\u4f1a\u542f\u52a8\u68c0\u67e5\u70b9\u8fdb\u7a0b\u56e0\u6b64\u53ef\u4ee5\u4fdd\u8bc1WAL\u6bb5\u6587\u4ef6\u4e2d\u603b\u662f\u5305\u542b\u81f3\u5c11\u4e24\u4e2aRedo\u70b9\uff0c\u6587\u4ef6\u7684\u6570\u91cf\u59cb\u7ec8\u5927\u4e8e2\u00d7checkpoint_segments\u3002</p> <p>PostgreSQL\u603b\u662f\u4f1a\u4fdd\u7559\u8db3\u591f\u7528\u4e8e\u6062\u590d\u7684WAL\u6bb5\u6587\u4ef6\u6570\uff08\u6709\u65f6\u5019\u4f1a\u8d85\u51fa\u5fc5\u8981\u7684\u91cf\uff09\u3002checkpoint_segments\u5982\u679c\u8bbe\u7f6e\u7684\u503c\u8f83\u5c0f\uff0c\u5219checkpoint\u9891\u7e41\u53d1\u751f\uff0c\u4f1a\u5bfc\u81f4\u6027\u80fd\u4e0b\u964d\uff0c\u800c\u5982\u679c\u8bbe\u7f6e\u7684\u503c\u8f83\u5927\uff0c\u5219WAL\u6587\u4ef6\u603b\u662f\u9700\u8981\u5de8\u5927\u7684\u78c1\u76d8\u7a7a\u95f4\uff0c\u4f46\u5176\u4e2d\u4e00\u4e9b\u7a7a\u95f4\u4e0d\u662f\u5fc5\u8981\u7684\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/WAL/#62-95","title":"6.2  9.5\u7248\u672c\u4ee5\u540e","text":"<p>checkpoint_segments\u53c2\u6570\u88ab\u5f03\u7528\u3002</p> <p>\u6bcf\u5f53\u68c0\u67e5\u70b9\u8fdb\u7a0b\u542f\u52a8\u65f6\uff0cPostgreSQL\u90fd\u4f1a\u4f30\u8ba1\u5e76\u51c6\u5907\u4e0b\u4e00\u4e2a\u68c0\u67e5\u70b9\u5468\u671f\u6240\u9700\u7684WAL\u6bb5\u6587\u4ef6\u6570\u3002\u8fd9\u79cd\u4f30\u8ba1\u57fa\u4e8e\u524d\u4e00\u4e2a\u68c0\u67e5\u70b9\u5468\u671f\u4e2d\u6d88\u8017\u7684\u6587\u4ef6\u6570\u91cf\uff0c\u5373\u4ece\u5305\u542b\u4e0a\u4e00\u4e2a\u91cd\u505a\u70b9\u7684\u6bb5\u6587\u4ef6\u5f00\u59cb\u8ba1\u6570\uff0c\u800c\u8fd9\u4e2a\u503c\u5e94\u5f53\u5728min_wal_size\uff08\u9ed8\u8ba4\u503c\u4e3a80MB,5\u4e2a\u6587\u4ef6\uff09\u4e0emax_wal_size \u4e4b\u95f4\uff08\u9ed8\u8ba4\u503c\u4e3a1GB,64\u4e2a\u6587\u4ef6\uff09\u3002\u5982\u679c\u68c0\u67e5\u70b9\u8fdb\u7a0b\u542f\u52a8\uff0c\u5fc5\u8981\u7684\u6bb5\u6587\u4ef6\u5c31\u4f1a\u88ab\u4fdd\u7559\u6216\u56de\u6536\uff0c\u4e0d\u5fc5\u8981\u7684\u6bb5\u6587\u4ef6\u5c31\u4f1a\u88ab\u79fb\u9664\u3002</p> <p> </p> <p>\u5047\u8bbe\u5728\u68c0\u67e5\u70b9\u5f00\u59cb\u524d\u67096\u4e2a\u6587\u4ef6\uff0cWAL_3\u5305\u542b\u4e86\u4e0a\u4e00\u4e2aREDO\u70b9\uff0810.0\u53ca\u66f4\u4f4e\u7248\u672c\uff0c11.0\u7248\u672c\u540e\u5c31\u662f\u5f53\u524d\u91cd\u505a\u70b9\uff09,PostgreSQL\u4f30\u8ba1\u9700\u89815\u4e2a\u6587\u4ef6\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cWAL_1\u88ab\u91cd\u547d\u540d\u4e3aWAL_7\u56de\u6536\u5229\u7528\uff0c\u800cWAL_2\u88ab\u79fb\u9664\u3002\u4efb\u4f55\u6bd4\u5305\u542b\u4e0a\u4e00\u4e2a\u91cd\u505a\u70b9\u7684\u6bb5\u6587\u4ef6\u66f4\u8001\u7684\u6bb5\u6587\u4ef6\u90fd\u53ef\u4ee5\u88ab\u79fb\u9664\u3002</p> <p> </p> <p>\u5982\u4e0a\u56fe\uff0c\u5982\u679c\u51fa\u73b0\u4e86WAL\u6d3b\u52a8\u5c16\u5cf0\uff0c\u5bfc\u81f4\u9700\u8981\u66f4\u591a\u7684\u6587\u4ef6\uff0c\u65b0\u7684\u6587\u4ef6\u5c31\u4f1a\u88ab\u521b\u5efa\uff0c\u800cWAL\u6587\u4ef6\u7684\u603b\u5927\u5c0f\u5c0f\u4e8emax_wal_size\u3002</p> <p>WAL\u6587\u4ef6\u7684\u6570\u91cf\u4f1a\u6839\u636e\u670d\u52a1\u5668\u6d3b\u52a8\u800c\u81ea\u52a8\u9002\u914d\u3002\u5982\u679cWAL\u6570\u636e\u5199\u5165\u91cf\u6301\u7eed\u589e\u52a0\uff0c\u5219WAL\u6bb5\u6587\u4ef6\u7684\u4f30\u8ba1\u6570\u91cf\u4ee5\u53caWAL\u6587\u4ef6\u7684\u603b\u5927\u5c0f\u4e5f\u4f1a\u968f\u4e4b\u589e\u52a0\u3002\u5728\u76f8\u53cd\u7684\u60c5\u51b5\u4e0b\uff08\u5373WAL\u6570\u636e\u5199\u5165\u91cf\u51cf\u5c11\uff09\uff0c\u8fd9\u4e9b\u503c\u4e5f\u4f1a\u51cf\u5c11\u3002</p> <p> </p> <p>\u5982\u679cWAL\u6587\u4ef6\u7684\u603b\u5927\u5c0f\u8d85\u8fc7max_wal_size\uff0c\u5219\u5c06\u542f\u52a8\u68c0\u67e5\u70b9\u3002\u68c0\u67e5\u70b9\u5c06\u4f1a\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u91cd\u505a\u70b9\uff0c\u6700\u8fd1\u7684\u91cd\u505a\u70b9\u5c06\u4f1a\u53d8\u4e3a\u4e0a\u4e00\u4e2a\u91cd\u505a\u70b9\uff0c\u4e0d\u5fc5\u8981\u7684\u6587\u4ef6\u5c06\u88ab\u56de\u6536\u3002\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\uff0cPostgreSQL\u5c06\u59cb\u7ec8\u53ea\u4fdd\u7559\u6570\u636e\u5e93\u6062\u590d\u6240\u5fc5\u9700\u7684WAL\u6bb5\u6587\u4ef6\u3002</p> <p>max_wal_size\u662f\u4e00\u4e2a\u8f6f\u9650\u5236\uff0c\u5728\u7279\u6b8a\u7684\u60c5\u51b5\u4e0bWAL\u5c3a\u5bf8\u53ef\u80fd\u4f1a\u8d85\u8fc7max_wal_size\uff0c \u4f8b\u5982\u5728\u91cd\u5ea6\u8d1f\u8377\u4e0b\u3001archive_command\u5931\u8d25\u6216\u8005\u9ad8\u7684wal_keep_segments\u8bbe\u7f6e\u3002\u9ed8\u8ba4\u4e3a1GB\u3002\u589e\u52a0\u8fd9\u4e2a\u53c2\u6570\u53ef\u80fd\u5bfc\u81f4\u5d29\u6e83\u6062\u590d\u6240\u9700\u7684\u65f6\u95f4\u3002 </p> <pre><code>postgres=# show max_wal_size;\n max_wal_size \n--------------\n 1GB\n(1 row)\npostgres=# show min_wal_size;\n min_wal_size \n--------------\n 80MB\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/","title":"autovacuum","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum","title":"autovacuum","text":"<p>Autovacuum\u662f\u542f\u52a8PostgresQL\u65f6\u81ea\u52a8\u542f\u52a8\u7684\u540e\u53f0\u5b9e\u7528\u7a0b\u5e8f\u8fdb\u7a0b\u4e4b\u4e00 \u5728\u751f\u4ea7\u7cfb\u7edf\u4e2d\u4e0d\u5e94\u8be5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u5173\u95ed</p> <pre><code>autovacuum= on #\uff08ON by default\uff09\ntrack_counts= on #\uff08ON by default\uff09\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum_1","title":"autovacuum\u4f5c\u7528","text":"<ol> <li>\u9700\u8981vacuum\u6765\u79fb\u9664\u6b7b\u5143\u7ec4</li> <li>\u9632\u6b62\u6b7b\u5143\u7ec4\u81a8\u80c0</li> <li>\u66f4\u65b0\u8868\u7684\u7edf\u8ba1\u4fe1\u606f\u8fdb\u884c\u5206\u6790\uff0c\u4ee5\u4fbf\u63d0\u4f9b\u4f18\u5316\u5668\u4f7f\u7528</li> <li>autovacuum launcher\u4f7f\u7528Stats Collector\u7684\u540e\u53f0\u8fdb\u7a0b\u6536\u96c6\u7684\u4fe1\u606f\u6765\u786e\u5b9aautovacuum\u7684\u5019\u9009\u8868\u5217\u8868</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum_2","title":"\u8bb0\u5f55autovacuum","text":"<pre><code>log_autovacuum_min_duration\n    -1  \u8868\u793a\u4e0d\u8bb0\u5f55\n    0\uff1a\u8868\u793a\u8bb0\u5f55\u6240\u6709\u7684\n    250ms # or 1s\uff0c1min\uff0c1h\uff0c1d:\u8868\u793a\u8bb0\u5f55\u771f\u7a7a\u64cd\u4f5c\u65f6\u95f4\u5927\u4e8e\u6b64\u503c\u7684\u64cd\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum_3","title":"\u4ec0\u4e48\u65f6\u5019\u505aautovacuum?","text":"<ol> <li>Autovacuum\u64cd\u4f5c\u7684\u5b9e\u9645\u5185\u5bb9:</li> <li>vacuum;</li> <li>Analyze</li> <li>Autovacuum vacuum\u89e6\u53d1\u6761\u4ef6(\u5982\u679c\u7531\u4e8e\u66f4\u65b0\u548c\u5220\u9664\uff0c\u8868\u4e2d\u7684\u5b9e\u9645\u6b7b\u5143\u7ec4\u6570\u8d85\u8fc7\u6b64\u6709\u6548\u9608\u503c\uff0c\u5219\u8be5\u8868\u5c06\u6210\u4e3aautovacuum\u7684\u5019\u9009\u8868)\uff1a <code>Autovacuum VACUUM thresold for a table = autovacuum_vacuum_scale_factor * number of tuples + autovacuum_vacuum_threshold</code></li> <li>Autovacuum ANALYZE\u89e6\u53d1\u6761\u4ef6(\u81ea\u4e0a\u6b21\u5206\u6790\u4ee5\u6765\u63d2\u5165/\u5220\u9664/\u66f4\u65b0\u603b\u6570\u8d85\u8fc7\u6b64\u9608\u503c\u7684\u4efb\u4f55\u8868\u90fd\u6709\u8d44\u683c\u8fdb\u884cautovacuum\u5206\u6790)\uff1a<code>Autovacuum ANALYZE threshold for a table = autovacuum_analyze_scale_factor * number of tuples + autovacuum_analyze_threshold</code></li> </ol> <p>\u4f8b\u5982\u8868Employee\u67091000\u884c \u4ee5\u4e0a\u8ff0\u6570\u5b66\u516c\u5f0f\u4e3a\u53c2\u8003\uff1a \u5f53\u6ee1\u8db3<code>Total number of Obsolete records = (0.2 * 1000) + 50 = 250</code>\u7684\u6761\u4ef6\u65f6\uff0cemployee\u6210\u4e3aautovacuum Vacuum\u7684\u5019\u9009\u8005\u3002 \u5f53\u6ee1\u8db3<code>Total number of Inserts/Deletes/Updates = (0.1 * 1000) + 50 = 150</code>\u7684\u6761\u4ef6\u65f6\uff0cemployee\u6210\u4e3aautovacuum ANALYZE\u7684\u5019\u9009\u8005\u3002</p> <p>\u4e0a\u8ff0\u53c2\u6570\u503c\u6709\u4e00\u4e2a\u95ee\u9898\uff1a \u5f53Table1\u6709100\u884c\uff0c\u5176\u89e6\u53d1\u5206\u6790\u548cvacuum\u7684\u9608\u503c\u5206\u522b\u662f\uff1a60\u548c70\u3002 \u5f53Table2\u6709100\u4e07\u884c\uff0c\u5176\u89e6\u53d1\u5206\u6790\u548cvacuum\u7684\u9608\u503c\u5206\u522b\u662f\uff1a100050\u548c200050\u3002 \u5982\u679c\u4e24\u5f20\u8868\u90fd\u505a\u540c\u6837\u6570\u91cf\u7684dml\u64cd\u4f5c\uff0cT1\u89e6\u53d1autovacuum\u662fT2\u76842857\u500d!</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum-setting","title":"\u5982\u4f55\u786e\u5b9a\u9700\u8981\u8c03\u6574\u5176autovacuum setting\u7684\u8868?","text":"<p>\u4e3a\u4e86\u5355\u72ec\u8c03\u6574\u8868\u7684autovacuum\uff0c\u5fc5\u987b\u77e5\u9053\u4e00\u6bb5\u65f6\u95f4\u5185\u8868\u4e0a\u7684\u63d2\u5165/\u5220\u9664/\u66f4\u65b0\u6570\u3002</p> <pre><code>SELECT n_tup_ins as \"inserts\",n_tup_upd as \"updates\",n_tup_del as \"deletes\",n_live_tup as \"live_tuples\", n_dead_tup as \"dead_tuples\"\nFROM pg_stat_user_tables\nWHERE schemaname = 'scott' and relname = 'employee';\ninserts | updates | deletes | live_tuples | dead_tuples\n---------+---------+---------+-------------+-------------\n30 | 40 | 9 | 21 | 49\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum-setting_1","title":"\u8c03\u6574\u8868\u7684autovacuum setting\u7684\u8bbe\u7f6e","text":"<p>\u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u5355\u4e2a\u8868\u7684\u5b58\u50a8\u53c2\u6570\u6765\u91cd\u5199\u6b64\u884c\u4e3a\uff0c\u8fd9\u6837\u4f1a\u5ffd\u7565\u5168\u5c40\u8bbe\u7f6e\u3002 <pre><code>postgres=# alter table percona.employee set (autovacuum_vacuum_threshold = 100);\npostgres=# alter table percona.employee set (autovacuum_vacuum_scale_factor=0);\npostgres=# \\d+ percona.employee\nTable \"percona.employee\"\nColumn | Type | Collation | Nullable | Default | Storage | Stats target | Description\n--------+---------+-----------+----------+---------+---------+--------------+-------------\nid | integer | | | | plain | |\nOptions: autovacuum_vacuum_threshold=100, autovacuum_vacuum_scale_factor = 0\n</code></pre></p> <p>\u53ea\u8981\u6709\u8d85\u8fc7100\u6761\u8fc7\u65f6\u7684\u8bb0\u5f55,\u8fd0\u884cautovacuum vacuum.</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum_max_workers","title":"autovacuum_max_workers","text":"<p>\u4e00\u6b21\u53ef\u4ee5\u8fd0\u884c\u591a\u5c11\u4e2aautovacuum\u8fc7\u7a0b</p> <p>1\u3001\u5728\u53ef\u80fd\u5305\u542b\u591a\u4e2a\u6570\u636e\u5e93\u7684\u5b9e\u4f8b/\u7fa4\u96c6\u4e0a\uff0c\u4e00\u6b21\u8fd0\u884c\u7684autovacuum\u8fdb\u7a0b\u6570\u4e0d\u80fd\u8d85\u8fc7\u4e0b\u9762\u53c2\u6570\u8bbe\u7f6e\u7684\u503c\uff1a</p> <pre><code>autovacuum_max_workers = 3 (Default)\n</code></pre> <p>2\u3001\u542f\u52a8\u4e0b\u4e00\u4e2aautovacuum\u4e4b\u524d\u7684\u7b49\u5f85\u65f6\u95f4\uff1a</p> <pre><code>autovacuum_naptime = 1min\n(autovacuum_naptime/N) \u5176\u4e2dN\u662f\u5b9e\u4f8b\u4e2d\u6570\u636e\u5e93\u7684\u603b\u6570\n</code></pre> <p>autovacuum\u53ef\u4ee5\u770b\u4f5c\u662f\u4e00\u79cd\u6e05\u6d01\u5de5\u4f5c\uff0c\u662f\u4e00\u4e2aIO\u5bc6\u96c6\u578b\u64cd\u4f5c\u3002\u53ef\u4ee5\u8bbe\u7f6e\u4e00\u4e9b\u53c2\u6570\u6765\u6700\u5c0f\u5316autovacuum\u5bf9IO\u7684\u5f71\u54cd\u3002</p> <pre><code>autovacuum_vacuum_cost_limit : autovacuum\u53ef\u8fbe\u5230\u7684\u603b\u6210\u672c\u9650\u5236(\u7ed3\u5408\u6240\u6709autovacuum\u4f5c\u4e1a)\nautovacuum_vacuum_cost_delay : \u5f53\u4e00\u4e2a\u6e05\u7406\u5de5\u4f5c\u8fbe\u5230autovacuum_vacuum_cost_limit\u6307\u5b9a\u7684\u6210\u672c\u9650\u5236\u65f6\uff0cautovacuum\u5c06\u4f11\u7720\u6570\u6beb\u79d2\nvacuum_cost_page_hit : \u8bfb\u53d6\u5df2\u5728\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u4e14\u4e0d\u9700\u8981\u78c1\u76d8\u8bfb\u53d6\u7684\u9875\u7684\u6210\u672c.\nvacuum_cost_page_miss : \u83b7\u53d6\u4e0d\u5728\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u7684\u9875\u7684\u6210\u672c.\nvacuum_cost_page_dirty : \u5728\u6bcf\u4e00\u9875\u4e2d\u53d1\u73b0\u6b7b\u5143\u7ec4\u65f6\u5199\u5165\u8be5\u9875\u7684\u6210\u672c.\n</code></pre> <p>\u5982\u679c\u4e0a\u9762\u53c2\u6570\u9ed8\u8ba4\u7684\u503c\u8bbe\u7f6e\u5982\u4e0b\uff1a</p> <pre><code>autovacuum_vacuum_cost_limit = 200\nautovacuum_vacuum_cost_delay = 20ms\nvacuum_cost_page_hit = 1\nvacuum_cost_page_miss = 10\nvacuum_cost_page_dirty = 20\n</code></pre> <p>\u4e00\u79d2\uff081000\u6beb\u79d2\uff09\u5185\uff0c\u5728\u8bfb\u53d6\u5ef6\u8fdf\u4e3a0\u6beb\u79d2\u7684\u6700\u4f73\u60c5\u51b5\u4e0b\uff0cautovacuum\u53ef\u4ee5\u5524\u9192\u5e76\u8fdb\u5165\u7761\u772050\u6b21(1000\u6beb\u79d2/20\u6beb\u79d2)\uff0c\u56e0\u4e3a\u5524\u9192\u4e4b\u95f4\u7684\u5ef6\u8fdf\u9700\u898120\u6beb\u79d2\u3002<code>second = 1000 milliseconds = 50 * autovacuum_vacuum_cost_delay</code> \u7531\u4e8e\u5728\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u6bcf\u6b21\u8bfb\u53d6\u4e00\u4e2a\u9875\u9762\u7684\u76f8\u5173\u6210\u672c\u662f1\uff0c\u56e0\u6b64\u5728\u6bcf\u4e2a\u5524\u9192\u4e2d\u53ef\u4ee5\u8bfb\u53d6200\u4e2a\u9875\u9762(\u56e0\u4e3a\u4e0a\u9762\u628a\u603b\u6210\u672c\u9650\u5236\u8bbe\u7f6e\u4e3a200)\uff0c\u572850\u4e2a\u5524\u9192\u4e2d\u53ef\u4ee5\u8bfb\u53d650200\u4e2a\u9875\u9762\u3002 \u5982\u679c\u5728\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u627e\u5230\u4e86\u6240\u6709\u5177\u6709\u6b7b\u5143\u7ec4\u7684\u9875\uff0c\u5e76\u4e14autovacuum\u4ee3\u4ef7\u5ef6\u8fdf\u4e3a20\u6beb\u79d2\uff0c\u5219\u5b83\u53ef\u4ee5\u5728\u6bcf\u4e00\u8f6e\u4e2d\u8bfb\u53d6\uff1a((200/ vacuum_cost_page_hit)8)KB\uff0c\u8fd9\u9700\u8981\u7b49\u5f85autovacuum\u4ee3\u4ef7\u5ef6\u8fdf\u65f6\u95f4\u91cf\u3002</p> <p>\u56e0\u6b64\uff0c\u8003\u8651\u5230\u5757\u5927\u5c0f\u4e3a8192\u5b57\u8282\uff0cautovacuum\u6700\u591a\u53ef\u4ee5\u8bfb\u53d6\uff1a502008kb=78.13mb/s(\u5982\u679c\u5728\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u5df2\u7ecf\u627e\u5230\u5757)\u3002 \u5982\u679c\u5757\u4e0d\u5728\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\uff0c\u9700\u8981\u4ece\u78c1\u76d8\u63d0\u53d6\uff0c\u5219autovacuum\u53ef\u4ee5\u8bfb\u53d6\uff1a50(200/ vacuum_cost_page_miss)8)KB=7.81 MB/\u79d2\u3002</p> <p>\u4e3a\u4e86\u4ece\u9875/\u5757\u4e2d\u5220\u9664\u6b7b\u5143\u7ec4\uff0c\u5199\u64cd\u4f5c\u7684\u5f00\u9500\u662f\uff1avacuum_cost_page_dirty\uff0c\u9ed8\u8ba4\u8bbe\u7f6e\u4e3a20 \u4e00\u4e2aautovacuum\u6bcf\u79d2\u6700\u591a\u53ef\u4ee5\u5199/\u810f\uff1a50(200/ vacuum_cost_page_dirty)8)KB=3.9mb/\u79d2\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/autovacuum/#autovacuum_max_workers_1","title":"autovacuum_max_workers\u7684\u8c03\u6574","text":"<p>\u901a\u5e38\uff0cautovacuum_vacuum_cost_limit\u6210\u672c\u5e73\u5747\u5206\u914d\u7ed9\u5b9e\u4f8b\u4e2d\u8fd0\u884c\u7684\u6240\u6709autovacuum\u8fc7\u7a0b\u7684autovacuum_max_workers\u6570\u3002 \u56e0\u6b64\uff0c\u589e\u52a0autovacuum_max_workers\u53ef\u80fd\u4f1a\u5ef6\u8fdf\u5f53\u524d\u8fd0\u884c\u7684autovacuum workers\u7684autovacuum\u6267\u884c\u3002 \u800c\u589e\u52a0autovacuum_vacuum_cost_limit\u53ef\u80fd\u4f1a\u5bfc\u81f4IO\u74f6\u9888\u3002 \u53ef\u4ee5\u901a\u8fc7\u8bbe\u7f6e\u5355\u4e2a\u8868\u7684\u5b58\u50a8\u53c2\u6570\u6765\u91cd\u5199\u6b64\u884c\u4e3a\uff0c\u8fd9\u6837\u4f1a\u5ffd\u7565\u5168\u5c40\u8bbe\u7f6e\u3002</p> <p>\u539f\u6587\uff1ahttps://www.percona.com/blog/tuning-autovacuum-in-postgresql-and-autovacuum-internals/</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/clog%E4%BD%9C%E7%94%A8%E5%92%8C%E7%AE%A1%E7%90%86/","title":"clog\u4f5c\u7528\u548c\u7ba1\u7406","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/clog%E4%BD%9C%E7%94%A8%E5%92%8C%E7%AE%A1%E7%90%86/#clog","title":"CLOG\u6982\u8ff0","text":"<p>CLOG\u7528\u6765\u8bb0\u5f55\u4e8b\u52a1\u53f7\u7684\u72b6\u6001\uff0c\u4e3b\u8981\u662f\u7528\u6765\u5224\u65ad\u884c\u7684\u53ef\u89c1\u6027\u3002\u6bcf\u4e2a\u4e8b\u52a1\u72b6\u6001\u5360\u7528\u4e24\u4e2abit\u4f4d\u3002\u4e8b\u52a1\u7684\u72b6\u6001\u67094\u79cd\uff1aIN PROGRESS\uff0cCOMMITTED\uff0cABORTED\u548cSUB_COMMITTED\u3002CLOG\u7531\u4e00\u4e2a\u6216\u591a\u4e2a8KB\u9875\u7ec4\u6210\u3002CLOG\u5728\u903b\u8f91\u4e0a\u5f62\u6210\u4e00\u4e2a\u6570\u7ec4\uff0c\u6570\u7ec4\u7684\u6bcf\u4e2a\u5143\u7d20\u5bf9\u5e94\u4e8b\u52a1ID\u53f7\u548c\u4e8b\u52a1\u72b6\u6001\u3002</p> <p>\u4e00\u4e2a\u4e8b\u52a1\u5360\u75282\u4e2abit\u4f4d\uff0c\u4e00\u4e2a\u5b57\u8282\u53ef\u4ee5\u5b58\u653e4\u4e2a\u4e8b\u52a1\u72b6\u6001\uff0c\u4e00\u4e2a\u9875\u5757\u53ef\u4ee5\u5b58\u653e8192*4=32768\u4e2a\u4e8b\u52a1\u72b6\u6001\u3002</p> <p>\u5f53\u6570\u636e\u5e93\u5e93\u542f\u52a8\u65f6\uff0c\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u88ab\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u3002CLOG\u7684\u4fe1\u606f\u540c\u6837\u4f1a\u88ab\u8bb0\u5f55\u5230wal\u65e5\u5fd7\u4e2d\uff0c\u5f53\u6570\u636e\u5e93\u5f02\u5e38\u4e2d\u65ad\u65f6\uff0cCLOG\u7684\u4fe1\u606f\u4f1a\u4ecewal\u65e5\u5fd7\u8fd8\u539f\u3002</p> <p>CLOG\u5b58\u653e\u5728\u7f13\u5b58\u4e2d\uff0c\u5f53checkpoint\u65f6\u5f00\u59cb\u5237\u65b0\u5230CLOG\u6587\u4ef6\u4e2d\u3002\u5f53\u6570\u636e\u5e93\u5e93\u5173\u95ed\u5e93\u540e\uff0cCLOG\u4f1a\u88ab\u5199\u5165\u5230$PGDATA/pg_xact\u5b50\u76ee\u5f55\u4e2d\uff0c\u6587\u4ef6\u547d\u540d\u4e3a0000,0001,00002......\uff0c\u5355\u4e2a\u6587\u4ef6\u6700\u5927\u4e3a256K\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/clog%E4%BD%9C%E7%94%A8%E5%92%8C%E7%AE%A1%E7%90%86/#clog_1","title":"CLOG\u5de5\u4f5c\u65b9\u5f0f","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/clog%E4%BD%9C%E7%94%A8%E5%92%8C%E7%AE%A1%E7%90%86/#clog_2","title":"CLOG\u5982\u4f55\u7ef4\u62a4","text":"<ol> <li>\u6570\u636e\u5e93\u6b63\u5e38\u5173\u95ed\u6216\u8005\u68c0\u67e5\u70b9\u53d1\u751f\u65f6\uff0cclog\u6570\u636e\u5199\u5165pg_xact\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u4e2d</li> <li>\u547d\u540d\u4e60\u60ef\uff1a0000 0001 \u2026\u2026</li> <li>\u6570\u636e\u5e93\u542f\u52a8\u65f6\u4ecepg_xact\u6587\u4ef6\u4e2d\u52a0\u8f7d\u6570\u636e</li> <li>\u7531Vacuum\u8fdb\u7a0b\u5b9a\u671f\u5904\u7406</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/clog%E4%BD%9C%E7%94%A8%E5%92%8C%E7%AE%A1%E7%90%86/#clog_3","title":"\u8ba1\u7b97\u5f53\u524d\u4f7f\u7528\u7684CLOG\u6570\u636e\u5757\u4f4d\u7f6e","text":"<p>\u4e00\u4e2a\u4e8b\u52a1\u5360\u75282\u4e2abit\u4f4d\uff0c\u4e00\u4e2a\u5b57\u8282\u53ef\u4ee5\u5b58\u653e4\u4e2a\u4e8b\u52a1\u72b6\u6001\uff0c\u4e00\u4e2a\u9875\u5757\u53ef\u4ee5\u5b58\u653e8192*4=32768\u4e2a\u4e8b\u52a1\u72b6\u6001\u3002</p> <p>\u67e5\u770b\u5f53\u524d\u7684TXID\u53f7</p> <pre><code>postgres=# SELECT txid_current();\n txid_current \n--------------\n       448854\n(1 row)\n</code></pre> <p>2\u3001\u8ba1\u7b97\u8bb0\u5f55\u5728\u54ea\u4e2aCLOG\u5757\u4e2d</p> <pre><code>postgres=# select 448854/(8192*4) block;\n block \n-------\n    13\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/clog%E4%BD%9C%E7%94%A8%E5%92%8C%E7%AE%A1%E7%90%86/#clog_4","title":"\u5220\u9664\u4e0d\u9700\u8981\u7684CLOG\u6587\u4ef6","text":"<p>\u5f53\u53d1\u751f\u6025\u6027\u51bb\u7ed3\u65f6\u4f1a\u66f4\u65b0pg_database.datfrozenxid\u7684\u503c\uff0c\u6b64\u65f6\uff0c\u5982\u679c\u67d0\u4e9bCLOG\u6587\u4ef6\u4e0d\u5305\u542b\u5305\u542b\u6700\u5c0fpg_database.datfrozenxid\u4ee5\u53ca\u4e4b\u524d\u7684\u4fe1\u606f\uff0c\u4f1a\u5c1d\u8bd5\u5220\u9664\u4e0d\u5fc5\u8981\u7684clog\u6587\u4ef6\u3002\u56e0\u4e3a\u8fd9\u4e9bCLOG\u6587\u4ef6\u4e2d\u8bb0\u5f55\u7684\u4e8b\u52a1\u6240\u4fee\u6539\u7684\u884c\u5df2\u7ecf\u88ab\u51bb\u7ed3\uff0c\u90a3\u4e48\u5728\u8fdb\u884c\u884c\u53ef\u89c1\u6027\u89c4\u5219\u5224\u65ad\u65f6\u5c31\u4e0d\u9700\u8981\u83b7\u5f97\u8be5\u4e8b\u52a1\u7684\u72b6\u6001\u3002</p> <p></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/","title":"pg_control","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#1","title":"1. \u6587\u4ef6\u4f4d\u7f6e","text":"<p>pg_control\u6587\u4ef6\u4f4d\u4e8e<code>$PGDATA/global/</code>\u76ee\u5f55\u4e0b\uff0cpg_control\u6587\u4ef6\u7269\u7406\u5927\u5c0f\u662f8K\uff0c\u5176\u5185\u5bb9\u5c3d\u91cf\u4fdd\u6301\u5c0f\u4e8e512\u5b57\u8282\u3002</p> <pre><code>$ ls -l $PGDATA/global/pg_control\n-rw------- 1 postgres postgres 8192 Apr 24 22:55 /opt/software/postgresql/12.13/data/global/pg_control\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#2","title":"2. \u6587\u4ef6\u5185\u5bb9","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#1-initdb","title":"1. initdb\u65f6\u751f\u6210\u7684\u9759\u6001\u4fe1\u606f","text":"<pre><code>pg_control version number:            1201\nCatalog version number:               201909212\nDatabase system identifier:           7225634509658546764\nMaximum data alignment:               8\nDatabase block size:                  8192\nBlocks per segment of large relation: 131072\nWAL block size:                       8192\nBytes per WAL segment:                16777216\nMaximum length of identifiers:        64\nMaximum columns in an index:          32\nMaximum size of a TOAST chunk:        1996\nSize of a large-object chunk:         2048\nDate/time type storage:               64-bit integers\nFloat4 argument passing:              by value\nFloat8 argument passing:              by value\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#2-postgresqlconf","title":"2. <code>postgresql.conf</code>\u6587\u4ef6\u4e2d\u7684\u4fe1\u606f","text":"<pre><code>wal_level setting:                    replica\nwal_log_hints setting:                off\nmax_connections setting:              100\nmax_worker_processes setting:         8\nmax_wal_senders setting:              10\nmax_prepared_xacts setting:           0\nmax_locks_per_xact setting:           64\ntrack_commit_timestamp setting:       off\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#3-walcheckpoint","title":"3. WAL\u53cacheckpoint\u7684\u52a8\u6001\u4fe1\u606f","text":"<pre><code>Latest checkpoint location:           0/15CD000\nLatest checkpoint's REDO location:    0/15CD000\nLatest checkpoint's REDO WAL file:    000000010000000000000001\nLatest checkpoint's TimeLineID:       1\nLatest checkpoint's PrevTimeLineID:   1\nLatest checkpoint's full_page_writes: on\nLatest checkpoint's NextXID:          0:486\nLatest checkpoint's NextOID:          12676\nLatest checkpoint's NextMultiXactId:  1\nLatest checkpoint's NextMultiOffset:  0\nLatest checkpoint's oldestXID:        479\nLatest checkpoint's oldestXID's DB:   1\nLatest checkpoint's oldestActiveXID:  0\nLatest checkpoint's oldestMultiXid:   1\nLatest checkpoint's oldestMulti's DB: 1\nLatest checkpoint's oldestCommitTsXid:0\nLatest checkpoint's newestCommitTsXid:0\nTime of latest checkpoint:            Mon 24 Apr 2023 11:12:14 PM CST\nFake LSN counter for unlogged rels:   0/3E8\nMinimum recovery ending location:     0/0\nMin recovery ending loc's timeline:   0\nBackup start location:                0/0\nBackup end location:                  0/0\nEnd-of-backup record required:        no\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#3-pg_control","title":"3. pg_control\u7684\u7ef4\u62a4","text":"<ol> <li>\u56fa\u5b9a\u90e8\u5206\uff1a\u521d\u59cb\u5316\u6570\u636e\u5e93\u65f6\u4ea7\u751f\uff0c\u56fa\u5b9a\u4e0d\u53d8</li> <li>\u968f\u65f6\u66f4\u65b0\u7684\u4fe1\u606f\uff1a\u53d1\u751f\u68c0\u67e5\u70b9\u3001\u5907\u4efd\u3001\u65e5\u5fd7\u5207\u6362\u7b49\u64cd\u4f5c\u81ea\u52a8\u66f4\u65b0</li> <li>postgresql.conf\u76f8\u5173\u53c2\u6570\u88ab\u66f4\u65b0\uff0c\u4e5f\u4f1a\u81ea\u52a8\u66f4\u65b0</li> <li>\u6570\u636e\u5e93\u5907\u4efd\u65f6\u4f1a\u4e00\u8d77\u5907\u4efd</li> <li>\u4e0d\u80fd\u624b\u52a8\u4fee\u6539\u8be5\u6587\u4ef6</li> <li>\u542f\u52a8\u548c\u6062\u590d\u6570\u636e\u5e93\u65f6\u9700\u8981\u6b64\u6587\u4ef6</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#4-pg_control","title":"4. pg_control\u91cd\u5efa","text":"<p>\u4f7f\u7528pg_resetwal\u547d\u4ee4\u8fdb\u884c\u91cd\u5efa\uff0c\u9700\u8981\u4f7f\u7528\u4e0b\u97624\u4e2a\u53c2\u6570</p> <pre><code>-l     set minimum starting location for new WAL\n-m     set next and oldest multitransaction ID\n-O     set next multitransaction offset\n-x     set next transaction ID\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#1-l","title":"1.  -l\u53c2\u6570","text":"<p>\u627e\u5230pg_wal\u4e0b\u6700\u5927\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u7f16\u53f7\u52a01\uff0c\u786e\u5b9a<code>-l</code>\u7684\u53c2\u6570\u4e3a0000000400000000000000D2</p> <pre><code>$ ls -rt1 $PGDATA/pg_wal/ | grep -v archive_status | tail\n0000000400000000000000F0\n000000040000000100000009\n00000004000000010000000B\n000000040000000100000007\n00000004000000010000000C\n00000004000000010000000D\n00000004000000010000000E\n0000000400000000000000CF\n0000000400000000000000D0\n0000000400000000000000D1\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#2-o","title":"2.-O\u53c2\u6570","text":"<p>\u5728pg_multixact/members\u76ee\u5f55\u4e0b\u53d6\u6700\u5927\u503c\u52a01\u4e58\u4ee565535\u540e\u8f6c\u6362\u4e3a16\u8fdb\u5236\uff0c\u7136\u540e\u672b\u5c3e\u6dfb\u52a04\u4e2a0</p> <pre><code>$ ls $PGDATA/pg_multixact/members/\n0000\n</code></pre> <p>\u5f97\u5230-O\u7684\u503c\u4e3a0x1000000000</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#3-m","title":"3.-m\u53c2\u6570","text":"<p>\u5728pg_multixact/offsets\u76ee\u5f55\u4e0b\u627e\u5230\u6700\u5927\u7684\u6587\u4ef6\u7f16\u53f7\u52a01\uff0c\u540e\u9762\u8ddf\u4e0a4\u4e2a0</p> <pre><code>$ ls $PGDATA/pg_multixact/offsets\n0000\n</code></pre> <p>\u5f97\u5230-m\u7684\u503c\u4e3a0x00010000,0x00010000</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#4-x","title":"4.-x\u53c2\u6570","text":"<p>\u5728pg_xact\u4e0b\u9762\uff0c\u627e\u5230\u6700\u5927\u7684\u6587\u4ef6\u7f16\u53f7\u52a01\uff0c\u540e\u9762\u8ddf\u4e0a5\u4e2a0</p> <pre><code>$ ls $PGDATA/pg_xact\n0000\n</code></pre> <p>\u5f97\u5230-x\u7684\u503c\u4e3a0x000100000</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/pg_control/#5","title":"5.\u6267\u884c","text":"<p>\u6267\u884c\u91cd\u5efapg_control\u6587\u4ef6\u8bed\u53e5</p> <pre><code>$ touch $PGDATA/global/pg_control\n$ pg_resetwal -f $PGDATA -x 0x000100000 -m 0x00010000,0x00010000 -O 0x1000000000 -l 0000000400000000000000D2\nWrite-ahead log reset\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/","title":"vacuum","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/#vacuum","title":"vacuum\u4f5c\u7528","text":"<ol> <li>\u79fb\u9664\u6b7b\u5143\u7ec4\u3002</li> <li>\u79fb\u9664\u6bcf\u4e00\u9875\u4e2d\u7684\u6b7b\u5143\u7ec4\uff0c\u5e76\u5bf9\u6bcf\u4e00\u9875\u5185\u7684\u6d3b\u5143\u7ec4\u8fdb\u884c\u788e\u7247\u6574\u7406\u3002</li> <li>\u79fb\u9664\u6307\u5411\u6b7b\u5143\u7ec4\u7684\u7d22\u5f15\u5143\u7ec4\u3002</li> <li>\u51bb\u7ed3\u65e7\u7684\u4e8b\u52a1\u6807\u8bc6\u3002</li> <li>\u5fc5\u8981\u65f6\u51bb\u7ed3\u65e7\u5143\u7ec4\u7684\u4e8b\u52a1\u6807\u8bc6\u3002</li> <li>\u66f4\u65b0\u4e0e\u51bb\u7ed3\u4e8b\u52a1\u6807\u8bc6\u76f8\u5173\u7684\u7cfb\u7edf\u89c6\u56fe\uff08pg_database\u4e0epg_class\uff09\u3002</li> <li>\u5982\u679c\u53ef\u80fd\uff0c\u79fb\u9664\u4e0d\u5fc5\u8981\u7684\u63d0\u4ea4\u65e5\u5fd7\u6587\u4ef6\u3002</li> <li>\u5176\u4ed6\u3002</li> <li>\u66f4\u65b0\u5df2\u5904\u7406\u8868\u7684\u7a7a\u95f2\u7a7a\u95f4\u6620\u5c04\uff08FSM\uff09\u548c\u53ef\u89c1\u6027\u6620\u5c04\uff08VM\uff09\u3002</li> <li>\u66f4\u65b0\u4e00\u4e9b\u7edf\u8ba1\u4fe1\u606f\uff08pg_stat_all_tables\u7b49\uff09\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/#vacuum_1","title":"vacuum\u5904\u7406\u6d41\u7a0b","text":"<ol> <li>\u4ece\u6307\u5b9a\u7684\u8868\u96c6\u4e2d\u4f9d\u6b21\u5904\u7406\u6bcf\u4e00\u5f20\u8868\u3002</li> <li>\u83b7\u53d6\u8868\u4e0a\u7684ShareUpdateExclusiveLock\u9501\uff0c\u6b64\u9501\u5141\u8bb8\u5176\u4ed6\u4e8b\u52a1\u5bf9\u8be5\u8868\u8fdb\u884c\u8bfb\u53d6\u3002</li> <li>\u626b\u63cf\u8868\u4e2d\u6240\u6709\u7684\u9875\u9762\uff0c\u4ee5\u83b7\u53d6\u6240\u6709\u7684\u6b7b\u5143\u7ec4\uff0c\u5e76\u5728\u5fc5\u8981\u65f6\u51bb\u7ed3\u65e7\u5143\u7ec4\u3002</li> <li>\u5220\u9664\u6307\u5411\u76f8\u5e94\u6b7b\u5143\u7ec4\u7684\u7d22\u5f15\u5143\u7ec4\uff08\u5982\u679c\u5b58\u5728\uff09\u3002</li> <li>\u5bf9\u8868\u7684\u6bcf\u4e2a\u9875\u9762\u6267\u884c\u6b65\u9aa4\uff086\uff09\u548c\uff087\uff09\u4e2d\u7684\u64cd\u4f5c\u3002</li> <li>\u79fb\u9664\u6b7b\u5143\u7ec4\uff0c\u5e76\u91cd\u65b0\u5206\u914d\u9875\u9762\u4e2d\u7684\u6d3b\u5143\u7ec4\u3002</li> <li>\u66f4\u65b0\u76ee\u6807\u8868\u5bf9\u5e94\u7684FSM\u4e0eVM\u3002</li> <li>\u5982\u679c\u6700\u540e\u4e00\u4e2a\u9875\u9762\u6ca1\u6709\u4efb\u4f55\u5143\u7ec4\uff0c\u5219\u622a\u65ad\u6700\u540e\u4e00\u9875\u3002</li> <li>\u66f4\u65b0\u4e0e\u76ee\u6807\u8868\u6e05\u7406\u8fc7\u7a0b\u76f8\u5173\u7684\u7edf\u8ba1\u6570\u636e\u548c\u7cfb\u7edf\u89c6\u56fe\u3002</li> <li>\u66f4\u65b0\u4e0e\u6e05\u7406\u8fc7\u7a0b\u76f8\u5173\u7684\u7edf\u8ba1\u6570\u636e\u548c\u7cfb\u7edf\u89c6\u56fe\u3002</li> <li>\u5982\u679c\u53ef\u80fd\uff0c\u79fb\u9664CLOG\u4e2d\u975e\u5fc5\u8981\u7684\u6587\u4ef6\u4e0e\u9875\u9762\u3002</li> </ol> <p>\u79fb\u9664\u6b7b\u5143\u7ec4\uff0c\u5e76\u9010\u9875\u66f4\u65b0FSM\u548cVM\u793a\u610f\u56fe\uff1a </p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/#_1","title":"\u53ef\u89c1\u6027\u5730\u56fe","text":"<p>\u6bcf\u4e2a\u8868\u90fd\u62e5\u6709\u5404\u81ea\u7684\u53ef\u89c1\u6027\u6620\u5c04\uff0c\u7528\u4e8e\u4fdd\u5b58\u8868\u6587\u4ef6\u4e2d\u6bcf\u4e2a\u9875\u9762\u7684\u53ef\u89c1\u6027\u3002\u9875\u9762\u7684\u53ef\u89c1\u6027\u786e\u5b9a\u4e86\u6bcf\u4e2a\u9875\u9762\u662f\u5426\u5305\u542b\u6b7b\u5143\u7ec4\u3002\u6e05\u7406\u8fc7\u7a0b\u53ef\u4ee5\u8df3\u8fc7\u6ca1\u6709\u6b7b\u5143\u7ec4\u7684\u9875\u9762\u3002</p> <p></p> <p>\u5047\u8bbe\u8be5\u8868\u5305\u542b\u4e09\u4e2a\u9875\u9762\uff0c\u7b2c0\u9875\u548c\u7b2c2\u9875\u5305\u542b\u6b7b\u5143\u7ec4\uff0c\u800c\u7b2c1\u9875\u4e0d\u5305\u542b\u6b7b\u5143\u7ec4\u3002\u8868\u7684\u53ef\u89c1\u6027\u6620\u5c04\u4e2d\u4fdd\u5b58\u7740\u90a3\u4e9b\u9875\u9762\u5305\u542b\u6b7b\u5143\u7ec4\u7684\u4fe1\u606f\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u6e05\u7406\u8fc7\u7a0b\u53ef\u4ee5\u53c2\u8003VM\u4e2d\u7684\u4fe1\u606f\uff0c\u8df3\u8fc7\u7b2c\u4e00\u4e2a\u9875\u9762\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/#clog","title":"\u5220\u9664\u4e0d\u9700\u8981\u7684clog","text":"<p>CLOG\u5b58\u50a8\u7740\u4e8b\u52a1\u7684\u72b6\u6001\u3002\u5f53\u66f4\u65b0pg_database.datfro zenxid\u65f6\uff0cPostgreSQL\u4f1a\u5c1d\u8bd5\u5220\u9664\u4e0d\u5fc5\u8981\u7684CLOG\u6587\u4ef6\uff0c\u76f8\u5e94\u7684CLOG\u9875\u9762\u4e5f\u4f1a\u88ab\u5220\u9664\u3002 \u5982\u679cCLOG\u6587\u4ef60002\u4e2d\u5305\u542b\u6700\u5c0f\u7684pg_database.datfro zenxid\uff0c\u5219\u53ef\u4ee5\u5220\u9664\u65e7\u6587\u4ef6\uff080000\u548c0001\uff09\uff0c\u56e0\u4e3a\u5b58\u50a8\u5728\u8fd9\u4e9b\u6587\u4ef6\u4e2d\u7684\u6240\u6709\u4e8b\u52a1\u5728\u6574\u4e2a\u6570\u636e\u5e93\u96c6\u7c07\u4e2d\u5df2\u7ecf\u88ab\u89c6\u4e3a\u51bb\u7ed3\u4e86\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/#autovacuum","title":"autovacuum","text":"<p>\u9ed8\u8ba4\u6bcf\u5206\u949f\u6267\u884c\u4e00\u6b21\uff0c\u7531autovacuum_naptime\u53c2\u6570\u5b9a\u4e49\u3002 \u9ed8\u8ba4\u8c03\u7528\u4e09\u4e2aworker\u8fdb\u7a0b\u8fdb\u884c\u5de5\u4f5c\uff0c\u7531autovacuum_max_workers\u53c2\u6570\u5b9a\u4e49</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/vacuum/#full-vacuum","title":"full vacuum","text":"<p>\u4e00\u4e2a\u8868\u7531\u4e09\u4e2a\u9875\u9762\u7ec4\u6210\uff0c\u6bcf\u4e2a\u9875\u9762\u5305\u542b6\u6761\u5143\u7ec4\u3002\u6267\u884c\u4ee5\u4e0bDELETE\u547d\u4ee4\u4ee5\u5220\u9664\u5143\u7ec4\uff0c\u5e76\u6267\u884cVACUUM\u547d\u4ee4\u4ee5\u79fb\u9664\u6b7b\u5143\u7ec4,\u6b7b\u5143\u7ec4\u867d\u7136\u90fd\u88ab\u79fb\u9664\u4e86\uff0c\u4f46\u8868\u7684\u5c3a\u5bf8\u6ca1\u6709\u51cf\u5c0f\u3002\u8fd9\u79cd\u60c5\u51b5\u65e2\u6d6a\u8d39\u4e86\u78c1\u76d8\u7a7a\u95f4\uff0c\u53c8\u4f1a\u5bf9\u6570\u636e\u5e93\u6027\u80fd\u4ea7\u751f\u8d1f\u9762\u5f71\u54cd\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u79cd\u95ee\u9898\uff0cPostgreSQL\u63d0\u4f9b\u4e86full vacuum\u3002</p> <p></p> <p>FULL VACUUM\u8fc7\u7a0b 1. \u521b\u5efa\u65b0\u7684\u8868\u6587\u4ef6\uff1a\u5f53\u5bf9\u8868\u6267\u884cVACUUM FULL\u547d\u4ee4\u65f6\uff0cPostgreSQL\u9996\u5148\u83b7\u53d6\u8868\u4e0a\u7684AccessExclusiveLock\u9501\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u5927\u5c0f\u4e3a8KB\u7684\u65b0\u7684\u8868\u6587\u4ef6\u3002AccessExclusiveLock \u9501\u4e0d\u5141\u8bb8\u5176\u4ed6\u7684\u4efb\u4f55\u8bbf\u95ee\u3002 2. \u5c06\u6d3b\u5143\u7ec4\u590d\u5236\u5230\u65b0\u8868\uff1aPostgreSQL\u53ea\u5c06\u65e7\u8868\u6587\u4ef6\u4e2d\u7684\u6d3b\u5143\u7ec4\u590d\u5236\u5230\u65b0\u8868\u4e2d\u3002 3.\u5220\u9664\u65e7\u6587\u4ef6\uff0c\u91cd\u5efa\u7d22\u5f15\u5e76\u66f4\u65b0\u7edf\u8ba1\u4fe1\u606fFSM\u548cVM\uff1a\u590d\u5236\u5b8c\u6240\u6709\u6d3b\u5143\u7ec4\u540e\uff0cPostgreSQL\u5c06\u5220\u9664\u65e7\u6587\u4ef6\uff0c\u91cd\u5efa\u6240\u6709\u76f8\u5173\u7684\u8868\u7d22\u5f15\uff0c\u66f4\u65b0\u8868\u7684FSM\u548cVM\uff0c\u5e76\u66f4\u65b0\u76f8\u5173\u7684\u7edf\u8ba1\u4fe1\u606f\u548c\u7cfb\u7edf\u89c6\u56fe\u3002</p> <p>\u6267\u884cfull vacuum\u7684\u65f6\u673a</p> <pre><code>postgres=# create table accounts (aid int, info text,   c_time timestamp);\nCREATE TABLE\npostgres=# insert into accounts select generate_series(1,100000), md5(random()::text),clock_timestamp();\nINSERT 0 100000\npostgres=# SELECT count(*) as \"number of pages\",\npostgres-#        pg_size_pretty(cast(avg(avail) as bigint)) as \"Av. freespace size\",\npostgres-#        round(100 * avg(avail)/8192 ,2) as \"Av. freespace ratio\"\npostgres-#        FROM pg_freespace('accounts');\n number of pages | Av. freespace size | Av. freespace ratio \n-----------------+--------------------+---------------------\n             935 | 32 bytes           |                0.39\n(1 row)\n\npostgres=# DELETE FROM accounts WHERE aid %10 != 0 OR aid &lt; 100;\nDELETE 90009\npostgres=# VACUUM accounts;\nVACUUM\npostgres=# SELECT count(*) as \"number of pages\",\npostgres-#        pg_size_pretty(cast(avg(avail) as bigint)) as \"Av. freespace size\",\npostgres-#        round(100 * avg(avail)/8192 ,2) as \"Av. freespace ratio\"\npostgres-#        FROM pg_freespace('accounts');\n number of pages | Av. freespace size | Av. freespace ratio \n-----------------+--------------------+---------------------\n             935 | 6964 bytes         |               85.01\n(1 row)\n\npostgres=# SELECT *, round(100 * avail/8192 ,2) as \"freespace ratio\"\npostgres-#                 FROM pg_freespace('accounts');\n blkno | avail | freespace ratio \n-------+-------+-----------------\n     0 |  7648 |           93.00\n     1 |  6944 |           84.00\n     2 |  6944 |           84.00\n     3 |  7008 |           85.00\n     4 |  6944 |           84.00\n     5 |  6944 |           84.00\n     ...\npostgres=# VACUUM FULL accounts;\nVACUUM\npostgres=# SELECT count(*) as \"number of blocks\",\npostgres-#        pg_size_pretty(cast(avg(avail) as bigint)) as \"Av. freespace size\",\npostgres-#        round(100 * avg(avail)/8192 ,2) as \"Av. freespace ratio\"\npostgres-#        FROM pg_freespace('accounts');\n number of blocks | Av. freespace size | Av. freespace ratio \n------------------+--------------------+---------------------\n               94 | 0 bytes            |                0.00\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/","title":"\u4e8b\u52a1\u4e0e\u9694\u79bb\u7ea7\u522b","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#acid","title":"ACID\u6982\u8ff0","text":"<p>ACID\u56db\u5927\u7279\u6027\uff1a 1. Atomicity(\u539f\u5b50\u6027)\uff1a\u4e00\u4e2a\u4e8b\u52a1(transaction)\u4e2d\u7684\u6240\u6709\u64cd\u4f5c\uff0c\u8981\u4e48\u5168\u90e8\u5b8c\u6210\uff0c\u8981\u4e48\u5168\u90e8\u4e0d\u5b8c\u6210\uff0c\u4e0d\u4f1a\u7ed3\u675f\u5728\u4e2d\u95f4\u67d0\u4e2a\u73af\u8282\u3002 2. Consistency(\u4e00\u81f4\u6027)\uff1a\u5728\u4e8b\u52a1\u5f00\u59cb\u4e4b\u524d\u548c\u4e8b\u52a1\u7ed3\u675f\u4ee5\u540e\uff0c\u6570\u636e\u5e93\u7684\u5b8c\u6574\u6027\u6ca1\u6709\u88ab\u7834\u574f\u3002\u8fd9\u8868\u793a\u5199\u5165\u7684\u6570\u636e\u5fc5\u987b\u5b8c\u5168\u7b26\u5408\u6240\u6709\u7684\u9884\u8bbe\u89c4\u5219\uff0c\u8fd9\u5305\u542b\u6570\u636e\u7684\u7cbe\u786e\u5ea6\u3001\u4e32\u8054\u6027\u4ee5\u53ca\u540e\u7eed\u6570\u636e\u5e93\u53ef\u4ee5\u81ea\u53d1\u6027\u5730\u5b8c\u6210\u9884\u5b9a\u7684\u5de5\u4f5c\u3002 3. Isolation(\u9694\u79bb\u6027)\uff1a\u6570\u636e\u5e93\u5141\u8bb8\u591a\u4e2a\u5e76\u53d1\u4e8b\u52a1\u540c\u65f6\u5bf9\u5176\u6570\u636e\u8fdb\u884c\u8bfb\u5199\u548c\u4fee\u6539\u7684\u80fd\u529b\uff0c\u9694\u79bb\u6027\u53ef\u4ee5\u9632\u6b62\u591a\u4e2a\u4e8b\u52a1\u5e76\u53d1\u6267\u884c\u65f6\u7531\u4e8e\u4ea4\u53c9\u6267\u884c\u800c\u5bfc\u81f4\u6570\u636e\u7684\u4e0d\u4e00\u81f4\u3002 3. Durability(\u6301\u4e45\u6027)\uff1a\u4e8b\u52a1\u5904\u7406\u7ed3\u675f\u540e\uff0c\u5bf9\u6570\u636e\u7684\u4fee\u6539\u5c31\u662f\u6c38\u4e45\u7684\uff0c\u5373\u4fbf\u7cfb\u7edf\u6545\u969c\u4e5f\u4e0d\u4f1a\u4e22\u5931\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#postgresql","title":"PostgreSQL\u652f\u6301\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b","text":"Isolation Level Dirty Reads Non-repeatable Read Phantom Read Serialization Anomaly READ COMMITTED Not possible Possible Possible Possible REPEATABLE READ Not possible Not possible Not possible Possible SERIALIZABLE Not possible Not possible Not possible Not possible"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#mvcc","title":"MVCC\u6982\u8ff0","text":"<p>\u5e76\u53d1\u63a7\u5236\u662f\u4e00\u79cd\u5728\u6570\u636e\u5e93\u4e2d\u5e76\u53d1\u8fd0\u884c\u591a\u4e2a\u4e8b\u52a1\u65f6\u4fdd\u6301\u4e00\u81f4\u6027\u548c\u9694\u79bb\u6027\u7684\u673a\u5236\uff0c\u8fd9\u662fACID\u7684\u4e24\u4e2a\u5c5e\u6027\u3002</p> <p>\u5e76\u53d1\u63a7\u5236\u6280\u672f: - \u591a\u7248\u672c\u5e76\u53d1\u63a7\u5236(MVCC) - \u4e25\u683c\u7684\u4e24\u9636\u6bb5\u9501(S2PL) - \u4e50\u89c2\u5e76\u53d1\u63a7\u5236(OCC)</p> <p>\u5728MVCC\u4e2d\uff0c\u6bcf\u6b21\u5199\u64cd\u4f5c\u90fd\u4f1a\u521b\u5efa\u6570\u636e\u9879\u7684\u65b0\u7248\u672c\uff0c\u540c\u65f6\u4fdd\u7559\u65e7\u7248\u672c\u3002\u5f53\u4e8b\u52a1\u8bfb\u53d6\u4e00\u4e2a\u6570\u636e\u9879\u65f6\uff0c\u7cfb\u7edf\u4f1a\u9009\u62e9\u5176\u4e2d\u4e00\u4e2a\u7248\u672c\u4ee5\u786e\u4fdd\u5355\u4e2a\u4e8b\u52a1\u7684\u9694\u79bb\u3002MVCC\u7684\u4e3b\u8981\u4f18\u70b9\u662f\u201c\u8bfb\u4e0d\u963b\u6b62\u5199\uff0c\u5199\u4e0d\u963b\u6b62\u8bfb\u201d\uff0c\u76f8\u53cd\uff0c\u4f8b\u5982\uff0c\u57fa\u4e8eS2PL\u7684\u7cfb\u7edf\u5fc5\u987b\u5728\u5199\u5361\u5668\u5199\u5165\u9879\u65f6\u963b\u6b62\u8bfb\u5361\u5668\uff0c\u56e0\u4e3a\u5199\u5361\u5668\u83b7\u53d6\u9879\u7684\u72ec\u5360\u9501\u3002PostgreSQL\u548c\u4e00\u4e9brdbms\u4f7f\u7528MVCC\u7684\u4e00\u4e2a\u53d8\u4f53\uff0c\u79f0\u4e3a\u5feb\u7167\u9694\u79bb(Snapshot Isolation\uff0cSI)\u3002</p> <p>\u4e00\u4e9b\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff08\u4f8b\u5982Oracle\uff09\u4f7f\u7528\u56de\u6eda\u6bb5\u6765\u5b9e\u73b0\u5feb\u7167\u9694\u79bbSI\u3002\u5f53\u5199\u5165\u65b0\u6570\u636e\u5bf9\u8c61\u65f6\uff0c\u65e7\u7248\u672c\u5bf9\u8c61\u5148\u88ab\u5199\u5165\u56de\u6eda\u6bb5\uff0c\u968f\u540e\u7528\u65b0\u5bf9\u8c61\u8986\u5199\u81f3\u6570\u636e\u533a\u57df\u3002PostgreSQL\u4f7f\u7528\u66f4\u7b80\u5355\u7684\u65b9\u6cd5\uff0c\u5373\u65b0\u6570\u636e\u5bf9\u8c61\u88ab\u76f4\u63a5\u63d2\u5165\u76f8\u5173\u8868\u9875\u4e2d\u3002\u8bfb\u53d6\u5bf9\u8c61\u65f6\uff0cPostgreSQL\u6839\u636e\u53ef\u89c1\u6027\u68c0\u67e5\u89c4\u5219\uff0c\u4e3a\u6bcf\u4e2a\u4e8b\u52a1\u9009\u62e9\u5408\u9002\u7684\u5bf9\u8c61\u7248\u672c\u4f5c\u4e3a\u54cd\u5e94\u3002 SI\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u5728ANSI SQL-92\u6807\u51c6\u4e2d\u5b9a\u4e49\u7684\u4e09\u79cd\u5f02\u5e38\uff0c\u5206\u522b\u662f\u810f\u8bfb\u3001\u4e0d\u53ef\u91cd\u590d\u8bfb\u548c\u5e7b\u8bfb\u3002\u4f46SI\u65e0\u6cd5\u5b9e\u73b0\u771f\u6b63\u7684\u53ef\u4e32\u884c\u5316\uff0c\u56e0\u4e3a\u5728SI\u4e2d\u53ef\u80fd\u4f1a\u51fa\u73b0\u4e32\u884c\u5316\u5f02\u5e38\uff0c\u4f8b\u5982\u5199\u504f\u5dee\u548c\u53ea\u8bfb\u4e8b\u52a1\u504f\u5dee\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0cANSI SQL-92\u6807\u51c6\u4e2d\u53ef\u4e32\u884c\u5316\u7684\u5b9a\u4e49\u4e0e\u73b0\u4ee3\u7406\u8bba\u4e2d\u7684\u5b9a\u4e49\u5e76\u4e0d\u76f8\u540c\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cPostgreSQL \u4ece9.1\u7248\u672c\u4e4b\u540e\u6dfb\u52a0\u4e86\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\uff08Serializable Snapshot Isolation,SSI\uff09,SSI\u53ef\u4ee5\u68c0\u6d4b\u4e32\u884c\u5316\u5f02\u5e38\uff0c\u5e76\u89e3\u51b3\u8fd9\u79cd\u5f02\u5e38\u5bfc\u81f4\u7684\u51b2\u7a81\u3002\u56e0\u6b64\uff0c9.1\u7248\u672c\u4e4b\u540e\u7684PostgreSQL\u63d0\u4f9b\u4e86\u771f\u6b63\u7684SERIALIZABLE\u9694\u79bb\u7b49\u7ea7\uff08SQL Server\u4e5f\u4f7f\u7528SSI\uff0c\u800cOracle\u4ecd\u7136\u4f7f\u7528SI\uff09\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#_1","title":"\u4e8b\u52a1\u72b6\u6001","text":"<p>\u56db\u79cd\u4e8b\u52a1\u72b6\u6001: - IN_PROGRESS - COMMITTED - ABORTED - SUB_COMMITTED</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#commit-log","title":"Commit Log","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#clog","title":"Clog \u5de5\u4f5c\u539f\u7406","text":"<p>CLOG\u5728\u903b\u8f91\u4e0a\u662f\u4e00\u4e2a\u6570\u7ec4\uff0c\u7531\u5171\u4eab\u5185\u5b58\u4e2d\u4e00\u7cfb\u52178KB\u9875\u9762\u7ec4\u6210\u3002\u6570\u7ec4\u7684\u5e8f\u53f7\u7d22\u5f15\u5bf9\u5e94\u7740\u76f8\u5e94\u4e8b\u52a1\u7684\u6807\u8bc6\uff0c\u5176\u5185\u5bb9\u5219\u662f\u76f8\u5e94\u4e8b\u52a1\u7684\u72b6\u6001\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#_2","title":"\u4e8b\u52a1\u5feb\u7167","text":"<p>\u5185\u7f6e\u51fd\u6570txid_current_snapshot\u53ca\u5176\u6587\u672c\u8868\u793a\u683c\u5f0f</p> <pre><code>testdb=# SELECT txid_current_snapshot();\ntxid_current_snapshot\n-----------------------\n100:104:100,102\n(1 row)\n</code></pre> <p>txid_current_snapshot\u7684\u6587\u672c\u8868\u793a\u4e3a\"xmin:xmax:xip_list\"\uff0c\u542b\u4e49\u5982\u4e0b Xmin\uff1a\u6700\u65e9\u4ecd\u5728\u6d3b\u52a8\u7684txid\u3002\u6240\u6709\u4ee5\u524d\u7684\u4e8b\u52a1\u8981\u4e48\u63d0\u4ea4\u5e76\u53ef\u89c1\uff0c\u8981\u4e48\u56de\u6eda\u5e76\u505c\u6b62\u3002 Xmax\uff1a\u7b2c\u4e00\u4e2a\u5c1a\u672a\u5206\u914d\u7684txid\u3002\u622a\u81f3\u5feb\u7167\u65f6\uff0c\u6240\u6709\u5927\u4e8e\u6216\u7b49\u4e8e\u6b64\u503c\u7684txid\u5c1a\u672a\u542f\u52a8\uff0c\u56e0\u6b64\u4e0d\u53ef\u89c1\u3002 xip_list\uff1a\u5feb\u7167\u65f6\u7684\u6d3b\u52a8txid\u3002\u8be5\u5217\u8868\u4ec5\u5305\u542bxmin\u548cxmax\u4e4b\u95f4\u7684\u6d3b\u52a8txid\u3002</p> <p>\u4f8b\u5982\uff0c\u5728\u5feb\u7167'100:104:100,102'\u4e2d\uff0cxmin\u662f'100'\uff0cxmax\u662f'104'\uff0cxip_list\u662f'100,102'\u3002</p> <p></p> <p>(a)\u4e2d<code>100:100:</code>\u8868\u793a\uff1a - \u56e0\u4e3axmin\u4e3a100\uff0c\u6240\u4ee5txid &lt; 100\u7684\u4e8b\u52a1\u4e0d\u6d3b\u8dc3\u3002 - \u56e0\u4e3axmax\u4e3a100\uff0c\u6240\u4ee5txid \u2265 100\u7684\u4e8b\u52a1\u662f\u6d3b\u8dc3\u7684\u3002</p> <p>(b)\u4e2d<code>100:104:100,102</code>\u8868\u793a\uff1a - txid &lt; 100\u7684\u4e8b\u52a1\u4e0d\u6d3b\u8dc3\u3002 - txid \u2265 104\u7684\u4e8b\u52a1\u662f\u6d3b\u8dc3\u7684\u3002 - txid\u7b49\u4e8e100\u548c102\u7684\u4e8b\u52a1\u662f\u6d3b\u8dc3\u7684\uff0c\u56e0\u4e3a\u5b83\u4eec\u5728xip_list\u4e2d\uff0c\u800ctxid\u7b49\u4e8e101\u548c103\u7684\u4e8b\u52a1\u4e0d\u6d3b\u8dc3\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#_3","title":"\u4e8b\u52a1\u7ba1\u7406\u5668","text":"<p>\u4e0d\u540c\u9694\u79bb\u7ea7\u522b\u7684\u4e8b\u52a1\u5feb\u7167\u72b6\u6001 </p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#update","title":"\u5e76\u53d1UPDATE\u65f6\u9632\u6b62\u66f4\u65b0\u7684\u6570\u636e\u4e22\u5931","text":"<p>\u5e76\u53d1UPDATE\u64cd\u4f5c\uff0c\u9694\u79bb\u7ea7\u522b\u4e0d\u540c\u5982\u4f55\u4fdd\u62a4\u5df2\u4fee\u6539\u7684\u6570\u636e\u4e0d\u4e22\u5931</p> <p></p> <p>(1)\u5982\u679cA\u4e8b\u52a1\u56de\u6eda\uff0c\u5219b\u4e8b\u52a1\u80fd\u591f\u66f4\u65b0\u6210\u529f (2)\u5f53\u524d\u4e8b\u52a1\u5c1d\u8bd5\u66f4\u65b0\u76ee\u6807\u5143\u7ec4\uff0c\u4f46\u53e6\u4e00\u4e2a\u5e76\u53d1\u4e8b\u52a1\u5df2\u7ecf\u66f4\u65b0\u4e86\u76ee\u6807\u884c\u5e76\u63d0\u4ea4\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u5f53\u524d\u4e8b\u52a1\u5904\u4e8eREAD COMMITTED\u7ea7\u522b\uff0c\u5219\u4f1a\u66f4\u65b0\u76ee\u6807\u884c\uff0c\u5426\u5219\u4f1a\u7acb\u5373\u4e2d\u6b62\u4ee5\u9632\u6b62\u4e22\u5931\u66f4\u65b0 (3)\u6ca1\u6709\u51b2\u7a81\uff0c\u5f53\u524d\u4e8b\u52a1\u53ef\u4ee5\u76f4\u63a5\u66f4\u65b0\u76ee\u6807\u884c</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#_4","title":"\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb","text":"<p>SSI(\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb)\u5b9e\u65bd\u7684\u57fa\u672c\u7b56\u7565</p> <p></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#postgresqlssi","title":"\u5728PostgreSQL\u4e2d\u5b9e\u73b0SSI","text":"<p>SIREAD locks\uff1a\u5728\u5185\u90e8\u53c8\u88ab\u79f0\u4e3a\u8c13\u8bcd\u9501\uff0c\u662f\u4e00\u4e2a\u7531\u5bf9\u8c61\u4e0e\uff08\u865a\u62df\uff09\u4e8b\u52a1\u6807\u8bc6\u6784\u6210\u7684\u4e8c\u5143\u7ec4\uff1b\u8fd9\u4e2a\u4e8c\u5143\u7ec4\u5b58\u50a8\u7740\u54ea\u4e2a\u4e8b\u52a1\u8bbf\u95ee\u4e86\u54ea\u4e2a\u5bf9\u8c61\u7684\u76f8\u5173\u4fe1\u606f rw-conflicts\uff1a\u8bfb-\u5199\u51b2\u7a81\u662f\u4e00\u4e2a\u4e09\u5143\u7ec4\uff0c\u7531SIREAD\u9501\u53ca\u4e24\u4e2a\u5206\u522b\u8bfb\u5199\u8be5SIREAD\u9501\u7684\u4e8b\u52a1txid\u6784\u6210</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#ssi","title":"SSI\u600e\u6837\u9020\u6210\u7684","text":"<p>\u4e8b\u52a1\u63d0\u4ea4\u5931\u8d25\u7684\u539f\u56e0\u662f\u8981\u4fdd\u62a4\u4e8b\u52a1A\u4fee\u6539\u7684\u7ed3\u679c\uff0c\u56e0\u4e3a\u4e8b\u52a1B\u662f\u5728\u53ef\u4e32\u884c\u5316\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff0c\u6240\u4ee5\u65e0\u6cd5\u770b\u5230\u4e8b\u52a1A\u4fee\u6539\u540e\u7684\u7ed3\u679c</p> <p></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#_5","title":"\u5047\u9633\u6027\u53ef\u4e32\u884c\u5316\u5feb\u7167\u9694\u79bb\u5f02\u5e38","text":"<p>\u4e24\u4e2a\u4e8b\u52a1\u5206\u522b\u67e5\u8be2\u548c\u66f4\u65b0\u5404\u81ea\u7684\u884c\uff0c\u6240\u4ee5\u4e0d\u4f1a\u5f71\u54cd\uff0c\u90fd\u80fd\u591f\u63d0\u4ea4\u6210\u529f\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#using-sequential-scan","title":"Using sequential scan","text":"<p>\u8868\u6ca1\u6709\u7d22\u5f15\uff0c\u5bfc\u81f4\u987a\u5e8f\u626b\u63cf\uff0c\u4e24\u4e2a\u4e8b\u52a1\u64cd\u4f5c\u65f6\u53d1\u751f\u4ea4\u53c9\u8bbf\u95ee\u540c\u4e00\u4e2a\u5757</p> <p></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#index-scan-using-the-same-index-page","title":"Index scan using the same index page","text":"<p>\u5982\u679c\u8868\u6bd4\u8f83\u5c0f\uff0c\u5bfc\u81f4root\u548cleaf\u7d22\u5f15\u5757\u540c\u5c5e\u4e8e\u4e00\u4e2a\u5757\uff0c\u4e24\u4e2a\u4e8b\u52a1\u4e5f\u53d1\u751f\u4ea4\u53c9\u8bbf\u95ee\u540c\u4e00\u4e2a\u7d22\u5f15\u5757</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E4%BA%8B%E5%8A%A1%E4%B8%8E%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/#index-scan-using-the-difference-index-page","title":"Index scan using the difference index page","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/","title":"\u5143\u7ec4\u7ed3\u6784\u548cDML\u64cd\u4f5c","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/#_1","title":"\u4e00\u3001\u5143\u7ec4\u7ed3\u6784","text":"<p>\u5143\u7ec4\u7ed3\u6784\uff1aHeapTupleHeaderData\u7ed3\u6784\u3001\u7a7a\u503c\u4f4d\u56fe\u53ca\u7528\u6237\u6570\u636e</p> <p>HeapTupleHeaderData\u7ed3\u6784\uff1a - t_xmin\u4fdd\u5b58\u63d2\u5165\u6b64\u5143\u7ec4\u7684\u4e8b\u52a1\u7684txid\u3002 - t_xmax\u4fdd\u5b58\u5220\u9664\u6216\u66f4\u65b0\u6b64\u5143\u7ec4\u7684\u4e8b\u52a1\u7684txid\u3002\u5982\u679c\u5c1a\u672a\u5220\u9664\u6216\u66f4\u65b0\u6b64\u5143\u7ec4\uff0c\u5219t_xmax\u8bbe\u7f6e\u4e3a0\uff0c\u5373\u65e0\u6548\u3002 - t_cid\u4fdd\u5b58\u547d\u4ee4\u6807\u8bc6\uff08command id,cid\uff09,cid\u7684\u610f\u601d\u662f\u5728\u5f53\u524d\u4e8b\u52a1\u4e2d\uff0c\u6267\u884c\u5f53\u524d\u547d\u4ee4\u4e4b\u524d\u6267\u884c\u4e86\u591a\u5c11SQL\u547d\u4ee4\uff0c\u4ece\u96f6\u5f00\u59cb\u8ba1\u6570\u3002\u4f8b\u5982\uff0c\u5047\u8bbe\u6211\u4eec\u5728\u5355\u4e2a\u4e8b\u52a1\u4e2d\u6267\u884c\u4e863\u6761INSERT\u547d\u4ee4BEGIN;INSERT;INSERT;INSERT;COMMIT;\u3002\u5982\u679c\u7b2c\u4e00\u6761\u547d\u4ee4\u63d2\u5165\u6b64\u5143\u7ec4\uff0c\u5219\u8be5\u5143\u7ec4\u7684t_cid\u4f1a\u88ab\u8bbe\u7f6e\u4e3a0\u3002\u5982\u679c\u7b2c\u4e8c\u6761\u547d\u4ee4\u63d2\u5165\u6b64\u5143\u7ec4\uff0c\u5219\u5176t_cid\u4f1a\u88ab\u8bbe\u7f6e\u4e3a1\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002 - t_ctid\u4fdd\u5b58\u7740\u6307\u5411\u81ea\u8eab\u6216\u65b0\u5143\u7ec4\u7684\u5143\u7ec4\u6807\u8bc6\u7b26\uff08tid\uff09\u3002tid\u7528\u4e8e\u6807\u8bc6\u8868\u4e2d\u7684\u5143\u7ec4\u3002\u5728\u66f4\u65b0\u8be5\u5143\u7ec4\u65f6\uff0ct_ctid\u4f1a\u6307\u5411\u65b0\u7248\u672c\u7684\u5143\u7ec4\uff0c\u5426\u5219t_ctid\u4f1a\u6307\u5411\u81ea\u5df1\u3002</p> <p>\u884c\u7ed3\u6784</p> <p></p> <p>PostgreSQL\u81ea\u5e26\u4e86\u4e00\u4e2a\u7b2c\u4e09\u65b9\u8d21\u732e\u7684\u6269\u5c55\u6a21\u5757pageinspect\uff0c\u53ef\u7528\u4e8e\u68c0\u67e5\u6570\u636e\u5e93\u9875\u9762\u7684\u5177\u4f53\u5185\u5bb9\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/#2-dml","title":"2. DML","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/#1-insert","title":"1. INSERT","text":"<p>\u5047\u8bbe\u5143\u7ec4\u662f\u7531txid=99\u7684\u4e8b\u52a1\u63d2\u5165\u9875\u9762\u4e2d\u7684\uff0c\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u88ab\u63d2\u5165\u5143\u7ec4\u7684\u9996\u90e8\u5b57\u6bb5\u4f1a\u4f9d\u4ee5\u4e0b\u6b65\u9aa4\u8bbe\u7f6e\u3002 Tuple_1\uff1a - t_xmin\u8bbe\u7f6e\u4e3a99\uff0c\u56e0\u4e3a\u6b64\u5143\u7ec4\u7531txid=99\u7684\u4e8b\u52a1\u6240\u63d2\u5165\u3002 - t_xmax\u8bbe\u7f6e\u4e3a0\uff0c\u56e0\u4e3a\u6b64\u5143\u7ec4\u5c1a\u672a\u88ab\u5220\u9664\u6216\u66f4\u65b0\u3002 - t_cid\u8bbe\u7f6e\u4e3a0\uff0c\u56e0\u4e3a\u6b64\u5143\u7ec4\u662f\u7531txid=99\u7684\u4e8b\u52a1\u6240\u6267\u884c\u7684\u7b2c\u4e00\u6761\u547d\u4ee4\u63d2\u5165\u7684\u3002 - t_ctid\u8bbe\u7f6e\u4e3a(0,1)\uff0c\u6307\u5411\u81ea\u8eab\uff0c\u56e0\u4e3a\u8fd9\u662f\u8be5\u5143\u7ec4\u7684\u6700\u65b0\u7248\u672c\u3002</p> <pre><code>postgres=# CREATE EXTENSION pageinspect;\nCREATE EXTENSION\npostgres=# CREATE TABLE tbl (data text);\nCREATE TABLE\npostgres=# INSERT INTO tbl VALUES('A');\nINSERT 0 1\npostgres=# SELECT lp as tuple, t_xmin, t_xmax, t_field3 as t_cid, t_ctid FROM heap_page_items(get_raw_page('tbl', 0));\n tuple | t_xmin | t_xmax | t_cid | t_ctid \n-------+--------+--------+-------+--------\n     1 | 448834 |      0 |     0 | (0,1)\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/#2-delete","title":"2. DELETE","text":"<p>\u5728\u5220\u9664\u64cd\u4f5c\u4e2d\uff0c\u76ee\u6807\u5143\u7ec4\u53ea\u662f\u5728\u903b\u8f91\u4e0a\u88ab\u6807\u8bb0\u4e3a\u5220\u9664\u3002\u76ee\u6807\u5143\u7ec4\u7684t_xmax\u5b57\u6bb5\u5c06\u88ab\u8bbe\u7f6e\u4e3a\u6267\u884cDELETE\u547d\u4ee4\u4e8b\u52a1\u7684txid\u3002 \u5047\u8bbeTuple_1\u88abtxid=111\u7684\u4e8b\u52a1\u5220\u9664\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0cTuple_1\u7684\u9996\u90e8\u5b57\u6bb5t_xmax\u88ab\u8bbe\u4e3a111\u3002 \u5982\u679ctxid=111\u7684\u4e8b\u52a1\u5df2\u7ecf\u63d0\u4ea4\uff0c\u5c31\u4e0d\u4e00\u5b9a\u8981Tuple_1\u3002\u901a\u5e38\u4e0d\u9700\u8981\u7684\u5143\u7ec4\u5728PostgreSQL\u4e2d\u88ab\u79f0\u4e3a\u6b7b\u5143\u7ec4\uff08dead tuple\uff09\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/#3-update","title":"3. UPDATE","text":"<p>\u5728\u66f4\u65b0\u64cd\u4f5c\u4e2d\uff0cPostgreSQL\u5728\u903b\u8f91\u4e0a\u5b9e\u9645\u6267\u884c\u7684\u662f\u5220\u9664\u6700\u65b0\u7684\u5143\u7ec4\uff0c\u5e76\u63d2\u5165\u4e00\u6761\u65b0\u7684\u5143\u7ec4\u3002 \u5047\u8bbe\u7531txid=99\u7684\u4e8b\u52a1\u63d2\u5165\u7684\u884c\uff0c\u88abtxid=100\u7684\u4e8b\u52a1\u66f4\u65b0\u4e24\u6b21\u3002 \u5f53\u6267\u884c\u7b2c\u4e00\u6761UPDATE\u547d\u4ee4\u65f6\uff0cTuple_1\u7684t_xmax\u88ab\u8bbe\u4e3atxid=100\uff0c\u5728\u903b\u8f91\u4e0a\u88ab\u5220\u9664\uff0c\u7136\u540eTuple_2\u88ab\u63d2\u5165\uff0c\u63a5\u4e0b\u6765\u91cd\u5199Tuple_1\u7684t_ctid\u4ee5\u6307\u5411Tuple_2\u3002Tuple_1\u548cTuple_2\u7684\u5934\u90e8\u5b57\u6bb5\u8bbe\u7f6e\u5982\u4e0b\u3002</p> <p>Tuple_1\uff1a   - t_xmax\u88ab\u8bbe\u7f6e\u4e3a100\u3002   - t_ctid\u4ece(0,1)\u88ab\u6539\u5199\u4e3a(0,2)\u3002</p> <p>Tuple_2\uff1a   - t_xmin\u88ab\u8bbe\u7f6e\u4e3a100\u3002   - t_xmax\u88ab\u8bbe\u7f6e\u4e3a0\u3002   - t_cid\u88ab\u8bbe\u7f6e\u4e3a0\u3002   - t_ctid\u88ab\u8bbe\u7f6e\u4e3a(0,2)\u3002</p> <p>\u5f53\u6267\u884c\u7b2c\u4e8c\u6761UPDATE\u547d\u4ee4\u65f6\uff0c\u548c\u7b2c\u4e00\u6761UPDATE\u547d\u4ee4\u7c7b\u4f3c\uff0cTuple_2\u88ab\u903b\u8f91\u5220\u9664\uff0cTuple_3\u88ab\u63d2\u5165\u3002Tuple_2\u548cTuple_3\u7684\u9996\u90e8\u5b57\u6bb5\u8bbe\u7f6e\u5982\u4e0b\u3002</p> <p>Tuple_2\uff1a   - t_xmax\u88ab\u8bbe\u7f6e\u4e3a100\u3002   - t_ctid\u4ece(0,2)\u88ab\u6539\u5199\u4e3a(0,3)\u3002</p> <p>Tuple_3\uff1a   - t_xmin\u88ab\u8bbe\u7f6e\u4e3a100\u3002   - t_xmax\u88ab\u8bbe\u7f6e\u4e3a0\u3002   - t_cid\u88ab\u8bbe\u7f6e\u4e3a1\u3002   - t_ctid\u88ab\u8bbe\u7f6e\u4e3a(0,3)\u3002</p> <pre><code>postgres=# CREATE TABLE tbl (data text);\nCREATE TABLE\npostgres=# INSERT INTO tbl VALUES('A');\nINSERT 0 1\npostgres=# SELECT lp as tuple, t_xmin, t_xmax, t_field3 as t_cid, t_ctid FROM heap_page_items(get_raw_page('tbl', 0));\n tuple | t_xmin | t_xmax | t_cid | t_ctid \n-------+--------+--------+-------+--------\n     1 | 448838 |      0 |     0 | (0,1)\n(1 row)\n\npostgres=# BEGIN;\nBEGIN\npostgres=# update tbl set data='B';\nUPDATE 1\npostgres=# SELECT lp as tuple, t_xmin, t_xmax, t_field3 as t_cid, t_ctid FROM heap_page_items(get_raw_page('tbl', 0));\n tuple | t_xmin | t_xmax | t_cid | t_ctid \n-------+--------+--------+-------+--------\n     1 | 448838 | 448839 |     0 | (0,2)\n     2 | 448839 |      0 |     0 | (0,2)\n(2 rows)\n\npostgres=# update tbl set data='C';\nUPDATE 1\npostgres=# SELECT lp as tuple, t_xmin, t_xmax, t_field3 as t_cid, t_ctid FROM heap_page_items(get_raw_page('tbl', 0));\n tuple | t_xmin | t_xmax | t_cid | t_ctid \n-------+--------+--------+-------+--------\n     1 | 448838 | 448839 |     0 | (0,2)\n     2 | 448839 | 448839 |     0 | (0,3)\n     3 | 448839 |      0 |     1 | (0,3)\n(3 rows)\n\npostgres=# END;\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%85%83%E7%BB%84%E7%BB%93%E6%9E%84%E5%92%8CDML%E6%93%8D%E4%BD%9C/#_2","title":"\u5757\u7a7a\u95f4\u7684\u6e05\u7406","text":"<p>\u5757\u4e2d\u88ab\u5220\u9664\u7684\u884c\u7684\u662f\u903b\u8f91\u4e0a\u5220\u9664\uff0c\u7269\u7406\u4e0a\u8fd8\u4fdd\u7559\u5728\u5757\u4e2d\uff0c\u5982\u679c\u957f\u65f6\u95f4\u4e0d\u6e05\u7406\uff0c\u4f1a\u9020\u6210\u5783\u573e\u7a7a\u95f4\u81a8\u80c0\uff0c\u8bbe\u60f3\uff0c\u5982\u679c\u4e00\u4e2a\u5757\u4e2d\u670950%\u5783\u573e\uff0c\u90a3\u4e48\u5c31\u6d6a\u8d3950%\u7684\u5b58\u50a8\u7a7a\u95f4\u5982\u679c\u8bfb\u5230\u5185\u5b58\uff0c\u4e5f\u4f1a\u6d6a\u8d3950%\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u6240\u4ee5\u9700\u8981\u5b9a\u671f\u7684\u6e05\u7406\uff0c\u800c\u6e05\u7406\u7684\u5de5\u4f5c\u7531AutoVacuum\u6765\u64cd\u4f5c\uff0c\u6216\u8005\u6211\u4eec\u4e5f\u53ef\u4ee5\u624b\u52a8\u64cd\u4f5c\u3002 pg_freespacemap\u63d2\u4ef6\u53ef\u4ee5\u5f88\u597d\u7684\u76d1\u6d4b\u5757\u4e2d\u7a7a\u95f4\u7684\u4f7f\u7528\u60c5\u51b5\uff0c\u53ef\u5f53\u4f5c<code>full vacuum</code>\u64cd\u4f5c\u7684\u53c2\u8003\u4fe1\u606f\u3002</p> <pre><code>postgres=# CREATE EXTENSION pg_freespacemap;\nCREATE EXTENSION\npostgres=# SELECT *, round(100 * avail/8192 ,2) as \"freespace ratio\" FROM pg_freespace('tbl');\n blkno | avail | freespace ratio \n-------+-------+-----------------\n     0 |     0 |            0.00\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/","title":"\u51bb\u7ed3tixd","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#txidid","title":"\u4e00\u3001TXID\uff08\u4e8b\u52a1id\uff09","text":"<p>\u5f53\u4e00\u4e2a\u4e8b\u52a1\u5f00\u59cb\u65f6\uff0cPostgreSQL\u4e2d\u7684\u4e8b\u52a1\u7ba1\u7406\u7cfb\u7edf\u4f1a\u4e3a\u8be5\u4e8b\u52a1\u5206\u914d\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6\u7b26\uff0c\u5373\u4e8b\u52a1ID(txid)\u3002PostgreSQL\u4e2d\u7684txid\u88ab\u5b9a\u4e49\u4e3a\u4e00\u4e2a32\u4f4d\u7684\u65e0\u7b26\u53f7\u6574\u6570\uff0c\u4e5f\u5c31\u662f\u8bf4\uff0c\u5b83\u80fd\u8bb0\u5f55\u5927\u7ea642\u4ebf\u4e2a\u4e8b\u52a1\u3002\u901a\u5e38txid\u5bf9\u6211\u4eec\u662f\u900f\u660e\u7684\uff0c\u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u5229\u7528PostgreSQL\u5185\u90e8\u7684\u51fd\u6570\u6765\u83b7\u53d6\u5f53\u524d\u4e8b\u52a1\u7684txid\u3002</p> <pre><code>postgres=# BEGIN;\nBEGIN\npostgres=# SELECT txid_current();\n txid_current \n--------------\n          100\n(1 row)\n</code></pre> <p>BEGIN\u547d\u4ee4\u6ca1\u6709\u6307\u5b9atxid\u3002\u5728PostgreSQL\u4e2d\uff0c\u5f53\u7b2c\u4e00\u4e2a\u547d\u4ee4\u5728BEGIN\u547d\u4ee4\u6267\u884c\u4e4b\u540e\u6267\u884c\u65f6\uff0c\u4e8b\u52a1\u7ba1\u7406\u5668\u4f1a\u5206\u914d\u4e00\u4e2atixd\uff0c\u7136\u540e\u5b83\u7684\u4e8b\u52a1\u5f00\u59cb\u3002</p> <p>PostgreSQL\u4fdd\u7559\u4ee5\u4e0b\u4e09\u4e2a\u7279\u6b8atxid\uff1a - 0\u8868\u793a\u65e0\u6548\u7684txid\u3002 - 1\u8868\u793a\u521d\u59cb\u542f\u52a8\u7684txid\uff0c\u4ec5\u7528\u4e8e\u6570\u636e\u5e93\u96c6\u7fa4\u7684\u521d\u59cb\u5316\u8fc7\u7a0b\u3002 - 2\u8868\u793a\u51bb\u7ed3\u7684txid</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#txid","title":"\u4e8c\u3001TXID\u4f7f\u7528\u539f\u7406","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#1-txid","title":"1. TXID\u7ed3\u6784","text":"<ul> <li>TxID=2^32=42\u4ebf</li> <li>\u524d21\u4ebf\u4e2aTxID\u662f\u201c\u8fc7\u53bb\u7684\u201d</li> <li>\u540e21\u4ebf\u4e2aTxID\u662f\u201c\u672a\u6765\u7684\u201d</li> </ul>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#2-txid","title":"2. TXID\u73af\u7ed5","text":"<p>\u5047\u8bbe\u5143\u7ec4tuple_1\u7684txid\u4e3a100\uff0c\u5373tuple_1\u7684t_xmin\u4e3a100\u3002\u670d\u52a1\u5668\u5df2\u7ecf\u8fd0\u884c\u5f88\u957f\u4e00\u6bb5\u65f6\u95f4\u4e86\uff0cTuple_1\u6ca1\u6709\u88ab\u4fee\u6539\u3002\u5f53\u524d\u7684txid\u662f21\u4ebf+100\uff0c\u6267\u884cSELECT\u547d\u4ee4\u3002\u6b64\u65f6\uff0cTuple_1\u53ef\u89c1\uff0c\u56e0\u4e3atxid 100\u662f\u8fc7\u53bb\u7684\u3002\u63a5\u7740\uff0c\u53c8\u6267\u884c\u76f8\u540c\u7684SELECT\u547d\u4ee4\uff0c\u6b64\u65f6\u5f53\u524d\u7684txid\u5c31\u53d8\u6210\u662f21\u4ebf+101\u4e86\uff0c\u6839\u636e\u884c\u53ef\u89c1\u6027\u89c4\u5219\u5224\u65adTuple_1\u5c31\u4e0d\u518d\u53ef\u89c1\uff0c\u56e0\u4e3atxid 100\u53d8\u6210\u662f\u672a\u6765\u7684\u4e86\u3002</p> <p>\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\uff0cPostgreSQL\u5f15\u5165\u4e86\u4e00\u4e2a\u51bb\u7ed3\u4e8b\u52a1\u6807\u8bc6\u7684\u6982\u5ff5\uff0c\u5e76\u5b9e\u73b0\u4e86\u4e00\u4e2a\u540d\u4e3aFREEZE\u7684\u8fc7\u7a0b\u3002 \u5728PostgreSQL\u4e2d\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51bb\u7ed3\u7684txid\uff0c\u5b83\u662f\u4e00\u4e2a\u7279\u6b8a\u7684\u4fdd\u7559\u503ctxid = 2\uff0c\u5728\u53c2\u4e0e\u4e8b\u52a1\u6807\u8bc6\u5927\u5c0f\u6bd4\u8f83\u65f6\uff0c\u5b83\u603b\u662f\u6bd4\u6240\u6709\u5176\u4ed6txid\u90fd\u65e7\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u51bb\u7ed3\u7684txid\u59cb\u7ec8\u5904\u4e8e\u975e\u6d3b\u8dc3\u72b6\u6001\uff0c\u4e14\u5176\u7ed3\u679c\u5bf9\u5176\u4ed6\u4e8b\u52a1\u59cb\u7ec8\u53ef\u89c1\u3002 \u6e05\u7406\u8fc7\u7a0b\u4f1a\u8c03\u7528\u51bb\u7ed3\u8fc7\u7a0b\u3002\u51bb\u7ed3\u8fc7\u7a0b\u5c06\u626b\u63cf\u6240\u6709\u8868\u6587\u4ef6\uff0c\u5982\u679c\u5143\u7ec4\u7684t_xmin\u6bd4\u5f53\u524dtxid- vacuum_freeze_min_age\uff08\u9ed8\u8ba4\u503c\u4e3a5000\u4e07\uff09\u66f4\u65e7\uff0c\u5219\u5c06\u8be5\u5143\u7ec4\u7684t_xmin\u91cd\u5199\u4e3a\u51bb\u7ed3\u4e8b\u52a1\u6807\u8bc6\u3002 \u4f8b\u5982\u5f53\u524dtxid\u4e3a5000\u4e07\uff0c\u6b64\u65f6\u901a\u8fc7VACUUM\u547d\u4ee4\u8c03\u7528\u51bb\u7ed3\u8fc7\u7a0b\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff1a 9.3\u53ca\u4ee5\u524d\u7684\u7248\u672c\uff1aTuple_1\u548cTuple_2\u7684t_xmin\u90fd\u88ab\u91cd\u5199\u4e3a2\u3002 9.4\u6216\u66f4\u9ad8\u7248\u672c\u4e2d\u4f7f\u7528\u5143\u7ec4t_infomask\u5b57\u6bb5\u4e2d\u7684XMIN_FROZEN\u6807\u8bb0\u4f4d\u6765\u6807\u8bc6\u51bb\u7ed3\u5143\u7ec4\u3002</p> <p></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#3","title":"3. \u51bb\u7ed3\u5904\u7406\u7684\u4e24\u79cd\u6a21\u5f0f","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#31-lazy-mode","title":"3.1 Lazy Mode","text":"<p><pre><code>freezeLimit_txid=(OldestXmin-vacuum_freeze_min_age)\n</code></pre> OldestXmin\u662f\u5f53\u524d\u6b63\u5728\u8fd0\u884c\u7684\u4e8b\u52a1\u4e2d\u6700\u65e9\u7684\u4e8b\u52a1\u6807\u8bc6\u3002\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5982\u679c\u5728\u6267\u884cVACUUM\u547d\u4ee4\u65f6\uff0c\u8fd8\u6709\u5176\u4ed6\u4e09\u4e2a\u4e8b\u52a1\u6b63\u5728\u8fd0\u884c\uff0c\u4e14\u5176txid\u5206\u522b\u4e3a100\u3001101\u548c102\uff0c\u90a3\u4e48OldestXmin\u5c31\u662f100\u3002\u5982\u679c\u4e0d\u5b58\u5728\u5176\u4ed6\u4e8b\u52a1\uff0cOldestXmin\u5c31\u662f\u6267\u884c\u6b64VACUUM\u547d\u4ee4\u7684\u4e8b\u52a1\u6807\u8bc6\u3002\u8fd9\u91ccvacuum_freeze_min_age\u662f\u4e00\u4e2a\u914d\u7f6e\u53c2\u6570\uff08\u9ed8\u8ba4\u503c\u4e3a50000000\uff09\u3002 AutoVacuum\u64cd\u4f5c\u4f1a\u8fdb\u884c\u51bb\u7ed3\u64cd\u4f5c\uff0c\u6bcf\u5206\u949f\u90fd\u4f1a\u6267\u884c\u4e00\u6b21\uff0c\u88ab\u9009\u4e2d\u7684\u8868\u90fd\u4f1a\u8fdb\u884cvacuum\u64cd\u4f5c\uff0c\u5305\u542b\u51bb\u7ed3txid\u5185\u5bb9\u3002</p> <p></p> <p>\u7b2c0\u9875\uff1a\u4e09\u6761\u5143\u7ec4\u88ab\u51bb\u7ed3\uff0c\u56e0\u4e3a\u6240\u6709\u5143\u7ec4\u7684t_xmin\u503c\u90fd\u5c0f\u4e8efreezeLimit_txid\u3002\u6b64\u5916\uff0c\u56e0\u4e3aTuple_1\u662f\u4e00\u6761\u6b7b\u5143\u7ec4\uff0c\u6240\u4ee5\u5728\u8be5\u6e05\u7406\u8fc7\u7a0b\u4e2d\u88ab\u79fb\u9664\u3002 \u7b2c1\u9875\uff1a\u901a\u8fc7\u5f15\u7528\u53ef\u89c1\u6027\u6620\u5c04\uff08\u4eceVM\u4e2d\u53d1\u73b0\u8be5\u9875\u9762\u6240\u6709\u5143\u7ec4\u90fd\u53ef\u89c1\uff09\uff0c\u6e05\u7406\u8fc7\u7a0b\u8df3\u8fc7\u4e86\u5bf9\u8be5\u9875\u9762\u7684\u6e05\u7406\u3002 \u7b2c2\u9875\uff1aTuple_7\u548cTuple_8\u88ab\u51bb\u7ed3\uff0c\u4e14Tuple_7\u88ab\u79fb\u9664\u3002 \u5728\u5b8c\u6210\u6e05\u7406\u8fc7\u7a0b\u4e4b\u524d\uff0c\u4e0e\u6e05\u7406\u76f8\u5173\u7684\u7edf\u8ba1\u6570\u636e\u4f1a\u88ab\u66f4\u65b0\uff0c\u4f8b\u5982pg_stat_all_tables\u89c6\u56fe\u4e2d\u7684n_live_tup\u3001n_dead_tup\u3001last_vacuum\u3001vacuum_count\u7b49\u5b57\u6bb5\u3002 \u56e0\u4e3a\u60f0\u6027\u6a21\u5f0f\u53ef\u80fd\u4f1a\u8df3\u8fc7\u9875\u9762\uff0c\u5b83\u53ef\u80fd\u65e0\u6cd5\u51bb\u7ed3\u6240\u6709\u9700\u8981\u51bb\u7ed3\u7684\u5143\u7ec4.</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E5%86%BB%E7%BB%93tixd/#32-eager-mode","title":"3.2 Eager Mode","text":"<p>\u5f53\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\u65f6\uff0c\u6267\u884c\u7d27\u6025\u6a21\u5f0f\uff1a</p> <pre><code>pg_database.datfrozenxid&lt;(OldestXmin-vacuum_freeze_table_age)\n</code></pre> <p>pg_database.datfrozenxid\u662f\u7cfb\u7edf\u89c6\u56fepg_database\u4e2d\u7684\u5217\uff0c\u5e76\u4fdd\u5b58\u7740\u6bcf\u4e2a\u6570\u636e\u5e93\u4e2d\u6700\u8001\u7684\u5df2\u51bb\u7ed3\u7684\u4e8b\u52a1\u6807\u8bc6\u3002 \u5047\u8bbe\u6240\u6709pg_database.datfrozenxid\u7684\u503c\u90fd\u662f1821\uff08\u8fd9\u662f\u57289.5\u7248\u672c\u4e2d\u5b89\u88c5\u65b0\u6570\u636e\u5e93\u96c6\u7fa4\u4e4b\u540e\u7684\u521d\u59cb\u503c\uff09\u3002vacuum_freeze_table_age\u662f\u914d\u7f6e\u53c2\u6570\uff08\u9ed8\u8ba4\u4e3a150000000\uff09</p> <p></p> <p>\u88681\u4e2d\uff0cTuple_1\u548cTuple_7\u90fd\u5df2\u7ecf\u88ab\u5220\u9664\uff0cTuple_10\u548cTuple_11\u5219\u5df2\u7ecf\u63d2\u5165\u7b2c2\u9875\u4e2d\u3002\u6267\u884cVACUUM \u547d\u4ee4\u65f6\u7684\u4e8b\u52a1\u6807\u8bc6\u4e3a150 002 000\uff0c\u4e14\u6ca1\u6709\u5176\u4ed6\u4e8b\u52a1\u3002\u56e0\u6b64\uff0cOldestXmin=150 002 000,freezeLimit_txid=100 002 000\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u6ee1\u8db3\u4e86\u4e0a\u8ff0\u6761\u4ef6\uff1a\u56e0\u4e3a1821 &lt; (150 002 000 - 150 000 000)\uff0c\u6240\u4ee5\u51bb\u7ed3\u8fc7\u7a0b\u4f1a\u4ee5\u8feb\u5207\u6a21\u5f0f\u6267\u884c\u3002 \u7b2c0\u9875\uff1a\u5373\u4f7f\u6240\u6709\u5143\u7ec4\u90fd\u88ab\u51bb\u7ed3\uff0c\u4e5f\u4f1a\u68c0\u67e5Tuple_2\u548cTuple_3\u3002 \u7b2c1\u9875\uff1a\u6b64\u9875\u9762\u4e2d\u7684\u4e09\u6761\u5143\u7ec4\u90fd\u4f1a\u88ab\u51bb\u7ed3\uff0c\u56e0\u4e3a\u6240\u6709\u5143\u7ec4\u7684t_xmin\u503c\u90fd\u5c0f\u4e8e freezeLimit_txid\u3002\u6ce8\u610f\uff0c\u5728\u60f0\u6027\u6a21\u5f0f\u4e0b\u4f1a\u8df3\u8fc7\u6b64\u9875\u9762\u3002 \u7b2c2\u9875\uff1a\u5c06Tuple_10\u51bb\u7ed3\uff0c\u800cTuple_11\u6ca1\u6709\u51bb\u7ed3\u3002</p> <p>\u51bb\u7ed3\u4e00\u5f20\u8868\u540e\uff0c\u76ee\u6807\u8868\u7684pg_class.relfrozenxid\u5c06\u88ab\u66f4\u65b0\u3002pg_class\u662f\u4e00\u4e2a\u7cfb\u7edf\u89c6\u56fe\uff0c\u6bcf\u4e2apg_class.relfrozenxid\u5217\u90fd\u4fdd\u5b58\u7740\u76f8\u5e94\u8868\u7684\u6700\u8fd1\u51bb\u7ed3\u7684\u4e8b\u52a1\u6807\u8bc6\u3002\u672c\u4f8b\u4e2d\u88681\u7684pg_class.relfrozenxid\u4f1a\u88ab\u66f4\u65b0\u4e3a\u5f53\u524d\u7684freezeLimit_txid\uff08\u5373100002000\uff09\uff0c\u8fd9\u610f\u5473\u7740\u88681\u4e2dt_xmin\u5c0f\u4e8e100002000\u7684\u6240\u6709\u5143\u7ec4\u90fd\u5df2\u88ab\u51bb\u7ed3\u3002</p> <p>\u5728\u5b8c\u6210\u6e05\u7406\u8fc7\u7a0b\u4e4b\u524d\uff0c\u5fc5\u8981\u65f6\u4f1a\u66f4\u65b0pg_database.datfrozenxid\u3002\u6bcf\u4e2apg_database.datfrozenxid\u5217\u90fd\u5305\u542b\u76f8\u5e94\u6570\u636e\u5e93\u4e2d\u7684\u6700\u5c0fpg_class.relfrozenxid\u3002\u5982\u679c\u5728\u8feb\u5207\u6a21\u5f0f\u4e0b\u4ec5\u4ec5\u5bf9\u88681\u505a\u51bb\u7ed3\u5904\u7406\uff0c\u5219\u4e0d\u4f1a\u66f4\u65b0\u8be5\u6570\u636e\u5e93\u7684pg_database.datfrozenxid\uff0c\u56e0\u4e3a\u5176\u4ed6\u5173\u7cfb\u7684pg_class.relfrozenxid\uff08\u5f53\u524d\u6570\u636e\u5e93\u53ef\u89c1\u7684\u5176\u4ed6\u8868\u548c\u7cfb\u7edf\u89c6\u56fe\uff09\u8fd8\u6ca1\u6709\u53d1\u751f\u53d8\u5316\uff0c\u5982\u56fe1\u6240\u793a\u3002\u5982\u679c\u5f53\u524d\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u5173\u7cfb\u90fd\u4ee5\u8feb\u5207\u6a21\u5f0f\u51bb\u7ed3\uff0c\u5219\u6570\u636e\u5e93\u7684pg_database.datfrozenxid\u5c31\u4f1a\u88ab\u66f4\u65b0\uff0c\u56e0\u4e3a\u6b64\u6570\u636e\u5e93\u7684\u6240\u6709\u5173\u7cfb\u7684pg_class.relfrozenxid\u90fd\u88ab\u66f4\u65b0\u4e3a\u5f53\u524d\u7684freezeLimit txid\uff0c\u5982\u56fe2\u6240\u793a\u3002</p> <p></p> <p>\u5982\u4f55\u663e\u793apg_class.relfrozenxid\u4e0epg_database.datfrozenxid</p> <pre><code>testdb=# VACUUM table_1;\nVACUUM\n\ntestdb=# SELECT n.nspname as \"Schema\", c.relname as \"Name\", c.relfrozenxid\n             FROM pg_catalog.pg_class c\n             LEFT JOIN pg_catalog.pg_namespace n ON n.oid = c.relnamespace\n             WHERE c.relkind IN ('r','')\n                   AND n.nspname &lt;&gt; 'information_schema' AND n.nspname !~ '^pg_toast'\n                   AND pg_catalog.pg_table_is_visible(c.oid)\n                   ORDER BY c.relfrozenxid::text::bigint DESC;\n   Schema   |            Name         | relfrozenxid \n------------+-------------------------+--------------\n public     | table_1                 |    100002000\n public     | table_2                 |         1846\n pg_catalog | pg_database             |         1827\n pg_catalog | pg_user_mapping         |         1821\n pg_catalog | pg_largeobject          |         1821\n\n...\n\n pg_catalog | pg_transform            |         1821\n(57 rows)\n\ntestdb=# SELECT datname, datfrozenxid FROM pg_database WHERE datname = 'testdb';\n datname | datfrozenxid \n---------+--------------\n testdb  |         1821\n(1 row)\n</code></pre> <p>9.5\u6216\u66f4\u4f4e\u7248\u672c\u4e2d\u7684\u8feb\u5207\u6a21\u5f0f\u6548\u7387\u4e0d\u9ad8\uff0c\u56e0\u4e3a\u5b83\u59cb\u7ec8\u4f1a\u626b\u63cf\u6240\u6709\u9875\u9762\u3002\u4e3a\u4e86\u89e3\u51b3\u8fd9\u4e00\u95ee\u9898\uff0c9.6\u7248\u672c\u6539\u8fdb\u4e86\u53ef\u89c1\u6027\u6620\u5c04VM\u4e0e\u51bb\u7ed3\u8fc7\u7a0b\u3002VM\u5305\u542b\u7740\u6bcf\u4e2a\u9875\u9762\u4e2d\u6240\u6709\u5143\u7ec4\u662f\u5426\u90fd\u5df2\u88ab\u51bb\u7ed3\u7684\u4fe1\u606f\u3002\u5728\u8feb\u5207\u6a21\u5f0f\u4e0b\u8fdb\u884c\u51bb\u7ed3\u5904\u7406\u65f6\uff0c\u53ef\u4ee5\u8df3\u8fc7\u4ec5\u5305\u542b\u51bb\u7ed3\u5143\u7ec4\u7684\u9875\u9762\u3002 \u5982\u4e0b\u56fe\uff1a\u6839\u636eVM\u4e2d\u7684\u4fe1\u606f\uff0c\u51bb\u7ed3\u6b64\u8868\u65f6\u4f1a\u8df3\u8fc7\u7b2c0\u9875\u3002\u5728\u66f4\u65b0\u5b8c1\u53f7\u9875\u9762\u540e\uff0c\u76f8\u5173\u7684VM\u4fe1\u606f\u4f1a\u88ab\u66f4\u65b0\uff0c\u56e0\u4e3a\u8be5\u9875\u4e2d\u6240\u6709\u7684\u5143\u7ec4\u90fd\u5df2\u7ecf\u88ab\u51bb\u7ed3\u4e86\u3002</p> <p></p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D/","title":"\u6570\u636e\u5e93\u6062\u590d","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D/#_1","title":"\u6570\u636e\u5e93\u7684\u6062\u590d","text":"<p>PostgreSQL\u7684\u6062\u590d\u529f\u80fd\u57fa\u4e8eREDO\u65e5\u5fd7\u5b9e\u73b0\u3002\u5982\u679c\u6570\u636e\u5e93\u670d\u52a1\u5668\u65e0\u6cd5\u5de5\u4f5c\uff0cPostgreSQL\u901a\u8fc7\u4eceREDO\u70b9\u4f9d\u5e8f\u91cd\u653eWAL\u6bb5\u6587\u4ef6\u4e2d\u7684XLOG\u8bb0\u5f55\u6765\u6062\u590d\u6570\u636e\u5e93\u96c6\u7fa4\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D/#1","title":"1. \u542f\u52a8\u6062\u590d\u8fc7\u7a0b","text":"<ol> <li>PostgreSQL\u5728\u542f\u52a8\u65f6\u8bfb\u53d6pg_control\u6587\u4ef6\u7684\u6240\u6709\u9879\u3002\u5982\u679cstate\u9879\u662fin production,PostgreSQL\u5c06\u8fdb\u5165\u6062\u590d\u6a21\u5f0f\uff0c\u56e0\u4e3a\u8fd9\u610f\u5473\u7740\u6570\u636e\u5e93\u6ca1\u6709\u6b63\u5e38\u505c\u6b62\uff1b\u800c\u5982\u679cstate\u9879\u662fshut down\uff0c\u5b83\u5c31\u4f1a\u8fdb\u5165\u6b63\u5e38\u7684\u542f\u52a8\u6a21\u5f0f\u3002</li> <li>PostgreSQL \u4ece\u5408\u9002\u7684 WAL \u6bb5\u6587\u4ef6\u4e2d\u8bfb\u53d6\u6700\u8fd1\u7684\u68c0\u67e5\u70b9\uff0c\u8be5\u8bb0\u5f55\u7684\u4f4d\u7f6e\u5199\u5728pg_control \u6587\u4ef6\u4e2d\uff0c\u5e76\u4ece\u8be5\u68c0\u67e5\u70b9\u4e2d\u83b7\u5f97REDO\u70b9\u3002\u5982\u679c\u6700\u65b0\u7684\u68c0\u67e5\u70b9\u662f\u65e0\u6548\u7684\uff0cPostgreSQL\u5c31\u4f1a\u8bfb\u53d6\u524d\u4e00\u4e2a\u68c0\u67e5\u70b9\uff08\u5728PostgreSQL 11.0\u4e2d\u4e0d\u4f1a\u5b58\u50a8\u524d\u4e00\u4e2a\u68c0\u67e5\u70b9\uff09\u3002\u5982\u679c\u4e24\u4e2a\u8bb0\u5f55\u90fd\u4e0d\u53ef\u8bfb\uff0c\u5b83\u5c31\u4f1a\u653e\u5f03\u81ea\u6211\u6062\u590d\u3002</li> <li>\u4f7f\u7528\u5408\u9002\u7684\u8d44\u6e90\u7ba1\u7406\u5668\u6309\u987a\u5e8f\u8bfb\u53d6\u5e76\u91cd\u653eXLOG\u8bb0\u5f55\uff0c\u4ece\u91cd\u505a\u70b9\u5f00\u59cb\uff0c\u76f4\u5230\u6700\u65b0WAL\u6bb5\u6587\u4ef6\u7684\u6700\u540e\u4f4d\u7f6e\u3002\u5f53\u9047\u5230\u4e00\u6761\u5c5e\u4e8e\u5907\u4efd\u533a\u5757\u7684XLOG\u8bb0\u5f55\u65f6\uff0c\u65e0\u8bba\u5176LSN\u5982\u4f55\uff0c\u90fd\u4f1a\u8986\u5199\u76f8\u5e94\u8868\u7684\u9875\u9762\u3002\u5728\u5176\u4ed6\u60c5\u51b5\u4e0b\uff0c\u53ea\u6709\u5f53\u6b64\u8bb0\u5f55\u7684LSN\u5927\u4e8e\u76f8\u5e94\u9875\u9762\u7684pd_lsn\u65f6\uff0c\u624d\u4f1a\u91cd\u653e\u8be5\uff08\u975e\u5907\u4efd\u533a\u5757\u7684\uff09XLOG\u8bb0\u5f55\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D/#2","title":"2. \u6062\u590d\u8fc7\u7a0b","text":"<p>\u6570\u636e\u5e93\u91cd\u542f\u65f6\u4f1a\u81ea\u52a8\u8fdb\u5165\u6062\u590d\u6a21\u5f0f\uff0cPostgreSQL\u4f1a\u4eceREDO\u70b9\u5f00\u59cb\uff0c\u4f9d\u5e8f\u8bfb\u53d6\u6b63\u786e\u7684WAL\u6bb5\u6587\u4ef6\u5e76\u91cd\u653eXLOG\u8bb0\u5f55\u3002\u5c06\u6570\u636e\u5e93\u6062\u590d\u5230\u5d29\u6e83\u65f6\u523b\u524d\u7684\u72b6\u6001\u3002</p> <p> </p> <ol> <li>PostgreSQL\u4ece\u76f8\u5173\u7684WAL\u6bb5\u6587\u4ef6\u4e2d\u8bfb\u53d6\u7b2c1\u6761INSERT\u8bed\u53e5\u7684XLOG\u8bb0\u5f55\uff0c\u5e76\u4ece\u786c\u76d8\u4e0a\u7684\u6570\u636e\u5e93\u76ee\u5f55\u52a0\u8f7dTABLE_A\u7684\u9875\u9762\u5230\u5185\u5b58\u4e2d\u7684\u5171\u4eab\u7f13\u51b2\u533a\u4e2d\u3002</li> <li>\u5728\u91cd\u653eXLOG\u8bb0\u5f55\u524d\uff0cPostgreSQL\u4f1a\u6bd4\u8f83XLOG\u8bb0\u5f55\u7684LSN\u4e0e\u76f8\u5e94\u9875\u9762\u7684LSN\u3002\u91cd\u653eXLOG\u7684\u89c4\u5219\u5982\u4e0b<ul> <li>\u5982\u679cXLOG\u8bb0\u5f55\u7684LSN\u6bd4\u9875\u9762\u7684LSN\u5927\uff0cXLOG\u8bb0\u5f55\u4e2d\u7684\u6570\u636e\u90e8\u5206\u5c31\u4f1a\u88ab\u63d2\u5165\u9875\u9762\u4e2d\uff0c\u5e76\u5c06\u9875\u9762\u7684LSN\u66f4\u65b0\u4e3aXLOG\u8bb0\u5f55\u7684LSN\u3002</li> <li>\u5982\u679cXLOG\u8bb0\u5f55\u7684LSN\u6bd4\u9875\u9762\u7684LSN\u5c0f\uff0c\u90a3\u4e48\u4e0d\u7528\u505a\u4efb\u4f55\u4e8b\u60c5\uff0c\u76f4\u63a5\u8bfb\u53d6\u540e\u7eed\u7684WAL\u6570\u636e\u5373\u53ef\u3002</li> </ul> </li> <li>PostgreSQL\u6309\u7167\u540c\u6837\u7684\u65b9\u5f0f\u91cd\u653e\u5176\u4f59\u7684XLOG\u8bb0\u5f55\u3002</li> </ol> <p>PostgreSQL\u53ef\u4ee5\u901a\u8fc7\u6309\u65f6\u95f4\u987a\u5e8f\u91cd\u653e\u5199\u5728WAL\u6bb5\u6587\u4ef6\u4e2d\u7684XLOG\u8bb0\u5f55\u6765\u81ea\u6211\u6062\u590d\uff0c\u56e0\u6b64\uff0cPostgreSQL\u7684XLOG\u8bb0\u5f55\u663e\u7136\u662f\u4e00\u79cdREDO\u65e5\u5fd7\u3002PostgreSQL\u4e0d\u652f\u6301UNDO\u65e5\u5fd7\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%81%A2%E5%A4%8D/#3-lsn","title":"3. LSN\u7684\u6bd4\u8f83","text":"<p>\u975e\u5907\u4efd\u533a\u5757\u7684LSN\u548c\u76f8\u5e94\u9875\u9762\u7684pd_lsn\u7684\u6bd4\u8f83</p> <p> </p> <ol> <li>PostgreSQL\u5c06\u4e00\u6761\u5143\u7ec4\u63d2\u5165\u8868A\uff0c\u5e76\u5c06\u4e00\u6761XLOG\u8bb0\u5f55\u5199\u5165LSN_1\u3002</li> <li>\u540e\u53f0\u5199\u5165\u8fdb\u7a0b\u5c06\u8868A\u7684\u9875\u9762\u5199\u5165\u5b58\u50a8\u3002\u6b64\u65f6\uff0c\u6b64\u9875\u9762\u7684pd_lsn\u4e3aLSN_1\u3002</li> <li>PostgreSQL\u5728\u8868A\u4e2d\u63d2\u5165\u4e00\u6761\u65b0\u5143\u7ec4\uff0c\u5e76\u5728LSN_2\u5904\u5199\u5165\u4e00\u6761XLOG\u8bb0\u5f55\u3002\u4fee\u6539\u540e\u7684\u9875\u9762\u5c1a\u672a\u5199\u5165\u5b58\u50a8\u3002</li> </ol> <p>\u8868A\u7684\u9875\u9762\u5df2\u7ecf\u88ab\u4e00\u6b21\u6027\u5199\u5165\u5b58\u50a8\u4e2d\u3002\u4f7f\u7528immediate\u6a21\u5f0f\u5173\u95ed\u6570\u636e\u5e93\uff0c\u7136\u540e\u542f\u52a8\u6570\u636e\u5e93\u3002</p> <p> </p> <ol> <li>PostgreSQL\u52a0\u8f7d\u7b2c\u4e00\u6761XLOG\u8bb0\u5f55\u548cTABLE_A\u7684\u9875\u9762\uff0c\u4f46\u4e0d\u91cd\u653e\u5b83\uff0c\u56e0\u4e3a\u8be5\u8bb0\u5f55\u7684LSN\u4e0d\u5927\u4e8e\u8868A\u7684LSN\uff08\u4e24\u4e2a\u503c\u90fd\u662fLSN_1\uff09,\u6ca1\u6709\u91cd\u653e\u8be5\u8bb0\u5f55\u7684\u5fc5\u8981\u6027\u3002</li> <li>\u63a5\u4e0b\u6765\uff0cPostgreSQL\u4f1a\u91cd\u653e\u7b2c\u4e8c\u6761XLOG\u8bb0\u5f55\uff0c\u56e0\u4e3a\u8be5\u8bb0\u5f55\u7684LSN\uff08LSN_2\uff09\u5927\u4e8e\u5f53\u524dTABLE_A\u7684LSN\uff08LSN_1\uff09\u3002</li> </ol> <p>\u53ef\u4ee5\u770b\u51fa\uff0c\u5982\u679c\u975e\u5907\u4efd\u533a\u5757\u7684\u91cd\u653e\u987a\u5e8f\u4e0d\u6b63\u786e\uff0c\u6216\u8005\u591a\u6b21\u91cd\u653e\u975e\u5907\u4efd\u533a\u5757\uff0c\u6570\u636e\u5e93\u96c6\u7fa4\u5c06\u4e0d\u518d\u4e00\u81f4\u3002\u7b80\u800c\u8a00\u4e4b\uff0c\u975e\u5907\u4efd\u533a\u5757\u7684\u91cd\u505a\uff08\u91cd\u653e\uff09\u64cd\u4f5c\u4e0d\u662f\u5e42\u7b49\u7684\u3002\u56e0\u6b64\uff0c\u4e3a\u4e86\u786e\u4fdd\u6b63\u786e\u7684\u91cd\u653e\u987a\u5e8f\uff0c\u975e\u5907\u4efd\u533a\u5757\u4e2d\u7684\u8bb0\u5f55\u5f53\u4e14\u4ec5\u5f53\u5176LSN\u5927\u4e8e\u76f8\u5e94\u9875\u9762\u7684pd_lsn\u65f6\uff0c\u624d\u6267\u884c\u91cd\u653e\u3002 \u53e6\u5916\uff0c\u7531\u4e8e\u5907\u4efd\u533a\u5757\u7684\u91cd\u653e\u64cd\u4f5c\u662f\u5e42\u7b49\u7684\uff0c\u4e0d\u7ba1\u5176 LSN\u4e3a\u4f55\u503c\uff0c\u5907\u4efd\u5757\u90fd\u53ef\u4ee5\u91cd\u653e\u4efb\u610f\u6b21\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/","title":"\u6570\u636e\u6587\u4ef6\u548c\u5757\u5b58\u50a8\u7ed3\u6784","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/#oid","title":"\u4e00\u3001\u5bf9\u8c61OID\u4e0e\u6570\u636e\u6587\u4ef6\u5bf9\u5e94\u5173\u7cfb","text":"<p>PG\u6570\u636e\u5e93\u7684\u4e00\u5f20\u8868\u6216\u8005\u7d22\u5f15\u5bf9\u5e94\u4e00\u4e2a\u6570\u636e\u6587\u4ef6\u3002 \u4f5c\u4e3a\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u8868\u548c\u7d22\u5f15\u5728\u5185\u90e8\u7531\u5404\u4e2aoid\u7ba1\u7406\uff0c\u800c\u8fd9\u4e9b\u6570\u636e\u6587\u4ef6\u5219\u7531\u53d8\u91cfrelfilenode\u7ba1\u7406\u3002 \u8868\u548c\u7d22\u5f15\u7684relfilenode\u503c\u5f00\u59cb\u65f6\u57fa\u672c\u4e0a(\u4f46\u5e76\u4e0d\u603b\u662f)\u4e0e\u76f8\u5e94\u7684oid\u5339\u914d\u3002</p> <pre><code>postgres=# SELECT relname,oid,relfilenode FROM pg_class WHERE relname='tbl';\n relname |  oid  | relfilenode \n---------+-------+-------------\n tbl     | 16740 |       16740\n(1 row)\n\npostgres=# SELECT datname,oid FROM pg_database WHERE datname='postgres';\n datname  |  oid  \n----------+-------\n postgres | 13593\n(1 row)\n</code></pre> <p>\u76f8\u5173\u8868\u7684\u6570\u636e\u6587\u4ef6\u8def\u5f84</p> <pre><code>$ ls -l $PGDATA/base/13593/16740\n-rw-------. 1 postgres postgres 0 Nov 16 09:51 /opt/software/postgresql/data/base/13593/16740\n</code></pre> <p>TRUNCATE\u3001REINDEX\u3001CLUSTER\u7b49\u64cd\u4f5c\u4f1a\u9020\u6210relfilenode\u53f7\u7684\u6539\u53d8\uff0c\u56e0\u4e3a\u5148\u5220\u9664\u539f\u6765\u7684\u6570\u636e\u6587\u4ef6\uff0c\u518d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4f1a\u66f4\u5feb\u3002</p> <p>\u4f7f\u7528\u5185\u7f6e\u51fd\u6570<code>pg_relation_filepath</code>\u67e5\u770b\u8868\u7684\u6587\u4ef6\u8def\u5f84</p> <pre><code>postgres=# select pg_relation_filepath('tbl');\n pg_relation_filepath \n----------------------\n base/13593/16740\n(1 row)\n</code></pre> <p>\u6587\u4ef6\u5c3a\u5bf8\u8d85\u8fc71GB\u540e\uff0c\u65b0\u6587\u4ef6\u7684\u4ea7\u751f\u89c4\u5219\uff1a</p> <pre><code>$ cd $PGDATA\n$ ls -la -h base/16384/19427*\n-rw------- 1 data/base/16384/19427\n-rw------- 1 data/base/16384/19427.1\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/#_1","title":"\u4e8c\u3001\u76f8\u5173\u8054\u7684\u5176\u5b83\u6570\u636e\u6587\u4ef6","text":"<p>\u7a7a\u95f2\u7a7a\u95f4\u5730\u56fe\u548c\u53ef\u89c1\u6027\u5730\u56fe('_fsm'\u548c'_vm'):</p> <pre><code>$ cd $PGDATA\n$ ls -1 base/13593/16740*\nbase/13593/16740\nbase/13593/16740_fsm\nbase/13593/16740_vm\n</code></pre> <ul> <li>\u5f53insert\u64cd\u4f5c\u65f6\u7a7a\u95f2\u7a7a\u95f4\u6587\u4ef6\u7528\u6765\u67e5\u770b\u54ea\u4e9b\u6570\u636e\u5757\u6709\u7a7a\u95f2\u7a7a\u95f4\u5b58\u653e\u65b0\u884c</li> <li>\u5f53\u8fdb\u884cvacuum\u64cd\u4f5c\u65f6\u53ef\u89c1\u6027\u5730\u56fe\u6587\u4ef6\u7528\u6765\u63d0\u9ad8\u64cd\u4f5c\u7684\u6548\u7387</li> <li>\u76f8\u5173\u7684\u4e09\u7c7b\u6587\u4ef6\u5728\u5185\u90e8\u79f0\u4e3a\u6bcf\u4e2a\u5173\u7cfb\u7684\u5206\u5c94(fork)\uff1b\u6570\u636e\u6587\u4ef6\u7684fork\u53f7\u4e3a0\u3001\u7a7a\u95f2\u7a7a\u95f4\u6587\u4ef6fork\u53f7\u4e3a1\uff0c\u53ef\u89c1\u6027\u5730\u56fe\u6587\u4ef6\u7684fork\u53f7\u4e3a2</li> </ul>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/#_2","title":"\u4e09\u3001\u6570\u636e\u5e93\u5185\u90e8\u7ed3\u6784","text":"<p>\u6570\u636e\u6587\u4ef6\uff08\u5806\u8868\u3001\u7d22\u5f15\uff0c\u4e5f\u5305\u62ec\u7a7a\u95f2\u7a7a\u95f4\u6620\u5c04\u548c\u53ef\u89c1\u6027\u6620\u5c04\uff09\u5185\u90e8\u88ab\u5212\u5206\u4e3a\u56fa\u5b9a\u957f\u5ea6\u7684\u9875\uff0c\u6216\u8005\u53eb\u533a\u5757\uff0c\u5927\u5c0f\u9ed8\u8ba4\u4e3a8192B\uff088KB\uff09\u3002 \u6bcf\u4e2a\u6587\u4ef6\u4e2d\u7684\u9875\u4ece0\u5f00\u59cb\u6309\u987a\u5e8f\u7f16\u53f7\uff0c\u8fd9\u4e9b\u6570\u5b57\u79f0\u4e3a\u533a\u5757\u53f7\u3002\u5982\u679c\u6587\u4ef6\u5df2\u586b\u6ee1\uff0cPostgreSQL\u5c31\u901a\u8fc7\u5728\u6587\u4ef6\u672b\u5c3e\u8ffd\u52a0\u4e00\u4e2a\u65b0\u7684\u7a7a\u9875\u6765\u589e\u52a0\u6587\u4ef6\u957f\u5ea6\u3002 \u9875\u9762\u5185\u90e8\u7684\u5e03\u5c40\u53d6\u51b3\u4e8e\u6570\u636e\u6587\u4ef6\u7684\u7c7b\u578b\u3002</p> <p>\u8868\u7684\u9875\u9762\u5305\u542b\u4e86\u4e09\u79cd\u7c7b\u578b\u7684\u6570\u636e\uff1a</p> <ol> <li>\u9996\u90e8\u6570\u636e\uff1a\u9875\u9762\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u5927\u5c0f\u4e3a24B\uff0c\u5305\u542b\u5173\u4e8e\u9875\u9762\u7684\u5143\u6570\u636e\u3002</li> <li>pd_lsn\uff1a\u672c\u9875\u9762\u6700\u8fd1\u4e00\u6b21\u53d8\u66f4\u6240\u5199\u5165\u7684XLOG\u8bb0\u5f55\u5bf9\u5e94\u7684LSN\u3002\u5b83\u662f\u4e00\u4e2a8B\u65e0\u7b26\u53f7\u6574\u6570\u3002</li> <li>pd_checksum\uff1a\u672c\u9875\u9762\u7684\u6821\u9a8c\u548c\u503c\u3002\uff08\u57289.3\u6216\u66f4\u9ad8\u7248\u672c\u4e2d\u624d\u6709\u6b64\u53d8\u91cf\uff0c\u65e9\u671f\u7248\u672c\u4e2d\u8be5\u5b57\u6bb5\u7528\u4e8e\u5b58\u50a8\u9875\u9762\u7684\u65f6\u95f4\u7ebf\u6807\u8bc6\u3002\uff09</li> <li>pd_lower\u3001pd_upper\uff1apd_lower\u6307\u5411\u884c\u6307\u9488\u7684\u672b\u5c3e\uff0cpd_upper\u6307\u5411\u6700\u65b0\u5806\u5143\u7ec4\u7684\u8d77\u59cb\u4f4d\u7f6e\u3002</li> <li>pd_special\uff1a\u5728\u7d22\u5f15\u9875\u4e2d\u4f1a\u7528\u5230\u8be5\u5b57\u6bb5\uff0c\u5728\u5806\u8868\u9875\u4e2d\u5b83\u6307\u5411\u9875\u5c3e\u3002\uff08\u5728\u7d22\u5f15\u9875\u4e2d\u5b83\u6307\u5411\u7279\u6b8a\u7a7a\u95f4\u7684\u8d77\u59cb\u4f4d\u7f6e\uff0c\u7279\u6b8a\u7a7a\u95f4\u662f\u4ec5\u7531\u7d22\u5f15\u4f7f\u7528\u7684\u7279\u6b8a\u6570\u636e\u533a\u57df\uff0c\u5305\u542b\u7279\u5b9a\u7684\u6570\u636e\uff0c\u5177\u4f53\u5185\u5bb9\u4f9d\u7d22\u5f15\u7684\u7c7b\u578b\u800c\u5b9a\uff0c\u5982B\u6811\u3001GiST\u3001GiN\u7b49\u3002\uff09</li> <li>papagesize_version\uff1a\u9875\u9762\u7684\u5927\u5c0f\uff0c\u4ee5\u53ca\u9875\u9762\u5e03\u5c40\u7684\u7248\u672c\u53f7</li> <li> <p>db_prune_xid\uff1a\u672c\u9875\u9762\u4e2d\u53ef\u4ee5\u4fee\u526a\u7684\u6700\u8001\u7684\u5143\u7ec4\u4e2d\u7684XID</p> </li> <li> <p>\u884c\u6307\u9488\uff1a\u6bcf\u4e2a\u884c\u6307\u9488\u53604B\uff0c\u4fdd\u5b58\u7740\u6307\u5411\u5806\u5143\u7ec4\u7684\u6307\u9488\u3002\u5b83\u4eec\u4e5f\u88ab\u79f0\u4e3a\u9879\u76ee\u6307\u9488\u3002\u884c\u6307\u9488\u5f62\u6210\u4e00\u4e2a\u7b80\u5355\u7684\u6570\u7ec4\uff0c\u626e\u6f14\u4e86\u5143\u7ec4\u7d22\u5f15\u7684\u89d2\u8272\u3002\u6bcf\u4e2a\u7d22\u5f15\u9879\u4ece1\u5f00\u59cb\u4f9d\u6b21\u7f16\u53f7\uff0c\u79f0\u4e3a\u504f\u79fb\u53f7\u3002\u5f53\u5411\u9875\u9762\u4e2d\u6dfb\u52a0\u65b0\u5143\u7ec4\u65f6\uff0c\u4e00\u4e2a\u76f8\u5e94\u7684\u65b0\u884c\u6307\u9488\u4e5f\u4f1a\u88ab\u653e\u5165\u6570\u7ec4\u4e2d\uff0c\u5e76\u6307\u5411\u65b0\u6dfb\u52a0\u7684\u5143\u7ec4\u3002</p> </li> <li>\u5806\u5143\u7ec4\uff1a\u5373\u6570\u636e\u8bb0\u5f55\u672c\u8eab\u3002\u5b83\u4eec\u4ece\u9875\u9762\u5e95\u90e8\u5f00\u59cb\u4f9d\u5e8f\u5806\u53e0\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/#1","title":"1. \u63d2\u5165\u6570\u636e","text":"<p>\u5047\u8bbe\u6709\u4e00\u4e2a\u8868\u4ec5\u7531\u4e00\u4e2a\u9875\u9762\u7ec4\u6210\uff0c\u4e14\u8be5\u9875\u9762\u53ea\u5305\u542b\u4e00\u4e2a\u5806\u5143\u7ec4\u3002\u6b64\u9875\u9762\u7684pd_lower\u6307\u5411\u7b2c\u4e00\u4e2a\u884c\u6307\u9488\uff0c\u800c\u8be5\u884c\u6307\u9488\u548cpd_upper\u90fd\u6307\u5411\u7b2c\u4e00\u4e2a\u5806\u5143\u7ec4\u3002 \u5f53\u5199\u5165\u7b2c\u4e8c\u4e2a\u5143\u7ec4\u65f6\uff0c\u5b83\u4f1a\u88ab\u653e\u5728\u7b2c\u4e00\u4e2a\u5143\u7ec4\u4e4b\u540e\u3002\u7b2c\u4e8c\u4e2a\u884c\u6307\u9488\u5199\u5165\u5230\u7b2c\u4e00\u4e2a\u884c\u6307\u9488\u7684\u540e\u9762\uff0c\u5e76\u6307\u5411\u7b2c\u4e8c\u4e2a\u5143\u7ec4\u3002pd_lower \u66f4\u6539\u4e3a\u6307\u5411\u7b2c\u4e8c\u4e2a\u884c\u6307\u9488\uff0cpd_upper\u66f4\u6539\u4e3a\u6307\u5411\u7b2c\u4e8c\u4e2a\u5806\u5143\u7ec4\u3002\u9875\u9762\u5185\u7684\u9996\u90e8\u6570\u636e\uff08\u4f8b\u5982pd_lsn\u3001pg_checksum\u548cpg_flag\uff09\u4e5f\u4f1a\u88ab\u6539\u5199\u4e3a\u9002\u5f53\u7684\u503c</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/#2","title":"2.\u8bfb\u53d6\u6570\u636e","text":"<ol> <li>\u987a\u5e8f\u626b\u63cf\uff1a\u901a\u8fc7\u626b\u63cf\u6bcf\u4e00\u9875\u4e2d\u7684\u884c\u6307\u9488\uff0c\u4f9d\u5e8f\u8bfb\u53d6\u6240\u6709\u9875\u9762\u4e2d\u7684\u6240\u6709\u5143\u7ec4\u3002</li> <li>B\u6811\u7d22\u5f15\u626b\u63cf\uff1a\u7d22\u5f15\u6587\u4ef6\u5305\u542b\u7d22\u5f15\u5143\u7ec4\uff0c\u7d22\u5f15\u5143\u7ec4\u7531\u4e00\u4e2a\u952e\u503c\u5bf9\u7ec4\u6210\uff0c\u952e\u4e3a\u88ab\u7d22\u5f15\u7684\u5217\u503c\uff0c\u503c\u4e3a\u76ee\u6807\u5806\u5143\u7ec4\u7684TID\u3002\u8fdb\u884c\u7d22\u5f15\u67e5\u8be2\u65f6\uff0c\u9996\u5148\u4f7f\u7528\u952e\u8fdb\u884c\u67e5\u627e\uff0c\u5982\u679c\u627e\u5230\u4e86\u5bf9\u5e94\u7684\u7d22\u5f15\u5143\u7ec4\uff0cPostgreSQL\u5c31\u4f1a\u6839\u636e\u76f8\u5e94\u503c\u4e2d\u7684TID\u6765\u8bfb\u53d6\u5bf9\u5e94\u7684\u5806\u5143\u7ec4\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6%E5%92%8C%E5%9D%97%E5%AD%98%E5%82%A8%E7%BB%93%E6%9E%84/#3","title":"3.\u66f4\u65b0\u8868","text":"<p>update\u64cd\u4f5c\u65f6\uff0c\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u8fc7\u7a0b\u662f\u5148delete\u540einsert\uff0c\u88ab\u5220\u9664\u7684\u884c\u7a7a\u95f4\u4e0d\u4f1a\u7acb\u523b\u91ca\u653e\uff0cvacuum\u64cd\u4f5c\u65f6\u4f1a\u91ca\u653e\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/","title":"\u67b6\u6784","text":""},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#_1","title":"\u4e00\u3001\u7269\u7406\u7ed3\u6784","text":"<p><code>$PGDATA</code>\u76ee\u5f55\u7ed3\u6784</p> <pre><code>$ ls -1 $PGDATA\nPG_VERSION            # \u5305\u542bPostgreSQL\u4e3b\u7248\u672c\u53f7\u7684\u6587\u4ef6\npostgresql.auto.conf  # \u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u7531ALTER SYSTEM \u8bbe\u7f6e\u7684\u914d\u7f6e\u53c2\u6570\u7684\u6587\u4ef6\npostgresql.conf       # \u53c2\u6570\u914d\u7f6e\npostmaster.opts       # \u4e00\u4e2a\u8bb0\u5f55\u670d\u52a1\u5668\u6700\u540e\u4e00\u6b21\u542f\u52a8\u65f6\u4f7f\u7528\u7684\u547d\u4ee4\u884c\u53c2\u6570\u7684\u6587\u4ef6\npostmaster.pid        # \u4e00\u4e2a\u9501\u6587\u4ef6\uff0c\u8bb0\u5f55\u7740\u5f53\u524d\u7684 postmaster \u8fdb\u7a0bID\uff08PID\uff09\u3001\u96c6\u7c07\u6570\u636e\u76ee\u5f55\u8def\u5f84\u3001\n                      # postmaster\u542f\u52a8\u65f6\u95f4\u6233\u3001\u7aef\u53e3\u53f7\u3001Unix\u57df\u5957\u63a5\u5b57\u76ee\u5f55\u8def\u5f84\uff08Windows\u4e0a\u4e3a\u7a7a\uff09\u3001\n                      # \u7b2c\u4e00\u4e2a\u53ef\u7528\u7684listen_address\uff08IP\u5730\u5740\u6216\u8005*\uff0c\u6216\u8005\u4e3a\u7a7a\u8868\u793a\u4e0d\u5728TCP\u4e0a\u76d1\u542c\uff09\n                      # \u4ee5\u53ca\u5171\u4eab\u5185\u5b58\u6bb5ID\uff08\u670d\u52a1\u5668\u5173\u95ed\u540e\u8be5\u6587\u4ef6\u4e0d\u5b58\u5728\uff09\npg_hba.conf           # \u5ba2\u6237\u7aef\u8ba4\u8bc1\u914d\u7f6e\npg_ident.conf         # \u7528\u6237\u540d\u6620\u5c04\u914d\u7f6e\nbase                  # \u5305\u542b\u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u5e94\u7684\u5b50\u76ee\u5f55\u7684\u76ee\u5f55\nglobal                # \u5305\u542b\u96c6\u7c07\u8303\u56f4\u7684\u8868\u7684\u5b50\u76ee\u5f55\uff0c\u6bd4\u5982pg_database\npg_commit_ts          # \u5305\u542b\u4e8b\u52a1\u63d0\u4ea4\u65f6\u95f4\u6233\u6570\u636e\u7684\u5b50\u76ee\u5f55\npg_dynshmem           # \u5305\u542b\u88ab\u52a8\u6001\u5171\u4eab\u5185\u5b58\u5b50\u7cfb\u7edf\u6240\u4f7f\u7528\u7684\u6587\u4ef6\u7684\u5b50\u76ee\u5f55\npg_logical            # \u5305\u542b\u7528\u4e8e\u903b\u8f91\u590d\u5236\u7684\u72b6\u6001\u6570\u636e\u7684\u5b50\u76ee\u5f55\npg_multixact          # \u5305\u542b\u591a\u4e8b\u52a1\uff08multi-transaction\uff09\u72b6\u6001\u6570\u636e\u7684\u5b50\u76ee\u5f55\uff08\u7528\u4e8e\u5171\u4eab\u7684\u884c\u9501\uff09\npg_notify             # \u5305\u542bLISTEN/NOTIFY\u72b6\u6001\u6570\u636e\u7684\u5b50\u76ee\u5f55\npg_replslot           # \u5305\u542b\u590d\u5236\u69fd\u6570\u636e\u7684\u5b50\u76ee\u5f55\npg_serial             # \u5305\u542b\u5df2\u63d0\u4ea4\u7684\u53ef\u5e8f\u5217\u5316\u4e8b\u52a1\u4fe1\u606f\u7684\u5b50\u76ee\u5f55\npg_snapshots          # \u5305\u542b\u5bfc\u51fa\u7684\u5feb\u7167\u7684\u5b50\u76ee\u5f55\npg_stat               # \u5305\u542b\u7528\u4e8e\u7edf\u8ba1\u5b50\u7cfb\u7edf\u7684\u6c38\u4e45\u6587\u4ef6\u7684\u5b50\u76ee\u5f55\npg_stat_tmp           # \u5305\u542b\u7528\u4e8e\u7edf\u8ba1\u4fe1\u606f\u5b50\u7cfb\u7edf\u7684\u4e34\u65f6\u6587\u4ef6\u7684\u5b50\u76ee\u5f55\npg_tblspc             # \u5305\u542b\u6307\u5411\u8868\u7a7a\u95f4\u7684\u7b26\u53f7\u94fe\u63a5\u7684\u5b50\u76ee\u5f55\npg_twophase           # \u5305\u542b\u7528\u4e8e\u9884\u5907\u4e8b\u52a1\u72b6\u6001\u6587\u4ef6\u7684\u5b50\u76ee\u5f55\npg_wal                # \u5305\u542b WAL \uff08\u9884\u5199\u65e5\u5fd7\uff09\u6587\u4ef6\u7684\u5b50\u76ee\u5f55\npg_xact               # \u5305\u542b\u4e8b\u52a1\u63d0\u4ea4\u72b6\u6001\u6570\u636e\u7684\u5b50\u76ee\u5f55\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#1","title":"1. \u6570\u636e\u5e93\u7ed3\u6784","text":"<p>\u4e00\u4e2a\u6570\u636e\u5e93\u4e0ebase\u5b50\u76ee\u5f55\u4e0b\u7684\u4e00\u4e2a\u5b50\u76ee\u5f55\u5bf9\u5e94\uff0c\u4e14\u8be5\u5b50\u76ee\u5f55\u7684\u540d\u79f0\u4e0e\u76f8\u5e94\u6570\u636e\u5e93\u7684oid\u76f8\u540c\u3002\u4f8b\u5982\uff0c\u5f53\u6570\u636e\u5e93postgres\u7684oid\u4e3a13593\u65f6\uff0c\u5b83\u5bf9\u5e94\u7684\u5b50\u76ee\u5f55\u540d\u79f0\u5c31\u662f13593\u3002</p> <pre><code>[postgres@pg1 data]$ ls base/\n1  13592  13593\n[postgres@pg1 data]$ psql\npsql (12.13)\nType \"help\" for help.\n\npostgres=# select datname,oid from pg_database;\n  datname  |  oid  \n-----------+-------\n postgres  | 13593\n template1 |     1\n template0 | 13592\n(3 rows)\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#2","title":"2. \u8868\u548c\u7d22\u5f15\u7ed3\u6784","text":"<p>\u5728\u6570\u636e\u5e93\u5185\u90e8\uff0c\u8868\u548c\u7d22\u5f15\u4f5c\u4e3a\u6570\u636e\u5e93\u5bf9\u8c61\u662f\u901a\u8fc7oid\u6765\u7ba1\u7406\u7684\uff0c\u800c\u8fd9\u4e9b\u6570\u636e\u6587\u4ef6\u7531\u53d8\u91cfrelfilenode\u7ba1\u7406\u3002\u8868\u548c\u7d22\u5f15\u7684relfilenode\u503c\u901a\u5e38\u4e0e\u5176oid\u4e00\u81f4\u3002</p> <pre><code>postgres=# create table tbl (id int);\nCREATE TABLE\npostgres=# SELECT relname, oid, relfilenode FROM pg_class WHERE relname = 'tbl';\n relname |  oid  | relfilenode \n---------+-------+-------------\n tbl     | 16384 |       16384\n(1 row)\n</code></pre> <p>\u8868\u548c\u7d22\u5f15\u7684relfilenode\u503c\u4f1a\u88ab\u4e00\u4e9b\u547d\u4ee4\uff08\u4f8b\u5982TRUNCATE\u3001REINDEX\u3001CLUSTER\uff09\u6240\u6539\u53d8\u3002\u4f8b\u5982\u5bf9\u8868tbl\u6267\u884cTRUNCATE\u547d\u4ee4\uff0cPostgreSQL\u4f1a\u4e3a\u8868\u5206\u914d\u4e00\u4e2a\u65b0\u7684relfilenode\uff0816387\uff09\uff0c\u5220\u9664\u65e7\u7684\u6570\u636e\u6587\u4ef6\uff0816384\uff09\uff0c\u5e76\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6570\u636e\u6587\u4ef6\uff0816387\uff09\u3002</p> <pre><code>postgres=# TRUNCATE tbl;\nTRUNCATE TABLE\npostgres=# SELECT relname, oid, relfilenode FROM pg_class WHERE relname = 'tbl';\n relname |  oid  | relfilenode \n---------+-------+-------------\n tbl     | 16384 |       16387\n(1 row)\n</code></pre> <p>\u4f7f\u7528\u51fd\u6570pg_relation_filepath\u80fd\u591f\u6839\u636eoid\u6216\u540d\u79f0\u8fd4\u56de\u5173\u7cfb\u5bf9\u5e94\u7684\u6587\u4ef6\u8def\u5f84\u3002</p> <pre><code>postgres=# SELECT pg_relation_filepath('tbl');\n pg_relation_filepath \n----------------------\n base/13593/16387\n(1 row)\n</code></pre> <p>\u5f53\u8868\u548c\u7d22\u5f15\u7684\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc71GB\u65f6\uff0cPostgreSQL\u4f1a\u521b\u5efa\u5e76\u4f7f\u7528\u4e00\u4e2a\u540d\u4e3arelfilenode.1\u7684\u65b0\u6587\u4ef6\u3002\u5982\u679c\u65b0\u6587\u4ef6\u4e5f\u586b\u6ee1\u4e86\uff0c\u5219\u4f1a\u521b\u5efa\u4e0b\u4e00\u4e2a\u540d\u4e3arelfilenode.2\u7684\u65b0\u6587\u4ef6\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#3","title":"3. \u8868\u7a7a\u95f4","text":"<ol> <li>PostgresQL\u4e2d\u7684\u8868\u7a7a\u95f4\u662f\u57fa\u672c\u76ee\u5f55\u4e4b\u5916\u7684\u9644\u52a0\u6570\u636e\u533a\u57df</li> <li>\u521d\u59cb\u5316\u6570\u636e\u5e93\u540e\u9ed8\u8ba4\u7684\u8868\u7a7a\u95f4pg_default\u3001pg_global</li> <li>pg_global\u8868\u7a7a\u95f4\u7684\u7269\u7406\u6587\u4ef6\u4f4d\u7f6e\u5728\u6570\u636e\u76ee\u5f55\u7684global\u76ee\u5f55\u4e2d\uff0c\u5b83\u7528\u6765\u4fdd\u5b58\u7cfb\u7edf\u8868\u3002</li> <li>pg_default\u8868\u7a7a\u95f4\u7684\u7269\u7406\u6587\u4ef6\u4f4d\u7f6e\u5728\u6570\u636e\u76ee\u5f55\u7684base\u5b50\u76ee\u5f55\u4e2d\uff0c\u662ftemplateo\u548ctemplate1\u6570\u636e\u5e93\u7684\u9ed8\u8ba4\u8868\u7a7a\u95f4\u3002</li> <li>\u521b\u5efa\u6570\u636e\u5e93\u65f6\uff0c\u9ed8\u8ba4\u4ecetemplate1\u6570\u636e\u5e93\u8fdb\u884c\u514b\u9686\uff0c\u56e0\u6b64\u9664\u975e\u7279\u522b\u6307\u5b9a\u4e86\u65b0\u5efa\u6570\u636e\u5e93\u7684\u8868\u7a7a\u95f4\uff0c\u5426\u5219\u9ed8\u8ba4\u4f7f\u7528template1\u4f7f\u7528\u7684\u8868\u7a7a\u95f4\uff0c\u5373pg_default\u8868\u7a7a\u95f4\u3002</li> </ol> <p>\u6267\u884c<code>CREATE TABLESPACE</code>\u8bed\u53e5\u4f1a\u5728\u6307\u5b9a\u7684\u76ee\u5f55\u4e0b\u521b\u5efa\u8868\u7a7a\u95f4\u3002\u5728\u8be5\u76ee\u5f55\u4e0b\u8fd8\u4f1a\u521b\u5efa\u7248\u672c\u7279\u5b9a\u7684\u5b50\u76ee\u5f55\u3002\u7248\u672c\u7279\u5b9a\u7684\u547d\u540d\u65b9\u5f0f\u4e3a\uff1a<code>PG_'Major version'_'Catalogue version number'</code></p> <pre><code>$ mkdir -p /home/postgres/tblspc\n$ psql\npsql (12.13)\nType \"help\" for help.\n\npostgres=# CREATE TABLESPACE new_tblspc LOCATION '/home/postgres/tblspc';\nCREATE TABLESPACE\npostgres=# \\q\n$ ls /home/postgres/tblspc\nPG_12_201909212\n</code></pre> <p>\u8868\u7a7a\u95f4\u76ee\u5f55\u901a\u8fc7pg_tblspc\u5b50\u76ee\u5f55\u4e2d\u7684\u7b26\u53f7\u94fe\u63a5\u5bfb\u5740\uff0c\u94fe\u63a5\u540d\u79f0\u4e0e\u8868\u7a7a\u95f4\u7684oid\u503c\u76f8\u540c\u3002</p> <pre><code>postgres=# select oid,spcname from pg_tablespace;\n  oid  |  spcname   \n-------+------------\n  1663 | pg_default\n  1664 | pg_global\n 16390 | new_tblspc\n(3 rows)\n$ ls -l $PGDATA/pg_tblspc\ntotal 0\nlrwxrwxrwx. 1 postgres postgres 21 Nov 15 22:48 16390 -&gt; /home/postgres/tblspc\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#31","title":"3.1  \u8868\u7a7a\u95f4\u4e0b\u521b\u5efa\u65b0\u5e93","text":"<p>\u5982\u679c\u5728\u8be5\u8868\u7a7a\u95f4\u4e0b\u521b\u5efa\u65b0\u7684\u6570\u636e\u5e93\uff08oid\u4e3a16387\uff09\uff0c\u5219\u4f1a\u5728\u7248\u672c\u7279\u5b9a\u7684\u5b50\u76ee\u5f55\u4e0b\u521b\u5efa\u76f8\u5e94\u7684\u76ee\u5f55\u3002</p> <pre><code>[postgres@pg1 ~]$ psql\npsql (12.13)\nType \"help\" for help.\n\npostgres=# CREATE DATABASE newdb TABLESPACE new_tblspc;\n$ ls -l /home/postgres/tblspc/PG_12_201909212/\ntotal 12\ndrwx------. 2 postgres postgres 8192 Nov 15 22:54 16391\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#33","title":"3.3 \u8868\u7a7a\u95f4\u4e0b\u521b\u5efa\u65b0\u8868","text":"<p>\u5982\u679c\u5728\u8be5\u8868\u7a7a\u95f4\u5185\u521b\u5efa\u4e00\u4e2a\u65b0\u8868\uff0c\u4f46\u65b0\u8868\u6240\u5c5e\u7684\u6570\u636e\u5e93\u5374\u521b\u5efa\u5728\u57fa\u7840\u76ee\u5f55\u4e0b\uff0c\u90a3\u4e48 PG \u4f1a\u9996\u5148\u5728\u7248\u672c\u7279\u5b9a\u7684\u5b50\u76ee\u5f55\u4e0b\u521b\u5efa\u540d\u79f0\u4e0e\u73b0\u6709\u6570\u636e\u5e93oid\u76f8\u540c\u7684\u65b0\u76ee\u5f55\uff0c\u7136\u540e\u5c06\u65b0\u8868\u6587\u4ef6\u653e\u7f6e\u5728\u521a\u521b\u5efa\u7684\u76ee\u5f55\u4e0b\u3002</p> <pre><code>postgres=# CREATE TABLE newtbl(id int) TABLESPACE new_tblspc;\nCREATE TABLE\npostgres=# SELECT pg_relation_filepath('newtbl');\n            pg_relation_filepath             \n---------------------------------------------\n pg_tblspc/16390/PG_12_201909212/13593/16392\n</code></pre>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#_2","title":"\u4e8c\u3001\u8fdb\u7a0b\u7ed3\u6784","text":"<pre><code>$ ps -u postgres -o pid,ppid,cmd --forest\n   PID   PPID CMD\n 17655  17654 -bash\n 17969  17655  \\_ ps -u postgres -o pid,ppid,cmd --forest\n 17721      1 /opt/software/postgresql/12.13/bin/postgres\n 17723  17721  \\_ postgres: checkpointer   \n 17724  17721  \\_ postgres: background writer   \n 17725  17721  \\_ postgres: walwriter   \n 17726  17721  \\_ postgres: autovacuum launcher   \n 17727  17721  \\_ postgres: stats collector   \n 17728  17721  \\_ postgres: logical replication launcher \n</code></pre> <p>\u91c7\u7528\u591a\u8fdb\u7a0b\u67b6\u6784\uff0c\u5305\u542b\u4e0b\u5217\u8fdb\u7a0b\uff1a</p> <ol> <li>Postgres\u670d\u52a1\u5668\u8fdb\u7a0b\uff08postgres server process\uff09\u662f\u6240\u6709\u6570\u636e\u5e93\u96c6\u7c07\u7ba1\u7406\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u3002</li> <li>\u6bcf\u4e2a\u540e\u7aef\u8fdb\u7a0b\uff08backend process\uff09\u8d1f\u8d23\u5904\u7406\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u67e5\u8be2\u548c\u8bed\u53e5\u3002</li> <li>\u5404\u79cd\u540e\u53f0\u8fdb\u7a0b\uff08background process\uff09\u8d1f\u8d23\u6267\u884c\u5404\u79cd\u6570\u636e\u5e93\u7ba1\u7406\u4efb\u52a1\uff08\u4f8b\u5982\u6e05\u7406\u8fc7\u7a0b\u4e0e\u5b58\u6863\u8fc7\u7a0b\uff09\u3002</li> <li>\u5404\u79cd\u590d\u5236\u76f8\u5173\u8fdb\u7a0b\uff08replication associated process\uff09\u8d1f\u8d23\u6d41\u590d\u5236\u3002</li> <li>\u540e\u53f0\u5de5\u4f5c\u8fdb\u7a0b\uff08background worker process\uff09\u57289.3\u7248\u672c\u4e2d\u88ab\u5f15\u5165\uff0c\u5b83\u80fd\u6267\u884c\u4efb\u610f\u7531\u7528\u6237\u5b9e\u73b0\u7684\u5904\u7406\u903b\u8f91\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#1-postgres","title":"1. Postgres\u670d\u52a1\u5668\u8fdb\u7a0b","text":"<ol> <li>postgres\u670d\u52a1\u5668\u8fdb\u7a0b\u662fPostgreSQL\u670d\u52a1\u5668\u4e2d\u6240\u6709\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\uff0c\u5728\u65e9\u671f\u7248\u672c\u4e2d\u88ab\u79f0\u4e3a\u201cpostmaster\u201d\u3002</li> <li>\u6267\u884cpg_ctl\u542f\u52a8\u4e00\u4e2apostgres\u670d\u52a1\u5668\u8fdb\u7a0b\u3002\u5b83\u4f1a\u5728\u5185\u5b58\u4e2d\u5206\u914d\u5171\u4eab\u5185\u5b58\u533a\u57df\u3002</li> <li>\u4e00\u4e2apostgres\u670d\u52a1\u5668\u8fdb\u7a0b\u53ea\u4f1a\u76d1\u542c\u4e00\u4e2a\u7f51\u7edc\u7aef\u53e3\uff0c\u9ed8\u8ba4\u7aef\u53e3\u4e3a5432\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#2_1","title":"2. \u540e\u7aef\u8fdb\u7a0b","text":"<ol> <li> <p>\u6bcf\u4e2a\u540e\u7aef\u8fdb\u7a0b\uff08\u4e5f\u79f0\u4e3a\u201cpostgres\u201d\uff09\u7531 postgres \u670d\u52a1\u5668\u8fdb\u7a0b\u542f\u52a8\uff0c\u5e76\u5904\u7406\u8fde\u63a5\u53e6\u4e00\u4fa7\u7684\u5ba2\u6237\u7aef\u53d1\u51fa\u7684\u6240\u6709\u67e5\u8be2\u3002</p> </li> <li> <p>PostgreSQL\u5141\u8bb8\u591a\u4e2a\u5ba2\u6237\u7aef\u540c\u65f6\u8fde\u63a5\uff0c\u914d\u7f6e\u53c2\u6570max_connections\u7528\u4e8e\u63a7\u5236\u6700\u5927\u5ba2\u6237\u7aef\u8fde\u63a5\u6570\uff08\u9ed8\u8ba4\u4e3a100\uff09\u3002</p> </li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#3_1","title":"3. \u540e\u53f0\u8fdb\u7a0b","text":"\u8fdb\u7a0b \u63cf\u8ff0 background writer \u672c\u8fdb\u7a0b\u8d1f\u8d23\u5c06\u5171\u4eab\u7f13\u51b2\u6c60\u4e2d\u7684\u810f\u9875\u9010\u6e10\u5237\u5165\u6301\u4e45\u5316\u5b58\u50a8\u4e2d\uff08\u4f8b\u5982\uff0cHDD\u3001SSD\uff09 checkpointer \u57289.2\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u8be5\u8fdb\u7a0b\u8d1f\u8d23\u5904\u7406\u68c0\u67e5\u70b9 autovacuum launcher \u5468\u671f\u6027\u5730\u542f\u52a8\u81ea\u52a8\u6e05\u7406\u5de5\u4f5c\u8fdb\u7a0b\uff0c\u66f4\u51c6\u786e\u5730\u8bf4\uff0c\u5b83\u5411postgres\u670d\u52a1\u5668\u8bf7\u6c42\u521b\u5efa\u767d\u52a8\u6e05\u7406\u5de5\u4f5c\u8fdb\u7a0b WAL writer \u672c\u8fdb\u7a0b\u5468\u671f\u6027\u5730\u5c06WAL\u7f13\u51b2\u533a\u4e2d\u7684WAL\u6570\u636e\u5237\u5165\u6301\u4e45\u5b58\u50a8\u4e2d statistics collector \u672c\u8fdb\u7a0b\u8d1f\u8d23\u6536\u96c6\u7edf\u8ba1\u4fe1\u606f\uff0c\u7528\u4e8e\u8bf8\u5982pg_stat_activity\u3001pg_stat_database\u7b49\u7cfb\u7edf\u89c6\u56fe logging collector \uff08logger) \u672c\u8fdb\u7a0b\u8d1f\u8d23\u5c06\u9519\u8bef\u6d88\u606f\u5199\u5165\u65e5\u5fd7\u6587\u4ef6 archiver \u672c\u8fdb\u7a0b\u8d1f\u8d23\u5c06\u65e5\u5fd7\u5f52\u6863"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#_3","title":"\u4e09\u3001\u903b\u8f91\u7ed3\u6784","text":"<p>Postgres\u6570\u636e\u5e93\u96c6\u7fa4\u662f\u7531PostgreSQL\u670d\u52a1\u5668\u7ba1\u7406\u7684\u6570\u636e\u5e93\u7684\u96c6\u5408\u3002PostgresQL\u4e2d\u7684\u201c\u6570\u636e\u5e93\u96c6\u201d\u4e00\u8bcd\u5e76\u4e0d\u610f\u5473\u7740\u201c\u4e00\u7ec4\u6570\u636e\u5e93\u670d\u52a1\u5668\u201d\u3002PostgreSQL\u670d\u52a1\u5668\u5728\u5355\u4e2a\u4e3b\u673a\u4e0a\u8fd0\u884c\uff0c\u5e76\u7ba1\u7406\u5355\u4e2a\u6570\u636e\u5e93\u7fa4\u96c6\u3002 \u6570\u636e\u5e93\u662f\u6570\u636e\u5e93\u5bf9\u8c61\u7684\u96c6\u5408\u3002\u5728\u5173\u7cfb\u6570\u636e\u5e93\u7406\u8bba\u4e2d\uff0c\u6570\u636e\u5e93\u5bf9\u8c61\u662f\u7528\u6765\u5b58\u50a8\u6216\u5f15\u7528\u6570\u636e\u7684\u6570\u636e\u7ed3\u6784\u3002\u5806(heap\uff09\u8868\u662f\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff0c\u5b83\u6709\u5f88\u591a\u7c7b\u4f3c\u4e8e\u7d22\u5f15\u3001\u5e8f\u5217\u3001\u56fe\u3001\u51fd\u6570\u7b49\u7b49\u3002\u5728PostgresQL\u4e2d\uff0c\u6570\u636e\u5e93\u672c\u8eab\u4e5f\u662f\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5728\u903b\u8f91\u4e0a\u5f7c\u6b64\u5206\u79bb\u3002</p>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#_4","title":"\u56db\u3001\u5185\u5b58\u7ed3\u6784","text":"<p>PostgreSQL\u7684\u5185\u5b58\u67b6\u6784\u53ef\u4ee5\u5206\u4e3a\u4e24\u4e2a\u90e8\u5206\uff1a</p> <ol> <li>\u672c\u5730\u5185\u5b58\u533a\u57df\u2014\u2014\u7531\u6bcf\u4e2a\u540e\u7aef\u8fdb\u7a0b\u5206\u914d\uff0c\u4f9b\u81ea\u5df1\u4f7f\u7528\uff0c\u7528\u4e8e\u67e5\u8be2\u5904\u7406\u3002</li> <li>\u5171\u4eab\u5185\u5b58\u533a\u57df\u2014\u2014\u4f9bPostgreSQL\u670d\u52a1\u5668\u7684\u6240\u6709\u8fdb\u7a0b\u4f7f\u7528\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#1_1","title":"1. \u672c\u5730\u5185\u5b58\u533a","text":"\u5b50\u533a\u57df \u63cf\u8ff0 work_mem \u6267\u884c\u5668\u5728\u6267\u884cORDER BY\u548cDISTINCT\u65f6\u4f7f\u7528\u8be5\u533a\u57df\u5bf9\u5143\u7ec4\u505a\u6392\u5e8f\uff0c\u4ee5\u53ca\u5b58\u50a8\u5f52\u5e76\u8fde\u63a5\u548c\u6563\u5217\u8fde\u63a5\u4e2d\u7684\u8fde\u63a5\u8868 maintenance_work mem \u67d0\u4e9b\u7c7b\u578b\u7684\u7ef4\u62a4\u64cd\u4f5c\u4f7f\u7528\u8be5\u533a\u57df\uff08\u4f8b\u5982VACUUM\u3001REINDEX\uff09 temp_buffers \u6267\u884c\u5668\u4f7f\u7528\u6b64\u533a\u57df\u5b58\u50a8\u4e34\u65f6\u8868"},{"location":"databases/PostgreSQL/%E5%8E%9F%E7%90%86/%E6%9E%B6%E6%9E%84/#2_2","title":"2. \u5171\u4eab\u5185\u5b58\u533a","text":"\u5b50\u533a\u57df \u63cf\u8ff0 shared buffer pool PostgreSQL\u5c06\u8868\u548c\u7d22\u5f15\u4e2d\u7684\u9875\u9762\u4ece\u6301\u4e45\u5b58\u50a8\u52a0\u8f7d\u81f3\u6b64\uff0c\u5e76\u76f4\u63a5\u64cd\u4f5c\u5b83\u4eec WAL buffer \u4e3a\u786e\u4fdd\u670d\u52a1\u6545\u969c\u4e0d\u4f1a\u5bfc\u81f4\u4efb\u4f55\u6570\u636e\u4e22\u5931\uff0cPostgreSQL\u5b9e\u73b0\u4e86WAL\u673a\u5236\u3002WAL\u6570\u636e\uff08\u4e5f\u79f0\u4e3aXLOG\u8bb0\u5f55\uff09\u662fPostgreSQL\u4e2d\u7684\u4e8b\u52a1\u65e5\u5fd7\uff1aWAL\u7f13\u51b2\u533a\u662fWAL\u6570\u636e\u5728\u5199\u5165\u6301\u4e45\u5b58\u50a8\u4e4b\u524d\u7684\u7f13\u51b2\u533a commit log \u63d0\u4ea4\u65e5\u5fd7\uff08CommitLog\uff0cCLOG\uff09\u4e3a\u5e76\u53d1\u63a7\u5236\uff08CC\uff09\u673a\u5236\u4fdd\u5b58\u4e86\u6240\u9700\u7684\u6240\u6709\u4e8b\u52a1\u72b6\u6001\uff08\u4f8b\u5982\u8fdb\u884c\u4e2d\u3001\u5df2\u63d0\u4ea4\u3001\u5df2\u4e2d\u6b62\u7b49\uff09 <p>\u9664\u4e86\u4e0a\u9762\u8fd9\u4e9b\uff0cPostgreSQL\u8fd8\u5206\u914d\u4e86\u4ee5\u4e0b\u51e0\u4e2a\u533a\u57df\uff1a</p> <ul> <li>\u7528\u4e8e\u8bbf\u95ee\u63a7\u5236\u673a\u5236\u7684\u5b50\u533a\u57df\uff08\u4f8b\u5982\u4fe1\u53f7\u91cf\u3001\u8f7b\u91cf\u7ea7\u9501\u3001\u5171\u4eab\u548c\u6392\u4ed6\u9501\u7b49\uff09\u3002</li> <li>\u5404\u79cd\u540e\u53f0\u8fdb\u7a0b\u4f7f\u7528\u7684\u5b50\u533a\u57df\uff0c\u4f8b\u5982checkpointer\u548cautovacuum\u3002</li> <li>\u7528\u4e8e\u4e8b\u52a1\u5904\u7406\u7684\u5b50\u533a\u57df\uff0c\u4f8b\u5982\u4fdd\u5b58\u70b9\u4e0e\u4e24\u9636\u6bb5\u63d0\u4ea4\uff082PC\uff09\u3002</li> </ul>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/","title":"PITR","text":"<p>PITR(Point-in-Time Recovery)\uff0c\u57fa\u4e8e\u65f6\u95f4\u70b9\u7684\u6062\u590d\uff0c\u53ef\u4ee5\u6062\u590dbasebackup\u65f6\uff0c\u7531pg_backup_start\u521b\u5efa\u70b9REDO\u70b9\u5230\u4e4b\u540e\u4efb\u610f\u65f6\u95f4\u7684\u6570\u636e\u3002 </p> <p></p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#pirt","title":"\u4e00\u3001PIRT\u7684\u6062\u590d\u6d41\u7a0b","text":"<ol> <li>\u4f7f\u7528\u5185\u90e8\u51fd\u6570read_backup_label \u4ecebackup_label\u6587\u4ef6\u4e2d\u8bfb\u53d6CHECKPOINT LOCATION\u7684\u503c\u3002</li> <li>\u4ecepostgresql.conf\u4e2d\u8bfb\u53d6restore_command\u548crecovery_target_time\u7684\u503c\u3002</li> <li>\u7528\u4eceCHECKPOINT LOCATION\u83b7\u53d6\u7684REDO\u70b9\u91cd\u653e WAL \u6570\u636e\uff0c\u6267\u884crestore_command\u4e2d\u914d\u7f6e\u7684\u547d\u4ee4\uff0c\u5c06\u5f52\u6863\u65e5\u5fd7\u4ece\u5f52\u6863\u533a\u57df\u590d\u5236\u5230\u4e34\u65f6\u533a\u57df\uff0c\u5e76\u4ece\u4e2d\u8bfb\u53d6 WAL \u6570\u636e\uff0c\u590d\u5236\u5230\u4e34\u65f6\u533a\u57df\u4e2d\u7684\u65e5\u5fd7\u6587\u4ef6\u4f1a\u5728\u4f7f\u7528\u540e\u88ab\u5220\u9664\u3002     \u5982\u679c\u53c2\u6570recovery_target_time\u8bbe\u7f6e\u4e86\u65f6\u95f4\u6233\uff0c\u4f1a\u4eceREDO\u70b9\u8bfb\u53d6\u5e76\u91cd\u653eWAL\u6570\u636e\uff0c\u76f4\u5230\u8bbe\u7f6e\u7684\u65f6\u95f4\u6233\u4e3a\u6b62\u3002\u5982\u679cpostgresql.conf\u4e2d\u6ca1\u6709\u914d\u7f6erecovery_target\uff0c\u5219\u5c06\u91cd\u653e\u81f3\u5f52\u6863\u65e5\u5fd7\u7684\u672b\u5c3e\u3002</li> <li>\u5f53\u6062\u590d\u8fc7\u7a0b\u5b8c\u6210\u65f6\uff0c\u4f1a\u5728pg_wal\u4e2d\u521b\u5efa\u65f6\u95f4\u7ebf\u5386\u53f2\u6587\u4ef6\uff0c\u598200000002.history\u3002\u5982\u679c\u542f\u7528\u4e86\u65e5\u5fd7\u5f52\u6863\u529f\u80fd\uff0c\u5219\u8fd8\u4f1a\u5728\u5f52\u6863\u76ee\u5f55\u4e2d\u521b\u5efa\u76f8\u540c\u7684\u547d\u540d\u6587\u4ef6\u3002</li> </ol> <p>PIRT\u7684\u6062\u590d\u8fc7\u7a0b\u4e0e\u5e38\u89c4\u7684\u5b8c\u5168\u6062\u590d\u8fc7\u7a0b\u57fa\u672c\u4e00\u81f4\uff0c\u533a\u522b\u6709\u4e24\u70b9\uff1a</p> <ol> <li>\u8bfb\u53d6WAL/\u5f52\u6863\u65e5\u5fd7\u7684\u4f4d\u7f6e\u4e0d\u540c\uff1a\u5e38\u89c4\u7684\u6062\u590d\u6a21\u5f0f\u4e0b\uff0c\u4ece\u6570\u636e\u76ee\u5f55\u4e0b\u7684pg_wal\u4e2d\u8bfb\u53d6\uff0cPITR\u6a21\u5f0f\u4e0b\uff0c\u4ece archive_command \u6307\u5b9a\u7684\u5f52\u6863\u76ee\u5f55\u4e0b\u83b7\u53d6</li> <li>\u8bfb\u53d6checkpoint\u7684\u4f4d\u7f6e\u4e0d\u540c\uff1a\u5e38\u89c4\u7684\u6062\u590d\u6a21\u5f0f\u4e0b\uff0c\u4ecepg_control\u4e2d\u8bfb\u53d6\uff0cPITR\u6a21\u5f0f\u4e0b\u4ecebackup_label\u6587\u4ef6\u4e2d\u83b7\u53d6\u3002</li> </ol> <p>\u4f8b\u5982\u5728\u4e0a\u4e00\u6b21\u7684\u5168\u91cf\u6062\u590d\u540e\uff0c\u572812:15:00\u65f6\u95f4\u70b9\u53c8\u72af\u4e86\u4e00\u4e2a\u9519\u8bef\uff0c\u9519\u8bef\u53d1\u751f\u5728\u65f6\u95f4\u7ebfID\u4e3a2\u7684\u6570\u636e\u5e93\u96c6\u7c07\u4e0a\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u4e3a\u4e86\u6062\u590d\u6570\u636e\u5e93\uff0c\u9700\u8981\u5728postgresql.conf\u4e2d\u6307\u5b9a\u53c2\u6570 recovery_target_time\u548crecovery_target_timeline\u3002\u91cd\u542fPostgreSQL\u670d\u52a1\u5668\u5e76\u8fdb\u5165PITR\u6a21\u5f0f\uff0c\u6570\u636e\u5e93\u4f1a\u6cbf\u7740\u65f6\u95f4\u7ebf\u6807\u8bc62\u8fdb\u884c\u6062\u590d\u3002</p> <pre><code>recovery_target_time = \"2023-2-1 12:15:00 GMT\"\nrecovery_target_timeline = 2\n</code></pre> <p> </p> <ul> <li>(1) PostgreSQL reads the value of \u2018CHECKPOINT LOCATION\u2019 from the backup_label file.</li> <li>(2) Some values of parameters are read from the recovery.conf; in this example, restore_command, recovery_target_time, and recovery_target_timeline.</li> <li>(3) PostgreSQL reads the timeline history file \u201800000002.history\u2019 which is corresponding to the value of the parameter recovery_target_timeline.</li> <li>(4) PostgreSQL does replaying WAL data by the following steps:<ul> <li>\\1. From the REDO point to the LSN \u20180/A000198\u2019 which is written in the 00000002.history file, PostgreSQL reads and replays WAL data of appropriate archive logs whose timelineId is 1.</li> <li>\\2. From the one after LSN \u20180/A000198\u2019 to the one before the timestamp \u20182023-2-1 12:15:00\u2019, PostgreSQL reads and replays WAL data (of appropriate archive logs) whose timelineId is 2.</li> </ul> </li> <li>(5) When the recovery process completes, the current timelineId will advance to 3, and new timeline history file named 00000003.history is created in the pg_xlog subdirectory (pg_wal subdirectory if version 10 or later) and the archival directory.</li> <li> <p>```     postgres&gt; cat /home/postgres/archivelogs/00000003.history     1         0/A000198     before 2023-2-1 12:05:00.861324+00</p> <p>2         0/B000078     before 2023-2-1 12:15:00.927133+00 ```</p> </li> </ul> <p>When you do PITR more than once, you should explicitly set a timelineId for using the appropriate timeline history file.</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#pitr","title":"\u4e8c\u3001PITR\u7684\u6062\u590d\u5b9e\u9a8c","text":"<p>\u57fa\u4e8e\u4e0a\u4e00\u7bc7\u5df2\u7ecf\u6062\u590d\u8fc7\u4e00\u6b21\u7684\u6570\u636e\u5e93\u8fdb\u884c\u64cd\u4f5c\u3002</p> <p>\u51c6\u5907\u6570\u636e</p> <pre><code>postgres=# create table tbl(id int, name varchar(20));\nCREATE TABLE\npostgres=# insert into tbl values(1,'a'),(2,'b'),(3,'c');\nINSERT 0 3\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#1-recovery_target_time","title":"1. recovery_target_time","text":"<p>recovery_target_time(timestramp)\uff1a\u6307\u5b9a\u6309\u65f6\u95f4\u6233\u6062\u590d\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#1","title":"1. \u5220\u9664\u6570\u636e","text":"<pre><code>postgres=# select current_timestamp;\n       current_timestamp       \n-------------------------------\n 2023-02-02 23:26:59.785955+08\n(1 row)\n\npostgres=# delete from tbl;\nDELETE 3\npostgres=# select * from tbl;\n id | name \n----+------\n(0 rows)\n\npostgres=# select pg_switch_wal(); -- \u5207\u6362\u65e5\u5fd7\uff0c\u4fdd\u8bc1wal\u65e5\u5fd7\u540c\u6b65\u5230\u5f52\u6863\u76ee\u5f55\n pg_switch_wal \n---------------\n 0/70134A0\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#2","title":"2. \u6062\u590d\u6570\u636e","text":"<p>\u6e05\u7406\u5f53\u524d\u6570\u636e</p> <pre><code>postgres@ubuntu:~$ pg_ctl stop\npostgres@ubuntu:~$ rm -rf $PGDATA/*\n</code></pre> <p>\u6062\u590d\u6570\u636e\u5e76\u6307\u5b9arecovery_target_time</p> <pre><code>postgres@ubuntu:~$ touch $PGDATA/recovery.signal\npostgres@ubuntu:~$ tar xf backup.tar/base.tar.gz -C $PGDATA\npostgres@ubuntu:~$ tar xf backup.tar/pg_wal.tar.gz -C $PGDATA\npostgres@ubuntu:~$ echo \"recovery_target_time = '2023-02-02 23:26:59.785955+08'\" &gt;&gt; $PGDATA/postgresql.conf\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#3","title":"3. \u542f\u52a8\u6570\u636e\u5e93","text":"<pre><code>postgres@ubuntu:~$ pg_ctl start\nwaiting for server to start....2023-02-02 23:30:06.035 CST [5328] LOG:  starting PostgreSQL 12.13 on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0, 64-bit\n2023-02-02 23:30:06.036 CST [5328] LOG:  listening on IPv4 address \"127.0.0.1\", port 5432\n2023-02-02 23:30:06.054 CST [5328] LOG:  listening on Unix socket \"/tmp/.s.PGSQL.5432\"\n2023-02-02 23:30:06.095 CST [5329] LOG:  database system was interrupted; last known up at 2023-01-30 22:52:08 CST\n2023-02-02 23:30:06.126 CST [5329] LOG:  restored log file \"00000002.history\" from archive\ncp: cannot stat '/home/postgres/archive/00000003.history': No such file or directory\n2023-02-02 23:30:06.131 CST [5329] LOG:  starting point-in-time recovery to 2023-02-02 23:26:59.785955+08\n2023-02-02 23:30:06.146 CST [5329] LOG:  restored log file \"00000002.history\" from archive\n2023-02-02 23:30:06.189 CST [5329] LOG:  restored log file \"000000010000000000000004\" from archive\n2023-02-02 23:30:06.231 CST [5329] LOG:  redo starts at 0/4000028\n2023-02-02 23:30:06.248 CST [5329] LOG:  consistent recovery state reached at 0/4000138\n2023-02-02 23:30:06.249 CST [5328] LOG:  database system is ready to accept read only connections\n2023-02-02 23:30:06.302 CST [5329] LOG:  restored log file \"000000010000000000000005\" from archive\n done\nserver started\npostgres@ubuntu:~$ 2023-02-02 23:30:06.380 CST [5329] LOG:  restored log file \"000000020000000000000006\" from archive\n2023-02-02 23:30:06.441 CST [5329] LOG:  restored log file \"000000020000000000000007\" from archive\n2023-02-02 23:30:06.471 CST [5329] LOG:  recovery stopping before commit of transaction 488, time 2023-02-02 23:27:19.159422+08\n2023-02-02 23:30:06.471 CST [5329] LOG:  recovery has paused\n2023-02-02 23:30:06.471 CST [5329] HINT:  Execute pg_wal_replay_resume() to continue.\n</code></pre> <p>\u8fde\u63a5\u5230\u6570\u636e\u5e93\u9a8c\u8bc1\u6570\u636e\u662f\u5426\u6062\u590d</p> <pre><code>postgres=# select * from tbl; -- \u5220\u9664\u7684\u6570\u636e\u6062\u590d\u6210\u529f\n id | name \n----+------\n  1 | a\n  2 | b\n  3 | c\n(3 rows)\n</code></pre> <p>\u63a5\u89e6\u6682\u505c\u72b6\u6001</p> <pre><code>postgres=# select pg_wal_replay_resume();\n pg_wal_replay_resume \n----------------------\n\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#2-recovery_target_name","title":"2. recovery_target_name","text":"<p>recovery_target_name(string)\uff1a\u4ecepg_create_restore_point()\u6240\u521b\u5efa\u6062\u590d\u70b9\uff0c\u8fdb\u884c\u6062\u590d\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#1_1","title":"1. \u521b\u5efa\u8fd8\u539f\u70b9","text":"<pre><code>postgres=# select * from tbl;\n id | name \n----+------\n  1 | a\n  2 | b\n  3 | c\n(3 rows)\n\npostgres=# select pg_create_restore_point('rp1'); -- \u521b\u5efa\u8fd8\u539f\u70b9\n pg_create_restore_point \n-------------------------\n 0/7013400\n(1 row)\n\npostgres=# drop table tbl;\nDROP TABLE\npostgres=# select pg_switch_wal();\n pg_switch_wal \n---------------\n 0/701AD88\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#2_1","title":"2. \u6062\u590d\u6570\u636e","text":"<pre><code>postgres@ubuntu:~$ touch $PGDATA/recovery.signal\npostgres@ubuntu:~$ tar xf backup.tar/base.tar.gz -C $PGDATA\npostgres@ubuntu:~$ tar xf backup.tar/pg_wal.tar.gz -C $PGDATA\npostgres@ubuntu:~$ echo \"recovery_target_name = 'rp1'\" &gt;&gt; $PGDATA/postgresql.conf\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#3_1","title":"3. \u542f\u52a8\u6570\u636e\u5e93","text":"<pre><code>postgres@ubuntu:~$ pg_ctl start\nwaiting for server to start....2023-02-02 23:48:09.528 CST [81978] LOG:  starting PostgreSQL 12.13 on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0, 64-bit\n2023-02-02 23:48:09.559 CST [81978] LOG:  listening on IPv4 address \"127.0.0.1\", port 5432\n2023-02-02 23:48:09.584 CST [81978] LOG:  listening on Unix socket \"/tmp/.s.PGSQL.5432\"\n2023-02-02 23:48:09.648 CST [81979] LOG:  database system was interrupted; last known up at 2023-01-30 22:52:08 CST\n2023-02-02 23:48:09.669 CST [81979] LOG:  restored log file \"00000002.history\" from archive\n2023-02-02 23:48:09.674 CST [81979] LOG:  restored log file \"00000003.history\" from archive\ncp: cannot stat '/home/postgres/archive/00000004.history': No such file or directory\n2023-02-02 23:48:09.678 CST [81979] LOG:  starting point-in-time recovery to \"rp1\"\n2023-02-02 23:48:09.684 CST [81979] LOG:  restored log file \"00000003.history\" from archive\n2023-02-02 23:48:09.720 CST [81979] LOG:  restored log file \"000000010000000000000004\" from archive\n2023-02-02 23:48:09.744 CST [81979] LOG:  restored log file \"00000002.history\" from archive\n2023-02-02 23:48:09.805 CST [81979] LOG:  redo starts at 0/4000028\n2023-02-02 23:48:09.821 CST [81979] LOG:  consistent recovery state reached at 0/4000138\n2023-02-02 23:48:09.822 CST [81978] LOG:  database system is ready to accept read only connections\n done\nserver started\npostgres@ubuntu:~$ 2023-02-02 23:48:09.857 CST [81979] LOG:  restored log file \"000000010000000000000005\" from archive\n2023-02-02 23:48:09.915 CST [81979] LOG:  restored log file \"000000020000000000000006\" from archive\n2023-02-02 23:48:09.952 CST [81979] LOG:  restored log file \"000000030000000000000007\" from archive\n2023-02-02 23:48:09.975 CST [81979] LOG:  recovery stopping at restore point \"rp1\", time 2023-02-02 23:44:09.828934+08\n2023-02-02 23:48:09.975 CST [81979] LOG:  recovery has paused\n2023-02-02 23:48:09.975 CST [81979] HINT:  Execute pg_wal_replay_resume() to continue.\n</code></pre> <p>\u8fde\u63a5\u5230\u6570\u636e\u5e93\u9a8c\u8bc1\u6570\u636e\u662f\u5426\u6062\u590d</p> <pre><code>postgres=# select * from tbl; -- \u5220\u9664\u7684\u6570\u636e\u6062\u590d\u6210\u529f\n id | name \n----+------\n  1 | a\n  2 | b\n  3 | c\n(3 rows)\n</code></pre> <p>\u63a5\u89e6\u6682\u505c\u72b6\u6001</p> <pre><code>postgres=# select pg_wal_replay_resume();\n pg_wal_replay_resume \n----------------------\n\n(1 row)\n</code></pre> <p>\u6b64\u65f6\u6570\u636e\u5e93\u65f6\u95f4\u7ebf\u4e3a4</p> <pre><code>postgres@ubuntu:~$ cat $PGDATA/pg_wal/00000004.history \n1   0/6000000   no recovery target specified\n\n2   0/70132E8   before 2023-02-02 23:27:19.159422+08\n\n\n3   0/7013400   at restore point \"rp1\"\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#3-recovery_target_xid","title":"3. recovery_target_xid","text":"<p>recovery_target_xid(string)\uff1a\u6309\u4e8b\u7269ID\u8fdb\u884c\u6062\u590d\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/PITR/#4-revovery_target_lsn","title":"4. revovery_target_lsn","text":"<p>revovery_target_lsn(lsn_log)\uff1a\u6309\u7ee7\u7eed\u8fdb\u884c\u7684WAL\u65e5\u5fd7\u4f4d\u7f6e\u7684LSN\u8fdb\u884c\u6062\u590d\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/","title":"basebackup","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#pg_basebackup","title":"\u4e00\u3001pg_basebackup","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#1","title":"1. \u5907\u4efd\u539f\u7406","text":"<p>pg_basebackup\u5de5\u5177\u81ea\u52a8\u6267\u884cpg_start_backup()\u548cpg_stop_backup()\u51fd\u6570\uff0c\u800c\u4e14\u5907\u4efd\u901f\u5ea6\u6bd4\u624b\u52a8\u5907\u4efd\u66f4\u5feb\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#1_1","title":"1. \u5907\u4efd\u524d\u63d0","text":"<p>\u6570\u636e\u5e93\u5904\u4e8e\u5f52\u6863\u6a21\u5f0f</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#2","title":"2. \u5907\u4efd\u65b9\u5f0f","text":"<ol> <li>\u4ea7\u751f\u538b\u7f29\u7684tar\u5305\uff1a<code>pg_basebackup -D backup.tar -Ft -z -P</code></li> <li>\u4ea7\u751f\u4e0e\u6e90\u6587\u4ef6\u4e00\u6837\u7684\u683c\u5f0f\uff1a<code>pg_basebackup\u00a0-D\u00a0backup\u00a0-Fp\u00a0-P</code>\uff0c\u6b64\u5907\u4efd\u65b9\u5f0f\u5757\uff0c\u4f46\u662f\u4e0d\u8282\u7701\u7a7a\u95f4</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#3","title":"3. \u5907\u4efd\u8fc7\u7a0b","text":"<ol> <li> <p>Issue the pg_start_backup command</p> <ol> <li> <p>Force into the full-page write mode</p> </li> <li> <p>Switch to the current WAL segment file</p> </li> <li> <p>Do checkpoint</p> </li> <li> <p>Creat a backup_label file</p> <p>backup_label\u4e0ebase\u76ee\u5f55\u540c\u7ea7\uff0c\u5305\u542b\u5907\u4efd\u7684\u57fa\u672c\u4fe1\u606f</p> <pre><code>CHECKPOINT LOCATION \u2013 \u8bb0\u5f55\u521b\u5efa\u7684\u68c0\u67e5\u70b9\u7684LSN\u4f4d\u7f6e\nSTART WAL LOCATION \u2013 \u4e0e\u6d41\u590d\u5236\u4e00\u8d77\u4f7f\u7528\uff0c\u5904\u4e8e\u590d\u5236\u6a21\u5f0f\u7684\u5907\u670d\u52a1\u5668\u5728\u521d\u59cb\u542f\u52a8\u65f6\u8bfb\u53d6\u4e00\u6b21\u8be5\u503c\nBACKUP METHOD \u2013 \u57fa\u7840\u5907\u4efd\u7684\u65b9\u6cd5\uff0c\u503c\u4e3a'pg_start_backup'\u6216'pg_basebackup'\nBACKUP FROM \u2013 \u663e\u793a\u6b64\u5907\u4efd\u662f\u4ece\u4e3b\u5907\u4efd\u7684\u8fd8\u662f\u4ece\u5907\u5907\u4efd\u7684\nSTART TIME \u2013 pg_start_backup\u6267\u884c\u65f6\u7684\u65f6\u95f4\u6233\nLABEL \u2013 pg_start_backup\u65f6\u6307\u5b9a\u7684\u6807\u7b7e.\nSTART TIMELINE \u2013 \u5907\u4efd\u5f00\u59cb\u7684\u65f6\u95f4\u7ebf\uff0c\u5728pg11\u4e2d\u5f15\u5165\uff0c\u7528\u6765\u8fdb\u884c\u5065\u5168\u6027\u68c0\u67e5.\n</code></pre> </li> </ol> </li> <li> <p>Take a snapshot of the database cluster with the archiving command you want to use</p> </li> <li> <p>Issue the pg_stop_backup command</p> <ol> <li>Reset to non-full-page writes mode if it has been forcibly changed by the pg_start_backup.</li> <li>Write a XLOG record of backup end.</li> <li>Switch the WAL segment file.</li> <li>Create a backup history file \u2013 This file contains the contents of the backup_label file and the timestamp that the pg_stop_backup has been executed.</li> <li>Delete the backup_label file \u2013 The backup_label file is required for recovery from the base backup and once copied, it is not necessary in the original database cluster.</li> </ol> </li> </ol> <p> </p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#2-pg_start_backuppg_stop_backup","title":"2. \u7528<code>pg_start_backup()</code>\u548c<code>pg_stop_backup()</code>\u5907\u4efd","text":"<p>\u786e\u8ba4\u5f00\u542f\u5f52\u6863</p> <pre><code>postgres@ubuntu:~$ grep -E \"^archive|^restore\" $PGDATA/postgresql.conf\narchive_mode = on       # enables archiving; off, on, or always\narchive_command = 'test ! -f /home/postgres/archive/%f &amp;&amp; cp %p /home/postgres/archive/%f'\nrestore_command = 'cp /home/postgres/archive/%f %p'\n</code></pre> <p>\u8c03\u7528<code>pg_start_backup()</code>\u5f00\u59cb\u5907\u4efd</p> <pre><code>postgres=# select pg_start_backup('backup1');\n pg_start_backup \n-----------------\n 0/2000028\n(1 row)\n</code></pre> <p>\u6b64\u65f6$PGDATA\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u4e2abackup_label\u6587\u4ef6</p> <pre><code>postgres@ubuntu:~$ cat $PGDATA/backup_label\nSTART WAL LOCATION: 0/2000028 (file 000000010000000000000002)\nCHECKPOINT LOCATION: 0/2000060\nBACKUP METHOD: pg_start_backup\nBACKUP FROM: master\nSTART TIME: 2023-01-30 22:27:14 CST\nLABEL: backup1\nSTART TIMELINE: 1\n</code></pre> <p>\u8c03\u7528<code>pg_stop_backup()</code>\u7ed3\u675f\u5907\u4efd</p> <pre><code>postgres=# select pg_stop_backup();\nNOTICE:  all required WAL segments have been archived\n pg_stop_backup \n----------------\n 0/2000138\n(1 row)\n</code></pre> <p>\u6b64\u65f6\uff0cbackup_label\u6587\u4ef6\u88ab\u5220\u9664</p> <pre><code>postgres@ubuntu:~$ ls  $PGDATA/backup_label\nls: cannot access '/opt/software/postgresql/12.13/data/backup_label': No such file or directory\n</code></pre> <p>\u5728$PGDATA/pg_wal/\u65b0\u751f\u6210\u4e00\u4e2a<code>*.backup</code>\u7684\u6587\u4ef6</p> <pre><code>postgres@ubuntu:~$ ls -1 $PGDATA/pg_wal/\n000000010000000000000002\n000000010000000000000002.00000028.backup\n000000010000000000000003\narchive_status\npostgres@ubuntu:~$ cat $PGDATA/pg_wal/000000010000000000000002.00000028.backup\nSTART WAL LOCATION: 0/2000028 (file 000000010000000000000002)\nSTOP WAL LOCATION: 0/2000138 (file 000000010000000000000002)\nCHECKPOINT LOCATION: 0/2000060\nBACKUP METHOD: pg_start_backup\nBACKUP FROM: master\nSTART TIME: 2023-01-30 22:27:14 CST\nLABEL: backup1\nSTART TIMELINE: 1\nSTOP TIME: 2023-01-30 22:28:04 CST\nSTOP TIMELINE: 1\n</code></pre> <p>wal\u65e5\u5fd7\u5f52\u6863\u5728<code>/home/postgres/archive</code>\u76ee\u5f55\u4e0b</p> <pre><code>postgres@ubuntu:~$ ls -1 /home/postgres/archive\n000000010000000000000002\n000000010000000000000002.00000028.backup\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#3-pg_basebackup","title":"3. \u7528<code>pg_basebackup</code>\u5907\u4efd","text":"<pre><code>postgres@ubuntu:~$ pg_basebackup -D backup.tar -Ft -z -P\n23653/23653 kB (100%), 1/1 tablespace\npostgres@ubuntu:~$ ls -1 backup.tar/\nbase.tar.gz\npg_wal.tar.gz\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#4","title":"4. \u6062\u590d\u6570\u636e\u5e93","text":"<p>\u505c\u6b62\u6570\u636e\u5e93</p> <pre><code>postgres@ubuntu:~$ pg_ctl stop\nwaiting for server to shut down.... done\nserver stopped\n</code></pre> <p>\u5220\u9664$DATA/\u4e0b\u6570\u636e</p> <pre><code>postgres@ubuntu:~$ rm -rf $PGDATA/*\n</code></pre> <p>\u521b\u5efa\u7a7a\u7684recovery.signal\u6587\u4ef6\uff0c\u544a\u8bc9\u6570\u636e\u5e93\u9700\u8981recovery</p> <pre><code>postgres@ubuntu:~$ touch $PGDATA/recovery.signal\n</code></pre> <p>\u6062\u590d\u6570\u636e</p> <pre><code>postgres@ubuntu:~$ tar xf backup.tar/base.tar.gz -C $PGDATA\npostgres@ubuntu:~$ tar xf backup.tar/pg_wal.tar.gz -C $PGDATA\n</code></pre> <p>\u542f\u52a8\u6570\u636e\u5e93</p> <pre><code>postgres@ubuntu:~$ pg_ctl start -D $PGDATA -l logfile\nwaiting for server to start.... done\nserver started\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#5","title":"5. \u65f6\u95f4\u7ebf","text":"<p>\u65f6\u95f4\u7ebf\u7528\u4e8e\u533a\u5206\u539f\u59cb\u6570\u636e\u5e93\u548c\u6062\u590d\u751f\u6210\u7684\u6570\u636e\u5e93\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#51-timelineid","title":"5.1 timelineid","text":"<p>\u6bcf\u4e00\u4e2a\u65f6\u95f4\u7ebf\u90fd\u4f1a\u6709\u4e00\u4e2a\u76f8\u5e94\u7684timelineid\uff0c\u6bcf\u4e2a\u6570\u636e\u5e93\u96c6\u7c07\u90fd\u4f1a\u88ab\u6307\u5b9a\u4e00\u4e2a\u65f6\u95f4\u7ebf\u6807\u8bc6\u3002\u7531initdb\u547d\u4ee4\u521b\u5efa\u7684\u539f\u59cb\u6570\u636e\u5e93\uff0c\u5176\u65f6\u95f4\u7ebf\u6807\u8bc6\u4e3a1\u3002\u6bcf\u5f53\u6570\u636e\u5e93\u96c6\u7c07\u6062\u590d\u65f6\uff0c\u65f6\u95f4\u7ebf\u6807\u8bc6\u90fd\u4f1a\u589e\u52a01\u3002\u4f8b\u5982\uff0c\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u4ece\u539f\u59cb\u5907\u4efd\u4e2d\u6062\u590d\u5f97\u5230\u7684\u6570\u636e\u5e93\uff0c\u5176\u65f6\u95f4\u7ebf\u6807\u8bc6\u4e3a2\u3002</p> <p> </p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/basebackup/#52-histroy","title":"5.2 histroy","text":"<p>\u6062\u590d\u5b8c\u6210\u540e\uff0c\u5728\u751f\u6210timeline\u4e3a00000002\u7684\u5386\u53f2\u6587\u4ef6</p> <pre><code>postgres@ubuntu:~$ cat $PGDATA/pg_wal/00000002.history\n1   0/6000000   no recovery target specified\n# \u6570\u636e\u5e93\uff08\u65f6\u95f4\u7ebf\u6807\u8bc6\u4e3a2\uff09\u57fa\u4e8e\u65f6\u95f4\u7ebf\u6807\u8bc6\u4e3a1\u7684\u57fa\u7840\u5907\u4efd\uff0c\n# \u901a\u8fc7\u91cd\u653e\u68c0\u67e5\u70b9\u65e5\u5fd7\uff0c\u6062\u590d\u81f30/6000000\u7684\u4f4d\u7f6e\n</code></pre> <p>\u5386\u53f2\u6587\u4ef6\u5305\u542b\u4e86\u4e09\u90e8\u5206\uff1a</p> <ul> <li>timelineId \u2013 timelineId of the archive logs used to recover.</li> <li>LSN \u2013 LSN location where the WAL segment switches happened.</li> <li>reason \u2013 human-readable explanation of why the timeline was changed.</li> </ul> <p>recovery_target = 'immediate'\uff1a\u6307\u5b9a\u6062\u590d\u5e94\u8be5\u5728\u8fbe\u5230\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u540e\u5c3d\u5feb\u7ed3\u675f\uff0c\u5728\u4ece\u4e00\u4e2a\u5728\u7ebf\u5907\u4efd\u6062\u590d\u65f6\uff0c\u8fd9\u610f\u5473\u7740\u5907\u4efd\u7ed3\u675f\u7684\u90a3\u4e2a\u70b9\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/","title":"\u4e3b\u5907\u5b9e\u4f8b","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#_1","title":"\u4e00\u3001\u5b89\u88c5\u73af\u5883","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\uff1aUbuntu 18.04.5</p> \u8282\u70b9 \u89d2\u8272 192.168.1.139 \u4e3b\u8282\u70b9 192.168.1.140 \u5907\u8282\u70b9"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#postgresql","title":"\u4e8c\u3001\u5b89\u88c5PostgreSQL","text":"<p>\u4e3b\u5907\u8282\u70b9\u5b89\u88c5postgresql</p> <pre><code>apt install -y gcc make zlib1g-dev libreadline-dev\nmkdir -p /opt/package &amp;&amp; cd /opt/package\nwget https://ftp.postgresql.org/pub/source/v12.13/postgresql-12.13.tar.gz\ntar xf postgresql-12.13.tar.gz\ncd postgresql-12.13\nmkdir build_dir &amp;&amp; cd build_dir\n../configure --prefix=/opt/software/postgresql/12.13\nmake &amp;&amp; make install\nadduser --disabled-password --gecos \"\" postgres\nmkdir -p /opt/software/postgresql/12.13/data\nchown postgres:postgres /opt/software/postgresql/12.13/data\ncat &gt;&gt; /home/postgres/.bashrc &lt;&lt; \"EOF\"\nexport PGHOME=/opt/software/postgresql/12.13\nexport PATH=$PGHOME/bin:$PATH\nexport LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PGHOME/lib\nexport PGDATA=$PGHOME/data\nEOF\n</code></pre> <p>\u4e3b\u8282\u70b9\u521d\u59cb\u5316\u6570\u636e\u5e93</p> <pre><code>su - postgres -c 'initdb -D $PGDATA'\n</code></pre> <p>\u4e3b\u8282\u70b9\u542f\u52a8\u6570\u636e\u5e93</p> <pre><code>su - postgres -c 'pg_ctl start -D $PGDATA -l logfile'\n</code></pre> <p>\u5907\u8282\u70b9\u65e0\u9700\u521d\u59cb\u5316\u548c\u542f\u52a8</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#_2","title":"\u4e09\u3001\u521b\u5efa\u7528\u6237\u3001\u4fee\u6539\u914d\u7f6e","text":"<p>\u4ee5\u4e0b\u64cd\u4f5c\u5207\u6362\u5230postgre\u7528\u6237\u6267\u884c</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#1","title":"1. \u4e3b\u8282\u70b9\u521b\u5efa\u6d41\u590d\u5236\u7528\u4e8e\u53ca\u914d\u7f6e","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#11","title":"1.1 \u521b\u5efa\u6d41\u590d\u5236\u9700\u8981\u7684\u7528\u6237","text":"<pre><code>psql -c \"create role repl login replication encrypted password 'repl@123'\"\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#12-pg_hbaconfrepl","title":"1.2 \u914d\u7f6e<code>pg_hba.conf</code>\uff0c\u6dfb\u52a0repl\u7528\u6237","text":"<pre><code>echo \"host replication repl 192.168.1.142/32 trust\" &gt;&gt; $PGDATA/pg_hba.conf\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#13-postgresqlconf","title":"1.3 \u914d\u7f6e<code>postgresql.conf</code>\uff0c\u4fee\u6539\u4ee5\u4e0b\u53c2\u6570","text":"<pre><code>listen_addresses = '*'\nwal_level = replica\nmax_wal_senders = 10  # \u6d41\u590d\u5236\u5141\u8bb8\u8fde\u63a5\u8fdb\u7a0b\uff0c\u4e3b\u5907\u8bbe\u7f6e\u5fc5\u987b\u4e00\u81f4\nwal_keep_segments = 64\n\narchive_mode = on\narchive_command = 'test ! -f /home/postgres/archives/%f &amp;&amp; cp %p /home/postgres/archives/%f'\nrestore_command = 'cp /home/postgres/archives/%f %p'\nrecovery_target_timeline = 'latest'\n# \u5207\u6362\u4e3a\u5907\u5e93\u540e\uff0c\u4e3b\u5e93\u7684\u4fe1\u606f\nprimary_conninfo = 'host=192.168.1.141 port=5432 application_name=standby1 user=repl password=repl@123'\nfull_page_writes = on\nwal_log_hints = on\n\nhot_standby = on\nax_standby_archive_delay = 30s\nwal_receiver_status_interval = 10s\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#14","title":"1.4 \u91cd\u542f\u4e3b\u5e93","text":"<pre><code>pg_ctl stop\npg_ctl start -D $PGDATA -l logfile\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#2","title":"2. \u5907\u8282\u70b9\u540c\u6b65\u4e3b\u8282\u70b9\u6570\u636e\u5e76\u521b\u5efa\u5907\u5e93\u6240\u9700\u6587\u4ef6","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#21-pg_basebackup","title":"2.1 \u5728\u5907\u5e93\u4e0a\u5229\u7528pg_basebackup\uff0c\u5c06\u4e3b\u5e93\u7684\u6570\u636e\u540c\u6b65\u5230\u5907\u5e93","text":"<pre><code>pg_basebackup -h 192.168.1.141 -p 5432 -U repl -F p -P -D $PGDATA\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#22-pg_hbaconfrepl","title":"2.2 \u914d\u7f6e<code>pg_hba.conf</code>\uff0c\u6dfb\u52a0repl\u7528\u6237","text":"<pre><code>sed -i  '$c\\\\host replication repl 192.168.1.141/32 trust'  $PGDATA/pg_hba.conf\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#23-postgresqlconf","title":"2.3 \u4fee\u6539postgresql.conf\u6587\u4ef6","text":"<pre><code># \u8fde\u63a5\u5230\u4e3b\u5e93\u7684\u4fe1\u606f\nprimary_conninfo = 'host=192.168.1.141 port=5432 application_name=standby1 user=repl password=repl@123'\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#24-standbysignal","title":"2.4 \u521b\u5efa\u5907\u5e93\u6587\u4ef6<code>standby.signal</code>","text":"<pre><code>touch $PGDATA/standby.signal\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#24","title":"2.4 \u542f\u52a8\u5907\u5e93","text":"<pre><code>chmod 750 $PGDATA\npg_ctl start -D $PGDATA -l logfile\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#_3","title":"\u56db\u3001\u9a8c\u8bc1","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#1_1","title":"1. \u4e3b\u5e93\u9a8c\u8bc1","text":"<p>\u67e5\u8be2\u4e3b\u8282\u70b9\u8fdb\u7a0b</p> <pre><code>postgres@ubuntu:~$ ps -u postgres -o cmd --forest\nCMD\n-su\n \\_ psql\n-su\n \\_ ps -u postgres -o cmd --forest\n/opt/software/postgresql/12.13/bin/postgres -D /opt/software/postgresql/12.13/data\n \\_ postgres: checkpointer   \n \\_ postgres: background writer   \n \\_ postgres: walwriter   \n \\_ postgres: autovacuum launcher   \n \\_ postgres: archiver   last was 00000001000000000000000C\n \\_ postgres: stats collector   \n \\_ postgres: logical replication launcher   \n \\_ postgres: postgres postgres [local] idle\n \\_ postgres: walsender repl 192.168.1.142(44498) streaming 0/D0132C0\n</code></pre> <p>\u67e5\u770b\u540c\u6b65\u72b6\u6001</p> <pre><code>postgres=# select * from pg_is_in_recovery();\n pg_is_in_recovery \n-------------------\n f\n(1 row)\npostgres=# \\x\nExpanded display is on.\npostgres=# select * from pg_stat_replication;\n-[ RECORD 1 ]----+------------------------------\npid              | 13962\nusesysid         | 16384\nusename          | repl\napplication_name | standby1\nclient_addr      | 192.168.1.142\nclient_hostname  | \nclient_port      | 44498\nbackend_start    | 2023-02-03 17:52:05.543671+00\nbackend_xmin     | \nstate            | streaming\nsent_lsn         | 0/D0132C0\nwrite_lsn        | 0/D0132C0\nflush_lsn        | 0/D0132C0\nreplay_lsn       | 0/D0132C0\nwrite_lag        | \nflush_lag        | \nreplay_lag       | \nsync_priority    | 0\nsync_state       | async\nreply_time       | 2023-02-03 17:58:51.520936+00\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#2_1","title":"2. \u5907\u5e93\u9a8c\u8bc1","text":"<p>\u67e5\u770b\u5907\u8282\u70b9\u8fdb\u7a0b</p> <pre><code>postgres@ubuntu:~$ ps -u postgres -o cmd --forest\nCMD\n-su\n \\_ psql\n-su\n \\_ ps -u postgres -o cmd --forest\n/opt/software/postgresql/12.13/bin/postgres -D /opt/software/postgresql/12.13/data\n \\_ postgres: startup   recovering 00000001000000000000000D\n \\_ postgres: checkpointer   \n \\_ postgres: background writer   \n \\_ postgres: stats collector   \n \\_ postgres: walreceiver   streaming 0/D0132C0\n \\_ postgres: postgres postgres [local] idle\n</code></pre> <p>\u67e5\u770b\u540c\u6b65\u72b6\u6001</p> <pre><code>postgres=# select * from pg_is_in_recovery();\n pg_is_in_recovery \n-------------------\n t\n(1 row)\npostgres=# select * from pg_stat_wal_receiver;\n-[ RECORD 1 ]---------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\npid                   | 16451\nstatus                | streaming\nreceive_start_lsn     | 0/A000000\nreceive_start_tli     | 1\nreceived_lsn          | 0/D0132C0\nreceived_tli          | 1\nlast_msg_send_time    | 2023-02-03 17:59:51.949989+00\nlast_msg_receipt_time | 2023-02-03 17:59:52.008054+00\nlatest_end_lsn        | 0/D0132C0\nlatest_end_time       | 2023-02-03 17:58:51.460858+00\nslot_name             | \nsender_host           | 192.168.1.141\nsender_port           | 5432\nconninfo              | user=repl password=******** dbname=replication host=192.168.1.141 port=5432 application_name=standby1 fallback_application_name=walreceiver sslmode=disable sslcompression=0 gssencmode=disable krbsrvname=postgres target_session_attrs=any\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#_4","title":"\u4e94\u3001\u4e3b\u5907\u5207\u6362","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#1_2","title":"1. \u505c\u6b62\u4e3b\u5e93","text":"<pre><code>pg_ctl stop\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#2_2","title":"2. \u5907\u5e93\u5347\u4e3b","text":"<pre><code>pg_ctl promote\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#3-standbysignal","title":"3. \u4e3b\u8282\u70b9\u521b\u5efa<code>standby.signal</code>","text":"<pre><code>touch $PGDATA/standby.signal\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#4","title":"4. \u542f\u52a8\u4e3b\u5e93","text":"<pre><code>pg_ctl start -D $PGDATA -l logfile\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E4%B8%BB%E5%A4%87%E5%AE%9E%E4%BE%8B/#5","title":"5. \u9a8c\u8bc1\u7ed3\u679c","text":"<p>\u65b0\u4e3b\u8282\u70b9\u8fdb\u7a0b</p> <pre><code>/opt/software/postgresql/12.13/bin/postgres -D /opt/software/postgresql/12.13/data\n \\_ postgres: checkpointer   \n \\_ postgres: background writer   \n \\_ postgres: stats collector   \n \\_ postgres: postgres postgres [local] idle\n \\_ postgres: walwriter   \n \\_ postgres: autovacuum launcher   \n \\_ postgres: archiver   last was 00000001000000000000000E.partial\n \\_ postgres: logical replication launcher   \n \\_ postgres: walsender repl 192.168.1.141(53926) streaming 0/E0132B8\n</code></pre> <p>\u65b0\u5907\u8282\u70b9\u8fdb\u7a0b</p> <pre><code>/opt/software/postgresql/12.13/bin/postgres -D /opt/software/postgresql/12.13/data\n \\_ postgres: startup   recovering 00000002000000000000000E\n \\_ postgres: checkpointer   \n \\_ postgres: background writer   \n \\_ postgres: stats collector   \n \\_ postgres: postgres postgres [local] idle\n \\_ postgres: walreceiver\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/","title":"\u5355\u5b9e\u4f8b\u5b89\u88c5","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_1","title":"\u4e00\u3001\u5b89\u88c5\u73af\u5883\u51c6\u5907","text":"<p>\u5b89\u88c5\u5fc5\u8981\u7684\u4f9d\u8d56\u5305 CentOS:</p> <pre><code>yum install -y wget gcc readline-devel zlib-devel\n</code></pre> <p>Ubuntu</p> <pre><code>apt install -y gcc make zlib1g-dev libreadline-dev\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_2","title":"\u4e8c\u3001\u4e0b\u8f7d\u6e90\u7801\u5305","text":"<pre><code>mkdir -p /opt/package &amp;&amp; cd /opt/package\nwget https://ftp.postgresql.org/pub/source/v12.13/postgresql-12.13.tar.gz --no-check-certificate\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_3","title":"\u4e09\u3001\u7f16\u8bd1\u5b89\u88c5","text":"<pre><code># \u89e3\u538b\u5b89\u88c5\u5305\ncd /opt/package &amp;&amp; tar xf postgresql-12.13.tar.gz\n# \u521b\u5efa\u7f16\u8bd1\u76ee\u5f55\ncd postgresql-12.13 &amp;&amp; mkdir build_dir &amp;&amp; cd build_dir\n# \u521b\u5efa\u5b89\u88c5\u76ee\u5f55\nmkdir -p /opt/software/postgresql/12.13\n# configure\n../configure --prefix=/opt/software/postgresql/12.13\n# \u7f16\u8bd1pg\u548ccontrib\nmake world-bin\n# \u5b89\u88c5pg\u548ccontrib\nmake install-world-bin\n# \u521b\u5efapostgres\u7528\u6237\uff0c\u7528\u6765\u542f\u52a8\u6570\u636e\u5e93\nadduser postgres\n# \u521b\u5efadata\u76ee\u5f55\nmkdir -p /opt/software/postgresql/data\nchown postgres:postgres /opt/software/postgresql/data\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_4","title":"\u56db\u3001\u914d\u7f6e\u73af\u5883\u53d8\u91cf","text":"<p>\u5207\u6362\u5230postgres\u7528\u6237\u914d\u7f6e\u76f8\u5173\u73af\u5883\u53d8\u91cf</p> <pre><code>cat &gt;&gt; .bashrc &lt;&lt; \"EOF\"\nexport PGHOME=/opt/software/postgresql/12.13\nexport PATH=$PGHOME/bin:$PATH\nexport LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$PGHOME/lib\nexport PGDATA=/opt/software/postgresql/data\nEOF\nsource .bashrc\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_5","title":"\u4e94\u3001\u521d\u59cb\u5316\u6570\u636e\u5e93","text":"<pre><code>initdb\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_6","title":"\u516d\u3001\u542f\u52a8\u6570\u636e\u5e93","text":"<pre><code>pg_ctl start -l logfile\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%8D%95%E5%AE%9E%E4%BE%8B%E5%AE%89%E8%A3%85/#_7","title":"\u4e03\u3001\u505c\u6b62\u6570\u636e\u5e93","text":"<pre><code>pg_ctl stop\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/","title":"\u7269\u7406\u5907\u4efd\u6062\u590d\u4e00","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_1","title":"\u5907\u4efd\u548c\u6062\u590d\u76ee\u7684","text":"<p>\u4fdd\u62a4\u6570\u636e\u5e93\u514d\u53d7\u591a\u79cd\u7c7b\u578b\u7684\u6545\u969c \u589e\u52a0\u5e73\u5747\u6545\u969c\u95f4\u9694\u65f6\u95f4(MTBF) \u51cf\u5c11\u5e73\u5747\u6062\u590d\u65f6\u95f4(MTTR) \u6700\u5c0f\u5316\u6570\u636e\u4e22\u5931</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_2","title":"\u6545\u969c\u7c7b\u522b","text":"<p>\u8bed\u53e5\u5931\u8d25 \u7528\u6237\u8fdb\u7a0b\u5931\u8d25 \u7528\u6237\u9519\u8bef \u7f51\u7edc\u6545\u969c \u5b9e\u4f8b\u5931\u8d25 \u4ecb\u8d28\u6545\u969c \u58f0\u660e\u5931\u8d25\u7684\u539f\u56e0 \u5e94\u7528\u7a0b\u5e8f\u4e2d\u7684\u903b\u8f91\u9519\u8bef \u8bd5\u56fe\u5728\u8868\u4e2d\u8f93\u5165\u65e0\u6548\u6570\u636e \u5c1d\u8bd5\u6743\u9650\u4e0d\u8db3\u7684\u64cd\u4f5c \u8bd5\u56fe\u521b\u5efa\u8868\uff0c\u4f46\u8d85\u51fa\u4e86\u5206\u914d\u7684\u914d\u989d\u9650\u5236 \u5c1d\u8bd5\u5bf9\u8868\u6267\u884cINSERT\u6216UPDATE\u64cd\u4f5c\uff0c\u5bfc\u81f4\u5206\u914d\u6269\u5c55\u6570\u636e\u5757\uff0c\u4f46\u53ef\u7528\u7a7a\u95f4\u4e0d\u8db3</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_3","title":"\u58f0\u660e\u5931\u8d25\u7684\u89e3\u51b3\u65b9\u6848","text":"<p>\u7ea0\u6b63\u7a0b\u5e8f\u7684\u903b\u8f91\u6d41\u7a0b \u4fee\u6539\u5e76\u91cd\u65b0\u53d1\u5e03SQL\u8bed\u53e5 \u63d0\u4f9b\u5fc5\u8981\u7684\u6570\u636e\u5e93\u6743\u9650 \u5411\u6570\u636e\u5e93\u6dfb\u52a0\u6587\u4ef6\u7a7a\u95f4</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_4","title":"\u7528\u6237\u8fdb\u7a0b\u5931\u8d25\u7684\u539f\u56e0","text":"<p>\u7528\u6237\u5728\u4f1a\u8bdd\u4e2d\u6267\u884c\u4e86\u5f02\u5e38\u65ad\u5f00\u8fde\u63a5 \u7528\u6237\u7684\u4f1a\u8bdd\u5f02\u5e38\u7ec8\u6b62 \u7528\u6237\u7684\u7a0b\u5e8f\u5f15\u53d1\u4e86\u5730\u5740\u5f02\u5e38\uff0c\u4ece\u800c\u7ec8\u6b62\u4e86\u4f1a\u8bdd</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_5","title":"\u7528\u6237\u8fdb\u7a0b\u5931\u8d25\u89e3\u51b3\u65b9\u6848","text":"<p>postgres\u8fdb\u7a0b\u68c0\u6d4b\u5f02\u5e38\u7ec8\u6b62\u7684\u7528\u6237\u8fdb\u7a0b postgres\u56de\u6eda\u4e8b\u52a1\u5e76\u91ca\u653e\u5176\u6301\u6709\u7684\u6240\u6709\u8d44\u6e90\u548c\u9501</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_6","title":"\u7528\u6237\u53ef\u80fd\u7684\u5931\u8bef","text":"<pre><code>SQL&gt; DROP TABLE employees;\n\nSQL&gt; TRUNCATE TABLE employees;\n\nSQL&gt; DELETE FROM employees;\n\nSQL&gt; COMMIT;\n\nSQL&gt; UPDATE employees\n\n2&gt; SET salary = salary * 1.5;\n\nSQL&gt; COMMIT;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_7","title":"\u7528\u6237\u5931\u8bef\u89e3\u51b3\u65b9\u6848","text":"<p>\u57f9\u8bad\u6570\u636e\u5e93\u7528\u6237 \u4ece\u6709\u6548\u5907\u4efd\u6062\u590d \u4ece\u5bfc\u51fa\u6587\u4ef6\u5bfc\u5165\u8868 \u4f7f\u7528WalMiner\u786e\u5b9a\u9519\u8bef\u65f6\u95f4\uff0c\u4f7f\u7528\u65f6\u95f4\u70b9\u6062\u590d\u8fdb\u884c\u6062\u590d \u4f7f\u7528WalMiner\u6267\u884c\u5bf9\u8c61\u7ea7\u6062\u590d</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_8","title":"\u5b9e\u4f8b\u5931\u8d25\u7684\u539f\u56e0","text":"<p>\u65ad\u7535 \u64cd\u4f5c\u7cfb\u7edfbug \u6570\u636e\u5e93\u7cfb\u7edfbug \u540e\u53f0\u8fdb\u7a0b\u610f\u5916kill</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_9","title":"\u5b9e\u4f8b\u5931\u8d25\u89e3\u51b3\u65b9\u6848","text":"<p>\u4e0d\u9700\u8981DBA\u91c7\u53d6\u7279\u6b8a\u7684\u6062\u590d\u64cd\u4f5c \u542f\u52a8\u5b9e\u4f8b \u7b49\u5f85\u201c\u6570\u636e\u5e93\u6253\u5f00\u201d\u901a\u77e5 \u901a\u77e5\u7528\u6237 \u68c0\u67e5\u8b66\u62a5\u65e5\u5fd7\u4ee5\u786e\u5b9a\u6545\u969c\u539f\u56e0</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_10","title":"\u4ecb\u8d28\u5931\u8d25\u7684\u539f\u56e0","text":"<p>\u78c1\u76d8\u9a71\u52a8\u5668\u4e0a\u7684\u78c1\u5934\u635f\u574f \u8bfb\u53d6\u6216\u5199\u5165\u6570\u636e\u5e93\u6587\u4ef6\u65f6\u51fa\u73b0\u7269\u7406\u95ee\u9898 \u6587\u4ef6\u88ab\u610f\u5916\u5220\u9664</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_11","title":"\u4ecb\u8d28\u5931\u8d25\u89e3\u51b3\u65b9\u6848","text":"<p>\u6062\u590d\u7b56\u7565\u53d6\u51b3\u4e8e\u9009\u62e9\u7684\u5907\u4efd\u65b9\u6cd5\u548c\u53d7\u5f71\u54cd\u7684\u6587\u4ef6 \u5982\u679c\u53ef\u7528\uff0c\u8bf7\u5e94\u7528\u5b58\u6863\u7684\u91cd\u505a\u65e5\u5fd7\u6587\u4ef6\u4ee5\u6062\u590d\u81ea\u4e0a\u6b21\u5907\u4efd\u4ee5\u6765\u63d0\u4ea4\u7684\u6570\u636e</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_12","title":"\u5236\u5b9a\u4e00\u4e2a\u5907\u4efd\u7b56\u7565","text":"<p>\u4e1a\u52a1\u8981\u6c42 \u64cd\u4f5c\u8981\u6c42 \u6280\u672f\u6ce8\u610f\u4e8b\u9879 \u7ba1\u7406\u5c42\u540c\u610f</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#1","title":"1.\u4e1a\u52a1\u8981\u6c42","text":"<p>\u5e73\u5747\u6062\u590d\u65f6\u95f4\uff1a\u51b3\u5b9a\u5907\u4efd\u7684\u9891\u7387 \u5e73\u5747\u65e0\u6545\u969c\u65f6\u95f4\uff1a\u7f29\u77ed\u6062\u590d\u65f6\u95f4 \u8fdb\u5316\u8fc7\u7a0b\uff1a\u6839\u636e\u5b9e\u9645\u60c5\u51b5\uff0c\u4e0d\u65ad\u8c03\u6574\u7b56\u7565\uff0c\u6bd4\u5982\uff1a\u7d22\u5f15\u8868\u7a7a\u95f4\u7684\u5907\u4efd\u7b49\u7b49\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#2","title":"2.\u64cd\u4f5c\u8981\u6c42","text":"<p>24\u5c0f\u65f6\u8fd0\u8425 \u6d4b\u8bd5\u548c\u9a8c\u8bc1\u5907\u4efd\u53ef\u7528\u6027 \u6570\u636e\u5e93\u6ce2\u52a8\u6027</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#3","title":"3.\u6280\u672f\u8003\u8651\u56e0\u7d20","text":"<p>\u8d44\u6e90\uff1a\u786c\u4ef6\u3001\u8f6f\u4ef6\u3001\u4eba\u529b\u548c\u65f6\u95f4 \u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6\u7684\u7269\u7406\u6620\u50cf\u526f\u672c \u6570\u636e\u5e93\u4e2d\u5bf9\u8c61\u7684\u903b\u8f91\u526f\u672c \u6570\u636e\u5e93\u914d\u7f6e \u5f71\u54cd\u6240\u9700\u5907\u4efd\u9891\u7387\u7684\u4e8b\u52a1\u91cf</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%B8%80/#_13","title":"\u707e\u96be\u6062\u590d\u95ee\u9898","text":"<p>\u5982\u679c\u53d1\u751f\u91cd\u5927\u707e\u96be\uff0c\u5982\uff1a - \u5730\u9707\u3001\u6d2a\u6c34\u6216\u706b\u707e - \u673a\u5668\u5b8c\u5168\u4e22\u5931 - \u5b58\u50a8\u786c\u4ef6\u6216\u8f6f\u4ef6\u6545\u969c - \u5931\u53bb\u5173\u952e\u4eba\u5458\u4f8b\u5982\u6570\u636e\u5e93\u7ba1\u7406\u5458</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/","title":"\u7269\u7406\u5907\u4efd\u6062\u590d\u4e8c","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_1","title":"\u672f\u8bed","text":"<ul> <li>\u5168\u5e93\u5907\u4efd</li> <li>\u76ee\u6807\u6570\u636e\u5e93\u5904\u4e8e\u6253\u5f00\u6216\u8005\u5173\u95ed\u72b6\u6001</li> <li>\u5907\u4efd$PGDATA\u4e0b\u6240\u6709\u7684\u6570\u636e\u6587\u4ef6</li> <li>\u90e8\u5206\u5907\u4efd</li> <li>\u5907\u4efd\u9664\u4e86pg_global\u7684\u5176\u5b83\u8868\u7a7a\u95f4</li> <li>\u4e00\u81f4\u6027\u5907\u4efd</li> <li>\u4e0d\u4e00\u81f4\u6027\u5907\u4efd</li> </ul>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_2","title":"\u5907\u4efd\u5de5\u5177","text":"<p>\u4f7f\u7528\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u5bf9\u6570\u636e\u5e93\u6587\u4ef6\u8fdb\u884c\u5907\u4efd\u548c\u6062\u590d</p> <p>\u4f7f\u7528pg_basebackup\u5bf9\u6570\u636e\u5e93\u6587\u4ef6\u8fdb\u884c\u5907\u4efd</p> <p>\u4f7f\u7528pg_rman\u5bf9\u6570\u636e\u5e93\u6587\u4ef6\u8fdb\u884c\u5907\u4efd\u548c\u6062\u590d</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_3","title":"\u5907\u4efd\u6a21\u5f0f","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_4","title":"\u4e00\u81f4\u6027\u5907\u4efd(\u6570\u636e\u5e93\u5173\u95ed)","text":"<p>\u5907\u4efd$PGDATA\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6</p> <p></p> <p>\u4e00\u81f4\u6027\u5168\u5e93\u5907\u4efd\u7684\u597d\u5904</p> <ul> <li>\u6982\u5ff5\u7b80\u5355</li> <li>\u6613\u4e8e\u6267\u884c</li> <li>\u9700\u8981\u5f88\u5c11\u7684\u64cd\u4f5c\u5458\u4ea4\u4e92</li> </ul> <p>\u6267\u884c\u4e00\u81f4\u6027\u5168\u5e93\u5907\u4efd</p> <p></p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_5","title":"\u6570\u636e\u5e93\u6253\u5f00\u6a21\u5f0f\u4e0b\u5907\u4efd","text":"<p>\u6570\u636e\u5e93\u6253\u5f00\u6a21\u5f0f\u4e0b\u5907\u4efd\u597d\u5904 - \u4fdd\u6301\u9ad8\u6570\u636e\u5e93\u53ef\u7528\u6027 - \u652f\u6301\u4e0d\u95f4\u65ad\u7684\u4e1a\u52a1\u8fd0\u8425</p> <p>\u6570\u636e\u5e93\u6253\u5f00\u6a21\u5f0f\u4e0b\u5907\u4efd\u8981\u6c42</p> <p></p> <p>\u8fde\u7eed\u5f52\u6863\u662f\u5728WAL\u6bb5\u5207\u6362\u65f6\u5c06WAL\u6bb5\u6587\u4ef6\u590d\u5236\u5230\u5f52\u6863\u533a\u57df\u7684\u529f\u80fd\uff0c\u7531archiver(\u540e\u53f0)\u8fdb\u7a0b\u6267\u884c\u3002\u5176\u4e2d\uff0c\u5360\u4f4d\u7b26%p\u662f\u590d\u5236\u7684WAL\u6bb5\uff0c\u800c%f\u662f\u5b58\u6863\u65e5\u5fd7\u3002</p> <pre><code>ALTER SYSTEM SET archive_command = 'cp %p /home/postgres/archives/%f';\nALTER SYSTEM SET archive_mod = on;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_6","title":"\u6267\u884c\u6570\u636e\u5e93\u6253\u5f00\u6a21\u5f0f\u4e0b\u5907\u4efd","text":"<p>pg_basebackup\u57fa\u672c\u5907\u4efd\u7684\u6807\u51c6\u8fc7\u7a0b\u5982\u4e0b\u6240\u793a\uff1a</p> <p></p> <p>(1) \u6267\u884cpg_start_backup\u547d\u4ee4\u00a0 (2) \u4f7f\u7528tar/cp\u547d\u4ee4\u5bf9$PGDATA\u76ee\u5f55\u8fdb\u884c\u5907\u4efd (3) \u6267\u884cpg_stop_backup\u547d\u4ee4</p> <p>pg_basebackup\u5de5\u4f5c\u539f\u7406\uff1a</p> <p>pg_start_backup\u6267\u884c\u4ee5\u4e0b\u56db\u4e2a\u64cd\u4f5c</p> <ol> <li>Force into the full-page wirte mode.</li> <li>Switch to the current WAL segment file (version 8.4 or later).</li> <li>Do checkpoint.</li> <li>Create a backup_label file:\u6b64\u6587\u4ef6\u521b\u5efa\u4e8ebase\u76ee\u5f55\u7684\u540c\u4e00\u5c42\uff0c\u5305\u542b\u6709\u5173\u57fa\u672c\u5907\u4efd\u672c\u8eab\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u4f8b\u5982\u6b64\u68c0\u67e5\u70b9\u7684\u68c0\u67e5\u70b9\u4f4d\u7f6e\u3002</li> </ol> <p>backup_label\u6587\u4ef6\u5305\u542b\u5982\u4e0b\u5185\u5bb9</p> <ul> <li>CHECKPOINT LOCATION \u2013\u8fd9\u662f\u8bb0\u5f55\u6b64\u547d\u4ee4\u521b\u5efa\u7684\u68c0\u67e5\u70b9\u7684LSN\u4f4d\u7f6e\u3002</li> <li>START WAL LOCATION \u2013\u8fd9\u4e0d\u4e0ePITR\u4e00\u8d77\u4f7f\u7528\uff0c\u800c\u662f\u4e0e\u6d41\u5f0f\u590d\u5236\u4e00\u8d77\u4f7f\u7528\u3002\u5b83\u88ab\u547d\u540d\u4e3a\"START WAL LOCATION\"\uff0c\u56e0\u4e3a\u5904\u4e8e\u590d\u5236\u6a21\u5f0f\u7684\u5907\u7528\u670d\u52a1\u5668\u5728\u521d\u59cb\u542f\u52a8\u65f6\u53ea\u8bfb\u53d6\u4e00\u6b21\u8be5\u503c\u3002</li> <li>BACKUP METHOD\u2013\u8fd9\u662f\u7528\u4e8e\u8fdb\u884c\u6b64\u57fa\u7840\u5907\u4efd\u7684\u65b9\u6cd5\u3002(pg_start_backup\u6216pg_basebackup\u3002)</li> <li>BACKUP FROM \u2013\u8fd9\u663e\u793a\u6b64\u5907\u4efd\u662f\u4ece\u4e3b\u5907\u4efd\u8fd8\u662f\u4ece\u5907\u7528\u5907\u4efd\u3002</li> <li>START TIME \u2013\u8fd9\u662f\u6267\u884cpg_start_backup\u65f6\u7684\u65f6\u95f4\u6233\u3002</li> <li>LABEL \u2013\u8fd9\u662f\u5728pg_start_backup\u4e2d\u6307\u5b9a\u7684\u6807\u7b7e\u3002</li> <li>START TIMELINE \u2013\u8fd9\u662f\u5907\u4efd\u5f00\u59cb\u7684\u65f6\u95f4\u7ebf\u3002\u8fd9\u662f\u4e3a\u4e86\u8fdb\u884c\u5065\u5168\u6027\u68c0\u67e5\uff0c\u5e76\u5df2\u5728\u7248\u672c11\u4e2d\u5f15\u5165\u3002</li> </ul> <p>pg_stop_backup</p> <ol> <li>\u5982\u679cpg_start_backup\u5f3a\u5236\u66f4\u6539\u4e86\u975e\u6574\u9875\u5199\u5165\u6a21\u5f0f\uff0c\u5219\u5c06\u5176\u91cd\u7f6e\u4e3a\u975e\u6574\u9875\u5199\u5165\u6a21\u5f0f\u3002</li> <li>\u5199\u4e00\u4e2a\u5907\u4efd\u7ed3\u675f\u7684XLOG\u8bb0\u5f55\u3002</li> <li>\u5207\u6362WAL\u65e5\u5fd7\u3002</li> <li>\u521b\u5efa\u5907\u4efd\u5386\u53f2\u6587\u4ef6\u2013\u6b64\u6587\u4ef6\u5305\u542b\u5907\u4efd\u6807\u7b7e\u6587\u4ef6\u7684\u5185\u5bb9\u548c\u6267\u884cpg_stop_backup\u7684\u65f6\u95f4\u6233\u3002</li> <li>\u5220\u9664\u5907\u4efd\u6807\u7b7e\u6587\u4ef6\u2013\u5907\u4efd\u6807\u7b7e\u6587\u4ef6\u662f\u4ece\u57fa\u672c\u5907\u4efd\u6062\u590d\u6240\u5fc5\u9700\u7684\uff0c\u4e00\u65e6\u590d\u5236\uff0c\u5c31\u4e0d\u5fc5\u5728\u539f\u59cb\u6570\u636e\u5e93\u7fa4\u96c6\u4e2d\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#pg_basebackup","title":"\u6267\u884cpg_basebackup\u5907\u4efd\u793a\u4f8b","text":"<p>\u4ea7\u751f\u538b\u7f29\u7684tar\u5305\uff0c-Ft\u53c2\u6570\u6307\u5b9a\uff1a</p> <p><pre><code>pg_basebackup -D bk1 -Ft -z -P\n</code></pre> \u6b64\u5907\u4efd\u82b1\u7684\u65f6\u95f4\u6bd4\u8f83\u957f\uff0c\u4f46\u662f\u8282\u7701\u7a7a\u95f4\u3002\u652f\u6301\u8868\u7a7a\u95f4\u6587\u4ef6\u5b58\u653e\u5728\u5176\u5b83\u76ee\u5f55\u4e0b\u3002</p> <p>\u4ea7\u751f\u8ddf\u6e90\u6587\u4ef6\u4e00\u6837\u7684\u683c\u5f0f\uff0c\u5373\u539f\u6837\u683c\u5f0f\uff0c-Fp\u53c2\u6570\u6307\u5b9a\uff1a</p> <pre><code>pg_basebackup -D bk2 -Fp -P\n</code></pre> <p>\u6b64\u5907\u4efd\u65b9\u5f0f\u5f88\u5feb\uff0c\u4f46\u662f\u4e0d\u8282\u7701\u7a7a\u95f4\u3002\u5982\u679c\u6709\u8868\u7a7a\u95f4\u8def\u5f84\u653e\u5728\u5176\u5b83\u76ee\u5f55\u4e0b\uff0c\u5219\u5907\u4efd\u5931\u8d25\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_7","title":"\u6267\u884c\u7528\u6237\u7ba1\u7406\u5168\u5e93\u5907\u4efd\u793a\u4f8b","text":"<p>\u6570\u636e\u5e93\u4e2d\u6267\u884c\u5f00\u59cb\u5907\u4efd\u51fd\u6570\uff1a</p> <pre><code>select pg_start_backup('full');\n</code></pre> <p>\u4f7f\u7528tar\u547d\u4ee4\u8fdb\u884c\u5907\u4efd\uff1a</p> <pre><code>cd $PGATA\ntar -zcf /backup/data.tar.gz .\n</code></pre> <p>\u6570\u636e\u5e93\u4e2d\u6267\u884c\u7ed3\u675f\u5907\u4efd\u51fd\u6570\uff1a</p> <pre><code>select pg_stop_backup();\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_8","title":"\u6267\u884c\u8868\u7a7a\u95f4\u5907\u4efd\u793a\u4f8b","text":"<p>\u6570\u636e\u5e93\u4e2d\u6267\u884c\u5f00\u59cb\u5907\u4efd\u51fd\u6570\uff1a</p> <pre><code>select pg_start_backup('tbs');\n</code></pre> <p>\u4f7f\u7528tar\u547d\u4ee4\u8fdb\u884c\u5907\u4efd(\u5907\u4efdpg_default\u8868\u7a7a\u95f4\u6240\u5728\u7684\u76ee\u5f55)\uff1a</p> <pre><code>cd $PGATA\ntar -zcf /backup/base.tar.gz base\ncp backup_lable /backup\n</code></pre> <p>\u6570\u636e\u5e93\u4e2d\u6267\u884c\u7ed3\u675f\u5907\u4efd\u51fd\u6570\uff1a</p> <pre><code>select pg_stop_backup();\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E4%BA%8C/#_9","title":"\u6267\u884c\u53ea\u8bfb\u6570\u636e\u5e93\u5907\u4efd\u793a\u4f8b","text":"<p>\u628a\u67d0\u4e2a\u6570\u636e\u5e93\u53d8\u6210\u53ea\u8bfb\uff1a</p> <pre><code>ALTER DATABASE new_db1 set default_transaction_read_only=on;\n</code></pre> <p>\u4f7f\u7528tar/cp\u547d\u4ee4\u8fdb\u884c\u5907\u4efd(\u5907\u4efdnew_db1\u6240\u5728\u7684\u76ee\u5f55)\uff1a</p> <pre><code>cd $PGATA/base\ntar -zcf /backup/90195.tar.gz 90195\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/","title":"\u903b\u8f91\u5907\u4efd","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_1","title":"\u903b\u8f91\u5907\u4efd\u5de5\u5177","text":"<p>\u5bfc\u5165\u5bfc\u51fa\u7684\u4f5c\u7528\uff1a 1. \u5f52\u6863\u5386\u53f2\u6570\u636e 2. \u4fdd\u5b58\u8868\u5b9a\u4e49\u4ee5\u9632\u6b62\u7528\u6237\u51fa\u9519 3. \u5728\u8ba1\u7b97\u673a\u548c\u6570\u636e\u5e93\u4e4b\u95f4\u6216PostgreSQL\u670d\u52a1\u5668\u7684\u4e0d\u540c\u7248\u672c\u4e4b\u95f4\u79fb\u52a8\u6570\u636e 4. \u5728\u6570\u636e\u5e93\u4e4b\u95f4\u4f20\u8f93\u6570\u636e</p> <p>\u8c03\u7528\u5bfc\u51fa\u548c\u5bfc\u5165\u7a0b\u5e8f\u7684\u65b9\u6cd5 1. \u547d\u4ee4\u884c\u63a5\u53e3 2. \u5176\u5b83\u7ba1\u7406\u5de5\u5177</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_2","title":"\u5bfc\u51fa\u6a21\u5f0f","text":"<ol> <li>pg_dump\u53ea\u80fd\u5907\u4efd\u5355\u4e2a\u6570\u636e\u5e93\uff0c\u4e0d\u4f1a\u5bfc\u51fa\u89d2\u8272\u548c\u8868\u7a7a\u95f4\u76f8\u5173\u7684\u4fe1\u606f\uff0c\u800c\u4e14\u6062\u590d\u7684\u65f6\u5019\u9700\u8981\u521b\u5efa\u7a7a\u6570\u636e\u5e93\u3002</li> <li>pg_dumpall\u53ef\u4ee5\u5907\u4efd\u6240\u6709\u6570\u636e\u5e93\uff0c\u5e76\u4e14\u5907\u4efd\u89d2\u8272\u3001\u8868\u7a7a\u95f4\u3002<ul> <li><code>-F c</code>\u5907\u4efd\u4e3a\u4e8c\u8fdb\u5236\u683c\u5f0f, \u538b\u7f29\u5b58\u50a8. \u5e76\u4e14\u53ef\u88abpg_restore\u7528\u4e8e\u7cbe\u7ec6\u8fd8\u539f\u3002</li> <li><code>-F p</code>\u5907\u4efd\u4e3a\u6587\u672c, \u5927\u5e93\u4e0d\u63a8\u8350\u3002</li> </ul> </li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#pg_dump","title":"pg_dump","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>pg_dump [\u9009\u9879]... [\u6570\u636e\u5e93\u540d\u5b57]\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>pg_dump testdb &gt; testdb.sql\npg_dump -F c -f testdb.dmp -C -E UTF8 -h 127.0.0.1 -U postgres testdb\npg_dump -F p -f testdb.sql -C -E UTF8 -h 127.0.0.1 -U postgres testdb\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_3","title":"\u903b\u8f91\u6062\u590d","text":"<p>\u6062\u590d\u987a\u5e8f\uff1a</p> <p>1.\u521b\u5efa\u65b0\u8868 2.\u5bfc\u5165\u6570\u636e 3.\u5efa\u7acb\u7d22\u5f15 4.\u89e6\u53d1\u5668\u5df2\u5bfc\u5165 5.\u5728\u65b0\u8868\u4e0a\u542f\u7528\u5b8c\u6574\u6027\u7ea6\u675f 6.\u521b\u5efa\u51fd\u6570</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_4","title":"\u6062\u590d\u6570\u636e","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_5","title":"\u6587\u672c\u683c\u5f0f\u5907\u4efd\u6062\u590d\u65b9\u5f0f\uff1a","text":"<p>1.\u521b\u5efa\u65b0\u6570\u636e\u5e93</p> <pre><code>CREATE DATABASE new_db1;\n</code></pre> <p>2.\u6062\u590d\u6570\u636e</p> <pre><code>psql new_db1 &lt; testdb.sql\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_6","title":"\u4e8c\u8fdb\u5236\u683c\u5f0f\u5907\u4efd\u6062\u590d\u65b9\u5f0f\uff1a","text":"<p>1.\u521b\u5efa\u65b0\u6570\u636e\u5e93</p> <pre><code>CREATE DATABASE new_db1;\n</code></pre> <p>2.\u6062\u590d\u6570\u636e</p> <pre><code>pg_restore -d new_db1 testdb.dmp\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_7","title":"\u4e8c\u8fdb\u5236\u5907\u4efd\u5b9e\u73b0\u7cbe\u7ec6\u6062\u590d","text":"<p>\u5229\u7528toc\u6587\u4ef6\u5b9e\u73b0\u7cbe\u7ec6\u6062\u590d</p> <p>1.\u6839\u636e\u4e8c\u8fdb\u5236\u5907\u4efd\u6587\u4ef6\u751f\u6210 toc \u6587\u4ef6</p> <pre><code>pg_restore -l -f testdb.toc testdb.dmp\n</code></pre> <p>2.\u4fee\u6539 toc \u6587\u4ef6\uff0c\u7528';'\u53f7\u6ce8\u91ca\u6389\u4e0d\u7528\u8fd8\u539f\u7684\u5185\u5bb9</p> <pre><code>203; 1259 40996 TABLE public dept postgres\n204; 1259 41001 TABLE public emp postgres\n;202; 1259 16391 TABLE public t1 postgres\n2840; 0 40996 TABLE DATA public dept postgres\n2841; 0 41001 TABLE DATA public emp postgres\n;2839; 0 16391 TABLE DATA public t1 postgres\n</code></pre> <p>3.\u4ee5toc\u6587\u4ef6\u505a\u6062\u590d</p> <pre><code>pg_restore -F c -L testdb.toc -d testdb testdb.dmp\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_8","title":"\u5176\u5b83\u5bfc\u51fa\u5bfc\u5165\u6280\u5de7","text":"<p>1.\u5229\u7528\u7ba1\u9053\u7b26\u5b9e\u73b0\u5404\u79cd\u5bfc\u51fa\u5bfc\u5165</p> <pre><code># \u5bfc\u51fa\u5e76\u4e14\u538b\u7f29:\npg_dump testdb |gzip testdb.sql\n# \u89e3\u538b\u5e76\u4e14\u5bfc\u5165\uff0c\u538b\u7f29\u6587\u4ef6\u4e0d\u53d8\uff0c\uff0c\u5bfc\u5165\u5230testdb\u6570\u636e\u5e93\uff1a\ngunzip -c testdb.sql.gz |psql testdb\n# \u5bfc\u51fa\u540e\u76f4\u63a5\u8fdb\u884c\u6062\u590d\uff0c\u6587\u4ef6\u4e0d\u843d\u5730\uff0c\u628atestdb\u6570\u636e\u5e93\u7684\u8868\u5bfc\u5165\u5230testdb1\uff1a\npg_dump testdb| psql testdb1\n# \u5e76\u884c\u5bfc\u51fa\u4e0e\u5bfc\u5165\npg_dump -Fd -j4 -f testdb.p.dump testdb\npg_restore -d testdb1 -j4 testdb.p.dump\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_9","title":"\u5176\u5b83\u5907\u4efd\u6062\u590d\u6280\u5de7","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#1","title":"1.\u5907\u4efd\u6307\u5b9a/\u6392\u9664\u7684\u8868","text":"<pre><code># \u5982\u679c\u53ea\u60f3\u5bfc\u51fa\u6307\u5b9a\u7684\u8868\u6570\u636e\uff0c\u53ef\u4ee5\u4f7f\u7528-t\u53c2\u6570\uff0c\u8868\u540d\u9700\u8981\u7528\u4e24\u4e2a\u53cc\u5f15\u53f7\u6982\u62ec\u8d77\u6765\u3002\npg_dump -t \"\"departments\"\" -t \"\"employees\"\" testdb &gt; testdb.sql\n\n# \u5bfc\u51fa\u6392\u9664\u6307\u5b9a\u7684\u8868\u7684\u6570\u636e\u5e93\npg_dump -d testdb -T \"\"emp\"\" &gt; testdb_ex_emp.sql\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#2pg_dump","title":"2.\u4f7f\u7528pg_dump\u5b9e\u73b0\u4e3b\u673a\u95f4\u6570\u636e\u5e93\u95f4\u8fc1\u79fb\u6570\u636e","text":"<p>\u6587\u4ef6\u4e0d\u843d\u5730\uff0c\u5b9e\u73b0\u6570\u636e\u5e93\u8fc1\u79fb</p> <p>1\u3001\u914d\u7f6e\u4e24\u4e2a\u6570\u636e\u5e93\u4e4b\u95f4\u7684\u4fe1\u4efb\u5173\u7cfb(\u5fc5\u987b)</p> <pre><code>host all all 192.168.18.0/24 trust\n</code></pre> <p>2\u3001\u5728\u6570\u636e\u5e93\u4e4b\u95f4\u8fdb\u884c\u67d0\u4e2a\u6570\u636e\u5e93\u8fc1\u79fb</p> <pre><code>pg_dump -h pg1 -p 1922 -U postgres testdb|psql -h pg2 -p 5432 -U postgres testdb\n</code></pre> <p>3\u3001\u8fc1\u79fb\u6240\u6709\u7684\u6570\u636e\u5e93\u5230\u76ee\u6807\u6570\u636e\u5e93</p> <pre><code>pg_dumpall -h pg1 -p 1922 -U postgres |psql -h pg2 -p 5432 -U postgres\n</code></pre> <p>\u6ce8\u610f\uff1a 1\u3001PG\u6570\u636e\u5e93\u4e4b\u95f4\u8fc1\u79fb\u65e0\u9700\u914d\u7f6edblink\uff0c\u53ea\u8981\u6307\u5b9a\u4e3b\u673a\u540d\u548c\u7aef\u53e3\u5373\u53ef\u3002 2\u3001\u7531\u4e8e\u7528\u7684\u662f\u7ba1\u9053\u7b26\uff0c\u6240\u4ee5\u5fc5\u987b\u914d\u7f6e\u4e24\u4e2a\u6570\u636e\u5e93\u8fdc\u7a0b\u767b\u5f55\u4fe1\u4efb\u5173\u7cfb\u3002 3\u3001\u8fc1\u79fb\u65f6\u4e24\u4e2a\u6570\u636e\u5e93\u5fc5\u987b\u8981\u6709\u76f8\u540c\u7684\u8868\u7a7a\u95f4\uff0c\u9700\u8981\u63d0\u524d\u521b\u5efa\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#copy","title":"copy\u6982\u8ff0","text":"<p>\u5b9e\u73b0\u8868\u4e0e\u6587\u4ef6\u4e4b\u95f4\u7684\u4ea4\u4e92 copy \u547d\u4ee4\u7528\u4e8e\u6570\u636e\u5e93\u4e2d\u8868\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u6587\u4ef6(\u548c\u6807\u51c6\u8f93\u51fa\u3001\u6807\u51c6\u8f93\u5165)\u4e4b\u95f4\u7684\u76f8\u4e92\u62f7\u8d1d\uff0c\u53ef\u4ee5\u7531\u8868\u81f3\u6587\u4ef6\uff0c\u4e5f\u53ef\u4ee5\u7531\u6587\u4ef6\u81f3\u8868\u3002 \u4f7f\u7528copy\u5b9e\u73b0\u6570\u636e\u5e93\u8868\u548c\u6587\u672c\u6587\u4ef6\u4e4b\u95f4\u6570\u636e\u7684\u8fc1\u79fb\uff0c\u975e\u5e38\u65b9\u4fbf\uff0c\u6bd4Oracle\u7684sqlloader\u6613\u7528\u6027\u597d\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#copy_1","title":"copy\u8bed\u6cd5","text":"<p>\u00b7 \u8bed\u6cd5</p> <p>\u6587\u4ef6\u5230\u8868</p> <pre><code>COPY table_name [ ( column ...] ) ]\nFROM { 'filename' | command' | STDIN }\n[ [ WITH ] ( option [, ] ) ]\n</code></pre> <p>\u8868\u5230\u6587\u4ef6</p> <pre><code>COPY { table_name column_name [, ...] ) ] | ( query ) }\nTO { 'filename' | PROGRAM 'command' | STDOUT }\n[ [ WITH ] ( option [, ...] ) ]\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#_10","title":"\u5e94\u7528\u6848\u4f8b","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#1_1","title":"1.\u6587\u4ef6\u5230\u8868","text":"<p>\u6587\u4ef6\u5230\u8868\u65f6\uff0c\u652f\u6301\u7684\u6587\u672c\u5185\u5bb9\u683c\u5f0f\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662ftab\u5236\u8868\u7b26\u4f5c\u4e3a\u5206\u9694\u7b26(\u4e0d\u662f\u7a7a\u683c);\u4e00\u79cd\u662f\u9017\u53f7\u505a\u4e3a\u5206\u9694\u7b26\u3002</p> <p>tab\u952e\u4f5c\u4e3a\u5206\u9694\u7b26\uff1a</p> <pre><code>1 a\n2 b\n3 c\n</code></pre> <pre><code>\\copy tab_name from /home/postgres/tab.txt;\n</code></pre> <p>\u9017\u53f7\u4f5c\u4e3a\u5206\u9694\u7b26\uff1a</p> <pre><code>1,a,\"I am students\"\n2,b,\"I am teacher\"\n3,c,\"I am boss\"\n</code></pre> <pre><code>\\copy tab_name from /home/postgres/tab.csv with csv;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D%E4%B9%8B%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D/#2","title":"2.\u8868\u5230\u6587\u4ef6","text":"<p>\u8868\u5230\u6587\u4ef6\u65f6\uff0c\u652f\u6301\u7684\u6587\u672c\u5185\u5bb9\u683c\u5f0f\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u662ftab\u5236\u8868\u7b26\u4f5c\u4e3a\u5206\u9694\u7b26(\u4e0d\u662f\u7a7a\u683c);\u4e00\u79cd\u662f\u9017\u53f7\u505a\u4e3a\u5206\u9694\u7b26\u3002</p> <p>tab\u952e\u4f5c\u4e3a\u5206\u9694\u7b26\uff1a</p> <pre><code>\\copy tab_name to /home/postgres/tab.txt;\n</code></pre> <p>\u9017\u53f7\u505a\u4e3a\u5206\u9694\u7b26\uff1a</p> <pre><code>\\copy tab_name to /home/postgres/tab.csv with csv;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/","title":"\u5bf9\u8c61\u6743\u9650","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#_1","title":"\u4e00\u3001\u5bf9\u8c61\u6743\u9650","text":"<ol> <li>\u6bcf\u4e2a\u6570\u636e\u5e93\u5bf9\u8c61\u90fd\u6709\u4e00\u4e2a\u6240\u6709\u8005\uff0c \u9ed8\u8ba4\u60c5\u51b5\u4e0b\u6240\u6709\u8005\u62e5\u6709\u8be5\u5bf9\u8c61\u7684\u6240\u6709\u6743\u9650</li> <li>\u5728\u6570\u636e\u5e93\u4e2d\u6240\u6709\u7684\u6743\u9650\u90fd\u548c\u89d2\u8272\u6302\u94a9</li> <li>\u5bf9\u8d85\u7ea7\u7528\u6237postgres\u4e0d\u505a\u6743\u9650\u68c0\u67e5\uff0c\u5176\u5b83\u7528\u6237\u8d70ACL(AccessControLList\uff09</li> <li>\u5bf9\u4e8e\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u5f00\u59cb\u53ea\u6709\u6240\u6709\u8005\u548c\u8d85\u7ea7\u7528\u6237\u53ef\u4ee5\u505a\u4efb\u4f55\u64cd\u4f5c\uff0c\u5176\u5b83\u8d70ACL\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#_2","title":"\u4e8c\u3001\u5bf9\u8c61\u7ea7\u522b\u7684\u6743\u9650","text":"<ul> <li>\u8868\u7ea7\u5bf9\u8c61\u6743\u9650\u63a7\u5236</li> <li>\u5217\u7ea7\u522b\u6743\u9650\u63a7\u5236</li> <li>\u5e8f\u5217\u6743\u9650\u63a7\u5236</li> <li>\u7c7b\u578b\u57df\u7684\u6743\u9650\u63a7\u5236\uff08\u57df\u7b80\u5355\u6765\u8bf4\u5c31\u662f\u81ea\u5b9a\u4e49\u7684\u5e26\u7ea6\u675f\u7684\u6570\u636e\u7c7b\u578b</li> <li>FDW\u6743\u9650\u63a7\u5236</li> <li>FS\u6743\u9650\u63a7\u5236</li> <li>\u51fd\u6570\u6743\u9650\u63a7\u5236</li> <li><code>\\h GRANT</code>\u663e\u793a\u6240\u6709\u53ef\u8bbe\u7f6e\u7684\u8bbf\u95ee\u6743\u9650</li> </ul>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#_3","title":"\u4e09\u3001\u5bf9\u8c61\u6743\u9650\u7ba1\u7406","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#1","title":"1. \u6388\u6743","text":"<pre><code>-- \u6388\u6743\u5355\u4e2a\u6743\u9650\u7ed9\u7528\u6237\nGRANT SELECT ON tab_name TO role_name;\n-- \u6388\u6743\u591a\u4e2a/\u6240\u6709\u6743\u9650\u7ed9\u7528\u6237\nGRANT SELECT,UPDATE,INSERT ON tab_name TO role_name;\nGRANT ALL ON tab_name TO role_name;\n-- \u6388\u6743\u67d0\u6a21\u5f0f\u4e0b\u6240\u6709\u8868\u7684\u67e5\u8be2\u6743\u9650\u7ed9\u7528\u6237\nGRANT SELECT ON ALL TABLES IN SCHEMA schema_name TO role_name;\n-- \u6388\u6743\u5217\u6743\u9650\u7ed9\u7528\u6237\nGRANT SELECT (col1), UPDATE(col1) ON tab_name TO role_name;\n-- \u6388\u6743\u6240\u6709\u6743\u9650\u7ed9\u6240\u6709\u7528\u6237\nGRANT ALL ON tab_name TO public;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#2","title":"2. \u67e5\u770b\u6743\u9650","text":"<pre><code>\\dp     [PATTERN]\n\\z\nselect grantor,grantee,privilege_type,is_grantable from information_schema.table_privileges where table_name='tbl';\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#3","title":"3. \u56de\u6536\u6743\u9650","text":"<pre><code>--\u56de\u6536\u5355\u4e2a\u6743\u9650\nREVOKE SELECT ON tab_name FROM role_name;\n-- \u56de\u6536\u591a\u4e2a/\u6240\u6709\u6743\u9650\nREVOKE SELECT,UPDATE,INSERT ON tab_name FROM role_name;\nREVOKE ALL ON tab_name FROM role_name;\n-- \u56de\u6536\u67d0\u6a21\u5f0f\u4e0b\u6240\u6709\u8868\u7684\u67e5\u8be2\u6743\u9650\nREVOKE SELECT ON ALL TABLES IN SCHEMA schema_name FROM role_name;\n-- \u56de\u6536\u5217\u6743\u9650\nREVOKE SELECT (col1), UPDATE (col1) ON tab_name FROM role_name;\n-- \u56de\u6536\u6240\u6709\u6743\u9650\nREVOKE ALL ON tab name FROM public;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%AF%B9%E8%B1%A1%E6%9D%83%E9%99%90/#4","title":"4. \u5bf9\u8c61\u6613\u4e3b","text":"<pre><code>-- 1.\u8f6c\u79fb\u5355\u4e2a\u8868\u7684\u5c5e\u4e3b\uff081\u3001\u8d85\u7ea7\u7528\u6237\uff1a2\u3001\u5c5e\u4e3b\uff0c\u539f\u5c5e\u4e3b\u5fc5\u987b\u662f\u88ab\u6388\u6743\u7528\u6237\u7684\u6210\u5458\uff09\n Alter table tablname owner to new_owner;\n-- 2\u3001\u8f6c\u79fb\u5f53\u524d\u6570\u636e\u5e93\u8868\u7684\u5c5e\u4e3b\uff08\u8d85\u7ea7\u7528\u6237\u64cd\u4f5c\uff0c\u5982\u679c\u5c5e\u4e3b\u662fpostgres\uff0c \u5219\u4e0d\u5141\u8bb8\uff0c\u56e0\u4e3a\u5176\u4e2d\u5305\u542b\u6570\u636e\u5b57\u5178\u8868\uff0c\u53ea\u80fd\u7528\u7b2c\u4e00\u79cd\u65b9\u5f0f\u5355\u8868\u4fee\u6539\u3002\uff09\nReassign owned by old_role to new_role;\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/","title":"\u5e38\u7528\u7cfb\u7edf\u7ba1\u7406\u547d\u4ee4","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_1","title":"\u67e5\u770b\u7cfb\u7edf\u4fe1\u606f","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_2","title":"\u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93\u5b9e\u4f8b\u7248\u672c","text":"<pre><code>postgres=# select version();\n                                                 version                                                  \n----------------------------------------------------------------------------------------------------------\n PostgreSQL 12.13 on x86_64-pc-linux-gnu, compiled by gcc (GCC) 4.8.5 20150623 (Red Hat 4.8.5-44), 64-bit\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_3","title":"\u67e5\u770b\u6570\u636e\u5e93\u542f\u52a8\u65f6\u95f4","text":"<pre><code>postgres=# select pg_postmaster_start_time();\n    pg_postmaster_start_time    \n--------------------------------\n 16/11/2023 05:27:36.234696 CET\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_4","title":"\u663e\u793a\u5f53\u524d\u6570\u636e\u5e93\u65f6\u533a","text":"<pre><code>postgres=# show timezone;\n TimeZone \n----------\n CET\n(1 row)\npostgres=# select now();\n              now               \n--------------------------------\n 17/11/2023 01:11:54.254751 CET\n(1 row)\n</code></pre> <p>\u6570\u636e\u5e93\u65f6\u533a\u662f\u64cd\u4f5c\u7cfb\u7edf\u65f6\u533a\u6709\u65f6\u5e76\u4e0d\u4e00\u81f4</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_5","title":"\u67e5\u770b\u5f53\u524d\u7528\u6237","text":"<pre><code>postgres=# select session_user;\n session_user \n--------------\n postgres\n(1 row)\n\npostgres=# select user;\n   user   \n----------\n postgres\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_6","title":"\u663e\u793a\u5f53\u524d\u6570\u636e\u5e93","text":"<pre><code>tpcc=# select current_catalog, current_database();\n current_catalog | current_database \n-----------------+------------------\n tpcc            | tpcc\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#ip","title":"\u67e5\u770b\u5f53\u524d\u6570\u636e\u5e93\u7684IP\u5730\u5740\u548c\u7aef\u53e3","text":"<pre><code>postgres=# select inet_server_addr(), inet_server_port();\n inet_server_addr | inet_server_port \n------------------+------------------\n 127.0.0.1        |             5432\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#sessionid","title":"\u67e5\u770b\u5f53\u524dsession\u7684\u540e\u53f0\u670d\u52a1\u8fdb\u7a0bID","text":"<pre><code>postgres=# select pg_backend_pid();\n pg_backend_pid \n----------------\n          40997\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_7","title":"\u67e5\u770b\u6570\u636e\u5e93\u5927\u5c0f","text":"<pre><code>postgres=# select pg_size_pretty(pg_database_size('tpcc'));\n pg_size_pretty \n----------------\n 7953 kB\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E5%B8%B8%E7%94%A8%E7%B3%BB%E7%BB%9F%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4/#_8","title":"\u67e5\u770b\u8868\u7684\u5927\u5c0f","text":"<pre><code>-- \u67e5\u770b\u8868\u7684\u5927\u5c0f\uff0c\u4e0d\u5305\u542b\u7d22\u5f15\nbenchmark=# select pg_size_pretty(pg_relation_size('bmsql_order_line'));\n pg_size_pretty \n----------------\n 569 MB\n(1 row)\n-- \u67e5\u770b\u8868\u548c\u7d22\u5f15\u7684\u5927\u5c0f\nbenchmark=# select pg_size_pretty(pg_total_relation_size('bmsql_order_line'));\n pg_size_pretty \n----------------\n 779 MB\n(1 row)\n-- \u67e5\u770b\u7d22\u5f15\u5927\u5c0f\nbenchmark=# select pg_size_pretty(pg_indexes_size('bmsql_order_line'));\n pg_size_pretty \n----------------\n 210 MB\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93/","title":"\u6570\u636e\u5e93","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93/#_1","title":"\u4e00\u3001\u6570\u636e\u5e93\u5c5e\u4e3b","text":"<ul> <li>Postgres\u4e2d\u7684\u6570\u636e\u5e93\u5c5e\u4e3b\u5c5e\u4e8e\u521b\u5efa\u8005\uff0c\u53ea\u8981\u6709createdb\u7684\u6743\u9650\u5c31\u53ef\u4ee5\u521b\u5efa\u6570\u636e\u5e93\uff0c\u6570\u636e\u5e93\u5c5e\u4e3b\u4e0d\u4e00\u5b9a\u62e5\u6709\u5b58\u653e\u5728\u8be5\u6570\u636e\u5e93\u4e2d\u5176\u5b83\u7528\u6237\u521b\u5efa\u7684\u5bf9\u8c61\u7684\u8bbf\u95ee\u6743\u9650\u3002</li> <li>\u6570\u636e\u5e93\u5728\u521b\u5efa\u540e\uff0c\u5141\u8bb8public\u89d2\u8272\u8fde\u63a5\uff0c\u5373\u5141\u8bb8\u4efb\u4f55\u4eba\u8fde\u63a5\u3002</li> <li>\u6570\u636e\u5e93\u5728\u521b\u5efa\u540e\uff0c\u4e0d\u5141\u8bb8\u9664\u4e86\u8d85\u7ea7\u7528\u6237\u548cowner\u4e4b\u5916\u7684\u4efb\u4f55\u4eba\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efaschema\u3002</li> <li>\u6570\u636e\u5e93\u5728\u521b\u5efa\u540e\uff0c\u4f1a\u81ea\u52a8\u521b\u5efa\u540d\u4e3apublic\u7684schema\uff0c\u8fd9\u4e2aschema\u7684all\u6743\u9650\u5df2\u7ecf\u8d4b\u5b50\u7ed9\u4e86public\u89d2\u8272\uff0c\u5373\u5141\u8bb8\u4efb\u4f55\u4eba\u5728\u91cc\u9762\u521b\u5efa\u5bf9\u8c61\uff0c\u4f46\u5bf9\u5df1\u5b58\u5728\u7684\u5176\u5b83\u7528\u6237\u7684\u8868\u4e0d\u5177\u6709\u4efb\u4f55\u6743\u9650\u3002</li> </ul>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93/#_2","title":"\u4e8c\u3001\u6570\u636e\u5e93\u6743\u9650","text":"<ul> <li>CREATE:\u53ef\u4ee5\u5728\u6307\u5b9a\u6570\u636e\u5e93\u521b\u5efaschema\u7684\u6743\u9650</li> <li>CONNECT\uff1a\u53ef\u4ee5\u8fde\u63a5\u5230\u6307\u5b9a\u6570\u636e\u5e93\u7684\u6743\u9650</li> <li>TEMPORARY:\u53ef\u4ee5\u521b\u5efa\u4e34\u65f6\u8868\u7684\u6743\u9650</li> <li>ALL\uff1a\u6307\u5b9a\u6570\u636e\u5e93\u6240\u6709\u7684\u6743\u9650</li> </ul>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93/#_3","title":"\u4e09\u3001\u6743\u9650\u7ba1\u7406","text":"<p>\u7531\u4e8e\u6570\u636e\u5e93\u5728\u521b\u5efa\u540e\uff0c\u5141\u8bb8public\u89d2\u8272\u8fde\u63a5\uff0c\u5373\u5141\u8bb8\u4efb\u4f55\u4eba\u8fde\u63a5\u3002\u6240\u4ee5\u5982\u679c\u8981\u53d6\u6d88\u67d0\u4e2a\u7528\u6237\u5bf9\u6307\u5b9a\u6570\u636e\u5e93\u8fde\u63a5\u7684\u6743\u9650\uff0c\u9700\u8981\u5148\u53d6\u6d88public\u7684\u8fde\u63a5\u6743\u9650\uff0c\u518d\u53d6\u6d88\u8be5\u7528\u6237\u7684\u8fde\u63a5\u6743\u9650\u3002</p> <pre><code>-- \u6388\u6743\u7528\u6237\u8fde\u63a5\u6570\u636e\u5e93\u7684\u6743\u9650\ngrant connect on database db_name to user_name;\n-- \u64a4\u9500\u7528\u6237\u8fde\u63a5\u6570\u636e\u5e93\u7684\u6743\u9650\nrevoke connect on database db_name from public;\nrevoke connect on database db_name from user_name;\n--\u67e5\u770b\u54ea\u4e9b\u7528\u6237\u6709\u67d0\u4e2a\u6570\u636e\u5e93\u7684connect\u6743\u9650\nselect datname,datacl from pg_database where datname='newdb';\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E6%95%B0%E6%8D%AE%E5%BA%93/#_4","title":"\u6570\u636e\u5e93\u73af\u5883\u8bbe\u7f6e","text":"<p>PostgresQL\u53c2\u6570\u8bbe\u7f6e\u5206\u4e3a\u5b9e\u4f8b\u7ea7\u3001\u6570\u636e\u5e93\u7ea7\u3001\u7528\u6237\u7ea7\u548c\u4f1a\u8bdd\u7ea7\uff0c\u800c\u6709\u4e9b\u53c2\u6570\u53ef\u4ee5\u5728\u6240\u6709\u7ea7\u522b\u4e2d\u8bbe\u7f6e\uff0c\u4f18\u5148\u7ea7\u987a\u5e8f\u4e3a\u4f1a\u8bdd\u7ea7&gt;\u7528\u6237\u7ea7&gt;\u6570\u636e\u5e93\u7ea7&gt;\u5b9e\u4f8b\u7ea7 \u6570\u636e\u5e93\u53c2\u6570\u914d\u7f6e\u8bed\u6cd5\uff1a</p> <pre><code>ALTER DATABASE name SET configuration_parameter { TO | = } { value | DEFAULT }\nALTER DATABASE name SET configuration_parameter FROM CURRENT\nALTER DATABASE name RESET configuration_parameter\nALTER DATABASE name RESET ALL\n</code></pre> <p>\u4f8b\uff1a <pre><code>-- \u8bbe\u7f6e\u6570\u636e\u5e93\u641c\u7d22\u8def\u5f84\uff1a\nalter database postgres set search_pathl to '$user',public,schema_name;\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u65f6\u53ef\u4f7f\u7528\u7684\u5de5\u4f5c\u5185\u5b58\nalter database postgres set work_mem = '8MB';\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u65f6\u53ef\u4f7f\u7528\u7684\u7ef4\u62a4\u5185\u5b58\nalter database postgres set maintenance_work_mem TO '256MB';\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u540e\u4f7f\u7528\u7684\u65f6\u533a\nalter database postgres set TimeZone to cet;\nalter database postgres set DateStyle to SQL,DMY; --\u91cd\u65b0\u767b\u5f55\u751f\u6548\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u540e\u6267\u884c\u8bed\u53e5\u6700\u591a\u65f6\u957f(\u6267\u884c1\u79d2\u8d85\u65f6\uff09\nalter database postgres set statement timeout = 1000;\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u540e\u9ed8\u8ba4\u7684\u5ba2\u6237\u7aef\u7f16\u7801\uff0c \u914d\u7f6e\u5ba2\u6237\u7aef\u7f16\u7801\u4e3agbk\uff0c \u9002\u7528\u4e8e\u6570\u636e\u5e93\u7f16\u7801\u4e3autf8\uff0c\u5e94\u7528\u7a0b\u5e8f\u7f16\u7801\u4e3agbk\u7684\u5e94\u7528\nalter database postgres set client_encoding to gbk;\n-- \u914d\u7f6e\u67d0\u4e2a\u5e93\u4f7f\u7528\u65e5\u5fd7\u8bb0\u5f55\u7ea7\u522b\uff08\u8bbe\u7f6e\u540e\uff0c\u5bf9\u8fd9\u4e2a\u6570\u636e\u5e93\u7684\u8bbf\u95ee\u4e0d\u8bb0\u5f55\u65e5\u5fd7\uff09\nalter database postgres set log_statement=none;\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u540e\u7684wal\u65e5\u5fd7\u5199\u76d8\u7ea7\u522b\uff08\u8bbe\u7f6e\u540e\uff0c\u8be5\u5e93\u7684\u66f4\u65b0\u64cd\u4f5c\u53ea\u8981\u6c42\u672c\u5730\u63d0\u4ea4\uff09\nalter database postgres set synchronous_commit to local;\n-- \u914d\u7f6e\u8fde\u63a5\u67d0\u4e2a\u5e93\u540e\u7981\u7528\u67d0\u4e2a\u89c4\u5212\u5668\uff08\u7981\u7528indexonlyscan\u626b\u63cf\uff09\nalter database postgres set enable_indexonlyscan to off;\n--\u67e5\u770b\u6240\u6709\u4e2a\u6027\u5316\u914d\u7f6e\n\\drds\n-- \u67e5\u8be2\u6570\u636e\u5e93\u7684\u8fde\u63a5\u6570\u9650\u5236\u53ea\u80fd\u67e5\u770b\u6570\u636e\u5b57\u5178\u8868\nselect datname, datconnlimit from pg_database;\n--\u8bbe\u7f6e\u67d0\u4e2a\u4e2a\u6027\u5316\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\nALTER DATABASE postgres reset exit_on_error;\n-- \u8bbe\u7f6e\u6240\u6709\u4e2a\u6027\u5316\u8bbe\u7f6e\u4e3a\u9ed8\u8ba4\u503c\nALTER DATABASE postgres reset ALL;\n</code></pre></p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/","title":"\u7528\u6237\u3001\u89d2\u8272\u548c\u6a21\u5f0f","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#_1","title":"\u4e00\u3001\u7528\u6237\u548c\u89d2\u8272","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#1","title":"1. \u7528\u6237","text":"<p>\u5728PostgreSQL\u4e2d\uff0c\u7528\u6237\u662f\u6307\u5177\u6709\u4e2a\u4eba\u8eab\u4efd\u7684\u6570\u636e\u5e93\u8d26\u6237\u3002\u6bcf\u4e2a\u7528\u6237\u90fd\u6709\u4e00\u4e2a\u552f\u4e00\u7684\u540d\u79f0\u548c\u5bc6\u7801\uff0c\u7528\u4e8e\u767b\u5f55\u6570\u636e\u5e93\u5e76\u6267\u884c\u64cd\u4f5c\u3002\u7528\u6237\u53ef\u4ee5\u88ab\u6388\u4e88\u5bf9\u6570\u636e\u5e93\u7684\u8bfb\u5199\u6743\u9650\uff0c\u53ef\u4ee5\u521b\u5efa\u3001\u4fee\u6539\u548c\u5220\u9664\u6570\u636e\u5e93\u5bf9\u8c61\u3002\u7528\u6237\u8fd8\u53ef\u4ee5\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u548c\u7ba1\u7406\u89d2\u8272\u3002\u7528\u6237\u5177\u6709\u4e00\u4e9b\u7279\u6b8a\u6743\u9650\uff0c\u4f8b\u5982\u521b\u5efa\u6570\u636e\u5e93\u3001\u5907\u4efd\u548c\u6062\u590d\u6570\u636e\u5e93\u3001\u66f4\u6539\u5168\u5c40\u8bbe\u7f6e\u7b49\u3002\u7528\u6237\u8fd8\u53ef\u4ee5\u88ab\u8d4b\u4e88\u8d85\u7ea7\u7528\u6237\u6743\u9650\uff0c\u8fd9\u4f7f\u5f97\u4ed6\u4eec\u53ef\u4ee5\u6267\u884c\u9ad8\u7ea7\u64cd\u4f5c\uff0c\u5982\u66f4\u6539\u5176\u4ed6\u7528\u6237\u7684\u6743\u9650\u3001\u4fee\u6539\u7cfb\u7edf\u8868\u3001\u5b89\u88c5\u6269\u5c55\u7b49\u3002\u8d85\u7ea7\u7528\u6237\u5e94\u5f53\u8c28\u614e\u4f7f\u7528\u5176\u6743\u9650\uff0c\u4ee5\u907f\u514d\u5bf9\u6570\u636e\u5e93\u7684\u610f\u5916\u7834\u574f\u3002</p> <p>\u5728\u521d\u59cb\u5316\u6570\u636e\u5e93\u7cfb\u7edf\u65f6\uff0c\u6709\u4e00\u4e2a\u9884\u5b9a\u4e49\u7684\u8d85\u7ea7\u7528\u6237\uff0c\u8fd9\u4e2a\u7528\u6237\u7684\u540d\u79f0\u4e0e\u521d\u59cb\u5316\u8be5\u6570\u636e\u5e93\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u540d\u76f8\u540c\u3002\u5982\u679c\u6570\u636e\u5e93\u662f\u5efa\u5728\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237postgres\uff08\u901a\u5e38\u628a\u6570\u636e\u5e93\u5b89\u88c5\u5728\u6b64\u7528\u6237\u4e0b\uff09\u4e0b\u7684\uff0c\u8fd9\u4e2a\u6570\u636e\u5e93\u8d85\u7ea7\u7528\u6237\u7684\u540d\u79f0\u4e5f\u4f1a\u53eb\u201cpostgres\u201d\u3002\u53ef\u4ee5\u7528\u8fd9\u4e2a\u8d85\u7ea7\u7528\u6237\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u7136\u540e\u521b\u5efa\u51fa\u66f4\u591a\u7684\u7528\u6237\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#2","title":"2. \u89d2\u8272","text":"<p>\u5728PostgreSQL\u4e2d\uff0c\u89d2\u8272\u662f\u4e00\u79cd\u66f4\u901a\u7528\u7684\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u7528\u4e8e\u7ba1\u7406\u548c\u6388\u6743\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u4e3b\u4f53\u3002\u89d2\u8272\u53ef\u4ee5\u7528\u4e8e\u6388\u6743\u7528\u6237\u8bbf\u95ee\u7279\u5b9a\u7684\u6570\u636e\u5e93\u3001\u6a21\u5f0f\u6216\u8868\uff0c\u53ef\u4ee5\u88ab\u8d4b\u4e88\u4e00\u4e9b\u6216\u5168\u90e8\u7684\u6570\u636e\u5e93\u7684\u6743\u9650\u3002\u89d2\u8272\u662f\u4e00\u7cfb\u5217\u76f8\u5173\u6743\u9650\u7684\u96c6\u5408\u3002\u4e3a\u4e86\u7ba1\u7406\u65b9\u4fbf\uff0c\u901a\u5e38\u4f1a\u628a\u4e00\u7cfb\u5217\u76f8\u5173\u7684\u6570\u636e\u5e93\u6743\u9650\u8d4b\u7ed9\u4e00\u4e2a\u89d2\u8272\uff0c\u5982\u679c\u54ea\u4e2a\u7528\u6237\u9700\u8981\u8fd9\u4e9b\u6743 \u9650\uff0c\u5c31\u628a\u89d2\u8272\u8d4b\u7ed9\u76f8\u5e94\u7684\u7528\u6237\u3002</p> <p>\u89d2\u8272\u6709\u4e24\u79cd\u7c7b\u578b\uff1a\u767b\u5f55\u89d2\u8272\u548c\u975e\u767b\u5f55\u89d2\u8272\u3002\u767b\u5f55\u89d2\u8272\u5177\u6709\u7528\u6237\u529f\u80fd\uff0c\u53ef\u4ee5\u767b\u5f55\u6570\u636e\u5e93\u5e76\u6267\u884c\u64cd\u4f5c\u3002\u975e\u767b\u5f55\u89d2\u8272\u4ec5\u7528\u4e8e\u6388\u6743\u548c\u6743\u9650\u7ba1\u7406\uff0c\u5b83\u4eec\u4e0d\u80fd\u76f4\u63a5\u767b\u5f55\u6570\u636e\u5e93\u3002</p> <p>\u4e0e\u7528\u6237\u4e0d\u540c\uff0c\u89d2\u8272\u4e0d\u5177\u6709\u7279\u6b8a\u6743\u9650\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u521b\u5efa\u7684\u89d2\u8272\u6ca1\u6709\u4efb\u4f55\u6743\u9650\u3002\u9700\u8981\u901a\u8fc7\u6388\u4e88\u89d2\u8272\u6743\u9650\u7684\u65b9\u5f0f\u6765\u8bbe\u7f6e\u5176\u8bbf\u95ee\u6743\u9650\u3002\u4f8b\u5982\uff0c\u53ef\u4ee5\u5c06\u89d2\u8272\u6388\u6743\u4e3a\u6570\u636e\u5e93\u7684\u6240\u6709\u8005\uff0c\u4f7f\u5176\u80fd\u591f\u5bf9\u6570\u636e\u5e93\u4e2d\u7684\u6240\u6709\u5bf9\u8c61\u8fdb\u884c\u5b8c\u5168\u63a7\u5236\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#3","title":"3. \u7528\u6237\u4e0e\u89d2\u8272\u7684\u533a\u522b","text":"<p>\u7528\u6237\u548c\u89d2\u8272\u5728 PostgreSQL \u4e2d\u7684\u533a\u522b\u4e3b\u8981\u6709\u4ee5\u4e0b\u51e0\u70b9\uff1a</p> <ol> <li>\u7528\u6237\u662f\u5177\u6709\u4e2a\u4eba\u8eab\u4efd\u548c\u767b\u5f55\u80fd\u529b\u7684\u6570\u636e\u5e93\u8d26\u6237\uff0c\u800c\u89d2\u8272\u66f4\u901a\u7528\uff0c\u7528\u4e8e\u6388\u6743\u548c\u6743\u9650\u7ba1\u7406\u3002</li> <li>\u7528\u6237\u53ef\u4ee5\u76f4\u63a5\u767b\u5f55\u6570\u636e\u5e93\u6267\u884c\u64cd\u4f5c\uff0c\u800c\u975e\u767b\u5f55\u89d2\u8272\u4ec5\u7528\u4e8e\u6388\u6743\u548c\u6743\u9650\u7ba1\u7406\u3002</li> <li>\u7528\u6237\u62e5\u6709\u767b\u5f55\u6570\u636e\u5e93\u548c\u4e00\u4e9b\u7279\u6b8a\u6743\u9650\uff0c\u5982\u8d85\u7ea7\u7528\u6237\u6743\u9650\uff0c\u800c\u89d2\u8272\u9ed8\u8ba4\u6ca1\u6709\u7279\u6b8a\u6743\u9650\u3002</li> <li>\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u3001\u4fee\u6539\u548c\u5220\u9664\u6570\u636e\u5e93\u5bf9\u8c61\uff0c\u800c\u89d2\u8272\u65e0\u6cd5\u76f4\u63a5\u6267\u884c\u8fd9\u4e9b\u64cd\u4f5c\uff0c\u5fc5\u987b\u901a\u8fc7\u7528\u6237\u7684\u6388\u6743\u6765\u5b9e\u73b0\u3002</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#_2","title":"\u4e8c\u3001\u7528\u6237\u7ba1\u7406","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#1_1","title":"1. \u521b\u5efa\u7528\u6237","text":"<pre><code>postgres=# \\du\n                                   List of roles\n Role name |                         Attributes                         | Member of \n-----------+------------------------------------------------------------+-----------\n postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\n\npostgres=# CREATE USER u1 SUPERUSER PASSWORD 'u1'; --\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u8d85\u7ea7\u7528\u6237\u6743\u9650\u7684\u7528\u6237\nCREATE ROLE\npostgres=# CREATE USER u2 CREATEDB PASSWORD 'u2';  --\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u5efa\u5e93\u6743\u9650\u7684\u7528\u6237\nCREATE ROLE\npostgres=# CREATE USER u3 LOGIN; --\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u767b\u5f55\u6743\u9650\u7684\u7528\u6237\uff0c\u9ed8\u8ba4\u503c\nCREATE ROLE\npostgres=# CREATE USER u4 encrypted PASSWORD '123456' VALID UNTIL '2025-01-01'; --\u521b\u5efa\u4e00\u4e2a\u5e26\u6709\u52a0\u5bc6\u5bc6\u7801\u4e14\u5177\u6709\u6709\u6548\u65f6\u95f4\u7684\u7528\u6237\nCREATE ROLE\npostgres=# \\du\n                                   List of roles\n Role name |                         Attributes                         | Member of \n-----------+------------------------------------------------------------+-----------\n postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\n u1        | Superuser                                                  | {}\n u2        | Create DB                                                  | {}\n u3        |                                                            | {}\n u4        | Password valid until 2025-01-01 00:00:00+08                | {}\n</code></pre> <p>\u67e5\u770b\u7528\u6237\u6743\u9650</p> <pre><code>postgres=# select * from pg_user where usename = 'u1';\n usename | usesysid | usecreatedb | usesuper | userepl | usebypassrls |  passwd  | valuntil | useconfig \n---------+----------+-------------+----------+---------+--------------+----------+----------+-----------\n u1      |    16395 | f           | t        | f       | f            | ******** |          | \n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#2_1","title":"2. \u521b\u5efa\u89d2\u8272","text":"<pre><code>postgres=# CREATE ROLE r1; --\u521b\u5efa\u4e00\u4e2a\u89d2\u8272\nCREATE ROLE\npostgres=# CREATE ROLE r2 createdb;    --\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u5efa\u5e93\u6743\u9650\u7684\u89d2\u8272\nCREATE ROLE\npostgres=# CREATE ROLE r3 LOGIN; --\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u767b\u5f55\u6743\u9650\u7684\u89d2\u8272\uff0c\nCREATE ROLE\npostgres=# CREATE ROLE r4 encrypted PASSWORD '1234561'  VALID UNTIL '2025-01-01'; --\u521b\u5efa\u4e00\u4e2a\u5e26\u6709\u52a0\u5bc6\u5bc6\u7801\u4e14\u5177\u6709\u6709\u6548\u65f6\u95f4\u7684\u89d2\u8272\nCREATE ROLE\npostgres=# \\du\n                                   List of roles\n Role name |                         Attributes                         | Member of \n-----------+------------------------------------------------------------+-----------\n postgres  | Superuser, Create role, Create DB, Replication, Bypass RLS | {}\n r1        | Cannot login                                               | {}\n r2        | Create DB, Cannot login                                    | {}\n r3        |                                                            | {}\n r4        | Cannot login                                              +| {}\n           | Password valid until 2025-01-01 00:00:00+08                | \n u1        | Superuser                                                  | {}\n u2        | Create DB                                                  | {}\n u3        |                                                            | {}\n u4        | Password valid until 2025-01-01 00:00:00+08                | {}\n</code></pre> <p>\u67e5\u770b\u89d2\u8272\u6743\u9650</p> <pre><code>postgres=# select * from pg_roles where rolname = 'r1';\n rolname | rolsuper | rolinherit | rolcreaterole | rolcreatedb | rolcanlogin | rolreplication | rolconnlimit | rolpassword | rolvaliduntil | rolbypassrls | rolconfig |  oid  \n---------+----------+------------+---------------+-------------+-------------+----------------+--------------+-------------+---------------+--------------+-----------+-------\n r1      | f        | t          | f             | f           | f           | f              |           -1 | ********    |               | f            |           | 16400\n(1 row)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#3_1","title":"3. \u4fee\u6539\u7528\u6237\u5c5e\u6027","text":"<pre><code>ALTER USER u2 RENAME TO u2; --\u4fee\u6539\u7528\u6237\u7684\u540d\u5b57\nALTER USER u22 PASSWORD u22;  --\u4fee\u6539\u7528\u6237\u7684\u5bc6\u7801\nALTER USER u22 CREATEROLE; --\u4fee\u6539\u7528\u6237\u7684\u6743\u9650\nALTER USER u22 IN DATABASE testdb RESET ALL --\u4fee\u6539\u6570\u636e\u5e93testdb\u4e2d\u7684\u53c2\u6570\u91cd\u8bbe\u4e3a\u9ed8\u8ba4\u503c\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#4","title":"4. \u5220\u9664\u7528\u6237","text":"<pre><code>drop user u1;\n</code></pre> <p>\u6ce8\u610f\u4e8b\u9879\uff1a</p> <ol> <li>\u53ea\u7528\u8d85\u7ea7\u7528\u6237\u80fd\u591f\u5220\u9664\u8d85\u7ea7\u7528\u6237</li> <li>\u53ea\u6709\u5177\u6709createrole\u6743\u9650\u7684\u7528\u6237\u80fd\u5220\u9664\u975e\u8d85\u7ea7\u7528\u6237</li> <li>\u5220\u9664\u7528\u6237\u524d\uff0c\u9700\u8981\u5148\u5220\u9664\u4f9d\u8d56\u8be5\u7528\u6237\u7684\u5bf9\u8c61\u3001\u6743\u9650\u7b49\u4fe1\u606f</li> <li>\u4efb\u4f55\u5c5e\u4e8e\u8be5\u7ec4\u89d2\u8272\u7684\u5bf9\u8c61\u90fd\u5fc5\u987b\u5148\u88ab\u5220\u9664\u6216\u8005\u5c06\u5bf9\u8c61\u7684\u6240\u6709\u8005\u8d4b\u4e88\u5176\u5b83\u89d2\u8272\uff0c\u4efb\u4f55\u8d4b\u4e88\u8be5\u7ec4\u89d2\u8272\u7684\u6743\u9650\u4e5f\u90fd\u5fc5\u987b\u88ab\u64a4\u6d88</li> <li>\u5220\u9664\u7ec4role\u53ea\u4f1a\u5220\u9664\u7ec4\u7684role\u672c\u8eab\uff0c\u7ec4\u7684\u6210\u5458\u5e76\u4e0d\u4f1a\u88ab\u5220\u9664</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#schema","title":"\u4e09\u3001schema","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#1-schema","title":"1. \u4ec0\u4e48\u662fschema\uff08\u6a21\u5f0f\uff09","text":"<ol> <li>\u7528\u6237\u5bf9\u8c61\u7684\u96c6\u5408\u53eb\u505a\u6a21\u5f0f\u3002\u6bd4\u5982\uff1ascott\u7528\u6237\u4e0b\u6709\u8868emp\u3001dept\u3001salgrade\u7b49\uff0c\u8fd8\u6709\u51e0\u4e2a\u7d22\u5f15\uff0c\u8fd8\u6709\u4e00\u4e9b\u7ea6\u675f\u7b49\u7b49\uff0c\u90a3\u4e48scott\u7528\u6237\u4e0b\u6240\u6709\u5bf9\u8c61\u7684\u96c6\u5408\u5c31\u53ebscott\u6a21\u5f0f\u3002</li> <li> <p>\u53ef\u4ee5\u628a\u7528\u6237\u4e0b\u62e5\u6709\u7684\u5bf9\u8c61\u6839\u636e\u4e1a\u52a1\u5206\u7c7b\uff0c\u4e0d\u540c\u7684\u5bf9\u8c61\u5b58\u653e\u5728\u4e0d\u540c\u7684\u6a21\u5f0f\u4e0b\u3002</p> </li> <li> <p>\u65b0\u5efa\u7684\u6570\u636e\u5e93\u9ed8\u8ba4\u4f1a\u521b\u5efa\u4e0d\u540c\u7684\u6a21\u5f0f\u6765\u7ba1\u7406\u5bf9\u8c61\u3002\u6bd4\u5982\uff1ainformation_schema\u3001pg_catalog\u3001 pg_temp_1\u3001pg_toast\u3001pg_toast_temp_1\u3001public\u7b49\u3002</p> </li> <li>\u4e0d\u540c\u7684schema\u4e0b\u53ef\u4ee5\u6709\u76f8\u540c\u540d\u5b57\u7684\u8868\u3001\u51fd\u6570\u7b49\u5bf9\u8c61\uff0c\u4e92\u76f8\u4e4b\u95f4\u662f\u4e0d\u51b2\u7a81\u7684\u3002\u53ea\u8981\u6709\u6743\u9650\uff0c\u6bcf\u4e2aschema\u7684\u5bf9\u8c61\u662f\u53ef\u4ee5\u4e92\u76f8\u8c03\u7528\u7684\u3002</li> </ol> <p>posgresql\u4e2d\u7684\u9ed8\u8ba4\u6a21\u5f0f</p> <pre><code>postgres=# \\dnS+\n                                     List of schemas\n        Name        |  Owner   |  Access privileges   |           Description            \n--------------------+----------+----------------------+----------------------------------\n information_schema | postgres | postgres=UC/postgres+| \n                    |          | =U/postgres          | \n pg_catalog         | postgres | postgres=UC/postgres+| system catalog schema\n                    |          | =U/postgres          | \n pg_temp_1          | postgres |                      | \n pg_toast           | postgres |                      | reserved schema for TOAST tables\n pg_toast_temp_1    | postgres |                      | \n public             | postgres | postgres=UC/postgres+| standard public schema\n                    |          | =UC/postgres         | \n(6 rows)\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#2_2","title":"2. \u7528\u6237\u4e0e\u6a21\u5f0f\u7684\u5bf9\u5e94\u5173\u7cfb","text":"<ol> <li>\u4e00\u4e2a\u7528\u6237\u53ef\u4ee5\u521b\u5efa\u4e0e\u62e5\u6709\u591a\u4e2a\u6a21\u5f0f\u3002</li> <li>\u4e00\u4e2a\u6a21\u5f0f\u53ea\u80fd\u5c5e\u624b\u4e00\u4e2a\u7528\u6237</li> <li>\u666e\u901a\u7528\u6237\u521b\u5efa\u6a21\u5f0f\u65f6\u9700\u8981\u6388\u6743\u5728\u6307\u5b9a\u7684\u6570\u636e\u5e93\u4e0b\u521b\u5efa\u6a21\u5f0f\u7684\u6743\u9650</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#3_2","title":"3. \u6a21\u5f0f\u7ba1\u7406","text":"<pre><code># \u521b\u5efa\u7528\u6237\u548c\u6570\u636e\u5e93\n$ psql\npsql (12.13)\nType \"help\" for help.\n# \npostgres=# create user tpcc password 'tpcc';\nCREATE ROLE\npostgres=# create database tpcc;\nCREATE DATABASE\npostgres=# \\q\n# \u6ca1\u6709\u8d4b\u6743\uff0c\u6ca1\u6709\u521b\u5efaschema\u6743\u9650\n$ psql -U tpcc -d tpcc\npsql (12.13)\nType \"help\" for help.\n\ntpcc=&gt; create schema benchmark;\nERROR:  permission denied for database tpcc\ntpcc=&gt; \\q\n# \u8d4b\u6743\n$ psql\npsql (12.13)\nType \"help\" for help.\n\npostgres=# grant create on database tpcc to tpcc;\nGRANT\npostgres=# \\q\n# \u518d\u6b21\u521b\u5efaschema\n$ psql -U tpcc -d tpcc\npsql (12.13)\nType \"help\" for help.\n\ntpcc=&gt; create schema benchmark;\nCREATE SCHEMA\ntpcc=&gt; \\dn\n   List of schemas\n   Name    |  Owner   \n-----------+----------\n benchmark | tpcc\n public    | postgres\n(2 rows)\n</code></pre> <p>\u6388\u6743\u67d0\u4e2a\u6a21\u5f0f\u4e0b\u7684\u5bf9\u8c61\u8bbf\u95ee\u6743\u9650\u7ed9\u5176\u5b83\u7528\u6237\uff0c\u5219\u9700\u8981\u5148\u6388\u6743\u8bbf\u95ee\u8be5\u6a21\u5f0f\u7684\u6743\u9650\u7ed9\u5176\u5b83\u7528\u6237\u3002</p> <pre><code>GRANT USAGE ON SHEMA sch_name TO role_name;\nGRANT SELECT ON sch_name.tab_name TO role_name;\n</code></pre> <p>\u5220\u9664\u6a21\u5f0f\uff0c\u6a21\u5f0f\u53ea\u80fd\u7531\u5176\u62e5\u6709\u8005\u6216\u8d85\u7ea7\u7528\u6237\u5220\u9664</p> <pre><code>drop schema schema name;\n</code></pre> <p>\u5220\u9664\u6a21\u5f0f\u65f6\u540c\u65f6\u5220\u9664\u6240\u4f9d\u8d56\u7684\u5bf9\u8c61</p> <p><code>sql drop schema chema name cascade;</code></p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#4-public","title":"4. public\u6a21\u5f0f","text":"<p>\u521d\u59cb\u5316\u6570\u636e\u5e93\u65f6\u4f1a\u7535\u52a8\u521b\u5efa\u4e00\u4e2apublic\u6a21\u5f0f\u5171\u4eab\u7ed9\u6240\u6709\u7528\u6237\u4f7f\u7528\uff0c\u4efb\u4f55\u7528\u6237\u90fd\u53ef\u4ee5\u628a\u5bf9\u8c61\u521b\u5efa\u5728\u8be5\u6a21\u5f0f\u4e0b\uff0c\u7531\u4e8ePostgreSQL\u4e0b\u4e00\u4e2a\u7528\u6237\u5bf9\u5e94\u591a\u4e2a\u6a21\u5f0f\uff0c\u521b\u5efa\u7528\u6237\u65f6\u6ca1\u6709\u521b\u5efa\u5bf9\u5e94\u7684\u9ed8\u8ba4\u6a21\u5f0f\uff0c\u800c\u5bf9\u8c61\u90fd\u662f\u57fa\u4e8e\u6a21\u5f0f\u7ba1\u7406\u7684\uff0c\u6240\u4ee5\u521b\u5efa\u4e00\u4e2a\u516c\u7528\u7684\u6a21\u5f0fpublic\u3002 \u57fa\u4e8e\u6570\u636e\u5e93\u5b89\u5168\u8003\u8651\uff0c\u53ef\u4ee5\u5220\u9664public\u6a21\u5f0f\uff08\u53ef\u9009\uff09\u3002</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E7%94%A8%E6%88%B7%E3%80%81%E8%A7%92%E8%89%B2%E5%92%8C%E6%A8%A1%E5%BC%8F/#5","title":"5. \u641c\u7d22\u8def\u5f84","text":"<p>\u67e5\u770b\u641c\u7d22\u8def\u5f84</p> <pre><code>tpcc=&gt; show search_path;\n   search_path   \n-----------------\n \"$user\", public\n(1 row)\n</code></pre> <p>\u8bbe\u7f6e\u641c\u7d22\u8def\u5f84</p> <pre><code>set search_path='Suser',public,scott\n</code></pre> <p>\u5982\u679c\u5728\u524d\u9762\u7684\u641c\u7d22\u8def\u5f84\u4e2d\u627e\u5230\u5bf9\u8c61\uff0c\u5219\u4f1a\u653e\u5f03\u540e\u9762\u6a21\u5f0f\u7684\u641c\u7d22</p>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E8%BF%9E%E6%8E%A5%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/","title":"\u8fde\u63a5\u8bbf\u95ee\u63a7\u5236","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E8%BF%9E%E6%8E%A5%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/#pg_hbaconf","title":"\u4e00\u3001pg_hba.conf\u6587\u4ef6","text":"<ol> <li>\u5ba2\u6237\u7aef\u8ba4\u8bc1\u662f\u7531\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\uff08\u901a\u5e38\u540d\u4e3apg_hba.conf\u5e76\u88ab\u5b58\u653e\u5728\u6570\u636e\u76ee\u5f55\u4e2d\uff09\u63a7\u5236\uff08HBA\u8868\u793a\u57fa\u4e8e\u4e3b\u673a\u7684\u8ba4\u8bc1\uff09\u3002</li> <li>\u5728initdb\u521d\u59cb\u5316\u6570\u636e\u76ee\u5f55\u65f6\uff0c\u5b83\u4f1a\u5b89\u88c5\u4e00\u4e2a\u9ed8\u8ba4\u7684pg_hba.conf\u6587\u4ef6\u3002\u4e0d\u8fc7\u6211\u4eec\u4e5f\u53ef\u4ee5\u628a\u8ba4\u8bc1\u914d\u7f6e\u6587\u4ef6\u653e\u5728\u5176\u5b83\u5730\u65b9\u3002</li> <li>pg_hba.conf\u6587\u4ef6\u7684\u5e38\u7528\u683c\u5f0f\u662f\u4e00\u7ec4\u8bb0\u5f55\uff0c\u6bcf\u884c\u4e00\u6761\u3002\u7a7a\u767d\u884c\u5c06\u88ab\u5ffd\u7565\uff0c#\u6ce8\u91ca\u5b57\u7b26\u540e\u9762\u7684\u4efb\u4f55\u6587\u672c\u4e5f\u88ab\u5ffd\u7565\u3002\u8bb0\u5f55\u4e0d\u80fd\u8de8\u884c\u3002</li> <li>\u4e00\u6761\u8bb0\u5f55\u7531\u82e5\u5e72\u7528\u7a7a\u683c/\u6216\u5236\u8868\u7b26\u5206\u9694\u7684\u57df\u7ec4\u6210\u3002\u5982\u679c\u57df\u503c\u7528\u53cc\u5f15\u53f7\u5305\u56f4\uff0c\u90a3\u4e48\u5b83\u53ef\u4ee5\u5305\u542b\u7a7a\u683c\u3002\u5728\u6570\u636e\u5e93\u3001\u7528\u6237\u6216\u5730\u5740\u57df\u4e2d\u5f15\u7528\u4e00\u4e2a\u5173\u952e\u5b57\uff08\u4f8b\u5982\uff0call\u6216replication\uff09\u5c06\u4f7f\u8be5\u8bcd\u5931\u53bb\u5176\u7279\u6b8a\u542b\u4e49\uff0c\u5e76\u4e14\u53ea\u662f\u5339\u914d\u4e00\u4e2a\u6709\u8be5\u540d\u5b57\u7684\u6570\u636e\u5e93\u3001\u7528\u6237\u6216\u4e3b\u673a\u3002</li> </ol> <pre><code>[postgres@pg1 ~]$ grep -Ev '#|^$' $PGDATA/pg_hba.conf\nlocal   all             all                                     trust\nhost    all             all             127.0.0.1/32            trust\nhost    all             all             ::1/128                 trust\nlocal   replication     all                                     trust\nhost    replication     all             127.0.0.1/32            trust\nhost    replication     all             ::1/128                 trust\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E8%BF%9E%E6%8E%A5%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6/#_1","title":"\u4e8c\u3001\u540d\u5355\u683c\u5f0f","text":"<ol> <li>TYPE\uff1a\u6307\u5b9a\u8fde\u63a5\u7c7b\u578b</li> <li>local\uff1a\u8868\u793a\u672c\u5730\u8fde\u63a5\uff0c\u53ea\u5bf9Unix/Linux\u7cfb\u7edf\u6709\u6548\uff0c\u4f7f\u7528socket\u65b9\u5f0f\u767b\u5f55</li> <li>host\uff1a\u8868\u793a\u4e3b\u673a\u901a\u8fc7TCP/IP\u8fde\u63a5</li> <li>hostssl\uff1a\u8868\u793a\u4e3b\u673a\u8fde\u63a5\u9700\u8981SSL\u52a0\u5bc6\u65b9\u5f0f\u8fde\u63a5</li> <li>DATABASE: \u6307\u5b9a\u8fde\u63a5\u7684\u6570\u636e\u5e93\u540d</li> <li>all\uff1a\u8868\u793a\u6240\u6709\u7684\u6570\u636e\u5e93</li> <li>db_name\uff1a \u8868\u793a\u6307\u5b9a\u7684\u6570\u636e\u5e93</li> <li>replications \u8868\u793a\u4e3b\u5907\u590d\u5236\u65f6\u7684\u8fde\u63a5</li> <li>USER: \u6307\u5b9a\u8fde\u63a5\u7684\u7528\u6237\u540d</li> <li>all\uff1a\u8868\u6709\u6240\u6709\u7528\u6237</li> <li>username\uff1a\u8868\u793a\u6307\u5b9a\u7684\u7528\u6237</li> <li>+group_name: \u8868\u793a\u4e00\u7ec4\u7528\u6237</li> <li>@file_name  \u8868\u793a\u6587\u4ef6\u4e2d\u5305\u542b\u7684\u7528\u6237\u5217\u8868</li> <li>ADDRESS\uff1a \u6307\u5b9a\u8bbf\u95ee\u7684\u5ba2\u6237\u7aef\u4e3b\u673a</li> <li>127.0.0.1/32\uff1a\u8868\u793a\u672c\u5730\u5ba2\u6237\u7aef\u4e3b\u673a</li> <li>0.0.0.0/0\uff1a\u8868\u793a\u6240\u6709\u5ba2\u6237\u7aef\u4e3b\u673a</li> <li>hostname: \u8868\u793a\u6307\u5b9a\u7684\u4e3b\u673a\u540d\uff08hosts\u6587\u4ef6\u4e2d\u5305\u542b\uff09</li> <li>ip_addr/net_mask\uff1a\u8868\u793a\u6307\u5b9a\u7684ip\u5730\u5740\u6216\u8005\u7f51\u6bb5</li> <li>METHOD\uff1a\u6307\u5b9a\u9a8c\u8bc1\u65b9\u5f0f</li> <li>trust\uff1a\u4fe1\u4efb\u5ba2\u6237\u7aef\u8fde\u63a5\uff0c\u65e0\u9700\u63d0\u4f9b\u5bc6\u7801</li> <li>scram-sha-256\uff1a\u8fd9\u662f\u5f53\u524d\u63d0\u4f9b\u7684\u65b9\u6cd5\u4e2d\u6700\u5b89\u5168\u7684\u4e00\u79cd\uff0c\u4f46\u662f\u65e7\u7684\u5ba2\u6237\u7aef\u5e93\u4e0d\u652f\u6301\u8fd9\u79cd\u65b9\u6cd5\u3002</li> <li>md5\uff1a\u5b83\u80fd\u9632\u6b62\u53e3\u4ee4\u560e\u63a2\u5e76\u4e14\u9632\u6b62\u53e3\u4ee4\u5728\u670d\u52a1\u5668\u4e0a\u4ee5\u660e\u6587\u5b58\u50a8\uff0c\u4f46\u662f\u65e0\u6cd5\u4fdd\u62a4\u653b\u51fb\u8005\u60f3\u529e\u6cd5\u4ece\u670d\u52a1\u5668\u4e0a\u53d6\u4e86\u53e3\u4ee4\u54c8\u5e0c\u7684\u60c5\u51b5</li> <li>password\uff1a\u65b9\u6cd5password\u4ee5\u660e\u6587\u5f62\u5f0f\u53d1\u9001\u53e3\u4ee4\uff0c\u56e0\u6b64\u5b83\u5bf9\u4e8e\u53e3\u4ee4\u201c\u63a2\u201d\u653b\u51fb\u5f88\u8106\u5f31\u3002</li> <li>ident\uff1a\u8be5\u6a21\u5f0f\u4e0b\u7cfb\u7edf\u4f1a\u5c06\u8bf7\u6c42\u53d1\u8d77\u8005\u7684\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u6620\u5c04\u4e3aPostgessQL\u6570\u636e\u5e93\u5185\u90e8\u7528\u6237\uff0c\u5e76\u4ee5\u8be5\u5185\u90e8\u7528\u6237\u7684\u6743\u9650\u767b\u5f55\uff0c\u4e14\u6b64\u65f6\u65e0\u9700\u63d0\u4f9b\u767b\u5f55\u5bc6\u7801\u3002\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u4e0e\u6570\u636e\u5e93\u5185\u90e8\u7528\u6237\u4e4b\u95f4\u7684\u6620\u5c04\u5173\u7cfb\u4f1a\u8bb0\u5f55\u5728pg_ident.conf\u6587\u4ef6\u4e2d\u3002</li> <li>peer\uff1a\u8be5\u6a21\u5f0f\u4f7f\u7528\u8fde\u63a5\u53d1\u8d77\u7aef\u7684\u64cd\u4f5c\u7cfb\u7edf\u540d\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u3002\u4ec5\u9650\u4e8eLinux\u3001BSD\u3001Macosx\u548cSolaris\uff0c\u5e76\u4e14\u4ec5\u53ef\u7528\u4e8e\u672c\u5730\u670d\u52a1\u5668\u53d1\u8d77\u7684\u8fde\u63a5\u3002</li> <li>reject\uff1a\u8be5\u6a21\u5f0f\u8868\u793a\u62d2\u7edd\u6240\u6709\u8bf7\u6c42</li> </ol>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E9%85%8D%E7%BD%AE/","title":"\u914d\u7f6e","text":""},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E9%85%8D%E7%BD%AE/#_1","title":"\u4e00\u3001\u521d\u59cb\u5316\u53c2\u6570","text":"<p>\u53c2\u6570\u7c7b\u578b\uff1a</p> <ol> <li>\u663e\u793a\uff1a\u5728\u6587\u4ef6\u4e2d\u5bf9\u53c2\u6570\u8fdb\u884c\u8bbe\u7f6e</li> <li>\u9690\u5f0f\uff1a\u6587\u4ef6\u4e2d\u6ca1\u6709\u8bbe\u7f6e\uff0c\u4f7f\u7528postgres\u9ed8\u8ba4\u503c</li> </ol> <p>\u53ef\u4ee5\u5b58\u5728\u591a\u4e2a\u521d\u59cb\u5316\u53c2\u6570\u6587\u4ef6</p> <ol> <li>\u9759\u6001\u53c2\u6570\u6587\u4ef6\uff1apostgresql.conf<ol> <li>\u9ed8\u8ba4\u5728PGDATA\u4e0b</li> <li>\u66f4\u6539\u5c06\u5728\u4e0b\u6b21\u542f\u52a8\u65f6\u751f\u6548</li> <li>\u4ec5\u5728\u5b9e\u4f8b\u542f\u52a8\u671f\u95f4\u8bfb\u53d6</li> <li>\u624b\u52a8\u4fee\u6539</li> </ol> </li> <li>\u52a8\u6001\u53c2\u6570\u6587\u4ef6\uff1apostgresql.auto.conf<ol> <li>\u9ed8\u8ba4\u5728PGDATA\u4e0b</li> <li>\u7531postgres\u8fdb\u7a0b\u7ef4\u62a4</li> <li><code>ALTER SYSTEM</code>\u547d\u4ee4\u4fee\u6539\u7684\u53c2\u6570\u4fdd\u5b58\u5728\u8be5\u6587\u4ef6</li> <li>\u80fd\u591f\u5728\u5173\u95ed\u548c\u542f\u52a8\u671f\u95f4\u6301\u7eed\u8fdb\u884c\u66f4\u6539</li> <li>\u53ef\u4ee5\u5b9e\u73b0\u81ea\u6211\u8c03\u6574\u53c2\u6570\u503c</li> </ol> </li> </ol> <p>\u8bfb\u53d6\u987a\u5e8f\uff1apostgresql.conf-&gt;postgresql.auto.conf</p> <pre><code>[postgres@pg1 data]$ psql\npsql (12.13)\nType \"help\" for help.\n                 ^\npostgres=# alter system set archive_mode=on;\nALTER SYSTEM\npostgres=# \\q\n[postgres@pg1 data]$ cat postgresql.auto.conf \n# Do not edit this file manually!\n# It will be overwritten by the ALTER SYSTEM command.\narchive_mode = 'on'\n</code></pre>"},{"location":"databases/PostgreSQL/%E7%AE%A1%E7%90%86/%E9%85%8D%E7%BD%AE/#_2","title":"\u4e8c\u3001\u53c2\u6570\u751f\u6548\u6761\u4ef6","text":"<ol> <li>sighup\uff1a\u8868\u793a\u9700\u8981\u8d85\u7ea7\u7ba1\u7406\u5458\u4fee\u6539\uff0creload\u5c31\u80fd\u591f\u751f\u6548</li> <li>superuser\uff1a\u8868\u793a\u4f7f\u7528\u8d85\u7ea7\u7ba1\u7406\u5458\u53ef\u4ee5\u4e3a\u666e\u901a\u7528\u6237\u3001\u6570\u636e\u5e93\u3001\u6216\u8005\u8d85\u7ea7\u7ba1\u7406\u5458\u81ea\u5df1\u4fee\u6539\uff08\u6709\u4e9b\u53c2\u6570\u662f\u53ef\u4ee5\u9488\u5bf9\u7528\u6237\u3001\u6570\u636e\u5e93\u5b9e\u4f8b\uff09\u3002</li> <li>postmaster\uff1a\u8868\u793a\u9700\u8981\u8d85\u7ea7\u7ba1\u7406\u5458\u4fee\u6539\uff0c\u9700\u8981\u91cd\u542f\u624d\u80fd\u591f\u751f\u6548\u3002</li> <li>user\uff1a\u8868\u793a\u666e\u901a\u7528\u6237\u53ef\u4ee5\u4fee\u6539\u8be5\u53c2\u6570\u503c\uff0c\u7acb\u5373\u751f\u6548\u3002</li> </ol> <pre><code>postgres=# select name,setting,context from pg_settings where name in ('port', 'work_mem', 'log_statement', 'log_checkpoints');\n      name       | setting |  context   \n-----------------+---------+------------\n log_checkpoints | off     | sighup\n log_statement   | none    | superuser\n port            | 5432    | postmaster\n work_mem        | 4096    | user\n(4 rows)\n</code></pre>"},{"location":"databases/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/benchmarksql/","title":"BenchmarkSQL","text":"<p>\u73af\u5883\u51c6\u5907</p> <pre><code>yum install -y epel-release\nyum install -y java ant R\n</code></pre> <p>\u5b89\u88c5benchmarksql</p> <pre><code>wget https://nchc.dl.sourceforge.net/project/benchmarksql/benchmarksql-5.0.zip --no-check-certificate\nunzip benchmarksql-5.0.zip \ncd benchmarksql-5.0/\nant\n</code></pre> <p>\u521b\u5efatpcc\u7528\u6237\u53ca\u6570\u636e\u5e93</p> <pre><code>create user tpcc with password 'tpcc@123';\ncreate database benchmark owner=tpcc;\n</code></pre> <p>\u914d\u7f6ebenchmarksql-5.0/run/props.pg</p> <pre><code>db=postgres\ndriver=org.postgresql.Driver\nconn=jdbc:postgresql://localhost:5432/benchmark\nuser=tpcc  # \u6570\u636e\u5e93\u7528\u4f8b\npassword=tpcc@123 # \u6570\u636e\u5e93\u5bc6\u7801\n\nwarehouses=10\nloadWorkers=4\n\nterminals=1\n//To run specified transactions per terminal- runMins must equal zero\nrunTxnsPerTerminal=0\n//To run for specified minutes- runTxnsPerTerminal must equal zero\nrunMins=5\n//Number of total transactions per minute\nlimitTxnsPerMin=300\n\n//Set to true to run in 4.x compatible mode. Set to false to use the\n//entire configured database evenly.\nterminalWarehouseFixed=true\n\n//The following five values must add up to 100\n//The default percentages of 45, 43, 4, 4 &amp; 4 match the TPC-C spec\nnewOrderWeight=45\npaymentWeight=43\norderStatusWeight=4\ndeliveryWeight=4\nstockLevelWeight=4\n\n// Directory name to create for collecting detailed result data.\n// Comment this out to suppress.\nresultDirectory=my_result_%tY-%tm-%td_%tH%tM%tS\nosCollectorScript=./misc/os_collector_linux.py\nosCollectorInterval=1\n//osCollectorSSHAddr=user@dbhost\nosCollectorDevices=net_ens33 blk_sda\n</code></pre> <p>\u5efa\u8868\u5e76\u63d2\u5165\u6570\u636e</p> <pre><code>$ bash benchmarksql-5.0/run/runDatabaseBuild.sh props.pg\n# ------------------------------------------------------------\n# Loading SQL file ./sql.common/tableCreates.sql\n# ------------------------------------------------------------\ncreate table bmsql_config (\ncfg_name    varchar(30) primary key,\ncfg_value   varchar(50)\n);\ncreate table bmsql_warehouse (\nw_id        integer   not null,\nw_ytd       decimal(12,2),\nw_tax       decimal(4,4),\nw_name      varchar(10),\nw_street_1  varchar(20),\nw_street_2  varchar(20),\nw_city      varchar(20),\nw_state     char(2),\nw_zip       char(9)\n);\ncreate table bmsql_district (\nd_w_id       integer       not null,\nd_id         integer       not null,\nd_ytd        decimal(12,2),\nd_tax        decimal(4,4),\nd_next_o_id  integer,\nd_name       varchar(10),\nd_street_1   varchar(20),\nd_street_2   varchar(20),\nd_city       varchar(20),\nd_state      char(2),\nd_zip        char(9)\n);\ncreate table bmsql_customer (\nc_w_id         integer        not null,\nc_d_id         integer        not null,\nc_id           integer        not null,\nc_discount     decimal(4,4),\nc_credit       char(2),\nc_last         varchar(16),\nc_first        varchar(16),\nc_credit_lim   decimal(12,2),\nc_balance      decimal(12,2),\nc_ytd_payment  decimal(12,2),\nc_payment_cnt  integer,\nc_delivery_cnt integer,\nc_street_1     varchar(20),\nc_street_2     varchar(20),\nc_city         varchar(20),\nc_state        char(2),\nc_zip          char(9),\nc_phone        char(16),\nc_since        timestamp,\nc_middle       char(2),\nc_data         varchar(500)\n);\ncreate sequence bmsql_hist_id_seq;\ncreate table bmsql_history (\nhist_id  integer,\nh_c_id   integer,\nh_c_d_id integer,\nh_c_w_id integer,\nh_d_id   integer,\nh_w_id   integer,\nh_date   timestamp,\nh_amount decimal(6,2),\nh_data   varchar(24)\n);\ncreate table bmsql_new_order (\nno_w_id  integer   not null,\nno_d_id  integer   not null,\nno_o_id  integer   not null\n);\ncreate table bmsql_oorder (\no_w_id       integer      not null,\no_d_id       integer      not null,\no_id         integer      not null,\no_c_id       integer,\no_carrier_id integer,\no_ol_cnt     integer,\no_all_local  integer,\no_entry_d    timestamp\n);\ncreate table bmsql_order_line (\nol_w_id         integer   not null,\nol_d_id         integer   not null,\nol_o_id         integer   not null,\nol_number       integer   not null,\nol_i_id         integer   not null,\nol_delivery_d   timestamp,\nol_amount       decimal(6,2),\nol_supply_w_id  integer,\nol_quantity     integer,\nol_dist_info    char(24)\n);\ncreate table bmsql_item (\ni_id     integer      not null,\ni_name   varchar(24),\ni_price  decimal(5,2),\ni_data   varchar(50),\ni_im_id  integer\n);\ncreate table bmsql_stock (\ns_w_id       integer       not null,\ns_i_id       integer       not null,\ns_quantity   integer,\ns_ytd        integer,\ns_order_cnt  integer,\ns_remote_cnt integer,\ns_data       varchar(50),\ns_dist_01    char(24),\ns_dist_02    char(24),\ns_dist_03    char(24),\ns_dist_04    char(24),\ns_dist_05    char(24),\ns_dist_06    char(24),\ns_dist_07    char(24),\ns_dist_08    char(24),\ns_dist_09    char(24),\ns_dist_10    char(24)\n);\nStarting BenchmarkSQL LoadData\n\ndriver=org.postgresql.Driver\nconn=jdbc:postgresql://localhost:5432/benchmark\nuser=tpcc\npassword=***********\nwarehouses=10\nloadWorkers=4\nfileLocation (not defined)\ncsvNullValue (not defined - using default 'NULL')\n\nWorker 000: Loading ITEM\nWorker 001: Loading Warehouse      1\nWorker 002: Loading Warehouse      2\nWorker 003: Loading Warehouse      3\nWorker 000: Loading ITEM done\nWorker 000: Loading Warehouse      4\nWorker 002: Loading Warehouse      2 done\nWorker 002: Loading Warehouse      5\nWorker 001: Loading Warehouse      1 done\nWorker 001: Loading Warehouse      6\nWorker 003: Loading Warehouse      3 done\nWorker 003: Loading Warehouse      7\nWorker 000: Loading Warehouse      4 done\nWorker 000: Loading Warehouse      8\nWorker 001: Loading Warehouse      6 done\nWorker 001: Loading Warehouse      9\nWorker 002: Loading Warehouse      5 done\nWorker 002: Loading Warehouse     10\nWorker 003: Loading Warehouse      7 done\nWorker 000: Loading Warehouse      8 done\nWorker 001: Loading Warehouse      9 done\nWorker 002: Loading Warehouse     10 done\n# ------------------------------------------------------------\n# Loading SQL file ./sql.common/indexCreates.sql\n# ------------------------------------------------------------\nalter table bmsql_warehouse add constraint bmsql_warehouse_pkey\nprimary key (w_id);\nalter table bmsql_district add constraint bmsql_district_pkey\nprimary key (d_w_id, d_id);\nalter table bmsql_customer add constraint bmsql_customer_pkey\nprimary key (c_w_id, c_d_id, c_id);\ncreate index bmsql_customer_idx1\non  bmsql_customer (c_w_id, c_d_id, c_last, c_first);\nalter table bmsql_oorder add constraint bmsql_oorder_pkey\nprimary key (o_w_id, o_d_id, o_id);\ncreate unique index bmsql_oorder_idx1\non  bmsql_oorder (o_w_id, o_d_id, o_carrier_id, o_id);\nalter table bmsql_new_order add constraint bmsql_new_order_pkey\nprimary key (no_w_id, no_d_id, no_o_id);\nalter table bmsql_order_line add constraint bmsql_order_line_pkey\nprimary key (ol_w_id, ol_d_id, ol_o_id, ol_number);\nalter table bmsql_stock add constraint bmsql_stock_pkey\nprimary key (s_w_id, s_i_id);\nalter table bmsql_item add constraint bmsql_item_pkey\nprimary key (i_id);\n# ------------------------------------------------------------\n# Loading SQL file ./sql.common/foreignKeys.sql\n# ------------------------------------------------------------\nalter table bmsql_district add constraint d_warehouse_fkey\nforeign key (d_w_id)\nreferences bmsql_warehouse (w_id);\nalter table bmsql_customer add constraint c_district_fkey\nforeign key (c_w_id, c_d_id)\nreferences bmsql_district (d_w_id, d_id);\nalter table bmsql_history add constraint h_customer_fkey\nforeign key (h_c_w_id, h_c_d_id, h_c_id)\nreferences bmsql_customer (c_w_id, c_d_id, c_id);\nalter table bmsql_history add constraint h_district_fkey\nforeign key (h_w_id, h_d_id)\nreferences bmsql_district (d_w_id, d_id);\nalter table bmsql_new_order add constraint no_order_fkey\nforeign key (no_w_id, no_d_id, no_o_id)\nreferences bmsql_oorder (o_w_id, o_d_id, o_id);\nalter table bmsql_oorder add constraint o_customer_fkey\nforeign key (o_w_id, o_d_id, o_c_id)\nreferences bmsql_customer (c_w_id, c_d_id, c_id);\nalter table bmsql_order_line add constraint ol_order_fkey\nforeign key (ol_w_id, ol_d_id, ol_o_id)\nreferences bmsql_oorder (o_w_id, o_d_id, o_id);\nalter table bmsql_order_line add constraint ol_stock_fkey\nforeign key (ol_supply_w_id, ol_i_id)\nreferences bmsql_stock (s_w_id, s_i_id);\nalter table bmsql_stock add constraint s_warehouse_fkey\nforeign key (s_w_id)\nreferences bmsql_warehouse (w_id);\nalter table bmsql_stock add constraint s_item_fkey\nforeign key (s_i_id)\nreferences bmsql_item (i_id);\n# ------------------------------------------------------------\n# Loading SQL file ./sql.postgres/extraHistID.sql\n# ------------------------------------------------------------\n-- ----\n-- Extra Schema objects/definitions for history.hist_id in PostgreSQL\n-- ----\n-- ----\n--      This is an extra column not present in the TPC-C\n--      specs. It is useful for replication systems like\n--      Bucardo and Slony-I, which like to have a primary\n--      key on a table. It is an auto-increment or serial\n--      column type. The definition below is compatible\n--      with Oracle 11g, using a sequence and a trigger.\n-- ----\n-- Adjust the sequence above the current max(hist_id)\nselect setval('bmsql_hist_id_seq', (select max(hist_id) from bmsql_history));\n-- Make nextval(seq) the default value of the hist_id column.\nalter table bmsql_history\nalter column hist_id set default nextval('bmsql_hist_id_seq');\n-- Add a primary key history(hist_id)\nalter table bmsql_history add primary key (hist_id);\n# ------------------------------------------------------------\n# Loading SQL file ./sql.postgres/buildFinish.sql\n# ------------------------------------------------------------\n-- ----\n-- Extra commands to run after the tables are created, loaded,\n-- indexes built and extra's created.\n-- PostgreSQL version.\n-- ----\nvacuum analyze;\n</code></pre> <p>\u8fd0\u884ctpcc</p> <pre><code>$ bash benchmarksql-5.0/run/runBenchmark.sh props.pg\n14:40:50,112 [main] INFO   jTPCC : Term-00, \n14:40:50,114 [main] INFO   jTPCC : Term-00, +-------------------------------------------------------------+\n14:40:50,115 [main] INFO   jTPCC : Term-00,      BenchmarkSQL v5.0\n14:40:50,115 [main] INFO   jTPCC : Term-00, +-------------------------------------------------------------+\n14:40:50,115 [main] INFO   jTPCC : Term-00,  (c) 2003, Raul Barbosa\n14:40:50,116 [main] INFO   jTPCC : Term-00,  (c) 2004-2016, Denis Lussier\n14:40:50,120 [main] INFO   jTPCC : Term-00,  (c) 2016, Jan Wieck\n14:40:50,120 [main] INFO   jTPCC : Term-00, +-------------------------------------------------------------+\n14:40:50,121 [main] INFO   jTPCC : Term-00, \n14:40:50,122 [main] INFO   jTPCC : Term-00, db=postgres\n14:40:50,126 [main] INFO   jTPCC : Term-00, driver=org.postgresql.Driver\n14:40:50,127 [main] INFO   jTPCC : Term-00, conn=jdbc:postgresql://localhost:5432/benchmark\n14:40:50,128 [main] INFO   jTPCC : Term-00, user=tpcc\n14:40:50,128 [main] INFO   jTPCC : Term-00, \n14:40:50,134 [main] INFO   jTPCC : Term-00, warehouses=10\n14:40:50,136 [main] INFO   jTPCC : Term-00, terminals=1\n14:40:50,140 [main] INFO   jTPCC : Term-00, runMins=5\n14:40:50,140 [main] INFO   jTPCC : Term-00, limitTxnsPerMin=300\n14:40:50,143 [main] INFO   jTPCC : Term-00, terminalWarehouseFixed=true\n14:40:50,145 [main] INFO   jTPCC : Term-00, \n14:40:50,147 [main] INFO   jTPCC : Term-00, newOrderWeight=45\n14:40:50,150 [main] INFO   jTPCC : Term-00, paymentWeight=43\n14:40:50,151 [main] INFO   jTPCC : Term-00, orderStatusWeight=4\n14:40:50,152 [main] INFO   jTPCC : Term-00, deliveryWeight=4\n14:40:50,152 [main] INFO   jTPCC : Term-00, stockLevelWeight=4\n14:40:50,153 [main] INFO   jTPCC : Term-00, \n14:40:50,153 [main] INFO   jTPCC : Term-00, resultDirectory=my_result_%tY-%tm-%td_%tH%tM%tS\n14:40:50,154 [main] INFO   jTPCC : Term-00, osCollectorScript=./misc/os_collector_linux.py\n14:40:50,156 [main] INFO   jTPCC : Term-00, \n14:40:50,183 [main] INFO   jTPCC : Term-00, copied props.pg to my_result_2023-03-01_144050/run.properties\n14:40:50,184 [main] INFO   jTPCC : Term-00, created my_result_2023-03-01_144050/data/runInfo.csv for runID 3\n14:40:50,187 [main] INFO   jTPCC : Term-00, writing per transaction results to my_result_2023-03-01_144050/data/result.csv\n14:40:50,194 [main] INFO   jTPCC : Term-00, osCollectorScript=./misc/os_collector_linux.py\n14:40:50,195 [main] INFO   jTPCC : Term-00, osCollectorInterval=1\n14:40:50,196 [main] INFO   jTPCC : Term-00, osCollectorSSHAddr=null\n14:40:50,197 [main] INFO   jTPCC : Term-00, osCollectorDevices=net_ens33 blk_sda\n14:40:50,323 [main] INFO   jTPCC : Term-00,\n14:40:50,430 [main] INFO   jTPCC : Term-00, C value for C_LAST during load: 199\n14:40:50,430 Term-00, Running Average tpmTOTAL: 295.26    Current tpmTOTAL: 9780    Memory Usage: 6MB / 30MB                                                 14:45:50,798 [Thread-1] INFO   jTPCC : Term-00,                                                                                                              14:45:50,799 [Thread-1] INFO   jTPCC : Term-00,                                                        \n14:45:50,800 [Thread-1] INFO   jTPCC : Term-00, Measured tpmC (NewOrders) = 132.85\n14:45:50,804 [Thread-1] INFO   jTPCC : Term-00, Measured tpmTOTAL = 295.07\n14:45:50,811 [Thread-1] INFO   jTPCC : Term-00, Session Start     = 2023-03-01 14:40:50\n14:45:50,812 [Thread-1] INFO   jTPCC : Term-00, Session End       = 2023-03-01 14:45:50\n14:45:50,813 [Thread-1] INFO   jTPCC : Term-00, Transaction Count = 147\n</code></pre> <p>\u751f\u6210\u62a5\u544a</p> <pre><code>postgres@ubuntu:~/benchmarksql-5.0/run$ bash ./generateReport.sh my_result_2023-03-01_144050\nGenerating my_result_2023-03-01_144050/tpm_nopm.png ... OK\nGenerating my_result_2023-03-01_144050/latency.png ... OK\nGenerating my_result_2023-03-01_144050/cpu_utilization.png ... OK\nGenerating my_result_2023-03-01_144050/dirty_buffers.png ... OK\nGenerating my_result_2023-03-01_144050/blk_sda_iops.png ... OK\nGenerating my_result_2023-03-01_144050/blk_sda_kbps.png ... OK\nGenerating my_result_2023-03-01_144050/net_ens33_iops.png ... OK\nGenerating my_result_2023-03-01_144050/net_ens33_kbps.png ... OK\nGenerating my_result_2023-03-01_144050/report.html ... OK\n</code></pre> <p>\u67e5\u770bhtml\u62a5\u544a</p> <p></p>"},{"location":"databases/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/sysbench/","title":"sysbench","text":""},{"location":"databases/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/sysbench/#_1","title":"\u4e00\u3001\u5b89\u88c5","text":"<pre><code>yum -y install make automake libtool pkgconfig libaio-devel git\ngit clone https://github.com/akopytov/sysbench.git\ncd sysbench\n./autogen.sh\n./configure  --with-pgsql --without-mysql --prefix=/home/postgres/tools/sysbench\nmake -j\nmake install\n</code></pre> <pre><code>[postgres@host136 sysbench]$ tree -L 3\n.\n\u251c\u2500\u2500 bin\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 sysbench\n\u2514\u2500\u2500 share\n    \u2514\u2500\u2500 sysbench\n        \u251c\u2500\u2500 bulk_insert.lua\n        \u251c\u2500\u2500 oltp_common.lua\n        \u251c\u2500\u2500 oltp_delete.lua\n        \u251c\u2500\u2500 oltp_insert.lua\n        \u251c\u2500\u2500 oltp_point_select.lua\n        \u251c\u2500\u2500 oltp_read_only.lua\n        \u251c\u2500\u2500 oltp_read_write.lua\n        \u251c\u2500\u2500 oltp_update_index.lua\n        \u251c\u2500\u2500 oltp_update_non_index.lua\n        \u251c\u2500\u2500 oltp_write_only.lua\n        \u251c\u2500\u2500 select_random_points.lua\n        \u251c\u2500\u2500 select_random_ranges.lua\n        \u2514\u2500\u2500 tests\n\n4 directories, 13 files\n</code></pre>"},{"location":"databases/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/sysbench/#_2","title":"\u521b\u5efa\u7528\u6237","text":"<pre><code>postgres=# create database sysbenchdb;\nCREATE DATABASE\npostgres=# CREATE USER sysbench_user SUPERUSER PASSWORD '123456'; \nCREATE ROLE\n</code></pre>"},{"location":"databases/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/sysbench/#prepare","title":"prepare","text":"<pre><code>[postgres@host136 sysbench]$ ./bin/sysbench ./share/sysbench/oltp_read_write.lua --db-driver=pgsql --pgsql-host=127.0.0.1 --pgsql-port=5432 --pgsql-user=sysbench_user --pgsql-password='123456' --pgsql-db=sysbenchdb --tables=10 --table-size=1000000 --threads=10 --time=300  --report-interval=10 prepare\nsysbench 1.1.0-de18a03 (using bundled LuaJIT 2.1.0-beta3)\n\nInitializing worker threads...\n\nCreating table 'sbtest1'...\nCreating table 'sbtest2'...\nCreating table 'sbtest3'...\nCreating table 'sbtest6'...\nCreating table 'sbtest8'...\nInserting 1000000 records into 'sbtest3'\nInserting 1000000 records into 'sbtest2'\nCreating table 'sbtest9'...\nCreating table 'sbtest5'...\nInserting 1000000 records into 'sbtest1'\nCreating table 'sbtest10'...\nCreating table 'sbtest7'...Creating table 'sbtest4'...\n\nInserting 1000000 records into 'sbtest6'\nInserting 1000000 records into 'sbtest8'\nInserting 1000000 records into 'sbtest5'\nInserting 1000000 records into 'sbtest9'\nInserting 1000000 records into 'sbtest7'\nInserting 1000000 records into 'sbtest4'\nInserting 1000000 records into 'sbtest10'\nCreating a secondary index on 'sbtest9'...\nCreating a secondary index on 'sbtest7'...\nCreating a secondary index on 'sbtest1'...\nCreating a secondary index on 'sbtest3'...\nCreating a secondary index on 'sbtest4'...\nCreating a secondary index on 'sbtest5'...\nCreating a secondary index on 'sbtest6'...\nCreating a secondary index on 'sbtest10'...\nCreating a secondary index on 'sbtest8'...\nCreating a secondary index on 'sbtest2'...\n</code></pre>"},{"location":"databases/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/sysbench/#run","title":"run","text":"<pre><code>[postgres@host136 sysbench]$ ./bin/sysbench ./share/sysbench/oltp_read_write.lua --db-driver=pgsql --pgsql-host=127.0.0.1 --pgsql-port=5432 --pgsql-user=sysbench_user --pgsql-password='123456' --pgsql-db=sysbenchdb --tables=10 --table-size=1000000 --threads=10 --time=60  --report-interval=10 run\nsysbench 1.1.0-de18a03 (using bundled LuaJIT 2.1.0-beta3)\n\nRunning the test with following options:\nNumber of threads: 10\nReport intermediate results every 10 second(s)\nInitializing random number generator from current time\n\n\nInitializing worker threads...\n\nThreads started!\n\n[ 10s ] thds: 10 tps: 214.05 qps: 4292.16 (r/w/o: 3006.47/856.59/429.10) lat (ms,95%): 77.19 err/s: 0.00 reconn/s: 0.00\n[ 20s ] thds: 10 tps: 205.24 qps: 4103.69 (r/w/o: 2872.65/820.56/410.48) lat (ms,95%): 81.48 err/s: 0.00 reconn/s: 0.00\n[ 30s ] thds: 10 tps: 196.67 qps: 3932.76 (r/w/o: 2751.92/787.49/393.35) lat (ms,95%): 86.00 err/s: 0.00 reconn/s: 0.00\n[ 40s ] thds: 10 tps: 173.60 qps: 3474.43 (r/w/o: 2432.85/694.39/347.19) lat (ms,95%): 102.97 err/s: 0.00 reconn/s: 0.00\n[ 50s ] thds: 10 tps: 197.83 qps: 3956.17 (r/w/o: 2769.40/791.11/395.66) lat (ms,95%): 89.16 err/s: 0.00 reconn/s: 0.00\n[ 60s ] thds: 10 tps: 195.72 qps: 3917.27 (r/w/o: 2741.93/783.89/391.45) lat (ms,95%): 86.00 err/s: 0.00 reconn/s: 0.00\nSQL statistics:\n    queries performed:\n        read:                            165802\n        write:                           47372\n        other:                           23686\n        total:                           236860\n    transactions:                        11843  (196.93 per sec.)\n    queries:                             236860 (3938.53 per sec.)\n    ignored errors:                      0      (0.00 per sec.)\n    reconnects:                          0      (0.00 per sec.)\n\nThroughput:\n    events/s (eps):                      196.9265\n    time elapsed:                        60.1392s\n    total number of events:              11843\n\nLatency (ms):\n         min:                                    6.97\n         avg:                                   50.72\n         max:                                  406.61\n         95th percentile:                       87.56\n         sum:                               600676.82\n\nThreads fairness:\n    events (avg/stddev):           1184.3000/16.27\n    execution time (avg/stddev):   60.0677/0.05\n</code></pre>"},{"location":"english/NCE/NCE2/","title":"NCE2","text":""},{"location":"english/NCE/NCE2/#01-a-private-conversation","title":"01 A Private Conversation","text":"<p>Last week I went to the theatre. I had a very good seat. The play was very interesting. I did not enjoy it. A young man and a young woman were sitting behind me. They were talking loudly. I got very angry. I could not hear the actors. I turned round. I looked at the man and the woman angrily. They did not pay any attention. In the end, I could not bear it. I turned round again. 'I can't hear a word!' I said angrily. 'It's none of your business,' the young man said rudely. 'This is a private conversation!'</p>"},{"location":"english/NCE/NCE2/#expressions","title":"Expressions","text":"<ul> <li>go to the theatre</li> <li>have a good seat</li> <li>get angry</li> <li>turn round</li> <li>pay attention</li> <li>in the end</li> <li>couldn\u2019t bear it</li> <li>It\u2019s none of your business</li> </ul>"},{"location":"english/NCE/NCE2/#_1","title":"\u73b0\u5728\u8fdb\u884c\u65f6","text":"<p>\u7528\u6cd51\uff1a\u4e00\u4e2a\u52a8\u4f5c\u6b63\u5728\u53d1\u751f</p> <p>\u4f8b\u53e5\uff1aWe are having a conversation.</p> <p>\u7528\u6cd52\uff1a\u8868\u8fd1\u671f\u8ba1\u5212\uff0c\u5b89\u6392</p> <p>\u4f8b\u53e5\uff1aI am meeting my friends tonight.</p>"},{"location":"english/NCE/NCE2/#_2","title":"\u4e00\u822c\u73b0\u5728\u65f6","text":"<p>\u7528\u6cd51\uff1a\u4e60\u60ef\u52a8\u4f5c</p> <p>\u4f8b\u53e5\uff1aHe goes to that theatre every weekend.</p> <p>\u7528\u6cd52\uff1a\u5ba2\u89c2\u4e8b\u5b9e</p> <p>\u4f8b\u53e5\uff1aThe Earth revolves around the Sun.</p>"},{"location":"english/NCE/NCE2/#02-breakfast-or-lunch","title":"02 Breakfast or Lunch","text":"<p>It was Sunday. I never get up early on Sundays. I sometimes stay in bed until lunchtime. Last Sunday I got up very late. I looked out of the window. It was dark outside. 'What a day!' I thought. 'It's raining again.' Just then, the telephone rang. It was my aunt Lucy. 'I've just arrived by train,' she said. 'I'm coming to see you.' 'But I'm still having breakfast,' I said. 'What are you doing?' she asked. 'I'm having breakfast,' I repeated. 'Dear me,' she said. 'Do you always get up so late? It's one o'clock!'</p>"},{"location":"english/NCE/NCE2/#what","title":"What \u611f\u53f9\u53e5","text":"<p>\u7528\u6cd5\uff1aWhat + (\u5f62\u5bb9\u8bcd) + n. + (\u4e3b\u8bed+\u8c13\u8bed)</p> <p>\u4f8b\u53e5\uff1aWhat a beautiful picture this is!</p>"},{"location":"english/NCE/NCE2/#_3","title":"\u9891\u7387\u526f\u8bcd","text":"<p>always &amp; usually &amp; sometimes</p> <p>\u4e00\u822c\u653e\u5728\u52a8\u8bcd\u524d\u6216\u8005be\u540e</p>"},{"location":"english/NCE/NCE2/#_4","title":"\u7279\u6b8a\u7591\u95ee\u53e5","text":"<p>\u8bed\u6cd5\uff1a\u7591\u95ee\u8bcd + \u4e00\u822c\u7591\u95ee\u53e5\u8bed\u5e8f</p>"},{"location":"english/NCE/NCE2/#03-please-send-me-a-card","title":"03 Please Send Me a Card","text":"<p>Postcards always spoil my holidays. Last summer, I went to Italy. I visited museums and sat in public gardens. A friendly waiter taught me a few words of Italian. Then he lent me a book. I read a few lines, but I did not understand a word. Everyday I thought about postcards. My holidays passed quickly, but I did not send cards to my friends. On the last day I made a big decision. I got up early and bought thirty-seven cards. I spent the whole day in my room, but I did not write a single card!</p>"},{"location":"english/NCE/NCE2/#expressions_1","title":"Expressions","text":"<ul> <li> <p>buy sb. sth.= buy sth. for sb.</p> </li> <li> <p>send sb. sth.= send sth. to sb.</p> </li> <li> <p>lend sth. to sb. = lend sb. sth.  \u501f\u51fa</p> </li> <li> <p>borrow sth. from sb.  = borrow sth. \u501f\u8fdb</p> </li> <li> <p>make a decision</p> </li> <li> <p>teach sb. sth.</p> </li> <li> <p>think about sth./sb. -- I think about you every night and day.</p> </li> <li> <p>on the last day</p> </li> <li> <p>spend st. sw.</p> </li> </ul>"},{"location":"english/NCE/NCE2/#_5","title":"\u4e00\u822c\u8fc7\u53bb\u5f0f","text":"<p>\u7528\u6cd51\uff1a\u8fc7\u53bb\u7684\u72b6\u6001</p> <p>\u4f8b\u53e5\uff1aHe was very angry yesterday.</p> <p>\u7528\u6cd52\uff1a\u4e00\u4e2a\u52a8\u4f5c\u53d1\u751f\u5728\u8fc7\u53bb</p> <p>\u4f8b\u53e5\uff1aI had breakfast this morning.</p>"},{"location":"english/NCE/NCE2/#04-an-exciting-trip","title":"04 An Exciting Trip","text":"<p>I have just received a letter from my brother, Tim. He is in Australia. He has been there for six months. Tim is an engineer. He is working for a big firm and he has already visited a great number of different places in Australia. He has just bought an Australian car and has gone to Alice Springs, a small town in the centre of Australia. He will soon visit Darwin. From there, he will fly to Perth. My brother has never been abroad before, so he is finding this trip very exciting.</p> <p>center \u7f8e\u5f0f\uff0ccentre \u82f1\u5f0f</p>"},{"location":"english/NCE/NCE2/#expressions_2","title":"Expressions","text":"<ul> <li>have a great trip</li> <li> <p>receive sth. from sb.</p> </li> <li> <p>work for sb.  -- He has worked for this firm for 6 years.</p> </li> <li> <p>A be different from B</p> </li> <li> <p>in the center of sw.</p> </li> <li> <p>go abroad</p> </li> <li> <p>live abroad</p> </li> <li> <p>study abroad</p> </li> <li> <p>a great number of + \u590d\u6570\u53ef\u6570\u540d\u8bcd</p> </li> <li> <p>have gone to sw. \u53bb\u4e86\u8fd8\u6ca1\u56de\u6765</p> </li> <li> <p>have been to sw. \u53bb\u8fc7\u5df2\u7ecf\u56de\u6765\u4e86</p> </li> <li> <p>fly to sw.</p> </li> <li> <p>find n. adj.  -- Men usually find women very beautiful in the bar at night.</p> </li> </ul>"},{"location":"english/NCE/NCE2/#_6","title":"\u73b0\u5728\u5b8c\u6210\u65f6","text":"<p>\u80af\u5b9a\u53e5\uff1ahave/has done</p> <p>\u5426\u5b9a\u53e5\uff1a have/has not done</p> <p>\u4e00\u822c\u7591\u95ee\u53e5\uff1ahave/has\u63d0\u524d&amp;done\u4e0d\u53d8</p> <p>\u7528\u6cd51\uff1a\u8fc7\u53bb\u7684\u4e8b\u60c5\u5bf9\u73b0\u5728\u4ea7\u751f\u4e86\u5f71\u54cd\uff08\u2f94\u4e4b\u8fc7\u53bb\uff0c\u610f\u5728\u5f53\u4e0b\uff09\u2248 did</p> <p>\u4f8b\u53e5\uff1aThey have gone out.(They are not at home now.)</p> <p>\u7528\u6cd52\uff1a\u4ece\u8fc7\u53bb\u6301\u7eed\u5230\u73b0\u5728\u7684\u4e8b\u60c5</p> <p>\u4f8b\u53e5\uff1aI have lived in Beijing for 10 years/since 2012. </p>"},{"location":"english/NCE/NCE2/#05-no-wrong-numbers","title":"05 No Wrong Numbers","text":"<p>Mr.James Scott has a garage(\u8f66\u5e93) /\u0261\u0259\u02c8r\u0251\u02d0\u0292/ in Silbury and now he has just bought another garage in Pinhurst. Pinhurst is only five miles from Silbury, but Mr. Scott cannot get a telephone for his new garage, so he has just bought twelve pigeons(\u9e3d\u5b50). /\u02c8p\u026ad\u0292\u026an/ Yesterday, a pigeon carried the first message from Pinhurst to Silbury. The bird covered the distance in three minutes. Up to now, Mr.Scott has sent a great many requests for spare parts and other urgent messages from one garage to the other. In this way, he has begun his own private 'telephone' service.</p>"},{"location":"english/NCE/NCE2/#expressions_3","title":"Expressions","text":"<ul> <li>leave sb. a message</li> <li> <p>customer service</p> </li> <li> <p>cover the distance in st.</p> </li> <li> <p>A is 5 miles from B</p> </li> <li> <p>get sth. for sb.</p> </li> <li> <p>a great many + \u53ef\u6570\u540d\u8bcd\u590d\u6570</p> </li> <li> <p>send a request for sth.</p> </li> <li> <p>up to now</p> </li> <li> <p>in this way</p> </li> </ul>"},{"location":"english/NCE/NCE2/#06-percy-buttons","title":"06 Percy Buttons","text":"<p>I have just moved to a house in Bridge Street. Yesterday a beggar knocked at my door. He asked me for a meal and a glass of beer. In return for this, the beggar stood on his head and sang songs. I gave him a meal. He ate the food and drank the beer. Then he put a piece of cheese in his pocket and went away. Later a neighbour told me about him. Everybody knows him. His name is Percy Buttons. He calls at every house in the street once a month and always asks for a meal and a glass of beer.</p>"},{"location":"english/NCE/NCE2/#expressions_4","title":"Expressions","text":"<ul> <li>pocket money \u96f6\u7528\u94b1</li> <li> <p>call at = visit</p> </li> <li> <p>move to sw.</p> </li> <li> <p>knock at the door \u6572\u95e8</p> </li> <li> <p>ask sb. for sth.</p> </li> <li> <p>stand on sb\u2019s head \u5012\u7acb</p> </li> <li> <p>in return for this</p> </li> <li> <p>once a st.</p> </li> <li> <p>mineral water \u77ff\u6cc9\u6c34</p> </li> </ul>"},{"location":"english/NCE/NCE2/#07-too-late","title":"07 Too Late","text":"<p>The plane was late and detectives(\u4fa6\u63a2) were waiting at the airport all morning. They were expecting a valuable parcel(\u5305\u88f9) of diamonds(\u94bb\u77f3) from South Africa. A few hours earlier,  someone had told the police that thieves would try to steal(\u5077) the diamonds. When the plane arrived, some of the detectives were waiting inside the main building while others were waiting on the airfield(\u673a\u573a). Two men took the parcel off the plane and carried it into the Customs House. While two detectives were keeping guard(\u5b88\u536b) at the door, two others opened the parcel. To their surprise, the precious(\u73cd\u8d35\u7684) parcel was full of stones and sand!</p>"},{"location":"english/NCE/NCE2/#_7","title":"\u8fc7\u53bb\u8fdb\u884c\u65f6","text":"<p>\u7528\u6cd5\uff1a\u2f00\u4e2a\u52a8\u4f5c\u8fc7\u53bb\u6b63\u5728\u8fdb\u884c</p> <p>\u80af\u5b9a\uff1awas/were + v.ing(\u73b0\u5728\u5206\u8bcd)</p> <p>\u5426\u5b9a\uff1awas/were not</p> <p>\u4e00\u822c\u7591\u95ee\uff1awas/were \u63d0\u53e5\u9996</p> <p>when while as... \u5f53/\u4e0e...\u540c\u65f6</p> <p>as/when: did or was/were+doing </p> <p>while: did or was/were+doing </p> <p>was/were+doing \u6301\u7eed\u65f6\u95f4\u66f4\u2ed3\u7684\u52a8\u4f5c</p>"},{"location":"english/NCE/NCE2/#expressions_5","title":"Expressions","text":"<ul> <li> <p>all morning</p> </li> <li> <p>a parcel of sth.</p> </li> <li> <p>A few hours earlier</p> </li> <li> <p>keep guard</p> </li> <li> <p>to sb.\u2019s surprise</p> </li> <li> <p>try to do sth.</p> </li> <li> <p>A be full of B</p> </li> </ul>"},{"location":"english/NCE/NCE2/#08-the-best-and-the-worst","title":"08 The Best and the Worst","text":"<p>Joe Sanders has the most beautiful garden in our town. Nearly everybody enters for 'The Nicest Garden Competition' each year, but Joe wins every time. Bill Frith's garden is larger than Joe's. Bill works harder than Joe and grows more flowers and vegetables, but Joe's garden is more interesting. He has made neat paths and has built a wooden bridge over a pool. I like gardens too, but I do not like hard work. Every year I enter for the garden competition too, and I always win a little prize for the worst garden in the town!</p>"},{"location":"english/NCE/NCE2/#expressions_6","title":"Expressions","text":"<ul> <li>swimming pool</li> <li> <p>enter the competition  \u53c2\u52a0\u6bd4\u8d5b</p> </li> <li> <p>enter for \u53c2\u52a0</p> </li> <li> <p>make a path</p> </li> <li> <p>That\u2019s neat/cool.</p> </li> <li> <p>make a path</p> </li> <li> <p>build a bridge</p> </li> <li> <p>win a prize</p> </li> </ul>"},{"location":"english/NCE/NCE2/#_8","title":"\u5f62\u5bb9\u8bcd\u6bd4\u8f83\u7ea7\u3001\u6700\u9ad8\u7ea7","text":""},{"location":"english/NCE/NCE2/#1-erest","title":"1. \u5355\u97f3\u8282\uff1a+er/est","text":"<p>small \u2192 smaller \u2192 smallest</p>"},{"location":"english/NCE/NCE2/#2-e-rst","title":"2. \u5355\u97f3\u8282\uff1a\u4ee5e\u7ed3\u5c3e +r/st","text":"<p>large \u2192 larger \u2192 largest</p>"},{"location":"english/NCE/NCE2/#3-er-est","title":"3. \u5355\u97f3\u8282\uff1a\u5143+\u8f85\u7ed3\u5c3e\uff0c\u53cc\u5199\u8f85\u2fb3\u5b57\u2e9f\uff0c\u52a0er, est","text":"<p>big \u2192 bigger \u2192 biggest</p>"},{"location":"english/NCE/NCE2/#4-yyier-est","title":"4. \u53cc\u97f3\u8282\uff1a\u8f85\u97f3\u5b57\u6bcd+y\u7ed3\u5c3e\u7684\uff0c\u628ay\u53d8\u4e3ai\uff0c\u52a0er, est","text":"<p>easy \u2192 easier \u2192 easiest</p> <p>famous \u2192 more famous \u2192 the most famous</p>"},{"location":"english/NCE/NCE2/#5","title":"5. \u4e0d\u89c4\u5219","text":"<p>good/well \u2192 better \u2192 best</p> <p>bad \u2192 worse \u2192 worst</p> <p>much /many \u2192 more \u2192 most</p> <p>little \u2192 less \u2192 least</p>"},{"location":"english/NCE/NCE2/#6-adj3more-most","title":"6. \u591a\u97f3\u8282adj\uff08\u5927\u4e8e\u7b49\u4e8e3)\uff0c\u524d\u52a0more, most\u8868\u80af\u5b9a","text":"<p>beautiful \u2192 more beautiful\u2192 the most beautiful</p>"},{"location":"english/NCE/NCE2/#7-adj3less-least","title":"7. \u591a\u97f3\u8282adj.(\u5927\u4e8e\u7b49\u4e8e3)\uff0c\u524d\u52a0less, least\u8868\u5426\u5b9a","text":"<p>beautiful\u2192less beautiful\u2192the least beautiful</p>"},{"location":"english/NCE/NCE2/#_9","title":"\u5f62\u5bb9\u8bcd\u6bd4\u8f83\u7ea7\u3001\u6700\u9ad8\u7ea7\u7528\u6cd5","text":""},{"location":"english/NCE/NCE2/#1-beadjerthani-formal-me-informal","title":"1. \u4e3b\u8bed+be+adj.er+than+\u2f50\u8f83\u5bf9\u8c61(I formal/ me informal)","text":"<p>The left one is smaller than the right one.</p>"},{"location":"english/NCE/NCE2/#2-betheadjest-n","title":"2. \u4e3b\u8bed+be+the+adj.est +n.+\u8303\u56f4","text":"<p>My mom is the kindest person in the world.</p>"},{"location":"english/NCE/NCE2/#3-betheadjestnive-ever-metseen","title":"3. \u4e3b\u8bed+be+the+adj.est+n.+I\u2019ve ever met/seen","text":"<p>Yao Ming is the tallest guy I\u2019ve ever seen.</p>"},{"location":"english/NCE/NCE2/#09-a-cold-welcome","title":"09 A Cold Welcome","text":"<p>On Wednesday evening, we went to the Town Hall. It was the last day of the year and a large crowd of people had gathered under the Town Hall clock. It would strike twelve in twenty minutes' time. Fifteen minutes passed and then, at five to twelve, the clock stopped. The big minute hand did not move. We waited and waited, but nothing happened. Suddenly someone shouted. 'It's two minutes past twelve! The clock has stopped!' I looked at my watch. It was true. The big clock refused to welcome the New Year. At that moment, everybody began to laugh and sing.</p>"},{"location":"english/NCE/NCE2/#expressions_7","title":"Expressions","text":"<ul> <li>second hand; minute hand; hour hand -\u79d2\u9488\uff1b\u5206\u9488\uff1b\u65f6\u9488</li> <li> <p>shout at sb. (This suggests that we\u2019re angry.) </p> </li> <li> <p>shout to sb. (When we shout to someone, we want them to hear us. They might be on the other side of the street)</p> </li> <li> <p>in+\u5e74/\u5b63/\u6708</p> </li> <li> <p>on+\u5177\u4f53\u67d0\u4e00\u5929</p> </li> <li> <p>at + \u65f6\u95f4\u70b9</p> </li> <li> <p>the last day of the year</p> </li> <li> <p>a large crowd of</p> </li> <li> <p>in twenty minutes' time</p> </li> <li> <p>refused to do sth.</p> </li> <li> <p>at that moment</p> </li> <li> <p>begin to do sth.</p> </li> </ul>"},{"location":"english/NCE/NCE2/#10-not-for-jazz","title":"10 Not for Jazz","text":"<p>We have an old musical instrument. It is called a clavichord(\u53e4\u94a2\u7434). It was made in Germany in 1681. Our clavichord is kept in the living room. It has belonged to our family for a long time. The instrument was bought by my grandfather many years ago. Recently it was damaged by a visitor. She tried to play jazz on it! She struck the keys too hard and two of the strings were broken. My father was shocked. Now we are not allowed to touch it. It is being repaired by a friend of my father's.</p>"},{"location":"english/NCE/NCE2/#expressions_8","title":"Expressions","text":"<ul> <li>musical instrument \u4e50\u5668</li> <li> <p>be allowed to do sth. </p> </li> <li> <p>allow sb. to do sth.</p> </li> <li>Who was the music composed by? \u88ab\u52a8\u8bed\u6001\u7591\u95ee\u53e5</li> </ul>"},{"location":"english/NCE/NCE2/#_10","title":"\u88ab\u52a8","text":"<p>\u7ed3\u6784\uff1abe(\u8868\u65f6\u6001) + done(\u8868\u88ab\u52a8)</p> <p>am/is/are + done \u4e00\u822c\u73b0\u5728\u65f6</p> <p>was/were + done \u4e00\u822c\u8fc7\u53bb\u65f6</p> <p>am/is/are + being + done \u73b0\u5728\u8fdb\u884c\u65f6</p> <p>have/has + been + done \u73b0\u5728\u5b8c\u6210\u65f6</p>"},{"location":"english/NCE/NCE2/#11-one-good-turn-deserves-another","title":"11 One Good Turn Deserves Another","text":"<p>I was having dinner at a restaurant when Tony Steele came in. Tony worked in a lawyer's office years ago, but he is now working at a bank. He gets a good salary, but he always borrows money from his friends and never pays it back. Tony saw me and came and sat at the same table. He has never borrowed money from me. While he was eating, I asked him to lend me twenty pounds. To my surprise, he gave me the money immediately. 'I have never borrowed any money from you,' Tony said, 'so now you can pay for my dinner!'</p>"},{"location":"english/NCE/NCE2/#expressions_9","title":"Expressions","text":"<ul> <li>One Good Turn Deserves Another \u793c\u5c1a\u5f80\u6765</li> <li>get a good salary </li> <li>borrow sth. from sb. </li> <li>pay it back</li> <li>pay for sth. </li> <li>ask sb. to do sth.</li> </ul>"},{"location":"english/NCE/NCE2/#12-goodbye-and-good-luck","title":"12 Goodbye and Good Luck","text":"<p>Our neighbour, Captain(\u8239\u957f) Charles Alison, will sail(\u822a\u884c) from Portsmouth tomorrow. We'll meet him at the harbour(\u6e2f\u53e3) early in the morning. He will be in his small boat, Topsail. Topsail is a famous little boat. It has sailed across the Atlantic many times. Captain Alison will set out at eight o'clock, so we'll have plenty of time. We'll see his boat and then we'll say goodbye to him. He will be away for two months. We are very proud of him. He will take part in an important race across the Atlantic.</p>"},{"location":"english/NCE/NCE2/#expressions_10","title":"Expressions","text":"<ul> <li>sail from sw.</li> <li>set out \u51fa\u53d1</li> <li>have plenty of time \u6709\u8db3\u591f\u7684\u7684\u65f6\u95f4</li> <li>will be away</li> <li>A be proud of B </li> <li>say goodbye to sb. </li> <li>take part in \u53c2\u52a0</li> <li>You luck dog \u4f60\u662f\u4e2a\u5e78\u8fd0\u513f</li> </ul>"},{"location":"english/NCE/NCE2/#_11","title":"\u4e00\u822c\u5c06\u6765\u65f6","text":"<p>\u542b\u4e49\uff1a\u5c06/\u4f1a\uff08\u5f53\u673a\u7acb\u65ad\u7684\u51b3\u5b9a\uff09</p> <p>\u80af\u5b9a\u53e5\uff1a\u4e3b + will + do</p> <p>\u5426\u5b9a\u53e5 \uff1a\u4e3b + will + not(won't)</p> <p>\u4e00\u822c\u7591\u95ee\u53e5\uff1aWill + \u4e3b + do </p>"},{"location":"english/NCE/NCE2/#13-the-greenwood-boys","title":"13 The Greenwood Boys","text":"<p>The Greenwood Boys are a group of pop singers. At present, they are visiting all parts of the country. They will be arriving here tomorrow. They will be coming by train and most of the young people in the town will be meeting them at the station. Tomorrow evening they will be singing at the Workers' Club. The Greenwood Boys will be staying for five days. During this time, they will give five performances(\u6f14\u51fa). As usual, the police will have a difficult time. They will be trying to keep order. It is always the same on these occasions.</p>"},{"location":"english/NCE/NCE2/#expressions_11","title":"Expressions","text":"<ul> <li>a group of</li> <li>at present \u73b0\u5728</li> <li>all parts of the country \u5168\u56fd\u5404\u5730</li> <li>as usual</li> <li>have a difficult time </li> <li>give five performances </li> <li>keep order</li> <li>on these occasions \u5728\u8fd9\u4e2a\u573a\u5408</li> </ul>"},{"location":"english/NCE/NCE2/#_12","title":"\u5c06\u6765\u8fdb\u884c\u65f6","text":"<p>\u7ed3\u6784\uff1awill be doing</p> <p>\u7528\u6cd51\uff1a\u672a\u6765\u52a8\u4f5c\u6b63\u5728\u8fdb\u884c</p> <p>\u7528\u6cd52\uff1a\u8ba1\u5212</p>"},{"location":"english/NCE/NCE2/#14-do-you-speak-english","title":"14 Do You Speak English","text":"<p>I had an amusing(\u6709\u8da3\u7684) experience last year. After I had left a small village in the south of France, I drove on to the next town. On the way, a young man waved to me. I stopped and he asked me for a lift. As soon as he had got into the car, I said good morning to him in French and he replied in the same language. Apart from(\u9664\u4e86) a few words, I do not know any French at all. Neither of us spoke during the journey(\u65c5\u884c). I had nearly reached the town, when the young man suddenly said, very slowly, 'Do you speak English?' As I soon learnt(\u610f\u8bc6\u5230), he was English himself!</p>"},{"location":"english/NCE/NCE2/#expressions_12","title":"Expressions","text":"<ul> <li>have an amusing experience </li> <li>wave to sb.  \u671d\u67d0\u4eba\u62db\u624b</li> <li>take a lift / ask for a lift  \u642d\u4fbf\u8f66</li> <li>A give B a lift  A\u7ed9\u6211\u642d\u4fbf\u8f66</li> <li>reply to the email/letter</li> <li>go on a journey</li> <li>drive on to sw.</li> <li>ask sb. for a lift</li> <li>apart from</li> <li>native language / mother tongue  \u6bcd\u8bed</li> </ul>"},{"location":"english/NCE/NCE2/#_13","title":"\u8fc7\u53bb\u5b8c\u6210\u65f6","text":"<p>Past A(had done) - &gt; Past B(did) -&gt; now</p> <p>\u7ed3\u6784\uff1ahad + (not) + done(\u8fc7\u53bb\u5206\u8bcd) </p> <p>\u2f00\u822c\u7591\u95ee\uff1ahad \u63d0\u53e5\u9996</p> <p>\u7528\u6cd51\uff1a\u8fc7\u53bb\u7684\u8fc7\u53bb\u3002  When Sarah arrived at the party, Paul had already gone home.</p> <p>\u7528\u6cd52\uff1a\u8fc7\u53bbA\u70b9\u53d1\u751f\uff0c\u5bf9\u8fc7\u53bbB\u70b9\u4ea7\u751f\u4e86\u5f71\u54cd\u3002 We weren\u2019t hungry. We had just had lunch.</p> <p>\u2f64\u6cd53 \uff1a\u2f00\u4e2a\u52a8\u4f5c\u4ece\u8fc7\u53bbA\u6301\u7eed\u6216\u91cd\u590d\u5230\u8fc7\u53bbB\u3002 By 2020, I had lived in Beijing for 9 years.</p>"},{"location":"english/NCE/NCE2/#15-good-news","title":"15 Good News","text":"<p>The secretary(\u79d8\u4e66) told me that Mr. Harmsworth would see me. I felt very nervous when I went into his office. He did not look up from his desk when I entered. After I had sat down, he said that business was very bad. He told me that the firm could not afford to pay such large salaries. Twenty people had already left. I knew that my turn had come. 'Mr. Harmsworth,' I said in a weak voice. 'Don't interrupt,' he said. Then he smiled and told me I would receive an extra thousand pounds a year!</p>"},{"location":"english/NCE/NCE2/#expressions_13","title":"Expressions","text":"<p>be nervous about sth. / doing sth.  \u7d27\u5f20</p> <p>afford sth. \u652f\u4ed8</p> <p>Sorry to interrupt, but ...</p> <p>It's my turn \u8f6e\u5230\u6211\u4e86</p>"},{"location":"english/NCE/NCE2/#_14","title":"\u5bbe\u8bed\u4ece\u53e5","text":"<p>\u2f00\u4e2a\u53e5\u5b50\u505a\u5bbe\u8bed\uff0c\u8fd9\u4e2a\u53e5\u5b50\u53eb\u5bbe\u8bed\u4ece\u53e5</p>"},{"location":"english/NCE/NCE2/#-","title":"\u76f4\u63a5\u5f15\u8bed -- \u95f4\u63a5\u5f15\u8bed","text":"<p>\u76f4\u63a5\u5f15\u8bed: \"I am busy\", he said. </p> <p>\u95f4\u63a5\u5f15\u8bed: He said that he was busy. </p> <p>\u95f4\u63a5\u5f15\u8bed: He says that he is busy.</p> <p>\u4ece\u53e5\u65f6\u6001\u53d8\u5316</p> <ul> <li>am/is/are \u2014 was/were</li> <li>am/is/are doing \u2014 was/were doing </li> <li>does/do \u2014 did</li> <li>have/has done \u2014 had done</li> <li>did \u2014 had done</li> </ul> <p>\u4ece\u53e5\u60c5\u6001\u52a8\u8bcd\u53d8\u5316 </p> <ul> <li>can-could </li> <li>may-might </li> <li>will-would </li> <li>shall-should </li> <li>must-had to</li> </ul>"},{"location":"english/NCE/NCE2/#16-a-polite-request","title":"16 A Polite Request","text":"<p>If you park your car in the wrong place, a traffic policeman will soon find it. You will be very lucky if he lets you go without a ticket. However, this does not always happen. Traffic police are sometimes very polite(\u6709\u793c\u8c8c\u7684). During a holiday in Sweden, I found this note on my car: 'sir, we welcome you to our city. This is a No Parking area. You will enjoy your stay here if you pay attention to our street signs. This note is only a reminder.' If you receive a request like this, you cannot fail to obey(\u9075\u5b88) it!</p>"},{"location":"english/NCE/NCE2/#expressions_14","title":"Expressions","text":"<p>parking lot \u505c\u8f66\u573a</p> <p>heavy traffic police/lights/jam </p> <p>make notes/ make a note </p> <p>leave a note</p> <p>remind sb. of sth./sb.</p> <p>fail to do sth.</p>"},{"location":"english/NCE/NCE2/#if","title":"if\u5f15\u5bfc\u7684\u6761\u4ef6\u4ece\u53e5","text":"<p>If\u4ece\u53e5\u53ef\u524d\u53ef\u540e\u3002</p> <p>\u4e3b\u5c06\u4ece\u73b0</p> <p>If you don\u2019t hurry, you\u2019ll miss the train. </p> <p>You\u2019ll miss the train if you don\u2019t hurry. </p> <p>If he is out, I\u2019ll call tomorrow.</p> <p>I\u2019ll call tomorrow if he is out. </p> <p>If you give us 20 minutes, we will give you 10 years back.</p> <p>If I don\u2019t feel well tomorrow, I\u2019ll stay at home. </p> <p>\u4e3b\u60c5\u4ece\u73b0</p> <p>If you need money, I can lend you some. </p> <p>\u4e3b\u7948\u4ece\u73b0</p> <p>If you don\u2019t like it, don\u2019t eat it.</p>"},{"location":"english/NCE/NCE2/#17-always-young","title":"17 Always Young","text":"<p>My aunt Jennifer is an actress. She must be at least thirty-five years old. In spite of this(\u5c3d\u7ba1\u5982\u6b64), she often appears(\u626e\u6f14) on the stage as a young girl. Jennifer will have to take part in a new play(\u8bdd\u5267) soon. This time, she will be a girl of seventeen. In the play, she must appear in a bright red dress and long black stockings(\u957f\u7b52\u889c). Last year in another play, she had to wear short socks(\u77ed\u889c) and a bright, orange-coloured dress. If anyone ever asks her how old she is, she always answers, 'Darling, it must be terrible to be grown up!'</p>"},{"location":"english/NCE/NCE2/#_15","title":"\u60c5\u6001\u52a8\u8bcd","text":"<p>\u5bf9\u73b0\u5728\u5f88\u786e\u4fe1\u7684\u80af\u5b9a\u63a8\u6d4b\u3002\u201c\u4e00\u5b9a\u662f\u201d </p> <p>must do</p> <p>must be adj./n. </p> <p>must be doing</p> <p>\u5bf9\u8fc7\u53bb\u5f88\u786e\u4fe1\u7684\u80af\u5b9a\u63a8\u6d4b\u3002\u201c\u5f53\u65f6\u4e00\u5b9a\u662f\u201d </p> <p>must have done</p> <p>must have been adj./n. </p> <p>must have been doing</p> <p>\u5bf9\u73b0\u5728\u5f88\u786e\u4fe1\u7684\u5426\u5b9a\u63a8\u6d4b\u3002\u201c\u4e00\u5b9a\u4e0d\u662f\u201d </p> <p>can\u2019t do</p> <p>can\u2019t be adj./n. </p> <p>can\u2019t be doing</p> <p>\u5bf9\u8fc7\u53bb\u5f88\u786e\u4fe1\u7684\u5426\u5b9a\u63a8\u6d4b\u3002\u201c\u5f53\u65f6\u4e00\u5b9a\u4e0d\u662f\u201d</p> <p>can\u2019t have done</p> <p>can\u2019t have been adj./n. </p> <p>can\u2019t have been doing</p>"},{"location":"english/NCE/NCE2/#18-he-often-does-this","title":"18 He Often does This","text":"<p>After I had had lunch at a village pub, I looked for my bag. I had left it on a chair beside the door and now it wasn't there! As(\u5f53) I was looking for it, the landlord(\u5e97\u4e3b) came in. 'Did you have a good meal?' he asked. 'Yes, thank you,' I answered, 'but I can't pay the bill. I haven't got my bag.' The landlord smiled and immediately went out. In a few minutes he returned with my bag and gave it back to me. 'I'm very sorry,' he said. 'My dog had taken it into the garden. He often does this!'</p>"},{"location":"english/NCE/NCE2/#19-sold-out","title":"19 Sold Out","text":"<p>'The play may begin at any moment,' I said. 'It may have begun already,' Susan answered. I hurried to the ticket office. 'May I have two tickets please?' I asked. 'I'm sorry, we've sold out,' the girl said. 'What a pity(\u9057\u61be)!' Susan exclaimed(\u558a\u53eb). Just then, a man hurried to the ticket office. 'Can I return(\u9000) these two tickets?' he asked. 'Certainly,' the girl said. I went back to the ticket office at once. 'Could I have those two tickets please?' I asked. 'Certainly,' the girl said, 'but they're for next Wednesday's performance. Do you still want them?' 'I might as well have them,' I said sadly(\u60b2\u4f24\u5730).</p>"},{"location":"english/NCE/NCE2/#expressions_15","title":"Expressions","text":"<ul> <li>hurry to sw.</li> <li>in a hurry</li> <li>What a pity!</li> <li>It\u2019s a pity that ... </li> <li>Don\u2019t yell at me</li> <li>sold out \u552e\u7f44</li> <li>at once \u7acb\u523b</li> <li>might as well \u53ea\u597d(\u505a)</li> </ul>"},{"location":"english/NCE/NCE2/#maymight","title":"may/might","text":"<ul> <li> <p>\u5bf9\u73b0\u5728\u4e0d\u786e\u4fe1\u7684\u80af\u5b9a(\u5426\u5b9a)\u63a8\u6d4b\u3002 \u4e5f\u8bb8\u662f (\u4e5f\u8bb8\u4e0d\u662f) </p> </li> <li> <p>may/might (not) do </p> </li> <li> <p>may/might (not) be adj./n. </p> </li> <li> <p>may/might (not) be doing</p> </li> <li> <p>\u5bf9\u8fc7\u53bb\u4e0d\u786e\u4fe1\u7684\u80af\u5b9a(\u5426\u5b9a)\u63a8\u6d4b\u3002\u5f53\u65f6\u4e5f\u8bb8\u662f(\u5f53\u65f6\u4e5f\u8bb8\u4e0d\u662f)</p> </li> <li> <p>may/might (not) have done. </p> </li> <li>may/might (not) have been adj./n. </li> <li>may/might (not) have been doing.</li> </ul>"},{"location":"english/NCE/NCE2/#20-one-man-in-a-boat","title":"20 One Man in a Boat","text":"<p>Fishing is my favourite sport. I often fish for hours without catching anything. But this does not worry me. Some fishermen are unlucky. Instead of catching fish, they catch old boots(\u9774\u5b50) and rubbish(\u5783\u573e). I am even less lucky. I never catch anything  --  not even old boots. After having spent whole mornings on the river, I always go home with an empty bag. 'You must give up fishing!' my friends say. 'It's a waste of time.' But they don't realize one important thing. I'm not really interested in fishing. I am only interested in sitting in a boat and doing nothing at all!</p>"},{"location":"english/NCE/NCE2/#expressions_16","title":"Expressions","text":"<ul> <li>One day someone will catch your eye\uff0cand then you\u2019ll have to watch your tongue.</li> <li>catch a bus \u8d76\u5df4\u58eb</li> <li>That\u2019s rubbish.  \u80e1\u626f</li> <li>You\u2019re wasting time.  \u522b\u6d6a\u8d39\u65f6\u95f4</li> <li>sb. realized that ... \u610f\u8bc6\u5230</li> </ul>"},{"location":"english/NCE/NCE2/#_16","title":"\u52a8\u540d\u8bcd","text":"<p>\u6784\u6210: v.+ing </p> <p>\u52a8\u8bcd\u53d8\u6210\u540d\u8bcd</p> <p>I like fishing. \u52a8\u540d\u8bcd \u662f\u4e2a\u540d\u8bcd</p> <p>She is fishing. \u73b0\u5728\u5206\u8bcd \u662f\u4e2a\u52a8\u8bcd</p>"},{"location":"english/NCE/NCE2/#21-mad-or-not","title":"21 Mad or Not","text":"<p>Aeroplanes(\u98de\u673a) are slowly driving me mad(\u75af\u4e86). I live near an airport and passing planes can be heard night and day. The airport was built years ago, but for some reason it could not be used then. Last year, however, it came into use. Over(\u8d85\u8fc7) a hundred people must have been driven away from their homes by the noise. I am one of the few people left. Sometimes I think this house will be knocked down by a passing plane. I have been offered a large sum of money to go away, but I am determined(\u4e0b\u51b3\u5fc3) to stay here. Everybody says I must be mad and they are probably right.</p>"},{"location":"english/NCE/NCE2/#expressions_17","title":"Expressions","text":"<ul> <li>be mad at sb. \u751f\u67d0\u4eba\u7684\u6c14</li> <li>for some reason \u57fa\u4e8e\u4e00\u4e9b\u539f\u56e0</li> <li>a large sum of money</li> <li>be determined to do sth.</li> </ul>"},{"location":"english/NCE/NCE2/#_17","title":"\u60c5\u6001\u52a8\u8bcd\u7684\u88ab\u52a8","text":"<p>will/would be done </p> <p>can/could be done </p> <p>must be done</p> <p>have to be done</p> <p>must have been done \u5f53\u65f6\u4e00\u5b9a\u662f\u88ab</p>"},{"location":"english/NCE/NCE2/#22-a-glass-envelope","title":"22 A Glass Envelope","text":"<p>My daughter, Jane, never dreamed of receiving a letter from a girl of her own age in Holland. Last year, we were travelling across the Channel and Jane put a piece of paper with her name and address on it into a bottle. She threw the bottle into the sea. She never thought of it again, but ten months later, she received a letter from a girl in Holland. Both girls write to each other regularly(\u89c4\u5f8b\u5730) now. However, they have decided to use the post office. Letters will cost a little more, but they will certainly travel faster.</p> <p>v. + of/from/in/on...</p>"},{"location":"english/NCE/NCE2/#23-a-new-house","title":"23 A New House","text":"<p>I had a letter from my sister yesterday. She lives in Nigeria. In her letter, she said that she would come to England next year. If she comes, she will get a surprise. We are now living in a beautiful new house in the country(\u4e61\u4e0b). Work on it had begun before my sister left. The house was completed five months ago. In my letter, I told her that she could stay with us. The house has many large rooms and there is a lovely garden. It is a very modern(\u73b0\u4ee3\u7684) house, so it looks strange(\u5947\u602a\u7684) to some people. It must be the only modern house in the district(\u533a).</p>"},{"location":"english/NCE/NCE2/#24-it-could-be-worse","title":"24 It Could be Worse","text":"<p>I entered the hotel manager's office and sat down. I had just lost \uffe150 and I felt very upset(\u4e0d\u5b89). 'I left the money in my room,' I said, 'and it's not there now.  ' The manager was sympathetic(\u6709\u540c\u60c5\u5fc3\u7684), but he could do nothing. 'Everyone's losing money these days,' he said. He started to complain about this wicked(\u90aa\u6076\u7684) world but was interrupted by a knock at the door. A girl came in and put an envelope(\u4fe1\u5c01) on his desk. It contained(\u5305\u542b) \uffe150. 'I found this outside this gentleman's room,' she said. 'Well,' I said to the manager,'there is still some honesty(\u8bda\u5b9e) in this world!'</p>"},{"location":"english/NCE/NCE2/#25-do-the-english-speak-english","title":"25 Do the English Speak English","text":"<p>I arrived in London at last. The railway station was big, black and dark. I did not know the way to my hotel, so I asked a porter(\u642c\u8fd0\u5de5). I not only spoke English very carefully, but very clearly as well. The porter, however, could not understand me. I repeated my question several(\u51e0\u4e2a) times and at last he understood. he answered me, but he spoke neither slowly nor clearly. 'I am a foreigner(\u5916\u56fd\u4eba),' I said. Then he spoke slowly, but I could not understand him. My teacher never spoke English like that! The porter and I looked at each other and smiled. Then he said something and I understood it. 'You'll soon learn English!' he said. I wonder(\u60ca\u8bb6). In England, each person speaks a different language. The English understand each other, but I don't understand them!</p>"},{"location":"english/NCE/NCE2/#_18","title":"\u5e76\u5217\u8fde\u8bcd","text":"<ol> <li>and, but, or, so \u540c\u4e00\u4e3b\u8bed\u60c5\u51b5\u4e0b\u4e3b\u8bed\u4e0d\u5fc5\u91cd\u590d</li> <li>both... and, either... or, neither... nor</li> <li>either... or \u8fde\u63a5\u4e3b\u8bed\u65f6\u5c31\u8fd1\u4e00\u81f4  Either the teacher or the students are wrong.</li> <li>neither... nor \u8fde\u63a5\u4e3b\u8bed\u65f6\u5c31\u8fd1\u4e00\u81f4 Neither dad nor mum is at home today</li> <li>not only\u2026 but also (as well)</li> <li>\u8fde\u63a5\u4e3b\u8bed\u65f6\u5c31\u8fd1\u4e00\u81f4 Not only the doctor but also the patients do not know about it. </li> </ol>"},{"location":"english/NCE/NCE2/#26-the-best-art-critics","title":"26 The Best Art Critics","text":"<p>I am an art student and I paint a lot of pictures. Many people pretend(\u5047\u88c5) that they understand modern art. They always tell you what a picture is 'about'. Of course, many pictures are not 'about' anything. They are just pretty(\u6f02\u4eae\u7684) patterns(\u56fe\u6848). We like them in the same way that we like pretty curtain(\u7a97\u5e18) material(\u6750\u6599). I think that young children often appreciate(\u6b23\u8d4f) modern pictures better than anyone else. They notice(\u6ce8\u610f) more. My sister is only seven, but she always tells me whether my pictures are good or not. She came into my room yesterday. 'What are you doing?' she asked. 'I'm hanging this picture on the wall,' I answered. 'It's a new one. Do you like it?' She looked at it critically(\u6279\u5224\u6027\u5730) for a moment. 'It's all right,' she said, 'but isn't it upside down(\u4e0a\u4e0b\u98a0\u5012)?' I looked at it again. She was right! It was!</p>"},{"location":"english/NCE/NCE2/#27-a-wet-night","title":"27 A Wet Night","text":"<p>Late in the afternoon, the boys put up their tent(\u5e10\u7bf7) in the middle of a field(\u7530\u5730). As soon as this was done, they cooked a meal over an open fire. They were all hungry and the food smelled good. After a wonderful meal, they told stories and sang songs by the campfire(\u7bdd\u706b). But some time later it began to rain. The boys felt tired so they put out the fire and crept(\u722c) into their tent. Their sleeping bags were warm and comfortable, so they all slept soundly(\u7761\u5f97\u5f88\u9999). In the middle of the night, two boys woke up and began shouting. The tent was full of water! They all leapt(leap\u8df3) out of their sleeping bags and hurried outside. It was raining heavily and they found that a stream(\u5c0f\u6eaa) had formed(\u5f62\u6210) in the field. The stream wound(\u873f\u8712) its way across the field and then flowed right under their tent!</p>"},{"location":"english/NCE/NCE2/#28-no-parking","title":"28 No Parking","text":"<p>Jasper White is one of those rare(\u7f55\u89c1) people who believes in ancient(\u53e4\u4ee3\u7684) myths(\u795e\u8bdd). He has just bought a new house in the city, but ever since he moved in, he has had trouble with cars and their owners. When he returns home at night, he always finds that someone has parked a car outside his gate. Because of this, he has not been able to get his own car into his garage even once. Jasper has put up 'No Parking' signs outside his gate, but these have not had any effect(\u6548\u679c). Now he has put an ugly stone head over the gate. It is one of the ugliest faces I have ever seen. I asked him what it was and he told me that it was Medusa, the Gorgon. Jasper hopes that she will turn cars and their owners to stone. But none of them has been turned to stone yet!</p>"},{"location":"english/NCE/NCE2/#_19","title":"\u5b9a\u8bed\u4ece\u53e5","text":""},{"location":"english/NCE/NCE2/#29-taxi","title":"29 Taxi","text":"<p>Captain Ben Fawcett has bought an unusual taxi and has begun a new service. The 'taxi' is a small Swiss aeroplane called a 'Pilatus Porter'. This wonderful plane can carry seven passengers. The most surprising thing about it, however, is that it can land(\u964d\u843d) anywhere: on snow, water, or even on a ploughed(\u8015\u5730) field. Captain Fawcett's first passenger was a doctor who flew from Birmingham to a lonely(\u504f\u50fb\u7684) village in the Welsh mountains. Since then, Captain Fawcett has flown passengers to many unusual places. Once he landed on the roof of a block of flats(\u516c\u5bd3) and on another occasion, he landed in a deserted(\u9057\u5f03\u7684) car park. Captain Fawcett has just refused a strange request from a businessman. The man wanted to fly to Rockall, a lonely island in the Atlantic Ocean, but Captain Fawcett did not take him because the trip was too dangerous.</p>"},{"location":"english/NCE/NCE2/#done","title":"done\u505a\u5b9a\u8bed","text":"<ol> <li>\u901a\u5e38\u8868\u88ab\u52a8\u2f00\u822c/\u88ab\u52a8\u5b8c\u6210</li> <li>a broken cup = the cup that has been broken </li> <li>boiled water = water that has been boiled</li> <li>\u5076\u5c14\u8868\u793a\u4e3b\u52a8\u5b8c\u6210 </li> <li>fallen leaves = leaves that have fallen</li> <li>a retired captain = a captain who has retired </li> <li>a married man = a man that has married </li> <li>\u4f4d\u7f6e: \u5355\u8bcd(done) + n. + done\u5f15\u5bfc\u7684\u77ed\u8bed</li> </ol>"},{"location":"english/NCE/NCE2/#30-football-or-polo","title":"30 Football or Polo","text":"<p>The Wayle is a small river that cuts across the park near my home. I like sitting by the Wayle on fine afternoons. It was warm last Sunday, so I went and sat on the river bank(\u5cb8) as usual. Some children were playing games on the bank and there were some people rowing(\u5212\u8239) on the river. Suddenly, one of the children kicked(\u8e22) a ball very hard and it went towards a passing boat. Some people on the bank called out to the man in the boat, but he did not hear them. The ball struck(\u6253\u51fb) him so hard that he nearly fell into the water. I turned to look at the children, but there weren't any in sight: they had all run away! The man laughed when he realized what had happened. He called out to the children and threw the ball back to the bank.</p>"},{"location":"english/NCE/NCE2/#expressions_18","title":"Expressions","text":"<p>polo \u6c34\u7403\uff1b\u9a6c\u7403</p>"},{"location":"english/NCE/NCE2/#doing","title":"doing \u73b0\u5728\u5206\u8bcd\u505a\u5b9a\u8bed","text":"<p>\u4e3b\u52a8\u8fdb\u884c/\u4e3b\u52a8\u4e00\u822c</p> <p>the sinking ship=the ship that is sinking</p> <p>the rising sun=the sun that is rising</p> <p>the sleeping child=the child who is sleeping </p> <p>I like the girl dancing with that guy.</p> <p>adj/done/doing + n + \u4ecb\u8bcd\u5f15\u5bfc/done\u5f15\u5bfc/doing\u5f15\u53f7|\u5b9a\u4e8e\u4ece\u53e5</p>"},{"location":"english/NCE/NCE2/#31-success-story","title":"31 Success Story","text":"<p>Yesterday afternoon Frank Hawkins was telling me about his experiences as a young man. Before he retired(\u9000\u4f11), Frank was the head of a very large business company,  but as a boy he used to work in a small shop. It was his job to repair bicycles and at that time he used to work fourteen hours a day. He saved(\u5b58\u94b1) money for years and in 1958 he bought a small workshop(\u8f66\u95f4) of his own. In his twenties(\u4e8c\u5341\u591a) Frank used to make spare parts for aeroplanes. At that time he had two helpers(\u52a9\u624b). In a few years the small workshop had become a large factory which employed seven hundred and twenty-eight people. Frank smiled when he remembered his hard early years and the long road to success. He was still smiling when the door opened and his wife came in. She wanted him to repair their grandson's bicycle!</p>"},{"location":"english/NCE/NCE2/#used-to-v","title":"used to v.","text":"<p>\u8fc7\u53bb\u53d1\u751f\uff0c\u73b0\u5728\u5df2\u7ecf\u4e0d\u53d1\u751f\u4e86</p> <p>\u5426\u5b9a\uff1adid't use to v. ...</p> <p>\u4e00\u822c\u7591\u95ee\u53e5\uff1aDid \u4e3b\u8bed use to v. ...</p>"},{"location":"english/NCE/NCE2/#32-shopping-made-easy","title":"32 Shopping Made Easy","text":"<p>People are not so honest as they once were. The temptation(\u8bf1\u60d1) to steal is greater than ever before--especially in large shops. A detective recently watched a well-dressed woman who always went into a large store on Monday mornings. One Monday, there were fewer people in the shop than usual when the woman came in, so it was easier for the detective to watch her. The woman first bought a few small articles(\u7269\u54c1). After a little time, she chose one of the most expensive dresses in the shop and handed(\u9012) it to an assistant who wrapped(\u5305\u8d77\u6765) it up for her as quickly as possible. Then the woman simply took the parcel and walked out of the shop without paying. When she was arrested(\u902e\u6355), the detective found out that the shop assistant was her daughter. The girl 'gave' her mother a free dress once a week!</p>"},{"location":"english/NCE/NCE2/#asas","title":"as\u2026as","text":"<p>as (adv. \u540c\u7b49\u5730/\u2f00\u6837\u5730) ...  as (conj. \u50cf)</p> <p>not as(so) ... as... </p>"},{"location":"english/NCE/NCE2/#33-out-of-the-darkness","title":"33 Out of the Darkness","text":"<p>Nearly a week passed before the girl was able to explain what had happened to her. One afternoon she set out from the coast(\u6d77\u5cb8) in a small boat and was caught in(\u9047\u5230) a storm(\u66b4\u98ce\u96e8). Towards evening, the boat struck(\u649e) a rock(\u7901\u77f3) and the girl jumped into the sea. Then she swam to the shore(\u5cb8) after spending the whole night in the water. During that time she covered a distance of eight miles. Early next morning, she saw a light ahead. She knew she was near the shore because the light was high up on the cliffs(\u60ac\u5d16). On arriving at the shore, the girl struggled(\u6323\u624e) up the cliff towards the light she had seen. That was all she remembered. When she woke up a day later, she found herself in hospital.</p>"},{"location":"english/NCE/NCE2/#34-quick-work","title":"34 Quick Work","text":"<p>Dan Robinson has been worried(adj.) all week. Last Tuesday he received a letter from the local police. In the letter he was asked to call at(visit) the station. Dan wondered why he was wanted by the police, but he went to the station yesterday and now he is not worried anymore. At the station, he was told by a smiling policeman that his bicycle had been found. Five days ago, the policeman told him, the bicycle was picked up in a small village four hundred miles away. It is now being sent to his home by train. Dan was most(=very) surprised when he heard the news. He was amused(\u6709\u8da3\u7684) too, because he never expected the bicycle to be found. It was stolen twenty years ago when Dan was a boy of fifteen!</p>"},{"location":"english/NCE/NCE2/#_20","title":"\u8fc7\u53bb\u5b8c\u6210\u65f6\u88ab\u52a8","text":"<p>\u2f00\u822c\u73b0\u5728\u65f6: am/is/are + done</p> <p>\u2f00\u822c\u8fc7\u53bb\u65f6: was/were + done</p> <p>\u2f00\u822c\u5c06\u6765\u65f6: will be + done</p> <p>\u73b0\u5728\u5b8c\u6210\u65f6: have/has been + done</p> <p>\u8fc7\u53bb\u5b8c\u6210\u65f6: had been + done</p> <p>The china had never been used.</p>"},{"location":"english/NCE/NCE2/#35-stop-thief","title":"35 Stop Thief","text":"<p>Roy Trenton used to drive a taxi. A short while ago(\u4e0d\u4e45\u524d), however, he became a bus driver and he has not regretted(\u540e\u6094) it. He is finding his new work far more exciting. When he was driving along(\u6cbf\u7740) Catford Street recently, he saw two thieves rush(\u51b2) out of a shop and run towards a waiting car. One of them was carrying a bag full of money. Roy acted(\u884c\u52a8) quickly and drove the bus straight at the thieves. The one with the money got such a fright(\u5413\u4e00\u8df3) that he dropped the bag. As(\u5f53) the thieves were trying to get away(\u79bb\u5f00) in their car, Roy drove his bus into the back of it. While the battered(\u574f\u7684) car was moving away, Roy stopped his bus and telephoned the police. The thieves' car was badly damaged and easy to recognize. Shortly afterwards(\u4e0d\u4e45\u4e4b\u540e), the police stopped the car and both men were arrested(\u902e\u6355).</p>"},{"location":"english/NCE/NCE2/#so-such","title":"so &amp; such","text":"<p>so+adj./adv.</p> <p>such + (adj.)+n</p> <p>so ... that</p> <p>such ... that</p>"},{"location":"english/NCE/NCE2/#expressions_19","title":"Expressions","text":"<ul> <li>see sb. do sth.  \u5168\u7a0b</li> <li>see sb. doing sth. \u8fc7\u7a0b</li> <li>a short while ago </li> <li>regret sth.</li> <li>rush out of/towards </li> <li>go straight ahead </li> <li>give me a fright </li> <li>get a fright </li> <li>Shortly afterwards</li> </ul>"},{"location":"english/NCE/NCE2/#36-across-the-channel","title":"36 Across the Channel","text":"<p>Debbie Hart is going to swim across the English Channel tomorrow. She is going to set out from the French coast at five o'clock in the morning. Debbie is only eleven years old and she hopes to set up a new world record. She is a strong swimmer and many people feel that she is sure to succeed(v.). Debbie's father will set out with her in a small boat. Mr. Hart has trained his daughter for years. Tomorrow he will be watching her anxiously(\u5fe7\u8651\u5730) as(\u5f53) she swims the long distance to England. Debbie intends(\u6253\u7b97) to take short rests every two hours. She will have something to drink but she will not eat any solid food. Most of Debbie's school friends will be waiting for her on the English coast. Among(\u5728...\u4e2d\u95f4) them will be Debbie's mother, who swam the Channel herself when she was a girl.</p>"},{"location":"english/NCE/NCE2/#expressions_20","title":"Expressions","text":"<ul> <li>set up a new world record  \u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4e16\u754c\u7eaa\u5f55</li> <li>break the record \u6253\u7834\u8bb0\u5f55</li> <li>as strong as a horse</li> <li>strong like a horse</li> <li>succeed in doing sth.</li> <li>train sb. to do sth.</li> <li> <p>intend to do sth.</p> </li> <li> <p>hope to do sth.</p> </li> <li>be sure to do sth.</li> <li>take some rests/a rest</li> </ul>"},{"location":"english/NCE/NCE2/#37-the-olympic-games","title":"37 The Olympic Games","text":"<p>The Olympic Games will be held in our country in four years' time. As(\u56e0\u4e3a) a great many people will be visiting the country, the government will be building new hotels, an immense(\u5de8\u5927\u7684) stadium, and a new Olympic-standard swimming pool. They will also be building new roads and a special railway line. The Games will be held just outside the capital(\u9996\u90fd) and the whole area will be called 'Olympic City'. Workers will have completed the new roads by the end of this year. By the end of next year, they will have finished work on the new stadium. The fantastic modern buildings have been designed by Kurt Gunter. Everybody will be watching anxiously as the new buildings go up. We are all very excited and are looking forward to the Olympic Games because they have never been held before in this country.</p>"},{"location":"english/NCE/NCE2/#expressions_21","title":"Expressions","text":"<p>hold a meeting</p>"},{"location":"english/NCE/NCE2/#_21","title":"\u5c06\u6765\u5b8c\u6210\u65f6","text":"<p>will have done</p> <p>\u5426\u5b9a\uff1awill not</p> <p>\u4e00\u822c\u7591\u95ee\u53e5 will\u63d0\u53e5\u9996</p> <p>\u7528\u6cd51: \u2f00\u4e2a\u52a8\u4f5c\u6301\u7eed\u6216\u91cd\u590d\u5230\u5c06\u6765(have done\u7684\u5c06\u6765\u65f6)</p> <p>We will have taken five exams by next Friday.</p> <p>\u7528\u6cd52: \u2f00\u4e2a\u52a8\u4f5c\u622a\u6b62\u5230\u672a\u6765\u67d0\u4e2a\u65f6\u95f4\u524d\u5b8c\u6210</p> <p>I will have finished my homework by next Friday.</p>"},{"location":"english/NCE/NCE2/#38-everything-except-the-weather","title":"38 Everything Except the Weather","text":"<p>My old friend, Harrison, had lived in the Mediterranean(\u5730\u4e2d\u6d77) for many years before he returned to England. He had often dreamed of retiring in England and had planned to settle down in the country. He had no sooner returned than he bought a house and went to live there. Almost immediately he began to complain about the weather, for even though it was still summer, it rained continually and it was often bitterly cold. After so many years of sunshine, Harrison got a shock. He acted as if he had never lived in England before. In the end, it was more than he could bear. He had hardly had time to settle down when he sold the house and left the country. The dream he had had for so many years ended there. Harrison had thought of everything except the weather.</p>"},{"location":"english/NCE/NCE2/#_22","title":"\u8fc7\u53bb\u5b8c\u6210\u65f6","text":"<p>\u8fc7\u53bb\u7684\u8fc7\u53bb</p> <p>had done</p>"},{"location":"english/NCE/NCE2/#expressions_22","title":"Expressions","text":"<p>no sooner ... than  \u4e00...\u5c31...</p> <p>hardly ... when \u51e0\u4e4e\u521a..\u5c31...</p>"},{"location":"english/NCE/NCE2/#39-am-i-all-right","title":"39 Am I All Right","text":"<p>While John Gilbert was in hospital, he asked his doctor to tell him whether his operation had been successful, but the doctor refused to do so. The following day(\u7b2c\u4e8c\u5929), the patient asked for a bedside telephone. When he was alone, he telephoned the hospital exchange and asked for Doctor Millington. When the doctor answered the phone, Mr. Gilbert said he was inquiring about a certain(\u67d0\u4e2a) patient, a Mr. John Gilbert. He asked if Mr. Gilbert's operation had been successful and the doctor told him that it had been. He then asked when Mr. Gilbert would be allowed to go home and the doctor told him that he would have to stay in hosptial for another two weeks. Then Dr. Millington asked the caller if he was a relative(\u4eb2\u621a) of the patient. 'No,' the patient answered, 'I am Mr. John Gilbert.'</p>"},{"location":"english/NCE/NCE2/#expressions_23","title":"Expressions","text":"<ul> <li>When did she become successful?\uff08\u52a9\u52a8\u8bcd did \u540e\u63a5\u52a8\u8bcd\u539f\u5f62 become\uff09</li> <li>have an operation</li> <li>leave me alone</li> <li>inquire about sth./sb.</li> </ul>"},{"location":"english/NCE/NCE2/#_23","title":"\u5bbe\u8bed\u4ece\u53e5","text":"<p>\u4e00\u4e2a\u53e5\u5b50\u505a\u5bbe\u8bed</p> <p>He asked if you coul d come tomorrow.</p>"},{"location":"english/NCE/NCE2/#40-food-and-talk","title":"40 Food and Talk","text":"<p>Last week at a dinner party, the hostess asked me to sit next to Mrs. Rumbold. Mrs. Rumbold was a large, unsmiling lady in a tight(\u7d27\u7684) black dress. She did not even look up when I took my seat beside her. Her eyes were fixed(\u51dd\u89c6) on her plate(\u76d8\u5b50) and in a short time, she was busy eating. I tried to make conversation. 'A new play is coming to \"The Globe\" soon,' I said. 'Will you be seeing it?' 'No,' she answered. 'Will you be spending your holidays abroad this year?' I asked. 'No,' she answered. 'Will you be staying in England?' I asked. 'No,' she answered. In despair(\u7edd\u671b), I asked her whether she was enjoying her dinner. 'Young man,' she answered, 'if you ate more and talked less, we would both enjoy our dinner!'</p>"},{"location":"english/NCE/NCE2/#_24","title":"\u865a\u62df\u8bed\u6c14","text":"<p>\u7ed3\u6784\uff1aIf +did/were\uff0c\u4e3b + would/should/could/might do.</p> <p>did \u5e76\u975e\u8868\u793a\u8fc7\u53bb</p> <p>If I were you, I wouldn\u2019t do that.</p> <p>If I knew them better, I might invite them to dinner.</p> <p>\u542b\u4e49:</p> <ol> <li>if\u4ece\u53e5\u4e2dv.\u4e0e\u73b0\u5728\u4e8b\u5b9e\u76f8\u53cd</li> <li>\u8bf4\u8bdd\u4eba\u8ba4\u4e3a\uff0cif\u4ece\u53e5\u4e2dv.\u53d1\u751f\u7684\u51e0\u7387\u975e\u5e38\u4f4e If I were you, I wouldn\u2019t do that. If I knew them better, I might invite them to dinner. It\u2019s cold. If I were you, I would put my coat on.</li> </ol>"},{"location":"english/NCE/NCE2/#expressions_24","title":"Expressions","text":"<ul> <li>take my seat</li> <li>be busy doing sth.</li> <li>Will you be doing sth?</li> </ul>"},{"location":"english/NCE/NCE2/#41-do-you-call-that-a-hat","title":"41 Do You Call That a Hat","text":"<p>'Do you call that a hat?' I said to my wife. 'You needn't be so rude about it,' my wife answered as she looked at herself in the mirror. I sat down on one of those modern chairs with holes(\u6d1e) in it and waited. We had been in the hat shop for half an hour and my wife was still in front of the mirror. 'We mustn't buy things we don't need,' I remarked suddenly. I regretted(\u540e\u6094) saying it almost at once. 'You needn't have said that,' my wife answered. 'I needn't remind you of that terrible tie you bought yesterday.' 'I find it beautiful,' I said. 'A man can never have too many ties.' 'And a woman can't have too many hats,' she answered. Ten minutes later we walked out of the shop together. My wife was wearing a hat that looked like a lighthouse(\u706f\u5854)!</p>"},{"location":"english/NCE/NCE2/#expressions_25","title":"Expressions","text":"<ul> <li>needn\u2019t have done \u672c\u4e0d\u5fc5\u5982\u6b64. \u4f46\u4e8b\u60c5\u5df2\u7ecf\u53d1\u751f\u4e86,\u6709\u540e\u6094\u7684\u8bed\u8a00\u6548\u679c</li> </ul>"},{"location":"english/NCE/NCE2/#42-not-very-musical","title":"42 Not Very Musical","text":"<p>As we had had a long walk through one of the markets of old Delhi, we stopped at a square(\u5e7f\u573a) to have a rest. After a time, we noticed a snake charmer with two large baskets at the other side of the square, so we went to have a look at him. As soon as he saw us, he picked up a long pipe which was covered with coins and opened one of the baskets. When he began to play a tune, we had our first glimpse(\u77a5\u89c1) of the snake. It rose out of the basket and began to follow the movements of the pipe. We were very much surprised when the snake charmer suddenly began to play jazz and modern pop songs. The snake, however, continued to 'dance' slowly. It obviously could not tell the difference between Indian music and jazz!</p>"},{"location":"english/NCE/NCE2/#expressions_26","title":"Expressions","text":"<ul> <li>watch a musical \u770b\u97f3\u4e50\u5267</li> <li>play a tune</li> <li>have a glimpse of sth./sb.</li> <li>continue to do sth.</li> <li>tell the difference between A and B</li> <li>have a long walk</li> <li>at the other side of sw.</li> <li>be able to do sth.</li> </ul>"},{"location":"english/NCE/NCE2/#43-over-the-south-pole","title":"43 Over the South Pole","text":"<p>In 1929, three years after his flight(\u822a\u73ed) over the North Pole(\u5317\u6781), the American explorer(\u63a2\u9669\u5bb6), R.E. Byrd, successfully flew over the South Pole for the first time. Though(\u5c3d\u7ba1), at first, Byrd and his men were able to take a great many photographs of the mountains that lay below, they soon ran into serious trouble. At one point, it seemed(\u4f3c\u4e4e) certain that their plane would crash. It could only get over the mountains if it rose to 10, 000 feet. Byrd at once ordered his men to throw out two heavy food sacks(\u888b\u5b50). The plane was then able to rise and it cleared(\u8d8a\u8fc7) the mountains by 400 feet. Byrd now knew that he would be able to reach the South Pole which was 300 miles away, for there were no more mountains in sight. The aircraft was able to fly over the endless white plains without difficulty.</p>"},{"location":"english/NCE/NCE2/#44-through-the-forest","title":"44 Through the Forest","text":"<p>Mrs. Anne Sterling did not think of the risk (that) she was taking when she ran through a forest(\u68ee\u6797) after two men. They had rushed up to her while she was having a picnic at the edge of a forest with her children and tried to steal her handbag. In the struggle(\u6323\u624e), the strap(\u5e26\u5b50) broke and, with the bag in their possession(\u62e5\u6709), both men started running through the trees. Mrs. Sterling got so angry that she ran after them. She was soon out of breath, but she continued to run. When she caught up with them, she saw that they had sat down and were going through the contents of the bag, so she ran straight at them. The men got such a fright that they dropped the bag and ran away. 'The strap needs mending(\u4fee\u7406),' said Mrs. Sterling later, 'but they did not steal anything.'</p>"},{"location":"english/NCE/NCE2/#expressions_27","title":"Expressions","text":"<ul> <li>take a risk \u5192\u9669</li> <li>have a picnic \u91ce\u9910</li> <li>at the edge of a forest</li> <li>in sb\u2019s possession</li> <li>out of breath \u4e0a\u6c14\u4e0d\u63a5\u4e0b\u6c14</li> <li>rush up to sb. \u51b2\u5411\u67d0\u4eba</li> <li>catch up with sb.</li> <li>go through \u7ffb\u8d8a</li> <li>run straight at sb. \u5f84\u76f4\u51b2\u5411\u67d0\u4eba</li> <li>need doing sth.</li> </ul>"},{"location":"english/NCE/NCE2/#45-a-clear-conscience","title":"45 A Clear Conscience","text":"<p>The whole village soon learnt(\u77e5\u9053) that a large sum of money had been lost. Sam Benton, the local butcher(\u5c60\u592b), had lost his wallet while taking his savings(\u5b58\u6b3e) to the post office. Sam was sure that the wallet must have been found by one of the villagers(\u6751\u6c11), but it was not returned to him. Three months passed, and then one morning, Sam found his wallet outside his front door. It had been wrapped up in newspaper and it contained half the money he had lost, together with a note which said: 'A thief, yes, but only 50 per cent a thief!' Two months later, some more money was sent to Sam with another note: 'Only 25 per cent a thief now!' In time(\u6700\u7ec8), all Sam's money was paid back in this way. The last note said: 'I am 100 per cent honest now!'</p>"},{"location":"english/NCE/NCE2/#expressions_28","title":"Expressions","text":"<ul> <li>a clear conscience(\u826f\u5fc3) \u95ee\u5fc3\u65e0\u6127</li> </ul>"},{"location":"english/NCE/NCE2/#46-expensive-and-uncomfortable","title":"46 Expensive and Uncomfortable","text":"<p>When a plane from London arrived at Sydney airport, workers began to unload a number of wooden boxes which contained clothing. No one could account(\u89e3\u91ca) for the fact that one of the boxes was extremely(\u975e\u5e38) heavy. It suddenly occurred(\u53d1\u751f) to one of the workers to open up the box. He was astonished(\u60ca\u8bb6\u7684) at what(=the things that) he found. A man was lying(lie, \u8eba) in the box on top of a pile(\u8bb8\u591a) of woollen(\u7f8a\u6bdb) goods. He was so surprised at being discovered that he did not even try to run away. After he was arrested(\u902e\u6355), the man admitted(\u627f\u8ba4) hiding in the box before the plane left London. He had had a long and uncomfortable trip, for he had been confined(\u9650\u5236) to the wooden box for over eighteen hours. The man was ordered to pay \uffe13, 500 for the cost of the trip. The normal price of a ticket is \uffe12, 000!</p>"},{"location":"english/NCE/NCE2/#_25","title":"\u540c\u4f4d\u8bed\u4ece\u53e5","text":"<p>\u4e00\u4e2a(\u5b8c\u6574)\u7684\u53e5\u5b50\u8865\u5145\u8bf4\u660e\u4e00\u4e2a\u540d\u8bcd</p> <p>No one could account for the fact that one of the boxes was extremely heavy.</p>"},{"location":"english/NCE/NCE2/#47-a-thirsty-ghost","title":"47 A Thirsty Ghost","text":"<p>A pub which was recently bought by Mr.Ian Thompson is up for sale(\u5f85\u552e). Mr.Thompson is going to sell it because it is haunted(\u95f9\u9b3c). He told me that he could not go to sleep one night because he heard a strange noise coming from the bar. The next morning, he found that the doors had been blocked(\u963b\u6321) by chairs and the furniture(\u5bb6\u5177) had been moved. Though Mr.Thompson had turned the lights off before he went to bed, they were on in the morning. He also said that he had found five empty whisky bottles which the ghost must have drunk the night before. When I suggested that some villagers must have come in for a free drink, Mr.Thompson shook(shake,\u6447) his head. The villagers have told him that they will not accept the pub even if he gives it away.</p>"},{"location":"english/NCE/NCE2/#48-did-you-want-to-tell-me-something","title":"48 Did You Want to Tell Me Something","text":"<p>Dentists always ask questions when it is impossible for you to answer. My dentist had just pulled out one of my teeth and had told me to rest for a while. I tried to say something, but my mouth was full of cotton wool(\u539f\u68c9,\u68c9\u7d6e). He knew I collected match(\u706b\u67f4) boxes and asked me whether my collection was growing. He then asked me how my brother was and whether I liked my new job in London. In answer to these questions I either nodded(\u70b9\u5934) or made strange noises. Meanwhile, my tongue(\u820c\u5934) was busy searching out the hole where the tooth had been. I suddenly felt very worried, but could not say anything. When the dentist at last removed the cotton wool from my mouth, I was able to tell him that he had pulled out the wrong tooth.</p>"},{"location":"english/NCE/NCE2/#49-the-end-of-a-dream","title":"49 The End of a Dream","text":"<p>Tired(\u538c\u5026) of sleeping on the floor, a young man in Teheran saved up(\u5b58\u94b1) for years to buy a real bed. For the first time in his life, he became the proud owner of a bed which had springs(\u5f39\u7c27) and a mattress(\u5e8a\u57ab). Because the weather was very hot, he carried the bed on to the roof of his house. He slept very well for the first two nights, but on the third night, a storm(\u66b4\u98ce\u96e8) blew up. A gust of wind(\u4e00\u9635\u98ce) swept(\u522e) the bed off the roof and sent it crashing(\u5206\u8bcd\u4f5c\u5bbe\u8865) into the courtyard(\u9662\u5b50) below. The young man did not wake up until the bed had struck the ground. Although the bed was smashed(\u7838\u788e) to pieces(\u5757), the man was miraculously(\u5947\u8ff9\u822c\u5730) unhurt. When he woke up, he was still on the mattress. Glancing( \u626b\u89c6) at the bits of wood and metal that lay around him, the man sadly picked up the mattress and carried it into his house. After he had put it on the floor, he promptly(\u8fc5\u901f\u5730) went to sleep again.</p>"},{"location":"english/NCE/NCE2/#_26","title":"\u5206\u8bcd\u4f5c\u72b6\u8bed","text":"<p>\u7b80\u5316\u72b6\u8bed\u4ece\u53e5</p> <p>The baby opened his eyes. The baby began to cry.</p> <p>When the baby opened his eyes, he began to cry.</p> <p>(When) opening his eyes, the baby began to cry.</p>"},{"location":"english/NCE/NCE2/#expressions_29","title":"Expressions","text":"<ul> <li>save up for years to buy sth.</li> <li>for the first time in sb.\u2019s life</li> <li>go to sleep</li> </ul>"},{"location":"english/NCE/NCE2/#50-taken-for-a-ride","title":"50 Taken for a Ride","text":"<p>I love travelling in the country, but I don't like losing my way. I went on an excursion(\u8fdc\u8db3,\u77ed\u9014\u65c5\u884c) recently, but my trip took me longer than I expected. 'I'm going to Woodford Green,' I said to the conductor(\u552e\u7968\u5458,\u6307\u6325) as I got on the bus, 'but I don't know where it is.' 'I'll tell you where to get off.' answered the conductor. I sat in the front of the bus to get a good view of the countryside. After some time, the bus stopped. Looking round, I realized with a shock(\u9707\u60ca) that I was the only passenger left on the bus. 'You'll have to get off here,' the conductor said. 'This is as far as we go.' 'Is this Woodford Green?' I asked. 'Oh dear,' said the conductor suddenly. 'I forgot to put you off.' 'It doesn't matter,' I said. 'I'll get off here.' 'We're going back now,' said the conductor. 'Well, in that case, I prefer to stay on the bus,' I answered.</p>"},{"location":"english/NCE/NCE2/#expressions_30","title":"Expressions","text":"<ul> <li>take it for granted \u5c06\u5b83\u5f53\u505a\u7406\u6240\u5f53\u7136\u3002</li> <li>ride a bike/horse</li> <li>go on an excursion \u53bb\u65c5\u884c</li> <li>get a good view of sth.</li> <li>prefer to do sth. = prefer doing sth.</li> <li>I prefer a to b</li> <li>I prefer doing a to doing b</li> <li>I prefer to do a rather than (do) b.</li> <li>I\u2019d prefer (= I would prefer) to do sth.</li> <li>I\u2019d(=would) prefer to do a rather than (do) b.</li> </ul>"},{"location":"english/NCE/NCE2/#51-reward-for-virtue","title":"51 Reward for Virtue","text":"<p>My friend, Hugh, has always been fat, but things got so bad recently that he decided to go on a diet(\u8282\u98df). He began his diet a week ago. First of all, he wrote out a long list of all the foods which were forbidden. The list included most of the things (that) Hugh loves: butter, potatoes, rice, beer, milk, chocolate, and sweets. Yesterday I paid him a visit. I rang the bell and was not surprised to see that Hugh was still as fat as ever. He led(lead,\u5f15\u9886) me into his room and hurriedly(\u8fc5\u901f\u5730) hid(hide) a large parcel(\u5305\u88f9)  under his desk. It was obvious that he was very embarrassed(\u5c34\u5c2c). When I asked him what he was doing, he smiled guiltily(\u5185\u759a) and then put the parcel on the desk. He explained that his diet was so strict(\u4e25\u683c\u7684) that he had to reward(\u5956\u52b1) himself occasionally(\u5076\u5c14). Then he showed me the contents of the parcel. It contained five large bars of chocolate and three bags of sweets!</p>"},{"location":"english/NCE/NCE2/#expressions_31","title":"Expressions","text":"<ul> <li>go on a diet = be on a diet</li> <li>forbid sb. to do sth.</li> <li>a be strict with b  a\u5bf9b\u4e25\u683c</li> <li>First of all,...</li> <li>write out a long list of ...</li> <li>pay sb. a visit ring the bell</li> <li>was not surprised to see that...</li> <li>It was obvious that ...</li> </ul>"},{"location":"english/NCE/NCE2/#52-a-pretty-carpet","title":"52 A Pretty Carpet","text":"<p>We have just moved into a new house and I have been working hard all morning. I have been trying to get my new room in order. This has not been easy because I own over a thousand books. To make matters worse, the room is rather small, so I have temporarily put my books on the floor. At the moment, they cover every inch of floor space and I actually(\u5b9e\u9645\u4e0a) have to walk on them to get in or out of the room. A short while ago, my sister helped me to carry one of my old bookcases up the stairs. She went into my room and got a big surprise when she saw all those books on the floor. 'This is the prettiest carpet(\u5730\u6bef) I have ever seen,' she said. She gazed(\u6ce8\u89c6) at it for some time then added, 'You don't need bookcases at all. You can sit here in your spare(\u7a7a\u95f2) time and read the carpet!'</p>"},{"location":"english/NCE/NCE2/#_27","title":"\u73b0\u5728\u5b8c\u6210\u8fdb\u884c\u65f6","text":"<p>\u7ed3\u6784\uff1a</p> <p>\u4e3b + have/has been doing sth.</p> <p>\u4e3b + have/has + not + been doing sth.</p> <p>Have/Has + \u4e3b + been doing sth. ?</p> <p>What have/has + \u4e3b + been doing?</p> <p>\u7528\u6cd5\u4e00\uff1a\u8fc7\u53bb\u8fdb\u884c\u7684\u52a8\u4f5c\uff08\u7ed3\u675f\uff09\u5bf9\u73b0\u5728\u6709\u5f71\u54cd</p> <p>\u7528\u6cd5\u4e00\uff1a\u8fc7\u53bb\u8fdb\u884c\u7684\u52a8\u4f5c\u6301\u7eed\u3001\u91cd\u590d\u5230\u73b0\u5728</p>"},{"location":"english/NCE/NCE2/#expressions_32","title":"Expressions","text":"<ul> <li>get sth. in order</li> <li>To make matters worse...</li> <li>A short while ago...</li> <li>help sb. to do sth.</li> <li>gaze at sth.</li> <li>in sb\u2019s spare time...</li> </ul>"},{"location":"english/NCE/NCE2/#53-hot-snake","title":"53 Hot Snake","text":"<p>At last firemen have put out a big forest fire in California. Since then, they have been trying to find out how the fire began. Forest fires are often caused by broken glass or by cigarette ends which people carelessly throw away(\u6254\u6389). Yesterday the firemen examined(\u68c0\u67e5) the ground carefully, but were not able to find any broken glass. They were also quite sure that a cigarette end did not start the fire. This morning, however, a firemen accidentally(\u610f\u5916\u5730) discovered the cause. He noticed the remains(\u6b8b\u9ab8) of a snake which was wound(wind,\u7f20\u7ed5) round the electric wires(\u7535\u7ebf) of a 16, 000-volt power line(\u7535\u7ebf). In this way, he was able to solve the mystery(\u8ff7). The explanation was simple but very unusual. A bird had snatched(\u6293) up the snake from the ground and then dropped it on to the wires. The snake then wound itself round the wires. When it did so, it sent sparks(\u706b\u82b1) down to the ground and these immediately started a fire.</p>"},{"location":"english/NCE/NCE2/#54-sticky-fingers","title":"54 Sticky Fingers","text":"<p>After breakfast, I sent the children to school and then I went to the shops. It was still early when I returned home. The children were at school, my husband was at work and the house was quiet. So I decided to make some meat pies. In a short time I was busy mixing butter and flour and my hands were soon covered with sticky(\u7c98\u7684) pastry(\u9762\u7cca,\u70b9\u5fc3). At exactly that moment, the telephone rang. Nothing could have been more annoying(\u4f7f\u4eba\u70e6\u607c\u7684). I picked up the receiver(\u7535\u8bdd\u542c\u7b52\uff0c\u63a5\u6536\u5668) between two sticky fingers and was dismayed(\u5931\u671b\u7684) when I recognized the voice of Helen Bates. It took me ten minutes to persuade(\u529d\u8bf4) her to ring back later. At last I hung up the receiver. What a mess(\u6742\u4e71)! There was pastry on my fingers, on the telephone, and on the doorknobs(\u7403\u5f62\u95e8\u62c9\u624b). I had no sooner got back to the kitchen than the doorbell rang loud(\u5927\u58f0\u7684) enough to wake the dead. This time it was the postman and he wanted me to sign for a registered letter(\u6302\u53f7\u4fe1)!</p>"},{"location":"english/NCE/NCE2/#expressions_33","title":"Expressions","text":"<ul> <li>stick to the plan \u575a\u6301\u8ba1\u5212</li> <li>put my finger on it</li> <li>point the finger at \u6307\u8d23\u6216\u8d23\u5907\u67d0\u4eba</li> <li>be dismayed to do sth.</li> <li>recognize the voice (of sb.)</li> <li>persuade sb. (not) to do sth.</li> <li>What a mess!</li> <li>such a mess</li> <li>Sign here.</li> <li>sign for sth.</li> <li>a registered letter</li> <li>send sb. to sp.</li> <li>decide to do sth.</li> <li>be busy doing sth.</li> <li>be covered with sth.</li> <li>take sb. st. to do sth.</li> <li>hang up</li> </ul>"},{"location":"english/NCE/NCE2/#55-not-a-gold-mine","title":"55 Not a Gold Mine","text":"<p>Dreams of finding lost treasure(\u5b9d\u85cf) almost came true recently. A new machine called 'The Revealer(\u63a2\u6d4b\u5668)' has been invented and it has been used to detect gold which has been buried(\u57cb) in the ground. The machine was used in a cave(\u5c71\u6d1e) near the seashore(\u5cb8\u8fb9) where--it is said--pirates(\u6d77\u76d7) used to hide gold. The pirates would often bury gold in the cave and then fail to collect it. Armed(v.\u6b66\u88c5) with the new machine, a search party went into the cave hoping to find buried treasure. The leader of the party was examining the soil(\u571f) near the entrance(\u5165\u53e3) to the cave when the machine showed that there was gold under the ground. Very excited, the party dug(dig,\u6316) a hole two feet deep. They finally found a small gold coin which was almost worthless. The party then searched the whole cave thoroughly(\u5f7b\u5e95\u5730) but did not find anything except an empty tin(\u9521) trunk(\u8863\u7bb1). In spite of this, many people are confident that 'The Revealer' may reveal something of value fairly(\u76f8\u5f53\u5730) soon.</p>"},{"location":"english/NCE/NCE2/#would-do-vs-used-to-do","title":"would do vs. used to do","text":"<p>used to do: </p> <ol> <li>\u8fc7\u53bb\u7684\u72b6\u6001</li> <li>\u73b0\u5728\u4e0d\u53d1\u751f\u4e86</li> </ol> <p>would do: </p> <ol> <li>\u8fc7\u53bb\u91cd\u590d\u53d1\u751f\u7684\u52a8\u4f5c</li> </ol>"},{"location":"english/NCE/NCE2/#56-faster-than-sound","title":"56 Faster Than Sound","text":"<p>Once a year, a race is held for old cars. A lot of cars entered for this race last year and there was a great deal of excitement(\u5174\u594b) just before it began. One of the most handsome(\u82f1\u4fca\u7684) cars was a Rolls-Royce Silver Ghost. The most unusual car was a Benz which had only three wheels. Built in 1885, it was the oldest car taking part. After a great many loud explosions(\u7206\u70b8), the race began. Many of the cars broke down on the course(\u9053\u8def) and some drivers spent more time under their cars than in them! A few cars, however, completed the race. The winning car reached a speed of forty miles an hour -- much faster than any of its rivals(\u7ade\u4e89\u5bf9\u624b). It sped downhill(\u4e0b\u5761) at the end of the race and its driver had a lot of trouble trying to stop it. The race gave everyone a great deal of pleasure. It was very different from modern car races but no less exciting.</p>"},{"location":"english/NCE/NCE2/#expressions_34","title":"Expressions","text":"<ul> <li>a great deal of ...+\u4e0d\u53ef\u6570</li> <li>break down \u53d1\u751f\u6545\u969c My car broke down.</li> <li>a be di erent from b.</li> <li>make a sound</li> <li>hear a sound</li> <li>on the course \u5728\u8def\u4e0a</li> <li>speed it/things/this up \u52a0\u5feb\u901f\u5ea6</li> <li>go downhill</li> </ul>"},{"location":"english/NCE/NCE2/#57-can-i-help-you-madam","title":"57 Can I Help You, Madam","text":"<p>A woman in jeans(\u725b\u4ed4\u88e4) stood at the window of an expensive shop. Though she hesitated(\u72b9\u8c6b) for a moment, she finally went in and asked to see a dress (that was in the window). The assistant (who served(\u670d\u52a1) her) did not like the way she was dressed. Glancing at her scornfully(\u8f7b\u8511\u5730), he told her [that the dress was sold]. The woman walked out of the shop angrily and decided to punish(\u60e9\u7f5a) the assistant next day. She returned to the shop the following morning dressed in a fur coat(\u76ae\u6bdb\u5927\u8863), with a handbag in one hand and a long umbrella in the other. After seeking(\u5bfb\u627e) out the rude assistant, she asked for the same dress. Not realizing who she was, the assistant was eager(\u6e34\u671b\u7684) to serve her this time. With great difficulty, he climbed(\u722c) into the shop window to get the dress. As soon as she saw it, the woman said she did not like it. She enjoyed herself making the assistant bring almost everything in the window before finally buying the dress (she had first asked for).</p>"},{"location":"english/NCE/NCE2/#the-way-that","title":"the way (that) ...","text":"<ol> <li>The assistant who served her did not (like) the way she was dressed.</li> <li>I don\u2019t like the way (that) you talk to me.</li> <li>We want to know the way (in which) you learn new words.</li> </ol>"},{"location":"english/NCE/NCE2/#expressions_35","title":"Expressions","text":"<ul> <li>ask to do sth.</li> <li>be dressed in ...</li> <li>seek out</li> <li>make sb. do sth.</li> </ul>"},{"location":"english/NCE/NCE2/#58-a-blessing-in-disguise","title":"58 A Blessing in Disguise","text":"<p>The tiny village of Frinley is said to possess(\u62e5\u6709) a 'cursed(\u88ab\u8bc5\u5492\u7684) tree'. Because the tree was mentioned(\u63d0\u53ca) in a newspaper, the number of visitors to Frinley has now increased. The tree was planted near the church(\u6559\u5802) fifty years ago, but it is only in recent years that it has gained an evil reputation(\u6076\u540d). It is said that if anyone touches the tree, he will have bad luck; if he picks a leaf, he will die. Many villagers believe that the tree has already claimed(\u4f7f\u5931\u8e2a\u6216\u6b7b\u4ea1) a number of victims(\u53d7\u5bb3\u8005). The vicar(\u6559\u5802\u7267\u5e08) has been asked to have the tree cut down, but so far he has refused. He has pointed out that the tree is a useful source of income, as tourists have been coming from all parts of the country to see it. In spite of all (that has been said), the tourists have been picking leaves and cutting their names on the tree-trunk. So far, not one of them has been struck down(\u6740\u6b7b) by sudden death!</p>"},{"location":"english/NCE/NCE2/#expressions_36","title":"Expressions","text":"<ul> <li>bless \u795d\u798f god bless \u4e0a\u5e1d\u4fdd\u4f51</li> <li>disguise \u5047\u88c5\uff1b\u63a9\u9970\uff1b\u9690\u7792</li> <li>A blessing in disguise \u585e\u7fc1\u5931\u9a6c\uff0c\u7109\u77e5\u975e\u798f\u3002</li> <li>be said to do sth. = it is said that...  \u636e\u8bf4</li> </ul>"},{"location":"english/NCE/NCE2/#_28","title":"\u5f3a\u8c03\u53e5","text":"<p>it is(was)+\u5f3a\u8c03\u90e8\u5206+that(who)+\u5269\u4f59\u90e8\u5206</p>"},{"location":"english/NCE/NCE2/#59-in-or-out","title":"59 In or Out","text":"<p>Our dog, Rex, used to sit outside our front gate and bark(\u72d7\u53eb). Every time he wanted to come into the garden he would bark until someone opened the gate. As the neighbours complained of the noise, my husband spent weeks training him to press his paw(\u722a\u5b50) on the latch(\u95e8\u95e9) to let himself in. Rex soon became an expert at opening the gate. However, when I was going out shopping last week, I noticed him in the garden near the gate. This time he was barking so that someone would let him out! Since then, he has developed another bad habit. As soon as he opens the gate from the outside, he comes into the garden and waits until the gate shuts. Then he sits and barks until someone lets him out. After this he immediately lets himself in and begins barking again. Yesterday my husband removed the gate and Rex got so annoyed(\u607c\u6012\u7684\uff1b\u70e6\u95f7\u7684) (that) we have not seen him since.</p>"},{"location":"english/NCE/NCE2/#_29","title":"\u76ee\u7684\u72b6\u8bed\u4ece\u53e5","text":"<p>to</p> <p>in order to</p> <p>so as to</p> <p>so that</p> <p>in order that</p> <p>so that \u4ee5\u4fbf; \u4e3a\u4e86</p>"},{"location":"english/NCE/NCE2/#expressions_37","title":"Expressions","text":"<ul> <li>become/be an expert at doing sth.</li> <li>have a habit of doing sth.</li> <li>remove sth. from...</li> <li>complained of ... \u62b1\u6028</li> <li>spend st. doing sth.</li> <li>train sb. to do sth.</li> </ul>"},{"location":"english/NCE/NCE2/#60-the-future","title":"60 The Future","text":"<p>At a village fair(\u5e02\u96c6), I decided to visit a fortune-teller(\u7b97\u547d\u5148\u751f) called Madam Bellinsky. I went into her tent(\u5e10\u7bf7) and she told me to sit down. After I had given her some money, she looked into a crystal(\u6c34\u6676\u7684) ball and said: 'A relation of yours is coming to see you. She will be arriving this evening and intends to stay for a few days. The moment you leave this tent, you will get a big surprise. A woman (you know well) will rush towards you. She will speak to you and then she will lead you away from this place. That is all.' As soon as I went outside, I forgot all about Madam Bellinsky because my wife hurried towards me. 'Where have you been hiding?' she asked impatiently(\u4e0d\u8010\u70e6\u5730;). 'Your sister will be here in less than an hour and we must be at the station to meet her. We are late already.' As she walked away, I followed her out of the fair.</p>"},{"location":"english/NCE/NCE2/#expressions_38","title":"Expressions","text":"<p>the moment = as soon as \u4e3b\u5c06\u4ece\u73b0</p>"},{"location":"english/NCE/NCE2/#61-trouble-with-the-hubble","title":"61 Trouble with the Hubble","text":"<p>The Hubble telescope(\u671b\u8fdc\u955c) was launched into space by NASA on April 20, 1990 at a cost of over a billion dollars. Right from the start there was trouble with the Hubble. The pictures (it sent us) were very disappointing(\u4ee4\u4eba\u5931\u671b\u7684) because its main mirror was faulty(\u6709\u9519\u8bef\u7684)! NASA is now going to put the telescope right, so it will soon be sending up four astronauts(\u5b87\u822a\u5458) to repair it. The shuttle(\u822a\u5929\u98de\u673a) Endeavour(\u594b\u8fdb\u53f7, \u52aa\u529b) will be taking the astronauts to the Hubble. A robot-arm (from the Endeavour) will grab the telescope and hold it while the astronauts make the necessary repairs. Of course, the Hubble is above the earth's atmosphere(\u5927\u6c14\u5c42), so it will soon be sending us the clearest pictures of the stars and distant galaxies(\u661f\u7cfb) (that we have ever seen). The Hubble will tell us a great deal about the age and size of the universe(\u5b87\u5b99). By the time you read this, the Hubble's eagle(\u9e70) eye will have sent us thousands and thousands of wonderful pictures.</p>"},{"location":"english/NCE/NCE2/#_30","title":"\u5c06\u6765\u5b8c\u6210\u8fdb\u884c\u65f6","text":"<p>will have been doing</p> <p>\u4e00\u4e2a\u52a8\u4f5c\u6301\u7eed\u6216\u91cd\u590d\u5230\u5c06\u6765</p>"},{"location":"english/NCE/NCE2/#expressions_39","title":"Expressions","text":"<ul> <li>right from the start \u4ece\u4e00\u5f00\u59cb\u5c31</li> <li>grab a beer/coffee</li> </ul>"},{"location":"english/NCE/NCE2/#62-after-the-fire","title":"62 After the Fire","text":"<p>Firemen had been fighting the forest fire for nearly three weeks before they could get it under control(\u63a7\u5236). A short time before, great trees had covered the countryside for miles around. Now, smoke still rose(rise) up from the warm ground over the desolate(\u8352\u51c9\u7684) hills. Winter was coming on and the hills threatened(\u5a01\u80c1) the surrounding villages with destruction(\u6bc1\u706d), for heavy rain would not only wash away the soil(\u571f\u5730) but would cause serious floods(\u6d2a\u6c34) as well. When the fire had at last been put out, the forest authorities(\u5f53\u5c40, \u5b98\u65b9) ordered several tons of a special type of grass-seed(\u8349\u79cd) (which would grow quickly). The seed was sprayed(\u55b7) over the ground in huge quantities by aeroplanes. The planes had been planting seed for nearly a month when it began to rain. By then, however, in many places the grass had already taken root. In place of(\u66ff\u4ee3) the great trees(which had been growing there for centuries)(\u4e16\u7eaa), patches(\u6591\u5757) of green had begun to appear in the blackened(\u53d8\u9ed1) soil.</p>"},{"location":"english/NCE/NCE2/#_31","title":"\u8fc7\u53bb\u5b8c\u6210\u8fdb\u884c\u65f6","text":"<p>\u7ed3\u6784</p> <p>\u80af\u5b9a\u53e5: \u4e3b+had been doing...</p> <p>\u5426\u5b9a\u53e5: \u4e3b+had not been doing...</p> <p>\u4e00\u822c\u7591\u95ee\u53e5: Had \u4e3b been doing...?</p> <p>\u7528\u6cd5\u4e00: \u8fc7\u53bbA\u8fdb\u884c\u7684\u52a8\u4f5c(\u7ed3\u675f)\u5bf9\u8fc7\u53bbB\u6709\u5f71\u54cd</p> <p>\u7528\u6cd5\u4e8c: \u8fc7\u53bbA\u8fdb\u884c\u7684\u52a8\u4f5c\u6301\u7eed\u6216\u91cd\u590d\u5230\u8fc7\u53bbB</p>"},{"location":"english/NCE/NCE2/#63-she-was-not-amused","title":"63 She Was Not Amused","text":"<p>Jeremy Hampden has a large circle of friends and is very popular at parties. Everybody admires(\u6b23\u8d4f) him for his great sense of humour(\u5e7d\u9ed8\u611f)--everybody, that is, except his six-year-old daughter, Jenny. Recently, one of Jeremy's closest(\u4eb2\u5bc6\u7684) friends asked him to make a speech at a wedding(\u5a5a\u793c) reception(\u62db\u5f85\u4f1a). This is the sort(\u79cd\u7c7b) of thing (that Jeremy loves). He prepared the speech carefully and went to the wedding with Jenny. He had included a large number of funny stories in the speech and, of course, it was a great success. As soon as he had finished Jenny told him (she wanted to go home). Jeremy was a little disappointed by this but he did as his daughter asked. On the way home, he asked Jenny if she had enjoyed the speech. To his surprise she said she hadn't. Jeremy asked her (why this was so) and she told him (that she did not like to see so many people laughing at him)!</p>"},{"location":"english/NCE/NCE2/#_32","title":"\u65b9\u5f0f\u72b6\u8bed\u4ece\u53e5","text":"<p>as: in the way or manner that</p> <p>like</p> <p>as if</p> <p>as though</p> <p>the way</p>"},{"location":"english/NCE/NCE2/#64-the-channel-tunnel","title":"64 The Channel Tunnel","text":"<p>In 1858, a French engineer, Aime Thome de Gamond, arrived in England with a plan for a 21-mile tunnel under the English Channel(\u6d77\u5ce1). He said that it would be possible to build a platform in the centre of the Channel. This platform would serve as(\u5145\u5f53) a port and a railway station. The tunnel would be well-ventilated(\u901a\u98ce) if tall chimneys(\u70df\u56f1) were built above sea level(\u6d77\u5e73\u9762). In 1860, a better plan was put forward by an Englishman, William Low. He suggested that a double railway-tunnel should be built. This would solve the problem of ventilation for if a train entered this tunnel, it would draw(\u5438\u5165) in fresh air behind it. Forty-two years later a tunnel was actually begun. If, at the time, the British had not feared(\u5bb3\u6015) invasion(\u4fb5\u7565), it would have been completed. The world had to wait almost another 100 years for the Channel Tunnel. It was officially(\u6b63\u5f0f\u5730) opened on March 7, 1994, finally connecting Britain to the European continent(\u6d32, \u5927\u9646).</p>"},{"location":"english/NCE/NCE2/#_33","title":"\u865a\u62df\u8bed\u6c14","text":"<p>\u7ed3\u6784: If \u4e3b had done..., \u4e3b would/could/ might/should + have done. \u4e0e\u8fc7\u53bb\u4e8b\u5b9e\u76f8\u53cd</p>"},{"location":"english/NCE/NCE2/#expressions_40","title":"Expressions","text":"<ul> <li>it is possible to do sth. ...</li> <li>a serve as b A \u5145\u5f53 B</li> <li>put forward a plan... \u63d0\u51fa\u8ba1\u5212</li> <li>solve the problem of a...</li> </ul>"},{"location":"english/NCE/NCE2/#65-jumbo-versus-the-police","title":"65 Jumbo Versus the Police","text":"<p>Last Christmas, the circus(\u9a6c\u620f\u56e2) owner, Jimmy Gates, decided to take some presents(\u793c\u7269) to a children's hospital. (Dressed up as Father Christmas) and (accompanied(\u966a\u4f34) by a 'guard of honour'(\u4eea\u4ed7\u961f) of six pretty girls), he set off(\u51fa\u53d1) down the main street of the city (riding a baby elephant called Jumbo). He should have known that the police would never allow this sort of thing. A policeman approached(\u63a5\u8fd1) Jimmy and told him he ought(\u5e94\u8be5) to have gone along a side street as Jumbo was holding up the traffic(\u963b\u788d\u4ea4\u901a). Though Jimmy agreed to go at once, Jumbo refused to move. Fifteen policemen had to push very hard to get him off the main street. The police had a difficult time, but they were most amused(\u6109\u5feb\u7684). 'Jumbo must weigh a few tons,' said a policeman afterwards, 'so it was fortunate(\u5e78\u8fd0\u7684) that we didn't have to carry him. Of course, we should arrest(\u902e\u6355) him, but as he has a good record, we shall let him off this time.'</p>"},{"location":"english/NCE/NCE2/#should-ought-to","title":"should &amp; ought to","text":"<p>shouldn\u2019t &amp; oughtn\u2019t to</p> <p>should(ought to) have done \u672c\u5e94\u8be5\u505a\u67d0\u4e8b,\u4f46\u5374\u6ca1\u6709\u3002</p>"},{"location":"english/NCE/NCE2/#66-sweet-as-honey","title":"66 Sweet as Honey","text":"<p>In 1963 a Lancaster bomber(\u8f70\u70b8\u673a) crashed on Wallis Island, a remote place in the South Pacific(\u592a\u5e73\u6d0b), a long way west of Samoa. The plane wasn't too badly damaged, but over the years the crash was forgotten and the wreck(\u6b8b\u9ab8) remained undisturbed(\u672a\u88ab\u6270\u4e71\u7684). Then in 1989, twenty-six years after the crash, the plane was accidentally(\u5076\u7136\u5730) rediscovered in an aerial(\u822a\u7a7a) survey(\u8c03\u67e5) of the island. By this time, a Lancaster bomber in reasonable condition was rare(\u5c11\u89c1\u7684) and worth rescuing. The French authorities had the plane packaged and moved in parts back to France. Now a group of enthusiasts(\u70ed\u8877\u8005) are going to have the plane restored. It has four Rolls-Royce Merlin engines but the group will need to have only three of them rebuilt. Imagine(\u60f3\u8c61) their surprise and delight(\u9ad8\u5174) when they broke open the packing cases and found that the fourth engine was sweet as honey--still in perfect condition. A colony of((\u4e00\u7fa4) bees had turned the engine into a hive(\u8702\u5de2) and it was totally preserved(\u4fdd\u85cf) in beeswax(\u8702\u8721)!</p>"},{"location":"english/NCE/NCE2/#expressions_41","title":"Expressions","text":"<ul> <li>have/get sth. done... : cause something to be done by somebody else.</li> <li>over the years \u6570\u5e74\u95f4</li> <li>in reasonable condition \u5728\u5408\u7406\u6761\u4ef6\u4e0b</li> <li>be worth doing...</li> <li>turn a into b. \u628aa\u53d8\u6210b</li> </ul>"},{"location":"english/NCE/NCE2/#67-volcanoes","title":"67 Volcanoes","text":"<p>Haroun Tazieff, the Polish scientist, has spent his lifetime studying active volcanoes(\u706b\u5c71) and deep caves(\u6d1e\u7a74) in all parts of the world. In 1948, he went to Lake Kivu in the Congo to observe a new volcano (which he later named Kituro). Tazieff was able to set up his camp(\u5b89\u8425\u624e\u5be8) very close to the volcano while it was erupting(\u7206\u53d1) violently(\u731b\u70c8\u5730). Though he managed to take a number of brilliant(\u7cbe\u5f69\u7684) photographs, he could not stay near the volcano for very long. He noticed that a river of liquid(\u6db2\u6001) rock(\u5ca9\u77f3) was coming towards him. It threatened to surround him completely, but Tazieff managed to escape(\u9003\u8131) just in time. He waited until the volcano became quiet and he was able to return two days later. This time, he managed to climb into the mouth of Kituro so that he could take photographs and measure(\u6d4b\u91cf) temperatures. Tazieff has often risked his life in this way. He has been able to tell us more about active volcanoes than any man alive.</p>"},{"location":"english/NCE/NCE2/#managed-to-do-sth","title":"managed to do sth.","text":"<p>to succeed in doing or dealing with something, especially something difficult</p> <p>\u8fc7\u53bb\u6210\u529f\u4e8b\u4ef6 (\u5177\u4f53)</p>"},{"location":"english/NCE/NCE2/#expressions_42","title":"Expressions","text":"<ul> <li>set up his camp/tent \u5b89\u8425\u624e\u5be8</li> </ul>"},{"location":"english/NCE/NCE2/#68-persistent","title":"68 Persistent","text":"<p>I crossed the street to avoid meeting him but he saw me and came running towards me. It was no use pretending that I had not seen him, so I waved to him. I never enjoy meeting Nigel Dykes. He never has anything to do. No matter how busy you are, he always insists on coming with you. I had to think of a way of preventing him from following me around all morning. 'Hello, Nigel,' I said 'Fancy meeting you here!' 'Hi, Elizabeth,' Nigel answered. 'I was just wondering how to spend the morning--until I saw you. You're not busy doing anything, are you?' 'No, not at all,' I answered. 'I'm going to...' 'Would you mind my coming with you?' he asked, before I had finished speaking. 'Not at all,' I lied, 'but I'm going to the dentist.' 'Then I'll come with you,' he answered. 'There's always plenty to read in the waiting room!'</p>"},{"location":"english/NCE/NCE2/#69-but-not-murder","title":"69 But not Murder","text":"<p>I was being tested for a driving licence for the third time. I had been asked to drive in heavy traffic and had done so successfully. After having been instructed to drive out of town, I began to acquire confidence. Sure that I had passed, I was almost beginning to enjoy my test. The examiner must have been pleased with my performance, for he smiled and said, 'Just one more thing Mr. Eames. Let us suppose that a child suddenly crosses the road in front of you. As soon as I tap on the window, you must stop within five feet.' I continued driving and after some time, the examiner tapped loudly. Though the sound could be heard clearly, it took me a long time to react. I suddenly pressed the brake pedal hard and we were both thrown forward. The examiner looked at me sadly. 'Mr. Eames,' he said, in a mournful voice, 'you have just killed that child!'</p>"},{"location":"english/NCE/NCE2/#70-red-for-danger","title":"70 Red for Danger","text":"<p>During a bullfight, a drunk suddenly wandered into the middle of the ring. The crowd began to shout, but the drunk was unaware of the danger. The bull was busy with the matador at the time, but it suddenly caught sight of the drunk who was shouting rude remarks and waving a red cap. Apparently sensitive to criticism, the bull forgot all about the matador and charged at the drunk. The crowd suddenly grew quiet. The drunk, however, seemed quite sure of himself. When the bull got close to him, he clumsily stepped aside to let it pass. The crowd broke into cheers and the drunk bowed. By this time, however three men had come into the ring and they quickly dragged the drunk to safety. Even the bull seemed to feel sorry for him, for it looked on sympathetically until the drunk was out of the way before once more turning its attention to the matador.</p>"},{"location":"english/NCE/NCE2/#71-a-famous-clock","title":"71 A Famous Clock","text":"<p>When you visit London, one of the first things you will see is Big Ben, the famous clock which can be heard all over the world on the B.B.C. If the Houses of Parliament had not been burned down in 1834, the great clock would never have been erected. Big Ben takes its name from Sir Benjamin Hall who was responsible for the making of the clock when the new Houses of Parliament were being built. It is not only of immense size, but is extremely accurate as well. Officials from Greenwich Observatory have the clock checked twice a day. On the B.B.C. you can hear the clock when it is actually striking because microphones are connected to the clock tower. Big Ben has rarely gone wrong. Once, however, it failed to give the correct time. A painter who had been working on the tower hung a pot of paint on one of the hands and slowed it down!</p>"},{"location":"english/NCE/NCE2/#72-a-car-called-bluebird","title":"72 A Car Called Bluebird","text":"<p>The great racing driver, Sir Malcolm Campbell, was the first man to drive at over 300 miles per hour. He set up a new world record in September 1935 at Bonneville Salt Flats, Utah. Bluebird, the car he was driving, had been specially built for him. It was over 30 feet in length and had a 2, 500-horsepower engine. Although Campbell reached a speed of over 304 miles per hour, he had great difficulty in controlling the car because a tyre burst during the first run. After his attempt, Campbell was disappointed to learn that his average speed had been 299 miles per hour. However, a few days later, he was told that a mistake had been made. His average speed had been 301 miles per hour. Since that time, racing drivers have reached speeds over 600 miles an hour. Following in his father's footsteps many years later, Sir Malcolm's son, Donald, also set up a world record. Like his father, he was driving a car called Bluebird.</p>"},{"location":"english/NCE/NCE2/#73-the-record-holder","title":"73 The Record-Holder","text":"<p>Children who play truant from school are unimaginative. A quiet days' fishing, or eight hours in a cinema seeing the same film over and over again, is usually as far as they get. They have all been put to shame by a boy who, while playing truant travelled 1, 600 miles. He hitchhiked to Dover and towards evening went into a boat to find somewhere to sleep. When he woke up next morning, he discovered that the boat had, in the meantime, travelled to Calais. No one noticed the boy as he crept off. From there, he hitchhiked to Paris in a lorry. The driver gave him a few biscuits and a cup of coffee and left him just outside the city. The next car the boy stopped did not take him into the centre of Paris as he hoped it would, but to Perpignan on the French-Spanish border. There he was picked up by a policeman and sent back to England by the local authorities. He has surely set up a record for the thousands of children who dream of evading school.</p>"},{"location":"english/NCE/NCE2/#74-out-of-the-limelight","title":"74 Out of the Limelight","text":"<p>An ancient bus stopped by a dry river bed and a party of famous actors and actresses got off. Dressed in dark glasses and old clothes, they had taken special precautions so that no one should recognize them. But as they soon discovered, disguises can sometimes be too perfect. 'This is a wonderful place for a picnic,' said Gloria Gleam. 'It couldn't be better, Gloria,' Brinksley Meers agreed. 'No newspaper men, no film fans! Why don't we come more often?' Meanwhile, two other actors Rockwall Slinger and Merlin Greeves, had carried two large food baskets to a shady spot under some trees. When they had all made themselves comfortable, a stranger appeared. He looked very angry. 'Now you get out of here, all of you!' he shouted. 'I'm sheriff here. Do you see that notice? It says \"No Camping\"  -- in case you can't read!' 'Look, sheriff,' said Rockwall, 'don't be too hard on us. I'm Rockwall Slinger and this is Merlin Greeves.' 'Oh, is it?' said the sheriff with a sneer. 'Well, I'm Brinksley Meers, and my other name is Gloria Gleam. Now you get out of here fast!'</p>"},{"location":"english/NCE/NCE2/#75-sos","title":"75 SOS","text":"<p>When a light passenger plane flew off course some time ago, it crashed in the mountains and its pilot was killed. The only passengers, a young woman and her two baby daughters, were unhurt. It was the middle of winter. Snow lay thick on the ground. The woman knew that the nearest village was miles away. When it grew dark, she turned a suitcase into a bed and put the children inside it, covering them with all the clothes she could find. During the night, it got terribly cold. The woman kept as near as she could to the children and even tried to get into the case herself, but it was too small. Early next morning, she heard planes passing overhead and wondered how she could send a signal. Then she had an idea. She stamped out the letters 'SOS' in the snow. Fortunately, a pilot saw the signal and sent a message by radio to the nearest town. It was not long before a helicopter arrived on the scene to rescue the survivors of the plane crash.</p>"},{"location":"english/NCE/NCE2/#76-april-fools-day","title":"76 April Fools' Day","text":"<p>'To end our special news bulletin,' said the voice of the television announcer, 'we're going over to the macaroni fields of Calabria. Macaroni has been grown in this area for over six hundred years. Two of the leading growers Giuseppe Moldova and Riccardo Brabante, tell me that they have been expecting a splendid crop this year and harvesting has begun earlier than usual. Here you can see two workers who, between them, have just finished cutting three cartloads of golden brown macaroni stalks. The whole village has been working day and night gathering and threshing this year's crop before the September rains. On the right, you can see Mrs. Brabante herself. She has been helping her husband for thirty years now. Mrs. Brabante is talking to the manager of the local factory where the crop is processed. This last scene shows you what will happen at the end of the harvest: the famous Calabrian macaroni-eating competition! Signor Fratelli, the present champion, has won it every year since 1991. And that ends our special bulletin for today, Thursday, April 1st. We're now going back to the studio.'</p>"},{"location":"english/NCE/NCE2/#77-a-successful-operation","title":"77 A Successful Operation","text":"<p>The mummy of an Egyptian woman who died in 800 B.C. has just had an operation. The mummy is that of Shepenmut who was once a singer in the Temple of Thebes. As there were strange marks on the X-ray plates taken of the mummy, doctors have been trying to find out whether the woman died of a rare disease. The only way to do this was to operate. The operation, which lasted for over four hours, proved to be very difficult because of the hard resin which covered the skin. The doctors removed a section of the mummy and sent it to a laboratory. They also found something which the X-ray plates did not show: a small wax figure of the god Duamutef. This god which has the head of a cow was normally placed inside a mummy. The doctors have not yet decided how the woman died. They feared that the mummy would fall to pieces when they cut it open, but fortunately this has not happened. The mummy successfully survived the operation.</p>"},{"location":"english/NCE/NCE2/#78-the-last-one","title":"78 The Last One","text":"<p>After reading an article entitled 'Cigarette Smoking and Your Health' I lit a cigarette to calm my nerves. I smoked with concentration and pleasure as I was sure that this would be my last cigarette. For a whole week I did not smoke at all and during this time my wife suffered terribly. I had all the usual symptoms of someone giving up smoking: a bad temper and an enormous appetite. My friends kept on offering me cigarettes and cigars. They made no effort to hide their amusement whenever I produced a packet of sweets from my pocket. After seven days of this I went to a party. Everybody around me was smoking and I felt extremely uncomfortable. When my old friend Brian urged me to accept a cigarette, it was more than I could bear. I took one guiltily, lit it and smoked with satisfaction. My wife was delighted that things had returned to normal once more. Anyway, as Brian pointed out, it is the easiest thing in the world to give up smoking. He himself has done it lots of times!</p>"},{"location":"english/NCE/NCE2/#79-by-air","title":"79 By Air","text":"<p>I used to travel by air a great deal when I was a boy. My parents used to live in South America and I used to fly there from Europe in the holidays. A flight attendant would take charge of me and I never had an unpleasant experience. I am used to travelling by air and only on one occasion have I ever felt frightened. After taking off, we were flying low over the city and slowly gaining height, when the plane suddenly turned round and flew back to the airport. While we were waiting to land, a flight attendant told us to keep calm and to get off the plane quietly as soon as it had touched down. Everybody on board was worried and we were curious to find out what had happened. Later we learnt that there was a very important person on board. The police had been told that a bomb had been planted on the plane. After we had landed, the plane was searched thoroughly. Fortunately, nothing was found and five hours later we were able to take off again.</p>"},{"location":"english/NCE/NCE2/#80-the-crystal-palace","title":"80 The Crystal Palace","text":"<p>Perhaps the most extraordinary building of the 19th century was the Crystal Palace which was built in Hyde Park for the Great Exhibition of 1851. The Crystal Palace was different from all other buildings in the world, for it was made of iron and glass. It was one of the biggest buildings of all time and a lot of people from many countries came to see it. A great many goods were sent to the exhibition from various parts of the world. There was also a great deal of machinery on display. The most wonderful piece of machinery on show was Nasmyth's steam hammer. Though in those days travelling was not as easy as it is today, steam boats carried thousands of visitors across the Channel from Europe. On arriving in England, they were, taken to the Crystal Palace by train. There were six million visitors in all, and the profits from the exhibition were used to build museums and colleges. Later, the Crystal Palace was moved to South London. It remained one of the most famous buildings in the world until it was burnt down in 1936.</p>"},{"location":"english/NCE/NCE2/#81-escape","title":"81 Escape","text":"<p>When he had killed the guard, the prisoner of war quickly dragged him into the bushes. Working rapidly in the darkness, he soon changed into the dead man's clothes. Now, dressed in a blue uniform and with a rifle over his shoulder, the prisoner marched boldly up and down in front of the camp. He could hear shouting in the camp itself. Lights were blazing and men were running here and there: they had just discovered that a prisoner had escaped. At that moment, a large black car with four officers inside it, stopped at the camp gates. The officers got out and the prisoner stood to attention and saluted as they passed. When they had gone the driver of the car came towards him. The man obviously wanted to talk. He was rather elderly with grey hair and clear blue eyes. The prisoner felt sorry for him, but there was nothing else he could do. As the man came near the prisoner knocked him to the ground with a sharp blow. Then, jumping into the car, he drove off as quickly as he could.</p>"},{"location":"english/NCE/NCE2/#82-monster-or-fish","title":"82 Monster or Fish","text":"<p>Fishermen and sailors sometimes claim to have seen monsters in the sea. Though people have often laughed at stories told by seamen, it is now known that many of these 'monsters' which have at times been sighted are simply strange fish. Occasionally, unusual creatures are washed to the shore, but they are rarely caught out at sea. Some time ago, however, a peculiar fish was caught near Madagascar. A small fishing boat was carried miles out to sea by the powerful fish as it pulled on the line. Realizing that this was no ordinary fish, the fisherman made every effort not to damage it in any way. When it was eventually brought to shore, it was found to be over thirteen feet long. It had a head like a horse big blue eyes, shining silver skin, and a bright red tail. The fish, which has since been set to a museum where it is being examined by a scientist, is called an oarfish. Such creatures have rarely been seen alive by man as they live at a depth of six hundred feet.</p>"},{"location":"english/NCE/NCE2/#83-after-the-elections","title":"83 After the Elections","text":"<p>The former Prime Minister, Mr. Wentworth Lane, was defeated in the recent elections. He is now retiring from political life and has gone abroad. My friend, Patrick, has always been a fanatical opponent of Mr. Lane's Radical Progressive Party. After the elections, Patrick went to the former Prime Minister's house. When he asked if Mr. Lane lived there, the policeman on duty told him that since his defeat, the ex-Prime Minister had gone abroad. On the following day Patrick went to the house again. The same policeman was just walking slowly past the entrance, when Patrick asked the same question. Though a little suspicious this time the policeman gave him the same answer. The day after, Patrick went to the house once more and asked exactly the same question. This time, the policeman lost his temper. 'I told you yesterday and the day before yesterday,' he shouted, 'Mr.Lane was defeated in the elections. He has retired from political life and gone to live abroad!' 'I know,' answered Patrick,' but I love to hear you say it!'</p>"},{"location":"english/NCE/NCE2/#84-on-strike","title":"84 On Strike","text":"<p>Busmen have decided to go on strike next week. The strike is due to begin on Tuesday. No one knows how long it will last. The busmen have stated that the strike will continue until general agreement is reached about pay and working conditions. Most people believe that the strike will last for at least a week. Many owners of private cars are going to offer 'free rides' to people on their way to work. This will relieve pressure on the trains to some extent. Meanwhile, a number of university students have volunteered to drive buses while the strike lasts. All the students are expert drivers, but before they drive any of the buses, they will have to pass a special test. The students are going to take the test in two days' time. Even so, people are going to find it difficult to get to work. But so far, the public has expressed its gratitude to the students in lettters to the Press. Only one or two people have objected that the students will drive too fast!</p>"},{"location":"english/NCE/NCE2/#85-never-too-old-to-learn","title":"85 Never Too Old To Learn","text":"<p>I have just received a letter from my old school, informing me that my former headmaster, Mr. Stuart Page, will be retiring next week. Pupils of the school old and new, will be sending him a present to mark the occasion. All those who have contributed towards the gift will sign their names in a large album which will be sent to the headmaster's home. We shall all remember Mr. Page for his patience and understanding and for the kindly encouragement he gave us when we went so unwillingly to school. A great many former pupils will be attending a farewell dinner in his honour next Thursday. It is a curious coincidence that the day before his retirement, Mr. Page will have been teaching for a total of forty years. After he has retired he will devote himself to gardening. For him, this will be an entirely new hobby. But this does not matter, for, as he has often remarked, one is never too old to learn.</p>"},{"location":"english/NCE/NCE2/#86-out-of-control","title":"86 Out of Control","text":"<p>As the man tried to swing the speedboat round, the steering wheel came away in his hands. He waved desperately to his companion, who had been water skiing for the last fifteen minutes. Both men had hardly had time to realize what was happening when they were thrown violently into the sea. The speedboat had struck a buoy, but it continued to move very quickly across the water. Both men had just begun to swim towards the shore, when they noticed with dismay that the speedboat was moving in a circle. It now came straight towards them at tremendous speed. In less than a minute, it roared past them only a few feet away. After it had passed, they swam on as quickly as they could because they knew that the boat would soon return. They had just had enough time to swim out of danger when the boat again completed a circle. On this occasion, however, it had slowed down considerably. The petrol had nearly all been used up. Before long, the noise dropped completely and the boat began to drift gently across the water.</p>"},{"location":"english/NCE/NCE2/#87-a-perfect-alibi","title":"87 A Perfect Alibi","text":"<p>'At the time the murder was committed, I was travelling on the 8 o'clock train to London,' said the man. 'Do you always catch such an early train?' asked the inspector. 'Of course I do,' answered the man. 'I must be at work at 10 o'clock. My employer will confirm that I was there on time.' 'Would a later train get you to work on time?' asked the inspector. 'I suppose it would, but I never catch a later train.' 'At what time did you arrive at the station?' 'At ten to eight. I bought a paper and waited for the train.' 'And you didn't notice anything unusual?' 'Of course not.' 'I suggest,' said the inspector,' that you are not telling the truth. I suggest that you did not catch the 8 o'clock train, but that you caught the 8.25 which would still get you to work on time. You see, on the morning of the murder, the 8 o'clock train did not run at all. It broke down at Ferngreen station and was taken off the line.'</p>"},{"location":"english/NCE/NCE2/#88-trapped-in-a-mine","title":"88 Trapped in a Mine","text":"<p>Six men have been trapped in a mine for seventeen hours. If they are not brought to the surface soon they may lose their lives. However, rescue operations are proving difficult. If explosives are used, vibrations will cause the roof of the mine to collapse. Rescue workers are therefore drilling a hole on the north side of the mine. They intend to bring the men up in a special capsule. If there had not been a hard layer of rock beneath the soil, they would have completed the job in a few hours. As it is, they have been drilling for 16 hours and they still have a long way to go. Meanwhile, a microphone, which was lowered into the mine two hours ago, has enabled the men to keep in touch with their closest relatives. Though they are running out of food and drink, the men are cheerful and confident that they will get out soon. They have been told that rescue operations are progressing smoothly. If they knew how difficult it was to drill through the hard rock, they would lose heart.</p>"},{"location":"english/NCE/NCE2/#89-a-slip-of-the-tongue","title":"89 A Slip of the Tongue","text":"<p>People will do anything to see a free show--even if it is a bad one. When the news got round that a comedy show would be presented at our local cinema by the P. and U. Bird Seed Company, we all rushed to see it. We had to queue for hours to get in and there must have been several hundred people present just before the show began. Unfortunately, the show was one of the dullest we have ever seen. Those who failed to get in need not have felt disappointed, as many of the artistes who should have appeared did not come. The only funny things we heard that evening came from the advertiser at the beginning of the programme. He was obviously very nervous and for some minutes stood awkwardly before the microphone. As soon as he opened his mouth, everyone burst out laughing. We all know what the poor man should have said, but what he actually said was: 'This is the Poo and Ee Seed Bird Company. Good ladies, evening and gentlemen!'</p>"},{"location":"english/NCE/NCE2/#90-whats-for-supper","title":"90 What's for Supper?","text":"<p>Fish and chips has always been a favourite dish in Britain, but as the oceans have been overfished, fish has become more and more expensive. So it comes as a surprise to learn that giant fish are terrifying the divers on North Sea oil rigs. Oil rigs have to be repaired frequently and divers, who often have to work in darkness a hundred feet under water, have been frightened out of their wits by giant fish bumping into them as they work. Now they have had special cages made to protect them from these monsters. The fish are not sharks or killer whales, but favourite eating varieties like cod and skate which grow to unnatural sizes, sometimes as much as twelve feet in length. Three factors have caused these fish to grow so large: the warm water round the hot oil pipes under the sea; the plentiful supply of food thrown overboard by the crews on the rigs; the total absence of fishing boats around the oil rigs. As a result, the fish just eat and eat and grow and grow in the lovely warm water. Who eats who?</p>"},{"location":"english/NCE/NCE2/#91-three-men-in-a-basket","title":"91 Three Men in a Basket","text":"<p>A pilot noticed a balloon which seemed to be making for a Royal Air Force station nearby. He informed the station at once, but no one there was able to explain the mystery. The officer in the control tower was very angry when he heard the news, because balloons can be a great danger to aircraft. He said that someone might be spying on the station and the pilot was ordered to keep track of the strange object. The pilot managed to circle the balloon for some time. He could make out three men in a basket under it and one of them was holding a pair of binoculars. When the balloon was over the station, the pilot saw one of the men taking photographs. Soon afterwards, the balloon began to descend and it landed near an airfield. The police were called in, but they could not arrest anyone, for the basket contained two Members of Parliament and the Commanding Officer of the station! As the Commanding Officer explained later, one half of the station did not know what the other half was doing!</p>"},{"location":"english/NCE/NCE2/#92-asking-for-trouble","title":"92 Asking for Trouble","text":"<p>It must have been about two in the morning when I returned home. I tried to wake up my wife by ringing the doorbell, but she was fast asleep, so I got a ladder from the shed in the garden, put it against the wall, and began climbing towards the bedroom window. I was almost there when a sarcastic voice below said. 'I don't think the windows need cleaning at this time of the night.' I looked down and nearly fell off the ladder when I saw a policeman. I immediately regretted answering in the way I did, but I said, 'I enjoy cleaning windows at night.' 'So do I,' answered the policeman in the same tone. Excuse my interrupting you. I hate to interrupt a man when he's busy working, but would you mind coming with me to the station?' 'Well, I'd prefer to stay here,' I said. 'You see, I've forgotten my key.' 'Your what?' he called. 'My key,' I shouted. Fortunately, the shouting woke up my wife who opened the window just as the policeman had started to climb towards me.</p>"},{"location":"english/NCE/NCE2/#93-a-noble-gift","title":"93 A Noble Gift","text":"<p>One of the most famous monuments in the world, the Statue of Liberty, was presented to the USA in the nineteenth century by the people of France. The great statue, which was designed by the sculptor Auguste Bartholdi, took ten years to complete. The actual figure was made of copper supported by a metal framework which had been especially constructed by Eiffel. Before it could be transported to the United States, a site had to be found for it and a pedestal had to be built. The site chosen was an island at the entrance of New York Harbour. By 1884, a statue which was 151 feet tall had been erected in Paris. The following year, it was taken to pieces and sent to America. By the end of October 1886, the statue had been put together again and it was officially presented to the American people by Bartholdi. Ever since then, the great monument has been a symbol of liberty for the millions of people who have passed through New York Harbour to make their homes in America.</p>"},{"location":"english/NCE/NCE2/#94-future-champions","title":"94 Future Champions","text":"<p>Experiments have proved that children can be instructed in swimming at a very early age. At a special swimming pool in Los Angeles, children become expert at holding their breath under water even before they can walk. Babies of two months old do not appear to be reluctant to enter the water. It is not long before they are so accustomed to swimming that they can pick up weights from the floor of the pool. A game that is very popular with these young swimmers is the underwater tricycle race. Tricycles are lined up on the floor of the pool seven feet under water. The children compete against each other to reach the other end of the pool. Many pedal their tricycles but most of them prefer to push or drag them. Some children can cover the whole length of the pool without coming up for breath even once. Whether they will ever become future Olympic champions, only time will tell. Meanwhile, they should encourage those among us who cannot swim five yards before they are gasping for air.</p>"},{"location":"english/NCE/NCE2/#95-a-fantasy","title":"95 A Fantasy","text":"<p>When the Ambassador of Escalopia returned home for lunch, his wife got a shock. He looked pale and his clothes were in a frightful state. 'What has happened?' she asked. 'How did your clothes get into such a mess?' 'A fire extinguisher, my dear,' answered the Ambassador drily. 'University students set the Embassy on fire this morning.' 'Good heavens!' exclaimed his wife. 'And where were you at the time?' 'I was in my office as usual,' answered the Ambassador. 'The fire broke out in the basement. I went down immediately, of course, and that fool, Horst, aimed a fire extinguisher at me. He thought I was on fire. I must definitely get that fellow posted.' The Ambassador's wife went on asking questions, when she suddenly noticed a big hole in her husband's hat. 'And how can you explain that?' she asked. 'Oh, that,' said the Ambassador. 'Someone fired a shot through my office window. Accurate, don't you think? Fortunately, I wasn't wearing it at the time. If I had been, I would not have been able to get home for lunch.'</p>"},{"location":"english/NCE/NCE2/#96-the-dead-return","title":"96 The Dead Return","text":"<p>A Festival for the Dead is held once a year in Japan. This festival is a cheerful occasion, for on this day, the dead are said to return to their homes and they are welcomed by the living. As they are expected to be hungry after their long journey, food is laid out for them. Specially-made lanterns are hung outside each house to help the dead to find their way. All night long, people dance and sing. In the early morning the food that had been laid out for the dead is thrown into a river or into the sea as it is considered unlucky for anyone living to eat it. In towns that are near the sea, the tiny lanterns which had been hung in the streets the night before, are placed into the water when the festival is over. Thousands of lanterns slowly drift out to sea guiding the dead on their return journey to the other world. This is a moving spectacle, for crowds of people stand on the shore watching the lanterns drifting away until they can be seen no more.</p> <p>\u7ec3\u4e60\u65b9\u6cd5\uff1a</p> <ol> <li>\u4e60\u60ef\u7528\u6cd5\u9020\u53e5\u3001\u5bf9\u8bdd\uff085\u53e5\uff09</li> <li>\u6587\u7ae0\u8ddf\u8bfb\u81f3\u719f\u8bfb\u6210\u8bf5</li> </ol> <p>\u5355\u8bcd\u9020\u53e5\u6307\u5357\uff1a</p> <ol> <li>v. + v\u53d8\u5316</li> <li>\u56db\u53e5\u578b\u8f6c\u6362</li> <li>\u65b9\u5f0f/\u5730\u70b9/\u65f6\u95f4</li> <li>\u7ed3\u5408\u5176\u4ed6\u4e60\u60ef\u7528\u6cd5</li> <li>\u5176\u4ed6\u5355\u8bcd+\u8bcd\u6027</li> <li>\u539f\u6587\u6458\u6284+\u53d8</li> </ol>"},{"location":"english/NCE/NCE3/","title":"NCE3","text":""},{"location":"english/NCE/NCE3/#01-a-puma-at-large","title":"01 A Puma at Large","text":"<p>Pumas(\u7f8e\u6d32\u8c79) are large, cat-like animals which are found in America. When reports came into London Zoo that a wild(\u91ce\u751f\u7684) puma had been spotted(\u53d1\u73b0) forty-five miles south of London, they were not taken seriously(\u4e25\u8083\u5730). However, as the evidence began to accumulate(\u79ef\u7d2f), experts from the Zoo felt obliged to investigate, for the descriptions given by people who claimed to have seen the puma were extraordinarily similar. The hunt for the puma began in a small village where a woman picking blackberries saw 'a large cat'only five yards away from her. It immediately ran away when she saw it, and experts confirmed that a puma will not attack a human being unless it is cornered. The search proved difficult, for the puma was often observed at one place in the morning and at another place twenty miles away in the evening. Wherever it went, it left behind it a trail of dead deer and small animals like rabbits. Paw prints were seen in a number of places and puma fur was found clinging to bushes. Several people complained of 'cat-like noises' at night and a businessman on a fishing trip saw the puma up a tree. The experts were now fully convinced that the animal was a puma, but where had it come from? As no pumas had been reported missing from any zoo in the country, this one must have been in the possession of a private collector and somehow managed to escape. The hunt went on for several weeks, but the puma was not caught. It is disturbing to think that a dangerous wild animal is still at large in the quiet countryside.</p>"},{"location":"english/NCE/NCE3/#02-thirteen-equals-one","title":"02 Thirteen Equals One","text":"<p>Our vicar is always raising money for one cause or another, but he has never managed to get enough money to have the church clock repaired. The big clock which used to strike the hours day and night was damaged many years ago and has been silent ever since. One night, however, our vicar woke up with a start:the clock was striking the hours! Looking at his watch, he saw that it was one o'clock, but the bell struck thirteen times before it stopped. Armed with a torch, the vicar went up into the clock tower to see what was going on. In the torchlight, he caught sight of a figure whom he immediately recognized as Bill Wilkins, our local grocer. 'Whatever are you doing up here Bill?' asked the vicar in surprise. 'I'm trying to repair the bell, ' answered Bill. 'I've been coming up here night after night for weeks now. You see, I was hoping to give you a surprise.' 'You certainly did give me a surprise!' said the vicar. 'You've probably woken up everyone in the village as well. Still, I'm glad the bell is working again.' 'That's the trouble, vicar, 'answered Bill. 'It's working all right, but I'm afraid that at one o'clock it will strike thirteen times and there's nothing I can do about it.' 'We'll get used to that, Bill, 'said the vicar. 'Thirteen is not as good as one, but it's better than nothing. Now let's go downstairs and have a cup of tea.'</p>"},{"location":"english/NCE/NCE3/#03-an-unknown-goddess","title":"03 An Unknown Goddess","text":"<p>Some time ago, an interesting discovery was made by archaeologists on the Aegean island of Kea. An American team explored a temple which stands in an ancient city on the promontory of Ayia Irini. The city at one time must have been prosperous, for it enjoyed a high level of civilization. Houses -- often three storeys high -- were built of stone. They had large rooms with beautifully decorated walls. The city was even equipped with a drainage system, for a great many clay pipes were found beneath the narrow streets. The temple which the archaeologists explored was used as a place of worship from the fifteenth century B.C. until Roman times. In the most sacred room of the temple, clay fragments of fifteen statues were found. Each of these represented a goddess and had, at one time, been painted. The body of one statue was found among remains dating from the 15th century B.C. Its missing head happened to be among remains of the fifth century B.C. This head must have been found in Classical times and carefully preserved. It was very old and precious even then. When the archaeologists reconstructed the fragments, they were amazed to find that the goddess turned out to be a very modern-looking woman. She stood three feet high and her hands rested on her hips. She was wearing a full-length skirt which swept the ground. Despite her great age, she was very graceful indeed, but, so far, the archaeologists have been unable to discover her identity.</p>"},{"location":"english/NCE/NCE3/#04-the-double-life-of-alfred-bloggs","title":"04 The Double Life of Alfred Bloggs","text":"<p>These days, people who do manual work often receive far more money than people who work in offices. People who work in offices are frequently referred to as 'white-collar workers' for the simple reason that they usually wear a collar and tie to go to work. Such is human nature, that a great many people are often willing to sacrifice higher pay for the privilege of becoming white-collar workers. This can give rise to curious situations, as it did in the case of Alfred Bloggs who worked as a dustman for the Ellesmere Corporation. When he got married, Alf was too embarrassed to say anything to his wife about his job. He simply told her that he worked for the Corporation. Every morning, he left home dressed in a smart black suit. He then changed into overalls and spent the next eight hours as a dustman. Before returning home at night, he took a shower and changed back into his suit. Alf did this for over two years and his fellow dustmen kept his secret. Alf's wife has never discovered that she married a dustman and she never will, for Alf has just found another job. He will soon be working in an office. He will be earning only half as much as he used to, but he feels that his rise in status is well worth the loss of money. From now on, he will wear a suit all day and others will call him 'Mr.Bloggs', not 'Alf'.</p>"},{"location":"english/NCE/NCE3/#05-the-facts","title":"05 The Facts","text":"<p>Editors of newspapers and magazines often go to extremes to provide their readers with unimportant facts and statistics. Last year a journalist had been instructed by a well-known magazine to write an article on the president's palace in a new African republic. When the article arrived, the editor read the first sentence and then refused to publish it. The article began:'Hundreds of steps lead to the high wall which surrounds the president's palace.' The editor at once sent the journalist a fax instructing him to find out the exact number of steps and the height of the wall. The journalist immediately set out to obtain these important facts, but he took a long time to send them. Meanwhile, the editor was getting impatient, for the magazine would soon go to press. He sent the journalist two more faxes, but received no reply. He sent yet another fax informing the journalist that if he did not reply soon he would be fired. When the journalist again failed to reply,  the editor reluctantly published the article as it had originally been written. A week later, the editor at last received a fax from the journalist. Not only had the poor man been arrested, but he had been sent to prison as well. However, he had at last been allowed to send a fax in which he informed the editor that he had been arrested while counting the 1, 084 steps leading to the 15th foot wall which surrounded the president's palace.</p>"},{"location":"english/NCE/NCE3/#06-smash-and-grab","title":"06 Smash-and-Grab","text":"<p>The expensive shops in a famous arcade near Piccadilly were just opening. At this time of the morning, the arcade was almost empty. Mr. Taylor, the owner of a jewellery shop was admiring a new window display. Two of his assistants had been working busily since 8 o'clock and had only just finished. Diamond necklaces and rings had been beautifully arranged on a background of black velvet. After gazing at the display for several minutes, Mr. Taylor went back into his shop. The silence was suddenly broken when a large car, with its headlights on and its horn blaring, roared down the arcade. It came to a stop outside the jeweller's. One man stayed at the wheel while two others with black stockings over their faces jumped out and smashed the window of the shop with iron bars. While this was going on, Mr. Taylor was upstairs. He and his staff began throwing furniture out of the window. Chairs and tables went flying into the arcade. One of the thieves was struck by a heavy statue, but he was too busy helping himself to diamonds to notice any pain. The raid was all over in three minutes, for the men scrambled back into the car and it moved off at a fantastic speed. Just as it was leaving, Mr.Taylor rushed out and ran after it throwing ashtrays and vases, but it was impossible to stop the thieves. They had got away with thousands of pounds worth of diamonds.</p>"},{"location":"english/NCE/NCE3/#07-mutilated-ladies","title":"07 Mutilated Ladies","text":"<p>People who live in Britain needn't despair when they make mistakes like this (and a lot of people do)! Fortunately for them, the Bank of England has a team called Mutilated Ladies which deals with claims from people who fed their money to a machine or to their dog. Dogs, it seems, love to chew up money! A recent case concerns Jane Butlin whose fiance, John, runs a successful furniture business. John had a very good day and put his wallet containing \uffe13, 000 into the microwave oven for safekeeping. Then he and Jane went horse-riding. When they got home, Jane cooked their dinner in the microwave oven and without realizing it, cooked her fiance's wallet as well. Imagine their dismay when they found a beautifully-cooked wallet and notes turned to ash! John went to see his bank manager who sent the remains of wallet and the money to the special department of the Bank of England in Newcastle: the Mutilated Ladies! They examined the remains and John got all his money back. 'So long as there's something to identify, we will give people their money back,' said a spokeswoman for the Bank. 'Last year, we paid \uffe11.5 million on 21,000 claims.'</p>"},{"location":"english/NCE/NCE3/#08-a-famous-monastery","title":"08 A Famous Monastery","text":"<p>The Great St.Bernard Pass connects Switzerland to Italy. At 2,473 metres, it is the highest mountain pass in Europe. The famous monastery of St.Bernard, which was founded in the eleventh century, lies about a mile away. For hundreds of years, St.Bernard dogs have saved the lives of travellers crossing the dangerous Pass. These friendly dogs, which were first brought from Asia, were used as watchdogs even in Roman times. Now that a tunnel has been built through the mountains, the Pass is less dangerous, but each year, the dogs are still sent out into the snow whenever a traveller is in difficulty. Despite the new tunnel, there are still a few people who rashly attempt to cross the Pass on foot. During the summer months, the monastery is very busy, for it is visited by thousands of people who cross the Pass in cars. As there are so many people about, the dogs have to be kept in a special enclosure. In winter, however, life at the monastery is quite different. The temperature drops to -30 degrees, and very few people attempt to cross the Pass. The monks prefer winter to summer for they have more privacy. The dogs have greater freedom, too, for they are allowed to wander outside their enclosure. The only regular visitors to the monastery in winter are parties of skiers who go there at Christmas and Easter. These young people, who love the peace of the mountains, always receive a warm welcome at St.Bernard's monastery.</p>"},{"location":"english/NCE/NCE3/#09-flying-cats","title":"09 Flying Cats","text":"<p>Cats never fail to fascinate human beings. They can be friendly and affectionate towards humans, but they lead mysterious lives of their own as well. They never become submissive like dogs and horses. As a result, humans have learned to respect feline independence. Most cats remain suspicious of humans all their lives. One of the things that fascinates us most about cats is the popular belief that they have nine lives. Apparently, there is a good deal of truth in this idea. A cat's ability to survive falls is based on fact. Recently the New York Animal Medical Centre made a study of 132 cats over a period of five months. All these cats had one experience in common: they had fallen off high buildings, yet only eight of them died from shock or injuries. Of course, New York is the ideal place for such an interesting study, because there is no shortage of tall buildings. There are plenty of high-rise windowsills to fall from! One cat, Sabrina, fell 32 storeys, yet only suffered from a broken tooth. 'Cats behave like well-trained paratroopers,' a doctor said. It seems that the further cats fall, the less they are likely to injure themselves. In a long drop, they reach speeds of 60 miles an hour and more. At high speeds, falling cats have time to relax. They stretch out their legs like flying squirrels. This increases their air-resistance and reduces the shock of impact when they hit the ground.</p>"},{"location":"english/NCE/NCE3/#10-the-loss-of-the-titanic","title":"10 The Loss of the Titanic","text":"<p>The great ship, Titanic sailed for New York from Southampton on April 10th, 1912. She was carrying 1, 316 passengers and a crew of 891. Even by modern standards, the 46, 000 ton Titanic was a colossal ship. At that time, however, she was not only the largest ship that had ever been built, but was regarded as unsinkable, for she had sixteen water-tight compartments. Even if two of these were flooded, she would still be able to float. The tragic sinking of this great liner will always be remembered, for she went down on her first voyage with heavy loss of life. Four days after setting out, while the Titanic was sailing across the icy waters of the North Atlantic, a huge iceberg was suddenly spotted by a lookout. After the alarm had been given, the great ship turned sharply to avoid a direct collision. The Titanic turned just in time, narrowly missing the immense wall of ice which rose over 100 feet out of the water beside her. Suddenly, there was a slight trembling sound from below, and the captain went down to see what had happened. The noise had been so faint that no one thought that the ship had been damaged. Below, the captain realized to his horror that the Titanic was sinking rapidly, for five of her sixteen watertight compartments had already been flooded! The order to abandon ship was given and hundreds of people plunged into the icy water. As there were not enough life-boats for everybody, 1, 500 lives were lost.</p>"},{"location":"english/NCE/NCE3/#11-not-guilty","title":"11 Not Guilty","text":"<p>Customs Officers are quite tolerant these days, but they can still stop you when you are going through the Green Channel and have nothing to declare. Even really honest people are often made to feel guilty. The hardened professional smuggler, on the other hand, is never troubled by such feelings, even if he has five hundred gold watches hidden in his suitcase. When I returned from abroad recently, a particularly officious young Customs Officer clearly regarded me as a smuggler. 'Have you anything to declare?' he asked, looking me in the eye. 'No,' I answered confidently. 'Would you mind unlocking this suitcase please? ' 'Not at all,' I answered. The Officer went through the case with great care. All the things I had packed so carefully were soon in a dreadful mess. I felt sure I would never be able to close the case again. Suddenly, I saw the Officer's face light up. He had spotted a tiny bottle at the bottom of my case and he pounced on it with delight. 'Perfume, eh?' he asked sarcastically. 'You should have declared that. Perfume is not exempt from import duty.  ' 'But it isn't perfume, I said. 'It's hair gel.  ' Then I added with a smile, 'It's a strange mixture I make myself. As I expected, he did not believe me. 'Try it!' I said encouragingly. The Officer unscrewed the cap and put the bottle to his nostrils. He was greeted by an unpleasant smell which convinced him that I was telling the truth. A few minutes later, I was able to hurry away with precious chalk marks on my baggage.</p>"},{"location":"english/NCE/NCE3/#12-life-on-a-desert-island","title":"12 Life on a Desert Island","text":"<p>Most of us have formed an unrealistic picture of life on a desert island. We sometimes imagine a desert island to be a sort of paradise where the sun always shines. Life there is simple and good. Ripe fruit falls from the trees and you never have to work. The other side of the picture is quite the opposite. Life on a desert island is wretched. You either starve to death or live like Robinson Crusoe, waiting for a boat which never comes. Perhaps there is an element of truth in both these pictures, but few of us have had the opportunity to find out. Two men who recently spent five days on a coral island wished they had stayed there longer. They were taking a badly damaged boat from the Virgin Islands to Miami to have it repaired. During the journey, their boat began to sink. They quickly loaded a small rubber dinghy with food, matches, and cans of beer and rowed for a few miles across the Caribbean until they arrived at a tiny coral island. There were hardly any trees on the island and there was no water, but this did not prove to be a problem. The men collected rainwater in the rubber dinghy. As they had brought a spear gun with them, they had plenty to eat. They caught lobster and fish every day, and as one of them put it 'ate like kings'. When a passing tanker rescued them five days later, both men were genuinely sorry that they had to leave.</p>"},{"location":"english/NCE/NCE3/#13-its-only-me","title":"13 It's Only Me","text":"<p>After her husband had gone to work, Mrs. Richards sent her children to school and went upstairs to her bedroom. She was too excited to do any housework that morning, for in the evening she would be going to a fancy-dress party with her husband. She intended to dress up as a ghost and as she had made her costume the night before, she was impatient to try it on. Though the costume consisted only of a sheet, it was very effective. After putting it on, Mrs. Richards went downstairs. She wanted to find out whether it would be comfortable to wear. Just as Mrs. Richards was entering the dining-room, there was a knock on the front door. She knew that it must be the baker. She had told him to come straight in if ever she failed to open the door and to leave the bread on the kitchen table. Not wanting to frighten the poor man, Mrs. Richards quickly hid in the small storeroom under the stairs. She heard the front door open and heavy footsteps in the hall. Suddenly the door of the storeroom was opened and a man entered. Mrs. Richards realized that it must be the man from the Electricity Board who had come to read the metre. She tried to explain the situation, saying 'It's only me', but it was too late. The man let out a cry and jumped back several paces. When Mrs. Richards walked towards him, he fled, slamming the door behind him.</p>"},{"location":"english/NCE/NCE3/#14-a-noble-gangster","title":"14 A Noble Gangster","text":"<p>There was a time when the owners of shops and businesses in Chicago had to pay large sums of money to gangsters in return for 'protection'. If the money was not paid promptly, the gangsters would quickly put a man out of business by destroying his shop. Obtaining 'protection money' is not a modern crime. As long ago as the fourteenth century, an Englishman, Sir John Hawkwood, made the remarkable discovery that people would rather pay large sums of money than have their life work destroyed by gangsters. Six hundred years ago, Sir John Hawkwood arrived in Italy with a band of soldiers and settled near Florence. He soon made a name for himself and came to be known to the Italians as Giovanni Acuto. Whenever the Italian city-states were at war with each other, Hawkwood used to hire his soldiers to princes who were willing to pay the high price he demanded. In times of peace, when business was bad, Hawkwood and his men would march into a city-state, and after burning down a few farms, would offer to go away if protection money was paid to them. Hawkwood made large sums of money in this way. In spite of this, the Italians regarded him as a sort of hero. When he died at the age of eighty, the Florentines gave him a state funeral and had a picture painted which was dedicated to the memory of 'the most valiant soldier and most notable leader, Signor Giovanni Haukodue'.</p>"},{"location":"english/NCE/NCE3/#15-fifty-pence-worth-of-trouble","title":"15 Fifty Pence Worth of Trouble","text":"<p>Children always appreciate small gifts of money. Mum or dad, of course, provides a regular supply of pocket money, but uncles and aunts are always a source of extra income. With some children, small sums go a long way. If fifty pence pieces are not exchanged for sweets, they rattle for months inside money boxes. Only very thrifty children manage to fill up a money box. For most of them, fifty pence is a small price to pay for a nice big bar of chocolate. My nephew, George, has a money box but it is always empty. Very few of the fifty pence pieces and pound coins I have given him have found their way there. I gave him fifty pence yesterday and advised him to save it. Instead, he bought himself fifty pence worth of trouble. On his way to the sweet shop, he dropped his fifty pence and it bounced along the pavement and then disappeared down a drain. George took off his jacket, rolled up his sleeves and pushed his right arm through the drain cover. He could not find his 50 pence piece anywhere, and what is more, he could not get his arm out. A crowd of people gathered round him and a lady rubbed his arm with soap and butter, but George was firmly stuck. The fire brigade was called and two fire fighters freed George using a special type of grease. George was not too upset by his experience because the lady who owns the sweet shop heard about his troubles and rewarded him with a large box of chocolates.</p>"},{"location":"english/NCE/NCE3/#16-mary-had-a-little-lamb","title":"16 Mary Had a Little Lamb","text":"<p>Mary and her husband Dimitri lived in the tiny village of Perachora in southern Greece. One of Mary's prize possessions was a little white lamb which her husband had given her. She kept it tied to a tree in a field during the day and went to fetch it every evening. One evening, however the lamb was missing. The rope had been cut, so it was obvious that the lamb had been stolen. When Dimitri came in from the fields, his wife told him what had happened. Dimitri at once set out to find the thief. He knew it would not prove difficult in such a small village. After telling several of his friends about the theft, Dimitri found out that his neighbour, Aleko, had suddenly acquired a new lamb. Dimitri immediately went to Aleko's house and angrily accused him of stealing the lamb. He told him he had better return it or he would call the police. Aleko denied taking it and led Dimitri into his backyard. It was true that he had just bought a lamb he explained, but his lamb was black. Ashamed of having acted so rashly, Dimitri apologized to Aleko for having accused him. While they were talking it began to rain and Dimitri stayed in Aleko's house until the rain stopped. When he went outside half an hour later, he was astonished to find that the little black lamb was almost white. Its wool, which had been dyed black, had been washed clean by the rain!</p>"},{"location":"english/NCE/NCE3/#17-the-longest-suspension-bridge-in-the-world","title":"17 The Longest Suspension Bridge in the World","text":"<p>Verrazano, an Italian about whom little is known, sailed into New York Harbour in 1524 and named it Angouleme. He described it as 'a very agreeable situation located within two small hills in the midst of which flowed a great river.' Though Verrazano is by no means considered to be a great explorer, his name will probably remain immortal, for on November 21st, 1964, the longest suspension bridge in the world was named after him. The Verrazano Bridge, which was designed by Othmar Ammann, joins Brooklyn to Staten Island. It has a span of 4, 260 feet. The bridge is so long that the shape of the earth had to be taken into account by its designer. Two great towers support four huge cables. The towers are built on immense underwater platforms made of steel and concrete. The platforms extend to a depth of over 100 feet under the sea. These alone took sixteen months to build. Above the surface of the water, the towers rise to a height of nearly 700 feet. They support the cables from which the bridge has been suspended. Each of the four cables contains 26, 108 lengths of wire. It has been estimated that if the bridge were packed with cars, it would still only be carrying a third of its total capacity. However, size and strength are not the only important things about this bridge. Despite its immensity, it is both simple and elegant, fulfilling its designer's dream to creat 'an enormous object drawn as faintly as possible'.</p>"},{"location":"english/NCE/NCE3/#18-electric-currents-in-modern-art","title":"18 Electric Currents in Modern Art","text":"<p>Modern sculpture rarely surprises us any more. The idea that modern art can only be seen in museums is mistaken. Even people who take no interest in art cannot have failed to notice examples of modern sculpture on display in public places. Strange forms stand in gardens, and outside buildings and shops. We have got quite used to them. Some so-called 'modern' pieces have been on display for nearly eighty years. In spite of this, some people--including myself--were surprised by a recent exhibition of modern sculpture. The first thing I saw when I entered the art gallery was a notice which said: 'Do not touch the exhibits, some of them are dangerous!' The objects on display were pieces of moving sculpture. Oddly shaped forms that are suspended from the ceiling and move in response to a gust of wind are quite familiar to everybody. These objects, however, were different. Lined up against the wall, there were long thin wires attached to metal spheres. The spheres had been magnetized and attracted or repelled each other all the time. In the centre of the hall, there were a number of tall structures which contained coloured lights. These lights flickered continuously like traffic lights which have gone mad. Sparks were emitted from small black boxes and red lamps flashed on and off angrily. It was rather like an exhibition of prehistoric electronic equipment. These peculiar forms not only seemed designed to shock people emotionally, but to give them electric shocks as well!</p>"},{"location":"english/NCE/NCE3/#19-a-very-dear-cat","title":"19 A Very Dear Cat","text":"<p>Kidnappers are rarely interested in animals, but they recently took considerable interest in Mrs. Eleanor Ramsay's cat. Mrs. Eleanor Ramsay, a very wealthy old lady, has shared a flat with her cat, Rastus, for a great many years. Rastus leads an orderly life. He usually takes a short walk in the evenings and is always home by seven o'clock. One evening, however he failed to arrive. Mrs. Ramsay got very worried. She looked everywhere for him but could not find him. Three days after Rastus' disappearance, Mrs. Ramsay received an anonymous letter. The writer stated that Rastus was in safe hands and would be returned immediately if Mrs. Ramsay paid a ransom of \uffe11, 000. Mrs.Ramsay was instructed to place the money in a cardboard box and to leave it outside her door. At first, she decided to go to the police, but fearing that she would never see Rastus again--the letter had made that quite clear--she changed her mind. She withdrew \uffe11000 from her bank and followed the kidnapper's instructions. The next morning, the box had disappeared but Mrs.Ramsay was sure that the kidnapper would keep his word. Sure enough, Rastus arrived punctually at seven o'clock that evening. He looked very well, though he was rather thirsty, for he drank half a bottle of milk. The police were astounded when Mrs. Ramsay told them what she had done. She explained that Rastus was very dear to her. Considering the amount she paid, he was dear in more ways than one!</p>"},{"location":"english/NCE/NCE3/#20-pioneer-pilots","title":"20 Pioneer Pilots","text":"<p>In 1908 Lord Northcliffe offered a prize of \uffe11, 000 to the first man who would fly across the English Channel. Over a year passed before the first attempt was made. On July 19th, 1909, in the early morning, Hubert Latham took off from the French coast in his plane the 'Antoinette IV.' He had travelled only seven miles across the Channel when his engine failed and he was forced to land on the sea. The 'Antoinette' floated on the water until Latham was picked up by a ship. Two days later, Louis Bleriot arrived near Calais with a plane called 'No.XI'. Bleriot had been making planes since 1905 and this was his latest model. A week before, he had completed a successful overland flight during which he covered twenty-six miles. Latham, however, did not give up easily. He, too, arrived near Calais on the same day with a new 'Antoinette'. It looked as if there would be an exciting race across the Channel. Both planes were going to take off on July 25th, but Latham failed to get up early enough. After making a short test flight at 4.15 a.m., Bleriot set off half an hour later. His great flight lasted thirty-seven minutes. When he landed near Dover, the first person to greet him was a local policeman. Latham made another attempt a week later and got within half a mile of Dover, but he was unlucky again. His engine failed and he landed on the sea for the second time.</p>"},{"location":"english/NCE/NCE3/#21-daniel-mendoza","title":"21 Daniel Mendoza","text":"<p>Boxing matches were very popular in England two hundred years ago. In those days, boxers fought with bare fists for prize money. Because of this, they were known as 'prizefighters'. However, boxing was very crude, for there were no rules and a prizefighter could be seriously injured or even killed during a match. One of the most colourful figures in boxing history was Daniel Mendoza, who was born in 1764. The use of gloves was not introduced until 1860, when the Marquis of Queensberry drew up the first set of rules. Though he was technically a prizefighter, Mendoza did much to change crude prizefighting into a sport, for he brought science to the game. In his day, Mendoza enjoyed tremendous popularity. He was adored by rich and poor alike. Mendoza rose to fame swiftly after a boxing match when he was only fourteen years old. This attracted the attention of Richard Humphries who was then the most eminent boxer in England. He offered to train Mendoza and his young pupil was quick to learn. In fact, Mendoza soon became so successful that Humphries turned against him. The two men quarrelled bitterly and it was clear that the argument could only be settled by a fight. A match was held at Stilton, where both men fought for an hour. The public bet a great deal of money on Mendoza, but he was defeated. Mendoza met Humphries in the ring on a later occasion and he lost for a second time. It was not until his third match in 1790 that he finally beat Humphries and became Champion of England. Meanwhile, he founded a highly successful Academy and even Lord Byron became one of his pupils. He earned enormous sums of money and was paid as much as \uffe1100 for a single appearance. Despite this, he was so extravagant that he was always in debt. After he was defeated by a boxer called Gentleman Jackson, he was quickly forgotten. He was sent to prison for failing to pay his debts and died in poverty in 1836.</p>"},{"location":"english/NCE/NCE3/#22-by-heart","title":"22 By Heart","text":"<p>Some plays are so successful that they run for years on end. In many ways, this is unfortunate for the poor actors who are required to go on repeating the same lines night after night. One would expect them to know their parts by heart and never have cause to falter. Yet this is not always the case. A famous actor in a highly successful play was once cast in the role of an aristocrat who had been imprisoned in the Bastille for twenty years. In the last act, a gaoler would always come on to the stage with a letter which he would hand to the prisoner. Even though the noble was expected to read the letter at each performance, he always insisted that it should be written out in full. One night, the gaoler decided to play a joke on his colleague to find out if, after so many performances, he had managed to learn the contents of the letter by heart. The curtain went up on the final act of the play and revealed the aristocrat sitting alone behind bars in his dark cell. Just then, the gaoler appeared with the precious letter in his hands. He entered the cell and presented the letter to the aristocrat. But the copy he gave him had not been written out in full as usual. It was simply a blank sheet of paper. The gaoler looked on eagerly, anxious to see if his fellow actor had at last learnt his lines. The noble stared at the blank sheet of paper for a few seconds. Then, squinting his eyes, he said: 'The light is dim. Read the letter to me.' And he promptly handed the sheet of paper to the gaoler. Finding that he could not remember a word of the letter either, the gaoler replied: 'The light is indeed dim, sire.  I must get my glasses.  ' With this, he hurried off the stage. Much to the aristocrat's amusement, the gaoler returned a few moments later with a pair of glasses and the usual copy of the letter which he proceeded to read to the prisoner.</p>"},{"location":"english/NCE/NCE3/#23-one-mans-meat-is-another-mans-poison","title":"23 One Man's Meat is Another Man's Poison","text":"<p>People become quite illogical when they try to decide what can be eaten and what cannot be eaten. If you lived in the Mediterranean, for instance, you would consider octopus a great delicacy. You would not be able to understand why some people find it repulsive. On the other hand, your stomach would turn at the idea of frying potatoes in animal fat-the normally accepted practice in many northern countries. The sad truth is that most of us have been brought up to eat certain foods and we stick to them all our lives. No creature has received more praise and abuse than the common garden snail. Cooked in wine, snails are a great luxury in various parts of the world. There are countless people who, ever since their early years, have learned to associate snails with food. My friend, Robert, lives in a country where snails are despised. As his flat is in a large town, he has no garden of his own. For years he has been asking me to collect snails from my garden and take them to him. The idea never appealed to me very much, but one day, after a heavy shower, I happened to be walking in my garden when I noticed a huge number of snails taking a stroll on some of my prize plants. Acting on a sudden impulse, I collected several dozen, put them in a paper bag, and took them to Robert. Robert was delighted to see me and equally pleased with my little gift. I left the bag in the hall and Robert and I went into the living room where we talked for a couple of hours. I had forgotten all about the snails when Robert suddenly said that I must stay to dinner. Snails would, of course, be the main dish. I did not fancy the idea and I reluctantly followed Robert out of the room. To our dismay, we saw that there were snails everywhere: they had escaped from the paper bag and had taken complete possession of the hall! I have never be able to look at a snail since then.</p>"},{"location":"english/NCE/NCE3/#24-a-skeleton-in-the-cupboard","title":"24 A Skeleton in the Cupboard","text":"<p>We often read in novels how a seemingly respectable person or family has some terrible secret which has been concealed from strangers for years. The English language possesses a vivid saying to describe this sort of situation. The terrible secret is called 'a skeleton in the cupboard'. At some dramatic moment in the story, the terrible secret becomes known and a reputation is ruined. The reader's hair stands on end when he reads in the final pages of the novel that the heroine, a dear old lady who had always been so kind to everybody, had, in her youth, poisoned every one of her five husbands. It is all very well for such things to occur in fiction. To varying degrees, we all have secrets which we do not want even our closest friends to learn, but few of us have skeletons in the cupboard. The only person I know who has a skeleton in the cupboard is George Carlton, and he is very proud of the fact. George studied medicine in his youth. Instead of becoming a doctor, however, he became a successful writer of detective stories. I once spent an uncomfortable weekend which I shall never forget at his house. George showed me to the guestroom which, he said, was rarely used. He told me to unpack my things and then come down to dinner. After I had stacked my shirts and underclothes in two empty drawers, I decided to hang one of the two suits I had brought with me in the cupboard. I opened the cupboard door and then stood in front of it petrified. A skeleton was dangling before my eyes. The sudden movement of the door made it sway slightly and it gave me the impression that it was about to leap out at me. Dropping my suit, I dashed downstairs to tell George. This was worse than 'a terrible secret'; this was a real skeleton! But George was unsympathetic. 'Oh, that,' he said with a smile as if he were talking about an old friend. 'That's Sebastian. You forget that I was a medical student once upon a time.'</p>"},{"location":"english/NCE/NCE3/#25-the-cutty-sark","title":"25 The Cutty Sark","text":"<p>One of the most famous sailing ships of the nineteenth century, the Cutty Sark, can still be seen at Greenwich. She stands on dry land and is visited by thousands of people each year. She serves as an impressive reminder of the great ships of the past. Before they were replaced by steamships, sailing vessels like the Cutty Sark were used to carry tea from China and wool from Australia. The Cutty Sark was one of the fastest sailing ships that has ever been built. The only other ship to match her was the Thermopylae. Both these ships set out from Shanghai on June 18th, 1872 on an exciting race to England. This race, which went on for exactly four months, was the last of its kind. It marked the end of the great tradition of ships with sails and the beginning of a new era. The first of the two ships to reach Java after the race had begun was the Thermopylae, but on the Indian Ocean, the Cutty Sark took the lead. It seemed certain that she would be the first ship home, but during the race she had a lot of bad luck. In August, she was struck by a very heavy storm during which her rudder was torn away. The Cutty Sark rolled from side to side and it became impossible to steer her. A temporary rudder was made on board from spare planks and it was fitted with great difficulty. This greatly reduced the speed of the ship, for there was a danger that if she travelled too quickly, this rudder would be torn away as well. Because of this, the Cutty Sark lost her lead. After crossing the Equator, the captain called in at a port to have a new rudder fitted, but by now the Thermopylae was over five hundred miles ahead. Though the new rudder was fitted at tremendous speed, it was impossible for the Cutty Sark to win. She arrived in England a week after the Thermopylae. Even this was remarkable, considering that she had had so many delays. There is no doubt that if she had not lost her rudder she would have won the race easily.</p>"},{"location":"english/NCE/NCE3/#26-wanted-a-large-biscuit-tin","title":"26 Wanted a Large Biscuit Tin","text":"<p>No one can avoid being influenced by advertisements. Much as we may pride ourselves on our good taste, we are no longer free to choose the things we want, for advertising exerts a subtle influence on us. In their efforts to persuade us to buy this or that product, advertisers have made a close study of human nature and have classified all our little weaknesses. Advertisers discovered years ago that all of us love to get something for nothing. An advertisement which begins with the magic word FREE can rarely go wrong. These days, advertisers not only offer free samples, but free cars, free houses, and free trips round the world as well. They devise hundreds of competitions which will enable us to win huge sums of money. Radio and television have made it possible for advertisers to capture the attention of millions of people in this way. During a radio programme, a company of biscuit manufacturers once asked listeners to bake biscuits and send them to their factory. They offered to pay $10 a pound for the biggest biscuit baked by a listener. The response to this competition was tremendous. Before long, biscuits of all shapes and sizes began arriving at the factory. One lady brought biscuit on a wheelbarrow. It weighed nearly 500 pounds. A little later, a man came along with a biscuit which occupied the whole boot of his car. All the biscuits that were sent were carefully weighed. The largest was 713 pounds. It seemed certain that this would win the prize. But just before the competition closed, a lorry arrived at the factory with a truly colossal biscuit which weighed 2, 400 pounds. It had been baked by a college student who had used over 1, 000 pounds of flour, 800 pounds of sugar, 200 pounds of fat, and 400 pounds of various other ingredients. It was so heavy that a crane had to be used to remove it from the lorry. The manufacturers had to pay more money than they had anticipated, for they bought the biscuit from the student for $24, 000.</p>"},{"location":"english/NCE/NCE3/#27-nothing-to-sell-and-nothing-to-buy","title":"27 Nothing to Sell and Nothing to Buy","text":"<p>It has been said that everyone lives by selling something. In the light of this statement, teachers live by selling knowledge, philosophers by selling wisdom and priests by selling spiritual comfort. Though it may be possible to measure the value of material goods in terms of money, it is extremely difficult to estimate the true value of the services which people perform for us. There are times when we would willingly give everything we possess to save our lives, yet we might grudge paying a surgeon a high fee for offering us precisely this service. The conditions of society are such that skills have to be paid for in the same way that goods are paid for at a shop. Everyone has something to sell. Tramps seem to be the only exception to this general rule. Beggars almost sell themselves as human beings to arouse the pity of passers-by. But real tramps are not beggars. They have nothing to sell and require nothing from others. In seeking independence, they do not sacrifice their human dignity. A tramp may ask you for money, but he will never ask you to feel sorry for him. He has deliberately chosen to lead the life he leads and is fully aware of the consequences. He may never be sure where the next meal is coming from, but he is free from the thousands of anxieties which afflict other people. His few material possessions make it possible for him to move from place to place with ease. By having to sleep in the open, he gets far closer to the world of nature than most of us ever do. He may hunt, beg, or steal occasionally to keep himself alive; he may even, in times of real need, do a little work; but he will never sacrifice his freedom. We often speak of tramps with contempt and put them in the same class as beggars, but how many of us can honestly say that we have not felt a little envious of their simple way of life and their freedom from care?</p>"},{"location":"english/NCE/NCE3/#28-five-pounds-too-dear","title":"28 Five Pounds Too Dear","text":"<p>Small boats loaded with wares sped to the great liner as she was entering the harbour. Before she had anchored, the men from the boats had climbed on board and the decks were soon covered with colourful rugs from Persia, silks from India, copper coffee pots, and beautiful handmade silverware. It was difficult not to be tempted. Many of the tourists on board had begun bargaining with the tradesmen, but I decided not to buy anything until I had disembarked. I had no sooner got off the ship than I was assailed by a man who wanted to sell me a diamond ring. I had no intention of buying one, but I could not conceal the fact that I was impressed by the size of the diamonds. Some of them were as big as marbles. The man went to great lengths to prove that the diamonds were real. As we were walking past a shop, he held a diamond firmly against the window and made a deep impression in the glass. It took me over half an hour to get rid of him. The next man to approach me was selling expensive pens and watches. I examined one of the pens closely. It certainly looked genuine. At the base of the gold cap, the words 'made in the U.S.A.' had been neatly inscribed. The man said that the pen was worth \uffe150, but as a special favour, he would let me have it for \uffe130. I shook my head and held up five fingers indicating that I was willing to pay \uffe15. Gesticulating wildly, the man acted as if he found my offer outrageous, but he eventually reduced the price to 10 pounds. Shrugging my shoulders I began to walk away when, a moment later, he ran after me and thrust the pen into my hands. Though he kept throwing up his arms in despair, he readily accepted the \uffe15 I gave him. I felt especially pleased with my wonderful bargain--until I got back to the ship. No matter how hard I tried, it was impossible to fill this beautiful pen with ink and to this day it has never written a single word!</p>"},{"location":"english/NCE/NCE3/#29-funny-or-not","title":"29 Funny or Not","text":"<p>Whether we find a joke funny or not largely depends on where we have been brought up. The sense of humour is mysteriously bound up with national characteristics. A Frenchman, for instance, might find it hard to laugh at a Russian joke. In the same way, a Russian might fail to see anything amusing in a joke which would make an Englishman laugh to tears. Most funny stories are based on comic situations. In spite of national differences, certain funny situations have a universal appeal. No matter where you live, you would find it difficult not to laugh at, say, Charlie Chaplin's early films. However, a new type of humour, which stems largely from U.S., has recently come into fashion. It is called 'sick humour'. Comedians base their jokes on tragic situations like violent death or serious accidents. Many people find this sort of joke distasteful. The following example of 'sick humour' will enable you to judge for yourself. A man who had broken his right leg was taken to hospital a few weeks before Christmas. From the moment he arrived there, he kept on pestering his doctor to tell him when he would be able to go home. He dreaded having to spend Christmas in hospital. Though the doctor did his best, the patient's recovery was slow. On Christmas day, the man still had his right leg in plaster. He spent a miserable day in bed thinking of all the fun he was missing. The following day, however, the doctor consoled him by telling him that his chances of being able to leave hospital in time for New Year celebrations were good. The man took heart and sure enough, on New Year's Eve he was able to hobble along to a party. To compensate for his unpleasant experiences in hospital, the man drank a little more than was good for him. In the process, he enjoyed himself thoroughly and kept telling everybody how much he hated hospitals. He was still mumbling something about hospitals at the end of the party when he slipped on a piece of ice and broke his left leg.</p>"},{"location":"english/NCE/NCE3/#30-the-death-of-a-ghost","title":"30 The Death of a Ghost","text":"<p>For years, villagers believed that Endley farm was haunted. The farm was owned by two brothers, Joe and Bob Cox. They employed a few farmhands, but no one was willing to work there long. Every time a worker gave up his job, he told the same story. Farm labourers said that they always woke up to find that work had been done overnight. Hay had been cut and cowsheds had been cleaned. A farm worker, who stayed up all night, claimed to have seen a figure cutting corn in the moonlight. In time, it became an accepted fact that the Cox brothers employed a conscientious ghost that did most of their work for them. No one suspected that there might be someone else on the farm who had never been seen. This was indeed the case. A short time ago, villagers were astonished to learn that the ghost of Endley had died. Everyone went to the funeral, for the 'ghost' was none other than Eric Cox, a third brother who was supposed to have died as a young man. After the funeral, Joe and Bob revealed a secret which they had kept for over fifty years. Eric had been the eldest son of the family, very much older than his two brothers. He had been obliged to join the army during the Second World War. As he hated army life, he decided to desert his regiment. When he learnt that he would be sent abroad, he returned to the farm and his father hid him until the end of the war. Fearing the authorities, Eric remained in hiding after the war as well. His father told everybody that Eric had been killed in action. The only other people who knew the secret were Joe and Bob. They did not even tell their wives. When their father died they thought it their duty to keep Eric in hiding. All these years, Eric had lived as a recluse. He used to sleep during the day and work at night, quite unaware of the fact that he had become the ghost of Endley. When he died, however, his brothers found it impossible to keep the secret any longer.</p>"},{"location":"english/NCE/NCE3/#31-a-lovable-eccentric","title":"31 A Lovable Eccentric","text":"<p>True eccentrics never deliberately set out to draw attention to themselves. They disregard social conventions without being conscious that they are doing anything extraordinary. This invariably wins them the love and respect of others, for they add colour to the dull routine of everyday life. Up to the time of his death, Richard Colson was one of the most notable figures in our town. He was a shrewd and wealthy businessman, but most people in the town hardly knew anything about this side of his life. He was known to us all as Dickie and his eccentricity had become legendary long before he died. Dickie disliked snobs intensely. Though he owned a large car, he hardly ever used it, preferring always to go on foot. Even when it was raining heavily, he refused to carry an umbrella. One day, he walked into an expensive shop after having been caught in a particularly heavy shower. He wanted to buy a \uffe1300 watch for his wife, but he was in such a bedraggled condition that an assistant refused to serve him. Dickie left the shop without a word and returned carrying a large cloth bag. As it was extremely heavy, he dumped it on the counter. The assistant asked him to leave, but Dickie paid no attention to him and requested to see the manager. Recognizing who the customer was, the manager was most apologetic and reprimanded the assistant severely. When Dickie was given the watch, he presented the assistant with the cloth bag. It contained \uffe1300 in pennies. He insisted on the assistant's counting the money before he left--30, 000 pennies in all! On another occasion, he invited a number of important critics to see his private collection of modern paintings. This exhibition received a great deal of attention in the press, for though the pictures were supposed to be the work of famous artists, they had in fact been painted by Dickie. It took him four years to stage this elaborate joke simply to prove that critics do not always know what they are talking about.</p>"},{"location":"english/NCE/NCE3/#32-a-lost-ship","title":"32 A Lost Ship","text":"<p>The salvage operation had been a complete failure. The small ship, Elkor, which had been searching the Barents Sea for weeks, was on its way home. A radio message from the mainland had been received by the ship's captain instructing him to give up the search. The captain knew that another attempt would be made later, for the sunken ship he was trying to find had been carrying a precious cargo of gold bullion. Despite the message, the captain of the Elkor decided to try once more. The sea bed was scoured with powerful nets and there was tremendous excitement on board when a chest was raised from the bottom. Though the crew were at first under the impression that the lost ship had been found, the contents of the chest proved them wrong. What they had in fact found was a ship which had been sunk many years before. The chest contained the personal belongings of a seaman, Alan Fielding. There were books, clothing and photographs, together with letters which the seaman had once received from his wife. The captain of the Elkor ordered his men to salvage as much as possible from the wreck. Nothing of value was found, but the numerous items which were brought to the surface proved to be of great interest. From a heavy gun that was raised, the captain realized that the ship must have been a cruiser. In another chest which contained the belongings of a ship's officer, there was an unfinished letter which had been written on March 14th, 1943. The captain learnt from the letter that the name of the lost ship was the Karen. The most valuable find of all was the ship's log book, parts of which it was still possible to read. From this the captain was able to piece together all the information that had come to light. The Karen had been sailing in a convoy to Russia when she was torpedoed by an enemy submarine. This was later confirmed by a naval official at the Ministry of Defence after the Elkor had returned home. All the items that were found were sent to the War Museum.</p>"},{"location":"english/NCE/NCE3/#33-a-day-to-remember","title":"33 A Day to Remember","text":"<p>We have all experienced days when everything goes wrong. A day may begin well enough, but suddenly everything seems to get out of control. What invariably happens is that a great number of things choose to go wrong at precisely the same moment. It is as if a single unimportant event set up a chain of reactions. Let us suppose that you are preparing a meal and keeping an eye on the baby at the same time. The telephone rings and this marks the prelude to an unforeseen series of catastrophes. While you are on the phone, the baby pulls the tablecloth off the table, smashing half your best crockery and cutting himself in the process. You hang up hurriedly and attend to baby, crockery, etc. Meanwhile, the meal gets burnt. As if this were not enough to reduce you to tears, your husband arrives, unexpectedly bringing three guests to dinner. Things can go wrong on a big scale as a number of people recently discovered in Parramatta, a suburb of Sydney. During the rush hour one evening two cars collided and both drivers began to argue. The woman immediately behind the two cars happened to be a learner. She suddenly got into a panic and stopped her car. This made the driver following her brake hard. His wife was sitting beside him holding a large cake. As she was thrown forward, the cake went right through the windscreen and landed on the road. Seeing a cake flying through the air, a lorry driver who was drawing up alongside the car, pulled up all of a sudden. The lorry was loaded with empty beer bottles and hundreds of them slid off the back of the vehicle and on to the road. This led to yet another angry argument. Meanwhile, the traffic piled up behind. It took the police nearly an hour to get the traffic on the move again. In the meantime, the lorry driver had to sweep up hundreds of broken bottles. Only two stray dogs benefited from all this confusion, for they greedily devoured what was left of the cake. It was just one of those days!</p>"},{"location":"english/NCE/NCE3/#34-a-happy-discovery","title":"34 A Happy Discovery","text":"<p>Antique shops exert a peculiar fascination on a great many people. The more expensive kind of antique shop where rare objects are beautifully displayed in glass cases to keep them free from dust is usually a forbidding place. But no one has to muster up courage to enter a less pretentious antique shop. There is always hope that in its labyrinth of musty, dark, disordered rooms a real rarity will be found amongst the piles of assorted junk that litter the floors. No one discovers a rarity by chance. A truly dedicated bargain hunter must have patience, and above all, the ability to recognize the worth of something when he sees it. To do this, he must be at least as knowledgeable as the dealer. Like a scientist bent on making a discovery, he must cherish the hope that one day he will be amply rewarded. My old friend, Frank Halliday, is just such a person. He has often described to me how he picked up a masterpiece for a mere \uffe150. One Saturday morning, Frank visited an antique shop in my neighbourhood. As he had never been there before, he found a great deal to interest him. The morning passed rapidly and Frank was about to leave when he noticed a large packing case lying on the floor. The dealer told him that it had just come in, but that he could not be bothered to open it. Frank begged him to do so and the dealer reluctantly prised it open. The contents were disappointing. Apart from an interesting-looking carved dagger, the box was full of crockery, much of it broken. Frank gently lifted the crockery out of the box and suddenly noticed a miniature painting at the bottom of the packing case. As its composition and line reminded him of an Italian painting he knew well, he decided to buy it. Glancing at it briefly the dealer told him that it was worth \uffe150. Frank could hardly conceal his excitement, for he knew that he had made a real discovery. The tiny painting proved to be an unknown masterpiece by Correggio and was worth hundreds and thousands of pounds.</p>"},{"location":"english/NCE/NCE3/#35-justice-was-done","title":"35 Justice was Done","text":"<p>The word justice is usually associated with courts of law. We might say that justice has been done when a man's innocence or guilt has been proved beyond doubt. Justice is part of the complex machinery of the law. Those who seek it, undertake an arduous journey and can never be sure that they will find it. Judges, however wise or eminent, are human and can make mistakes. There are rare instances when justice almost ceases to be an abstract concept. Reward or punishment are meted out quite independent of human interference. At such times, justice acts like a living force. When we use a phrase like 'it serves him right', we are, in part, admitting that a certain set of circumstances has enabled justice to act of its own accord. When a thief was caught on the premises of a large jewellery store one morning, the shop assistants must have found it impossible to resist the temptation to say 'it serves him right'. The shop was an old converted house with many large, disused fireplaces and tall, narrow chimneys. Towards midday, a girl heard a muffled cry coming from behind one of the walls. As the cry was repeated several times, she ran to tell the manager who promptly rang up the fire brigade. The cry had certainly come from one of the chimneys, but as there were so many of them, the firemen could not be certain which one it was. They located the right chimney by tapping at the walls and listening for the man's cries. After chipping through a wall which was eighteen inches thick, they found that a man had been trapped in the chimney. As it was extremely narrow, the man was unable to move, but the fire fighters were eventually able to free him by cutting a huge hole in the wall. The sorry-looking, blackened figure that emerged, admitted at once that he had tried to break into the shop during the night but had got stuck in the chimney. He had been there for nearly ten hours. Justice had been done even before the man was handed over to the police.</p>"},{"location":"english/NCE/NCE3/#36-a-chance-in-a-million","title":"36 A Chance in a Million","text":"<p>We are less credulous than we used to be. In the nineteenth century, a novelist would bring his story to a conclusion by presenting his readers with a series of coincidences--most of them wildly improbable. Readers happily accepted the fact that an obscure maidservant was really the hero's mother. A long-lost brother, who was presumed dead, was really alive all the time and wickedly plotting to bring about the hero's downfall. And so on. Modern readers would find such naive solutions totally unacceptable. Yet, in real life, circumstances do sometimes conspire to bring about coincidences which anyone but a nineteenth century novelist would find incredible. When I was a boy, my grandfather told me how a German taxi driver, Franz Bussman, found a brother who was thought to have been killed twenty years before. While on a walking tour with his wife, he stopped to talk to a workman. After they had gone on, Mrs. Bussman commented on the workman's close resemblance to her husband and even suggested that he might be his brother. Franz poured scorn on the idea, pointing out that his brother had been killed in action during the war. Though Mrs. Bussman was fully acquainted with this story, she thought that there was a chance in a million that she might be right. A few days later, she sent a boy to the workman to ask him if his name was Hans Bussman. Needless to say, the man's name was Hans Bussman and he really was Franz's long-lost brother. When the brothers were reunited, Hans explained how it was that he was still alive. After having been wounded towards the end of the war, he had been sent to hospital and was separated from his unit. The hospital had been bombed and Hans had made his way back into Western Germany on foot. Meanwhile, his unit was lost and all records of him had been destroyed. Hans returned to his family home, but the house had been bombed and no one in the neighbourhood knew what had become of the inhabitants. Assuming that his family had been killed during an air raid, Hans settled down in a village fifty miles away where he had remained ever since.</p>"},{"location":"english/NCE/NCE3/#37-the-westhaven-express","title":"37 The Westhaven Express","text":"<p>We have learnt to expect that trains will be punctual. After years of conditioning, most of us have developed an unshakable faith in railway timetables. Ships may be delayed by storms; flights may be cancelled because of bad weather; but trains must be on time. Only an exceptionally heavy snow fall might temporarily dislocate railway services. It is all too easy to blame the railway authorities when something does go wrong. The truth is that when mistakes occur, they are more likely to be ours than theirs. After consulting my railway timetable, I noted with satisfaction that there was an express train to Westhaven. It went direct from my local station and the journey lasted a mere hour and seventeen minutes. When I boarded the train, I could not help noticing that a great many local people got on as well. At the time, this did not strike me as odd. I reflected that there must be a great many people besides myself who wished to take advantage of this excellent service. Neither was I surprised when the train stopped at Widley, a tiny station a few miles along the line. Even a mighty express train can be held up by signals. But when the train dawdled at station after station, I began to wonder. It suddenly dawned on me that this express was not roaring down the line at ninety miles an hour, but barely chugging along at thirty. One hour and seventeen minutes passed and we had not even covered half the distance. I asked a passenger if this was the Westhaven Express, but he had not even heard of it. I determined to lodge a complaint as soon as we arrived. Two hours later, I was talking angrily to the station master at Westhaven. When he denied the train's existence, I borrowed his copy of the timetable. There was a note of triumph in my voice when I told him that it was there in black and white. Glancing at it briefly, he told me to look again. A tiny asterisk conducted me to a footnote at the bottom of the page. It said: 'This service has been suspended.'</p>"},{"location":"english/NCE/NCE3/#38-the-first-calendar","title":"38 The First Calendar","text":"<p>Future historians will be in a unique position when they come to record the history of our own times. They will hardly know which facts to select from the great mass of evidence that steadily accumulates. What is more, they will not have to rely solely on the written word. Films, videos, CDs and CD-ROMs are just some of the bewildering amount of information they will have. They will be able, as it were, to see and hear us in action. But the historian attempting to reconstruct the distant past is always faced with a difficult task. He has to deduce what he can from the few scanty clues available. Even seemingly insignificant remains can shed interesting light on the history of early man. Up to now, historians have assumed that calendars came into being with the advent of agriculture, for then man was faced with a real need to understand something about the seasons. Recent scientific evidence seems to indicate that this assumption is incorrect. Historians have long been puzzled by dots, lines and symbols which have been engraved on walls, bones, and the ivory tusks of mammoths. The nomads who made these markings lived by hunting and fishing during the last Ice Age which began about 35, 000 B.C. and ended about 10, 000 B.C. By correlating markings made in various parts of the world, historians have been able to read this difficult code. They have found that it is connected with the passage of days and the phases of the moon. It is, in fact, a primitive type of calendar. It has long been known that the hunting scenes depicted on walls were not simply a form of artistic expression. They had a definite meaning, for they were as near as early man could get to writing. It is possible that there is a definite relation between these paintings and the markings that sometimes accompany them. It seems that man was making a real effort to understand the seasons 20, 000 years earlier than has been supposed.</p>"},{"location":"english/NCE/NCE3/#39-nothing-to-worry-about","title":"39 Nothing to Worry About","text":"<p>The rough road across the plain soon became so bad that we tried to get Bruce to drive back to the village we had come from. Even though the road was littered with boulders and pitted with holes, Bruce was not in the least perturbed. Glancing at his map, he informed us that the next village was a mere twenty miles away. It was not that Bruce always underestimated difficulties. He simply had no sense of danger at all. No matter what the conditions were, he believed that a car should be driven as fast as it could possibly go. As we bumped over the dusty track, we swerved to avoid large boulders. The wheels scooped up stones which hammered ominously under the car. We felt sure that sooner or later a stone would rip a hole in our petrol tank or damage the engine. Because of this, we kept looking back, wondering if we were leaving a trail of oil and petrol behind us. What a relief it was when the boulders suddenly disappeared, giving way to a stretch of plain where the only obstacles were clumps bushes. But there was worse to come. Just ahead of us there was a huge fissure. In response to renewed pleadings, Bruce stopped. Though we all got out to examine the fissure, he remained in the car. We informed him that the fissure extended for fifty yards and was two feet wide and four feet deep. Even this had no effect. Bruce went into a low gear and drove at a terrifying speed, keeping the front wheels astride the crack as he followed its zigzag course. Before we had time to worry about what might happen, we were back on the plain again. Bruce consulted the map once more and told us that the village was now only fifteen miles away. Our next obstacle was a shallow pool of water about half a mile across. Bruce charged at it, but in the middle, the car came to a grinding halt. A yellow light on the dashboard flashed angrily and Bruce cheerfully announced that there was no oil in the engine!</p>"},{"location":"english/NCE/NCE3/#40-whos-who","title":"40 Who's Who","text":"<p>It has never been explained why university students seem to enjoy practical jokes more than anyone else. Students specialize in a particular type of practical joke: the hoax. Inviting the fire brigade to put out a nonexistent fire is a crude form of deception which no self-respecting student would ever indulde in. Students often create amusing situations which are funny to everyone except the victims. When a student recently saw two workmen using a pneumatic drill outside his university, he immediately telephoned the police and informed them that two students dressed up as workmen were tearing up the road with a pneumatic drill. As soon as he had hung up, he went over to the workmen and told them that if a policeman ordered them to go away, they were not to take him seriously. He added that a student had dressed up as a policeman and was playing all sorts of silly jokes on people. Both the police and the workmen were grateful to the student for this piece of advance information. The student hid in an archway nearby where he could watch and hear everything that went on. Sure enough, a policeman arrived on the scene and politely asked the workmen to go away. When he received a very rude reply from one of the workmen, he threatened to remove them by force. The workmen told him to do as he pleased and the policeman telephoned for help. Shortly afterwards, 4 more policemen arrived and remonstrated with the workmen. As the men refused to stop working, the police attempted to seize the pneumatic drill. The workmen struggled fiercely and one of them lost his temper. He threatened to call the police. At this, the police pointed out ironically that this would hardly be necessary as the men were already under arrest. Pretending to speak seriously, one of the workmen asked if he might make a telephone call before being taken to the station. Permission was granted and a policeman accompanied him to a pay phone. Only when he saw that the man was actually telephoning the police did he realize that they had all been the victims of a hoax.</p>"},{"location":"english/NCE/NCE3/#41-illusions-of-pastoral-peace","title":"41 Illusions of Pastoral Peace","text":"<p>The quiet life of the country has never appealed to me. City born and city bred, I have always regarded the country as something you look at through a train window, or something you occasionally visit during the weekend. Most of my friends live in the city, yet they always go into raptures at the mere mention of the country. Though they extol the virtues of the peaceful life, only one of them has ever gone to live in the country and he was back in town within six months. Even he still lives under the illusion that country life is somehow superior to town life. He is forever talking about the friendly people, the clean atmosphere, the closeness to nature and the gentle pace of living. Nothing can be compared, he maintains, with the first cockcrow, the twittering of birds at dawn, the sight of the rising sun glinting on the trees and pastures. This idyllic pastoral scene is only part of the picture. My friend fails to mention the long and friendless winter evenings in front of the TV--virtually the only form of entertainment. He says nothing about the poor selection of goods in the shops, or about those unfortunate people who have to travel from the country to the city every day to get to work. Why people are prepared to tolerate a four-hour journey each day for the dubious privilege of living in the country is beyond me. They could be saved so much misery and expense if they chose to live in the city where they rightly belong. If you can do without the few pastoral pleasures of the country, you will find the city can provide you with the best that life can offer. You never have to travel miles to see your friends. They invariably live nearby and are always available for an informal chat or an evening's entertainment. Some of my acquaintances in the country come up to town once or twice a year to visit the theatre as a special treat. For them this is a major operation which involves considerable planning. As the play draws to its close, they wonder whether they will ever catch that last train home. The city dweller never experiences anxieties of this sort. The latest exhibitions, films, or plays are only a short bus ride away. Shopping, too, is always a pleasure. There is so much variety that you never have to make do with second best. Country people run wild when they go shopping in the city and stagger home loaded with as many of the exotic items as they can carry. Nor is the city without its moments of beauty. There is something comforting about the warm glow shed by advertisements on cold wet winter nights. Few things could be more impressive than the peace that descends on deserted city streets at weekends when the thousands that travel to work every day are tucked away in their homes in the country. It has always been a mystery to me why city dwellers, who appreciate all these things, obstinately pretend that they would prefer to live in the country.</p>"},{"location":"english/NCE/NCE3/#42-modern-cavemen","title":"42 Modern Cavemen","text":"<p>Cave exploration, or pot-holing, as it has come to be known, is a relatively new sport. Perhaps it is the desire for solitude or the chance of making an unexpected discovery that lures people down to the depths of the earth. It is impossible to give a satisfactory explanation for a pot-holer's motives. For him, caves have the same peculiar fascination which high mountains have for the climber. They arouse instincts which can only be dimly understood. Exploring really deep caves is not a task for the Sunday afternoon rambler. Such undertakings require the precise planning and foresight of military operations. It can take as long as eight days to rig up rope ladders and to establish supply bases before a descent can be made into a very deep cave. Precautions of this sort are necessary, for it is impossible to foretell the exact nature of the difficulties which will confront the pot-holer. The deepest known cave in the world is the Gouffre Berger near Grenoble. It extends to a depth of 3, 723 feet. This immense chasm has been formed by an underground stream which has tunnelled a course through a flaw in the rocks. The entrance to the cave is on a plateau in the Dauphine Alps. As it is only six feet across, it is barely noticeable. The cave might never have been discovered had not the entrance been spotted by the distinguished French pot-holer, Berger. Since its discovery, it has become a sort of pot-holers' Everest. Though a number of descents have been made, much of it still remains to be explored. A team of pot-holers recently went down the Gouffre Berger. After entering the narrow gap on the plateau, they climbed down the steep sides of the cave until they came to a narrow corridor. They had to edge their way along this, sometimes wading across shallow streams, or swimming across deep pools. Suddenly they came to a waterfall which dropped into an underground lake at the bottom of the cave. They plunged into the lake, and after loading their gear on an inflatable rubber dinghy, let the current carry them to the other side. To protect themselves from the icy water, they had to wear special rubber suits. At the far end of the lake, they came to huge piles of rubble which had been washed up by the water. In this part of the cave, they could hear an insistent booming sound which they found was caused by a small waterspout shooting down into a pool from the roof of the cave. Squeezing through a cleft in the rocks, the pot-holers arrived at an enormous cavern, the size of a huge concert hall. After switching on powerful arc lights, they saw great stalagmites--some of them over forty feet high--rising up like tree-trunks to meet the stalactites suspended from the roof. Round about, piles of limestone glistened in all the colours of the rainbow. In the eerie silence of the cavern, the only sound that could be heard was made by water which dripped continuously from the high dome above them.</p>"},{"location":"english/NCE/NCE3/#43-fully-insured","title":"43 Fully Insured","text":"<p>Insurance companies are normally willing to insure anything. Insuring public or private property is a standard practice in most countries in the world. If, however, you were holding an open air garden party or a fete it would be equally possible to insure yourself in the event of bad weather. Needless to say, the bigger the risk an insurance company takes, the higher the premium you will have to pay. It is not uncommon to hear that a shipping company has made a claim for the cost of salvaging a sunken ship. But the claim made by a local authority to recover the cost of salvaging a sunken pie dish must surely be unique. Admittedly it was an unusual pie dish, for it was eighteen feet long and six feet wide. It had been purchased by a local authority so that an enormous pie could be baked for an annual fair. The pie committee decided that the best way to transport the dish would be by canal so they insured it for the trip. Shortly after it was launched, the pie committee went to a local inn to celebrate. At the same time, a number of teenagers climbed on to the dish and held a little party of their own. Dancing proved to be more than the dish could bear, for during the party it capsized and sank in seven feet of water. The pie committee telephoned a local garage owner who arrived in a recovery truck to salvage the pie dish. Shivering in their wet clothes, the teenagers looked on while three men dived repeatedly into the water to locate the dish. They had little difficulty in finding it, but hauling it out of the water proved to be a serious problem. The sides of the dish were so smooth that it was almost impossible to attach hawsers and chains to the rim without damaging it. Eventually chains were fixed to one end of the dish and a powerful winch was put into operation. The dish rose to the surface and was gently drawn towards the canal bank. For one agonizing moment, the dish was perched precariously on the bank of the canal, but it suddenly overbalanced and slid back into the water. The men were now obliged to try once more. This time they fixed heavy metal clamps to both sides of the dish so that they could fasten the chains. The dish now had to be lifted vertically because one edge was resting against the side of the canal. The winch was again put into operation and one of the men started up the truck. Several minutes later, the dish was successfully hauled above the surface of the water. Water streamed in torrents over its sides with such force that it set up a huge wave in the canal. There was a danger that the wave would rebound off the other side of the bank and send the dish plunging into the water again. By working at tremendous speed, the men managed to get the dish on to dry land before the wave returned.</p>"},{"location":"english/NCE/NCE3/#44-speed-and-comfort","title":"44 Speed and Comfort","text":"<p>People travelling long distances frequently have to decide whether they would prefer to go by land, sea, or air. Hardly anyone can positively enjoy sitting in a train for more than a few hours. Train compartments soon get cramped and stuffy. It is almost impossible to take your mind off the journey. Reading is only a partial solution, for the monotonous rhythm of the wheels clicking on the rails soon lull you to sleep. During the day, sleep comes in snatches. At night, when you really wish to go to sleep, you rarely manage to do so. If you are lucky enough to get a sleeper, you spend half the night staring at the small blue light in the ceiling, or fumbling to find your ticket for inspection. Inevitably you arrive at your destination almost exhausted. Long car journeys are even less pleasant, for it is quite impossible even to read. On motorways you can, at least, travel fairly safely at high speeds, but more often than not, the greater part of the journey is spent on roads with few service stations and too much traffic. By comparison, ferry trips or cruises offer a great variety of civilized comforts. You can stretch your legs on the spacious decks, play games, meet interesting people and enjoy good food--always assuming, of course, that the sea is calm. If it is not, and you are likely to get seasick, no form of transport could be worse. Even if you travel in ideal weather, sea journeys take a long time. Relatively few people are prepared to sacrifice holiday time for the pleasure of travelling by sea. Aeroplanes have the reputation of being dangerous and even hardened travellers are intimidated by them. They also have the disadvantage of being an expensive form of transport. But nothing can match them for speed and comfort. Travelling at a height of 30, 000 feet, far above the clouds, and at over 500 miles an hour is an exhilarating experience. You do not have to devise ways of taking your mind off the journey, for an aeroplane gets you to your destination rapidly. For a few hours, you settle back in a deep armchair to enjoy the flight. The real escapist can watch a film and sip champagne on some services. But even when such refinements are not available, there is plenty to keep you occupied. An aeroplane offers you an unusual and breathtaking view of the world. You soar effortlessly over high mountains and deep valleys. You really see the shape of the land. If the landscape is hidden from view, you can enjoy the extraordinary sight of unbroken cloud plains that stretch out for miles before you, while the sun shines brilliantly in a clear sky. The journey is so smooth that there is nothing to prevent you from reading or sleeping. However you decide to spend your time, one thing is certain: you will arrive at your destination fresh and uncrumpled. You will not have to spend the next few days recovering from a long and arduous journey.</p>"},{"location":"english/NCE/NCE3/#45-the-power-of-the-press","title":"45 The Power of the Press","text":"<p>In democratic countries any efforts to restrict the freedom of the press are rightly condemned. However, this freedom can easily be abused. Stories about people often attract far more public attention than political events. Though we may enjoy reading about the lives of others, it is extremely doubtful whether we would equally enjoy reading about ourselves. Acting on the contention that facts are sacred, reporters can cause untold suffering to individuals by publishing details about their private lives. Newspapers exert such tremendous influence that they can not only bring about major changes to the lives of ordinary people but can even overthrow a government. The story of a poor family that acquired fame and fortune overnight, dramatically illustrates the power of the press. The family lived in Aberdeen, a small town of 23, 000 inhabitants in South Dakota. As the parents had five children, life was a perpetual struggle against poverty. They were expecting their sixth child and were faced with even more pressing economic problems. If they had only had one more child, the fact would have passed unnoticed. They would have continued to struggle against economic odds and would have lived in obscurity. But they suddenly became the parents of quintuplets, four girls and a boy, an event which radically changed their lives. The day after the birth of the five children, an aeroplane arrived in Aberdeen bringing sixty reporters and photographers. The rise to fame was swift. Television cameras and newspapers carried the news to everyone in the country. Newspapers and magazines offered the family huge sums for the exclusive rights to publish stories and photographs. Gifts poured in not only from unknown people, but from baby food and soap manufacturers who wished to advertise their products. The old farmhouse the family lived in was to be replaced by a new $500, 000 home. Reporters kept pressing for interviews so lawyers had to be employed to act as spokesmen for the family at press conferences. While the five babies were still quietly sleeping in oxygen tents in a hospital nursery, their parents were paying the price for fame. It would never again be possible for them to lead normal lives. They had become the victims of commercialization, for their names had acquired a market value. Instead of being five new family members, these children had immediately become a commodity.</p>"},{"location":"english/NCE/NCE3/#46-do-it-yourself","title":"46 Do It Yourself","text":"<p>So great is our passion for doing things for ourselves, that we are becoming increasingly less dependent on specialized labour. No one can plead ignorance of a subject any longer, for there are countless do-it-yourself publications. Armed with the right tools and materials, newlyweds gaily embark on the task of decorating their own homes. Men, particularly, spend hours of their leisure time installing their own fireplaces, laying out their own gardens; building garages and making furniture. Some really keen enthusiasts go so far as to build their own computers. Shops cater for the do-it-yourself craze not only by running special advisory services for novices, but by offering consumers bits and pieces which they can assemble at home. Such things provide an excellent outlet for pent up creative energy, but unfortunately not all of us are born handymen. Some wives tend to believe that their husbands are infinitely resourceful and can fix anything. Even men who can hardly drive a nail in straight are supposed to be born electricians, carpenters, plumbers and mechanics. When lights fuse, furniture gets rickety, pipes get clogged, or vacuum cleaners fail to operate, some women assume that their husbands will somehow put things right. The worst thing about the do-it-yourself game is that sometimes even men live under the delusion that they can do anything, even when they have repeatedly been proved wrong. It is a question of pride as much as anything else. Last spring my wife suggested that I call in a man to look at our lawn mower. It had broken down the previous summer, and though I promised to repair it, I had never got round to it. I would not hear of the suggestion and said that I would fix it myself. One Saturday afternoon, I hauled the machine into the garden and had a close look at it. As far as I could see, it needed only a minor adjustment: a turn of a screw here, a little tightening up there, a drop of oil and it would be as good as new. Inevitably the repair job was not quite so simple. The mower firmly refused to mow, so I decided to dismantle it. The garden was soon littered with chunks of metal which had once made up a lawn mower. But I was extremely pleased with myself. I had traced the cause of the trouble. One of the links in the chain that drives the wheels had snapped. After buying a new chain I was faced with the insurmountable task of putting the confusing jigsaw puzzle together again. I was not surprised to find that the machine still refused to work after I had reassembled it, for the simple reason that I was left with several curiously shaped bits of metal which did not seem to fit anywhere. I gave up in despair. The weeks passed and the grass grew. When my wife nagged me to do something about it, I told her that either I would have to buy a new mower or let the grass grow. Needless to say our house is now surrounded by a jungle. Buried somewhere in deep grass there is a rusting lawn mower which I have promised to repair one day.</p>"},{"location":"english/NCE/NCE3/#47-too-high-a-price","title":"47 Too High a Price","text":"<p>Pollution is the price we pay for an overpopulated, overindustrialized planet. When you come to think about it, there are only four ways you can deal with rubbish: dump it, burn it, turn it into something you can use again, attempt to produce less of it. We keep trying all four methods, but sheer volume of rubbish we produce worldwide threatens to overwhelm us. Rubbish, however, is only part of the problem of polluting our planet. The need to produce ever increasing quantities of cheap food leads to a different kind of pollution. Industriallized farming metheods produce cheap meat products: beef, pork and chicken. The use of pesticides and fertilizers produces cheap grain and vegetables. The price we pay for cheap food may be already too high: Mad Cow Disease (BSE) in cattle, salmonella in chicken and eggs, and listeria in dairy products. And if you think you'll abandon meat and become a vegetarian, you have the choice of very expensive organically-grown vegetables or a steady diet of pesticides every time you think you're eating fresh salads and vegetables, or just having an innocent glass of water! However, there is an even more insidious kind of pollution that particularly affects urban area and invades our daily lives, and that is noise. Burglar alarms going off at any time of the day or night serve only to annoy passers-by and actually assist burglars to burgle. Car alarms constantly scream at us in the street and are a source of profound irritation. A recent survey of the effects of noise revealed (surprisingly?) that dogs barking incessantly in the night rated the highest form of noise pollution on a scale ranging from 1 to 7. The survey revealed a large number of sources of noise that we really dislike. Lawn mowers whining on a summer's day, late-night parties in apartment blocks, noisy neighbours, vehicles of all kinds, especially large container trucks thundering through quiet villages, planes and helicopters flying overhead, large radios carried round in public places and played at maximum volume. New technology has also made its own contribution to noise. A lot of people object to mobile phones, especially when they are used in public places like restaurant or on public transport. Loud conversations on mobile phones invade our thoughts or interrupt the pleasure of meeting friends for a quiet chat. The noise pollution survey revealed a rather surprising and possibly amusing old-fashioned source of noise. It turned out to be snoring! Men were found to be the worst offenders. It was revealed that 20% of men in their mid-thirties snore. This figure rises to a staggering 60% of men in their sixties. Against these figures, it was found that only 5% of women snore regularly, while the rest are constantly woken or kept awake by their trumpeting partners. Whatever the source of noise, one thing is certain: silence, it seems, has become a golden memory.</p>"},{"location":"english/NCE/NCE3/#48-the-silent-village","title":"48 The Silent Village","text":"<p>In this much-travelled world, there are still thousands of places which are inaccessible to tourists. We always assume that villagers in remote places are friendly and hospitable. But people who are cut off not only from foreign tourists, but even from their own countrymen can be hostile to travellers. Visits to really remote villages are seldom enjoyable--as my wife and I discovered during a tour through the Balkans. We had spent several days in a small town and visited a number of old churches in the vicinity. These attracted many visitors, for they were not only of great architectural interest, but contained a large number of beautifully preserved frescoes as well. On the day before our departure, several bus loads of tourists descended on the town. This was more than we could bear, so we decided to spend our last day exploring the countryside. Taking a path which led out of the town, we crossed a few fields until we came to a dense wood. We expected the path to end abruptly, but we found that it traced its way through the trees. We tramped through the wood for over two hours until we arrived at a deep stream. We could see that the path continued on the other side, but we had no idea how we could get across the stream. Suddenly my wife spotted a boat moored to the bank. In it there was a boatman fast asleep. We gently woke him up and asked him to ferry us to the other side. Though he was reluctant to do so at first, we eventually persuaded him to take us. The path led to a tiny village perched on the steep sides of a mountain. The place consisted of a straggling unmade road which was lined on either side by small houses. Even under a clear blue sky, the village looked forbidding, as all the houses were built of grey mud bricks. The village seemed deserted, the only sign of life being an ugly-looking black goat on a short length of rope tied to a tree in a field nearby. Sitting down on a dilapidated wooden fence near the field, we opened a couple of tins of sardines and had a picnic lunch. All at once, I noticed that my wife seemed to be filled with alarm. Looking up I saw that we were surrounded by children in rags who were looking at us silently as we ate. We offered them food and spoke to them kindly, but they remained motionless. I concluded that they were simply shy of strangers. When we later walked down the main street of the village, we were followed by a silent procession of children. The village which had seemed deserted, immediately came to life. Faces appeared at windows. Men in shirt sleeves stood outside their houses and glared at us. Old women in black shawls peered at us from doorways. The most frightening thing of all was that not a sound could be heard. There was no doubt that we were unwelcome visitors. We needed no further warning. Turning back down the main street, we quickened our pace and made our way rapidly towards the stream where we hoped the boatman was waiting.</p>"},{"location":"english/NCE/NCE3/#49-the-ideal-servant","title":"49 The Ideal Servant","text":"<p>It is a good thing my aunt Harriet died years ago. If she were alive today she would not be able to air her views on her favourite topic of conversation: domestic servants. Aunt Harriet lived in that leisurely age when servants were employed to do housework. She had a huge, rambling country house called 'The Gables'. She was sentimentally attached to this house, for even though it was far too big for her needs, she persisted in living there long after her husband's death. Before she grew old, aunt Harriet used to entertain lavishly. I often visited The Gables when I was a boy. No matter how many guests were present, the great house was always immaculate. The parquet floors shone like mirrors; highly polished silver was displayed in gleaming glass cabinets; even my uncle's huge collection of books was kept miraculously free from dust. Aunt Harriet presided over an invisible army of servants that continuously scrubbed, cleaned, and polished. She always referred to them as 'the shifting population', for they came and went with such frequency that I never even got a chance to learn their names. Though my aunt pursued what was, in those days an enlightened policy, in that she never allowed her domestic staff to work more than eight hours a day, she was extremely difficult to please. While she always criticized the fickleness of human nature, she carried on an unrelenting search for the ideal servant to the end of her days, even after she had been sadly disillusioned by Bessie. Bessie worked for aunt Harriet for three years. During that time she so gained my aunt's confidence, that she was put in charge of the domestic staff. Aunt Harriet could not find words to praise Bessie's industriousness and efficiency. In addition to all her other qualifications, Bessie was an expert cook. She acted the role of the perfect servant for three years before Aunt Harriet discovered her 'little weakness'. After being absent from The Gables for a week, my aunt unexpectedly returned one afternoon with a party of guests and instructed Bessie to prepare dinner. Not only was the meal well below the usual standard, but Bessie seemed unable to walk steadily. She bumped into the furniture and kept mumbling about the guests. When she came in with the last course--a huge pudding--she tripped on the carpet and the pudding went flying through the air, narrowly missed my aunt, and crashed on the dining table with considerable force. Though this caused great mirth among the guests, Aunt Harriet was horrified. She reluctantly came to the conclusion that Bessie was drunk. The guests had, of course, realized this from the moment Bessie opened the door for them and, long before the final catastrophe, had had a difficult time trying to conceal their amusement. The poor girl was dismissed instantly. After her departure, Aunt Harriet discovered that there were piles of empty wine bottles of all shapes and sizes neatly stacked in what had once been Bessie's wardrobe. They had mysteriously found their way there from the wine cellar!</p>"},{"location":"english/NCE/NCE3/#50-new-year-resolutions","title":"50 New Year Resolutions","text":"<p>The New Year is a time for resolutions. Mentally, at least, most of us could compile formidable lists of 'dos' and 'don'ts'. The same old favourites recur year in year out with monotonous regularity. We resolve to get up earlier each morning, eat less, find more time to play with the children, do a thousand and one jobs about the house, be nice to people we don't like, drive carefully, and take the dog for a walk every day. Past experience has taught us that certain accomplishments are beyond attainment. If we remain inveterate smokers, it is only because we have so often experienced the frustration that results from failure. Most of us fail in our efforts at sel-improvement because our schemes are too ambitious and we never have time to carry them out. We also make the fundamental error of announcing our resolutions to everybody so that we look even more foolish when we slip back into our bad old ways. Aware of these pitfalls, this year I attempted to keep my resolutions to myself. I limited myself to two modest ambitions: to do physical exercises every morning and to read more of an evening. An all-night party on New Year's Eve provided me with a good excuse for not carrying out either of these new resolutions on the first day of the year, but on the second, I applied myself assiduously to the task. The daily exercises lasted only eleven minutes and I proposed to do them early in the morning before anyone had got up. The self-discipline required to drag myself out of bed 11 minutes earlier than usual was considerable. Nevertheless, I managed to creep down into the living room for two days before anyone found me out. After jumping about on the carpet and twisting the human frame into uncomfortable positions, I sat down at the breakfast table in an exhausted condition. It was this that betrayed me. The next morning the whole family trooped in to watch the performance. That was really unsettling but I fended off the taunts and jibes of the family good-humouredly and soon everybody got used to the idea. However, my enthusiasm waned. The time I spent at exercises gradually diminished. Little by little the eleven minutes fell to zero. By January 10th, I was back to where I had started from. I argued that if I spent less time exhausting myself at exercises in the morning, I would keep my mind fresh for reading when I got home from work. Resisting the hypnotizing effect of television, I sat in my room for a few evenings with my eyes glued to a book. One night, however, feeling cold and lonely, I went downstairs and sat in front of the television pretending to read. That proved to be my undoing, for I soon got back to my old bad habit of dozing off in front of the screen. I still haven't given up my resolution to do more reading. In fact, I have just bought a book entitled How to Read a Thousand Words a Minute. Perhaps it will solve my problem, but I just haven't had time to read it!</p>"},{"location":"english/NCE/NCE3/#51-predicting-the-future","title":"51 Predicting the Future","text":"<p>Predicting the future is notoriously difficult. Who could have imagined, in the mid 1970s, for example, that by the end of the 20th century, computers would be as common in people's homes as TV sets? In the 1970s, computers were common enough, but only in big business, government departments and large organizations. These were the so-called mainframe machines. Mainframe computers were very large indeed often occupying whole air-conditioned rooms, employing full-time technicians and run on specially-written software. Though these large machines still exist, many of their functions have been taken over by small powerful personal computers, commonly known as PCs. In 1975, a primitive machine called the Altair, was launched in the USA. It can properly be described as the first 'home computer' and it pointed the way to the future. This was followed, at the end of the 1970s, by a machine called an Apple. In the early 1980s, the computer giant, IBM produced the world's first Personal Computer. This ran on an 'operating system' called DOS, produced by a then small company named Microsoft. The IBM Personal Computer was widely copied. From those humble beginnings, we have seen the development of the user-friendly home computers and multimedia machines which are in common use today. Considering how recent these developments are, it is even more remarkable that as long ago as the 1960s, an Englishman, Leon Bagrit, was able to predict some of the uses of computers which we know today. Bagrit dismissed the idea that computers would learn to 'think' for themselves and would 'rule the world', which people liked to believe in those days. Bagrit foresaw a time when computers would be small enough to hold in the hand, when they would be capable of providing information about traffic jams and suggesting alterative routes, when they would be used in hospitals to help doctors to diagnose illnesses, when they would relieve office workers and accountants of dull, repetitive clerical work. All these computer uses have become commonplace. Of course, Leon Bagrit couldn't possibly have foreseen the development of the Internet, the worldwide system that enables us to communicate instantly with anyone in any part of the world by using computers linked to telephone networks. Nor could he have foreseen how we could use the Internet to obtain information on every known subject, so we can read it on a screen in our homes and even print it as well if we want to. Computers have become smaller and smaller, more and more powerful and cheaper and cheaper. This is what makes Leon Bagrit's predictions particularly remarkable. If he, or someone like him, were alive today, he might be able to tell us what to expect in the next fifty years.</p>"},{"location":"english/NCE/NCE3/#52-mud-is-mud","title":"52 Mud is Mud","text":"<p>My cousin, Harry, keeps a large curiously-shaped bottle on permanent display in his study. Despite the fact that the bottle is tinted a delicate shade of green, an observant visitor would soon notice that it is filled with what looks like a thick, greyish substance. If you were to ask Harry what was in the bottle, he would tell you that it contained perfumed mud. If you expressed doubt or surprise, he would immediately invite you to smell it and then to rub some into your skin. The brief experiment would dispel any further doubts she might have. The bottle really does contain perfumed mud. How Harry came into the possession of this outlandish stuff makes an interesting story which he is fond of relating. Furthermore, the acquisition of this bottle cured him of a bad habit he had been developing for years. Harry used to consider it a great joke to go into expensive cosmetic shops and make outrageous requests for goods that do not exist. He would invent fanciful names on the spot. On entering a shop, he would ask for a new perfume called 'Scented Shadow' or for 'insoluble bath cubes'. If a shop assistant told him she had not heard of it, he would pretend to be considerably put out. He loved to be told that one of his imaginary products was temporarily out of stock and he would faithfully promise to call again at some future date, but of course he never did. How Harry managed to keep a straight face during these performances is quite beyond me. Harry does not need to be prompted to explain how he bought his precious bottle of mud. One day, he went to an exclusive shop in London and asked for 'Myrolite'. The shop assistant looked puzzled and Harry repeated the word, slowly stressing each syllable. When the woman shook her head in bewilderment, Harry went on to explain that 'myrolite' was a hard, amber-like substance which could be used to remove freckles. This explanation evidently conveyed something to the woman who searched shelf after shelf. She produced all sorts of weird concoctions, but none of them met with Harry's requirements. When Harry put on his act of being mildly annoyed, the assistant promised to order some for him. Intoxicated by his success, Harry then asked for perfumed mud. He expected the assistant to look at him in blank astonishment. However, it was his turn to be surprised, for the woman's eyes immediately lit up and she fetched several bottles which she placed on the counter for Harry to inspect. For once, Harry had to admit defeat. He picked up what seemed to be the smallest bottle and discreetly asked the price. He was glad to get away with a mere twenty pounds and he beat a hasty retreat, clutching the precious bottle under his arm. From then on, Harry decided that this little game he had invented might prove to be expensive. The curious bottle which now adorns the bookcase in his study was his first and last purchase of rare cosmetics.</p>"},{"location":"english/NCE/NCE3/#53-in-the-public-interest","title":"53 In the Public Interest","text":"<p>The Scandinavian countries are much admired all over the world for their enlightened social policies. Sweden has evolved an excellent system for protecting the individual citizen from high-handed or incompetent public officers. The system has worked so well, that it has been adopted in other countries too. The Swedes were the first to recognize that public officials like civil servants, police officers, health inspectors or tax-collectors can make mistakes or act over-zealously in the belief that they are serving the public. As long ago as 1809, the Swedish Parliament introduced a scheme to safeguard the interest of the individual. A parliamentary committee representing all political parties appoints a person who is suitably qualified to investigate private grievances against the State. The official title of the person is 'Justiteombudsman', but the Swedes commonly refer to him as the 'J.O.' or 'Ombudsman'. The Ombudsman is not subject to political pressure. He investigates complaints large and small that come to him from all levels of society. As complaints must be made in writing, the Ombudsman receives an average of 1, 200 letters a year. He has eight lawyer assistants to help him and he examines every single letter in detail. There is nothing secretive about the Ombudsman's work, for his correspondence is open to public inspection. If a citizen's complaint is justified the Ombudsman will act on his behalf. The action he takes varies according to the nature of the complaint. He may gently reprimand an official or even suggest to parliament that a law be altered. The following case is a typical example of the Ombudsman's work. A foreigner living in a Swedish village wrote to the Ombudsman complaining that he had been ill-treated by the police, simply because he was a foreigner. The Ombudsman immediately wrote to the Chief of Police in the district asking him to send a record of the case. There was nothing in the record to show that the foreigner's complaint was justified and the Chief of Police strongly denied the accusation. It was impossible for the Ombudsman to take action, but when he received a similar complaint from another foreigner in the same village, he immediately sent one of his lawyers to investigate the matter. The lawyer ascertained that a policeman had indeed dealt roughly with foreigners on several occasions. The fact that the policeman was prejudiced against foreigners could not be recorded in the official files. It was only possible for the Ombudsman to find this out by sending one of his representatives to check the facts. The policeman in question was severely reprimanded and was informed that if any further complaints were lodged against him, he would be prosecuted. The Ombudsman's prompt action at once put an end to an unpleasant practice which might have gone unnoticed.</p>"},{"location":"english/NCE/NCE3/#54-instinct-or-cleverness","title":"54 Instinct or Cleverness","text":"<p>We have been brought up to fear insects. We regard them as unnecessary creatures that do more harm than good. We continually wage war on them, for they contaminate our food, carry diseases, or devour our crops. They sting or bite without provocation; they fly uninvited into our rooms on summer nights, or beat against our lighted windows. We live in dread not only of unpleasant insects like spiders or wasps, but of quite harmless ones like moths. Reading about them increases our understanding without dispelling our fears. Knowing that the industrious ant lives in a highly organized society does nothing to prevent us from being filled with revulsion when we find hordes of them crawling over a carefully prepared picnic lunch. No matter how much we like honey, or how much we have read about the uncanny sense of direction which bees possess, we have a horror of being stung. Most of our fears are unreasonable, but they are impossible to erase. At the same time, however, insects are strangely fascinating. We enjoy reading about them, especially when we find that, like the praying mantis, they lead perfectly horrible lives. We enjoy staring at them, entranced as they go about their business, unaware (we hope) of our presence. Who has not stood in awe at the sight of a spider pouncing on a fly, or a column of ants triumphantly bearing home an enormous dead beetle? Last summer I spent days in the garden watching thousands of ants crawling up the trunk of my prize peach tree. The tree has grown against a warm wall on a sheltered side of the house. I am especially proud of it, not only because it has survived several severe winters, but because it occasionally produces luscious peaches. During the summer, I noticed that the leaves of the tree were beginning to wither. Clusters of tiny insects called aphides were to be found on the underside of the leaves. They were visited by a large colony of ants which obtained a sort of honey from them. I immediately embarked on an experiment which even though it failed to get rid of the ants kept me fascinated for twenty-four hours. I bound the base of the tree with sticky tape, making it impossible for the ants to reach the aphides. The tape was so sticky that they did not dare to cross it. For a long time, I watched them scurrying around the base of the tree in bewilderment. I even went out at midnight with a torch and noted with satisfaction (and surprise) that the ants were still swarming around the sticky tape without being able to do anything about it. I got up early next morning hoping to find that the ants had given up in despair. Instead, I saw that they had discovered a new route. They were climbing up the wall of the house and then on to the leaves of the tree. I realized sadly that I had been completely defeated by their ingenuity. The ants had been quick to find an answer to my thoroughly unscientific methods!</p>"},{"location":"english/NCE/NCE3/#55-from-the-earth-greetings","title":"55 From the Earth Greetings","text":"<p>Recent developments in astronomy have made it possible to detect planets in our own Milky Way and in other galaxies. This is a major achievement because, in relative terms, planets are very small and do not emit light. Finding planets is proving hard enough, but finding life on them will prove infinitely more difficult. The first question to answer is whether a planet can actually support life. In our own solar system, for example, Venus is far to hot and Mars is far too cold to support life. Only the Earth provides ideal conditions, and even here it has taken more than four billion years for plant and animal life to evolve. Whether a planet can support life depends on the size and brightness of its star, that is its 'sun'. Imagine a star up to twenty times larger, brighter and hotter than our own sun. A planet would have to be a very long way from it to be capable of supporting life. Alternatively, if the star were small, the life-supporting planet would have to have a close orbit round it and also provide the perfect conditions for life forms to develop. But how would we find such a planet? At present, there is no telescope in existence that is capable of detecting the presence of life. The development of such a telescope will be one of the great astronomical projects of the 21st century. It is impossible to look for life on another planet using earth-based telescopes. Our own warm atmosphere and the heat generated by the telescope would make it impossible to detect objects as small as planets. Even a telescope in orbit round the earth, like the very successful Hubble telescope, would not be suitable because of the dust particles in our solar system. A telescope would have to be as far away as the planet Jupiter to look for life in outer space, because the dust becomes thinner the further we travel towards the outer edges of our own solar system. Once we detected a planet, we would have to find a way of blotting out the light from its star, so that we would be able to 'see' the planet properly and analyse its atmosphere. In the first instance, we would be looking for plant life, rather than 'little green men'. The life forms most likely to develop on a planet would be bacteria. It is bacteria that have generated the oxygen we breathe on earth. For most of the earth's history they have been the only form of life on our planet. As Earth-dwellers, we always cherish the hope that we will be visited by little green men and that we will be able to communicate with them. But this hope is always in the realms of science fiction. If we were able to discover lowly forms of life like bacteria on another planet, it would completely change our view of ourselves. As Daniel Goldin of NASA observed, 'Finding life elsewhere would change everything. No human endeavour or thought would be unchanged by it.'</p>"},{"location":"english/NCE/NCE3/#56-our-neighbour-the-river","title":"56 Our Neighbour, the River","text":"<p>The river which forms the eastern boundary of our farm has always played an important part in our lives. Without it we could not make a living. There is only enough spring water to supply the needs of the house so we have to pump from the river for farm use. We tell the river all our secrets. We know instinctively, just as beekeepers with their bees, that misfortune might overtake us if the important events of our lives were not related to it. We have special river birthday parties in the summer. Sometimes we go upstream to a favourite backwater, sometimes we have our party at the boathouse, which a predecessor of ours at the farm built in the meadow hard by the deepest pool for swimming and diving. In a heat wave we choose a midnight birthday party and that is the most exciting of all. We welcome the seasons by the riverside, crowning the youngest girl with flowers in the spring, holding a summer festival on Midsummer Eve, giving thanks for the harvest in the autumn, and throwing a holly wreath into the current in the winter. After a long period of rain the river may overflow its banks. This is a rare occurrence as our climate seldom goes to extremes. We are lucky in that only the lower fields, which make up a very small proportion of our farm, are affected by flooding, but other farms are less favourably sited, and flooding can sometimes spell disaster for their owners. One bad winter we watched the river creep up the lower meadows. All the cattle had been moved into stalls and we stood to lose little. We were, however, worried about our nearest neighbours, whose farm was low lying and who were newcomers to the district. As the floods had put the telephone out of order, we could not find out how they were managing. From an attic window we could get a sweeping view of the river where their land joined ours, and at the most critical juncture we took turns in watching that point. The first sign of disaster was a dead sheep floating down. Next came a horse, swimming bravely, but we were afraid that the strength of the current would prevent its landing anywhere before it became exhausted. Suddenly a raft appeared, looking rather like Noah's ark, carrying the whole family, a few hens, the dogs, a cat, and a bird in a cage. We realized that they must have become unduly frightened by the rising flood, for their house, which had sound foundations, would have stood stoutly even if it had been almost submerged. The men of our family waded down through our flooded meadows with boat hooks, in the hope of being able to grapple a corner of the raft and pull it out of the current towrds our bank. We still think it a miracle that they were able to do so.</p>"},{"location":"english/NCE/NCE3/#57-back-in-the-old-country","title":"57 Back in the Old Country","text":"<p>I stopped to let the car cool off and to study the map. I had expected to be near my objective by now, but everything still seemed alien to me. I was only five when my father had taken me abroad, and that was eighteen years ago. When my mother had died after a tragic accident, he did not quickly recover from the shock and loneliness. Everything around him was full of her presence, continually reopening the wound. So he decided to emigrate. In the new country he became absorbed in making a new life for the two of us, so that he gradually ceased to grieve. He did not marry again and I was brought up without a woman's care; but I lacked for nothing, for he was both father and mother to me. He always meant to go back one day, but not to stay. His roots and mine had become too firmly embedded in the new land. But he wanted to see the old folk againand to visit my mother's grave. He became mortally ill a few months before we had planned to go and, when he knew that he was dying, he made me promise to go on my own. I hired a car the day after landing and bought a comprehensive book of maps, which I found most helpful on the cross-country journey, but which I did not think I should need on the last stage. It was not that I actually remembered anything at all. But my father had described over and over again what we should see at every milestone after leaving the nearest town, so that I was positive I should recognize it as familiar territory. Well, I had been wrong, for I was now lost. I looked at the map and then at the milometer. I had come ten miles since leaving the town and at this point, according to my father, I should be looking at farms and cottages in a valley, with the spire of the church of our village showing in the far distance. I could see no valley, no farms, no cottages and no church spire-only a lake. I decided that I must have taken a wrong turning somewhere. So I drove back to the town and began to retrace the route, taking frequent glances at the map. I landed up at the same corner. The curious thing was that the lake was not marked on the map. I felt as if I had stumbled into a nightmare country, as you sometimes do in dreams. And, as in a nightmare, there was nobody in sight to help me. Fortunately for me, as I was wondering what to do next, there appeared on the horizon a man on horseback, riding in my direction. I waited till he came near, then I asked him the way to our old village. He said that there was now no village. I thought he must have misunderstood me, so I repeated its name. This time he pointed to the lake. The village no longer existed because it had been submerged, and all the valley too. The lake was not a natural one, but a man-made reservoir.</p>"},{"location":"english/NCE/NCE3/#58-a-spot-of-bother","title":"58 A Spot of Bother","text":"<p>The old lady was glad to be back at the block of flats where she lived. Her shopping had tired her and her basket had grown heavier with every step of the way home. In the lift her thoughts were on lunch and a good rest; but when she got out at her own floor, both were forgotten in her sudden discovery that her front door was open. She was thinking that she must reprimand her home help the next morning for such a monstrous piece of negligence, when she remembered that she had gone shopping after the home help had left and she knew that she had turned both keys in their locks. She walked slowly into the hall and at once noticed that all the room doors were open, yet following her regular practice she had shut them before going out. Looking into the drawing room, she saw a scene of confusion over by her writing desk. It was as clear as daylight then that burglars had forced an entry during her absence. Her first impulse was to go round all the rooms looking for the thieves, but then she decided that at her age it might be more prudent to have someone with her, so she went to fetch the porter from his basement. By this time her legs were beginning to tremble, so she sat down and accepted a cup of very strong tea, while he telephoned the police. Then, her composure regained, she was ready to set off with the porter's assistance to search for any intruders who might still be lurking in her flat. They went through the rooms, being careful to touch nothing, as they did not want to hinder the police in their search for fingerprints. The chaos was inconceivable. She had lived in the flat for thirty years and was a veritable magpie at hoarding: and it seemed as though everything she possessed had been tossed out and turned over and over. At least sorting out the things she should have discarded years ago was now being made easier for her. Then a police inspector arrived with a constable and she told them of her discovery of the ransacked flat. The inspector began to look for fingerprints, while the constable checked that the front door locks had not been forced, thereby proving that the burglars had either used skeleton keys or entered over the balcony. There was no trace of fingerprints, but the inspector found a dirty red bundle that contained jewellery which the old lady said was not hers. So their entry into this flat was apparently not the burglars' first job that day and they must have been disturbed. The inspector then asked the old lady to try to check what was missing by the next day, and advised her not to stay alone in the flat for a few nights. The old lady thought he was a fussy creature, but since the porter agreed with him, she rang up her daughter and asked for her help in what she described as a little spot of bother.</p>"},{"location":"english/NCE/NCE3/#59-collecting","title":"59 Collecting","text":"<p>People tend to amass possessions, sometimes without being aware of doing so. Indeed they can have a delightful surprise when they find something useful which they did not know they owned. Those who never have to move house become indiscriminate collectors of what can only be described as clutter. They leave unwanted objects in drawers, cupboards and attics for years, in the belief that they may one day need just those very things. As they grow old, people also accumulate belongings for two other reasons, lack of physical and mental energy, both of which are essential in turning out and throwing away, and sentiment. Things owned for a long time are full of associations with the past, perhaps with relatives who are dead, and so they gradually acquire a value beyond their true worth. Some things are collected deliberately in the home in an attempt to avoid waste. Among these I would list string and brown paper, kept by thrifty people when a parcel has been opened, to save buying these two requisites. Collecting small items can easily become a mania. I know someone who always cuts sketches out from newspapers of model clothes that she would like to buy if she had the money. As she is not rich, the chances that she will ever be able to afford such purchases are remote; but she is never sufficiently strongminded to be able to stop the practice. It is a harmless habit, but it litters up her desk to such an extent that every time she opens it, loose bits of paper fall out in every direction. Collecting as a serious hobby is quite different and has many advantages. It provides relaxation for leisure hours, as just looking at one's treasures is always a joy. One does not have to go outside for amusement, since the collection is housed at home. Whatever it consists of, stamps, records, first editions of books, china, glass, antique furniture, pictures, model cars, stuffed birds, toy animals, there is always something to do in connection with it, from finding the right place for the latest addition, to verifying facts in reference books. This hobby educates one not only in the chosen subject, but also in general matters which have some bearing on it. There are also other benefits. One wants to meet like-minded collectors, to get advice, to compare notes, to exchange articles, to show off the latest find. So one's circle of friends grows. Soon the hobby leads to travel, perhaps to a meeting in another town, possibly a trip abroad in search of a rare specimen, for collectors are not confined to any one country. Over the years, one may well become an authority on one's hobby and will very probably be asked to give informal talks to little gatherings and then, if successful, to larger audiences. In this way self-confidence grows, first from mastering a subject, then from being able to talk about it. Collecting, by occupying spare time so constructively, makes a person contented, with no time for boredom.</p>"},{"location":"english/NCE/NCE3/#60-too-early-and-too-late","title":"60 Too Early and Too Late","text":"<p>Punctuality is a necessary habit in all public affairs in civilized society. Without it, nothing could ever be brought to a conclusion; everything would be in a state of chaos. Only in a sparsely-populated rural community is it possible to disregard it. In ordinary living, there can be some tolerance of unpunctuality. The intellectual, who is working on some abstruse problem, has everything coordinated and organized for the matter in hand. He is therefore forgiven if late for a dinner party. But people are often reproached for unpunctuality when their only fault is cutting things fine. It is hard for energetic, quick-minded people to waste time, so they are often tempted to finish a job before setting out to keep an appointment. If no accidents occur on the way, like punctured tyres, diversions of traffic, sudden descent of fog, they will be on time. They are often more industrious, useful citizens than those who are never late. The over-punctual can be as much a trial to others as the unpunctual. The guest who arrives half an hour too soon is the greatest nuisance. Some friends of my family had this irritating habit. The only thing to do was ask them to come half an hour later than the other guests. Then they arrived just when we wanted them. If you are catching a train, it is always better to be comfortably early than even a fraction of a minute too late. Although being early may mean wasting a little time, this will be less than if you miss the train and have to wait an hour or more for the next one; and you avoid the frustration of arriving at the very moment when the train is drawing out of the station and being unable to get on it. An even harder situation is to be on the platform in good time for a train and still to see it go off without you. Such an experience befell a certain young girl the first time she was travelling alone. She entered the station twenty minutes before the train was due, since her parents had impressed upon her that it would be unforgivable to miss it and cause the friends with whom she was going to stay to make two journeys to meet her. She gave her luggage to a porter and showed him her ticket. To her horror he said that she was two hours too soon. She felt in her handbag for the piece of paper on which her father had written down all the details of the journey and gave it to the porter. He agreed that a train did come into the station at the time on the paper and that it did stop, but only to take on mail, not passengers. The girl asked to see a timetable, feeling sure that her father could not have made such a mistake. The porter went to fetch one and arrived back with the station master, who produced it with a flourish and pointed out a microscopic 'o' beside the time of the arrival of the train at his station; this little 'o' indicated that the train only stopped for mail. Just as that moment the train came into the station. The girl, tears streaming down her face, begged to be allowed to slip into the guard's van. But the station master was adamant: rules could not be broken. And she had to watch that train disappear towards her destination while she was left behind.</p>"},{"location":"english/NCE/NCE4/","title":"NCE4","text":""},{"location":"english/NCE/NCE4/#01-finding-fossil-man","title":"01 Finding Fossil Man","text":"<p>We can read of things that happened 5, 000 years ago in the Near East, where people first learned to write. But there are some parts of the world where even now people cannot write. The only way that they can preserve their history is to recount it as sagas legends handed down from one generation of storytellers to another. These legends are useful because they can tell us something about migrations of people who lived long ago, but none could write down what they did. Anthropologists wondered where the remote ancestors of the Polynesian peoples now living in the Pacific Islandscame from. The sagas of these people explain that some of them came from Indonesia about 2, 000 years ago. But the first people who were like ourselves lived so long ago that even their sagas, if they had any, are forgotten. So archaeologists have neither history nor legends to help them to find out where the first 'modern men' came from. Fortunately, however, ancient men made tools of stone, especially flint, because this is easier to shape than other kinds. They may also have used wood and skins, but these have rotted away. Stone does not decay, and so the tools of long ago have remained when even the bones of the men who made them have disappeared without trace.</p>"},{"location":"english/NCE/NCE4/#02-spare-that-spider","title":"02 Spare That Spider","text":"<p>Because they destroy so many insects, and insects include some of the greatest enemies of the human race. Insects would make it impossible for us to live in the world; they would devour all our crops and kill our flocks and herds, if it were not for the protection we get from insect eating animals. We owe a lot to the birds and beasts who eat insects but all of them put together kill only a fraction of the number destroyed by spiders. Moreover, unlike some of the other insect eaters, spiders never do the least harm to us or our belongings. Spiders are not insects, as many people think, nor even nearly related to them. One can tell the difference almost at a glance, for a spider always has eight legs and an insect never more than six. How many spiders are engaged in this work on our behalf? One authority on spiders made a census of the spiders in a grass field in the south of England, and he estimated that there were more than 2, 250, 000 in one acre; that is something like 6, 000, 000 spiders of different kinds on a football pitch. Spiders are busy for at least half the year in killing insects. It is impossible to make more than the wildest guess at how many they kill, but they are hungry creatures, not content with only three meals a day. It has been estimated that the weight of all the insects destroyed by spiders in Britain in one year would be greater than the total weight of all the human beings in the country.</p>"},{"location":"english/NCE/NCE4/#03-matterhorn-man","title":"03 Matterhorn Man","text":"<p>Modern alpinists try to climb mountains by a route which will give them good sport, and the more difficult it is, the more highly it is regarded. In the pioneering days however, this was not the case at all. The early climbers were looking for the easiest way to the top because the summit was the prize they sought, especially if it had never been attained before. It is true that during their explorations they often faced difficulties and dangers of the most perilous nature, equipped in a manner which would make a modern climber shudder at the thought, but they did not go out of their way to court such excitement. They had a single aim, a solitary goal -- the top! It is hard for us to realize nowadays how difficult it was for the pioneers. Except for one or two places such as Zermatt and Chamonix, which had rapidly become popular. Alpine villages tended to be impoverished settlements cut off from civilization by the high mountains. Such inns as there were were generally dirty and flea-ridden; the food simply local cheese accompanied by bread often twelve months old, all washed down with coarse wine. Often a valley boasted no inn at all, and climbers found shelter wherever they could -- sometimes with the local priest (who was usually as poor as his parishioners), sometimes with shepherds or cheese-makers. Invariably the background was the same:dirt and poverty, and very uncomfortable. For men accustomed to eating seven-course dinners and sleeping between fine linen sheets at home, the change to the Alps must have been very hard indeed.</p>"},{"location":"english/NCE/NCE4/#04-seeing-hands","title":"04 Seeing Hands","text":"<p>Several cases have been reported in Russia recently of people who can read and detect colours with their fingers, and even see through solid doors and walls. One case concerns an 11-year-old schoolgirl Vera Petrova, who has normal vision but who can also perceive things with different parts of her skin, and through solid walls. This ability was first noticed by her father. One day she came into his office and happened to put her hands on the door of a locked safe. Suddenly she asked her father why he kept so many old newspapers locked away there, and even described the way they were done up in bundles. Vera's curious talent was brought to the notice of a scientific research institute in the town of Ulyanovsk, near where she lives, and in April she was given a series of tests by a special commission of the Ministry of Health of the Russian Federal Republic. During these tests she was able to read a newspaper through an opaque screen and, stranger still, by moving her elbow over a child's game of Lotto she was able to describe the figures and colours printed on it; and, in another instance, wearing stockings and slippers, to make out with her foot the outlines and colours of a picture hidden under a carpet. Other experiments showed that her knees and shoulders had a similar sensitivity. During all these tests Vera was blindfold; and indeed, except when blindfold she lacked the ability to perceive things with her skin. It was also found that although she could perceive things with her fingers this ability ceased the moment her hands were wet.</p>"},{"location":"english/NCE/NCE4/#05-youth","title":"05 Youth","text":"<p>People are always talking about 'the problem of youth'. If there is one -- which I take leave to doubt -- then it is older people who create it, not the young themselves. Let us get down to fundamentals and agree that the young are after all human beings -- people just like their elders. There is only one difference between an old man and a young one: the young man has a glorious future before him and the old one has a splendid future behind him: and maybe that is where the rub is. When I was a teenager, I felt that I was just young and uncertain -- that I was a new boy in a huge school, and I would have been very pleased to be regarded as something so interesting as a problem. For one thing, being a problem gives you a certain identity, and that is one of the things the young are busily engaged in seeking. I find young people exciting. They have an air of freedom, and they have not a dreary commitment to mean ambitions or love of comfort. They are not anxious social climbers, and they have no devotion to material things. All this seems to me to link them with life and the origins of things. It's as if they were in some sense cosmic beings in violent and lovely contrast with us suburban creatures. All that is in my mind when I meet a young person. He may be conceited, ill-mannered,  presumptuous or fatuous,  but I do not turn for protection to dreary cliches about respect for elders -- as if mere age were a reason for respect. I accept that we are equals, and I will argue with him, as an equal, if I think he is wrong.</p>"},{"location":"english/NCE/NCE4/#06-the-sporting-spirit","title":"06 The Sporting Spirit","text":"<p>I am always amazed when I hear people saying that sport creates goodwill between the nations, and that if only the common peoples of the world could meet one another at football or cricket, they would have no inclination to meet on the battlefield. Even if one didn't know from concrete examples (the 1936 Olympic Games, for instance) that international sporting contests lead to orgies of hatred, one could deduce it from general principles. Nearly all the sports practised nowadays are competitive. You play to win, and the game has little meaning unless you do your utmost to win. On the village green, where you pick up sides and no feeling of local patriotism is involved, it is possible to play simply for the fun and exercise: but as soon as a the question of prestige arises, as soon as you feel that you and some larger unit will be disgraced if you lose, the most savage combative instincts are aroused. Anyone who has played even in a school football match knows this. At the international level, sport is frankly mimic warfare. But the significant thing is not the behaviour of the players but the attitude of the spectators: and, behind the spectators, of the nations who work themselves into furies over these absurd contests, and seriously believe -- at any rate for short periods -- that running, jumping and kicking a ball are tests of national virtue.</p>"},{"location":"english/NCE/NCE4/#07-bats","title":"07 Bats","text":"<p>Not all sounds made by animals serve as language, and we have only to turn to that extraordinary discovery of echo-location in bats to see a case in which the voice plays a strictly utilitarian role. To get a full appreciation of what this means we must turn first to some recent human inventions. Everyone knows that if he shouts in the vicinity of a wall or a mountainside, an echo will come back. The further off this solid obstruction, the longer time will elapse for the return of the echo. A sound made by tapping on the hull of a ship will be reflected from the sea bottom, and by measuring the time interval between the taps and the receipt of the echoes the depth of the sea at that point can be calculated. So was born the echo-sounding apparatus, now in general use in ships. Every solid object will reflect a sound, varying according to the size and nature of the object. A shoal of fish will do this. So it is a comparatively simple step from locating the sea bottom to locating a shoal of fish. With experience, and with improved apparatus, it is now possible not only to locate a shoal but to tell if it is herring, cod, or other well-known fish, by the pattern of its echo. It has been found that certain bats emit squeaks and by receiving the echoes, they can locate and steer clear of obstacles -- or locate flying insects on which they feed. This echo-location in bats is often compared with radar, the principle of which is similar.</p>"},{"location":"english/NCE/NCE4/#08-trading-standards","title":"08 Trading Standards","text":"<p>Chickens slaughtered in the United States, claim officials in Brussels, are not fit to grace European tables. No, say the Americans: our fowl are fine, we simply clean them in a different way. These days, it is differences in national regulations, far more than tariffs, that put sand in the wheels of trade between rich countries. It is not just farmers who are complaining. An electric razor that meets the European Union's safety standards must be approved by American testers before it can be sold in the United States, and an American-made dialysis machine needs the EU's okay before it hits the market in Europe. As it happens, a razor that is safe in Europe is unlikely to electrocute Americans. So, ask businesses on both sides of the Atlantic, why have two lots of tests where one would do? Politicians agree, in principle, so America and the EU have been trying to reach a deal which would eliminate the need to double-test many products. They hope to finish in time for a trade summit between America and the EU on May 28th. Although negotiators are optimistic, the details are complex enough that they may be hard-pressed to get a deal at all. Why? One difficulty is to construct the agreements. The Americans would happily reach one accord on standards for medical devices and then hammer out different pacts covering, say, electronic goods and drug manufacturing. The EU -- following fine continental traditions -- wants agreement on general principles, which could be applied to many types of products and perhaps extended to other countries.</p>"},{"location":"english/NCE/NCE4/#09-royal-espionage","title":"09 Royal Espionage","text":"<p>Alfred the Great acted as his own spy, visiting Danish camps disguised as a minstrel. In those days wandering minstrels were welcome everywhere. They were not fighting men, and their harp was their passport. Alfred had learned many of their ballads in his youth and could vary his programme with acrobatic tricks and simple conjuring. While Alfred's little army slowly began to gather at Athelney, the king himself set out to penetrate the camp of Guthrum, the commander of the Danish invaders. These had settled down for the winter at Chippenham: thither Alfred went. He noticed at once that discipline was slack: the Danes had the self-confidence of conquerors, and their security precautions were casual. They lived well, on the proceeds of raids on neighbouring regions. There they collected women as well as food and drink, and a life of ease had made them soft. Alfred stayed in the camp a week before he returned to Athelney. The force there assembled was trivial compared with the Danish horde. But Alfred had deduced that the Danes were no longer fit for prolonged battle: and that their commissariat had no organization, but depended on irregular raids. So, faced with the Danish advance, Alfred did not risk open battle but harried the enemy. He was constantly on the move, drawing the Danes after him. His patrols halted the raiding parties: hunger assailed the Danish army. Now Alfred began a long series of skirmishes -- and within a month the Danes had surrendered. The episode could reasonably serve as a unique epic of royal espionage!</p>"},{"location":"english/NCE/NCE4/#10-silicon-valley","title":"10 Silicon Valley","text":"<p>Technology trends may push Silicon Valley back to the future. Carver Mead, a pioneer in integrated circuits and a professor of computer science at the California Institute of Technology, notes there are now workstations that enable engineers to design, test and produce chips right on their desks, much the way and editor creates a newsletter on a Macintosh. As the time and cost of making a chip drop to a few days and a few hundred dollars, engineers may soon be free to let their imaginations soar without being penalized by expensive failures. Mead predicts that inventors will be able to perfect powerful customized chips over a weekend at the office -- spawning a new generation of garage start-ups and giving the U. S.  a jump on its foreign rivals in getting new products to market fast. 'We've got more garages with smart people,' Mead observes. 'We really thrive on anarchy. ' And on Asians. Already, orientals and Asian Americans constitute the majority of the engineering staffs at many Valley firms. And Chinese, Korean, Filipino and Indian engineers are graduating in droves from California's colleges. As the heads of next-generation start-ups, these Asian innovators can draw on customs and languages to forge tighter links with crucial Pacific Rim markets. For instance, Alex Au, a Stanford Ph. D. from Hong Kong, has set up a Taiwan factory to challenge Japan's near lock on the memory-chip market. India-born N. Damodar Reddy's tiny California company reopened an AT&amp;T chip plant in Kansas City last spring with financing from the state of Missouri. Before it becomes a retirement village, Silicon Valley may prove a classroom for building a global business.</p>"},{"location":"english/NCE/NCE4/#11-how-to-grow-old","title":"11 How to Grow Old","text":"<p>Some old people are oppressed by the fear of death. In the young there is a justification for this feeling. Young men who have reason to fear that they will be killed in battle may justifiably feel bitter in the thought that they have been cheated of the best things that life has to offer. But in an old man who has known human joys and sorrows, and has achieved whatever work it was in him to do, the fear of death is somewhat abject and ignoble. The best way to overcome it--so at least it seems to me-- is to make your interests gradually wider and more impersonal, until bit by bit the walls of the ego recede, and your life becomes increasingly merged in the universal life. An individual human existence should be like a river-- small at first, narrowly contained within its banks, and rushing passionately past boulders and over waterfalls. Gradually the river grows wider, the banks recede, the waters flow more quietly, and in the end, without any visiblebreak, they become merged in the sea, and painlessly lose their individual being. The man who, in old age can see his life in this way, will not suffer from the fear of death, since the things he cares for will continue. And if, with the decay of vitality, weariness increases, the thought of rest will be not unwelcome. I should wish to die while still at work, knowing that others will carry on what I can no longer do, and content in the thought that what was possible has been done.</p>"},{"location":"english/NCE/NCE4/#12-banks-and-their-customers","title":"12 Banks and Their Customers","text":"<p>When anyone opens a current account at a bank, he is lending the bank money, repayment of which he may demand at any time either in cash or by drawing a cheque in favour of another person. Primarily, the banker-customer relationship is that of debtor and creditor-- who is which depending on whether the customer's account is in credit or is overdrawn. But, in addition to that basically simple concept, the bank and its customer owe a large number of obligations to one another. Many of these obligations can give rise to problems and complications but a bank customer, unlike, say, a buyer of goods, cannot complain that the law is loaded against him. The bank must obey its customer's instructions, and not those of anyone else. When, for example, a customer first opens an account, he instructs the bank to debit his account only in respect of cheques drawn by himself. He gives the bank specimens of his signature, and there is a very firm rule that the bank has no right or authority to pay out a customer's money on a cheque on which its customer's signature has been forged. It makes no difference that the forgery may have been a very skillful one: the bank must recognize its customer's signature. For this reason there is no risk to the customer in the practice, adopted by banks, of printing the customer's name on his cheques. If this facilitates forgery, it is the bank which will lose, not the customer.</p>"},{"location":"english/NCE/NCE4/#13-the-search-for-oil","title":"13 The Search for Oil","text":"<p>The deepest holes of all are made for oil, and they go down to as much as 25, 000 feet. But we do not need to send man down to get the oil out, as we must with other mineral deposits. The holes are only borings, less than a foot in diameter. My particular experience is largely in oil, and the search for oil has done more to improve deep drilling than any other mining activity. When it has been decided where we are going to drill, we put up at the surface an oil derrick. It has to be tall because it is like a giant block and tackle and we have to lower into the ground and haul out of the ground great lengths of drill pipe which are rotated by an engine at the top and are fitted with a cutting bit at the bottom. The geologist needs to know what rocks the drill has reached, so every so often a sample is obtained with a coring bit. It cuts a clean cylinder of rock, from which can be seen the strata the drill has been cutting through. Once we get down to the oil, it usually flows to the surface because great pressure either from gas or water, is pushing it. This pressure must be under control, and we control it by means of the mud which we circulate down the drill pipe. We endeavour to avoid the old, romantic idea of a gusher, which wastes oil and gas. We want it to stay down the hole until we can lead it off in a controlled manner.</p>"},{"location":"english/NCE/NCE4/#14-the-butterfly-effect","title":"14 The Butterfly Effect","text":"<p>Beyond two or three days, the world's best weather forecasts are speculative, and beyond six or seven they are worthless. The Butterfly Effect is the reason. For small pieces of weather-- and to a global forecaster, small can mean thunderstorms and blizzards-- any prediction deteriorates rapidly. Errors and uncertainties multiply, cascading upward through a chain of turbulent features, from dust devils and squalls up to continent-size eddies that only satellites can see. The modern weather models work with a grid of points of the order of sixty miles apart, and even so, some starting data has to be guessed, since ground stations and satellites cannot see everywhere. But suppose the earth could be covered with sensors spaced one foot apart, rising at one-foot intervals all the way to the top of the atmosphere. Suppose every sensor gives perfectly accurate readings of temperature, pressure, humidity, and any other quantity a meteorologist would want. Precisely at noon an infinitely powerful computer takes all the data and calculates what will happen at each point at 12.01, then 12.02, then 12.03... The computer will still be unable to predict whether Princeton, New Jersey, will have sun or rain on a day one month away. At noon the spaces between the sensors will hide fluctuations that the computer will not know about, tiny deviations from the average. By 12.01, those fluctuations will already have created small errors one foot away. Soon the errors will have multiplied to the ten-foot scale, and so on up to the size of the globe.</p>"},{"location":"english/NCE/NCE4/#15-secrecy-in-industry","title":"15 Secrecy in Industry","text":"<p>Two factors weigh heavily against the effectiveness of scientific research in industry. One is the general atmosphere of secrecy in which it is carried out, the other the lack of freedom of the individual research worker. In so far as any inquiry is a secret one, it naturally limits all those engaged in carrying it out from effective contact with their fellow scientists either in other countries or in universities, or even, often enough, in other departments of the same firm. The degree of secrecy naturally varies considerably. Some of the bigger firms are engaged in researches which are of such general and fundamental nature that it is a positive advantage to them not to keep them secret. Yet a great many processes depending on such research are sought for with complete secrecy until the stage at which patents can be taken out. Even more processes are never patented at all but kept as secret processes. This applies particularly to chemical industries, where chance discoveries play a much larger part than they do in physical and mechanical industries. Sometimes the secrecy goes to such an extent that the whole nature of the research cannot be mentioned. Many firms, for instance have great difficulty in obtaining technical or scientific books from libraries because they are unwilling to have their names entered as having taken out such and such a book, for fear the agents of other firms should be able to trace the kind of research they are likely to be undertaking.</p>"},{"location":"english/NCE/NCE4/#16-the-modern-city","title":"16 The Modern City","text":"<p>In the organization of industrial life the influence of the factory upon the physiological and mental state of the workers has been completely neglected. Modern industry is based on the conception of the maximum production at lowest cost, in order that an individual or a group of individuals may earn as much money as possible. It has expanded without any idea of the true nature of the human beings who run the machines, and without giving any consideration to the effects produced on the individuals and on their descendants by the artificial mode of existence imposed by the factory. The great cities have been built with no regard for us. The shape and dimensions of the skyscrapers depend entirely on the necessity of obtaining the maximum income per square foot of ground, and of offering to the tenants offices and apartments that please them. This caused the construction of gigantic buildings where too large masses of human beings are crowded together. Civilized men like such a way of living. While they enjoy the comfort and banal luxury of their dwelling, they do not realize that they are deprived of the necessities of life. The modern city consists of monstrous edifices and of dark, narrow streets full of petrol fumes and toxic gases, torn by the noise of the taxicabs, lorries and buses, and thronged ceaselessly by great crowds. Obviously, it has not been planned for the good of its inhabitants.</p>"},{"location":"english/NCE/NCE4/#17-a-man-made-disease","title":"17 A Man-made Disease","text":"<p>In the early days of the settlement of Australia, enterprising settlers unwisely introduced the European rabbit. This rabbit had no natural enemies in the Antipodes, so that it multiplied with that promiscuous abandon characteristic of rabbits. It overran a whole continent. It caused devastation by burrowing and by devouring the herbage which might have maintained millions of sheep and cattle. Scientists discovered that this particular variety of rabbit (and apparently no other animal) was susceptible to a fatal virus disease, myxomatosis. By infecting animals and letting them loose in the burrows, local epidemics of this disease could be created. Later it was found that there was a type of mosquito which acted as the carrier of this disease and passed it on to the rabbits. So while the rest of the world was trying to get rid of mosquitoes, Australia was encouraging this one. It effectively spread the disease all over the continent and drastically reduced the rabit population. It later became apparent that rabbits were developing a degree of resistance to this disease, so that the rabbit population was unlikely to be completely exterminated. There were hopes, however, that the problem of the rabbit would become manageable. Ironically, Europe, which had bequeathed the rabbit as a pest to Australia, acquired this man-made disease as a pestilence. A French physician decided to get rid of the wild rabbits on his own estate and introduced myxomatosis. It did not, however, remain within the confines of this estate. It spread through France, where wild rabbits are not generally regarded as a pest but as a sport and a useful food supply, and it spread to Britain where wild rabbits are regarded as a pest but where domesticated rabbits, equally susceptible to the disease, are the basis of a profitable fur industry. The question became one of whether Man could control the disease he had invented.</p>"},{"location":"english/NCE/NCE4/#18-porpoises","title":"18 Porpoises","text":"<p>There has long been a superstition among mariners that porpoises will save drowning men by pushing them to the surface, or protect them from sharks by surrounding them in defensive formation. Marine Studio biologists have pointed out that, however intelligent they may be, it is probably a mistake to credit dolphins with any motive of life-saving. On the occasions when they have pushed to shore an unconscious human being they have much more likely done it out of curiosity or for sport, as in riding the bow waves of a ship. In 1928 some porpoises were photographed working like beavers to push ashore a waterlogged mattress. If, as has been reported, they have protected humans from sharks, it may have been because curiosity attracted them and because the scent of a possible meal attracted the sharks. Porpoises and sharks are natural enemies. It is possible that upon such an occasion a battle ensued, with the sharks being driven away or killed. Whether it be bird, fish or beast, the porpoise is intrigued with anything that is alive. They are constantly after the turtles, who peacefully submit to all sorts of indignities. One young calf especially enjoyed raising a turtle to the surface with his snout, and then shoving him across the tank like an aquaplane. Almost any day a young porpoises may be seen trying to turn a 300-pound sea turtle over by sticking his snout under the edge of his shell and pushing up for dear life. This is not easy, and may require two porpoises working together. In another game, as the turtle swims across the oceanarium, the first porpoise swoops down from above and butts his shell with his belly. This knocks the turtle down several feet. He no sooner recovers his equilibrium than the next porpoises comes along and hits him another crack. Eventually the turtle has been butted all the way down to the floor of the tank. He is now satisfied merely to try to stand up, but as soon as he does so a porpoise knocks him flat. The turtle at last gives up by pulling his feet under his shell and the game is over.</p>"},{"location":"english/NCE/NCE4/#19-the-stuff-of-dreams","title":"19 The Stuff of Dreams","text":"<p>It is fairly clear that the sleeping period must have some function, and because there is so much of it the function would seem to be important. Speculations about its nature have been going on for literally thousands of years, and one odd finding that makes the problem puzzling is that it looks very much as if sleeping is not simply a matter of giving the body a rest. 'Rest', in terms of muscle relaxation and so on, can be achieved by a brief period lying, or even sitting down. The body's tissues are self-repairing and self-restoring to a degree, and function best when more or less continuously active. In fact a basic amount of movement occurs during sleep which is specifically concerned with preventing muscle inactivity. If it is not a question of resting the body, then perhaps it is the brain that needs resting? This might be a plausible hypothesis were it not for two factors. First the electroencephalograph (which is simply a device for recording the electrical activity of the brain by attaching electrodes to the scalp) shows that while there is a change in the pattern of activity during sleep, there is no evidence that the total amount of activity is any less. The second factor is more interesting and more fundamental. Some years ago an American psychiatrist named William Dement published experiments dealing with the recording of eye-movements during sleep. He showed that the average individual's sleep cycle is punctuated with peculiar bursts of eye-movements, some drifting and slow, others jerky and rapid. People woken during these periods of eye-movements generally reported that they had been dreaming. When woken at other times they reported no dreams. If one group of people were disturbed from their eye-movement sleep for several nights on end, and another group were disturbed for an equal period of time but when they were not exhibiting eye-movements, the first group began to show some personality disorders while the others seemed more or less unaffected. The implications of all this were that it was not the disturbance of sleep that mattered, but the disturbance of dreaming.</p>"},{"location":"english/NCE/NCE4/#20-snake-poison","title":"20 Snake Poison","text":"<p>How in came about that snakes manufactured poison is a mystery. Over the periods their saliva, a mild, digestive juice like our own, was converted into a poison that defies analysis even today. It was not forced upon them by the survival competition; they could have caught and lived on prey without using poison, just as the thousands of non-poisonous snakes still do. Poison to a snake is merely a luxury; it enables it to get its food with very little effort, no more effort than one bite. And why only snakes? Cats, for instance, would be greatly helped; no running fights with large, fierce rats or tussles with grown rabbits--just a bite and no more effort needed. In fact, it would be an assistance to all carnivores though it would be a two-edged weapon when they fought each other. But, of the vertebrates unpredictable Nature selected only snakes (and one lizard). One wonders also why Nature, with some snakes concocted poison of such extreme potency. In the conversion of saliva into poison, one might suppose that a fixed process took place. It did not; some snakes manufactured a poison different in every respect from that of others, as different as arsenic is from strychnine, and having different effects. One poison acts on the nerves, the other on the blood. The makers of the nerve poison include the mambas and the cobras and their venom is called neurotoxic. Vipers (adders) and rattlesnakes manufacture the blood poison, which is known as haemolytic. Both poisons are unpleasant, but by far the more unpleasant is the blood poison. It is said that the nerve poison is the more primitive of the two, that the blood poison is, so to speak, a newer product from an improved formula. Be that as it may, the nerve poison does its business with man far more quickly than the blood poison. This, however, means nothing. Snakes did not acquire their poison for use against man but for use against prey such as rats and mice, and the effects on these of viperine poison is almost immediate.</p>"},{"location":"english/NCE/NCE4/#21-william-s-hart-and-the-early-western-film","title":"21 William S. Hart and the Early Western Film","text":"<p>William S.Hart was, perhaps, the greatest of all Western stars, for unlike Gary Cooper and John Wayne he appeared in nothing but Westerns. From 1914 to 1924 he was supreme and unchallenged. It was Hart who created the basic formula of the Western film, and devised the protagonist he played in every film he made, the good-bad man, the accidental, noble outlaw, or the honest, but framed cowboy, or the sheriff made suspect by vicious gossip; in short, the individual in conflict with himself and his frontier environment. Unlike most of his contemporaries in Hollywood, Hart actually knew something of the old West. He had lived in it as a child when it was already disappearing, and his hero was firmly rooted in his memories and experiences, and in both the history and the mythology of the vanished frontier, And although no period or place in American history has been more absurdly romanticized, myth and reality did join hands in at least one arena, the conflict between the individual and encroaching civilization. Men accustomed to struggling for survival against the elements and Indians were bewildered by politicians, bankers and businessmen, and unhorsed by fences, laws and alien taboos. Hart's good-bad man was always an outsider, always one of the disinherited, and if he found it necessary to shoot a sheriff or rob a bank along the way, his early audiences found it easy to understand and forgive, especially when it was Hart who, in the end, overcame the attacking Indians. Audiences in the second decade of the twentieth century found it pleasant to escape to a time when life, though hard, was relatively simple. We still do; living in a world in which undeclared aggression, war, hypocrisy, chicanery, anarchy and impending immolation are part of our daily lives, we all want a code to live by.</p>"},{"location":"english/NCE/NCE4/#22-knowledge-and-progress","title":"22 Knowledge and Progress","text":"<p>Surely because progress of a particular kind is actually taking place around us and is becoming more and more manifest. Although mankind has undergone no general improvement in intelligence or morality, it has made extraordinary progress in the accumulation of knowledge. Knowledge began to increase as soon as the thoughts of one individual could be communicated to another by means of speech. With the invention of writing, a great advance was made, for knowledge could then be not only communicated but also stored. Libraries made education possible, and education in its turn added to libraries: the growth of knowledge followed a kind of compound interest law, which was greatly enhanced by the invention of printing. All this was comparatively slow until, with the coming of science, the tempo was suddenly raised. Then knowledge began to be accumulated according to a systematic plan. The trickle became a stream: the stream has now become a torrent. Moreover, as soon as new knowledge is acquired, it is now turned to practical account. What is called 'modern civilization' is not the result of a balanced development of all man's nature, but of accumulated knowledge applied to practical life. The problem now facing humanity is: What is going to be done with all this knowledge? As is so often pointed out, knowledge is a two-edged weapon which can be used equally for good or evil. It is now being used indifferently for both. Could any spectacle, for instance, be more grimly whimsical than that of gunners using science to shatter men's bodies while, close at hand, surgeons use it to restore them? We have to ask ourselves very seriously what will happen if this twofold use of knowledge, with its ever-increasing power, continues.</p>"},{"location":"english/NCE/NCE4/#23-bird-flight","title":"23 Bird Flight","text":"<p>No two sorts of birds practise quite the same sort of flight; the varieties are infinite; but two classes may be roughly seen. Any ship that crosses the Pacific is accompanied for many days by the smaller albatross, which may keep company with the vessel for an hour without visible or more than occasional movement of wing. The currents of air that the walls of the ship direct upwards, as well as in the line of its course, are enough to give the great bird with its immense wings sufficient sustenance and progress. The albatross is the king of the gliders, the class of fliers which harness the air to their purpose, but must yield to its opposition. In the contrary school, the duck is supreme. It comes nearer to the engines with which man has 'conquered' the air, as he boasts. Duck, and like them the pigeons, are endowed with steel-like muscles, that are a good part of the weight of the bird, and these will ply the short wings with such irresistible power that they can bore for long distances through an opposing gale before exhaustion follows. Their humbler followers, such as partridges, have a like power of strong propulsion, but soon tire. You may pick them up in utter exhaustion, if wind over the sea has driven them to a long journey. The swallow shares the virtues of both schools in highest measure. It tires not, nor does it boast of its power; but belongs to the air travelling it may be six thousand miles to and from its northern nesting home, feeding its flown young as it flies, and slipping through a medium that seems to help its passage even when the wind is adverse. Such birds do us good, though we no longer take omens from their flight on this side and that; and even the most superstitious villagers no longer take off their hats to the magpie and wish it good-morning.</p>"},{"location":"english/NCE/NCE4/#24-beauty","title":"24 Beauty","text":"<p>A young man sees a sunset and, unable to understand or to express the emotion that it rouses in him, concludes that it must be the gateway to a world that lies beyond It is difficult for any of us in moments of intense aesthetic experience to resist the suggestion that we are catching a glimpse of a light that shines down to us from a different realm of existence, different and, because the experience is intensely moving, in some way higher. And, though the gleams blind and dazzle, yet do they convey a hint of beauty and serenity greater than we have known or imagined. Greater too than we can describe; for language, which was invented to convey the meanings of this world cannot readily be fitted to the uses of another. That all great art has this power of suggesting a world beyond is undeniable. In some moods, nature shares it. There is no sky in June so blue that it does not point forward to a bluer, no sunset so beautiful that it does not waken the vision of a greater beauty, a vision which passes before it is fully glimpsed, and in passing leaves an indefinable longing and regret. But, if this world is not merely a bad joke, life a vulgar flare amid the cool radiance of the stars, and existence an empty laugh braying across the mysteries; if these intimations of a something behind and beyond are not evil humour born of indigestion, or whimsies sent by the devil to mock and madden us, if, in a word beauty means something yet we must not seek to interpret the meaning. If we glimpse the unutterable, it is unwise to try to utter it, nor should we seek to invest with significance that which we cannot grasp. Beauty in terms of our human meanings is meaningless.</p>"},{"location":"english/NCE/NCE4/#25-non-auditory-effects-of-noise","title":"25 Non-Auditory Effects of Noise","text":"<p>Many people in industry and the Services, who have practical experience of noise, regard any investigation of this question as a waste of time; they are not prepared even to admit the possibility that noise affects people. On the other hand, those who dislike noise will sometimes use most inadequate evidence to support their pleas for a quieter society. This is a pity, because noise abatement really is a good cause, and it is likely to be discredited if it gets to be associated with bad science. One allegation often made is that noise produces mental illness. A recent article in a weekly newspaper, for instance, was headed with a striking illustration of a lady in a state of considerable distress, with the caption 'She was yet another victim, reduced to a screaming wreck'. On turning eagerly to the text, one learns that the lady was a typist who found the sound of office typewriters worried her more and more until eventually she had to go into a mental hospital. Now the snag in this sort of anecdote is of course that one cannot distinguish cause and effect. Was the noise a cause of the illness, or were the complaints about noise merely a symptom? Another patient might equally well complain that her neighbours were combining to slander her and persecute her, and yet one might be cautious about believing this statement. What is needed in the case of noise is a study of large numbers of people living under noisy conditions, to discover whether they are mentally ill more often than other people are. Some time ago the United States Navy, for instance, examined a very large number of men working on aircraft carriers: the study was known as Project Anehin. It can be unpleasant to live even several miles from an aerodrome; if you think what it must be like to share the deck of a ship with several squadrons of jet aircraft, you will realize that a modern navy is a good place to study noise. But neither psychiatric interviews nor objective tests were able to show any effects upon these American sailors. This result merely confirms earlier American and British studies: if there is any effect of noise upon mental health, it must be so small that present methods of psychiatric diagnosis cannot find it. That does not prove that it does not exist; but it does mean that noise is less dangerous than, say being brought up in an orphanage --which really is a mental health hazard.</p>"},{"location":"english/NCE/NCE4/#26-the-past-life-of-the-earth","title":"26 The Past Life of the Earth","text":"<p>It is animals and plants which lived in or near water whose remains are most likely to be preserved, for one of the necessary conditions of preservation is quick burial, and it is only in the seas and rivers, and sometimes lakes, where mud and silt have been continuously deposited, that bodies and the like can be rapidly covered over and preserved. But even in the most favourable circumstances only a small fraction of the creatures that die are preserved in this way before decay sets in or, even more likely, before scavengers eat them. After all, all living creatures live by feeding on something else, whether it be plant or animal, dead or alive, and it is only by chance that such a fate is avoided. The remains of plants and animals that lived on land are much more rarely preserved, for there is seldom anything to cover them over. When you think of the innumerable birds that one sees flying about, not to mention the equally numerous small animals like field mice and voles which you do not see, it is very rarely that one comes across a dead body, except, of course, on the roads. They decompose and are quickly destroyed by the weather or eaten by some other creature. It is almost always due to some very special circumstances that traces of land animals survive, as by falling into inaccessible caves, or into an ice crevasse, like the Siberian mammoths, when the whole animal is sometimes preserved, as in a refrigerator. This is what happened to the famous Beresovka mammoth which was found preserved and in good condition. In his mouth were the remains of fir trees--the last meal that he had before he fell into the crevasse and broke his back. The mammoth has now been restored in the Palaeontological Museum in St.Petersburg. Other animals were trapped in tar pits, like the elephants, sabre-toothed cats, and numerous other creatures that are found at Rancho la Brea, which is now just a suburb of Los Angeles. Apparently what happened was that water collected on these tar pits and the bigger animals like the elephants ventured out on to the apparently firm surface to drink, and were promptly bogged in the tar. And then, when they were dead, the carnivores, like the sabretoothed cats and the giant wolves, came out to feed and suffered exactly the same fate. There are also endless numbers of birds in the tar as well.</p>"},{"location":"english/NCE/NCE4/#27-the-vasa","title":"27 The vasa","text":"<p>From the seventeenth-century empire of Sweden, the story of a galleon that sank at the start of her maiden voyage in 1628 must be one of the strangest tales of the sea. For nearly three and a half centuries she lay at the bottom of Stockholm harbour until her discovery in 1956. This was the Vasa, royal flagship of the great imperial fleet. King Gustavus Adolphus 'The Northern Hurricane', then at the height of his military success in the 'Thirty Years' War, had dictated her measurements and armament. Triple gun-decks mounted sixty-four bronze cannon. She was intended to play a leading role in the growing might of Sweden. As she was prepared for her maiden voyage on August 10, 1628, Stockholm was in a ferment. From the Skeppsbron and surrounding islands the people watched this thing of beauty begin to spread her sails and catch the wind. They had laboured for three years to produce this floating work of art; she was more richly carved and ornamented than any previous ship. The high stern castle was a riot of carved gods, demons, knights, kings, warriors, mermaids, cherubs; and zoomorphic animal shapes ablaze with red and gold and blue, symbols of courage, power, and cruelty, were portrayed to stir the imaginations of the superstitious sailors of the day. Then the cannons of the anchored warships thundered a salute to which the Vasa fired in reply. As she emerged from her drifting cloud of gun smoke with the water churned to foam beneath her bow, her flags flying, pennants waving, sails filling in the breeze, and the red and gold or her superstructure ablaze with colour, she presented a more majestic spectacle than Stockholmers had ever seen before. All gun-ports were open and the muzzles peeped wickedly from them. As the wind freshened there came a sudden squall and the ship made a strange movement, listing to port. The Ordnance officer ordered all the port cannon to be heaved to starboard to counteract the list but the steepening angle of the decks increased. Then the sound of rumbling thunder reached the watchers on the shore, as cargo, ballast, ammunition and 400 people went sliding and crashing down to the port side of the steeply listing ship. The lower gun-ports were now below water and the inrush sealed the ship's fate. In that first glorious hour, the mighty Vasa, which was intended to rule the Baltic, sank with all flags flying--in the harbour of her birth.</p>"},{"location":"english/NCE/NCE4/#28-patients-and-doctors","title":"28 Patients and Doctors","text":"<p>This is a sceptical age, but although our faith in many of the things in which our forefathers fervently believed has weakened, our confidence in the curative properties of the bottle of medicine remains the same as theirs. This modern faith in medicines is proved by the fact that the annual drug bill of the Health Services is mounting to astronomical figures. and shows no signs at present of ceasing to rise. The majority of the patients attending the medical out-patients departments of our hospitals feel that they have not received adequate treatment unless they are able to carry home with them some tangible remedy in the shape of a bottle of medicine, a box of pills, or a small jar of ointment, and the doctor in charge of the department is only too ready to provide them with these requirements. There is no quicker method of disposing of patients than by giving them what they are asking for, and since most medical men in the Health Services are overworked and have little time for offering time-consuming and little-appreciated advice on such subjects as diet, right living, and the need for abandoning bad habits etc., the bottle, the box, and the jar are almost always granted them. Nor is it only the ignorant and ill-educated person who has such faith in the bottle of medicine. It is recounted of Thomas Carlyle that when he heard of the illness of his friend, Henry Taylor, he went off immediately to visit him, carrying with him in his pocket what remained a bottle of medicine formerly prescribed for an indisposition of Mrs. Carlyle's. Carlyle was entirely ignorant of what the bottle in his pocket contained, of the nature of the illness from which his friend was suffering, and of what had previously been wrong with his wife, but a medicine that had worked so well in one form of illness would surely be of equal benefit in another, and comforted by the thought of the help he was bringing to his friend, he hastened to Henry Taylor's house. History does not relate whether his friend accepted his medical help, but in all probability he did. The great advantage of taking medicine is that it makes no demands on the taker beyond that of putting up for a moment with a disgusting taste, and that is what all patients demand of their doctors--to be cured at no inconvenience to themselves.</p>"},{"location":"english/NCE/NCE4/#29-the-hovercraft","title":"29 The Hovercraft","text":"<p>Many strange new means of transport have been developed in our century, the strangest of them being perhaps the hovercraft. In 1953, a former electronics engineer in his fifties, Christopher Cockerell, who had turned to boat-building on the Norfolk Broads, suggested an idea on which he had been working for many years to the British Government and industrial circles. It was the idea of supporting a craft on a 'pad', or cushion, of low-pressure air, ringed with a curtain of higher pressure air. Ever since, people have had difficulty in deciding whether the craft should be ranged among ships, planes, or land vehicles--for it is something in between a boat and an aircraft. As a shipbuilder, Cockerell was trying to find a solution to the problem of the wave resistance which wastes a good deal of a surface ship's power and limits its speed. His answer was to lift the vessel out of the water by making it ride on a cushion of air, no more than one or two feet thick. This is done by a great number of ring-shaped air jets on the bottom of the craft. It 'flies', therefore, but it cannot fly higher--its action depends on the surface, water or ground, over which it rides. The first tests on the Solent in 1959 caused a sensation. The hovercraft travelled first over the water, then mounted the beach, climbed up the dunes, and sat down on a road. Later it crossed the Channel, riding smoothly over the waves, which presented no problem. Since that time, various types of hovercraft have appeared and taken up regular service. The hovercraft is particularly useful in large areas with poor communications such as Africa or Australia; it can become a 'flying fruit-bowl', carrying bananas from the plantations to the ports; giant hovercraft liners could span the Atlantic; and the railway of the future may well be the 'hovertrain', riding on its air cushion over a single rail, which it never touches, at speeds, up to 300 m.p.h.--the possibilities appear unlimited.</p>"},{"location":"english/NCE/NCE4/#30-exploring-the-sea-floor","title":"30 Exploring the Sea-Floor","text":"<p>Our knowledge of the oceans a hundred years ago was confined to the two-dimensional shape of the sea surface and the hazards of navigation presented by the irregularities in depth of the shallow water close to the land. The open sea was deep and mysterious, and anyone who gave more than a passing thought to the bottom confines of the oceans probably assumed that the sea-bed was flat. Sir James Clark Ross had obtained a sounding of over 2, 400 fathoms in 1839, but it was not until 1869, when H.M.S. Porcupine was put at the disposal of the Royal Society for several cruises that a series of deep soundings was obtained in the Atlantic and the first samples were collected by dredging the bottom. Shortly after this the famous H.M.S. Challenger expedition established the study of the sea-floor as a subject worthy of the most qualified physicists and geologists. A burst of activity associated with the laying of submarine cables soon confirmed the Challenger's observation that many parts of the ocean were two to three miles deep, and the existence of underwater features of considerable magnitude. Today, enough soundings are available to enable a relief map of the Atlantic to be drawn and we know something of the great variety of the sea bed's topography. Since the sea covers the greater part of the earth's surface, it is quite reasonable to regard the sea floor as the basic form of the crust of the earth, with superimposed upon it the continents, together with the islands and other features of the oceans. The continents form rugged tablelands which stand nearly three miles above the floor of the open ocean. From the shore line, out to a distance which may be anywhere from a few miles to a few hundred miles, runs the gentle slope of the continental shelf, geologically part of the continents. The real dividing line between continents and oceans occurs at the foot of a steeper slope. This continental slope usually starts at a place somewhere near the 100-fathom mark and in the course of a few hundred miles reaches the true ocean floor at 2, 500-3, 500 fathoms. The slope averages about 1 in 30, but contains steep, probably vertical, cliffs, and gentle sediment-covered terraces, and near its lower reaches there is a long tailing-off which is almost certainly the result of material transported out to deep water after being eroded from the continental masses.</p>"},{"location":"english/NCE/NCE4/#31-the-sculptor-speaks","title":"31 The Sculptor Speaks","text":"<p>Appreciation of sculpture depends upon the ability to respond to form in 3 dimensions. That is perhaps why sculpture has been described as the most difficult of all arts; certainly it is more difficult than the arts which involve appreciation of flat forms, shape in only two dimensions. Many more people are 'form-blind' than colour-blind. The child learning to see, first distinguishes only two-dimensional shape; it cannot judge distances, depths. Later, for its personal safety and practical needs, it has to develop (partly by means of touch) the ability to judge roughly 3-dimensonal distances. But having satisfied the requirements of practical necessity, most people go no further. Though they may attain considerable accuracy in the perception of flat form, they do not make the further intellectual and emotional effort needed to comprehend form in its full spatial existence. This is what the sculptor must do. He must strive continually to think of and use, form in its full spatial completeness. He gets the solid shape as it were, inside his head--he thinks of it, whatever its size, as if he were holding it completely enclosed in the hollow of his hand. He mentally visualizes a complex form from all round itself; he knows while he looks at one side what the other side is like; he identifies himself with its centre of gravity, its mass, its weight; he realizes its volume as the space that the shape displaces in the air. And the sensitive observer of sculpture must also learn to feel shape simply as shape, not as description or reminiscence. He must, for example, perceive an egg as a simple single solid shape quite apart from its significance as food, or from the literary idea that it will become a bird. And so with solids such as a shell, a nut, a plum, a pear, a tadpole, a mushroom, a mountain peak, a kidney, a carrot, a tree-trunk, a bird, a bud, a lark, a ladybird, a bulrush, a bone. From these he can go on to appreciate more complex forms or combinations of several forms.</p>"},{"location":"english/NCE/NCE4/#32-galileo-reborn","title":"32 Galileo Reborn","text":"<p>In his own lifetime Galileo was the centre of violent controversy, but the scientific dust has long since settled, and today we can see even his famous clash with the Inquisition in something like its proper perspective. But, in contrast, it is only in modern times that Galileo has become a problem child for historians of science. The old view of Galileo was delightfully uncomplicated. He was, above all, a man who experimented: who despised the prejudice and book learning of the Aristotelians, who put his questions to nature instead of to the ancients, and who drew his conclusions fearlessly. He had been the first to turn a telescope to the sky, and he had seen there evidence enough to overthrow Aristotle and Ptolemy together. He was the man who climbed the Leaning Tower of Pisa and dropped various weights from the top, who rolled balls down inclined planes, and then generalized the results of his many experiments into the famous law of free fall. But a closer study of the evidence, supported by a deeper sense of the period, and particularly by a new consciousness of the philosophical undercurrents in the scientific revolution, has profoundly modified this view of Galileo. Today, although the old Galileo lives on in many popular writings, among historians of science a new and more sophisticated picture has emerged. At the same time our sympathy for Galileo's opponents has grown somewhat. His telescopic observations are justly immortal; they aroused great interest at the time, they had important theoretical consequences, and they provided a striking demonstration of the potentialities hidden in instruments and apparatus. But can we blame those who looked and failed to see what Galileo saw, if we remember that to use a telescope at the limit of its powers calls for long experience and intimate familiarity with one's instrument? Was the philosopher who refused to look through Galileo's telescope more culpable than those who alleged that the spiral nebulae observed with Lord Rosse's great telescope in the 1840s were scratches left by the grinder? We can perhaps forgive those who said the moons of Jupiter were produced by Galileo's spyglass if we recall that in his day, as for centuries before, curved glass was the popular contrivance for producing not truth but illusion, untruth; and if a single curved glass would distort nature, how much more would a pair of them?</p>"},{"location":"english/NCE/NCE4/#33-education","title":"33 Education","text":"<p>Education is one of the key words of our time. A man without an education, many of us believe, is an unfortunate victim of adverse circumstances, deprived of one of the greatest twentieth-century opportunities. Convinced of the importance of education, modern states 'invest' in institutions of learning to get back 'interest' in the form of a large group of enlightened young men and women who are potential leaders. Education, with its cycles of instruction so carefully worked out, punctuated by textbooks--those purchasable wells of wisdom--what would civilization be like without its benefits? So much is certain: that we would have doctors and preachers, lawyers and defendants marriages and births--but our spiritual outlook would be different. We would lay less stress on 'facts and figures' and more on a good memory, on applied psychology, and on the capacity of a man to get along with his fellow-citizens. If our educational system were fashioned after its bookless past we would have the most democratic form of 'college' imaginable. Among tribal people all knowledge inherited by tradition is shared by all; it is taught to every member of the tribe so that in this respect everybody is equally equipped for life. It is the ideal condition of the 'equal start' which only our most progressive forms of modern education try to regain. In primitive cultures the obligation to seek and to receive the traditional instruction is binding to all. There are no'illiterates' --if the term can be applied to peoples without a script--while our own compulsory school attendance became law in Germany in 1642, in France in 1806, and in England in 1876 and is still nonexistent in a number of 'civilized' nations. This shows how long it was before we deemed it necessary to make sure that all our children could share in the knowledge accumulated by the 'happy few' during the past centuries. Education in the wilderness is not a matter of monetary means. All are entitled to an equal start. There is none of the hurry which, in our society, often hampers the full development of a growing personality. There, a child grows up under the everpresent attention of his parents; therefore the jungles and the savannahs know of no 'juvenile delinquency'. No necessity of making a living away from home results in neglect of children, and no father is confronted with his inability to 'buy' an education for his child.</p>"},{"location":"english/NCE/NCE4/#34-adolescence","title":"34 Adolescence","text":"<p>Parents are often upset when their children praise the homes of their friends and regard it as a slur on their own cooking, or cleaning, or furniture, and often are foolish enough to let the adolescents see that they are annoyed. They may even accuse them of disloyalty, or make some spiteful remark about the friends' parents. Such a loss of dignity and descent into childish behaviour on the part of the adults deeply shocks the adolescents, and makes them resolve that in future they will not talk to their parents about the places or people they visit. Before very long the parents will be complaining that the child is so secretive and never tells them anything, but they seldom realize that they have brought this on themselves. Disillusionment with the parents, however good and adequate they may be both as parents and as individuals, is to some degree inevitable. Most children have such a high ideal of their parents, unless the parents themselves have been unsatisfactory, that it can hardly hope to stand up to a realistic evaluation. Parents would be greatly surprised and deeply touched if they realized how much belief their children usually have in their character and infallibility, and how much this faith means to a child. If parents were prepared for this adolescent reaction, and realized that was a sign that the child was growing up and developing valuable powers of observation and independent judgment, they would not be so hurt, and therefore would not drive the child into opposition by resenting and resisting it. The adolescent, with his passion for sincerity, always respects a parent who admits that he is wrong, or ignorant, or even that he has been unfair or unjust. What the child cannot forgive is the parents' refusal to admit these charges if the child knows them to be true. Victorian parents believed that they kept their dignity by retreating behind an unreasoning authoritarian attitude in fact they did nothing of the kind, but children were then too cowed to let them know how they really felt. Today we tend to go to the other extreme, but on the whole this is a healthier attitude both for the child and the parent. It is always wiser and safer to face up to reality, however painful it may be at the moment.</p>"},{"location":"english/NCE/NCE4/#35-space-odyssey","title":"35 Space Odyssey","text":"<p>The Moon is likely to become the industrial hub of the Solar System supplying the rocket fuels for its ships, easily obtainable from the lunar rocks in the form of liquid oxygen. The reason lies in its gravity. Because the Moon has only an eightieth of the Earth's mass, it requires 97% less energy to travel the quarter of a million miles from the Moon to Earth-orbit than the 200 mile-journey from Earth's surface into orbit! This may sound fantastic, but it is easily calculated. To escape from the Earth in a rocket, one must travel at seven miles per second. The comparable speed from the Moon is only 1.5 miles per second. Because the gravity on the Moon's surface is only a sixth of Earth's (remember how easily the Apollo astronauts bounded along), it takes much less energy to accelerate to that 1.5mps than it does on Earth. Moon dwellers will be able to fly in space at only three percent of the cost of similar journeys by their terrestrial cousins. Arthur C.Clark once suggested a revolutionary idea passes through three phases: 1.  'It's impossible--don't waste my time.' 2.  'It's possible, but not worth doing.' 3.  'I said it was a good idea all along.' The idea of colonising Mars--a world 160 times more distant than the Moon--will move decisively from the second phase to the third, when a significant number of people are living permanently in space. Mars has an extraordinary fascination for would-be voyagers. America, Russia and Europe are filled with enthusiasts--many of them serious and senior scientists who dream of sending people to it. Their aim is understandable. It is the one world in the Solar System that is most like the Earth. It is a world of red sandy deserts (hence its name--the Red Planet), cloudless skies, savage sandstorms, chasms wider than the Grand Canyon and at least one mountain more than twice as tall as Everest. It seems ideal for settlement.</p>"},{"location":"english/NCE/NCE4/#36-the-cost-of-government","title":"36 The Cost of Government","text":"<p>If a nation is essentialy disunited, it is left to the government to hold it together. This increases the expense of government, and reduces correspondingly the amount of economic resources that could be used for developing the country. And it should not be forgotten how small those resources are in a poor and backward country. Where the cost of government is high, resources for development are correspondingly low. This may be illustrated by comparing the position of a nation with that of a private business enterprise. An enterprise has to incur certain costs and expenses in order to stay in business. For our purposes, we are concerned only with one kind of cost--the cost of managing and administering the business. Such administrative overheads in a business are analogous to the cost of government in a nation. The administrative overheads of a business are low to the extent that everyone working in the business can be trusted to behave in a way that best promotes the interests of the firm. If they can each be trusted to take such responsibilities, and to exercise such initiative as falls within their sphere, then administrative overheads will be low. It will be low because it will be necessary to have only one man looking after each job without having another man to check upon what he is doing, keep him in line, and report on him to someone else. But if no one can be trusted to act in a loyal and responsible manner towards his job, then the business will require armies of administrators, checkers and foremen and administrative overheads will rise correspondingly. As administrative overheads rise, so the earnings of the business after meeting the expense of administration, will fall; and the business will have less money to distribute as dividends or invest directly in its future progress and development. It is precisely the same with a nation. To the extent that the people can be relied on to behave in a loyal and responsible manner, the government does not require armies of police and civil servants to keep them in order. But if a nation is disunited, the government cannot be sure that the actions of the people will be in the interests of the nation; and it will have to watch, check, and control the people accordingly. A disunited nation therefore has to incur unduly high costs of government.</p>"},{"location":"english/NCE/NCE4/#37-the-process-of-ageing","title":"37 The Process of Ageing","text":"<p>At the age of twelve years, the human body is at its most vigorous. It has yet to reach its full size and strength, and its owner his or her full intelligence: but at this age the likelihood of death is least. Earlier, we were infants and young children, and consequently more vulnerable; later, we shall undergo a progressive loss of our vigour and resistance which, though imperceptible at first will finally become so steep that we can live no longer, however well we look after ourselves, and however well society, and our doctors, look after us. This decline in vigour with the passing of time is called ageing. It is one of the most unpleasant discoveries which we all make that we must decline in this way, that if we escape wars, accidents and diseases we shall eventually 'die of old age', and that this happens at a rate which differs little from person to person, so that there are heavy odds in favour of our dying between the ages of 65 and 80. Some of us will die sooner, a few will live longer -- on into a ninth or tenth decade. But the chances are against it, and there is a virtual limit on how long we can hope to remain alive, however lucky and robust we are. Normal people tend to forget this process unless and until they are reminded of it. We are so familiar with the fact that man ages, that people have for years assumed that the process of losing vigour with time, of becoming more likely to die the older we get, was something self-evident like the cooling of a hot kettle or the wearing-out of a pair of shoes. They have also assumed that all animals, and probably other organisms such as trees, or even the universe itself, must in the nature of things 'wear out'. Most animals we commonly observe do in fact age as we do, if given the chance to live long enough; and mechanical systems like a wound watch, or the sun, do in fact run out of energy in accordance with the second law of thermodynamics (whether the whole universe does so is a moot point at present). But these are not analogous to what happens when man ages. A run-down watch is still a watch and can be rewound. An old watch, by contrast, becomes so worn and unreliable that it eventually is not worth mending. But a watch could never repair itself--it does not consist of living parts, only of metal, which wears away by friction. We could, at one time, repair ourselves--well enough, at least, to overcome all but the most instantly fatal illnesses and accidents. Between twelve and eighty years we gradually lose this power; an illness which at 12 would knock us over, at 80 can knock us out, and into our grave. If we could stay as vigorous as we are at twelve, it would take about 700 years for half of us to die, and another 700 for the survivors to be reduced by half again.</p>"},{"location":"english/NCE/NCE4/#38-water-and-the-traveller","title":"38 Water and the Traveller","text":"<p>Contamination of water supplies is usually due to poor sanitation close to water sources, sewage disposal into the sources themselves, leakage of sewage into distribution systems or contamination with industrial or farm waste. Even if a piped water supply is safe at its source, it is not always safe by the time it reaches the tap. Intermittent tap-water supplies should be regarded as particularly suspect. Travellers on short trips to areas with water supplies of uncertain quality should avoid drinking tap-water, or untreated water from any other source. It is best to keep to hot drinks, bottled or canned drinks of well-known brand names-international standard of water treatment are usually followed at bottling plants. Carbonated drinks are acidic, and slightly safer. Make sure that all bottles are opened in your presence, and that their rims are clean and dry. Boiling is always a good way of treating water. Some hotels supply boiled water on request and this can be used for drinking, or for brushing teeth. Portable boiling elements that can boil small quantities of water are useful when the right voltage of electricity is available. Refuse politely any cold drink from an unknown source. Ice is only as safe as the water from which it is made, and should not be put in drinks unless it is known to be safe. Drinks can be cooled by placing them on ice rather than adding ice to them. Alcohol may be a medical disinfectant, but should not be relied upon to sterilize water. Ethanol is more effective at a concentration of 50-70 percent; below 20 per cent, its bactericidal action is negligible. Spirits labelled 95 proof contain only about 47 per cent alcohol. Beware of methylated alcohol, which is very poisonous and should never be added to drinking water. If no other safe water supply can be obtained, tap water that is too hot to touch can be left to cool and is generally safe to drink. Those planning a trip to remote areas, or intending to live in countries where drinking water is not readily available, should know about the various possible methods for making water safe.</p>"},{"location":"english/NCE/NCE4/#39-what-every-writer-wants","title":"39 What Every Writer Wants","text":"<p>I have known very few writers, but those I have known and whom I respect, confess at once that they have little idea where they are going when they first set pen to paper. They have a character, perhaps two; they are in that condition of eager discomfort which passes for inspiration all admit radical changes of destination once the journey has begun; one, to my certain knowledge, spent nine months on a novel about Kashmir, then reset the whole thing in the Scottish Highlands. I never heard of anyone making a 'skeleton', as we were taught at school. In the breaking and remaking, in the timing interweaving, beginning afresh, the writer comes to discern things in his material which were not consciously in his mind when he began. This organic process, often leading to moments of extraordinary self-discovery, is of an indescribable fascination. A blurred image appears; he adds a brushstroke and another and it is gone but something was there, and he will not rest till he has captured it. Sometimes the yeast within a writer outlives a book he has written. I have heard of writers who read nothing but their own books; like adolescents they stand before the mirror, and still cannot fathom the exact outline of the vision before them. For the same reason, writers talk interminably about their own books, winkling out hidden meanings, super-imposing new ones, begging response from those around them. Of course a writer doing this is misunderstood: he might as well try to explain a crime or a love affair. He is also, incidentally, an unforgivable bore. This temptation to cover the distance between himself and the reader, to study his image in the sight of those who do not know him, can be his undoing: he has begun to write to please. A young English writer made the pertinent observation a year or two back that the talent goes into the first draft, and the art into the drafts that follow. For this reason also the writer, like any other artist, has no resting place, no crowd or movement in which he may take comfort, no judgment from outside which can replace the judgment from within. A writer makes order out of the anarchy of his heart; he submits himself to a more ruthless discipline than any critic dreamed of, and when he flirts with fame, he is taking time off from living with himself, from the search for what his world contains at its inmost point.</p>"},{"location":"english/NCE/NCE4/#40-waves","title":"40 Waves","text":"<p>Waves are the children of the struggle between ocean and atmosphere, the ongoing signatures of infinity. Rays from the sun excite and energize the atmosphere of the earth, awakening it to flow, to movement, to rhythm, to life. The wind then speaks the message of the sun to the sea and the sea transmits it on through waves--an ancient, exquisite powerful message. These ocean waves are among the earth's most complicated natural phenomena. The basic features include a crest (the highest point of the wave), a trough (the lowest point), a height (the vertical distance from the trough to the crest), a wave length (the horizontal distance between two wave crests), and a period (which is the time it takes awave crest to travel one wave length). Although an ocean wave gives the impression of a wall of water moving in your direction, in actuality waves move through the water leaving the water about where it was. If the water was moving with the wave, the ocean and everything on it would be racing in to the shore with obviously catastrophic results. An ocean wave passing through deep water causes a particle on the surface to move in a roughly circular orbit, drawing the particle first towards the advancing wave, then up into the wave, then forward with it and then--as the wave leaves the particles behind--back to its starting point again. From both maturity to death, a wave is subject to the same laws as any other 'living' thing. For a time it assumes a miraculous individuality that, in the end, is reabsorbed into the great ocean of life. The undulating waves of the open sea are generated by three natural causes: wind, earth movements or tremors, and the gravitational pull of the moon and the sun. Once waves have been generated, gravity is the force that drives them in a continual attempt to restore the ocean surface to a flat plain.</p>"},{"location":"english/NCE/NCE4/#41-training-elephants","title":"41 Training Elephants","text":"<p>Two main techniques have been used for training elephants, which we may call respectively the tough and the gentle. The former method simply consists of setting an elephant to work and beating him until he does what is expected of him. Apart from any moral considerations this is a stupid method of training, for it produces a resentful animal who at a later stage may well turn man-killer. The gentle method requires more patience in the early stages, but produce a cheerful good-tempered elephant who will give many years of loyal service. The first essential in elephant training is to assign to the animal a single mahout who will be entirely responsible for the job. Elephants like to have one master just as dogs do, and are capable of a considerable degree of personal affection. There are even stories of half-trained elephant calves who have refused to feed and pined to death when by some unavoidable circumstance they have been deprived of their own trainer. Such extreme cases must probably be taken with a grain of salt, but they do underline the general principle that the relationship between elephant and mahout is the key to successful training. The most economical age to capture an elephant for training is between 15 and 20 years, for it is then almost ready to undertake heavy work and can begin to earn its keep straight away. But animals of this age do not easily become subservient to man, and a very firm hand must be employed in the early stages. The captive elephant, still roped to a tree, plunges and screams every time a man approaches, and for several days will probably refuse all food through anger and fear. Sometimes a tame elephant is tethered nearby to give the wild one confidence, and in most cases the captive gradually quietens down and begins to accept its food. The next stage is to get the elephant to the training establishment, a ticklish business which is achieved with the aid of two tame elephants roped to the captive on either side. When several elephants are being trained at one time, it is customary for the new arrival to be placed between the stalls of two captives whose training is already well advanced. It is then left completely undisturbed with plenty of food and water so that it can absorb the atmosphere of its new home and see that nothing particularly alarming is happening to its companions. When it is eating normally, its own training begins. The trainer stands in front of the elephant holding a long stick with a sharp metal point. Two assistants, mounted on tame elephants, control the captive from either side, while others rub their hands over his skin to the accompaniment of a monotonous and soothing chant. This is supposed to induce pleasurable sensations in the elephant, and its effects are reinforced by the use of endearing epithets, such as 'ho! my son', or 'ho! my father', or 'my mother', according to the age and sex of the captive. The elephant is not immediately susceptible to such blandishments, however, and usually lashes fiercely with its trunk in all directions. These movements are controlled by the trainer with the metal-pointed stick, and the trunk eventually becomes so sore that the elephant curls it up and seldom afterwards uses it for offensive purposes.</p>"},{"location":"english/NCE/NCE4/#42-recording-an-earthquake","title":"42 Recording an Earthquake","text":"<p>An earthquake comes like a thief in the night, without warning. It was necessary, therefore, to invent instruments that neither slumbered nor slept. Some devices were quite simple. One, for instance, consisted of rods of various lengths and thicknesses which would stand up on end like ninepins. When a shock came, it shook the rigid table upon which these stood. If it were gentle, only the more unstable rods fell. If it were severe, they all fell. Thus the rods, by falling, and by the direction in which they fell, recorded for the slumbering scientist the strength of a shock that was too weak to waken him, and the direction from which it came. But instruments far more delicate than that were needed if any really serious advance was to be made. The ideal to be aimed at was to devise an instrument that could record with a pen on paper, the movements of the ground or of the table as the quake passed by. While I write my pen moves, but the paper keeps still. With practice, no doubt, I could in time learn to write by holding the pen still while the paper moved. That sounds a silly suggestion, but that was precisely the idea adopted in some of the early instruments (seismometers) for recording earthquake waves. But when table, penholder and paper are all moving, how is it possible to write legibly? The key to a solution of that problem lay in an everyday observation. Why does a person standing in a bus or train tend to fall when a sudden start is made? It is because his feet move on, but his head stays still. A simple experiment will help us a little further. Tie a heavy weight at the end of a long piece of string. With the hand held high in the air, hold the string so that the weight nearly touches the ground. Now move the hand to and fro and around but not up and down. It will be found that the weight moves but slightly or not at all. Imagine a pen attached to the weight in such a way that its point rests upon a piece of paper on the floor. Imagine an earthquake shock shaking the floor, the paper, you and your hand. In the midst of all this movement, the weight and the pen would be still. But as the paper moved from side to side under the pen point, its movement would be recorded in ink upon its surface. It was upon this principle that the first instruments were made, but the paper was wrapped round a drum which rotated slowly. As long as all was still, the pen drew a straight line, but while the drum was being shaken, the line that the pen was drawing wriggled from side to side. The apparatus thus described, however, records only the horizontal component of the wave movement, which is, in fact, much more complicated. If we could actually see the path described by a particle, such as a sand grain in the rock, it would be more like that of a bluebottle buzzing round the room; it would be up and down, to and fro and from side to side. Instruments have been devised and can be so placed that all three elements can be recorded in different graphs. When the instrument is situated at more than 700 miles from the earthquake centre, the graphic record shows three waves arriving one after the other at short intervals. The first records the arrival of longitudinal vibrations. The second marks the arrival of transverse vibrations which travel more slowly and arrive several minutes after the first. These two have travelled through the earth. It was from the study of these that so much was learnt about the interior of the earth. The third, or main wave is the slowest and has travelled round the earth through the surface rocks.</p>"},{"location":"english/NCE/NCE4/#43-are-there-strangers-in-space","title":"43 Are There Strangers in Space","text":"<p>We must conclude from the work of those who have studied the origin of life, that given a planet only approximately like our own, life is almost certain to start. Of all the planets in our solar system, we are now pretty certain the Earth is the only one on which life can survive. Mars is too dry and poor in oxygen, Venus far too hot, and so is Mercury, and the outer planets have temperatures near absolute zero and hydrogen-dominated atmospheres. But other suns, start as the astronomers call them, are bound to have planets like our own, and as is the number of stars in the universe is so vast, this possibility becomes virtual certainty. There are one hundred thousand million starts in our own Milky Way alone, and then there are three thousand million other milky ways or galaxies, in the universe. so the number of stars that we know exist is now estimated at about 300 million million million. Although perhaps only 1 percent of the life that has started somewhere will develop into highly complex and intelligent patterns, so vast is the number of planets, that intelligent life is bound to be a natural part of the universe. If then we are so certain that other intelligent life exists in the universe, why have we had no visitors from outer space yet? First of all, they may have come to this planet of ours thousands or millions of years ago, and found our then prevailing primitive state completely uninteresting to their own advanced knowledge. Professor Ronald Bracewell, a leading American radio astronomer, argued in Nature that such a superior civilization, on a visit to our own solar system, may have left an automatic messenger behind to await the possible awakening of an advanced civilization. Such a messenger, receiving our radio and television signals, might well re-transmit them back to its home-planet, although what impression any other civilization would thus get from us is best left unsaid. But here we come up against the most difficult of all obstacles to contact with people on other planets -- the astronomical distances which separate us. As a reasonable guess, they might, on an average, be 100 light years away. (A light year is the distance which light travels at 186, 000 miles per second in one year, namely 6 million million miles.) Radio waves also travel at the speed of light, and assuming such an automatic messenger picked up our first broadcasts of the 1920's, the message to its home planet is barely halfway there. Similarly, our own present primitive chemical rockets, though good enough to orbit men, have no chance of transporting us to the nearest other star, four light years away, let alone distances of tens or hundreds of light years. Fortunately, there is a 'uniquely rational way' for us to communicate with other intelligent beings, as Walter Sullivan has put it in his excellent book, We Are not Alone. This depends on the precise radio frequency of the 21-cm wavelength, or 1420 megacycles per second. It is the natural frequency of emission of the hydrogen atoms in space and was discovered by us in 1951; it must be known to any kind of radio astronomer in the universe. Once the existence of this wave-length had been discovered, it was not long before its use as the uniquely recognizable broadcasting frequency for interstellar communication was suggested. Without something of this kind, searching for intelligences on other planets would be like trying to meet a friend in London without a pre-arranged rendezvous and absurdly wandering the streets in the hope of a chance encounter.</p>"},{"location":"english/NCE/NCE4/#44-patterns-of-culture","title":"44 Patterns of Culture","text":"<p>Custom has not commonly been regarded as a subject of any great moment. The inner workings of our own brains we feel to be uniquely worthy of investigation, but custom, we have a way of thinking, is behaviour at is most commonplace. As a matter of fact, it is the other way around. Traditional custom, taken the world over, is a mass of detailed behaviour more astonishing than what any one person can ever evolve in individual actions, no matter how aberrant. Yet that is a rather trivial aspect of the matter. The fact of first-rate importance is the predominant role that custom plays in experience and in belief, and the very great varieties it may manifest. No man ever looks at the world with pristine eyes. He sees it edited by a definite set of customs and institutions and ways of thinking. Even in his philosophical probings he cannot go behind these stereotypes; his very concepts of the true and the false will still have reference to his particular traditional customs. John Dewey has said in all seriousness that the part played by custom in shaping the behaviour of the individual, as against any way in which he can affect traditional custom, is as the proportion of the total vocabulary of his mother tongue against those words of his own baby talk that are taken up into the vernacular of his family. When one seriously studies the social orders that have had the opportunity to develop autonomously, the figure becomes no more than an exact and matter-of-fact observation. The life history of the individual is first and foremost an accommodation to the patterns and standards traditionally handed down in his community. From the moment of his birth, the customs into which he is born shape his experience and behaviour. By the time he can talk, he is the little creature of his culture, and by the time he is grown and able to take part in its activities, its habits are his habits, its beliefs his beliefs, its impossibilities his impossibilities. Every child that is born into his group will share them with him, and no child born into one on the opposite side of the globe can ever achieve the thousandth part. There is no social problem it is more incumbent upon us to understand than this of the role of custom. Until we are intelligent as to its laws and varieties, the main complicating facts of human life must remain unintelligible. The study of custom can be profitable only after certain preliminary propositions have been accepted, and some of these propositions have been violently opposed. In the first place, any scientific study requires that there be no preferential weighting of one or another of the items in the series it selects for its consideration. In all the less controversial fields, like the study of cacti or termites or the nature of nebulae, the necessary method of study is to group the relevant material and to take note of all possible variant forms and conditions. In this way, we have learned all that we know of the laws of astronomy, or of the habits of the social insects, let us say. It is only in the study of man himself that the major social sciences have substituted the study of one local variation, that of Western civilization. Anthropology was by definition impossible, as long as these distinctions between ourselves and the primitive, ourselves and the barbarian, ourselves and the pagan, held sway over people's minds. It was necessary first to arrive at that degree of sophistication where we no longer set our own belief against our neighbour's superstition. It was necessary to recognize that these institutions which are based on the same premises, let us say the supernatural, must be considered together, our own among the rest.</p>"},{"location":"english/NCE/NCE4/#45-of-men-and-galaxies","title":"45 Of Men and Galaxies","text":"<p>In man's early days, competition with other creatures must have been critical. But this phase of our development is now finished. Indeed, we lack practice and experience nowadays in dealing with primitive conditions. I am sure that, without modern weapons, I would make a very poor show of disputing the ownership of a cave with a bear, and in this I do not think that I stand alone. The last creature to compete with man was the mosquito. But even the mosquito has been subdued by attention to drainage and by chemical sprays. Competition between ourselves, person against person, community against community, still persists, however; and it is as fierce as it ever was. But the competition of man against man is not the simple process envisioned in biology. It is not a simple competition for a fixed amount of food determined by the physical environment, because the environment that determines our evolution is no longer essentially physical. Our environment is chiefly conditoned by the things we believe. Morocco and California are bits of the Earth in very similar latitudes, both on the west coasts of continents with similar climates, and probably with rather similar natural resources. Yet their present development is wholly different, not so much because of different people even, but because of the different thoughts that exist in the minds of their inhabitants. This is the point I wish to emphasize. The most important factor in our environment is the state of our own minds. It is well known that where the white man has invaded a primitive culture, the most destructive effects have come not from physical weapons but from ideas. Ideas are dangerous. The Holy Office knew this full well when it caused heretics to be burned in days gone by. Indeed, the concept of free speech only exists in our modern society because when you are inside a community, you are conditioned by the conventions of the community to such a degree that it is very difficult to conceive of anything really destructive. It is only someone looking on from outside that can inject the dangerous thoughts. I do not doubt that it would be possible to inject ideas into the modern world that would utterly destroy us. I would like to give you an example, but fortunately I cannot do so. Perhaps it will suffice to mention the nuclear bomb. Imagine the effect on a reasonably advanced technological society, one that still does not possess the bomb, of making it aware of the possibility, of supplying suffcient details to enable the thing to be constructed. 20 or 30 pages of information handed to any of the major world powers around the year 1925, would have been sufficient to change the course of world history. It is a strange thought, but I believe a correct one, that twenty or thirty pages of ideas and information would be capable of turning the present-day world upside down, or even destroying it. I have often tried to conceive of what those pages might contain, but of course I cannot do so because I am a prisoner of the present-day world, just as all of you are. We cannot think outside the particular patterns that our brains are conditioned to, or, to be more accurate we can think only a very little way outside and then only if we are very original.</p>"},{"location":"english/NCE/NCE4/#46-hobbies","title":"46 Hobbies","text":"<p>A gifted American psychologist has said, 'Worry is a spasm of the emotion; the mind catches hold of something and will not let it go.' It is useless to argue with the mind in this condition. The stronger the will, the more futile the task. One can only gently insinuate something else into its convulsive grasp. And if this something else is rightly chosen, if it is really attended by the illumination of another field of interest, gradually, and often quite swiftly, the old undue grip relaxes and the process of recuperation and repair begins. The cultivation of a hobby and new forms of interest is therefore a policy of the first importance to a public man. But this is not a business that can be undertaken in a day or swiftly improvised by a mere command of the will. The growth of alternative mental interests is a long process. The seeds must be carefully chosen; they must fall on good ground; they must be sedulously tended, if the vivifying fruits are to be at hand when needed. To be really happy and really safe, one ought to have at least two or three hobbies, and they must all be real. It is no use starting late in life to say: 'I will take an interest in this or that.' Such an attempt only aggravates the strain of mental effort. A man may acquire great knowledge of topics unconnected with his daily work, and yet get hardly any benefit or relief. It is no use doing what you like; you have got to like what you do. Broadly speaking, human beings may be divided into three classes: those who are toiled to death, those who are worried to death, and those who are bored to death. It is no use offering the manual labourer, tired out with a hard week's sweat and effort the chance of playing a game of football or baseball on Saturday afternoon. It is no use inviting the politician or the professional or business man, who has been working or worrying about serious things for six days, to work or worry about trifling things at the weekend. As for the unfortunate people who can command everything they want, who can gratify every caprice and lay their hands on almost every object of desire--for them a new pleasure a new excitement is only an additional satiation. In vain they rush frantically round from place to place, trying to escape from avenging boredom by mere clatter and motion. For them discipline in one form or another is the most hopeful path. It may also be said that rational, industrious, useful human beings are divided into two classes: first, those whose work is work and whose pleasure is pleasure; and secondly, those whose work and pleasure are one. Of these the former are the majority. They have their compensations. The long hours in the office or the factory bring with them as their reward, not only the means of sustenance, but a keen appetite for pleasure even in its simplest and most modest forms. But Fortune's favoured children belong to the second class. Their life is a natural harmony. For them the working hours are never long enough. Each day is a holiday, and ordinary holidays, when they come, are grudged as enforced interruptions in an absorbing vocation. Yet to both classes, the need of an alternative outlook, of a change of atmosphere of a diversion of effort, is essential. Indeed, it may well be that those whose work is their pleasure are those who most need the means of banishing it at intervals from their minds.</p>"},{"location":"english/NCE/NCE4/#47-the-great-escape","title":"47 The Great Escape","text":"<p>Economy is one powerful motive for camping, since after the initial outlay upon equipment, or through hiring it, the total expense can be far less than the cost of hotels. But, contrary to a popular assumption, it is far from being the only one, or even the greatest. The man who manoeuvres carelessly into his 20 pounds' worth of space at one of Europe's myriad permanent sites may find himself bumping a Bentley. More likely, Ford Escort will be hub to hub with Renault or Mercedes, but rarely with bicycles made for two. That the equipment of modern camping becomes yearly more sophisticated is an entertaining paradox for the cynic, a brighter promise for the hopeful traveller who has sworn to get away from it all. It also provides--and some student sociologist might care to base his thesis upon the phenomenon--an escape of another kind. The modern traveller is often a man who dislikes the Splendide and the Bellavista, not because he cannot afford, or shuns their material comforts, but because he is afraid of them. Affluent he may be, but he is by no means sure what to tip the doorman or the chambermaid. Master in his own house he has little idea of when to say boo to a manager hotel. From all such fears camping releases him. Granted, a snobbery of camping itself, based upon equipment and techniques, already exists; but it is of a kind that, if he meets it, he can readily understand and deal with. There is no superior 'they' in the shape of managements and hotel hierarchies to darken his holiday days. To such motives, yet another must be added. The contemporary phenomenon of car worship is to be explained not least by the sense of independence and freedom that ownership entails. To this pleasure camping gives an exquisite refinement. From one's own front door to home or foreign hills or sands and back again, everything is to hand. Not only are the means of arriving at the holiday paradise entirely within one's own command and keeping, but the means of escape from holiday hell (if the beach proves too crowded, the local weather too inclement) are there, outside--or, as likely, part of--the tent. Idealists have objected to the practice of camping, as to the package tour, that the traveller abroad thereby denies himself the opportunity of getting to know the people of the country visited. Insularity and self-containment, it is argued, go hand in hand. The opinion does not survive experience of a popular Continental camping place. Holiday hotels tend to cater for one nationality of visitors especially, sometimes exclusively. Camping sites, by contrast, are highly cosmopolitan. Granted, a preponderance of Germans is a characteristic that seems common to most Mediterranean sites; but as yet there is no overwhelmingly specialized patronage. Notices forbidding the open-air drying of clothes, or the use of water points for car washing, or those inviting 'our camping friends' to a dance or a boat trip are printed not only in French or Italian or Spanish, but also in English, German and Dutch. At meal times the odour of sauerkraut vies with that of garlic. The Frenchman's breakfast coffee competes with the Englishman's bacon and eggs. Whether the remarkable growth of organized camping means the eventual death of the more independent kind is hard to say. Municipalities naturally want to secure the campers' site fees and other custom. Police are wary of itinerants who cannot be traced to a recognized camp boundary or to four walls. But most probably it will all depend upon campers themselves: how many heath fires they cause; how much litter they leave; in short, whether or not they wholly alienate landowners and those who live in the countryside. Only good scouting is likely to preserve the freedoms so dear to the heart of the eternal Boy Scout.</p>"},{"location":"english/NCE/NCE4/#48-planning-a-share-portfolio","title":"48 Planning a Share Portfolio","text":"<p>There is no shortage of tipsters around offering 'get-rich-quick' opportunities. But if you are a serious private investor, leave the Las Vegas mentality to those with money to fritter. The serious investor needs a proper 'portfolio' --a well-planned selection of investments, with a definite structure and a clear aim. But exactly how does a newcomer to the stock market go about achieving that? Well, if you go to five reputable stock brokers and ask them what you should do with your money, you're likely to get five different answers, --  even if you give all the relevant information about your age, family, finances and what you want from your investments. Moral? There is no one 'right' way to structure a portfolio. However, there are undoubtedly some wrong ways, and you can be sure that none of our five advisers would have suggested sinking all (or perhaps any) of your money into Periwigs. So what should you do? We'll assume that you have sorted out the basics--like mortgages, pensions, insurance and access to sufficient cash reserves. You should then establish your own individual aims. These are partly a matter of personal circumstances, partly a matter of psychology. For instance, if you are older you have less time to recover from any major losses, and you may well wish to boost your pension income. So preserving your capital and generating extra income are your main priorities. In this case, you'd probably construct a portfolio with some shares (but not high risk ones), along with gilts, cash deposits, and perhaps convertibles or the income shares of split capital investment trusts. If you are younger, and in a solid financial position, you may decide to take an aggressive approach--but only if you're blessed with a sanguine disposition and won't suffer sleepless nights over share prices. If you recognize yourself in this description, you might include a couple of heady growth stocks in your portfolio, alongside your more pedestrian investments. Once you have decided on your investment aims you can then decide where to put your money. The golden rule here is spread your risk--if you put all of your money into Periwigs International, you're setting yourself up as a hostage to fortune.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/","title":"\u4ece\u53e5","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#_1","title":"\u4e00\u3001\u5b9a\u8bed\u4ece\u53e5","text":"<p>\u5b9a\u8bed\u4ece\u53e5=\u5f62\u5bb9\u8bcd\u4ece\u53e5=\u5173\u7cfb\u4ece\u53e5</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1","title":"1. \u601d\u7ef4\u65b9\u5f0f","text":"<p>The rabbit is eating a carrot(\u5148\u884c\u8bcd) that(\u5173\u7cfb\u8bcd) I bought</p> <p>\u5728\u88ab\u4fee\u9970\u7684\u8bcd\u4e4b\u540e\uff0c\u6dfb\u52a0\u53e6\u4e00\u4e2a\u548c\u5b83\u6709\u5173\u7684\u8bcd\uff0c\u518d\u628a\u65b0\u8bcd\u653e\u5230\u53e6\u4e00\u4e2a\u53e5\u5b50\u4e2d\uff0c\u8fdb\u884c\u8865\u5145\u8bf4\u660e\u6216\u903b\u8f91\u9610\u8ff0\u3002</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2","title":"2. \u6784\u6210","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1_1","title":"1.\u5173\u7cfb\u4ee3\u8bcd","text":"<p>that/who/whom/whose/which</p> <p>The rabbit is eating a carrot that I bought. -&gt; I bought the carrot.</p> <p>The teacher who ate a carrot is a rabbit. -&gt; the rabbit ate a carrot</p> <p>The teacher whom I saw yesterday is a rabbit. -&gt; I saw the teacher yesterday.</p> <p>The teacher whose favorite food is carrot is a rabbit. -&gt; the teacher's  favorite food is carrot.</p> <p>The food which the teacher likes is carrot. -&gt; the teacher likes the food</p> <p>that vs. which</p> <ol> <li>\u5148\u884c\u8bcd\u662f\u552f\u4e00\u7684\uff1athat eg. The rabbit ate the largest carrot that I\u2018ve ever seen.</li> <li>\u5148\u884c\u8bcd\u662f\u591a\u9009\u4e00\u7684\uff1awhich eg. The rabbit ate the carrot which(that) I bought.</li> </ol>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_1","title":"2.\u5173\u7cfb\u526f\u8bcd","text":"<p>where/why/when</p> <p>This was the place where the rabbit ate the carrot.</p> <p>This is the reason thy the rabbit ate the carrot.</p> <p>That was the day when the rabbit ate the carrot for the first time.</p> <p>\u5173\u7cfb\u526f\u8bcd\u53ef\u8f6c\u6362\u4e3a\u5173\u7cfb\u4ee3\u8bcd\uff1awhere/why/when = at which/for which/on which</p> <p>\u5173\u7cfb\u526f\u8bcd = \u4ecb\u8bcd + \u5173\u7cfb\u4ee3\u8bcd</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#3","title":"3. \u9650\u5b9a\u6027\u548c\u975e\u9650\u5b9a\u6027","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1_2","title":"1. \u9650\u5b9a\u6027","text":"<p>The rabbit ate the carrot which was on the table.</p> <p>\u9650\u5b9acarrot\u7684\u8303\u56f4/\u6027\u8d28</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_2","title":"2. \u975e\u9650\u5b9a","text":"<p>The rabbit ate the carrot, which was on the table.</p> <p>The rabbit ate the carrot, the carrot was on the table.</p> <p>\u4f5c\u63d2\u5165\u8bed\uff1a</p> <p>My head, which is big, is useful when it rains.</p> <p>The biggest carrot, which the rabbit ate, was on the table.</p> <p>\u4ee3\u6307\u6574\u53e5\u8bdd\uff1a</p> <p>The rabbit ate the carrot, which was not surprising.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#_2","title":"\u4e8c\u3001 \u540d\u8bcd\u4ece\u53e5","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1_3","title":"1. \u4e3b\u8bed\u4ece\u53e5","text":"<p>The fact is obvious. </p> <p>\u53e5\u5b50\u4e3b\u8bed\u7531\u4ece\u53e5\u5145\u5f53\uff0c\u8981\u4ee5\u5f15\u5bfc\u8bcd\u5f00\u5934\u3002</p> <p>\u5f15\u5bfc\u8bcd\uff1awhere, whether, when, how, who, that, what</p> <p>That the rabbit ate a carrot is obvious.</p> <p>Where the rabbit ate a carrot is obvious.</p> <p>When the rabbit ate a carrot is obvious.</p> <p>How the rabbit ate a carrot is obvious.</p> <p>Who ate a carrot is obvious.</p> <p>What the rabbit ate is obvious.</p> <p>\u5f62\u5f0f\u4e3b\u8bedit</p> <p>It is obvious that the rabbit ate a carrot.</p> <p>It is obvious where the rabbit ate a carrot.</p> <p>It is obvious when the rabbit ate a carrot.</p> <p>It is obvious how the rabbit ate a carrot.</p> <p>It is obvious who ate a carrot.</p> <p>It is obvious what the rabbit ate.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_3","title":"2. \u5bbe\u8bed\u4ece\u53e5","text":"<p>\u5728\u6574\u4e2a\u590d\u6742\u53e5\u4e2d\u4f5c\u5bbe\u8bed\uff0c\u5305\u542b\u786e\u5b9a/\u4e0d\u786e\u5b9a\u4fe1\u606f</p> <p>I saw that the rabbit ate a carrot.</p> <p>I saw whether the rabbit ate a carrot.</p> <p>I saw where the rabbit ate a carrot.</p> <p>I saw when the rabbit ate a carrot.</p> <p>I saw how the rabbit ate a carrot.</p> <p>I saw who ate a carrot.</p> <p>I saw what the rabbit ate.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1-that","title":"1. that\u7701\u7565","text":"<p>\u5bbe\u8bed\u4ece\u53e5\u4e2d\u7684that\u5f80\u5f80\u53ef\u4ee5\u7701\u7565</p> <p>I know (that) the rabbit ate a carrot.</p> <p>\u4f46\u5f15\u5bfc\u8bcd  who, what, which, when, where, how \u4e0d\u80fd\u7701\u7565</p> <p>\u6709\u65f6that\u4e5f\u4e0d\u80fd\u7701\u7565\uff0c\u5426\u5219\u4f1a\u6709\u6b67\u4e49\u6216\u8005\u8bed\u6cd5\u9519\u8bef</p> <p>I don't know that the rabbit ate a carrot and that you saw it.</p> <p>I know, just like you do, that the rabbit ate the carrot.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_4","title":"2. \u67d0\u4e9b\u8bcd\u540e\u7684\u5bbe\u8bed\u4ece\u53e5\u7684\u5426\u5b9a","text":"<p>\u5426\u5b9a\u52a0\u5728\u8c13\u8bed\u52a8\u8bcd\u524d</p> <p>I don't think that the rabbit is smart.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#3_1","title":"3. \u4e3b\u4ece\u65f6\u6001\u4e00\u81f4","text":"<p>I don't think that you're right. </p> <p>I knew that the rabbit liked carrots.</p> <p>\u4e0d\u53d8\u7684\u5ba2\u89c2\u73b0\u8c61\u4f8b\u5916\uff1aI knew that the sun rise in the east.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#4-be-that","title":"4. be + \u5f62\u5bb9\u8bcd + that","text":"<p>I am sure that there's a carrot on the table.</p> <p>= confirm that</p> <p>I am happy that there's a carrot on the table.</p> <p>= like that</p> <p>I am afraid that there's a carrot on the table.</p> <p>= fear that</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#3_2","title":"3. \u8868\u8bed\u4ece\u53e5","text":"<p>=\u4e3b\u8bed\u8865\u8bed\u4ece\u53e5 \u7528\u4ece\u53e5\u5145\u5f53\u7cfb\u52a8\u8bcd\u540e\u7684\u8868\u8bed</p> <p>\u7cfb\u52a8\u8bcd\u662fbe\u52a8\u8bcd\uff1a</p> <p>The problem is that the rabbit is hungry.</p> <p>The reason is that there's the rabbit is hungry.</p> <p>The question is whether the rabbit is hungry.</p> <p>The question is what the rabbit should eat.</p> <p>The question is where/when/how the rabbit should eat the carrot.</p> <p>\u7cfb\u52a8\u8bcd\u975ebe\u52a8\u8bcd\uff1a</p> <p>It seems that the rabbit is hungry.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#4","title":"4. \u540c\u4f4d\u8bed\u4ece\u53e5","text":"<p>\u540c\u4f4d\u8bed\uff1a\u7528\u4e0d\u540c\u7684\u65b9\u5f0f\u628a\u4e00\u4e2a\u6982\u5ff5\u518d\u8bf4\u4e00\u904d\uff0c\u7528\u9017\u53f7\u9694\u5f00</p> <p>My teacher, Papa rabbit(\u540c\u4f4d\u8bed), likes carrots.</p> <p>\u540c\u4f4d\u8bed\u4ece\u53e5\uff1a\u4e00\u4e2a\u4ece\u53e5\u6765\u5145\u5f53\u540c\u4f4d\u8bed\uff0c\u957f\u4fee\u9970\u62bd\u8c61\u7684\u540d\u8bcd</p> <p>1.\u5305\u542b\u5df2\u77e5\u4fe1\u606f</p> <p>The fact that the rabbit ate a rabbit did not surprise me.</p> <p>2.\u5305\u542b\u672a\u77e5\u4fe1\u606f</p> <p>The question whether the rabbit will eat the carrot is on all our mind.</p> <p>I have no idea who ate the carrot.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#5","title":"5. \u5bbe\u8bed\u8865\u8bed\u4ece\u53e5","text":"<p>You can call me what you like.</p> <p>My education made me who I am today.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#_3","title":"\u4e09\u3001\u526f\u8bcd\u4ece\u53e5\uff08\u72b6\u8bed\u4ece\u53e5\uff09","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1_4","title":"1. \u65f6\u95f4\u526f\u8bcd\u4ece\u53e5","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1_5","title":"1. \u5728\u67d0\u4e00\u65f6\u95f4\u4e4b\u524d","text":"<p>The rabbit ate a carrot at home before the wolf stopped by.</p> <p>Before the wolf stopped by, the rabbit ate a carrot at home.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_5","title":"2. \u5728\u67d0\u4e00\u65f6\u95f4\u4e4b\u4e2d\uff08\u5f53\u65f6\uff09","text":"<p>The rabbit was eating a carrot when I reached home.</p> <p>The rabbit was eating a carrot while I was making a video.</p> <p>I ate a carrot as I made a video.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#3_3","title":"3. \u5728\u67d0\u4e00\u65f6\u95f4\u70b9\u4e4b\u540e","text":"<p>The rabbit ate a carrot after the wolf stopped by.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#4_1","title":"4. \u4ece\u4e4b\u524d\u67d0\u4e00\u65f6\u95f4\u70b9\u5f00\u59cb\u7b97","text":"<p>The rabbit has shared 3 carrots since the wolf stopped by.</p> <p>The rabbit has not stopped sharing carrots since the wolf stopped by.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#5_1","title":"5. \u76f4\u5230\u4e4b\u540e\u7684\u67d0\u4e00\u65f6\u95f4\u70b9","text":"<p>The rabbit waited until the wolf stopped by.</p> <p>The rabbit didn't eat any carrot until the wolf stopped by.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#6","title":"6. \u4e00...\u5c31...","text":"<p>The rabbit will eat a carrot as soon as the wolf leaves.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#7","title":"7. \u4e0b\u6b21","text":"<p>The rabbot will share the biggest carrot the next time the wolf stops by.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_6","title":"2. \u5730\u70b9\u526f\u8bcd\u4ece\u53e5","text":"<p>The rabbit ate the carrot where he found it.</p> <p>The rabbit will go where he can find a carrot.</p> <p>The rabbit will go wherever he can find a carrot.</p> <p>where\u5f3a\u8c03\u5f62\u5f0f\uff1awherever, everywhere, anywhere</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#3_4","title":"3. \u6bd4\u8f83\u526f\u8bcd\u4ece\u53e5","text":""},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#1_6","title":"1. \u66f4...","text":"<p>He is  smarter than I am.</p> <p>This carrot is bigger than that one is.</p> <p>She is more beautiful than Snow White is.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#2_7","title":"2. \u540c\u6837\u7684...","text":"<p>He is as smart as I am.</p> <p>This carrot is as big as that on is.</p> <p>She is as beautiful as Snow White is.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#3_5","title":"3. \u8d8a...\u8d8a...","text":"<p>The more  you practice English, the more fluent you become.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#4_2","title":"4. \u6761\u4ef6\u526f\u8bcd\u4ece\u53e5","text":"<p>If the rabbit sees a carrot, he will eat it.</p> <p>\u4ece\u53e5\uff1a\u4e00\u822c\u73b0\u5728\u65f6\uff0c\u4e3b\u8bed\uff1a\u4e00\u822c\u5c06\u6765\u65f6</p> <p>If + \u771f\u5b9e\u7684\u5047\u8bbe\uff0c\u533a\u522b\u4e0e\u865a\u62df\u8bed\u6c14\u4e2d\u7684\u865a\u62df\u6761\u4ef6\u53e5\uff1a</p> <p>If I saw a carrot, I would eat it.</p> <p>If I had seen a carrot, I would have eaten it.</p> <p>\u4e3b\u5c06\u4ece\u73b0</p> <p>\u73b0\uff1a\u4e00\u822c\u73b0\u5728\u65f6\u6001\uff0c\u5f3a\u8c03\u4e00\u822c\u72b6\u6001\uff0c\u548c\u201c\u73b0\u5728\u201d\u6ca1\u5565\u5173\u7cfb\uff0c</p> <p>\u4e00\u822c\u72b6\u6001\uff1a\u7b80\u5355\u7684\uff0c\u9ed8\u8ba4\u7684\uff0c\u666e\u901a\u7684\u72b6\u6001\uff0c\u5982\uff1a</p> <p>Rabbits eat carrots. \u4e60\u60ef</p> <p>The sun rises in the east. \u5ba2\u89c2\u4e8b\u5b9e</p> <p>\u5c06\u6765\u65f6\u6001\u662f\u6307\u975e\u5e38\u786e\u5b9a\u4f1a\u53d1\u751f\u7684\u4e8b\uff0c\u5982\uff1aI will eat the carrot.</p> <p>\u6761\u4ef6\u53e5\u4ece\u4e8b\u6bd4\u4e3b\u53e5\u5728\u65f6\u6001\u4e0a\u843d\u540e\u4e00\u4e2a\u65f6\u95f4\u6bb5\uff0c\u4e5f\u53ef\u5e94\u7528\u4e8e\u865a\u62df\u8bed\u6c14\u3002If I saw a carrot, I would eat it.</p> <p>\u5f15\u5bfc\u8bcd</p> <p>If you like this video, you will give it a thumbs-up.</p> <p>If you don't like this video, you will not give it a thumbs-up.</p> <p>Unless you like this video, you will not give it a thumbs-up.</p> <p>Provided that my video is excellent, you will give it a thumbs-up.</p> <p>As long as I make excellent video, you will remain my follower.</p> <p>In case you don't understant, please comment below.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#5_2","title":"5. \u8ba9\u6b65\u526f\u8bcd\u4ece\u53e5","text":"<p>\u9610\u8ff0\u67d0\u79cd\u60c5\u51b5\uff0c\u505a\u51fa\u67d0\u79cd\u5047\u8bbe\uff0c\u8fdb\u4e00\u6b65\u4f5c\u51fa\u4e00\u4e2a\u76f8\u53cd/\u76f8\u5bf9\u7684\u9610\u8ff0\u3002</p> <p>\u8ba9\u6b65\u5047\u8bbe\uff1aEven if I see a carrot, I will not eat it.   \u6ca1\u770b\u89c1</p> <p>\u8ba9\u6b65\u4e8b\u5b9e\uff1aAlthough I see a carrot, I will not eat it. \u770b\u89c1\u4e86</p> <p>no matter + \u7591\u95ee\u8bcd\uff1a</p> <ol> <li>No matter what happens, I will not eat the carrot.</li> <li>No matter who ofder me, I will not eat the carrot.</li> <li>No matter how hungry I am, I will not eat the carrot.</li> </ol> <p>no matter = regardless of</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#6_1","title":"6. \u65b9\u5f0f\u526f\u8bcd\u4ece\u53e5","text":"<ol> <li>\u597d\u50cf\u67d0\u4e8b\u53d1\u751f\u8fc7\u7684\u65b9\u5f0f</li> <li>\u597d\u50cf\u67d0\u4e8b\u6b63\u5728\u53d1\u751f\u7684\u65b9\u5f0f</li> </ol> <p>\u65b9\u5f0f\u72b6\u8bed\u4ece\u53e5\uff1aI feel good as if I just ate a carrot. \u4e3b\u53e5\uff1a\u786e\u5b9a\u60c5\u51b5\uff1b\u4ece\u53e5\uff1a\u4e0e\u73b0\u5b9e\u76f8\u53cd\u7684\u5047\u8bbe\uff08\u6211\u6ca1\u5403\uff09</p> <p>\u6761\u4ef6\u72b6\u8bed\u4ece\u53e5\uff1aIf I had eaten a carrot, I would feel good. \u4ece\u53e5\uff1a\u4e0e\u8fc7\u53bb\u4e8b\u5b9e\u76f8\u53cd\u7684\u5047\u8bbe\uff08\u6211\u521a\u624d\u6ca1\u5403\uff09\uff1b\u4e3b\u53e5\uff1a\u4e0d\u786e\u5b9a\u60c5\u51b5</p> <p>\u65b9\u5f0f\u72b6\u8bed\u4ece\u53e5\uff1aYou spend so much money, as if you were a millionaire.</p> <p>\u6761\u4ef6\u72b6\u8bed\u4ece\u53e5\uff1aIf you were a millionaire, you would spend a lot of money.</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#7_1","title":"7. \u539f\u56e0\u526f\u8bcd\u4ece\u53e5","text":"<p>The rabbit ate the carrot, because he was hungry.</p> <p>Since you are hungery, you can eat the carrot.</p> <p>As you were not here, we ate the carrot without you.</p> <p>before, since, as\u4e09\u8005\u7684\u533a\u522b\uff1a</p> <ol> <li>\u4ece\u56e0\u679c/\u8bed\u6c14\u770b\uff1abecause &gt; since &gt; as<ol> <li>because \u5f15\u51fa\u5b9e\u5b9e\u5728\u5728\u7684\u56e0\u679c\u5173\u7cfb</li> <li>since \u5f15\u51fa\u5927\u5bb6\u90fd\u5df2\u7ecf\u77e5\u9053\u7684\u60c5\u51b5</li> <li>as \u5f15\u51fa\u663e\u800c\u6613\u89c1\u7684\u7684\u4e8b\u5b9e</li> </ol> </li> <li>\u8bed\u5e8f\u7684\u533a\u522b<ol> <li>because \u5f15\u5bfc\u7684\u4ece\u53e5\u5728\u4e3b\u53e5\u524d\u540e\u90fd\u53ef\u4ee5</li> <li>since\u548cas\u5f15\u5bfc\u7684\u4ece\u53e5\u4e00\u822c\u53ea\u80fd\u5728\u4e3b\u53e5\u524d</li> </ol> </li> </ol> <p>for \u4e5f\u53ef\u4ee5\u8868\u793a\u539f\u56e0\uff0c\u4f46\u662ffor\u6784\u6210\u7684\u4e0d\u662f\u539f\u56e0\u72b6\u8bed\u4ece\u53e5\uff0c\u800c\u662f\u590d\u5408\u53e5\uff1a</p> <p>You must really like me, for you have give a phone.</p> <p>for \u524d\u540e\u7684\u4e24\u4e2a\u53e5\u5b50\u540c\u7b49\u5730\u4f4d\uff0c\u524d\u8005\u662f\u63a8\u6d4b\uff0c\u540e\u8005\u662f\u63a8\u6d4b\u7684\u539f\u56e0\u3002</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#8","title":"8. \u76ee\u7684\u526f\u8bcd\u4ece\u53e5","text":"<p>\u7531\u4e00\u5b9a\u7684\u56e0\u679c\u5173\u7cfb\uff0c\u4f7f\u7528\u76ee\u7684\u7684\u65b9\u5f0f\u8bf4\u51fa\u6765\u3002\u76ee\u7684\uff08\u4ece\u53e5\uff09 &lt;-- \u4e8b\u4ef6\uff08\u4e3b\u53e5\uff09</p> <p>In order that I could finish the video in time, I pulled an all-nighter.</p> <p>= I pulled an all-nighter so that I could finish the video in time.</p> <p>\u76ee\u7684\u72b6\u8bed\u4ece\u53e5\u4e2d\u4e00\u822c\u4f7f\u7528\u60c5\u6001\u52a8\u8bcd\uff1acan, could, may, might, should, would\u7b49\u66f4\u597d\u4f53\u73b0\u76ee\u7684\u6027\u3002</p>"},{"location":"english/grammar/%E4%BB%8E%E5%8F%A5/#9","title":"9. \u7ed3\u679c\u526f\u8bcd\u4ece\u53e5","text":"<p>I ate a lot of carrots for lunch, so that I wasn't hungry at all in the afternoon.</p> <p>I ate so many carrots for lunch that I felt sick afterwords.</p> <p>It was such a tasty carrot that I ate it all at once.  such + n + that ...</p> <p>It was so tasty a carrot that I ate it all at once. so + adj. + that ...</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/","title":"\u5012\u88c5","text":"<p>\u4e3a\u4e86\u5f3a\u8c03\u67d0\u4e9b\u4fe1\u606f\uff0c\u800c\u98a0\u5012\u539f\u6709\u8bed\u5e8f</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#1","title":"1. \u5b8c\u5168\u5012\u88c5","text":"<p>\u8c13\u8bed\u52a8\u8bcd\u5b8c\u5168\u5728\u4e3b\u8bed\u524d</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#11","title":"1.1 \u526f\u8bcd/\u4ecb\u8bcd\u77ed\u8bed\u5728\u53e5\u9996\u7684\u5012\u88c5","text":""},{"location":"english/grammar/%E5%80%92%E8%A3%85/#1-here-there","title":"1. \u5730\u70b9\u526f\u8bcd\u5728\u53e5\u9996\u7684\u5012\u88c5(here, there...)","text":"<p>There goes the last bus.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#2-now-then","title":"2. \u65f6\u95f4\u526f\u8bcd\u5728\u53e5\u9996\u7684\u5012\u88c5(now, then...)","text":"<p>Now comes the wolf's turn.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#3-inoutupdownaway","title":"3. \u8868\u8fd0\u52a8\u65b9\u6cd5\u7684\u526f\u8bcd\u5728\u53e5\u9996\u7684\u5012\u88c5(in,out,up,down,away...)","text":"<p>Up went the carrots into the air.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#4","title":"4. \u4ecb\u8bcd\u77ed\u8bed\u5728\u53e5\u9996\u7684\u5012\u88c5","text":"<p>At the table sat a rabbit.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#12","title":"1.2 \u4e3b\u8bed\u8865\u8bed\uff08\u8868\u8bed\uff09\u5012\u88c5","text":"<p>\u4f5c\u8868\u8bed\u7684\u5f62\u5bb9\u8bcd\uff0c\u5206\u8bcd\uff0c\u4ecb\u8bcd\u77ed\u8bed\uff0csuch\u7f6e\u4e8e\u53e5\u9996</p> <p>Seated on the ground is a group of rabbit.</p> <p>Such were the wolf's tricks.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#2","title":"2. \u90e8\u5206\u5012\u88c5","text":"<p>\u5206\u79bb\u52a9\u52a8\u8bcd\u548c\u8c13\u8bed\u52a8\u8bcd\uff0c\u4ec5\u52a9\u52a8\u8bcd\u63d0\u524d</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#21","title":"2.1 \u53e5\u9996\u6709\u5426\u5b9a\u610f\u4e49\u8bcd\u7684\u5012\u88c5","text":"<p>I have never eaten such a delicious carrot.</p> <p>-&gt; Never before have I eaten such a delicious carrot.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#22-only","title":"2.2 \u53e5\u9996\u6709only\u65f6\u7684\u5012\u88c5","text":"<p>Only in this way can we grow delicious carrots.</p> <p>Only then did the rabbit meet the wolf.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#23-ifshould","title":"2.3 if...should...\u6784\u6210\u865a\u62df\u8bed\u6c14\u7684\u5012\u88c5","text":"<p>If I should win the lottery, I would buy a huge pile of carrots.</p> <p>-&gt; Should I win the lottery, I would buy a huge pile of carrots.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#24","title":"2.4 \u56fa\u5b9a\u53e5\u578b\u4e2d\u7684\u5012\u88c5","text":"<p>Rabbits love eating carrots;so do wolves.</p> <p>I was afraid. So was I.</p> <p>The rabbit can't ride a bicycle;neither/nor can the wolf.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#3","title":"3. \u5f62\u5f0f\u5012\u88c5","text":"<p>\u53ea\u628a\u5f3a\u8c03\u7684\u5185\u5bb9\u63d0\u81f3\u53e5\u9996\uff0c\u8c13\u8bed\u52a8\u8bcd\u4e0d\u63d0\u524d</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#31","title":"3.1 \u611f\u53f9\u53e5\u4e2d\u7684\u5012\u88c5","text":"<p>What a delicious carrot it is!</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#32","title":"3.2 \u6bd4\u8f83\u53e5\u578b\u4e2d\u7684\u5012\u88c5","text":"<p>If you eat more carrots, you will become healthier.</p> <p>-&gt; The more carrots you eat, the healthier you become.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#33-however-wathever","title":"3.3 however, wathever\u5f15\u5bfc\u8ba9\u6b65\u72b6\u8bed\u4ece\u53e5\u65f6\u7684\u5012\u88c5","text":"<p>However long this video is, you should watch it till the end.</p>"},{"location":"english/grammar/%E5%80%92%E8%A3%85/#34-asthough","title":"3.4 as,though\u5f15\u5bfc\u8ba9\u6b65\u72b6\u8bed\u4ece\u53e5\u65f6\u7684\u5012\u88c5","text":"<p>Much as he likes the carrot, he doesn't want to eat it.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/","title":"\u52a8\u8bcd","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_1","title":"\u4e00\u3001\u52a8\u8bcd\u5206\u7c7b","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1","title":"1. \u53ef\u505a\u8c13\u8bed\u52a8\u8bcd","text":"<p>\u5b9e\u4e49\u52a8\u8bcd</p> <ul> <li>\u6309\u52a8\u4f5c\u627f\u53d7\u8005\u5212\u5206<ul> <li>\u53ca\u7269\u52a8\u8bcd</li> <li>\u4e0d\u53ca\u7269\u52a8\u8bcd</li> </ul> </li> <li>\u6309\u72b6\u6001\u52a8\u4f5c\u5212\u5206<ul> <li>\u52a8\u4f5c\u52a8\u8bcd</li> <li>\u72b6\u6001\u52a8\u8bcd</li> </ul> </li> </ul> <p>\u8fde\u7cfb\u52a8\u8bcd</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2","title":"2. \u53ef\u8f85\u52a9\u6784\u6210\u8c13\u8bed\u52a8\u8bcd","text":"<p>\u52a9\u52a8\u8bcd</p> <p>\u60c5\u6001\u52a8\u8bcd</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3","title":"3. \u4e0d\u53ef\u505a\u8c13\u8bed\u52a8\u8bcd","text":"<p>\u975e\u8c13\u8bed\u52a8\u8bcd</p> <ul> <li>\u4e0d\u5b9a\u65f6</li> <li>\u8fc7\u53bb\u5206\u8bcd</li> <li>\u73b0\u5728\u5206\u8bcd</li> <li>\u52a8\u540d\u8bcd</li> </ul>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_2","title":"\u4e8c\u3001\u52a8\u8bcd\u65f6\u6001","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1_1","title":"1. \u4e00\u822c\u73b0\u5728\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_3","title":"\u7ed3\u6784","text":"<ol> <li>+\u52a8\u8bcd\u539f\u5f62</li> <li>+\u52a8\u8bcd\u539f\u5f62 + s (\u7b2c\u4e09\u4eba\u79f0\u5355\u6570)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_4","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u4e8b\u5b9e The sun rises in the east.</li> <li>\u8868\u8fbe\u4e60\u60ef/\u91cd\u590d\u7684\u52a8\u4f5c I play basketball.</li> <li>\u8868\u8fbe\u9884\u8ba1\u53d1\u751f\u7684\u4e8b The bus leaves at 8PM every day.</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_1","title":"2. \u73b0\u5728\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_5","title":"\u7ed3\u6784","text":"<ol> <li>\u52a9\u52a8\u8bcdbe\u7684\u53d8\u4f4d(am/is/are)+\u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_6","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u67d0\u4e8b\u5728\u8bf4\u8bdd\u65f6\u6b63\u5728\u8fdb\u884c</li> <li>\u8868\u8fbe\u67d0\u4e9b\u4e8b\u5728\u5c06\u6765\u8981\u53d1\u751f </li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3_1","title":"3. \u73b0\u5728\u5b8c\u6210\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_7","title":"\u7ed3\u6784","text":"<ol> <li>\u52a9\u52a8\u8bcdhave\u7684\u53d8\u4f4d(have/has)+\u52a8\u8bcd\u7684\u8fc7\u53bb\u5206\u8bcd(v.+ed)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_8","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u4e00\u4ef6\u4e8b\u60c5\u5df2\u7ecf\u5b8c\u6210</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#4","title":"4. \u73b0\u5728\u5b8c\u6210\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_9","title":"\u7ed3\u6784","text":"<ol> <li>\u52a9\u52a8\u8bcdhave\u7684\u53d8\u4f4d(have/has) + been + \u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_10","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u4e00\u4ef6\u4e8b\u5728\u67d0\u4e00\u65f6\u95f4\u5185\u53d1\u751f\u4e86\u4f46\u8fd8\u672a\u7ed3\u675f</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#5","title":"5. \u4e00\u822c\u8fc7\u53bb\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_11","title":"\u7ed3\u6784","text":"<ol> <li>+\u52a8\u8bcd\u8fc7\u53bb\u5f0f(v.+ed)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_12","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u4e00\u4ef6\u4e8b\u5728\u8fc7\u53bb\u67d0\u65f6\u523b\u5df2\u5b8c\u6210</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#6","title":"6. \u8fc7\u53bb\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_13","title":"\u7ed3\u6784","text":"<ol> <li>\u52a9\u52a8\u8bcdbe\u7684\u53d8\u4f4d(was/were)+\u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_14","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u5728\u8fc7\u53bb\u67d0\u65f6\u95f4\u70b9\u8be5\u52a8\u4f5c\u6b63\u5728\u8fdb\u884c</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#7","title":"7. \u8fc7\u53bb\u5b8c\u6210\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_15","title":"\u7ed3\u6784","text":"<ol> <li>\u52a9\u52a8\u8bcdhave\u7684\u53d8\u4f4d(had)+\u52a8\u8bcd\u7684\u8fc7\u53bb\u5206\u8bcd(v.+ed)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_16","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u8fc7\u53bb\u67d0\u4e00\u70b9A\u7684\u8fc7\u53bbB\u5bf9\u8fc7\u53bb\u90a3\u4e00\u70b9A\u7684\u5f71\u54cd</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#8","title":"8. \u8fc7\u53bb\u5b8c\u6210\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_17","title":"\u7ed3\u6784","text":"<ol> <li>\u52a9\u52a8\u8bcdhave\u7684\u53d8\u4f4d(had) + been + \u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_18","title":"\u4f5c\u7528","text":"<ol> <li>\u5bf9\u4e8e\u8fc7\u53bb\u67d0\u4e2a\u70b9\uff0c\u4e0d\u4f46\u5df2\u7ecf\u5b8c\u6210\u4e00\u90e8\u5206\uff0c\u800c\u4e14 \u8fd8\u8fc7\u53bb\u90a3\u4e00\u70b9\u4e4b\u540e\uff0c\u7ee7\u7eed\u4e00\u6bb5\u65f6\u95f4</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#9","title":"9. \u4e00\u822c\u5c06\u6765\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_19","title":"\u7ed3\u6784","text":"<ol> <li>will + \u52a8\u8bcd\u539f\u5f62</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_20","title":"\u4f5c\u7528","text":"<ol> <li>\u63cf\u8ff0\u5c06\u6765\u67d0\u4e2a\u65f6\u95f4\u70b9\u53d1\u751f\u7684\u52a8\u4f5c</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#10","title":"10. \u5c06\u6765\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_21","title":"\u7ed3\u6784","text":"<ol> <li>will + be + \u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_22","title":"\u4f5c\u7528","text":"<ol> <li>\u5c06\u6765\u67d0\u4e2a\u65f6\u95f4\uff0c\u67d0\u4e2a\u52a8\u4f5c\u65f6\u8fdb\u884c\u7684\u8fc7\u7a0b\u4e2d</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#11","title":"11. \u5c06\u6765\u5b8c\u6210\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_23","title":"\u7ed3\u6784","text":"<ol> <li>will + have+\u52a8\u8bcd\u7684\u8fc7\u53bb\u5206\u8bcd(v.+ed)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_24","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u5c06\u6765\u67d0\u4e00\u70b9 (A) \u7684\u8fc7\u53bb (B)\uff08\u548c\u73b0\u5728\u7684\u524d\u540e\u4e0d\u786e\u5b9a\uff09\u5bf9\u5c06\u6765\u90a3\u4e00\u70b9 (A) \u7684\u5f71\u54cd</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#12","title":"12. \u5c06\u6765\u5b8c\u6210\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_25","title":"\u7ed3\u6784","text":"<ol> <li>will + have + been + \u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_26","title":"\u4f5c\u7528","text":"<ol> <li>\u8868\u8fbe\u5bf9\u4e8e\u5c06\u6765\u67d0\u4e2a\u70b9\uff0c\u4e0d\u4f46\u5df2\u7ecf\u5b8c\u6210\u4e86\u4e00\u90e8\u5206\uff0c\u800c\u4e14\u8fd8\u8981\u7ee7\u7eed\u8fdb\u884c\u7684\u52a8\u4f5c</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#13","title":"13. \u4e00\u822c\u8fc7\u53bb\u5c06\u6765\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_27","title":"\u7ed3\u6784","text":"<ol> <li>would + \u52a8\u8bcd\u539f\u5f62</li> <li>was/were + going + to</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_28","title":"\u4f5c\u7528","text":"<ol> <li>\u8fc7\u53bb\u7684\u5c06\u6765</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#14","title":"14. \u8fc7\u53bb\u5c06\u6765\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_29","title":"\u7ed3\u6784","text":"<ol> <li>would + be + \u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#15","title":"15. \u8fc7\u53bb\u5c06\u6765\u5b8c\u6210\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_30","title":"\u7ed3\u6784","text":"<ol> <li>would + have + \u52a8\u8bcd\u7684\u8fc7\u53bb\u5206\u8bcd(v.+ed)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#16","title":"16. \u8fc7\u53bb\u5c06\u6765\u5b8c\u6210\u8fdb\u884c\u65f6","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_31","title":"\u7ed3\u6784","text":"<ol> <li>would + have + been + \u52a8\u8bcd\u7684\u73b0\u5728\u5206\u8bcd(v.+ing)</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_32","title":"\u4e09\u3001\u52a8\u8bcd\u8bed\u6c14","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1_2","title":"1. \u9648\u8ff0\u8bed\u6c14","text":"<p>\u63cf\u8ff0\u73b0\u5b9e</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_2","title":"2. \u7948\u4f7f\u8bed\u6c14","text":"<p>\u547d\u4ee4/\u8bf7\u6c42</p> <ol> <li>\u7528\u7b2c\u4e8c\u4eba\u79f0(\"\u4f60\")\u7528\u4e00\u822c\u73b0\u5728\u65f6\u6001</li> <li>\u53bb\u6389\u201d\u4f60\u201c\uff0c\u5e76\u4fdd\u8bc1\u52a8\u8bcd\u539f\u5f62</li> </ol> <p>You be quiet! -&gt; Be quiet!</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3_2","title":"3. \u865a\u62df\u8bed\u6c14","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1_3","title":"1. \u8868\u201c\u4e0d\u53ef\u80fd\u201d\u5047\u8bbe","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1_4","title":"1. \u548c\u73b0\u5728\u4e8b\u5b9e\u76f8\u53cd","text":"<p>\u6761\u4ef6\u53e5\uff1a\u8fc7\u53bb\u5f0f</p> <p>\u4e3b\u53e5\uff1awould+\u52a8\u8bcd\u539f\u5f62</p> <p>If I knew it, I would tell you. \u5982\u679c\u6211\u73b0\u5728\u77e5\u9053\uff08\u4f46\u5176\u5b9e\u5e76\u4e0d\u77e5\u9053\uff09\uff0c\u6211\u73b0\u5728\u4f1a\u544a\u8bc9\u4f60\u3002</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_3","title":"2. \u5c06\u6765\u4e8b\u5b9e\u76f8\u53cd","text":"<p>\u6761\u4ef6\u53e5\uff1ashould+\u52a8\u8bcd\u539f\u5f62  \uff08shall\u7684\u8fc7\u53bb\u5f0f)</p> <p>\u4e3b\u53e5\uff1awould+\u52a8\u8bcd\u539f\u5f62</p> <p>If I should meet thee after long years, how should I greet thee? \u4e07\u4e00\u6211\u4eec\u5c06\u6765\u91cd\u9022\u4e86\uff0c\u6211\u53c8\u8be5\u5982\u4f55\u9762\u5bf9\u4f60\u5462\uff1f\uff08\u54b1\u4fe9\u76f8\u4f1a\u9065\u9065\u65e0\u671f\uff09</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3_3","title":"3. \u548c\u8fc7\u53bb\u4e8b\u5b9e\u76f8\u53cd","text":"<p>\u6761\u4ef6\u53e5\uff1ahad+\u52a8\u8bcd\u8fc7\u53bb\u5206\u8bcd</p> <p>\u4e3b\u53e5\uff1awould have+\u52a8\u8bcd\u8fc7\u53bb\u5206\u8bcd</p> <p>If I had watch this video before, I would have aced my test. \u6211\u8981\u662f\u4e4b\u524d\u5c31\u770b\u4e86\u8fd9\u89c6\u9891\uff0c\u90a3\u7edd\u5bf9\u80fd\u8003\u4e2a\u597d\u6210\u7ee9\uff08\u6211\u6ca1\u8003\u51fa\u597d\u6210\u7ee9\uff09\u3002</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_4","title":"2. \u8868\u8fbe\u613f\u671b\uff0c\u8bf7\u6c42\uff0c\u5efa\u8bae\uff0c\u547d\u4ee4\u7b49","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1_5","title":"1. \u5bf9\u73b0\u5728\u7684\u5e0c\u671b","text":"<p>wish+\u52a8\u8bcd\u8fc7\u53bb\u5f0f</p> <p>I wish that I were a rabbit.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_5","title":"2. \u5bf9\u8fc7\u53bb\u7684\u5e0c\u671b","text":"<p>wish+had/would have + \u52a8\u8bcd\u8fc7\u53bb\u5206\u8bcd</p> <p>I wish that I had eaten the carrot. \u6211\u5e0c\u671b\u6211\u5403\u4e86\u90a3\u4e2a\u80e1\u841d\u535c</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3_4","title":"3. \u5bf9\u5c06\u6765\u7684\u5e0c\u671b","text":"<p>wish+should|would|could|might+\u52a8\u8bcd\u539f\u5f62</p> <p>I wish that I could eat the carrot. \u6211\u5e0c\u671b\u6211\u80fd\u5403\u90a3\u4e2a\u80e1\u841d\u535c</p> <p>wish,would rather,demand,suggest,insist,order... + should + \u52a8\u8bcd\u539f\u5f62</p> <p>I demand that you should give me a carrot.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_33","title":"\u56db\u3001\u975e\u8c13\u8bed\u52a8\u8bcd","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1-infinitive","title":"1. \u52a8\u8bcd\u4e0d\u5b9a\u5f0f(infinitive)","text":"<p>to + \u52a8\u8bcd\u539f\u5f62</p> <p>To be or not to be, that is the question.</p> <p>You helped me (to) cook the carrot.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#11_1","title":"1.1 \u4e0d\u5b9a\u5f0f\u505a\u4e3b\u8bed","text":"<p>To eat a carrot every day is good for the rabbit.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#12_1","title":"1.2 \u4e0d\u5b9a\u5f0f\u505a\u5bbe\u8bed","text":"<p>The rabbit likes to eat carrots.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#13_1","title":"1.3 \u4e0d\u5b9a\u5f0f\u505a\u5bbe\u8bed\u8865\u8bed","text":"<p>The rabbit expected the wolf to eat a carrot.</p> <p>see,find,watch,have,make,let\u8fd9\u7c7b\u4f7f\u5f79\u52a8\u8bcd\u540e\u9762\u7528\u4e0d\u5b9a\u5f0f\u505a\u5bbe\u8865\u8981\u7701\u7565to\u3002</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#14_1","title":"1.4 \u4e0d\u5b9a\u5f0f\u505a\u5b9a\u8bed","text":"<p>The rabbit has a lot of carrots to eat.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#15_1","title":"1.5 \u4e0d\u5b9a\u5f0f\u505a\u72b6\u8bed","text":"<ol> <li>\u8868\u539f\u56e0 I was surprised to get a thumbs-up.</li> <li>\u8868\u76ee\u7684 I will do anything to get a  thumbs-up.</li> <li>\u8868\u7ed3\u679c I got enough thumbs-up to make another video.</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_6","title":"2. \u52a8\u540d\u8bcd","text":"<p>\u52a8\u8bcd\u539f\u5f62+ing</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#21","title":"2.1 \u52a8\u540d\u8bcd\u505a\u4e3b\u8bed","text":"<p>Eating carrots is healthy for the rabbit.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#22","title":"2.2 \u52a8\u540d\u8bcd\u505a\u4e3b\u8bed\u8865\u8bed(\u8868\u8bed)","text":"<p>The rabbit's hobby is growing carrots.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#23","title":"2.3 \u52a8\u540d\u8bcd\u505a\u5b9a\u8bed","text":"<p>a sleeping pill = a pill for sleeping</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#24","title":"2.4 \u52a8\u540d\u8bcd\u505a\u5bbe\u8bed","text":"<p>The rabbit likes eating carrots.</p> <p>enjoy,avoid,advise,consider,escape,mind,practice,insist on, give up, feel like, put off\u53ea\u80fd\u7528\u52a8\u540d\u8bcd</p> <p>\u4ecb\u8bcd+\u5bbe\u8bed</p> <p>The rabbit is fond of eating carrots.</p> <p>The rabbit is looking forward to seeing the wolf again. </p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3_5","title":"3. \u73b0\u5728\u5206\u8bcd","text":"<p>\u76f8\u5f53\u4e8e\u5f62\u5bb9\u8bcd</p> <p>a talking rabbit</p> <p>\u52a8\u540d\u8bcd\u548c\u73b0\u5728\u5206\u8bcd\u7684\u533a\u522b</p> <p>a sleeping(\u52a8\u540d\u8bcd\uff0c\u7528\u6765\u8bf4\u660e\u836f\u7247\u7684\u6027\u8d28\uff0c\u529f\u80fd\uff0c\u7528\u9014) pill = a pill for sleeping</p> <p>a sleeping(\u73b0\u5728\u5206\u8bcd\uff0c\u76f8\u5f53\u4e8e\u5f62\u5bb9\u8bcd) rabbit \u2260 a rabbit for sleeping</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#31","title":"3.1 \u73b0\u5728\u5206\u8bcd\u505a\u8868\u8bed\uff08\u4e3b\u8bed\u8865\u8bed\uff09","text":"<p>The rabbit is charming.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#32","title":"3.2 \u73b0\u5728\u5206\u8bcd\u505a\u5bbe\u8bed\u8865\u8db3\u8bed","text":"<p>The wolf saw the rabbit eating a carrot.</p> <p>\u8868\u6b63\u5728\u8fdb\u884c\u4e2d\uff0c\u5f3a\u8c03\u52a8\u4f5c\u8fdb\u884c\u72b6\u6001</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#33","title":"3.3 \u73b0\u5728\u5206\u8bcd\u505a\u72b6\u8bed","text":"<p>\u8868\u65f6\u95f4\uff0c\u539f\u56e0\uff0c\u6761\u4ef6\uff0c\u7ed3\u679c\uff0c\u8ba9\u6b65\uff0c\u76ee\u7684\uff0c\u65b9\u5f0f\u548c\u4f34\u968f\u60c5\u51b5\u7b49</p> <p>Hearing the news, the rabbit became excited.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#4_1","title":"4. \u8fc7\u53bb\u5206\u8bcd","text":"<p>\u4e0d\u81ea\u5e26\u65f6\u95f4\uff0c\u4e0d\u80fd\u8868\u793a\u8fc7\u53bb\u65f6\u95f4</p> <p>\u52a8\u8bcd\u539f\u5f62+ed</p> <ol> <li>\u5355\u72ec\u4e00\u4e2a\u8fc7\u53bb\u5206\u8bcd\u4f5c\u5f62\u5bb9\u8bcd a painted room, an excited rabbit</li> <li>\u8fc7\u53bb\u5206\u8bcd\u77ed\u8bed\u505a\u5b9a\u8bed\uff0c\u5219\u8981\u653e\u5728\u88ab\u4fee\u9970\u540d\u8bcd\u4e4b\u540e\uff0c\u5373\u540e\u7f6e\u5b9a\u8bed The carrot cake eaten by the rabbit is delicious.</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#41","title":"4.1 \u8fc7\u53bb\u5206\u8bcd\u4f5c\u4e3b\u8bed\u8865\u8bed\uff08\u8868\u8bed\uff09","text":"<p>The rabbit is interested in growing carrot. </p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#42","title":"4.2 \u8fc7\u53bb\u5206\u8bcd\u4f5c\u5bbe\u8bed\u8865\u8bed","text":"<p>The rabbit found his carrot stolen.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#43","title":"4.3 \u8fc7\u53bb\u5206\u8bcd\u4f5c\u72b6\u8bed","text":"<ol> <li>\u8868\u5730\u70b9 Seen from the hill, the carrot field looks beautiful.</li> <li>\u8868\u539f\u56e0 Born in a rabbit family, the rabbit's only work is growing carrots.</li> <li>\u8868\u6761\u4ef6 Given another chance, the rabbit would go to the wolf's party.</li> </ol> <p>\u73b0\u5728\u5206\u8bcd\u4e0e\u8fc7\u53bb\u5206\u8bcd\u7684\u533a\u522b\u5728\u4e8e\u4e3b\u8bed\u4e0e\u52a8\u4f5c\u4e4b\u95f4\u7684\u4e3b\u52a8\u6216\u88ab\u52a8\u5173\u7cfb</p> <p>\u4e3b\u52a8\u7528\u73b0\u5728\u5206\u8bcd\uff1b\u88ab\u52a8\u7528\u8fc7\u53bb\u5206\u8bcd</p> <p>The work finished, the rabbit went home.</p> <p>The weather permitting, the rabbit will go out.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_34","title":"\u4e94\u3001\u52a9\u52a8\u8bcd&amp;\u60c5\u6001\u52a8\u8bcd","text":""},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#1_6","title":"1. \u57fa\u672c\u52a9\u52a8\u8bcd\uff08\u8fd8\u53ef\u4f5c\u5b9e\u4e49\u52a8\u8bcd\uff09","text":"<p>be: The rabbit is eating a carrot.</p> <p>do</p> <p>have The rabbit has eaten a carrot.</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#2_7","title":"2. \u60c5\u6001\u52a9\u52a8\u8bcd","text":"<p>can/could</p> <ol> <li>\u8868\u80fd\u529b I can kill a wolf.</li> <li>\u8868\u8bf7\u6c42\u6216\u8bb8\u53ef Can/Could I borrow your book?</li> <li>\u8868\u53ef\u80fd\u6027 Anything can happen.</li> </ol> <p>may/might</p> <ol> <li>\u8868\u8bf7\u6c42\u6216\u8bb8\u53ef May/might I borrow your book?</li> <li>\u8868\u53ef\u80fd\u6027\uff08\u53ef\u80fd\u6027\u5c0f\u4e8ecan/cloud\uff09 The rabbit isn't here. He may be at home.</li> <li>\u8868\u795d\u613f\uff08\u653e\u53e5\u9996\uff09 May you succeed!</li> </ol> <p>will/would</p> <ol> <li>\u6784\u6210\u5c06\u6765\u65f6 The rabbit will eat a carrot. The rabbit would eat a carrot.</li> <li>\u8868\u793a\u8bf7\u6c42\uff0c\u5efa\u8bae Will you lend me that book?</li> <li>\u8868\u63a8\u6d4b\uff0c\u5047\u8bbe Ask him, He will/would konw.</li> </ol> <p>shall</p> <ol> <li>\u6784\u6210\u5c06\u6765\u65f6 I shall be there at 9 AM.</li> <li>\u8868\u793a\u8bf7\u6c42\u6216\u5f81\u6c42\u610f\u89c1 Shall we meet at 9 AM.</li> <li>\u8868\u8b66\u544a\uff0c\u547d\u4ee4 You shall not steal.</li> </ol> <p>should</p> <ol> <li>\u8868\u5e94\u5f53</li> <li>\u8868\u6709\u4e00\u5b9a\u63a8\u6d4b It should rain tomorrow.</li> <li>\u8868\u5f53\u7136 It's surprising that he should be late.</li> <li>\u6784\u6210\u865a\u62df\u8bed\u6c14</li> </ol> <p>must</p> <ol> <li>\u8868\u5fc5\u987b</li> <li>\u8868\u7981\u6b62 You must not smoke here</li> <li>\u8868\u63a8\u6d4b The light is on. The rabbit must be at home.</li> </ol> <p>ought to</p> <ol> <li>\u8868\u5e94\u8be5 \u4e0eshould\u7528\u6cd5\u5927\u81f4\u76f8\u540c\uff0c\u4f46\u8bed\u6c14\u66f4\u5f3a\u4e00\u4e9b\u3002You ought to treat the rabbit well.</li> </ol> <p>dare/dared</p> <ol> <li>\u5b9e\u4e49\u52a8\u8bcd\uff1a\u6562\u6311\u6218\uff0c\u5192\u9669</li> <li>\u60c5\u6001\u52a8\u8bcd\uff1a\u6562 The rabbit dare not tell the truth to the wolf.</li> </ol> <p>need</p> <ol> <li>\u5b9e\u4e49\u52a8\u8bcd\uff1a\u9700\u8981</li> <li>\u9700\u8981\uff0c\u6709\u5fc5\u8981 The rabbit need wait</li> </ol> <p>used to</p> <ol> <li>\u8868\u8fc7\u53bb\u7684\u52a8\u8bcd\uff0c\u5c24\u5176\u65f6\u91cd\u590d\u7684\u52a8\u8bcd The rabbit used to eat apples, Now he only eat carrots.</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#3_6","title":"3. \u534a\u52a9\u52a8\u8bcd","text":"<p>be able to \u53ef\u4ee5\u8868\u8fbe\u5c06\u6765\u7684\u80fd\u529b I'll be able to reach school on time if I leave right now.</p> <p>was/were able to \u6210\u529f\u505a\u6210\u67d0\u4e8b</p> <p>be going to \u6709\u66f4\u5f3a\u7684\u4e3b\u89c2\u80fd\u52a8\u6027\uff0c\u8ba1\u5212\u505a\u67d0\u4e8b</p> <p>be about to \u9a6c\u4e0a\u5c31\u8981\u505a</p> <p>bad better \u6700\u597d\u505a\uff0c\u5fe0\u544a\uff0c\u8b66\u544a\u4e4b\u610f You had better follow my order.</p> <p>be to</p> <ol> <li>\u88ab\u547d\u4ee4\u505a\u67d0\u4e8b You are to finish homework first.</li> <li>\u547d\u4e2d\u6ce8\u5b9a I think they are to fall in love with each other.</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_35","title":"\u516d\u3001\u7cfb\u52a8\u8bcd\uff08\u8fde\u7cfb\u52a8\u8bcd\uff09","text":"<p>\u4f5c\u7528\uff1a\u8d4b\u503c  A &lt;- B</p> <p>I am a rabbit.</p> <p>The rabbit is smart.</p> <p>The carrot smells nice.</p> <p>The room remained empty.</p> <p>The sky grew dark.</p> <p>keep, feel, stay, become, seem, appear, prove, turn...</p>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_36","title":"\u4e03\u3001\u4f7f\u5f79\u52a8\u8bcd","text":"<p>I make the wolf eat carrots from time to time.</p> <p>\u4f7f\u5f79\u52a8\u8bcd\uff1a\u9700\u8981\u540e\u63a5\u5bbe\u8bed\u4ee5\u53ca\u5bbe\u8bed\u8865\u8bed\u7684\u52a8\u8bcd\u6709\u597d\u51e0\u7c7b\uff0c\u5176\u4e2d\u8868\u8fbe\u201c\u4f7f\uff0c\u4ee4\uff0c\u8ba9\u201c\u7684\u4e00\u7c7b\u52a8\u8bcd</p> <p>make</p> <ol> <li>+\u52a8\u8bcd\u539f\u5f62\uff08\u88f8\u4e0d\u5b9a\u5f0f\uff09 I make the wolf eat carrots from time to time.</li> <li>+\u5f62\u5bb9\u8bcd The carrot make the wolf full.</li> </ol> <p>let</p> <ol> <li>+\u52a8\u8bcd\u539f\u5f62\uff08\u88f8\u4e0d\u5b9a\u5f0f \uff09I let the wolf eat some chocolate.</li> <li>+\u526f\u8bcd Let me out!</li> </ol> <p>have</p> <ol> <li>+\u52a8\u8bcd\u539f\u5f62\uff08\u88f8\u4e0d\u5b9a\u5f0f\uff09 I'll have the wolf wash the dishes.</li> <li>+\u8fc7\u53bb\u5206\u8bcd I had my car washed.</li> </ol> <p>get</p> <ol> <li>+\u5b8c\u6574\u4e0d\u5b9a\u5f0f I\u2019ll get the wolf to clean the kitchen after she washes the dishes.</li> <li>+\u8fc7\u53bb\u5206\u8bcd I got my nails done</li> </ol>"},{"location":"english/grammar/%E5%8A%A8%E8%AF%8D/#_37","title":"\u516b\u3001\u72ec\u7acb\u4e3b\u683c","text":"<p>\u540d\u8bcd + \u8fc7\u53bb\u5206\u8bcd\uff1a</p> <p>Because he was invited by the wolf, the rabbit decided to go to he party.</p> <p>-&gt; Invited(\u8fc7\u53bb\u5206\u8bcd) by the wolf, the rabbit decided to go to the party.</p> <p>After the work was finished, the rabbit went home.</p> <p>-&gt; The work finished, the rabbit went home.</p> <p>\u540d\u8bcd + \u73b0\u5728\u5206\u8bcd\uff1a</p> <p>Because the wolf invited him , the rabbit decided to go the party.</p> <p>-&gt; The wolf inviting(\u73b0\u5728\u5206\u8bcd) him , the rabbit decided to go the party.</p> <p>If the weather permits, the rabbit will go out.</p> <p>-&gt; The weather permitting, the rabbit will go out.</p> <p>The rabbit is lying in bed and a carrot is still held in his hand.</p> <p>-&gt; The rabbit is lying in bed, a carrot still held in his hand.</p> <p>\u540d\u8bcd + \u52a8\u8bcd\u4e0d\u5b9a\u5f0f\uff1a</p> <p>The rabbit to come, the wolf is overjoyed.</p> <p>\u540d\u8bcd + \u540d\u8bcd\uff1a</p> <p>Many animals went to the party, some of them being rabbits and wolves.</p> <p>\u540d\u8bcd + \u5f62\u5bb9\u8bcd\uff1a</p> <p>Many animals went to the party, some of them being happy.</p> <p>\u540d\u8bcd + \u526f\u8bcd\uff1a</p> <p>The rabbit sat on a chair, head being down.</p> <p>\u540d\u8bcd + \u4ecb\u8bcd\u77ed\u8bed\uff1a</p> <p>The rabbit came in, carrot being in hand.</p> <p>with + \u5bbe\u8bed + \u5bbe\u8bed\u8865\u8bed\uff1a</p> <p>With the work finished, the rabbit went home.</p> <p>-&gt; The work finished, the rabbit went home.</p> <p>The rabbit came in, with a carrot in his hand.</p> <p>-&gt;The rabbit came in, carrot in hand.</p> <p>\u603b\u7ed3\uff1a</p> <ol> <li>\u975e\u8c13\u8bed\u52a8\u8bcd\u4e2d\u8fc7\u53bb\u5206\u8bcd\u8868\u793a\u903b\u8f91\u4e3b\u8bed\u548c\u52a8\u4f5c\u662f\u201c\u88ab\u52a8\uff0c\u5b8c\u6210\u201d\u5173\u7cfb</li> <li>\u975e\u8c13\u8bed\u52a8\u8bcd\u4e2d\u73b0\u5728\u5206\u8bcd\u8868\u793a\u903b\u8f91\u4e3b\u8bed\u548c\u52a8\u4f5c\u662f\u201c\u4e3b\u52a8\uff0c\u8fdb\u884c\u201d\u5173\u7cfb</li> <li>\u975e\u8c13\u8bed\u52a8\u8bcd\u4e2d\u52a8\u8bcd\u4e0d\u5b9a\u5f0f\u8868\u793a\u903b\u8f91\u5c06\u8981\u53d1\u751f\u7684\u52a8\u4f5c</li> <li>\u5176\u4ed6\u5f62\u5f0f\u50cf\u662f\u7701\u7565\u7684\u73b0\u5728\u5206\u8bcdbeing\u7684\u4e00\u79cd\u7b80\u5316\u5f62\u5f0f</li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/","title":"\u7efc\u8ff0","text":""},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_1","title":"\u4e00\u3001\u8bed\u6cd5\u7efc\u8ff0","text":""},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_2","title":"\u52a8\u8bcd(\u52a8\u4f5c)","text":"<ol> <li>\u53ef\u4ee5\u72ec\u7acb\u5b8c\u6210\u7684\u52a8\u4f5c\uff1a\u4e3b\u8bed+\u4e0d\u53ca\u7269\u52a8\u8bcd Papa Rabbit sleeps.</li> <li>\u67091\u4e2a\u52a8\u4f5c\u7684\u627f\u53d7\u8005\uff1a\u4e3b\u8bed+\u5355\u53ca\u7269\u52a8\u8bcd+\u5bbe\u8bed Papa Rabbit likes you.</li> <li>\u67092\u4e2a\u52a8\u4f5c\u7684\u627f\u53d7\u8005: \u4e3b\u8bed+\u53cc\u53ca\u7269\u52a8\u8bcd+\u95f4\u63a5\u5bbe\u8bed+\u76f4\u63a5\u5bbe\u8bed  Papa Rabbit teaches you English</li> <li> <p>\u53ea\u67091\u4e2a\u52a8\u4f5c\u7684\u627f\u53d7\u8005 (\u4f46\u9700\u8865\u5145) \uff1a\u4e3b\u8bed+\u590d\u6742\u53ca\u7269\u52a8\u8bcd+\u5bbe\u8bed +(\u5bbe\u8bed)\u8865\u8bed Papa Rabbit considers you smart.</p> </li> <li> <p>\u975e\u52a8\u4f5c\uff1a\u4e3b\u8bed + \u8fde\u7cfb\u52a8\u8bcd + (\u4e3b\u8bdd)\u8865\u8bed/\u8868\u8bed Papa Rabbit is tall.</p> </li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_3","title":"\u4e94\u79cd\u57fa\u672c\u53e5\u578b","text":"<ol> <li>\u65e0\u9700\u627f\u53d7\u8005\uff08\u5bbe\u8bed\uff09\uff1a\u4e3b\u8bed+\u4e0d\u53ca\u7269\u52a8\u8bcd </li> <li>\u4e00\u4e2a\u5bbe\u8bed\uff0c\u65e0\u8865\u5145\u4fe1\u606f\uff1a\u4e3b\u8bed+\u5355\u53ca\u7269\u52a8\u8bcd+\u5bbe\u8bed</li> <li>\u4e24\u4e2a\u5bbe\u8bed\uff1a\u4e3b\u8bed+\u53cc\u53ca\u7269\u52a8\u8bcd+\u95f4\u63a5\u5bbe\u8bed+\u76f4\u63a5\u5bbe\u8bed</li> <li>\u4e00\u4e2a\u5bbe\u8bed+\u8865\u5145\u4fe1\u606f\uff1a\u4e3b\u8bed+\u590d\u6742\u53ca\u7269\u52a8\u8bcd+\u5bbe\u8bed +(\u5bbe\u8bed)\u8865\u8bed </li> <li>\u8d4b\u4e88\u4fe1\u606f\uff1a\u4e3b\u8bed + \u8fde\u7cfb\u52a8\u8bcd + (\u4e3b\u8bdd)\u8865\u8bed/\u8868\u8bed</li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_4","title":"\u53e5\u5b50\u6210\u5206","text":"<ol> <li>\u4e3b\u8bed</li> <li>\u8c13\u8bed\u52a8\u8bcd</li> <li>\u5bbe\u8bed</li> <li>\u5bbe\u8bed\u8865\u8bed</li> <li>\u4e3b\u8bed\u8865\u8bed\uff08\u8868\u8bed\uff09</li> <li>\u5b9a\u8bed</li> <li>\u72b6\u8bed</li> <li>\u540c\u4f4d\u8bed</li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_5","title":"\u53e5\u5b50\u7684\u5206\u7c7b","text":""},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#1","title":"1. \u7b80\u5355\u53e5","text":"<p>\u4e3b\u8bed(\u4eba/\u7269) + \u8c13\u8bed(\u52a8\u4f5c/\u53d1\u751f\u4e86\u4ec0\u4e48\u4e8b)</p>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#2","title":"2. \u590d\u5408\u53e5","text":"<p>\u4e0d\u5206\u4e3b\u6b21</p>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#3","title":"3. \u590d\u6742\u53e5","text":"<p>\u4e00\u4e2a\u53e5\u5b50(\u4e3b\u53e5)\u5957\u53e6\u4e00\u4e2a\u53e5\u5b50(\u4ece\u53e5)</p> <ol> <li>\u540d\u8bcd\u6027\u4ece\u53e5<ul> <li>\u7b80\u5355\u53e5\u4f5c\u4e3b\u8bed--&gt;\u4e3b\u8bed\u4ece\u53e5</li> <li>\u7b80\u5355\u53e5\u505a\u5bbe\u8bed--&gt;\u5bbe\u8bed\u4ece\u53e5</li> <li>\u7b80\u5355\u53e5\u505a\u8868\u8bed--&gt;\u8868\u8bed\u4ece\u53e5</li> <li>\u7b80\u5355\u53e5\u505a\u540c\u4f4d\u8bed--&gt;\u540c\u4f4d\u8bed\u4ece\u53e5</li> </ul> </li> <li>\u5b9a\u8bed\u4ece\u53e5<ul> <li>\u7b80\u5355\u53e5\u4f5c\u5b9a\u8bed--&gt;\u5b9a\u8bed\uff08\u5f62\u5bb9\u8bcd/\u5173\u7cfb\uff09\u4ece\u53e5</li> </ul> </li> <li>\u72b6\u8bed\u4ece\u53e5<ul> <li>\u7b80\u5355\u53e5\u4f5c\u72b6\u8bed--&gt;\u72b6\u8bed\u4ece\u53e5</li> </ul> </li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_6","title":"\u8bcd\u6027(\u8bcd\u7c7b)","text":"<ol> <li>\u540d\u8bcd</li> <li>\u51a0\u8bcd</li> <li>\u4ee3\u8bcd</li> <li>\u5f62\u5bb9\u8bcd</li> <li>\u6570\u8bcd</li> <li>\u526f\u8bcd</li> <li>\u4ecb\u8bcd</li> <li>\u53f9\u8bcd</li> <li>\u8fde\u8bcd</li> <li>\u52a8\u8bcd</li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_7","title":"\u8c13\u8bed\u52a8\u8bcd\u7684\"\u4e09\u5927\u672c\u9886\"","text":"<ol> <li>\u52a8\u4f5c\u65f6\u95f4<ol> <li>\u73b0\u5728</li> <li>\u8fc7\u53bb</li> <li>\u5c06\u6765</li> <li>\u8fc7\u53bb\u5c06\u6765</li> </ol> </li> <li>\u52a8\u4f5c\u72b6\u6001<ol> <li>\u4e00\u822c</li> <li>\u5b8c\u6210</li> <li>\u8fdb\u884c</li> <li>\u5b8c\u6210\u8fdb\u884c</li> </ol> </li> <li>\u52a8\u4f5c\u5047\u8bbe\uff0c\u60c5\u611f<ol> <li>\u865a\u62df\u8bed\u6c14</li> <li>\u79f0\u8ff0\u8bed\u6c14</li> <li>\u7948\u4f7f\u8bed\u6c14</li> </ol> </li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_8","title":"\u52a9\u52a8\u8bcd","text":"<ol> <li>\u534f\u52a9\u8868\u793a\"\u5403\u8fc7\u4e86\uff08\u5b8c\u6210\uff09\"-&gt;  have -&gt; have eat</li> <li>\u534f\u52a9\u8868\u793a\"\u6b63\u5728\u5403\uff08\u8fdb\u884c\uff09\"-&gt; be -&gt; is eating</li> <li>\u534f\u52a9\u8868\u793a\"\u88ab\u5403\" -&gt; be -&gt; is eaten</li> <li>\u534f\u52a9\u8868\u793a\"\u6709\u80fd\u529b\u5403\" -&gt; can -&gt; can eat</li> <li>\u534f\u52a9\u8868\u793a\"\u6709\u53ef\u80fd\u5403\" -&gt; might -&gt; might eat</li> <li>\u534f\u52a9\u8868\u793a\"\u6709\u4e49\u52a1\u5403\" -&gt; must -&gt; must eat</li> <li>\u534f\u52a9\u8868\u793a\"\u4e0d\u5403\" do -&gt; do not eat</li> </ol>"},{"location":"english/grammar/%E7%BB%BC%E8%BF%B0/#_9","title":"\u975e\u8c13\u8bed\u52a8\u8bcd","text":"<p>\u52a8\u8bcd\u53ef\u4ee5\u5145\u5f53\uff1a</p> <ul> <li>\u8c13\u8bed\u52a8\u8bcd</li> <li>\u4e3b\u8bed\uff08\u975e\u8c13\u8bed\u52a8\u8bcd\uff09</li> <li>\u5bbe\u8bed\uff08\u975e\u8c13\u8bed\u52a8\u8bcd\uff09</li> <li>\u5bbe\u8bed\u8865\u8bed\uff08\u975e\u8c13\u8bed\u52a8\u8bcd\uff09</li> <li>\u4e3b\u8bed\u8865\u8bed\uff08\u975e\u8c13\u8bed\u52a8\u8bcd\uff09</li> <li>\u5b9a\u8bed\uff08\u975e\u8c13\u8bed\u52a8\u8bcd\uff09</li> <li>...</li> </ul> <p>\u975e\u8c13\u8bed\u52a8\u8bcd\u53ef\u4ee5\u53d6\u4ee3\u6240\u6709\u7684\u4ece\u53e5\uff0c\u4ece\u800c\u7b80\u5316\u53e5\u5b50\u3002</p> <p>\u975e\u8c13\u8bed\u52a8\u8bcd\u5206\u7c7b</p> <ul> <li>\u52a8\u8bcd\u4e0d\u5b9a\u5f0f</li> <li>\u73b0\u5728\u5206\u8bcd</li> <li>\u52a8\u540d\u8bcd</li> <li>\u8fc7\u53bb\u5206\u8bcd</li> </ul>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/","title":"\u8bcd\u6027","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_1","title":"\u4e00\u3001\u51a0\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1","title":"1. \u4e0d\u5b9a\u51a0\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_1","title":"1.\u53d1\u97f3","text":"<ol> <li> <p>a\u7528\u4e8e\u8f85\u97f3\u97f3\u7d20\u524d\uff1aa rabbit, a university</p> </li> <li> <p>an\u7528\u4e8e\u5143\u97f3\u97f3\u7d20\u524d\uff1aan apple, an hour</p> </li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2","title":"2.\u7528\u6cd5","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#21","title":"2.1 \u6cdb\u6307\u7528\u6cd5","text":"<ol> <li> <p>\u6cdb\u6307\u67d0\u4e00\u4e2a\u4eba\u6216\u7269\uff1aI saw a rabbit</p> </li> <li> <p>\u6cdb\u6307\u67d0\u4e00\u7c7b\uff1aA rabbit is smarter than a wolf</p> </li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#22-1","title":"2.2 \u8868\u793a\u6570\u5b57\"1\"","text":"<p>I gave you a hundred carrots.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#23","title":"2.3 \u8868\u793a\"\u6bcf\"","text":"<p>I eat 10 carrots a day.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#24","title":"2.4 \u4e3b\u8c13\u4e00\u81f4","text":"<p>a teacher and video creator.</p> <p>a teacher and a video creator.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#25","title":"2.5 \u56fa\u5b9a\u8868\u8fbe","text":"<p>have a good time.</p> <p>as a result</p> <p>in a hurry</p> <p>all of a sudden</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_1","title":"2.\u5b9a\u51a0\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_2","title":"1. \u53d1\u97f3","text":"<ol> <li>the /\u00f0\u0259/ \u7528\u4e8e\u8f85\u97f3\u97f3\u7d20\u524d</li> <li>the /\u00f0i/ \u7528\u4e8e\u5143\u97f3\u97f3\u7d20\u524d </li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_2","title":"2. \u7528\u6cd5","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#21_1","title":"2.1 \u7279\u6307","text":"<ol> <li>\u8868\u793a\u67d0\u4e2a\u6216\u67d0\u4e9b\u7279\u5b9a\u7684\u4eba\u6216\u7269</li> <li>\u518d\u6b21\u63d0\u5230\u7684\u4eba\u6216\u7269</li> <li>\u7528\u5728\u5e8f\u6570\u8bcd\u548c\u5f62\u5bb9\u8bcd\u7684\u6700\u9ad8\u7ea7\u524d the first rabbit.</li> <li>\u72ec\u4e00\u65e0\u4e8c\u7684\u540d\u8bcd\u524d the sun, the moon, the earth</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#22","title":"2.2 \u6cdb\u6307","text":"<p>I like play the piano.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#23_1","title":"2.3 \u5728\u5f62\u5bb9\u8bcd\u524d","text":"<ol> <li>\u4ee3\u6307\u4e00\u7c7b\u4eba</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#24_1","title":"2.4 \u56fa\u5b9a\u8868\u8fbe","text":"<p>all the time</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3","title":"3.\u96f6\u51a0\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_3","title":"1. \u590d\u6570\u6cdb\u6307","text":"<p>Rabbits are smart.</p> <p>Water is important.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_3","title":"2. \u6cdb\u6307\u2018\u6982\u5ff5\u2019","text":"<p>Summer is hot. Winter is cold.</p> <p>I want to play football.</p> <p>in spring</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_1","title":"3. \u4e13\u6709\u540d\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#4","title":"4. \u56fa\u5b9a\u8868\u8fbe","text":"<p>from time to time</p> <p>face to face</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_2","title":"\u4e8c\u3001\u4ecb\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_4","title":"1. \u539f\u7406","text":"<p>\u4ecb\u8bcd\uff08\u9644\u52a0\u4fe1\u606f\uff1a\u65f6\u95f4\uff0c\u7a7a\u95f4\uff0c\u65b9\u5f0f\uff0c\u903b\u8f91\uff09 + \u540d\u8bcd/\u4ee3\u8bcd...</p> <p>\u4ecb\u8bcd\uff1a\u524d\u7f6e\u8bcd</p> <ol> <li> <p>\u672c\u4e49\uff1a\u6839\u6e90\u610f\u4e49\uff0c\u8868\u8fbe\u660e\u786e\u7684\u7a7a\u95f4\u542b\u4e49 about :  \u5728...\u7684\u5916\u9762</p> </li> <li> <p>\u5f15\u7533\u4e49\uff1a\u884d\u751f\u542b\u4e49\uff0c\u8868\u8fbe\u975e\u7a7a\u95f4\u542b\u4e49 about: \u5173\u4e8e\uff08\u5916\u56f4\uff0c\u6709\u6d89\u53ca\uff0c\u975e\u6838\u5fc3\uff09\uff0c\u5927\u7ea6\uff08\u4ece\u5916\u5927\u8303\u56f4\u5927\u81f4\u6570\u6570\uff09\uff0c\u9488\u5bf9\uff08\u4ece\u5916\u5411\u5185\u5730\u89e3\u51b3\uff09\uff0c\u67d0\u4eba\u67d0\u4e8b\u6709\u67d0\u79cd\u7279\u5f81\uff0c\u5230\u5904\uff08\u5728\u5916\u9762\u6765\u6765\u56de\u56de\uff09\uff0c...</p> </li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_4","title":"2. \u6784\u6210\u5f62\u5f0f","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_5","title":"1. \u7b80\u5355\u4ecb\u8bcd","text":"<p>in, on, with</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_5","title":"2. \u77ed\u8bed\u4ecb\u8bcd","text":"<p>by way of, at the end, along with, because of, pervious to</p> <p>\u4e0d\u80fd\u8868\u5b8c\u6574\u610f\u4e49</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_2","title":"3. \u5408\u6210\u4ecb\u8bcd","text":"<p>into, onto, within</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#4_1","title":"4. \u5206\u8bcd\u4ecb\u8bcd","text":"<p>including, regarding, considering, given</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_3","title":"3. \u5e38\u89c1\u7528\u6cd5","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_6","title":"1. \u8868\u7a7a\u95f4","text":"<p>in: \u5728...\u91cc\uff0c\u5728\u7a7a\u95f4\u7684\u5185\u90e8</p> <ol> <li>in the house, in the park, in the country</li> <li>There are some birds in the tree(\u5916\u90e8\u4e8b\u7269\u5728\u6811\u7acb).</li> </ol> <p>at: \u5728\u67d0\u5904\uff0c\u5177\u4f53\u7684\u70b9</p> <ol> <li>at the bus station</li> </ol> <p>on: \u5728...\u4e0a\uff0c\u7269\u4f53\u8868\u9762\u4e0a\uff0c\u7269\u4f53\u4e0e\u7269\u4f53\u63a5\u89e6</p> <ol> <li>on the table, on the floor</li> <li>There are some apples on the tree(\u957f\u5728\u6811\u4e0a).</li> </ol> <p>over: \u5728...\uff08\u6b63\uff09\u4e0a\u65b9\uff0c\u8986\u76d6\uff0c\u8d8a\u8fc7\u4e0a\u7a7a</p> <ol> <li>the bridge over the river</li> <li>The mother put a blanket over the child.</li> <li>The plane flew over the mountain.</li> </ol> <p>above: \u5728...\u4e0a\u65b9(\u9ad8\u4e8e\u5e73\u9762)</p> <ol> <li>the sky above us</li> </ol> <p>under: \u5728...\uff08\u6b63\uff09\u4e0b\u65b9 -- over</p> <ol> <li>There is a ball under the desk.</li> </ol> <p>below: \u5728...\u4e0b\u65b9 -- above</p> <ol> <li>The rabbit dived below the surface of the water.</li> </ol> <p>near: \u5728...\u9644\u8fd1</p> <ol> <li>There is school near here.</li> </ol> <p>by: \u5728...\u65c1\u8fb9</p> <p>beside: \u5728...\u65c1\u8fb9</p> <p>next to: \u5728...\u65c1\u8fb9, \u7d27\u6328\u7740</p> <ol> <li>The rabbit sat by/beside/next to the wolf.</li> </ol> <p>accross: \uff08\u4ece\u8868\u9762\uff09\u7a7f\u8fc7</p> <ol> <li>go accross the street</li> </ol> <p>through: \uff08\u4ece\u5185\u90e8\uff09\u7a7f\u8fc7</p> <ol> <li>go through the tunnel</li> <li>look through the window</li> </ol> <p>past: \u7ecf\u8fc7\uff0c\u8def\u8fc7</p> <p>int front of: \u5728...\u524d\u65b9</p> <p>behind: \u5728...\u4e4b\u540e</p> <p>before: \u5728...\u4e4b\u524d</p> <ol> <li>She played the violin before the crowd.</li> </ol> <p>between: \u5728...\u4e4b\u95f4</p> <p>among. \u5728...\uff08\u591a\u6570\uff09\u4e4b\u95f4</p> <p>round/around\uff1a\u56f4\u7ed5</p> <p>along: \u6cbf\u7740\uff0c\u987a\u7740</p> <p>to: \u5411\uff0c\u671d</p> <p>toward/towards: \u671d\u7740..\u7684\u65b9\u5411</p> <p>onto: \u5230...\u4e0a</p> <p>into: \u5230...\u91cc</p> <p>out of: \u4ece...\u51fa\u6765</p> <p>opposite: \u5728...\u5bf9\u9762</p> <p>against: \u4e0e...\u76f8\u53cd\uff1b\u501a\uff1b\u9760</p> <ol> <li>We were rowing against the current.</li> <li>The rabbit was leaning against the tree.</li> </ol> <p>up: \u6cbf...\u5411\u4e0a</p> <p>down: \u6cbf...\u5411\u4e0b</p> <p>off: \u79bb...\u6709\u4e00\u5b9a\u8ddd\u79bb</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_6","title":"2. \u8868\u65f6\u95f4","text":"<p>in: in 2030, in wanter</p> <p>on: on Monday</p> <p>at: at 6 o'clock, at noon, at dawn,</p> <p>during: during the past 2 days</p> <p>for: I've been learing English for 2 years.</p> <p>since: since last week</p> <p>before: before Monday</p> <p>after: after two years</p> <p>from...to...</p> <p>by: by tomorrow \u660e\u5929\u4e4b\u524d</p> <p>until</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_4","title":"3. \u8868\u65b9\u5f0f","text":"<p>in: in English</p> <p>through: We succeed through hard work.</p> <p>by: \u901a\u8fc7\uff1b\u5728...\u65c1\u8fb9</p> <ol> <li>We learn English by watching videos.</li> </ol> <p>with: \u7528...;\u548c...\u4e00\u8d77</p> <ol> <li>We write with pens.</li> </ol> <p>on: \u5728...\u4e0a\u9762</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#4_2","title":"4. \u8868\u539f\u56e0","text":"<p>for</p> <p>with: ...\u662f\u548c...\u5206\u4e0d\u5f00\u7684\u539f\u56e0</p> <ol> <li>The rabbit is shaking with cold.</li> </ol> <p>becasue of + \u540d\u8bcd</p> <p>becasue + \u4ece\u53e5</p> <p>due to</p> <p>owing to</p> <p>on account of</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#5","title":"5. \u8868\u5173\u4e8e","text":"<p>about</p> <p>of: \u6b64\u5916\u7684\uff1b\u9644\u52a0\u7684</p> <p>on</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#6","title":"6. \u8868\u6570\u503c","text":"<p>at</p> <ol> <li>at a fast rate, at a high price</li> </ol> <p>by:  +\u5ea6\u91cf\u6807\u51c6</p> <ol> <li>They get paid by the hour.</li> </ol> <p>for: \u4ee5...\u7684\u4ef7\u94b1</p> <p>I bought there books for 100 Yuan.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#7","title":"7. \u8868\u72b6\u6001","text":"<p>in: \u5728...\u72b6\u6001\u4e2d</p> <p>on: \u53d7\u5230\u4e4b\u4e0b...\u7684\u652f\u6301 on drugs \u5403\u836f on a diet \u5728\u8282\u98df</p> <p>at: \u5728\u67d0\u4e2a\u72b6\u6001 at work</p> <p>under: \u5728\uff08\u6846\u67b6\uff0c\u524d\u63d0\uff09\u4e0b under construction \u5728\u65bd\u5de5\u4e2d</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#8","title":"8. \u8868\u6392\u9664","text":"<p>besides: \u9664\u4e86...\u8fd8</p> <p>except</p> <p>except for</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#4_3","title":"4. \u4ecb\u8bcd\u77ed\u8bed","text":"<p>\u4ecb\u8bcd\uff08\u524d\u7f6e\u8bcd\uff09 + \u5bbe\u8bed\uff08\u4ecb\u8bcd\u5bbe\u8bed\uff09</p> <p>Between 10 and 11 is a good time for me.</p> <p>The meeting is at 2 o'clock.</p> <p>This is the key to the house.</p> <p>I found the carrot in good condition.</p> <p>The rabbit ate a carrot at noon.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#5_1","title":"5. \u56fa\u5b9a\u642d\u914d","text":"<p>for example</p> <p>at ease</p> <p>in turn</p> <p>need for</p> <p>long for \u6e34\u671b</p> <p>ready for</p> <p>\u77ed\u8bed\u52a8\u8bcd\uff1a</p> <ol> <li>check out \u9000\u623f</li> <li>make out \u5206\u8fa8</li> <li>put out \u7184\u706d</li> <li>pass out \u6655\u5012</li> <li>work out \u5065\u8eab</li> <li>look out \u5c0f\u5fc3</li> <li>knock out \u6253\u6655</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_3","title":"\u4e09\u3001\u540d\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_7","title":"1. \u666e\u901a\u540d\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_8","title":"1. \u5355\u6570&amp;\u590d\u6570","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_7","title":"2. \u53ef\u6570&amp;\u4e0d\u53ef\u6570","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_8","title":"2. \u4e13\u6709\u540d\u8bcd","text":"<p>Earth\u3001Asia\u3001China\u3001\u4eba\u540d</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_9","title":"1. \u53ef\u6570&amp;\u4e0d\u53ef\u6570","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_5","title":"3. \u6240\u6709\u683c","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1-s","title":"1. 's","text":"<p>the rabbit's carrot.</p> <p>today's news</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2-of","title":"2. of","text":"<p>the news of taday</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_6","title":"3. \u53cc\u91cd\u6240\u6709\u683c","text":"<p>I am a friend of Michael's.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_4","title":"\u56db\u3001\u4ee3\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_10","title":"1. \u4eba\u79f0\u4ee3\u8bcd","text":"\u6211 \u6211\u4eec \u4f60\uff0c\u4f60\u4eec \u4ed6 \u5979 \u5b83 \u4ed6\u4eec\u3001\u5979\u4eec\uff0c\u5b83\u4eec \u4e3b\u683c I we you he she it they \u5bbe\u683c me us you him her it them <p>you and I \u4f5c\u4e3b\u8bed</p> <p>you and me \u4f5c\u5bbe\u8bed</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_9","title":"2. \u7269\u4e3b\u4ee3\u8bcd","text":"\u6211\u7684 \u6211\u4eec\u7684 \u4f60\u7684\uff0c\u4f60\u4eec\u7684 \u4ed6\u7684 \u5979\u7684 \u5b83\u7684 \u4ed6\u4eec\u7684\u3001\u5979\u4eec\u7684\uff0c\u5b83\u4eec\u7684 \u5f62\u5bb9\u8bcd\u6027 my our your his her its their \u540d\u8bcd\u6027 min ours yours his hers its theirs"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_7","title":"3. \u53cd\u8eab\u4ee3\u8bcd","text":"\u6211\u81ea\u5df1 \u6211\u4eec\u81ea\u5df1 \u4f60\u81ea\u5df1 \u4f60\u4eec\u81ea\u5df1 \u5979\u81ea\u5df1 \u4ed6\u81ea\u5df1 \u5b83\u81ea\u5df1 \u4ed6\u4eec\u81ea\u5df1,\u5979\u4eec\u81ea\u5df1 \u5b83\u4eec\u81ea\u5df1 \u53cd\u8eab\u4ee3\u8bcd myself ourself yourself yourselves herself himself itself themselves itself"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#4_4","title":"4. \u76f8\u4e92\u4ee3\u8bcd","text":"<p>each other</p> <p>one another</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#5_2","title":"5. \u6307\u793a\u4ee3\u8bcd","text":"<p>this, these</p> <p>that, those</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#6_1","title":"6. \u4e0d\u5b9a\u4ee3\u8bcd","text":"<p>many \u4ee3\u66ff/\u4fee\u9970\u53ef\u6570\u540d\u8bcd\u590d\u6570; much \u4ee3\u66ff/\u4fee\u9970\u4e0d\u53ef\u6570\u540d\u8bcd</p> <p>a few \uff08\u80af\u5b9a\u610f\u4e49\uff09\u4e00\u4e9b; few \uff08\u5426\u5b9a\u610f\u4e49\uff09\u51e0\u4e4e\u6ca1\u6709 + \u53ef\u6570\u540d\u8bcd\u590d\u6570</p> <p>a little \uff08\u80af\u5b9a\u610f\u4e49\uff09\u4e00\u4e9b; little \uff08\u5426\u5b9a\u610f\u4e49\uff09\u51e0\u4e4e\u6ca1\u6709 + \u4e0d\u53ef\u6570\u540d\u8bcd</p> <p>some \u80af\u5b9a\u53e5\uff1bany \u5426\u5b9a\u8bed\u548c\u7591\u95ee\u53e5</p> <p>each \u53ef\u4f5c\u4ee3\u8bcd 2\u4e2a/2\u4e2a\u4ee5\u4e0a ; every + \u540d\u8bcd 3\u4e2a/3\u4e2a\u4ee5\u4e0a </p> <p>either \u4e24\u8005\u4e2d\u7684\u6bcf\u4e00\u4e2a\uff1b neither \u4e24\u8005\u4e2d\u7684\u6bcf\u4e00\u4e2a\u90fd\u4e0d\u3002 \u4e24\u8005\u4f5c\u4e3b\u8bed\u662f\u8c13\u8bed\u7528\u5355\u6570</p> <p>both; all </p> <p>other\uff1bthe other; another</p> <p>one; it</p> <p>\u590d\u5408\u4e0d\u5b9a\u4ee3\u8bcd\uff1beveryone/everybody; someone/somebody; anyone/anybody; no one/nobody</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#7_1","title":"7. \u7591\u95ee\u4ee3\u8bcd","text":"<p>who</p> <p>whom</p> <p>what</p> <p>which</p> <p>whose</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#8_1","title":"8. \u8fde\u63a5\u4ee3\u8bcd","text":"<p>\u5f15\u5bfc\u4e3b\u8bed\u4ece\u53e5\uff0c\u5bbe\u8bed\u4ece\u53e5\u548c\u8868\u8bed\u4ece\u53e5\uff1bwho whom whose what which whoever whomever whatever whichever</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#9","title":"9. \u5173\u7cfb\u4ee3\u8bcd","text":"<p>\u4e13\u7528\u4e8e\u5b9a\u8bed\u4ece\u53e5\uff1awho whom whose which that as</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_5","title":"\u4e94\u3001\u6570\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_11","title":"1.\u5206\u7c7b","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#11","title":"1.1 \u57fa\u6570\u8bcd","text":"<p>1-10: one two three four five six seven eight nine ten</p> <p>11-19: eleven twelve thirteen fourteen fifteen sixteen seventeen eighteen nineteen</p> <p>20-90: twenty thirty forty fifty sixty seventy eighty ninety</p> <p>\u51e0\u5341\u51e0: twenty-one</p> <p>\u767e hundred; \u5343 thousand; \u767e\u4e07 million; \u5343\u4e07 billion</p> <p>\u8868\u4e0d\u786e\u5b9a\u6570\u91cf\uff1ahundreds of; thousands of; millions of</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#12","title":"1.2 \u5e8f\u6570\u8bcd","text":"<p>\u7b2c1-19: first(1st) second(2nd) third(3td) fourth fifth sixth seventh eighth ninth tenth eleventh(11th) twelfth(12th) thirteenth(13th) fourteenth fifteenth sixteenth seventeenth eighteenth nineteenth</p> <p>\u7b2c20-90\uff1atwentieth thirtieth fortieth fiftieth sixtieth seventieth eightieth ninetieth</p> <p>\u7b2c\u51e0\u5341\u51e0\uff1atwenty-second, fifty-sixth</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_10","title":"2. \u7528\u6cd5","text":"<ol> <li> <p>\u5206\u6570 </p> <ol> <li>1/3 one third; </li> <li>3/5 three fifths;</li> <li>one second = a half; one fourth = a quarter</li> <li>two and one third </li> </ol> </li> <li> <p>\u5c0f\u6570 one point three four</p> </li> <li>\u767e\u5206\u6570 twenty-five percent</li> <li>\u500d\u6570<ol> <li>\u500d\u6570 + the + \u8ba1\u91cf + of: This carrot is half/twice/three times the size of that one.</li> <li>\u500d\u6570 + as ... as ...: I have half/twice/three times as many carrots as he has.</li> <li>\u500d\u6570 + \u6bd4\u8f83\u7ea7 + than: I can eat three times faster than he can.</li> <li>by + \u500d\u6570: I have increased my income by three times.</li> </ol> </li> <li>\u6570\u5b57\u7b26\u53f7\u548c\u7b97\u6570: 2 plus 2 is 4; 4 minus 2 is 2; 2 multiplied by/times 3 is 6; 8 divided by 4 is 2; 2 squared is 4; 2 cubed is 8; 4 is more than 3.</li> <li>\u5355\u4f4d\uff1a<ol> <li>\u65f6\u95f4\uff1a 7:00 at seven; 7:15 seven fifteen; 7:30 half past seven; 7:50  seven fifty</li> <li>\u65e5\u671f\uff1aDecember 12th, 2020; 2020s</li> <li>\u957f\u5ea6\uff1alength; width; height</li> </ol> </li> <li>\u9762\u79ef&amp;\u4f53\u79ef<ol> <li>This room is 20 by 35 meters.</li> <li>This room is 700 square meters.</li> <li>This box is 8 by 5 by 6 centimeters.</li> </ol> </li> <li>\u6e29\u5ea6 37 degrees (centigraded/Fahrenheit); 10 degrees below zero.</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_6","title":"\u516d\u3001\u5f62\u5bb9\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_12","title":"1. \u7528\u6cd5","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#11_1","title":"1.1 \u5b9a\u8bed","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_13","title":"1. \u524d\u7f6e\u5b9a\u8bed","text":"<p>a hungry rabbit</p> <p>\u524d\u7f6e\u5b9a\u8bed\u987a\u5e8f\uff1a\u9650\u5b9a\u8bcd(\u51a0\u8bcd\uff0c\u7269\u4e3b\u4ee3\u8bcd) + (\u4e3b\u89c2)\u7279\u5f81 + \u5c3a\u5bf8 + \u5f62\u72b6 + \u65b0\u65e7 + \u989c\u8272 + \u6765\u6e90 + \u6750\u6599 + \u7528\u9014</p> <p>a beautiful big round new black Chinese wooden table.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_11","title":"2. \u540e\u7f6e\u5b9a\u8bed","text":"<p>somebody nice \u67d0\u4e2a\u597d\u4eba</p> <p>anybody absent \u4e0d\u5728\u573a\u7684\u4eba</p> <p>everything possible \u6240\u6709\u53ef\u80fd\u7684\u4e8b</p> <p>nothing wrong \u6ca1\u4e0d\u5bf9\u7684\u4e8b</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_8","title":"3. \u5f62\u5bb9\u8bcd\u77ed\u8bed\u4f5c\u5b9a\u8bed","text":"<p>carrots good for the rabbit</p> <p>the rabbit eager to eat carrots = the rabbit that is eager to eat carrots.</p> <p>the rabbit busy eating carrots = the rabbit that is busy eating carrots</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#12_1","title":"1.2 \u8868\u8bed","text":"<p>The rabbit is hungry.</p> <p>The rabbit is alive/aleep/alone.</p> <p>a living/sleeping/lonely rabbit</p> <p>The rabbit is ill/well</p> <p>a sick/healthy rabbit.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#13","title":"1.3 \u8865\u8bed","text":"<p>Carrots make rabbits happy.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#14","title":"1.4 \u72b6\u8bed","text":"<p>The rabbit came home, tired and huntry.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_12","title":"2. \u6784\u6210","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#21_2","title":"2.1 \u5f62\u5bb9\u8bcd+\u5f62\u5bb9\u8bcd/\u73b0\u5728\u5206\u8bcd/\u8fc7\u53bb\u5206\u8bcd","text":"<p>a red-hot coal</p> <p>a good-looking rabbit</p> <p>a new-born baby</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#22_1","title":"2.2 \u526f\u8bcd+\u5f62\u5bb9\u8bcd/\u73b0\u5728\u5206\u8bcd/\u8fc7\u53bb\u5206\u8bcd","text":"<p>all-round \u5168\u9762\u7684</p> <p>hard-working</p> <p>recently-built</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#23_2","title":"2.3 \u5f62\u5bb9\u8bcd/\u6570\u8bcd+\u540d\u8bcd","text":"<p>white-haired</p> <p>kind-hearted wowan</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#24_2","title":"2.4 \u540d\u8bcd+\u5f62\u5bb9\u8bcd/\u73b0\u5728\u5206\u8bcd/\u8fc7\u53bb\u5206\u8bcd","text":"<p>a snow-white rabbit</p> <p>a carrot-eating rabbit</p> <p>a heart-broken rabbit</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_9","title":"3. \u6bd4\u8f83\u7ea7\u548c\u6700\u9ad8\u7ea7","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#31","title":"3.1 \u6784\u6210","text":"<p>\u4e00\u822c\u60c5\u51b5\uff1along-&gt;longer-&gt;longest</p> <p>e\u7ed3\u5c3e\uff1alate-&gt;later-&gt;latest</p> <p>\u8f85\u97f3+y\u7ed3\u5c3e\uff1ahappy-&gt;happier-&gt;happiest</p> <p>\u91cd\u8bfb\u95ed\u97f3\u8282\uff1abig-&gt;bigger-&gt;biggest</p> <p>\u591a\u97f3\u8282\u8bcd/\u90e8\u5206\u53cc\u97f3\u8282\uff1ainteresting-&gt;more interesting-&gt;most interesting</p> <p>\u4e0d\u89c4\u5219\uff1agood-&gt;better-&gt;best</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#32","title":"3.2 \u6bd4\u8f83\u7ea7\u7528\u6cd5","text":"<ol> <li>...\u6bd4...\u66f4...\uff1aThis carrot is bigger than that one.</li> <li>\u8d8a\u6765\u8d8a...\uff1aprettier and prettier, more and more beautiful</li> <li>\u8d8a...(\u539f\u56e0),\u5c31\u8d8a...(\u7ed3\u679c)\uff1aThe more carrots the rabbit eats, the smarter he will become.</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#33","title":"3.3 \u6700\u9ad8\u7ea7\u7528\u6cd5","text":"<ol> <li>in+\u5730\u70b9, of \u6240\u5c5e\u8303\u56f4\uff1aMigic mirror on the wall, who is the fairest one of all?</li> <li>\u6700\u9ad8\u7ea7\u524d\u52a0\u5e8f\u6570\u8bcd\uff0c\u8868\u7b2c\u51e0\u6700\uff1aMigic mirror on the wall, who is the second fairest one of all?</li> <li>the+\u6700\u9ad8\u7ea7\uff1aSnow White is the most beautiful wowan in the world.</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_7","title":"\u4e03\u3001\u526f\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_14","title":"1. \u7528\u6cd5","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#11_2","title":"1.1 \u4fee\u9970\u8bcd\u6027","text":"<ol> <li>\u4fee\u9970\u52a8\u8bcd\uff1aThis rabbit runs fast.</li> <li>\u4fee\u9970\u5f62\u5bb9\u8bcd\uff1aThis is a very fast rabbit.</li> <li>\u4fee\u9970\u526f\u8bcd\uff1aThis rabbit runs very fast.</li> <li>\u4fee\u9970\u540d\u8bcd\uff1aThis rabbit here runs very fast.</li> <li>\u4fee\u9970\u53e5\u5b50\uff1aObviously, This rabbit here runs very fast.</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#12_2","title":"1.2 \u53e5\u5b50\u4e2d\u7684\u6210\u5206","text":"<ol> <li>\u72b6\u8bed\uff0c\u5b9a\u8bed\uff1a Obviously, This rabbit here runs very fast.</li> <li>\u8868\u8bed\uff1aThe wolf is abroad. </li> <li>\u5bbe\u8bed\u8865\u8bed\uff1aLet me in.</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_13","title":"2. \u526f\u8bcd\u7684\u5f62\u5f0f","text":"<ol> <li>\u540c\u62fc\u5199\uff0c\u540c\u4e49/\u8fd1\u4e49</li> <li>This is a fast(adj.) rabbit.</li> <li>This rabbit run fast(adv.).</li> <li>\u540c\u62fc\u5199\uff0c\u5f02\u4e49</li> <li>This is a pretty(adj.) wolf.</li> <li>This is a pretty(adv.\u76f8\u5bf9\uff0c\u5f88) smart wolf.</li> <li>\u526f\u8bcd=\u5f62\u5bb9\u8bcd+ly\uff0c\u540c\u4e49/\u8fd1\u4e49</li> <li>This is a quick rabbit.</li> <li>This rabbit runs quickly.</li> <li>\u526f\u8bcd=\u5f62\u5bb9\u8bcd+ly\uff0c\u5f02\u4e49</li> <li>This is a large(\u5927\u7684) carrot.</li> <li>I largely(adv.\u57fa\u672c\u4e0a) only eat carrots.</li> </ol>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#3_10","title":"3. \u526f\u8bcd\u7684\u79cd\u7c7b","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#31_1","title":"3.1 \u65b9\u5f0f\u526f\u8bcd","text":"<p>\u4f4d\u4e8e\u53e5\u9996/\u53e5\u4e2d/\u53e5\u5c3e</p> <p>Suddenly, the driver turned left.</p> <p>The driver suddenly turned left.</p> <p>The driver turned left suddenly.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#32_1","title":"3.2 \u7a0b\u5ea6\u526f\u8bcd","text":"<p>\u4e00\u822c\u4f4d\u4e8e\u6240\u4fee\u9970\u8bcd\u4e4b\u524d</p> <p>This is a very fast rabbit.</p> <p>This rabbit runs very fast.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#33_1","title":"3.3 \u5730\u70b9\u526f\u8bcd","text":"<p>\u4e00\u822c\u4f4d\u4e8e\u53e5\u5c3e\uff0c\u4e5f\u53ef\u4f4d\u4e8e\u53e5\u9996\u8868\u5f3a\u8c03</p> <p>The rabbit eats carrots indoors/outdoors. </p> <p>Here you can relax and forget about all your troubles.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#34","title":"3.4 \u65f6\u95f4\u526f\u8bcd","text":"<p>\u4e00\u822c\u4f4d\u4e8e\u53e5\u5c3e\uff0c\u4e5f\u53ef\u4f4d\u4e8e\u53e5\u9996/\u53e5\u4e2d</p> <p>The rabbit ate some carrots yesterday.</p> <p>The rabbit is eating some carrots now.</p> <p>The rabbit will eat some carrots  later.</p> <p>The rabbit has already eaten some carrots.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#35","title":"3.5 \u9891\u7387\u526f\u8bcd","text":"<p>\u4f4d\u4e8e\u884c\u4e3a\u52a8\u8bcd\u4e4b\u524d\uff0cbe\u52a8\u8bcd/\u52a9\u52a8\u8bcd/\u60c5\u6001\u52a8\u8bcd\u4e4b\u540e</p> <p>The rabbit eats carrots every day.</p> <p>Sometimes, the rabbit eats carrots.</p> <p>The rabbit usually eat carrots.</p> <p>The rabbit eats carrots three times a day.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#36","title":"3.6 \u7591\u95ee\u526f\u8bcd","text":"<p>How does the rabbit eat carrots?</p> <p>Where does the rabbit eat carrots?</p> <p>When does the rabbit eat carrots?</p> <p>Why does the rabbit eat carrots?</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#37","title":"3.7 \u8fde\u63a5\u526f\u8bcd","text":"<p>How the rabbit eats carrots is interesting.</p> <p>I don't know where the rabbit eats carrots.</p> <p>That is why the rabbit eats carrots.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#38","title":"3.8 \u5173\u7cfb\u526f\u8bcd","text":"<p>This was the place where the rabbit ate the carrot.</p> <p>This is the reason why the rabbit ate the carrot.</p> <p>This was the day when the rabbit ate the carrot.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#39","title":"3.9 \u53e5\u5b50\u526f\u8bcd","text":"<p>\u4e00\u822c\u4f4d\u4e8e\u53e5\u5b50\u5f00\u5934\uff0c\u7528\u9017\u53f7\u4e0e\u4e3b\u53e5\u5206\u5f00</p> <p>Obviously, This rabbit here runs very fast.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#_8","title":"\u516b\u3001\u8fde\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#1_15","title":"1. \u5e76\u5217\u8fde\u8bcd","text":"<p>\u8fde\u63a5\u6709\u7740\u201c\u5e76\u5217\u7684\uff0c\u540c\u7b49\u8bed\u6cd5\u5730\u4f4d\u7684\u201d\u5355\u8bcd\uff0c\u8bcd\u7ec4\uff0c\u53e5\u5b50</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#11_3","title":"1.1 \u5e76\u5217\u5173\u7cfb","text":"<p>The rabbit is smart and cute.</p> <p>The rabbit not only teachers English but also make videos.</p> <p>The rabbit like neither apples not pears.</p> <p>Neither the rabbit nor the wolf likes apples.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#12_3","title":"1.2 \u9009\u62e9\u5173\u7cfb","text":"<p>What does the rabbit like? Apples or carrots?</p> <p>Either the rabbit or the wolf is going to the party this evening.</p> <p>The rabbit neither ate nor slept yesterday.</p> <p>Hurry up. or/or else/otherise you'll late.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#13_1","title":"1.3 \u8f6c\u6298\u5173\u7cfb","text":"<p>The rabbit cooked some carrots, but/yet he didn't eat any.</p> <p>I haven't eaten yet, yet I'm not hungry.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#14_1","title":"1.4 \u56e0\u679c\u5173\u7cfb","text":"<p>The rabbit is busy, so he won't go to the party tonight.</p> <p>The rabbit is busy. Therefor, he won't go to the party tonight.</p> <p>The rabbit will skip lunch, for he is busy making a video.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#2_14","title":"2. \u4ece\u5c5e\u8fde\u8bcd","text":""},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#21_3","title":"2.1 \u5f15\u5bfc\u540d\u8bcd\u6027\u4ece\u53e5","text":"<p>that\u5728\u5f15\u5bfc\u4e3b\u8bed\u4ece\u53e5\uff0c\u5bbe\u8bed\u4ece\u53e5\uff0c\u8868\u8bed\u4ece\u53e5\uff0c\u540c\u4f4d\u8bed\u4ece\u53e5\u65f6\uff0c\u53ea\u8d77\u8fde\u63a5\u4f5c\u7528\uff0c\u5728\u4ece\u53e5\u4e2d\u6ca1\u6709\u5b9e\u9645\u610f\u4e49\uff0c\u5728\u5bbe\u8bed\u4ece\u53e5\u4e2d\u53ef\u4ee5\u7701\u7565\u3002</p> <p>That the rabbit ate the carrot was obvious.</p> <p>I saw (that) the rabbit ate the carrot.</p> <p>I don't know if the rabbit ate the carrot.</p> <p>The fact is that the rabbit ate the carrot.</p> <p>The question whether the rabbit will eat the carrot is on all our minds.</p>"},{"location":"english/grammar/%E8%AF%8D%E6%80%A7/#22_2","title":"2.2 \u5f15\u5bfc\u526f\u8bcd\u6027\u4ece\u53e5\uff08\u72b6\u8bed\u4ece\u53e5\uff09","text":"<p>\u65f6\u95f4\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1awhen, while, as, before, after, until, since</p> <p>\u5730\u70b9\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1awhere, wherever</p> <p>\u6bd4\u8f83\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1athan, as</p> <p>\u6761\u4ef6\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1aif, unless</p> <p>\u8ba9\u6b65\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1aalthough, though, enen though, enen if, while</p> <p>\u65b9\u5f0f\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1aas, as if, as though</p> <p>\u539f\u56e0\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1abecause, since, as</p> <p>\u76ee\u7684\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1ain order that, so that, so</p> <p>\u7ed3\u679c\u72b6\u8bed\u4ece\u53e5\u8fde\u8bcd\uff1aso...that..., such...that..., so...that..., so</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/","title":"\u8bed\u6001","text":""},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#1","title":"1. \u4e3b\u52a8\u8bed\u6001","text":"<p>\u4e3b+\u8c13 </p> <p>\u4e3b+\u8c13+\u5bbe</p> <p>\u4e3b+\u8c13+\u95f4\u63a5\u5bbe\u8bed+\u76f4\u63a5\u5bbe\u8bed</p> <p>\u4e3b+\u8c13+\u5bbe\u8bed+\u5bbe\u8865 </p> <p>\u4e3b+be+\u8868</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#2","title":"2. \u88ab\u52a8\u8bed\u6001","text":"<p>be + \u52a8\u8bcd\u8fc7\u53bb\u5206\u8bcd</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#1_1","title":"1. \u4e3b+\u8c13","text":"<p>\u65e0\u88ab\u52a8\u8bed\u6001</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#2_1","title":"2. \u4e3b+\u8c13+\u5bbe","text":"<p>The rabbit ate the carrot.</p> <p>-&gt; The carrot was eaten (by the rabbit). (by+\u52a8\u4f5c\u6267\u884c\u8005)</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#3","title":"3. \u4e3b+\u8c13+\u5bbe+\u5bbe","text":"<p>The rabbit gave the carrot to the wolf.</p> <p>The wolf was given the carrot (by the rabbit).</p> <p>The carrot was given to the wolf (by the rabbit).</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#4","title":"4. \u4e3b+\u8c13+\u5bbe+\u5bbe\u8865","text":"<p>The wolf invited the rabbit to her party.</p> <p>-&gt; The rabbit was invited to the party by the wolf.</p> <p>The rabbit made the wolf laugh.</p> <p>-&gt; The wolf was made to laugh (by the rabbit).</p>"},{"location":"english/grammar/%E8%AF%AD%E6%80%81/#5","title":"5. \u4e3b+\u7cfb+\u8868","text":"<p>\u65e0\u88ab\u52a8</p>"},{"location":"linux/CA/","title":"\u6570\u5b57\u7b7e\u540d","text":""},{"location":"linux/CA/#1","title":"1. \u6570\u5b57\u7b7e\u540d","text":"<p>\u6570\u5b57\u7b7e\u540d\u5728\u52a0\u5bc6\u9886\u57df\u662f\u7528\u6765\u8fdb\u884c\u6d88\u606f\u7b7e\u540d\u548c\u9a8c\u8bc1\u6d88\u606f\u7b7e\u540d\u7684\u6280\u672f\uff0c\u76ee\u7684\u662f\u7528\u6765\u9a8c\u8bc1\u6d88\u606f\u7684\u771f\u5b9e\u6027\u3002</p> <p>\u6570\u5b57\u7b7e\u540d\u7684\u5e94\u7528\u975e\u5e38\u5e7f\u6cdb\uff0c\u7279\u522b\u662f\u5728\u91d1\u878d\u9886\u57df\uff08\u6bd4\u5982\u94f6\u884c\u8f6c\u8d26\uff09\u3002\u5728\u52a0\u5bc6\u8d27\u5e01\u9886\u57df\uff0c\u6570\u5b57\u7b7e\u540d\u6280\u672f\u4e00\u822c\u4f1a\u7528\u4e8e\u8f6c\u8d26\u4ea4\u6613\uff0c\u7b80\u5355\u6765\u8bf4\uff0c\u6bd4\u5982A\u7ed9B\u53d1\u90011\u4e2a\u6bd4\u7279\u5e01\uff0c\u4e3a\u4e86\u786e\u4fdd\u8f6c\u8d26\u7684\u771f\u5b9e\u6027\u548c\u5b89\u5168\uff0c\u6bd4\u7279\u5e01\u8f6c\u51fa\u65b9\uff0c\u4f1a\u628a\u4ea4\u6613\u4fe1\u606f\u505a\u4e00\u4e2a\u6570\u5b57\u7b7e\u540d\uff0c\u6765\u8bc1\u660e\u786e\u5b9e\u662f\u7531A\u8f6c\u7ed9B\u4e00\u4e2a\u6bd4\u7279\u5e01\uff0c\u7136\u540e\u5e7f\u64ad\u7ed9\u5168\u7f51\u3002</p>"},{"location":"linux/CA/#1_1","title":"1.  \u5de5\u4f5c\u539f\u7406","text":"<p>\u9996\u5148\u6570\u5b57\u7b7e\u540d\u4f9d\u8d56\u4e00\u4e2a\u516c\u94a5\u52a0\u5bc6\u7cfb\u7edf\uff0c\u4e5f\u5c31\u662f\u5b83\u9700\u8981\u6709\u4e00\u5bf9\u516c\u94a5\u79c1\u94a5\u3002\u7b7e\u540d\u548c\u9a8c\u8bc1\u7684\u57fa\u672c\u8fc7\u7a0b\u5982\u4e0b\uff1a </p> <p></p>"},{"location":"linux/CA/#1_2","title":"1. \u7b7e\u540d\u8fc7\u7a0b\uff08\u7b7e\u540d\u7531\u79c1\u94a5\u6301\u6709\u65b9\u53d1\u8d77\uff09","text":"<ol> <li>\u9996\u5148\u51c6\u5907\u4e00\u4e2a\u8981\u53d1\u9001\u7684\u660e\u6587\u6d88\u606f</li> <li>\u901a\u8fc7\u54c8\u5e0c\u7b97\u6cd5\uff0c\u628a\u8fd9\u6761\u660e\u6587\u6d88\u606f\u8f6c\u6210\u54c8\u5e0c\u503c</li> <li>\u4f7f\u7528\u79c1\u94a5\u5bf9\u8fd9\u4e2a\u54c8\u5e0c\u503c\u8fdb\u884c\u7b7e\u540d</li> <li>\u628a\u660e\u6587\u6d88\u606f\u8fde\u540c\u7b7e\u540d\u53d1\u9001\u7ed9\u516c\u94a5\u6301\u6709\u65b9</li> </ol>"},{"location":"linux/CA/#2","title":"2. \u9a8c\u8bc1\u8fc7\u7a0b\uff08\u516c\u94a5\u6301\u6709\u65b9\u8fdb\u884c\u7b7e\u540d\u9a8c\u8bc1\uff09","text":"<ol> <li>\u6536\u5230\u539f\u59cb\u660e\u6587\u4fe1\u606f\uff0c\u5bf9\u5176\u8fdb\u884c\u54c8\u5e0c\uff0c\u53d6\u5f97\u54c8\u5e0c\u503cH1</li> <li>\u901a\u8fc7\u516c\u94a5\u5bf9\u7b7e\u540d\u6d88\u606f\u8fdb\u884c\u89e3\u5bc6\uff0c\u53d6\u5f97\u54c8\u5e0c\u503cH2</li> <li>\u6bd4\u8f83H1\u548cH2\uff0c\u5982\u679c\u76f8\u7b49\uff0c\u5219\u8bc1\u660e\u53d1\u9001\u4fe1\u606f\u8005\uff0c\u786e\u5b9e\u4e3a\u79c1\u94a5\u62e5\u6709\u65b9\u3002</li> </ol>"},{"location":"linux/CA/#2_1","title":"2. \u5e38\u7528\u7684\u6570\u5b57\u7b7e\u540d\u7b97\u6cd5","text":"<p>\u5e38\u7528\u7684\u6570\u5b57\u7b7e\u540d\u7b97\u6cd5\u6709<code>RSA</code>\uff0c<code>DSA</code>\uff0c<code>ECDSA</code>\uff0c<code>EdDSA</code>\u7b49</p>"},{"location":"linux/CA/#2-digital-certificates","title":"2. \u6570\u5b57\u8bc1\u4e66\uff08Digital Certificates\uff09","text":"<p>\u8bc1\u4e66\u662f\u4e00\u4e2a\u5728\u6570\u5b57\u4e16\u754c\u91cc\u7528\u6765\u8ba4\u8bc1\u7528\u6237\u6216\u8005\u8bbe\u5907\u7684\u6280\u672f\uff0c\u7531\u4e00\u4e9b\u53d7\u4fe1\u4efb\u7684\u673a\u6784\u7b7e\u53d1\u4e00\u4e2a\u7279\u6b8a\u7684\u201c\u6587\u4ef6\u201d\u6765\u8bc1\u660e\u4e00\u4e2a\u79d8\u94a5\u5c5e\u4e8e\u7279\u5b9a\u7684\u7528\u6237\u548c\u8bbe\u5907\uff0c\u7528\u6237\u548c\u8bbe\u5907\u4ece\u800c\u53ef\u4ee5\u4f7f\u7528\u8be5\u8ba4\u8bc1\u8fc7\u7684\u79d8\u94a5\u6765\u4ee3\u8868\u81ea\u5df1\u7684\u8eab\u4efd\uff0c\u8fdb\u884c\u6d88\u606f\u7684\u4f20\u9012\u3002</p> <p>\u8fd9\u79cd\u7528\u6765\u7b7e\u53d1\u8bc1\u4e66\u7684\u673a\u6784\uff0c\u6211\u4eec\u79f0\u4e4b\u4e3acertificate authority (CA)\uff0c\u7ecf\u7531\u5b83\u7b7e\u53d1\u7684\u201c\u6587\u4ef6\u201d\u6211\u4eec\u79f0\u4e4b\u4e3acertificate\u8bc1\u4e66\u3002</p> <p>\u6211\u4eec\u7b7e\u540d\u8bb2\u8fc7\u7684\u6570\u5b57\u7b7e\u540d\u5728PKI\u4e2d\u626e\u6f14\u975e\u5e38\u91cd\u8981\u7684\u89d2\u8272\uff0ccertificate\u8bc1\u4e66\u7684\u5185\u5bb9\u662f\u4ec0\u4e48\uff1fCA\u662f\u600e\u4e48\u7b7e\u53d1\u8bc1\u4e66\u7684\u5462\uff1f</p> <p>certificate\u8bc1\u4e66\u5176\u5b9e\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u7b7e\u540d\uff0c\u6211\u4eec\u77e5\u9053\u6570\u5b57\u7b7e\u540d\u53ef\u4ee5\u9a8c\u8bc1\u8eab\u4efd\uff0c\u4f46\u662f\u524d\u63d0\u662f\u5bf9\u65b9\u6709\u4f60\u7684\u516c\u94a5\uff0c\u6240\u4ee5\u516c\u94a5\u7684\u5206\u53d1\u975e\u5e38\u5173\u952e\uff0c\u5982\u4f55\u8bc1\u660e\u8fd9\u4e2a\u516c\u94a5\u5c31\u662f\u4f60\u7684\u5462\uff1f\u7b54\u6848\u662f\uff0c\u627e\u4e00\u4e2a\u5927\u5bb6\u90fd\u4fe1\u4efb\u7684\u673a\u6784\uff08CA\uff09\u7ed9\u4f60\u7684\u516c\u94a5\u8fdb\u884c\u7b7e\u540d\uff0c\u83b7\u53d6\u5230\u8bc1\u4e66\uff0c\u522b\u4eba\u6536\u5230\u5c31\u4fe1\u4efb\u4f60\u7684\u516c\u94a5\u4e86\u3002</p> <p>\u6bd4\u5982\u5728\u6211\u4eec\u7684\u7cfb\u7edf\u4e2d\uff0c\u4e00\u822c\u90fd\u5185\u7f6e\u4e86\u4e00\u4e9b\u53d7\u4fe1\u4efb\u7684\u673a\u6784\u7684\u516c\u94a5\uff0c\u53ea\u8981\u6536\u5230\u8fd9\u4e9b\u673a\u6784\u7684\u7b7e\u540d\u6570\u636e\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u5c31\u53ef\u4ee5\u9a8c\u8bc1\u6570\u636e\u7684\u771f\u5047\u3002</p> <p>\u8bc1\u4e66\u5305\u542b\u4ee5\u4e0b\u5185\u5bb9 \uff1a</p> <ol> <li>\u8bc1\u4e66\u62e5\u6709\u8005\u7684\u57fa\u672c\u4fe1\u606f\uff0c\uff08\u6bd4\u5982HTTPS\u8bc1\u4e66\u7684\u8bdd\uff0c\u5305\u62ec\u62e5\u6709\u8005\u7684\u57df\u540dCNAME\uff0c\u516c\u53f8\u6216\u8005\u7ec4\u7ec7\u540d\u79f0\uff0c\u5730\u70b9\u7b49\uff09</li> <li>\u8bc1\u4e66\u9881\u53d1\u8005\u7684\u57fa\u672c\u4fe1\u606f</li> <li>\u8bc1\u4e66\u62e5\u6709\u8005\u7684\u516c\u94a5</li> <li>\u5bf9\u516c\u94a5\u548c\u5176\u4ed6\u4fe1\u606f\u7684\u7b7e\u540d </li> </ol> <p></p>"},{"location":"linux/CA/#3-openssl","title":"3. openssl\u751f\u6210\u81ea\u7b7e\u540d\u8bc1\u4e66","text":"<p>\u4e0d\u7ecf\u8fc7CA\uff0c\u81ea\u5df1\u901a\u8fc7\u81ea\u5df1\u7684\u79c1\u94a5\u8fdb\u884c\u7b7e\u540d\u4ea7\u751f\u8bc1\u4e66</p> <p>\u56e0\u4e3a\u662f\u81ea\u7b7e\u540d\uff0c\u6240\u4ee5\u6211\u4eec\u9700\u8981\u81ea\u5df1\u626e\u6f14CA\uff0c\u4f5c\u4e3aCA\u9881\u53d1\u8bc1\u4e66\u7684\u673a\u6784\uff0c\u9700\u8981\u51c6\u5907\uff1a</p> <ol> <li>\u4e00\u5bf9\u516c\u94a5\u79c1\u94a5public key\uff0cprivate key</li> <li>\u628a\u516c\u94a5\u5305\u88c5\u6210\u8bc1\u4e66\u7684\u683c\u5f0f\uff0c\u5206\u53d1\u51fa\u53bb\uff0c\u5728\u73b0\u5b9e\u4e2d\uff0c\u8fd9\u4e9bCA\u7684\u8bc1\u4e66\uff08\u6216\u8005\u53eb\u6839\u8bc1\u4e66\uff09\u4e00\u822c\u90fd\u5df2\u7ecf\u5305\u542b\u5728\u64cd\u4f5c\u7cfb\u7edf\u4e2d\u4e86\u3002</li> </ol>"},{"location":"linux/CA/#1-ca","title":"1. \u751f\u6210CA\u8bc1\u4e66","text":""},{"location":"linux/CA/#1-ca_1","title":"1. \u521b\u5efaCA\u79c1\u94a5","text":"<pre><code>ubuntu@ubuntu:~/ca$ openssl genrsa -out ca.key -des3 2048\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n..........................................................................+++++\n........................................................+++++\ne is 65537 (0x010001)\nEnter pass phrase for ca.key:    # \u8f93\u5165\u5bc6\u7801\uff1a123456\nVerifying - Enter pass phrase for ca.key:    # \u8f93\u5165\u5bc6\u7801\uff1a123456\nubuntu@ubuntu:~/ca$ ls\nca.key\n</code></pre> <p><code>-des3</code>\uff1a\u4f7f\u7528des3\u7b97\u6cd5\u5bf9\u79c1\u94a5\u8fdb\u884c\u52a0\u5bc6\u3002</p> <pre><code>ubuntu@ubuntu:~/ca$ cat ca.key \n-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: DES-EDE3-CBC,F526BBC32DB83B32\n\n8cgYjD+RrZx29x2kvJhw7hHWWROs6YDpU+bCMC6eR8FlboeMXmNAKdr/+74iKSug\niHwelqLPDdeyo/27aySkbgWr6wv2BZZvx7B7Mju9TrKAQ18+uIZMLSG36frBtLXD\nS59wUdEO1R0Y1pey66qSd7d3SaiV/gau1J4fvwNgp1DAOnePiZTOO0ekFSdxO+sH\nqbjXGBstwJLvxAo0mhbp0H9oHWXoLPT3iNeESsGezX+sEyk5y7hXyXfHg2+sQcRb\n607hQ8/rjcdtMFzA4GkYjC9PPzBf/+vizlf4Frt4gM3TtyzKRcKTLa9VhA7EGtf6\n4ktyI1o+bKQrHSvuwRhNNg0YxgQZCmlVm2iisKBIPccCNgPcfH3KJdK0OpG4nstS\n3Yutl4PmxbueSrg/P5cpQjor1B/atCime6bPfYITZhCY9mm9ULNxL+AJNMpb0dbG\nhXcRG31P8tucysSNntPAElCQ+6h0XmmkNGoFFiD2d6Y7fl3gYmigo8OHI1bbGoXT\niw59A0/y90faRwmLOFWXJxVvBDSuekf7UOJRHLarzSyoug7r/zWmdW9F/NrRZMlX\nGXsZ1SPeJx996LpE0/XkaTehFage6Q8zzFEcbBFoH1Z0Ru712d3NQx/10om8Z9sA\n6znm/CoVM0spnYvGeyjEyLBVCclGG+sFJQ306/WwtvgNGkOohFG5ZqVpX8qrvUQV\n9+4ZK6YMd6JLsli7aU4YJ3CbREakP81ygTepT6wzO7L9uEDg56Bjsrejd5glZSV5\nMRlOqnGicQUx6oeHXjy+MYocxeYsXyMNV0WmbcJLXScGjCfhkOkUbp1LkHC0HC7P\nIzgy7jTexFLD+iExUr7tSfUvV4mD/b8Eebr+5zEBDAnoVAQH+mVFHvUPNxKsWWj8\ngBkv8ciZQ/NozzS73RLzYXMExxq96dxuTZkQgjTGWgJl/GtZggw9wvmfWJnO5Qyf\n3FZW9nO827HIRCzZpuWZatkcjksqo9Z2+SHoI9gdxXAWWa0PN1VKfKBEmkb7elf/\ntY7JWS6kumD/1Qkns6IFVwWeZOxTv6jq6YIzPXWIjKiF3uzX5pRe2PHjr3Tujneb\nituMq60PX+xnXX3w8//GbNaN7POg+7VgyTST26DwoPoFlKh1yLPw2cOLqfG1D4iJ\nl0spUtN5tLgQwPNssXpONIrP148WBga741jPuSUBRkxZMhRgPh6XOenK1Kpnp+cu\nBZZxugfWyX3yWJxILZkqWqkx5NSrh9ofkjk/7UGwgYLWwpBzHPFpPcFfVD6HWwAB\nYpJr20BqhhsFq37yyBI4+WMwtYKicatd0vIE6Xwt5VxrcgyoyQl5qL/GEBTVi1I2\nfNqbs4D3PlaXzZqrTlMhCXdZgrjJHU6WmLXreBpuym1RCYTDO9+MEzVKmlGQZGEE\nzuP3ket3paJ7C+WnDclU9OLplOVxNXvmeO58ICycmR85jVFUazOJWH8T8QCc5PtU\nD+5qHZYOcecwsZ/FzOaFCNecl7DThMOZdpxY0KWNeCogrDKyrsxkTvIkGMymX74w\n/0H/19ySdj9bPmPPp28V2PUvEqvwr6dbhl0K4CDU+GPLp5OnNjM5Y/HYBvEYxa1F\n-----END RSA PRIVATE KEY-----\n</code></pre>"},{"location":"linux/CA/#2-ca","title":"2. \u751f\u6210CA\u6839\u8bc1\u4e66","text":"<pre><code>ubuntu@ubuntu:~/ca$ openssl rand -writerand  /home/ubuntu/.rnd\nubuntu@ubuntu:~/ca$ openssl req -x509 -key ca.key -out ca.crt -days 365\nEnter pass phrase for ca.key:    # \u8f93\u5165\u5bc6\u7801\uff1a123456\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:CN\nState or Province Name (full name) [Some-State]:BeiJing\nLocality Name (eg, city) []:BeiJing\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:RootCA\nOrganizational Unit Name (eg, section) []:RootCA\nCommon Name (e.g. server FQDN or YOUR name) []:www.rootca.com\nEmail Address []:admin@rootca.com\nubuntu@ubuntu:~/ca$ ls\nca.crt  ca.key\n</code></pre> <p>\u67e5\u770b\u8bc1\u4e66\u5185\u5bb9</p> <pre><code>ubuntu@ubuntu:~/ca$ openssl x509 -in ca.crt -text -noout\nCertificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number:\n            2a:10:79:8b:79:30:dc:c2:63:d7:10:00:ec:20:22:98:ba:93:07:95\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: C = CN, ST = BeiJing, L = BeiJing, O = RootCA, OU = RootCA, CN = www.rootca.com, emailAddress = admin@rootca.com\n        Validity\n            Not Before: Apr 22 11:54:35 2023 GMT\n            Not After : Apr 21 11:54:35 2024 GMT\n        Subject: C = CN, ST = BeiJing, L = BeiJing, O = RootCA, OU = RootCA, CN = www.rootca.com, emailAddress = admin@rootca.com\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                RSA Public-Key: (2048 bit)\n                Modulus:\n                    00:ef:3d:f2:5a:53:f5:ad:11:20:e3:81:14:1f:fe:\n                    a7:14:d0:1d:c7:fc:d4:6b:9f:5e:7e:95:8d:a7:38:\n                    c7:8b:30:ab:79:6c:9c:14:57:b6:a7:19:d6:b5:cb:\n                    37:e0:17:5d:b3:ba:15:74:81:2a:73:25:95:49:13:\n                    ff:fb:f9:c8:f5:11:17:16:b1:ba:20:4e:92:48:17:\n                    2c:56:3a:d3:11:2e:1e:c9:ff:90:06:aa:44:bc:2b:\n                    ff:fc:03:6e:b7:26:89:30:22:a9:c6:38:c5:4a:4e:\n                    25:b5:63:95:a9:d9:b0:1b:35:59:aa:08:00:42:dd:\n                    a4:8e:2b:6a:75:da:24:31:c5:56:2a:31:4b:9c:0a:\n                    77:2a:b4:4b:a4:11:c5:7c:6d:ad:57:f2:e8:71:8e:\n                    79:2e:63:a5:8e:7f:0c:24:96:b3:2a:26:fa:13:aa:\n                    50:df:0c:e8:c4:5b:bc:04:3b:cc:78:d1:5e:73:81:\n                    3e:fc:86:3b:7f:e1:e0:a8:eb:a8:e8:8a:79:d0:18:\n                    41:6a:50:41:d9:f8:d1:0a:2f:2d:9f:c7:af:cc:13:\n                    80:44:e0:c9:0c:4e:08:93:9d:63:39:29:7c:a6:68:\n                    a3:7d:95:06:af:e0:f5:6c:02:8f:85:58:ba:39:54:\n                    a3:6d:6d:19:fb:e6:33:de:3d:07:f3:44:22:62:03:\n                    a3:b3\n                Exponent: 65537 (0x10001)\n        X509v3 extensions:\n            X509v3 Subject Key Identifier: \n                27:A2:9C:C7:A2:0C:F1:EF:D5:3C:DA:90:D2:10:0B:D0:6C:B1:15:7B\n            X509v3 Authority Key Identifier: \n                keyid:27:A2:9C:C7:A2:0C:F1:EF:D5:3C:DA:90:D2:10:0B:D0:6C:B1:15:7B\n\n            X509v3 Basic Constraints: critical\n                CA:TRUE\n    Signature Algorithm: sha256WithRSAEncryption\n         07:01:c2:c8:54:45:d0:84:af:34:de:73:f4:20:fe:06:98:f8:\n         87:62:57:77:d6:c5:2b:15:93:88:f0:31:c4:2e:12:89:e1:eb:\n         bf:c9:da:c1:f7:6a:39:eb:0b:a1:aa:63:b7:97:25:66:75:1e:\n         fd:81:b3:07:3d:91:de:f8:d5:bb:02:51:63:91:1c:66:d4:3e:\n         72:ef:2b:5d:ea:fa:7b:96:85:48:ac:d9:07:ec:ba:df:a4:bb:\n         1c:5d:8e:e8:52:7a:6d:f6:b6:77:6e:43:9f:5a:bc:b2:ae:39:\n         85:95:d4:1c:7d:0e:bc:26:7b:c7:c6:62:0f:fc:8a:71:88:07:\n         69:7e:f1:e7:2d:36:f0:30:30:26:e4:70:1f:9c:fe:2c:c3:a5:\n         62:9f:6f:74:ce:58:10:4f:ec:92:df:30:88:b8:11:f2:51:ca:\n         14:72:af:13:e1:b6:e8:f7:eb:9d:20:08:35:33:47:dc:63:c9:\n         c5:72:31:16:0d:d4:f2:f3:c4:93:97:9f:8d:56:07:53:1f:b3:\n         82:44:b7:5e:a1:a8:1b:10:46:ac:39:96:dc:1c:90:4b:e7:fa:\n         b2:f8:57:a2:6a:7f:85:53:94:ef:2c:93:de:45:0f:26:99:bd:\n         14:1e:35:19:ce:70:af:ae:2e:0d:5e:b9:bd:56:04:29:e8:83:\n         6e:9d:46:dc\n</code></pre>"},{"location":"linux/CA/#2_2","title":"2. \u670d\u52a1\u5668\u7aef\u8bc1\u4e66","text":""},{"location":"linux/CA/#1_3","title":"1. \u751f\u6210\u79c1\u94a5","text":"<pre><code>ubuntu@ubuntu:~/site$ openssl genrsa -out server.key 2048\nGenerating RSA private key, 2048 bit long modulus (2 primes)\n...................................................................+++++\n............................+++++\ne is 65537 (0x010001)\nubuntu@ubuntu:~/site$ ls\nserver.key\n</code></pre> <p>\u4ece\u79c1\u94a5\u4e2d\u62bd\u53d6\u516c\u94a5</p> <pre><code>ubuntu@ubuntu:~/site$ openssl rsa -in server.key -pubout \nwriting RSA key\n-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAz3mBKdAnFVHRwBBQQosk\nlnROb+VjD1ZZgGGqCbNxe/6DTNeJrCNnkhI6q0oKHWkzfa02VfoRxceUxCxhOnVQ\nw54WEzcqVdlPYeruWbSusmq8etWKVILa1RXVUzpE0tZyg8YI5vdyoX8Pj3NfKhP9\nFuSXKqf2CfMCwocrPtMh0zhUIaTUXk1yJShn1+0MEl+0dBUsl0ANqHGvD1cBuYBS\nXaxDcAAWsqI56nctOAY135eNVLs8Fq+E+Q3knJ8/b/tTS4K2fDtatpctu1kKWoHp\nnwQgBGaRHtUOOHVdS4UBhox7nO1fuZHiNPY+VFTm/unaNY+VHSIscTqsY7BsD7Ao\nKwIDAQAB\n-----END PUBLIC KEY-----\n</code></pre>"},{"location":"linux/CA/#2_3","title":"2. \u751f\u6210\u7b7e\u540d\u8bf7\u6c42","text":"<pre><code>ubuntu@ubuntu:~/site$ openssl req -new -key server.key -out server.csr\nYou are about to be asked to enter information that will be incorporated\ninto your certificate request.\nWhat you are about to enter is what is called a Distinguished Name or a DN.\nThere are quite a few fields but you can leave some blank\nFor some fields there will be a default value,\nIf you enter '.', the field will be left blank.\n-----\nCountry Name (2 letter code) [AU]:CN\nState or Province Name (full name) [Some-State]:BeiJing\nLocality Name (eg, city) []:BeiJing\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:example\nOrganizational Unit Name (eg, section) []:dev\nCommon Name (e.g. server FQDN or YOUR name) []:www.example.com\nEmail Address []:admin@example.com\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\nubuntu@ubuntu:~/site$ ls\nserver.csr  server.key\n</code></pre> <p>\u6216\u8005</p> <pre><code>openssl req -new -key server.key -out server.csr -subj \"/C=CN/ST=BeiJing/L=BeiJing/O=example/OU=dev/CN=www.example.com/emailAddress=admin@example.com\"\n</code></pre> <p>\u67e5\u770b\u8bf7\u6c42\u5185\u5bb9</p> <pre><code>ubuntu@ubuntu:~/site$ openssl req -text -in server.csr -verify -noout \nverify OK\nCertificate Request:\n    Data:\n        Version: 1 (0x0)\n        Subject: C = CN, ST = BeiJing, L = BeiJing, O = example, OU = dev, CN = www.example.com, emailAddress = admin@example.com\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                RSA Public-Key: (2048 bit)\n                Modulus:\n                    00:cf:79:81:29:d0:27:15:51:d1:c0:10:50:42:8b:\n                    24:96:74:4e:6f:e5:63:0f:56:59:80:61:aa:09:b3:\n                    71:7b:fe:83:4c:d7:89:ac:23:67:92:12:3a:ab:4a:\n                    0a:1d:69:33:7d:ad:36:55:fa:11:c5:c7:94:c4:2c:\n                    61:3a:75:50:c3:9e:16:13:37:2a:55:d9:4f:61:ea:\n                    ee:59:b4:ae:b2:6a:bc:7a:d5:8a:54:82:da:d5:15:\n                    d5:53:3a:44:d2:d6:72:83:c6:08:e6:f7:72:a1:7f:\n                    0f:8f:73:5f:2a:13:fd:16:e4:97:2a:a7:f6:09:f3:\n                    02:c2:87:2b:3e:d3:21:d3:38:54:21:a4:d4:5e:4d:\n                    72:25:28:67:d7:ed:0c:12:5f:b4:74:15:2c:97:40:\n                    0d:a8:71:af:0f:57:01:b9:80:52:5d:ac:43:70:00:\n                    16:b2:a2:39:ea:77:2d:38:06:35:df:97:8d:54:bb:\n                    3c:16:af:84:f9:0d:e4:9c:9f:3f:6f:fb:53:4b:82:\n                    b6:7c:3b:5a:b6:97:2d:bb:59:0a:5a:81:e9:9f:04:\n                    20:04:66:91:1e:d5:0e:38:75:5d:4b:85:01:86:8c:\n                    7b:9c:ed:5f:b9:91:e2:34:f6:3e:54:54:e6:fe:e9:\n                    da:35:8f:95:1d:22:2c:71:3a:ac:63:b0:6c:0f:b0:\n                    28:2b\n                Exponent: 65537 (0x10001)\n        Attributes:\n            a0:00\n    Signature Algorithm: sha256WithRSAEncryption\n         b7:b2:80:b6:29:53:46:61:a5:23:ba:d6:60:b7:b2:cf:a0:fd:\n         cb:4d:25:50:9a:f0:b8:3e:e8:77:db:7f:f1:6a:fd:74:76:cc:\n         81:a5:34:cc:50:31:51:37:42:c2:ec:c3:71:1c:16:1e:5e:00:\n         e9:07:9d:07:7b:21:f6:4e:47:6e:02:2d:54:68:83:d3:bc:e4:\n         bf:1b:4e:32:c1:79:a7:79:3c:32:d7:10:ef:10:3c:1b:4d:5f:\n         ea:79:47:46:6c:48:68:98:50:da:cc:a4:c4:39:03:03:a1:37:\n         bb:47:44:92:d6:5f:99:9c:43:44:c0:79:2f:11:a1:d7:0a:6d:\n         d7:ef:d5:c7:a5:02:eb:7d:c6:d4:6b:72:8c:03:ac:9e:77:ee:\n         ce:a4:df:88:8b:a5:d0:3d:f1:e3:d5:29:05:cd:f8:6c:22:1f:\n         6f:bd:66:72:91:31:72:f2:78:8d:80:ef:48:86:81:54:71:fe:\n         8d:c9:0c:0c:f2:18:26:5a:f4:60:92:54:64:84:7b:1f:87:8a:\n         b5:8d:c7:c6:f4:ec:47:61:76:b8:24:1f:b4:c3:5d:84:bd:da:\n         9a:61:6c:ae:26:fb:fe:7a:ca:df:4e:e9:df:9e:87:48:e8:58:\n         2a:c1:ee:34:32:39:13:41:d1:0f:da:44:8b:cb:24:a9:fa:90:\n         02:d3:56:84\n</code></pre>"},{"location":"linux/CA/#3","title":"3. \u751f\u6210\u670d\u52a1\u5668\u8bc1\u4e66","text":"<pre><code>ubuntu@ubuntu:~/site$ openssl x509 -req -in server.csr -CA ../ca/ca.crt -CAkey ../ca/ca.key -CAcreateserial -out server.crt -days 365\nSignature ok\nsubject=C = CN, ST = BeiJing, L = BeiJing, O = example, OU = dev, CN = www.example.com, emailAddress = admin@example.com\nGetting CA Private Key\nEnter pass phrase for ../ca/ca.key:\nubuntu@ubuntu:~/site$ ls\nserver.crt  server.csr  server.key\n</code></pre> <p>\u67e5\u770b\u8bc1\u4e66\u5185\u5bb9</p> <pre><code>ubuntu@ubuntu:~/site$ openssl x509 -in server.crt -text -noout \nCertificate:\n    Data:\n        Version: 1 (0x0)\n        Serial Number:\n            70:8f:17:fa:48:1d:07:eb:12:90:00:b6:12:e7:17:9f:7c:43:a0:6c\n        Signature Algorithm: sha256WithRSAEncryption\n        Issuer: C = CN, ST = BeiJing, L = BeiJing, O = RootCA, OU = RootCA, CN = www.rootca.com, emailAddress = admin@rootca.com\n        Validity\n            Not Before: Apr 22 12:19:52 2023 GMT\n            Not After : Apr 21 12:19:52 2024 GMT\n        Subject: C = CN, ST = BeiJing, L = BeiJing, O = example, OU = dev, CN = www.example.com, emailAddress = admin@example.com\n        Subject Public Key Info:\n            Public Key Algorithm: rsaEncryption\n                RSA Public-Key: (2048 bit)\n                Modulus:\n                    00:cf:79:81:29:d0:27:15:51:d1:c0:10:50:42:8b:\n                    24:96:74:4e:6f:e5:63:0f:56:59:80:61:aa:09:b3:\n                    71:7b:fe:83:4c:d7:89:ac:23:67:92:12:3a:ab:4a:\n                    0a:1d:69:33:7d:ad:36:55:fa:11:c5:c7:94:c4:2c:\n                    61:3a:75:50:c3:9e:16:13:37:2a:55:d9:4f:61:ea:\n                    ee:59:b4:ae:b2:6a:bc:7a:d5:8a:54:82:da:d5:15:\n                    d5:53:3a:44:d2:d6:72:83:c6:08:e6:f7:72:a1:7f:\n                    0f:8f:73:5f:2a:13:fd:16:e4:97:2a:a7:f6:09:f3:\n                    02:c2:87:2b:3e:d3:21:d3:38:54:21:a4:d4:5e:4d:\n                    72:25:28:67:d7:ed:0c:12:5f:b4:74:15:2c:97:40:\n                    0d:a8:71:af:0f:57:01:b9:80:52:5d:ac:43:70:00:\n                    16:b2:a2:39:ea:77:2d:38:06:35:df:97:8d:54:bb:\n                    3c:16:af:84:f9:0d:e4:9c:9f:3f:6f:fb:53:4b:82:\n                    b6:7c:3b:5a:b6:97:2d:bb:59:0a:5a:81:e9:9f:04:\n                    20:04:66:91:1e:d5:0e:38:75:5d:4b:85:01:86:8c:\n                    7b:9c:ed:5f:b9:91:e2:34:f6:3e:54:54:e6:fe:e9:\n                    da:35:8f:95:1d:22:2c:71:3a:ac:63:b0:6c:0f:b0:\n                    28:2b\n                Exponent: 65537 (0x10001)\n    Signature Algorithm: sha256WithRSAEncryption\n         db:b7:f9:32:28:45:29:14:04:e2:49:87:b8:9c:4f:33:2d:ef:\n         5f:54:04:9c:2e:c0:f7:64:9c:ea:e0:14:96:c8:08:6f:6a:42:\n         9c:73:d9:35:3c:79:0f:57:7f:ae:36:d1:f2:99:fb:40:54:97:\n         93:a4:5e:d0:a1:fb:a6:e7:8a:7b:2b:23:ba:69:31:30:06:76:\n         19:88:e3:ed:5a:25:b7:32:00:e3:04:2a:52:23:c0:91:e2:5e:\n         c6:88:ee:22:4a:08:f4:b9:93:82:15:fe:6c:01:c8:66:fe:7d:\n         30:06:4a:48:a2:88:14:2f:09:dc:0c:04:41:c6:d9:a6:12:4d:\n         de:cf:e0:9f:21:aa:70:e6:8d:f4:c8:8f:4b:8d:a2:36:23:63:\n         4a:d4:c8:5d:22:9b:45:9a:0e:ed:1a:03:3d:33:ed:d6:4f:c2:\n         93:ea:9d:5b:1a:6a:7f:d5:9b:78:c3:f6:38:66:9f:84:8f:66:\n         0d:4d:6a:22:46:02:1b:64:21:00:36:32:26:85:ee:d9:85:3e:\n         38:85:1a:1b:b8:8c:33:e5:84:dc:bf:09:19:1c:95:f9:b8:24:\n         0c:df:54:72:df:24:80:3f:35:f0:a8:03:27:a0:82:85:7f:f3:\n         bb:5e:72:1e:22:b2:b4:ac:e6:40:6a:d1:16:e2:0e:e4:17:76:\n         1f:b6:6a:31\n</code></pre>"},{"location":"linux/ShellScript/","title":"Shell\u811a\u672c\u57fa\u7840","text":""},{"location":"linux/ShellScript/#_1","title":"\u4e00\u3001\u53d8\u91cf","text":""},{"location":"linux/ShellScript/#1","title":"1. \u53d8\u91cf\u5206\u7c7b","text":""},{"location":"linux/ShellScript/#11","title":"1.1 \u73af\u5883\u53d8\u91cf","text":"<p>\u7528\u6765\u5b58\u50a8\u6709\u5173shell\u4f1a\u8bdd\u548c\u5de5\u4f5c\u73af\u5883\u7684\u4fe1\u606f\u3002\u5728bash shell\u4e2d\u73af\u5883\u53d8\u91cf\u5206\u4e3a\u5168\u5c40\u53d8\u91cf\u548c\u5c40\u90e8\u53d8\u91cf\u3002</p> <p>\u73af\u5883\u53d8\u91cf\uff1a</p> <ol> <li> <p>\u5168\u5c40\u73af\u5883\u53d8\u91cf\uff1a\u5bf9\u4e8eshell\u4f1a\u8bdd\u548c\u6240\u6709\u751f\u6210\u7684\u5b50shell\u90fd\u662f\u53ef\u89c1\u7684\u3002</p> </li> <li> <p>\u5c40\u90e8\u73af\u5883\u53d8\u91cf\uff1a\u53ea\u5bf9\u521b\u5efa\u5b83\u4eec\u7684shell\u53ef\u89c1</p> </li> </ol> <p>\u4f7f\u7528<code>env</code>\u6216<code>printenv</code>\u67e5\u770b\u5168\u5c40\u53d8\u91cf\uff0c\u6240\u6709\u7684\u73af\u5883\u53d8\u91cf\u540d\u5747\u4f7f\u7528\u5927\u5199\u5b57\u6bcd\u3002</p> <pre><code>#!/bin/bash\n# \u73af\u5883\u53d8\u91cf\necho \"User Info:\"\necho \"user: $USER\"\necho \"UID : $EUID\"\necho \"home: $HOME\"\necho \u201c$HOSTNAME\u201d\n</code></pre> <p>\u5e38\u7528\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf</p> \u53d8\u91cf \u63cf\u8ff0 HOME \u5f53\u524d\u7528\u6237\u4e3b\u76ee\u5f55 BASH \u5f53\u524dshell\u7684\u5168\u8def\u5f84\u540d\uff08/bin/bash\uff09 BASH_SOURCE \u542b\u6709\u5f53\u524d\u6b63\u5728\u6267\u884c\u7684shell\u51fd\u6570\u6240\u5728\u6e90\u6587\u4ef6\u540d\u7684\u6570\u7ec4 FUNCTION \u5f53\u524d\u6267\u884c\u7684shell\u51fd\u6570\u7684\u540d\u79f0 HOSTNAME \u5f53\u524d\u4e3b\u673a\u7684\u540d\u79f0 LINENO \u5f53\u524d\u6267\u884c\u7684\u811a\u672c\u7684\u884c\u53f7 PWD \u5f53\u524d\u5de5\u4f5c\u76ee\u5f55"},{"location":"linux/ShellScript/#12","title":"1.2  \u7528\u6237\u53d8\u91cf","text":"<p>\u53d8\u91cf\u547d\u540d\u89c4\u5219\uff1a</p> <ol> <li>\u7531\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\u5927\u5c0f\u5199\u654f\u611f</li> <li>\u5927\u5c0f\u5199\u654f\u611f</li> </ol> <p>\u7528\u6237\u53d8\u91cf\u7684\u5206\u7c7b\uff1a</p> <ol> <li>\u5c40\u90e8\u7528\u6237\u53d8\u91cf</li> <li>\u5168\u5c40\u73af\u5883\u53d8\u91cf\uff1a\u4f7f\u7528<code>export \u53d8\u91cf\u540d</code>\u5c06\u5c40\u90e8\u53d8\u91cf\u5bfc\u51fa\u5230\u5168\u5c40\u73af\u5883\u4e2d\u3002</li> </ol> <pre><code>#!/bin/bash\n# \u7528\u6237\u53d8\u91cf\nvar1=100\nvar2=hello\nvar3=\"hello world\"\necho \"$var1 $var2 $var3\"\n</code></pre>"},{"location":"linux/ShellScript/#13","title":"1.3 \u7279\u6b8a\u53d8\u91cf","text":"\u53d8\u91cf \u542b\u4e49 <code>$0</code> \u5f53\u524d\u811a\u672c\u7684\u6587\u4ef6\u540d <code>$n</code> \u4f20\u9012\u7ed9\u811a\u672c\u6216\u51fd\u6570\u7684\u53c2\u6570\u3002n \u662f\u4e00\u4e2a\u6570\u5b57 <code>$#</code> \u4f20\u9012\u7ed9\u811a\u672c\u6216\u51fd\u6570\u7684\u53c2\u6570\u4e2a\u6570\u3002 <code>$*</code> \u4f20\u9012\u7ed9\u811a\u672c\u6216\u51fd\u6570\u7684\u6240\u6709\u53c2\u6570\u3002 <code>$@</code> \u4f20\u9012\u7ed9\u811a\u672c\u6216\u51fd\u6570\u7684\u6240\u6709\u53c2\u6570 <code>$?</code> \u4e0a\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\uff0c\u6216\u51fd\u6570\u7684\u8fd4\u56de\u503c\u3002 <code>$$</code> \u5f53\u524dShell\u8fdb\u7a0bID\u3002\u5bf9\u4e8e Shell \u811a\u672c\uff0c\u5c31\u662f\u8fd9\u4e9b\u811a\u672c\u6240\u5728\u7684\u8fdb\u7a0bID\u3002 <pre><code>#!/bin/bash\necho \"Total Number of Parameters : $#\"\necho \"File Name: $0\"\necho \"First Parameter : $1\"\necho \"First Parameter : $2\"\necho \"Quoted Values: $@\"\necho \"Quoted Values: $*\"\necho \"PID $$\"\necho \"$?\"\n</code></pre> <p>$@ \u4e0e $* \u7684\u533a\u522b</p> <p>\\(* \u548c \\(@ \u90fd\u8868\u793a\u4f20\u9012\u7ed9\u51fd\u6570\u6216\u811a\u672c\u7684\u6240\u6709\u53c2\u6570\uff0c\u4e0d\u88ab\u53cc\u5f15\u53f7(\" \")\u5305\u542b\u65f6\uff0c\u90fd\u4ee5\"\\)1\" \"\\)2\" \u2026 \"$n\" \u7684\u5f62\u5f0f\u8f93\u51fa\u6240\u6709\u53c2\u6570\u3002</p> <p>\u4f46\u662f\u5f53\u5b83\u4eec\u88ab\u53cc\u5f15\u53f7(\" \")\u5305\u542b\u65f6\uff0c\"\\(*\" \u4f1a\u5c06\u6240\u6709\u7684\u53c2\u6570\u4f5c\u4e3a\u4e00\u4e2a\u6574\u4f53\uff0c\u4ee5\"\\)1 \\(2 \u2026 \\(n\"\u7684\u5f62\u5f0f\u8f93\u51fa\u6240\u6709\u53c2\u6570\uff1b\"\\)@\" \u4f1a\u5c06\u5404\u4e2a\u53c2\u6570\u5206\u5f00\uff0c\u4ee5\"\\)1\" \"\\(2\" \u2026 \"\\)n\" \u7684\u5f62\u5f0f\u8f93\u51fa\u6240\u6709\u53c2\u6570\u3002</p> <pre><code>#!/bin/bash\necho '$@:'\nfor i in $@;do\n    echo $i\ndone\necho '\"$@:\"'\nfor i in \"$@\";do\n    echo $i\ndone\necho '$*:'\nfor i in $*;do\n    echo $i\ndone\necho '\"$*:\"'\nfor i in \"$*\";do\n    echo $i\ndone\n\u7ed3\u679c\uff1a\n$@:\n1\n2\n3\n\"$*\":\n1\n2\n3\n$@:\n1\n2\n3\n\"$*\":\n1 2 3\n</code></pre>"},{"location":"linux/ShellScript/#2","title":"2.\u53d8\u91cf\u5b9a\u4e49","text":""},{"location":"linux/ShellScript/#1_1","title":"1. \u53ea\u8bfb\u53d8\u91cf","text":"<pre><code>root@localhost:~# cat file.sh\n#!/bin/bash\nreadonly hours_per_day=24\nhours_per_day=12\n</code></pre> <p>\u66f4\u6539\u53d8\u91cf\u4f1a\u89e6\u53d1\u5f02\u5e38</p> <pre><code>root@localhost:~# ./file.sh\n./file.sh: line 3: hours_per_day: readonly variable\n</code></pre>"},{"location":"linux/ShellScript/#3","title":"3. \u53d8\u91cf\u66ff\u6362","text":"\u8bed\u6cd5 \u8bf4\u660e <code>${\u53d8\u91cf\u540d#\u5339\u914d\u89c4\u5219}</code> \u4ece\u53d8\u91cf\u5f00\u5934\u8fdb\u884c\u89c4\u5219\u5339\u914d\uff0c\u5c06\u7b26\u5408\u6700\u77ed\u7684\u6570\u636e\u5220\u9664 <code>${\u53d8\u91cf\u540d##\u5339\u914d\u89c4\u5219}</code> \u4ece\u53d8\u91cf\u5f00\u5934\u8fdb\u884c\u89c4\u5219\u5339\u914d\uff0c\u5c06\u7b26\u5408\u6700\u957f\u7684\u6570\u636e\u5220\u9664 <code>${\u53d8\u91cf\u540d%\u5339\u914d\u89c4\u5219}</code> \u4ece\u53d8\u91cf\u5c3e\u90e8\u8fdb\u884c\u89c4\u5219\u5339\u914d\uff0c\u5c06\u7b26\u5408\u6700\u77ed\u7684\u6570\u636e\u5220\u9664 <code>${\u53d8\u91cf\u540d%%\u5339\u914d\u89c4\u5219}</code> \u4ece\u53d8\u91cf\u5c3e\u90e8\u8fdb\u884c\u89c4\u5219\u5339\u914d\uff0c\u5c06\u7b26\u5408\u6700\u957f\u7684\u6570\u636e\u5220\u9664 <code>${\u53d8\u91cf\u540d/\u65e7\u5b57\u7b26\u4e32/\u65b0\u5b57\u7b26\u4e32}</code> \u53d8\u91cf\u5185\u5bb9\u7b26\u5408\u65e7\u5b57\u7b26\u4e32\u89c4\u5219\uff0c\u5219\u7b2c\u4e00\u4e2a\u65e7\u5b57\u7b26\u4e32\u4f1a\u88ab\u65b0\u5b57\u7b26\u4e32\u53d6\u4ee3 <code>${\u53d8\u91cf\u540d//\u65e7\u5b57\u7b26\u4e32/\u65b0\u5b57\u7b26\u4e32}</code> \u53d8\u91cf\u5185\u5bb9\u7b26\u5408\u65e7\u5b57\u7b26\u4e32\u89c4\u5219\uff0c\u5219\u5168\u90e8\u7684\u65e7\u5b57\u7b26\u4e32\u4f1a\u88ab\u65b0\u5b57\u7b26\u4e32\u53d6\u4ee3"},{"location":"linux/ShellScript/#4","title":"4. \u53d8\u91cf\u6d4b\u8bd5\uff08\u4e0d\u5e38\u7528\uff09","text":"\u8fd0\u7b97\u7b26 \u7528\u9014 <code>${varname:-word}</code> \u5982\u679c\u53d8\u91cf\u5b58\u5728\u4e14\u975enull\uff0c\u5219\u8fd4\u56de\u5176\u503c\uff1b\u5426\u5219\u8fd4\u56deword <code>${varname:=word}</code> \u5982\u679c\u53d8\u91cf\u5b58\u5728\u4e14\u975enull\uff0c\u5219\u8fd4\u56de\u5176\u503c\uff1b\u5426\u5219\u8bbe\u7f6e\u5b83\u7684\u503c\u4e3aword\u5e76\u8fd4\u56de <code>${varname:+word}</code> \u5982\u679c\u53d8\u91cf\u5b58\u5728\u4e14\u975enull\uff0c\u5219\u8fd4\u56deword;\u5426\u5219\u8fd4\u56denull <code>${varname:?message}</code> \u5982\u679c\u53d8\u91cf\u5b58\u5728\u4e14\u975enull,\u5219\u8fd4\u56de\u5176\u503c\uff1b\u5426\u5219\u663e\u793amessage\uff0c\u5e76\u9000\u51fa\u5f53\u524d\u811a\u672c\u6216\u547d\u4ee4; message\u9ed8\u8ba4\u4fe1\u606f\u4e3a\uff1aparameter null or not set"},{"location":"linux/ShellScript/#5","title":"5.\u5b57\u7b26\u4e32\u5904\u7406","text":""},{"location":"linux/ShellScript/#51","title":"5.1 \u8ba1\u7b97\u5b57\u7b26\u4e32\u957f\u5ea6","text":"<p>\u65b9\u6cd51\uff1a<code>${#string}</code></p> <p>\u65b9\u6cd52\uff1a<code>expr length \"$string\"</code></p>"},{"location":"linux/ShellScript/#52","title":"5.2 \u83b7\u53d6\u5b57\u7b26\u5728\u5b57\u7b26\u4e32\u4e2d\u7684\u7d22\u5f15\u4f4d\u7f6e","text":"<p><code>expr index $string substring</code></p>"},{"location":"linux/ShellScript/#53","title":"5.3 \u8ba1\u7b97\u5b50\u4e32\u957f\u5ea6","text":"<p><code>expr match $string substr</code></p> <pre><code>expr match \"hello world\" .*w  # 7\n</code></pre>"},{"location":"linux/ShellScript/#54","title":"5.4 \u62bd\u53d6\u5b50\u4e32","text":"\u8bed\u6cd5 \u8bf4\u660e <code>${string:position}</code> \u4ecestring\u4e2d\u7684position\u5f00\u59cb <code>${string:position:length}</code> \u4eceposition\u5f00\u59cb\uff0c\u5339\u914d\u957f\u5ea6\u4e3alength <code>${string:-position}</code> \u4ece\u53f3\u8fb9\u5f00\u59cb\u5339\u914d <code>${string:(position)}</code> \u4ece\u5de6\u8fb9\u5f00\u59cb\u5339\u914d <code>expr substr $string $postion $length</code> \u4eceposition\u5f00\u59cb\uff0c\u5339\u914d\u957f\u5ea6\u4e3alength <p>\u6ce8\u610f\uff1a\u4f7f\u7528expr\u7d22\u5f15\u8ba1\u6570\u4ece1\u5f00\u59cb\uff1b\u4f7f\u7528${:}\uff0c\u7d22\u5f15\u8ba1\u6570\u4ece1\u5f00\u59cb\u3002</p>"},{"location":"linux/ShellScript/#6","title":"6. \u547d\u4ee4\u66ff\u6362","text":"<p>\u628a\u547d\u4ee4\u7684\u6267\u884c\u7ed3\u679c\u8d4b\u7ed9\u53d8\u91cf</p> <pre><code>#!/bin/bash\n# \u65b9\u6cd51\ntime=`date +%y%m%d`\n# \u65b9\u6cd52    \u63a8\u8350\u4f7f\u7528\ntime=$(date +%y%m%d)\n</code></pre>"},{"location":"linux/ShellScript/#7","title":"7.\u6709\u7c7b\u578b\u53d8\u91cf","text":"<p>\u4f7f\u7528<code>declare</code>\u6216<code>typeset</code>\u5b9a\u4e49\u53d8\u91cf\u7c7b\u578b</p> \u53c2\u6570 \u542b\u4e49 <code>-r</code> \u5c06\u53d8\u91cf\u8bbe\u4e3a\u53ea\u8bfb <code>-i</code> \u5c06\u53d8\u91cf\u8bbe\u4e3a\u6574\u6570 <code>-a</code> \u5c06\u53d8\u91cf\u5b9a\u4e49\u4e3a\u6570\u7ec4 <code>-f</code> \u663e\u793a\u6b64\u811a\u672c\u524d\u5b9a\u4e49\u8fc7\u5f97\u6240\u6709\u51fd\u6570\u53ca\u5185\u5bb9 <code>-F</code> \u4ec5\u663e\u793a\u6b64\u811a\u672c\u524d\u5b9a\u4e49\u8fc7\u5f97\u51fd\u6570\u540d <code>-x</code> \u5c06\u53d8\u91cf\u58f0\u660e\u4e3a\u73af\u5883\u53d8\u91cf"},{"location":"linux/ShellScript/#_2","title":"\u4e8c\u3001\u6570\u7ec4","text":""},{"location":"linux/ShellScript/#1_2","title":"1. \u6570\u7ec4\u7684\u5b9a\u4e49","text":"<p>1.1 \u65b9\u6cd5\u4e00\uff1a</p> <pre><code>arr=(1 2 3 4 5)\n</code></pre> <p>1.2 \u65b9\u6cd5\u4e8c\uff1a</p> <pre><code>arr[0]=1\narr[1]=2\narr[2]=3\n</code></pre>"},{"location":"linux/ShellScript/#2_1","title":"2. \u8f93\u51fa\u6570\u7ec4\u4e2d\u7684\u503c","text":"<pre><code>root@localhost:~# arr=(1 2 3 4 5)\nroot@localhost:~# echo ${arr[2]}\n3\nroot@localhost:~# echo ${arr[*]}\n1 2 3 4 5\nroot@localhost:~# echo ${arr[@]}\n1 2 3 4 5\n</code></pre>"},{"location":"linux/ShellScript/#3_1","title":"3. \u5173\u8054\u6570\u7ec4","text":"<p>\u666e\u901a\u6570\u7ec4\u53ea\u80fd\u4f7f\u7528\u6574\u6570\u4f5c\u4e3a\u7d22\u5f15\u503c\uff0c\u800c\u5173\u8054\u6570\u7ec4\u53ef\u4ee5\u4f7f\u7528\u4efb\u610f\u6587\u672c\u4f5c\u4e3a\u7d22\u5f15\u503c\uff08\u6709\u70b9\u7c7b\u4f3c\u4e8ePython\u4e2d\u7684\u5b57\u5178\uff09\uff0c\u5173\u8054\u6570\u7ec4\u53ea\u5728bash 4.0\u4ee5\u4e0a\u652f\u6301\u3002</p> <pre><code>root@localhost:~# declare -A person\nroot@localhost:~# person=([name]=\"Wang\" [age]=18)\nroot@localhost:~# echo ${person[name]}\nWang\nroot@localhost:~# echo ${person[age]}\n18\nroot@localhost:~# echo ${person[*]}\nWang 18\n</code></pre>"},{"location":"linux/ShellScript/#_3","title":"\u4e09\u3001\u6570\u5b66\u8ba1\u7b97","text":""},{"location":"linux/ShellScript/#1-let","title":"1. <code>let</code>","text":"<p>let\u547d\u4ee4\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u57fa\u672c\u7684\u7b97\u6570\u64cd\u4f5c\uff0c\u5e76\u4e14\u53d8\u91cf\u540d\u4e4b\u524d\u4e0d\u9700\u8981\u6dfb\u52a0<code>$</code>\u3002</p> <pre><code>gp@gp:~$ a=2\ngp@gp:~$ b=3\ngp@gp:~$ let c=a+b\ngp@gp:~$ echo $c\n5\n# let \u8fd8\u53ef\u4ee5\u6267\u884c\u81ea\u52a0\u81ea\u51cf\u64cd\u4f5c\ngp@gp:~$ let a++\ngp@gp:~$ let b--\ngp@gp:~$ echo $a $b\n3 2\n</code></pre>"},{"location":"linux/ShellScript/#2-expr","title":"2. <code>expr</code>","text":"<pre><code>#!/bin/bash\n# expr \u548c = \u4e4b\u95f4\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\nvar= expr 1 + 2\necho $var\n</code></pre> <p><code>expr</code>\u64cd\u4f5c\u7b26\u5bf9\u7167\u8868</p> \u64cd\u4f5c\u7b26 \u542b\u4e49 <code>num1 | num2</code> num1\u4e0d\u4e3a\u7a7a\u4e14\u975e0\uff0c\u8fd4\u56denum1\uff1b\u5426\u5219\u8fd4\u56denum2 <code>num1 &amp; num2</code> num1\u4e0d\u4e3a\u7a7a\u4e14\u975e0\uff0c\u8fd4\u56denum1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 &lt; num2</code> num1\u5c0f\u4e8enum2\uff0c\u8fd4\u56de1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 &lt;= num2</code> num1\u5c0f\u4e8e\u7b49\u4e8enum2\uff0c\u8fd4\u56de1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 = num2</code> num1\u7b49\u4e8enum2\uff0c\u8fd4\u56de1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 != num2</code> num1\u4e0d\u7b49\u4e8enum2\uff0c\u8fd4\u56de1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 &gt; num2</code> num1\u5927\u4e8enum2\uff0c\u8fd4\u56de1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 &gt;= num2</code> num1\u5927\u4e8e\u7b49\u4e8enum2\uff0c\u8fd4\u56de1\uff1b\u5426\u5219\u8fd4\u56de0 <code>num1 + num2</code> \u6c42\u548c <code>num1 - num2</code> \u6c42\u5dee <code>num1 * num2</code> \u6c42\u79ef <code>num1 / num2</code> \u6c42\u5546 <code>num1 % num2</code> \u6c42\u4f59 <p>\u4f7f\u7528\u65f6\u8981\u5bf9\u7279\u6b8a\u5b57\u7b26\u8fdb\u884c\u8f6c\u4e49<code>expr 5 \\* 2</code></p>"},{"location":"linux/ShellScript/#3_2","title":"3. <code>[ ]</code> \u4e0e <code>(( ))</code>","text":"<pre><code>#!/bin/bash\nvar=$[ 1 + 2 ]\nvar=$(( 3 + 4 ))\n</code></pre>"},{"location":"linux/ShellScript/#4-bc","title":"4. <code>bc</code>","text":"<p>\u4e0a\u8ff0\u4e24\u79cd\u53ea\u80fd\u8ba1\u7b97\u6574\u6570\uff0c\u5bf9\u4e8e\u6d6e\u70b9\u6570\u9700\u8981\u4f7f\u7528<code>bc</code> \u5728\u811a\u672c\u4e2d\u4f7f\u7528<code>bc</code>\u7684\u683c\u5f0f\uff1a</p> <pre><code>variable=`echo \"option; expression\" |bc`\n</code></pre> <pre><code>#!/bin/bash\nvar=`echo \"scale=2;5/3\" | bc`\necho $var\n</code></pre>"},{"location":"linux/ShellScript/#_4","title":"\u56db\u3001\u903b\u8f91\u63a7\u5236","text":""},{"location":"linux/ShellScript/#1-if","title":"1. if","text":""},{"location":"linux/ShellScript/#11-if-then","title":"1.1  if-then","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>if command\nthen\n    command\nfi\n</code></pre> <p>\u4f8b\uff1a</p> <pre><code>#!/bin/bash\nif date\nthen\n    echo \"command is succeed\"\nfi\n</code></pre>"},{"location":"linux/ShellScript/#12-if-then-else","title":"1.2 if-then-else","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>if command\nthen\n    command\nelse\n     command\nfi\n</code></pre> <p>\u4f8b\uff1a</p> <pre><code>#!/bin/bash\n# \u67e5\u627e\u7cfb\u7edf\u4e2d\u662f\u5426\u5b58\u5728httpd\u7528\u6237\nif grep httpd /etc/passwd\nthen\n    echo \"httpd is exist\"\nelse\n    echo \"httpd not find\"\nfi\n</code></pre>"},{"location":"linux/ShellScript/#13-if","title":"1.3 if\u5d4c\u5957","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>if command\nthen\n    command\nelif command\n    command\nelse\n     command\nfi\n</code></pre>"},{"location":"linux/ShellScript/#2-test","title":"2. test","text":"<p>\u529f\u80fd\uff1a</p> <ol> <li>\u6570\u503c\u6bd4\u8f83</li> <li>\u5b57\u7b26\u4e32\u6bd4\u8f83</li> <li>\u6587\u4ef6\u6bd4\u8f83</li> </ol> <p>\u683c\u5f0f\uff1a</p> <pre><code>test condition\n\u6216\n[ command ]  \n</code></pre>"},{"location":"linux/ShellScript/#21","title":"2.1 \u6570\u503c\u6bd4\u8f83","text":"\u6bd4\u8f83 \u63cf\u8ff0 <code>-eq</code> \u7b49\u4e8e <code>-ge</code> \u5927\u4e8e\u7b49\u4e8e <code>-gt</code> \u5927\u4e8e <code>-le</code> \u5c0f\u4e8e\u7b49\u4e8e <code>-lt</code> \u5c0f\u4e8e <code>-ne</code> \u4e0d\u7b49\u4e8e <p>\u4f8b\uff1a</p> <pre><code>#!/bin/bash\ndate\nif [ $? -eq 0 ];then\n   echo \"command is succeed\"\nfi\n# \u6216\nif test date;then\n   echo \"command is succeed\"\nfi\n</code></pre>"},{"location":"linux/ShellScript/#22","title":"2.2 \u5b57\u7b26\u4e32\u6bd4\u8f83","text":"\u6bd4\u8f83 \u63cf\u8ff0 \u4f8b <code>str1 = str2</code> \u5b57\u7b26\u4e32\u662f\u5426\u76f8\u540c <code>str1 != str2</code> \u5b57\u7b26\u4e32\u662f\u5426\u4e0d\u540c <code>str1 &lt; str2</code> str1\u662f\u5426\u6bd4str2\u5c0f <code>str1 &gt; str2</code> str1\u662f\u5426\u6bd4str2\u5927 <code>[ b \\&gt; a  ] &amp;&amp; echo \"true\"</code>\uff08\u6ce8\u610f&gt;\u9700\u8981\u8f6c\u4e49\uff09 <code>-n str</code> \u5b57\u7b26\u4e32\u957f\u5ea6\u975e0\u4e3a\u771f <code>[ -n \"str\" ] &amp;&amp; echo \"str is not null\"</code> <code>-z str</code> \u5b57\u7b26\u4e32\u957f\u5ea6\u4e3a0\u4e3a\u771f <code>[ -z \"\" ] &amp;&amp; echo \"str is null\"</code>"},{"location":"linux/ShellScript/#23","title":"2.3 \u6587\u4ef6\u6bd4\u8f83","text":"\u6bd4\u8f83 \u63cf\u8ff0 <code>-d file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u662f\u4e00\u4e2a\u76ee\u5f55 <code>-f file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u662f\u4e00\u4e2a\u76ee\u5f55 <code>-e file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728 <code>-r file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u53ef\u8bfb <code>-s file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u975e\u7a7a <code>-w file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u53ef\u5199 <code>-x file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u53ef\u6267\u884c <code>-O file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u5c5e\u5f53\u524d\u7528\u6237\u6240\u6709 <code>-G file</code> \u68c0\u67e5file\u662f\u5426\u5b58\u5728\u5e76\u4e14\u9ed8\u8ba4\u7ec4\u4e0e\u5f53\u524d\u7528\u6237\u76f8\u540c <code>file1 -nt file2</code> file1\u662f\u5426\u6bd4file2\u65b0 <code>file1 -ot file2</code> file1\u662f\u5426\u6bd4file2\u65e7"},{"location":"linux/ShellScript/#24","title":"2.4 \u590d\u5408\u6761\u4ef6","text":"<pre><code>[ condition1 ] &amp;&amp; [ condition2 ]\n[ condition1 ] || [ condition2 ]\n</code></pre>"},{"location":"linux/ShellScript/#3-case","title":"3. case","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>case variable in\n    pattern1 | pattern2) command1;;\n    pattern3) command2;;\n    *) default command;;\nesca\n</code></pre> <p>\u4f8b\uff1a</p> <pre><code>#!/bin/bash\nread -p \"input something: \" var\ncase $var in\n[0-9])\n    echo \"number\";;\n[a-z])\n    echo \"character\";;\n*)\n    echo \"other\";;\nesac\n</code></pre>"},{"location":"linux/ShellScript/#4-for","title":"4. for","text":""},{"location":"linux/ShellScript/#41-bashfor","title":"4.1 bash\u4e2d\u7684for","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>for var in list\ndo\n    command\ndone\n</code></pre> <p>\u4f8b1\uff1a\u67e5\u770b\u670d\u52a1\u72b6\u6001</p> <pre><code>#!/bin/bash\nfor service in apache2 mysqld zabbix-server zabbix-agent\ndo\n    status=$(systemctl status mysql | awk '/Active/ {print $2,$3}')\n    echo $service $status\ndone\n</code></pre> <p>\u4f8b2\uff1a\u4f7f\u7528\u901a\u914d\u7b26</p> <pre><code>#!/bin/bash\n# \u6ce8\u610f\u5728$file\u4e0a\u52a0\u201c\u201d\uff0c\u5426\u5219\u5982\u679c\u51fa\u73b0\u5e26\u7a7a\u683c\u7684\u76ee\u5f55\u540d\uff0c\u811a\u672c\u4f1a\u51fa\u9519\nfor file in /tmp/*\ndo\n    if [ -d \"$file\" ]\n    then\n        echo \"$file\" is a directory\n    elif [ -f \"$file\" ]\n    then\n        echo \"$file\" is a file\n    fi\ndone\n</code></pre>"},{"location":"linux/ShellScript/#42-c-for","title":"4.2 C \u8bed\u8a00\u98ce\u683c\u7684for","text":"<p>\u4f8b\uff1a</p> <pre><code>#!/bin/bash\nfor (( i=1; i&lt;=10; i++ ))\ndo\n    echo $i\ndone\n\n#!/bin/bash\n# \u5355\u53d8\u91cf\nfor (( i=1; i&lt;=10; i++ ))\ndo\n    echo $i\ndone\n# \u591a\u53d8\u91cf\nfor (( i=1,j=10; i&lt;=10; i++,j-- ))\ndo\n    echo $i $j\ndone\n</code></pre>"},{"location":"linux/ShellScript/#5-while","title":"5. while","text":"<p>\u4f8b\uff1a\u68c0\u6d4b\u7ad9\u70b9\u72b6\u6001</p> <pre><code>#!/bin/bash\n\nurls=\"\nhttps://www.baidu.com\nhttps://www.taobao.com\nhttps://www.jd.com/abc\nhttps://www.12306.cn/index/\n192.168.1.111\n\"\nfor url in $urls;do\n    count=0\n    while [ $count -lt 3 ];do\n       STATUS=$(curl -I -m 10 -o /dev/null -s -w %{http_code} $url)\n\n       if [ $STATUS -eq 200 ];then\n          echo \"$url  OK\"\n          break 1\n       fi\n       count=$(($count+1))\n    done\n    if [ $count -eq 3 ];then\n       echo \"$url Error\"\n    fi\ndone\n</code></pre>"},{"location":"linux/ShellScript/#6-until","title":"6. until","text":"<pre><code>#!/bin/bash\nvar=10\nuntil [ $var -eq 0 ];do\n    var=$[$var-2]\n    echo $var\ndone\n</code></pre>"},{"location":"linux/ShellScript/#7_1","title":"7. \u63a7\u5236\u5faa\u73af","text":""},{"location":"linux/ShellScript/#71-break","title":"7.1 break","text":"<pre><code>#!/bin/bash\n# break \u8df3\u51fa\u5f53\u524d\u5faa\u73af\n# break n \u8df3\u51fan\u5c42\u5faa\u73af\nfor (( i=0; i&lt;10; i++ ));do\n    if [ $i -eq 5 ];then\n       break\n    fi\n    echo $i\ndone\n</code></pre>"},{"location":"linux/ShellScript/#72-continue","title":"7.2 continue","text":""},{"location":"linux/ShellScript/#_5","title":"\u4e94\u3001\u8f93\u5165","text":""},{"location":"linux/ShellScript/#1_3","title":"1. \u547d\u4ee4\u884c\u53c2\u6570","text":"<p>\u4f8b1\uff1a</p> <pre><code>#!/bin/bash\necho $1+$2=$[$1+$2]\n\n./add.sh  3 4\n3+4=7\n</code></pre> <p>\u4f8b2\uff1a<code>shift</code></p> <pre><code>#!/bin/bash\n# \u628a\u53d8\u91cf\u7684\u4f4d\u7f6e\u5411\u5de6\u79fb\nwhile [ -n \"$1\" ];do\n    echo $1\n    shift\ndone\n</code></pre>"},{"location":"linux/ShellScript/#2getopts","title":"2.getopts","text":"<p>\u683c\u5f0f\uff1a<code>getopts optstring variable</code></p> <p>optstring:  \u9009\u9879\u5b57\u6bcd\uff0c\u5982\u679c\u5b57\u6bcd\u8981\u6c42\u6709\u53c2\u6570\u5c31\u52a0\u4e00\u4e2a<code>:</code>\uff0c\u8981\u53bb\u6389\u9519\u8bef\u6d88\u606f\u7684\u8bdd\u53ef\u4ee5\u5728optstring\u524d\u52a0\u4e00\u4e2a<code>:</code></p> <p>variable: \u4fdd\u5b58\u5f53\u524d\u53c2\u6570</p> <pre><code>#!/bin/bash\n# getopts\u7684\u7528\u6cd5\n# opt \u4f1a\u4fdd\u5b58\u8f93\u5165\u7684\u53c2\u6570\uff0c\u5982 r i\n# OPTARG\u4fdd\u5b58\u53c2\u6570\u503c\n# \u53c2\u6570\u9700\u8981\u4e00\u4e2a\u503c\u5c31\u5728\u53c2\u6570\u540e\u9762\u52a0\u4e00\u4e2a: \u5982i:\nwhile getopts ri: opt\ndo\n    case \"$opt\" in\n    i) echo \"install service $OPTARG\";;\n    r) echo \"remove all service\";;\n    *) echo \"Unknown option: $opt\";;\n    esac\ndone\nroot@localhost:/# ./getopts.sh -i apache2\ninstall service apache2\nroot@localhost:/# ./getopts.sh -r\nremove all service\nroot@localhost:/# ./getopts.sh -a\n./getopts.sh: illegal option -- a\nUnknown option: ?\n</code></pre>"},{"location":"linux/ShellScript/#3-read","title":"3. \u83b7\u5f97\u7528\u6237\u8f93\u5165 read","text":""},{"location":"linux/ShellScript/#31","title":"3.1 \u666e\u901a\u7528\u6cd5","text":"<pre><code>#!/bin/bash\nread name\necho $name\n</code></pre>"},{"location":"linux/ShellScript/#32","title":"3.2 \u6307\u5b9a\u63d0\u793a\u7b26","text":"<pre><code>#!/bin/bash\nread -p \"Enter your name: \" name\necho \"Hello $name \"\n</code></pre>"},{"location":"linux/ShellScript/#33","title":"3.3 \u6307\u5b9a\u8d85\u65f6\u65f6\u95f4","text":"<pre><code>#!/bin/bash\nif read -t 5 -p  \"Enter your name: \" name\nthen\n    echo \"Hello $name\"\nelse\n    echo \"TIME OUT\"\nfi\n</code></pre>"},{"location":"linux/ShellScript/#34","title":"3.4 \u9690\u85cf\u6570\u636e","text":"<pre><code>#!/bin/bash\nread -s -p \"Enter passwd: \" passwd\necho \"$passwd\"\n</code></pre>"},{"location":"linux/ShellScript/#35","title":"3.5 \u9650\u5236\u8f93\u5165\u957f\u5ea6","text":"<pre><code>#!/bin/bash\nread -n1 -p \"Do you want continue[Y/N]?\" answer\necho\necho \"$answer\"\n</code></pre>"},{"location":"linux/ShellScript/#_6","title":"\u516d\u3001\u8f93\u51fa","text":"<p>\u663e\u793a\u811a\u672c\u8f93\u51fa\u7684\u65b9\u6cd5\uff1a</p> <ol> <li>\u5728\u663e\u793a\u5668\u4e0a\u663e\u793a</li> <li>\u5c06\u8f93\u51fa\u91cd\u5b9a\u5411\u5230\u6587\u4ef6</li> </ol> \u63cf\u8ff0\u7b26 \u7f29\u5199 \u63cf\u8ff0 0 STDIN \u6807\u51c6\u8f93\u5165 1 STDOUT \u6807\u51c6\u8f93\u51fa 2 STDERR \u6807\u51c6\u9519\u8bef"},{"location":"linux/ShellScript/#1_4","title":"1. \u5728\u811a\u672c\u4e2d\u91cd\u5b9a\u5411","text":""},{"location":"linux/ShellScript/#1_5","title":"1. \u4e34\u65f6\u91cd\u5b9a\u5411","text":"<p>\u4f7f\u7528\u573a\u666f\uff1a\u5728\u811a\u672c\u4e2d\u751f\u6210\u9519\u8bef\u6d88\u606f</p> <pre><code>#!/bin/bash\necho \"This is an error message\" &gt;&amp;2\necho \"This is normal output\"\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0bLinux \u4f1a\u5c06STDERR\u5b9a\u5411\u5230STDOUT</p> <pre><code>$./error.sh\nThis is an error message\nThis is normal output\n</code></pre> <p>\u5728\u6267\u884c\u811a\u672c\u7684\u65f6\u5019\u91cd\u5b9a\u5411STDERR\uff0cERR\u6587\u672c\u5c31\u4f1a\u88ab\u91cd\u5b9a\u5411</p> <pre><code>$ ./error.sh  2&gt; error.log\nThis is normal output\n$ cat error.log\nThis is an error message\n</code></pre>"},{"location":"linux/ShellScript/#2_2","title":"2. \u6c38\u4e45\u91cd\u5b9a\u5411","text":"<p>\u7528exec\u547d\u4ee4\u544a\u8bc9shell\u5728\u6267\u884c\u811a\u672c\u671f\u95f4\u91cd\u5b9a\u5411\u67d0\u4e2a\u7279\u5b9a\u6587\u4ef6\u63cf\u8ff0\u7b26</p> <pre><code>#!/bin/bash\nexec 2&gt;errout\necho \"This is error\"\nexec 1&gt;testout\necho \"testout\"\necho \"testout  to errout\" &gt;&amp;2\n</code></pre> <pre><code>$ ./test.sh\nThis is error\n$ cat errout\ntestout  to errout\n$ cat testout\ntestout\n</code></pre>"},{"location":"linux/ShellScript/#2_3","title":"2. \u8bb0\u5f55\u6d88\u606f","text":"<p>tee : \u5c06\u8f93\u51fa\u4e00\u8fb9\u53d1\u9001\u5230\u663e\u793a\u5668\u4e00\u8fb9\u53d1\u9001\u5230\u65e5\u5fd7\u6587\u4ef6 tee \u9ed8\u8ba4\u4f1a\u8986\u76d6\u539f\u6765\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u4f7f\u7528-a\u8ffd\u52a0</p> <pre><code>$ date | tee -a date.txt\nFri Nov 23 11:03:15 CST 2018\n$ cat date.txt\nFri Nov 23 11:03:07 CST 2018\nFri Nov 23 11:03:15 CST 2018\n</code></pre>"},{"location":"linux/ShellScript/#_7","title":"\u4e03\u3001\u51fd\u6570","text":""},{"location":"linux/ShellScript/#1_6","title":"1.\u51fd\u6570\u5b9a\u4e49","text":"<pre><code>#!/bin/bash\n# \u5b9a\u4e49\u65b9\u5f0f1\nfunction foo\n{\n    echo \"This is a func\"\n}\n# \u5b9a\u4e49\u65b9\u5f0f2\nbar()\n{\n   echo \"This is another func\"\n}\n</code></pre>"},{"location":"linux/ShellScript/#2_4","title":"2. \u51fd\u6570\u8c03\u7528","text":"<p>\u76f4\u63a5\u4f7f\u7528\u51fd\u6570\u540d\u8c03\u7528</p>"},{"location":"linux/ShellScript/#3_3","title":"3.\u8fd4\u56de\u503c","text":""},{"location":"linux/ShellScript/#31_1","title":"3.1 \u9ed8\u8ba4\u9000\u51fa\u72b6\u6001\u7801","text":"<pre><code>#!/bin/bash\nfunction foo {\n    echo \"This is a func\"\n}\nfoo\necho \"Exit status is $?\"\n</code></pre>"},{"location":"linux/ShellScript/#32-return","title":"3.2 \u4f7f\u7528return\u547d\u4ee4","text":"<pre><code>#!/bin/bash\nfunction foo {\n    echo \"Hello world\"\n    return 2\n}\nfoo\necho \"Exit status is $?\"\n</code></pre> <pre><code> ./func.sh\nHello world\nExit status is 2\n</code></pre>"},{"location":"linux/ShellScript/#33_1","title":"3.3 \u4f7f\u7528\u51fd\u6570\u8f93\u51fa","text":"<pre><code>#!/bin/bash\nfunction foo {\n    echo \"Hello world\"\n}\nfoo\n# \u628a\u51fd\u6570\u7684\u8f93\u51fa\u8d4b\u503c\u7ed9\u53d8\u91cf\nresult=`foo`\necho \"Exit status is $result\"\n</code></pre> <pre><code> $./func.sh\nHello world\nExit status is Hello world\n</code></pre>"},{"location":"linux/ShellScript/#4_1","title":"4. \u53c2\u6570","text":""},{"location":"linux/ShellScript/#42","title":"4.2 \u53c2\u6570\u4f20\u9012","text":"<pre><code>#!/bin/bash\nfunction status {\n    systemctl status $1\n}\nstatus sshd\n</code></pre>"},{"location":"linux/ShellScript/#42_1","title":"4.2 \u5c40\u90e8\u53d8\u91cf\u4e0e\u5168\u5c40\u53d8\u91cf","text":"<pre><code>#!/bin/bash\n# \u5b9a\u4e49\u5168\u5c40\u53d8\u91cf\nhostname=\"web\"\nfunction foo {\n      str=\"hello\"\n      # \u4f7f\u7528 local \u5b9a\u4e49\u5c40\u90e8\u53d8\u91cf\n      local  user=\"http\"\n      # \u53ef\u4ee5\u5728\u51fd\u6570\u5185\u4f7f\u7528\u5168\u5c40\u53d8\u91cf\n      echo \"$hostname\"\n      echo \"$user\"\n}\nfoo\n# \u5728\u51fd\u6570\u4e2d\u5b9a\u4e49\u7684\u5c40\u90e8\u53d8\u91cf\u4e0d\u80fd\u5728\u5168\u5c40\u4f7f\u7528\necho \"$str $user\"\n</code></pre>"},{"location":"linux/ShellScript/#43","title":"4.3 \u6570\u7ec4\u53d8\u91cf","text":"<p>\u5982\u679c\u5c06\u6570\u7ec4\u53d8\u91cf\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\uff0c\u51fd\u6570\u53ea\u4f1a\u53d6\u6570\u7ec4\u53d8\u91cf\u7684\u7b2c\u4e00\u4e2a\u503c</p> <pre><code>#!/bin/bash\nfunction foo {\n     arr=$1\n     echo \"The received array is ${arr[*]}\"\n}\nmyarr=(1 2 3 4 5)\nfoo $myarr\n\n# The received array is 1\n</code></pre> <p>\u89e3\u51b3\u65b9\u6cd5</p> <pre><code>#!/bin/bash\nfunction foo {\n     arr=$@\n     echo \"The received array is ${arr[*]}\"\n}\nmyarr=(1 2 3 4 5)\n# \u5c06\u8be5\u6570\u7ec4\u53d8\u91cf\u7684\u503c\u5206\u89e3\u6210\u5355\u4e2a\u7684\u503c\uff0c\u7136\u540e\u5c06\u8fd9\u4e9b\u503c\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u4f7f\u7528\u3002\nfoo ${myarr[*]}\n\n# The received array is 1 2 3 4 5\n</code></pre>"},{"location":"linux/ShellScript/#_8","title":"\u516b\u3001\u8f93\u51fa\u683c\u5f0f\u5316","text":""},{"location":"linux/ShellScript/#1-c","title":"1. C\u8bed\u8a00\u98ce\u683c\u7684\u683c\u5f0f\u5316","text":"<pre><code>#!/bin/bash\nprintf \"%-5s %-10s %-4s\\n\" NO. Name Mark\nprintf \"%-5s %-10s %-4.2f\\n\" 1 Sarath 80.3456\nprintf \"%-5s %-10s %-4.2f\\n\" 2 James 90.9989\n</code></pre> <pre><code>root@localhost:/tmp# ./test.sh\nNO.   Name       Mark\n1     Sarath     80.35\n2     James      91.00\n</code></pre>"},{"location":"linux/ShellScript/#2-echo","title":"2. echo","text":""},{"location":"linux/ShellScript/#21_1","title":"2.1 \u4e0d\u6362\u884c","text":"<p><code>echo -n \"hello world\"</code></p>"},{"location":"linux/ShellScript/#22_1","title":"2.2 \u8f6c\u4e49","text":"<p><code>echo -e \"hello\\t\\tworld\"</code></p>"},{"location":"linux/ShellScript/#23_1","title":"2.3 \u5f69\u8272\u8f93\u51fa","text":"\u989c\u8272 \u91cd\u7f6e \u9ed1 \u7ea2 \u7eff \u9ec4 \u84dd \u7d2b \u9752 \u767d \u524d\u666f\u8272 0 30 31 32 33 34 35 36 37 \u80cc\u666f\u8272 0 40 41 42 43 44 45 46 47 <pre><code>echo -e \"\\e[1;31m This is red test \\e[0m\"\n# \u6216\necho -e  \"\\033[47;31m This is red test \\033[0m\"\n</code></pre>"},{"location":"linux/ShellScript/#shell_1","title":"\u4e5d\u3001shell \u811a\u672c\u7684\u6267\u884c","text":""},{"location":"linux/ShellScript/#1-4","title":"1. \u811a\u672c\u6267\u884c\u76844\u79cd\u65b9\u6cd5","text":"<pre><code>#!/bin/bash\n# test.sh\n# \u8fd9\u91cc\u501f\u52a9SHLVL\u8fd9\u4e2a\u53d8\u91cf\uff0cSHLVL\u53ef\u4ee5\u663e\u793ashell\u7684\u5c42\u7ea7\uff0c\n# \u6bcf\u542f\u52a8\u4e00\u4e2ashell\uff0c\u8fd9\u4e2a\u503c\u5c31\u52a01\necho \"shell level :$SHLVL\"\necho \"hello world!\"\n</code></pre>"},{"location":"linux/ShellScript/#11-shell","title":"1.1 \u5207\u6362\u5230shell\u811a\u672c\u6240\u5728\u76ee\u5f55\u6267\u884c","text":"<pre><code>root@localhost:/# cd /tmp/\nroot@localhost:/tmp# chmod +x test.sh\nroot@localhost:/tmp# ./test.sh\nshell level :2\nhello world!\n</code></pre>"},{"location":"linux/ShellScript/#12_1","title":"1.2 \u4ee5\u7edd\u5bf9\u8def\u5f84\u6267\u884c","text":"<pre><code>root@localhost:~# chmod +x /tmp/test.sh\nroot@localhost:~# /tmp/test.sh\nshell level :2\nhello world!\n</code></pre>"},{"location":"linux/ShellScript/#13-bashsh-bash-shell","title":"1.3 \u76f4\u63a5\u4f7f\u7528bash\u6216sh \u6765\u6267\u884cbash shell\u811a\u672c","text":"<pre><code>root@localhost:/tmp# bash test.sh\nshell level :2\nhello world!\nroot@localhost:/tmp# sh test.sh\nshell level :1\nhello world!\n</code></pre>"},{"location":"linux/ShellScript/#14-shell","title":"1.4 \u5728\u5f53\u524dshell \u73af\u5883\u4e2d\u6267\u884c","text":"<pre><code>root@localhost:/tmp# . test.sh\nshell level :1\nhello world!\nroot@localhost:/tmp# source  test.sh\nshell level :1\nhello world!\n</code></pre> <p>\u603b\u7ed3\uff1a\u6ce8\u610f\u770bSHLVL\u7684\u503c\uff0c\u524d3\u79cd\u65b9\u5f0f\u90fd\u5728\u5b50shell\u4e2d\u6267\u884c\uff08sh\u9664\u5916\uff09\uff0c\u7b2c4\u79cd\u5728\u5f53\u524dshell\u79cd\u6267\u884c\u3002</p>"},{"location":"linux/ShellScript/#2_5","title":"2.\u8c03\u8bd5\u811a\u672c","text":"<p><code>bash -x script.sh</code> \u8ddf\u8e2a\u8c03\u8bd5shell\u811a\u672c</p> <p>\u4f8b\uff1a</p> <pre><code>root@localhost:/tmp# bash -x test.sh\n+ echo 'shell level :2'\nshell level :2\n+ echo 'hello world!'\nhello world!\n</code></pre> <p>-x \u6253\u5370\u6240\u6267\u884c\u7684\u6bcf\u4e00\u884c\u547d\u4ee4\u4ee5\u53ca\u5f53\u524d\u72b6\u6001</p> <p>set  -x : \u5728\u6267\u884c\u65f6\u663e\u793a\u53c2\u6570\u548c\u547d\u4ee4 set +x : \u7981\u6b62\u8c03\u8bd5 set -v : \u5f53\u547d\u4ee4\u8fdb\u884c\u8bfb\u53d6\u65f6\u663e\u793a\u8f93\u5165 set +v : \u7981\u6b62\u6253\u5370\u8f93\u5165</p>"},{"location":"linux/ShellScript/#_9","title":"\u5341\u3001\u63a7\u5236\u811a\u672c","text":""},{"location":"linux/ShellScript/#1_7","title":"1.\u5904\u7406\u4fe1\u53f7","text":""},{"location":"linux/ShellScript/#11linux","title":"1.1\u67e5\u770bLinux\u4fe1\u53f7","text":"<pre><code>kill -l\n 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP\n 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1\n11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM\n16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP\n21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ\n26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR\n31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3\n38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8\n43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13\n48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12\n53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7\n58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2\n63) SIGRTMAX-1  64) SIGRTMAX\n</code></pre> <p>\u5728Linux\u7f16\u7a0b\u65f6\u4f1a\u9047\u5230\u7684\u6700\u5e38\u89c1\u7684Linux\u7cfb\u7edf\u4fe1\u53f7</p> \u4fe1 \u53f7 \u503c \u63cf \u8ff0 \u89e6\u53d1 1 SIGHUP \u6302\u8d77\u8fdb\u7a0b 2 SIGINT \u7ec8\u6b62\u8fdb\u7a0b Ctrl + C 3 SIGQUIT \u505c\u6b62\u8fdb\u7a0b 9 SIGKILL \u65e0\u6761\u4ef6\u7ec8\u6b62\u8fdb\u7a0b 15 SIGTERM \u5c3d\u53ef\u80fd\u7ec8\u6b62\u8fdb\u7a0b 17 SIGSTOP \u65e0\u6761\u4ef6\u505c\u6b62\u8fdb\u7a0b\uff0c\u4f46\u4e0d\u662f\u7ec8\u6b62\u8fdb\u7a0b 18 SIGTSTP \u505c\u6b62\u6216\u6682\u505c\u8fdb\u7a0b\uff0c\u4f46\u4e0d\u7ec8\u6b62\u8fdb\u7a0b Ctrl+Z 19 SIGCONT \u7ee7\u7eed\u8fd0\u884c\u505c\u6b62\u7684\u8fdb\u7a0b"},{"location":"linux/ShellScript/#12_2","title":"1.2 \u6355\u6349\u4fe1\u53f7","text":"<p>\u683c\u5f0f\uff1a<code>trap command signals</code> \u4f8b</p> <pre><code>#!/bin/bash\ntrap \"echo 'You Enter Ctrl + C'\" SIGINT\nfor (( i=0; i&lt;10; i++ ));do\n    echo $i\n    sleep 1\ndone\n</code></pre> <pre><code># ./signal.sh\n0\n1\n^CYou Enter Ctrl + C\n2\n^CYou Enter Ctrl + C\n</code></pre>"},{"location":"linux/ShellScript/#2_6","title":"2. \u9000\u51fa\u72b6\u6001","text":"<p>\u53ef\u4ee5\u4f7f\u7528<code>$?</code>\u67e5\u770b\u4e0a\u4e00\u4e2a\u547d\u4ee4\u7684\u9000\u51fa\u72b6\u6001\u7801</p> \u72b6\u6001\u7801 \u542b\u4e49 0 \u547d\u4ee4\u6210\u529f\u7ed3\u675f 1 \u901a\u7528\u672a\u77e5\u9519\u8bef 2 \u8bef\u7528shell\u547d\u4ee4 126 \u547d\u4ee4\u4e0d\u53ef\u6267\u884c 127 \u6ca1\u6709\u627e\u5230\u547d\u4ee4 128+x Linux\u4fe1\u53f7x\u7684\u4e25\u91cd\u9519\u8bef 130 \u547d\u4ee4\u901a\u8fc7Ctrl+C\u7ec8\u6b62 255 \u9000\u51fa\u72b6\u6001\u7801\u8d8a\u754c"},{"location":"linux/command-line/","title":"Linux\u547d\u4ee4\u884c","text":""},{"location":"linux/command-line/#_1","title":"\u4e00\u3001\u7cfb\u7edf\u7ba1\u7406","text":""},{"location":"linux/command-line/#1","title":"1.\u7528\u6237\u7ba1\u7406","text":"<p><code>passwd</code></p> <p><code>useradd</code></p> <p><code>userdel</code></p> <p><code>groupadd</code></p> <p><code>groupdel</code></p> <p><code>uesrmod</code></p> <p><code>groupmod</code></p> <p><code>whoami</code></p> <p><code>who</code></p> <p><code>id</code></p>"},{"location":"linux/command-line/#2","title":"2.\u65f6\u95f4\u7ba1\u7406","text":"<p><code>date</code></p>"},{"location":"linux/command-line/#_2","title":"\u4e8c\u3001\u6587\u4ef6\u7ba1\u7406","text":"<p><code>cd</code></p> <p><code>touch</code></p> <p><code>cat</code></p> <p><code>head</code></p> <p><code>tail</code></p> <p><code>less</code></p> <p><code>more</code></p> <p><code>file</code></p> <p><code>chown</code></p> <p><code>chmod</code></p> <p><code>rm</code></p> <p><code>mv</code></p> <p><code>cp</code></p> <p><code>mkdir</code></p> <p><code>rmdir</code></p>"},{"location":"linux/command-line/#_3","title":"\u4e09\u3001\u78c1\u76d8\u7ba1\u7406","text":"<p><code>df</code></p> <p><code>fdisk</code></p> <p><code>lsblk</code></p> <p><code>du</code></p> <p><code>mount</code></p> <p><code>umount</code></p> <p><code>tree</code></p> <p><code>mkfs</code></p>"},{"location":"linux/command-line/#_4","title":"\u56db\u3001\u7f51\u7edc\u7ba1\u7406","text":"<p><code>ping</code></p> <p><code>ipconfig</code></p> <p><code>ip</code></p> <p><code>telnet</code></p>"},{"location":"linux/command-line/#_5","title":"\u4e94\u3001\u5907\u4efd\u538b\u7f29","text":"<p><code>zip</code></p> <p><code>unzip</code></p> <p><code>tar</code></p>"},{"location":"linux/command-line/#_6","title":"\u516d\u3001\u8fdb\u7a0b\u7ba1\u7406","text":"<p><code>ps</code></p> <p><code>kill</code></p> <p><code>pkill</code></p> <p><code>killall</code></p> <p><code>nohup</code></p>"},{"location":"linux/command-line/#_7","title":"\u9644\u3001\u547d\u4ee4\u884c\u5feb\u6377\u952e","text":""},{"location":"linux/command-line/#1_1","title":"1. \u5149\u6807\u79fb\u52a8","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>Ctrl+f</code> \u5149\u6807\u5411\u524d\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\uff0c\u76f8\u5f53\u4e8e\u65b9\u5411\u952e\u7684\u53f3\u952e <code>Ctrl+b</code> \u5149\u6807\u5411\u540e\u79fb\u52a8\u4e00\u4e2a\u5b57\u7b26\uff0c\u76f8\u5f53\u4e8e\u65b9\u5411\u952e\u7684\u5de6\u952e <code>Alt+f</code> \u5149\u6807\u5411\u540e\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd <code>Alt+b</code> \u5149\u6807\u5411\u540e\u79fb\u52a8\u4e00\u4e2a\u5355\u8bcd <code>Ctrl+a</code> \u5149\u6807\u79fb\u52a8\u5230\u5f53\u524d\u884c\u7684\u5f00\u5934 <code>Ctrl+e</code> \u5149\u6807\u79fb\u52a8\u5230\u5f53\u524d\u884c\u7684\u7ed3\u5c3e <code>Esc+b</code> \u5149\u6807\u79fb\u52a8\u5230\u5f53\u524d\u5355\u8bcd\u7684\u5f00\u5934 <code>Esc+f</code> \u5149\u6807\u79fb\u52a8\u5230\u5f53\u524d\u5355\u8bcd\u7684\u7ed3\u5c3e <code>Ctrl+ ]</code> \u4ece\u5f53\u524d\u5149\u6807\u5f80\u540e\u641c\u7d22\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u5feb\u901f\u79fb\u52a8\u5230\u8be5\u5b57\u7b26\u4e32 <code>Ctrl+ alt + ]</code> \u4ece\u5f53\u524d\u5149\u6807\u5f80\u524d\u641c\u7d22\u5b57\u7b26\u4e32\uff0c\u7528\u4e8e\u5feb\u901f\u79fb\u52a8\u5230\u8be5\u5b57\u7b26\u4e32"},{"location":"linux/command-line/#2_1","title":"2. \u547d\u4ee4\u884c\u5b57\u7b26\u4fee\u6539","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>Ctrl+d</code> \u5220\u9664\u5149\u6807\u6240\u5728\u5904\u5b57\u7b26 <code>Ctrl+h</code> \u5220\u9664\u5149\u6807\u6240\u5728\u5904\u524d\u4e00\u4e2a\u5b57\u7b26 <code>Ctrl+w</code> \u526a\u5207\u5149\u6807\u6240\u5728\u5904\u4e4b\u524d\u7684\u4e00\u4e2a\u8bcd\uff08\u4ee5\u7a7a\u683c\u3001\u6807\u70b9\u7b49\u4e3a\u5206\u9694\u7b26\uff09 <code>Alt+d</code> \u526a\u5207\u5149\u6807\u4e4b\u540e\u7684\u8bcd\uff08\u4ee5\u7a7a\u683c\u3001\u6807\u70b9\u7b49\u4e3a\u5206\u9694\u7b26\uff09 <code>Ctrl+u</code> \u526a\u5207\u547d\u4ee4\u884c\u4e2d\u5149\u6807\u6240\u5728\u5904\u4e4b\u524d\u7684\u6240\u6709\u5b57\u7b26\uff08\u4e0d\u5305\u62ec\u81ea\u8eab <code>Ctrl+k</code> \u526a\u5207\u547d\u4ee4\u884c\u4e2d\u5149\u6807\u6240\u5728\u5904\u4e4b\u540e\u7684\u6240\u6709\u5b57\u7b26\uff08\u5305\u62ec\u81ea\u8eab\uff09 <code>Ctrl+y</code> \u7c98\u8d34\u521a\u624d\u6240\u5220\u9664\u7684\u8bcd <code>Ctrl+t</code> \u98a0\u5012\u5149\u6807\u6240\u5728\u5904\u53ca\u5176\u4e4b\u524d\u7684\u5b57\u7b26\u4f4d\u7f6e\uff0c\u5e76\u5c06\u5149\u6807\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a\u5b57\u7b26 <code>Alt+t</code> \u4ea4\u6362\u5f53\u524d\u548c\u4e0a\u4e00\u4e2a\u5355\u8bcd\u7684\u4f4d\u7f6e <code>Alt+u</code> \u628a\u5149\u6807\u5230\u5f53\u524d\u8bcd\u7ed3\u5c3e\u8f6c\u5316\u4e3a\u5927\u5199\uff0c\u5149\u6807\u79fb\u52a8\u5230\u5355\u8bcd\u672b\u5c3e <code>Alt+l</code> \u628a\u5149\u6807\u5230\u5f53\u524d\u8bcd\u7ed3\u5c3e\u8f6c\u5316\u4e3a\u5c0f\u5199\uff0c\u5149\u6807\u79fb\u52a8\u5230\u5355\u8bcd\u672b\u5c3e <code>Alt+c</code> \u628a\u5149\u6807\u6240\u5728\u5b57\u7b26\u8f6c\u4e3a\u5927\u5199\uff0c\u5149\u6807\u79fb\u52a8\u5230\u5355\u8bcd\u672b\u5c3e <code>Esc+t</code> \u98a0\u5012\u5149\u6807\u6240\u5728\u5904\u53ca\u5176\u4e4b\u524d\u5355\u8bcd\u7684\u4f4d\u7f6e <code>Ctrl+x+u</code> \u64a4\u9500\u521a\u624d\u7684\u64cd\u4f5c <code>Ctrl+?</code> \u64a4\u9500\u4e0a\u4e00\u6b21\u8f93\u5165"},{"location":"linux/command-line/#3","title":"3. \u7ec8\u7aef\u64cd\u4f5c","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>Ctrl+l</code> \u6e05\u7a7a\u5f53\u524d\u5c4f\u5e55 <code>Ctrl+s</code> \u505c\u6b62\u5411\u5c4f\u5e55\u8f93\u51fa <code>Ctrl+q</code> \u91cd\u65b0\u6fc0\u6d3b\u5411\u5c4f\u5e55\u8f93\u51fa <code>Ctrl+d</code> \u6ce8\u9500\u5f53\u524d\u7ec8\u7aef\u767b\u5f55\u7684\u7528\u6237"},{"location":"linux/command-line/#4","title":"4. \u5386\u53f2\u547d\u4ee4","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>Ctrl+p</code> \u663e\u793a\u4e0a\u4e00\u6761\u547d\u4ee4 <code>Ctrl+n</code> \u663e\u793a\u4e0b\u4e00\u6761\u547d\u4ee4 <code>Ctrl+r</code> \u5411\u4e0a\u641c\u7d22\u5305\u542b\u8f93\u5165\u5b57\u7b26\u7684\u547d\u4ee4\uff0c\u7ee7\u7eed\u6309<code>Ctrl+r</code>\uff0c\u641c\u7d22\u4e0a\u4e00\u6761\u5339\u914d\u7684\u547d\u4ee4 <code>Ctrl+g</code> \u4ece\u6b63\u5728\u6267\u884c<code>Ctrl+</code>r\u7684\u641c\u7d22\u4e2d\u9000\u51fa <code>!num</code> \u6267\u884c\u5386\u53f2\u547d\u4ee4\u5217\u8868\u4e2d\u7684\u7b2cnum\u6761\u547d\u4ee4 <code>!!</code> \u6267\u884c\u4e0a\u4e00\u6761\u547d\u4ee4 <code>!?string?</code> \u6267\u884c\u542b\u6709string\u5b57\u7b26\u4e32\u7684\u6700\u65b0\u547d\u4ee4"},{"location":"linux/command-line/#5","title":"5. \u547d\u4ee4\u6267\u884c","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>Ctrl+m</code> \u6267\u884c\u5f53\u524d\u884c\u547d\u4ee4\uff0c\u76f8\u5f53\u4e8e\u56de\u8f66 <code>Ctrl+o</code> \u6267\u884c\u5f53\u524d\u884c\u547d\u4ee4\uff0c\u76f8\u5f53\u4e8e\u56de\u8f66"},{"location":"linux/grep_sed_awk/","title":"\u6587\u672c\u5904\u7406\u4e09\u5251\u5ba2","text":"<p>\u5305\u62ecawk\u3001sed\u548cgrep\u4e09\u79cd\u6587\u672c\u5904\u7406\u5de5\u5177\u3002</p>"},{"location":"linux/grep_sed_awk/#grep","title":"\u4e00\u3001grep","text":"<p>grep\u547d\u4ee4\uff1a\u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u67e5\u627e\u6587\u4ef6\u4e2d\u7684\u5173\u952e\u5b57</p>"},{"location":"linux/grep_sed_awk/#1","title":"1. \u8bed\u6cd5\u683c\u5f0f","text":"<ol> <li><code>grep [option] [pattern] [file1,file2]</code></li> <li><code>command | grep [option] [pattern]</code></li> </ol>"},{"location":"linux/grep_sed_awk/#2","title":"2. \u9009\u9879","text":"\u9009\u9879 \u542b\u4e49 <code>-v</code> \u4e0d\u663e\u793a\u5339\u914d\u884c\u4fe1\u606f <code>-i</code> \u641c\u7d22\u65f6\u5ffd\u7565\u5927\u5c0f\u5199 <code>-n</code> \u663e\u793a\u884c\u53f7 <code>-r</code> \u9012\u5f52\u641c\u7d22 <code>-E</code> \u652f\u6301\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f <code>-F</code> \u4e0d\u6309\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\uff0c\u6309\u7167\u5b57\u7b26\u4e32\u5b57\u9762\u610f\u601d\u5339\u914d <code>-c</code> \u53ea\u663e\u793a\u5339\u914d\u884c\u6570 <code>-w</code> \u5339\u914d\u6574\u8bcd <code>-x</code> \u5339\u914d\u6574\u884c <code>-l</code> \u53ea\u663e\u793a\u6587\u4ef6\u540d\uff0c\u4e0d\u663e\u793a\u5185\u5bb9 <code>-s</code> \u4e0d\u663e\u793a\u9519\u8bef\u4fe1\u606f <code>-A &lt;N&gt;</code> \u663e\u793a\u6240\u627e\u7684\u5339\u914d\u5b57\u6bb5\uff0c\u5e76\u663e\u793a\u4e0b\u9762\u6307\u5b9a\u7684\u884c\u6570\u7684\u4fe1\u606f <code>-B &lt;N&gt;</code> \u663e\u793a\u6240\u627e\u7684\u5339\u914d\u5b57\u6bb5\uff0c\u5e76\u663e\u793a\u4e0a\u9762\u6307\u5b9a\u7684\u884c\u6570\u7684\u4fe1\u606f <code>-C &lt;N&gt;</code> \u6253\u5370\u51fa\u5339\u914d\u7684\u4e0a\u4e0b\u6587\uff08\u4e0aN\u884c\uff0c\u4e0bN\u884c\uff09\u524d\u540e\u7684N\u884c"},{"location":"linux/grep_sed_awk/#sed","title":"\u4e8c\u3001sed","text":"<p>sed\u547d\u4ee4\uff1a\u5b57\u7b26\u6d41\u7f16\u8f91\u5de5\u5177\uff0c\u5bf9\u6807\u51c6\u8f93\u51fa\u6216\u6587\u4ef6\u9010\u884c\u8fdb\u884c\u5904\u7406\u3002</p> <p>sed\u7684\u4e24\u4e2a\u4e34\u65f6\u7f13\u51b2\u533a\uff08\u7a7a\u95f4\uff09\uff1a</p> <ol> <li>\u6a21\u5f0f\u7a7a\u95f4\uff1a\u4fdd\u5b58\u5f53\u524d\u88ab\u5904\u7406\u7684\u884c</li> <li>\u4fdd\u6301\u7a7a\u95f4</li> </ol>"},{"location":"linux/grep_sed_awk/#1_1","title":"1.\u529f\u80fd","text":"<ol> <li>\u5bf9\u884c\u8fdb\u884c\u64cd\u4f5c\u5904\u7406</li> <li>\u5bf9\u6587\u4ef6\u5185\u5bb9\u4fe1\u606f\u8fdb\u884c\u4fee\u6539\uff0c\u5220\u9664\u3001\u6dfb\u52a0\u3001\u67e5\u8be2</li> </ol>"},{"location":"linux/grep_sed_awk/#2_1","title":"2.\u8bed\u6cd5\u683c\u5f0f","text":"<ol> <li><code>sed [OPTION] \"pattern command\" file</code></li> <li><code>command | sed [OPTION] \"pattern command\"</code></li> </ol>"},{"location":"linux/grep_sed_awk/#3","title":"3.\u5de5\u4f5c\u6a21\u5f0f","text":"<ol> <li>sed \u4e00\u6b21\u5904\u7406\u4e00\u884c\u6587\u4ef6\u7684\u6587\u672c\u5e76\u5c06\u5f53\u524d\u5904\u7406\u7684\u884c\u5b58\u50a8\u5728\u4e34\u65f6\u7f13\u51b2\u533a\u4e2d\uff08\u6b64\u53c8\u88ab\u79f0\u4e3a\u6a21\u5f0f\u7a7a\u95f4\u201c pattern space\u201d)</li> <li>Sed \u4e00\u65e6\u5b8c\u6210\u5bf9\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u884c\u7684\u5904\u7406\uff0c\u884c\u5c06\u4ece\u7a7a\u95f4\u4e2d\u8f93\u51fa\u5230\u5c4f\u5e55\u3002</li> <li>sed \u5728\u7ee7\u7eed\u8bfb\u5165\u4e0b\u4e00\u884c\uff0c\u5728\u5982\u6b64\u7ee7\u7eed\uff0c\u76f4\u81f3\u5168\u90e8\u6267\u884c\u5b8c\u6210</li> </ol>"},{"location":"linux/grep_sed_awk/#4","title":"4.\u9009\u9879","text":"\u9009\u9879 \u542b\u4e49 <code>-n</code> \u53ea\u6253\u5370\u6a21\u5f0f\u5339\u914d\u884c\uff0c\u9ed8\u8ba4\u8f93\u51fa <code>-e</code> \u5141\u8bb8\u591a\u70b9\u7f16\u8f91 <code>-f</code> \u7f16\u8f91\u52a8\u4f5c\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\uff0c\u6307\u5b9a\u6587\u4ef6\u6267\u884c <code>-r</code> \u652f\u6301\u6269\u5c55\u6b63\u5219\u8868\u8fbe\u5f0f <code>-i</code> \u76f4\u63a5\u4fee\u6539\u6587\u4ef6\u5185\u5bb9"},{"location":"linux/grep_sed_awk/#5pattern","title":"5.pattern\u7528\u6cd5","text":"\u5339\u914d\u6a21\u5f0f \u542b\u4e49 <code>10command</code> \u5339\u914d\u7b2c10\u884c <code>10,20command</code> \u4ece10\u884c\u5f00\u59cb\u5339\u914d\u523020\u884c\u7ed3\u675f <code>10,+5command</code> \u4ece10\u884c\u5f00\u59cb\u5339\u914d\uff0c\u523015\u884c\u7ed3\u675f <code>/pattern/command</code> \u5339\u914d\u6709pattern\u7684\u884c\uff0cpattern\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u6216\u6b63\u5219\u8868\u8fbe\u5f0f <code>/pattern1/,/pattern2/command</code> \u5339\u914d\u5230pattern1\u7684\u884c\u5f00\u59cb\uff0c\u5230\u5339\u914d\u5230pattern2\u7684\u884c\u7ed3\u675f <code>10,/pattern/command</code> \u4ece10\u884c\u5f00\u59cb\uff0c\u5230\u5339\u914d\u5230pattern\u7684\u884c\u7ed3\u675f <code>/pattern/,10command</code> \u4ece\u5339\u914d\u5230pattern\u7684\u884c\u5f00\u59cb\uff0c\u5230\u7b2c10\u884c\u7ed3\u675f"},{"location":"linux/grep_sed_awk/#6sed","title":"6.sed\u547d\u4ee4","text":"<p>\u547d\u4ee4\u8bed\u6cd5\uff1a</p> <ol> <li><code>[address]command</code></li> <li><code>[address]{command1;command2}</code></li> </ol>"},{"location":"linux/grep_sed_awk/#61","title":"6.1 \u57fa\u7840\u547d\u4ee4","text":""},{"location":"linux/grep_sed_awk/#61-s","title":"6.1 \u66ff\u6362\uff08s\uff09","text":"<pre><code>root@gp:~# sed -i 's/UNIX/unix/g' file\n</code></pre> <p>\u5e38\u7528\u7684\u5b9a\u754c\u7b26<code>#</code>\u3001<code>@</code>\u3001<code>/</code></p>"},{"location":"linux/grep_sed_awk/#62-d","title":"6.2 \u5220\u9664\uff08d\uff09","text":"<p>\u5982\u679c\u5339\u914d\u4f1a\u5220\u9664\u6574\u884c</p> <pre><code># \u5220\u9664\u7a7a\u884c\nroot@gp:~# sed -i '/^$/d' file  \n</code></pre>"},{"location":"linux/grep_sed_awk/#63-a","title":"6.3 \u8ffd\u52a0\uff08a\uff09","text":"<p>\u5728\u5339\u914d\u884c\u540e\u6dfb\u52a0</p> <pre><code>sed  '/word/a \\text' file\n</code></pre>"},{"location":"linux/grep_sed_awk/#64-i","title":"6.4 \u63d2\u5165\uff08i\uff09","text":"<p>\u5728\u5339\u914d\u884c\u524d\u6dfb\u52a0</p> <pre><code>sed  '/word/i \\text' file\n</code></pre>"},{"location":"linux/grep_sed_awk/#65-c","title":"6.5 \u66f4\u6539\uff08c\uff09","text":"<p>\u5220\u9664\u5339\u914d\u7684\u884c\u5e76\u66ff\u6362\u4e3a\u6307\u5b9a\u5185\u5bb9</p> <pre><code>root@gp:~# sed  '/hello/c \\HELLO WORLD' file\nHELLO WORLD\n</code></pre>"},{"location":"linux/grep_sed_awk/#65-l","title":"6.5 \u5217\u8868\uff08l\uff09","text":"<p>\u663e\u793a\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u663e\u793a\u975e\u6253\u5370\u5b57\u7b26\uff0c\u5982\u5236\u8868\u7b26\u7b49</p> <pre><code>root@gp:~# sed  -n 'l' file\nhello$\n\\tworld$\n</code></pre>"},{"location":"linux/grep_sed_awk/#66-p","title":"6.6 \u6253\u5370\uff08p\uff09","text":"<p>\u8f93\u51fa\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\u3002</p> <pre><code>root@gp:~# sed  -n '$p' /etc/passwd\n</code></pre>"},{"location":"linux/grep_sed_awk/#67","title":"6.7 \u6253\u5370\u884c\u53f7\uff08=\uff09","text":"<p>\u6253\u5370\u88ab\u5339\u914d\u7684\u884c\u7684\u884c\u53f7</p>"},{"location":"linux/grep_sed_awk/#68-n","title":"6.8 \u4e0b\u4e00\u6b65\uff08n\uff09","text":"<p>\u5c0f\u5199n\u547d\u4ee4\u4f1a\u544a\u8bc9sed\u7f16\u8f91\u5668\u79fb\u52a8\u5230\u6570\u636e\u6d41\u7684\u4e0b\u4e00\u884c\u6587\u672c\uff0c\u800c\u4e0d\u7528\u91cd\u65b0\u56de\u5230\u547d\u4ee4\u6700\u5f00\u59cb\u518d\u6267\u884c\u4e00\u904d\u3002\u901a\u5e38sed\u7f16\u8f91\u5668\u5728\u79fb\u52a8\u5230\u6570\u636e\u6d41\u4e2d\u7684\u4e0b\u4e00\u884c\u6587\u672c\u4e4b\u524d\uff0c\u4f1a\u5728\u5f53\u524d\u884c\u4e0a\u6267\u884c\u5b8c\u6240\u6709\u5b9a\u4e49\u597d\u7684\u76ee\u547d\u4ee4\u3002</p> <pre><code>$ sed -i \"/baidu/{n;/baidu/d}\" hosts\n</code></pre>"},{"location":"linux/grep_sed_awk/#69-r","title":"6.9 \u8bfb\uff08r\uff09","text":"<p>\u5c06\u4e00\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u63d2\u5165\u5230\u6307\u5b9a\u4f4d\u7f6e</p>"},{"location":"linux/grep_sed_awk/#69-w","title":"6.9 \u5199\uff08w\uff09","text":"<p>\u5c06\u6a21\u5f0f\u7a7a\u95f4\u7684\u5185\u5bb9\u5199\u5230\u6587\u4ef6\u4e2d</p>"},{"location":"linux/grep_sed_awk/#610-q","title":"6.10 \u9000\u51fa\uff08q\uff09","text":"<p>\u4f7fsed\u505c\u6b62\u8bfb\u53d6\u65b0\u7684\u8f93\u5165\u884c</p> <pre><code># \u8f93\u51fa\u524d5\u884c\nroot@gp:~# sed '5q' /etc/passwd\n</code></pre>"},{"location":"linux/grep_sed_awk/#62","title":"6.2 \u9ad8\u7ea7\u547d\u4ee4","text":"<p>\u9ad8\u7ea7\u547d\u4ee4\u6539\u53d8\u4e86\u6267\u884c\u6216\u63a7\u5236\u7684\u6d41\u7a0b\u987a\u5e8f\u3002</p>"},{"location":"linux/grep_sed_awk/#621-nextn","title":"6.2.1 \u591a\u884cNext\uff08N\uff09","text":"<p>\u8bfb\u53d6\u65b0\u7684\u8f93\u5165\u884c\uff0c\u5e76\u5c06\u5b83\u6dfb\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4\u7684\u73b0\u6709\u5185\u5bb9\u4e4b\u540e\u3002</p> <p>\u4f8b1\uff1a</p> <pre><code>root@gp:~# cat file\nThis is the header line.\nThis is the first line.\nThis is the second line.\nThis is the last line.\n# \u5c06\u4e24\u884c\u5408\u5e76\u4e3a\u4e00\u884c\nroot@gp:~# sed '/first/{N; s/\\n/ /}' file\nThis is the header line.\nThis is the first line. This is the second line.\nThis is the last line.\n</code></pre> <p>\u4f8b2\uff1a</p> <pre><code>root@gp:~# cat file.txt\nOn Tuesday, the Linux System\nAdministrator's group meeting will be held.\nAll System Administrator should attent.\nThank you for your attend.\n# \u66ff\u6362\u5206\u6563\u5728\u4e24\u884c\u4e2d\u7684\u6587\u672c\u77ed\u8bed\nroot@gp:~# sed 's/System Administrator/Desktop User/;N;s/System\\nAdministrator/Desktop\\nUser/' file.txt\nOn Tuesday, the Linux Desktop\nUser's group meeting will be held.\nAll Desktop User should attent.\nThank you for your attend.\n</code></pre>"},{"location":"linux/grep_sed_awk/#622-d","title":"6.2.2 \u591a\u884c\u5220\u9664\uff08D\uff09","text":"<p>\u53ea\u5220\u9664\u6a21\u5f0f4\u7a7a\u95f4\u7684\u7b2c\u4e00\u884c\u3002\u8be5\u547d\u4ee4\u4f1a\u5220\u9664\u5230\u6362\u884c\u7b26\u4e3a\u6b62\u7684\u6240\u6709\u5b57\u7b26\u3002</p> <p>D\u547d\u4ee4\u4f1a\u5f3a\u5236sed\u7f16\u8f91\u5668\u8fd4\u56de\u5230\u811a\u672c\u7684\u8d77\u59cb\u5904\uff0c\u5bf9\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u5185\u5bb9\u91cd\u65b0\u6267\u884c\u8fd9\u4e9b\u547d\u4ee4\uff08\u4e0d\u4f1a\u4ece\u6570\u636e\u6d41\u4e2d\u8bfb\u53d6\u65b0\u7684\u6587\u672c\u884c\uff09</p> <p>\u4f8b1\uff1a\u5220\u9664\u5339\u914d\u884c\u7684\u524d\u4e00\u884c\u6587\u672c</p> <pre><code>root@gp:~# cat file\n\nThis is the header line.\n\nThis is the first line.\nThis is the second line.\nThis is the last line.\n# \u5220\u9664\u5339\u914d\u884c\u7684\u524d\u4e00\u884c\u6587\u672c\nroot@gp:~# sed '/^$/{N;/header/D}' file\nThis is the header line.\n\nThis is the first line.\nThis is the second line.\nThis is the last line.\n</code></pre> <p>\u4f8b2\uff1a\u5c06\u591a\u4e2a\u7a7a\u884c\u5408\u5e76\u4e3a\u4e00\u4e2a\u7a7a\u884c</p> <pre><code>root@gp:~# sed '/^$/{N;/^\\n$/D}' file\n</code></pre>"},{"location":"linux/grep_sed_awk/#623-p","title":"6.2.3 \u591a\u884c\u6253\u5370\uff08P\uff09","text":"<p>\u8f93\u51fa\u591a\u884c\u6a21\u5f0f\u7a7a\u95f4\u7684\u7b2c\u4e00\u90e8\u5206\uff0c\u76f4\u5230\u7b2c\u4e00\u4e2a\u6362\u884c\u7b26\u4e3a\u6b62\u3002\u8fd9\u4e2a\u547d\u4ee4\u7ecf\u5e38\u51fa\u73b0\u5728Next\u4e4b\u540e\u548cDelete\u4e4b\u524d\u3002</p>"},{"location":"linux/grep_sed_awk/#63","title":"6.3 \u4fdd\u6301\u7a7a\u95f4","text":"<p>\u7528\u9014: \u5728\u5904\u7406\u6a21\u5f0f\u7a7a\u95f4\u4e2d\u7684\u67d0\u4e9b\u884c\u65f6\uff0c\u53ef\u4ee5\u7528\u4fdd\u6301\u7a7a\u95f4\u6765\u4e34\u65f6\u4fdd\u5b58\u4e00\u4e9b\u884c\u3002</p> \u547d\u4ee4 \u63cf\u8ff0 <code>h</code> \u5c06\u6a21\u5f0f\u7a7a\u95f4\u590d\u5236\u5230\u4fdd\u6301\u7a7a\u95f4 <code>H</code> \u5c06\u6a21\u5f0f\u7a7a\u95f4\u8ffd\u52a0\u5230\u4fdd\u6301\u7a7a\u95f4 <code>g</code> \u5c06\u4fdd\u6301\u7a7a\u95f4\u590d\u5236\u5230\u6a21\u5f0f\u7a7a\u95f4 <code>G</code> \u5c06\u4fdd\u6301\u7a7a\u95f4\u8ffd\u52a0\u5230\u6a21\u5f0f\u7a7a\u95f4 <code>x</code> \u4ea4\u6362\u6a21\u5f0f\u7a7a\u95f4\u548c\u4fdd\u6301\u7a7a\u95f4\u7684\u5185\u5bb9"},{"location":"linux/grep_sed_awk/#64","title":"6.4 \u6d41\u7a0b\u63a7\u5236","text":""},{"location":"linux/grep_sed_awk/#1-b","title":"1. \u5206\u652f\uff08b\uff09","text":"<p>\u5728\u811a\u672c\u4e2d\u5c06\u63a7\u5236\u6743\u8f6c\u79fb\u5230\u53e6\u4e00\u884c</p> <p><code>[address]b[label]</code></p> <p>address\uff1a\u51b3\u5b9a\u54ea\u4e9b\u884c\u7684\u6570\u636e\u4f1a\u89e6\u53d1\u5206\u652f\u547d\u4ee4</p> <p>label\uff1a\u5b9a\u4e49\u8981\u8df3\u8f6c\u5230\u7684\u4f4d\u7f6e\uff0c\u5982\u679c\u6ca1\u6709label\uff0c\u5c31\u8df3\u8f6c\u5230\u811a\u672c\u7684\u7ed3\u5c3e</p> <p>\u4f8b1\uff1a\u4e0d\u52a0\u6807\u7b7e</p> <pre><code>root@gp:~# cat file\nThis is the header line.\nThis is the first line.\nThis is the second line.\nThis is the last line.\n# \u8df3\u8fc7\u7b2c2,3\u884c\nroot@gp:~# sed '{2,3b; s/This is/Is this/; s/line./test?/}' file\nIs this the header test?\nThis is the first line.\nThis is the second line.\nIs this the last test?\n</code></pre> <p>\u4f8b2\uff1a\u4f7f\u7528\u6807\u7b7e</p> \u7f16\u8f91\u547d\u4ee4 \u542b\u4e49 <code>p</code> \u6253\u5370 <code>a</code> \u884c\u540e\u8ffd\u52a0 <code>i</code> \u884c\u524d\u8ffd\u52a0 <code>r</code> \u5916\u90e8\u6587\u4ef6\u8bfb\u53d6\uff0c\u884c\u540e\u8ffd\u52a0 <code>w</code> \u5339\u914d\u884c\u5199\u5165\u5916\u90e8\u6587\u4ef6 <code>d</code> \u5220\u9664 <code>s/old/new/</code> \u5c06\u884c\u5185\u7684\u7b2c\u4e00\u4e2aold\u66ff\u6362\u4e3anew <code>s/old/new/g</code> \u5c06\u884c\u5185\u5168\u90e8\u7684old\u66ff\u6362\u4e3anew <code>s/old/new/2g</code> \u540c\u4e00\u884c\u5185\uff0c\u53ea\u66ff\u6362\u4ece\u7b2c2\u4e2a\u5f00\u59cb\u5230\u5269\u4e0b\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684 <code>s/old/new/ig</code> \u5c06\u884c\u5185\u5168\u90e8\u7684old\u66ff\u6362\u4e3anew\uff0c\u5ffd\u7565\u5927\u5c0f\u5199 <code>=</code> \u663e\u793a\u5339\u914d\u7684\u884c\u53f7\uff0c\u4f46\u662f\u4e0d\u663e\u793a\u5185\u5bb9"},{"location":"linux/grep_sed_awk/#7","title":"7.\u53cd\u5411\u5f15\u7528","text":"\u5b57\u7b26 \u529f\u80fd <code>&amp;</code> \u4fdd\u5b58\u6240\u641c\u7d22\u5b57\u7b26\u7528\u6765\u66ff\u6362\u5176\u4ed6\u5b57\u7b26 <code>()</code> \u5206\u7ec4\uff0c\u628a\u9700\u8981\u5f15\u7528\u7684\u90e8\u5206\u62ec\u8d77\u6765 <p>7.1. \u4f7f\u7528<code>&amp;</code>\u5f15\u7528</p> <pre><code>$ sed -n 's/ubuntu/++&amp;++/p' passwd\n++ubuntu++:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bash\n</code></pre> <p>7.2. \u4f7f\u7528<code>()</code>\u5206\u7ec4\u5f15\u7528</p> <pre><code>$ sed -n 's/\\(ro\\)../\\1OT/gp' passwd\nroOT:x:0:0:roOT:/roOT:/bin/bash\n</code></pre>"},{"location":"linux/grep_sed_awk/#8","title":"8.\u53d8\u91cf\u5f15\u7528","text":"<p>\u5339\u914d\u6a21\u5f0f\u4e2d\u4f7f\u7528\u53d8\u91cf\u65f6\uff0c\u4f7f\u7528\u53cc\u5f15\u53f7\uff0c\u5426\u5219\u9700\u8981\u628a\u53d8\u91cf\u7528\u5355\u5f15\u53f7\u62ec\u8d77\u6765</p> <p><code>\"s/$old/$new/g\"</code> \u6216 <code>'s/'$old'/'$new'/g'</code></p>"},{"location":"linux/grep_sed_awk/#awk","title":"\u4e09\u3001awk","text":"<p>awk\uff1a\u62a5\u544a\u751f\u6210\u5668\uff0c\u662f Alfred Aho,Peter Weinberger,Brian Kernighan \u4e09\u4f4d\u4f5c\u8005\u8054\u5408\u5f00\u53d1\u7684\u3002</p>"},{"location":"linux/grep_sed_awk/#1_2","title":"1.\u8bed\u6cd5\u683c\u5f0f","text":"<ol> <li><code>awk 'BEGIN{}pattern{commmand}END{}' file</code></li> <li><code>command | awk 'BEGIN{}pattern{commmand}END{}'</code></li> </ol> \u8bed\u6cd5\u683c\u5f0f \u542b\u4e49 <code>BEGIN{}</code> \u6b63\u5f0f\u5904\u7406\u6570\u636e\u4e4b\u524d\u6267\u884c <code>pattern</code> \u5339\u914d\u6a21\u5f0f <code>{commands}</code> \u5904\u7406\u547d\u4ee4\uff0c\u53ef\u4ee5\u591a\u884c <code>END{}</code> \u5904\u7406\u5b8c\u6240\u6709\u5339\u914d\u6570\u636e\u540e\u7684\u6267\u884c"},{"location":"linux/grep_sed_awk/#2_2","title":"2.\u5185\u7f6e\u53d8\u91cf","text":"\u5185\u7f6e\u53d8\u91cf \u542b\u4e49 <code>$0</code> \u6574\u884c\u5185\u5bb9 <code>$</code> \u5f53\u524d\u884c\u7684\u7b2cn\u4e2a\u5b57\u6bb5 <code>NF</code> Number Field\uff0c\u5f53\u524d\u884c\u7684\u5b57\u6bb5\u4e2a\u6570\uff0c\u4e5f\u5c31\u662f\u6709\u591a\u5c11\u5217 <code>NR</code> Number Row\uff0c\u5f53\u524d\u884c\u7684\u884c\u53f7\uff0c\u4ece1\u5f00\u59cb\u8ba1\u6570 <code>FNR</code> File Number Row\u591a\u6587\u4ef6\u5904\u7406\u662f\uff0c\u6bcf\u4e2a\u6587\u4ef6\u884c\u53f7\u5355\u72ec\u8ba1\u6570\uff0c\u90fd\u662f\u4ece1\u5f00\u59cb <code>FS</code> Field Separator\uff0c\u8f93\u5165\u5b57\u6bb5\u5206\u5272\u7b26\uff0c\u9ed8\u8ba4\u4ee5\u7a7a\u683c\u6216tab\u5206\u5272 <code>RS</code> Row Separator\uff0c\u8f93\u5165\u884c\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u56de\u8f66\u6362\u884c <code>OFS</code> Output Field Separator\uff0c\u8f93\u51fa\u5b57\u6bb5\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u7a7a\u683c <code>ORS</code> Output Row Separator\uff0c\u8f93\u51fa\u884c\u5206\u9694\u7b26\uff0c\u9ed8\u8ba4\u56de\u8f66\u6362\u884c <code>FILENAME</code> \u5f53\u524d\u8f93\u5165\u7684\u6587\u4ef6\u540d\u79f0 <code>ARGC</code> \u547d\u4ee4\u884c\u53c2\u6570\u4e2a\u6570 <code>ARGV</code> \u547d\u4ee4\u884c\u53c2\u6570\u6570\u7ec4"},{"location":"linux/grep_sed_awk/#3_1","title":"3. \u8f93\u51fa","text":""},{"location":"linux/grep_sed_awk/#31-printf","title":"3.1. printf","text":"\u683c\u5f0f\u7b26 \u542b\u4e49 <code>%s</code> \u6253\u5370\u5b57\u7b26\u4e32 <code>%d</code> \u6253\u5370\u5341\u8fdb\u5236\u6570 <code>%f</code> \u6253\u5370\u6d6e\u70b9\u6570 <code>%x</code> \u6253\u5370\u5341\u516d\u8fdb\u5236\u6570 <code>%o</code> \u6253\u5370\u516b\u8fdb\u5236\u6570 <code>%e</code> \u6253\u5370\u6570\u5b57\u7684\u79d1\u5b66\u6280\u672f\u6cd5\u683c\u5f0f <code>%c</code> \u6253\u5370\u5355\u4e2a\u5b57\u7b26\u7684ASCII \u4fee\u9970\u7b26 \u542b\u4e49 <code>-</code> \u5de6\u5bf9\u9f50 <code>+</code> \u53f3\u5bf9\u9f50 <code>#</code> \u663e\u793a8\u8fdb\u5236\u5728\u524d\u9762\u52a00\uff0c\u663e\u793a16\u8fdb\u5236\u5728\u524d\u9762\u52a00x <pre><code># printf\n$ awk 'BEGIN{FS=\":\"}{printf \"%-20s %10s\\n\",$1,$7}' /etc/passwd\n</code></pre>"},{"location":"linux/grep_sed_awk/#32-print","title":"3.2 print","text":"<pre><code>$ awk 'BEGIN{FS=\":\"}/root/{printf $0}' /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\n</code></pre>"},{"location":"linux/grep_sed_awk/#4_1","title":"4.\u5339\u914d\u6a21\u5f0f","text":""},{"location":"linux/grep_sed_awk/#41","title":"4.1.\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d","text":"<pre><code>$ awk 'BEGIN{FS=\":\"}/root/{printf $0}' /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\n</code></pre>"},{"location":"linux/grep_sed_awk/#42","title":"4.2.\u5173\u7cfb\u8fd0\u7b97\u5339\u914d","text":"\u5173\u7cfb\u8fd0\u7b97\u7b26 \u542b\u4e49 <code>&lt;</code> \u5c0f\u4e8e <code>&lt;=</code> \u5c0f\u4e8e\u7b49\u4e8e <code>&gt;</code> \u5927\u4e8e <code>&gt;=</code> \u5927\u4e8e\u7b49\u4e8e <code>==</code> \u7b49\u4e8e <code>!=</code> \u4e0d\u7b49\u4e8e <code>~</code> \u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f <code>!~</code> \u4e0d\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f <pre><code># \u5173\u7cfb\u8fd0\u7b97\u7b26\u5339\u914d\n$ awk -F \":\" '$3&gt;=1000 {print $0}' /etc/passwd\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bash\n</code></pre> <pre><code># \u6b63\u5219\u5339\u914d\n$ awk -F \":\" '$1~/root/ {print $0}' /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\n</code></pre>"},{"location":"linux/grep_sed_awk/#43","title":"4.3. \u5e03\u5c14\u8fd0\u7b97\u7b26\u5339\u914d","text":"\u5e03\u5c14\u8fd0\u7b97\u7b26 \u542b\u4e49 <code>||</code> \u6216 <code>&amp;&amp;</code> \u4e0e <code>!</code> \u975e <pre><code># \u5e03\u5c14\u8fd0\u7b97\u7b26\u5339\u914d\n$ awk -F \":\" '$3==0 || $3&gt;=1000 {printf \"%s\\n\",$0}' /etc/passwd\nroot:x:0:0:root:/root:/bin/bash\nnobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin\nubuntu:x:1000:1000:ubuntu,,,:/home/ubuntu:/bin/bash\n</code></pre>"},{"location":"linux/grep_sed_awk/#5","title":"5. \u8868\u8fbe\u5f0f","text":""},{"location":"linux/grep_sed_awk/#51","title":"5.1. \u7b97\u6570\u8fd0\u7b97\u7b26","text":"\u8fd0\u7b97\u7b26 \u542b\u4e49 <code>+</code> \u52a0 <code>-</code> \u51cf <code>*</code> \u4e58 <code>/</code> \u9664 <code>%</code> \u53d6\u6a21 <code>^\u6216**</code> \u4e58\u65b9 <code>++x</code> \u5728\u8fd4\u56dex\u53d8\u91cf\u4e4b\u524d\uff0cx\u53d8\u91cf\u52a01 <code>x++</code> \u5728\u8fd4\u56dex\u53d8\u91cf\u4e4b\u540e\uff0cx\u53d8\u91cf\u52a01 <pre><code># \u7b97\u6570\u8fd0\u7b97\n$ awk 'BEGIN{x=10;y=30;print x+y}'\n40\n</code></pre> <pre><code># \u7edf\u8ba1\u7a7a\u884c\n$ awk '/^$/{cnt++}END{print cnt}' /etc/services\n6\n</code></pre>"},{"location":"linux/grep_sed_awk/#6","title":"6. \u903b\u8f91\u63a7\u5236","text":"<p>\u8bed\u6cd5\u683c\u5f0f\u540cC\u8bed\u8a00\u3002</p>"},{"location":"linux/grep_sed_awk/#61-if","title":"6.1. <code>if</code>","text":"<pre><code>$ awk -F \":\"  '{if ($3==0) {printf \"%-10s%s\\n\",\"root\u7528\u6237:\",$1} else {printf \"%-10s%s\\n\",\"\u666e\u901a\u7528\u6237:\",$1}}' /etc/passwd\nroot\u7528\u6237:   root\n\u666e\u901a\u7528\u6237:     daemon\n\u666e\u901a\u7528\u6237:     bin\n\u666e\u901a\u7528\u6237:     sys\n\u666e\u901a\u7528\u6237:     sync\n\u666e\u901a\u7528\u6237:     games\n\u666e\u901a\u7528\u6237:     man\n\u666e\u901a\u7528\u6237:     lp\n\u666e\u901a\u7528\u6237:     mail\n\u666e\u901a\u7528\u6237:     news\n\u666e\u901a\u7528\u6237:     uucp\n\u666e\u901a\u7528\u6237:     proxy\n\u666e\u901a\u7528\u6237:     www-data\n\u666e\u901a\u7528\u6237:     backup\n\u666e\u901a\u7528\u6237:     list\n\u666e\u901a\u7528\u6237:     irc\n\u666e\u901a\u7528\u6237:     gnats\n\u666e\u901a\u7528\u6237:     nobody\n\u666e\u901a\u7528\u6237:     systemd-timesync\n\u666e\u901a\u7528\u6237:     systemd-network\n\u666e\u901a\u7528\u6237:     systemd-resolve\n\u666e\u901a\u7528\u6237:     systemd-bus-proxy\n\u666e\u901a\u7528\u6237:     syslog\n\u666e\u901a\u7528\u6237:     _apt\n\u666e\u901a\u7528\u6237:     lxd\n\u666e\u901a\u7528\u6237:     messagebus\n\u666e\u901a\u7528\u6237:     uuidd\n\u666e\u901a\u7528\u6237:     dnsmasq\n\u666e\u901a\u7528\u6237:     sshd\n\u666e\u901a\u7528\u6237:     ubuntu\n</code></pre>"},{"location":"linux/grep_sed_awk/#62-dowhile","title":"6.2. <code>do...while</code>","text":"<pre><code>$ awk 'BEGIN{do{sum+=i;i++}while(i&lt;=100) print sum}'\n5050\n</code></pre>"},{"location":"linux/grep_sed_awk/#63-while","title":"6.3. <code>while</code>","text":"<pre><code>$ awk 'BEGIN{while(i&lt;=100){sum+=i;i++}print sum}'\n5050\n</code></pre>"},{"location":"linux/grep_sed_awk/#64-for","title":"6.4. <code>for</code>","text":""},{"location":"linux/grep_sed_awk/#7_1","title":"7. \u5b57\u7b26\u4e32\u51fd\u6570","text":"\u51fd\u6570\u540d \u89e3\u91ca \u8fd4\u56de\u503c <code>length(str)</code> \u8ba1\u7b97\u5b57\u7b26\u4e32\u957f\u5ea6 \u6574\u6570\u957f\u5ea6\u503c <code>index(str1,str2)</code> \u5728str1\u4e2d\u67e5\u627estr2\u7684\u4f4d\u7f6e \u8fd4\u56de\u503c\u4e3a\u4f4d\u7f6e\u7d22\u5f15\uff0c\u4ece1\u8ba1\u6570 <code>tolower(str)</code> \u8f6c\u6362\u4e3a\u5c0f\u5199 \u8f6c\u6362\u540e\u7684\u5c0f\u5199\u5b57\u7b26\u4e32 <code>toupper(str)</code> \u8f6c\u6362\u4e3a\u5927\u5199 \u8f6c\u6362\u540e\u7684\u5927\u5199\u5b57\u7b26\u4e32 <code>substr(str,m,n)</code> \u4ecestr\u7684m\u4e2a\u5b57\u7b26\u5f00\u59cb\uff0c\u622a\u53d6n\u4f4d \u622a\u53d6\u540e\u7684\u5b50\u4e32 <code>split(str,arr,fs)</code> \u6309fs\u5206\u5272\u5b57\u7b26\u4e32\uff0c\u7ed3\u679c\u4fdd\u5b58arr \u5207\u5272\u540e\u7684\u5b50\u4e32\u4e2a\u6570 <code>match(str,RE)</code> \u5728str\u4e2d\u6309\u7167RE\u67e5\u627e\uff0c\u8fd4\u56de\u4f4d\u7f6e \u8fd4\u56de\u7d22\u5f15\u4f4d\u7f6e <code>sub(RE,RepStr,str)</code> \u5728str\u4e2d\u641c\u7d22\u7b26\u5408RE\u7684\u5b57\u4e32\uff0c\u5c06\u5176\u66ff\u6362\u4e3aRepStr\uff0c\u53ea\u66ff\u6362\u7b2c\u4e00\u4e2a \u66ff\u6362\u7684\u4e2a\u6570 <code>gsub(RE,RepStr,str)</code> \u5728str\u4e2d\u641c\u7d22\u7b26\u5408RE\u7684\u5b57\u4e32\uff0c\u5c06\u5176\u66ff\u6362\u4e3aRepStr\uff0c\u66ff\u6362\u6240\u6709 \u66ff\u6362\u7684\u4e2a\u6570"},{"location":"linux/grep_sed_awk/#8_1","title":"8. \u9009\u9879","text":"\u9009\u9879 \u89e3\u91ca <code>-v</code> \u5b9a\u4e49\u6216\u5f15\u7528\u53d8\u91cf <code>-f</code> \u6307\u5b9a\u811a\u672c\u6587\u4ef6 <code>-F</code> \u6307\u5b9a\u5206\u9694\u7b26 <code>-V</code> \u67e5\u770b\u7248\u672c\u53f7 <pre><code># \u628a\u5916\u90e8\u53d8\u91cf\u5f15\u5165awk\n$ x=12\n$ awk -v y=\"$x\" 'BEGIN{print y}'\n12\n</code></pre>"},{"location":"linux/service/","title":"Linux\u4e2d\u5e38\u7528\u7684\u670d\u52a1","text":""},{"location":"linux/service/#ftp","title":"\u4e00\u3001FTP","text":""},{"location":"linux/service/#1","title":"1. \u4ecb\u7ecd","text":"<p>FTP \u662f File Transfer Protocol \uff08\u6587\u4ef6\u4f20\u8f93\u534f\u8bae\uff09\u7684\u7f29\u5199 \uff0c\u5728 Unix/Linux \u7cfb\u7edf\u4e2d\u5e38\u7528\u7684\u514d\u8d39 FTP \u670d\u52a1\u5668\u8f6f\u4ef6\u4e3b\u8981\u662f VSFTP\uff0cvsftp\u7684\u5b98\u65b9\u5730\u5740\uff1ahttp://vsftpd.beasts.org</p>"},{"location":"linux/service/#1-ftp","title":"1. FTP \u7684\u5de5\u4f5c\u6a21\u5f0f","text":"<p>FTP\u5de5\u4f5c\u65f6\u4f1a\u5f00\u4e24\u4e2a\u7aef\u53e3\uff0c\u4e00\u4e2a\u547d\u4ee4\u7aef\u53e3\uff08TCP:21\uff09\uff0c\u4e00\u4e2a\u6570\u636e\u7aef\u53e3(TCP:20)</p> <p>1.1 \u4e3b\u52a8\u6a21\u5f0f \uff08Active FTP\uff09</p> <p>\u670d\u52a1\u5668\u4e3b\u52a8\u8fde\u63a5\u5ba2\u6237\u7aef</p> <p>FTP \u5ba2\u6237\u7aef\u968f\u673a\u5f00\u542f\u4e00\u4e2a\u5927\u4e8e1024 \u7684\u7aef\u53e3 N \u5411\u670d\u52a1\u5668\u7684 21 \u53f7\u7aef\u53e3\u53d1\u8d77\u8fde\u63a5\uff0c\u7136\u540e\u5f00\u653e N+1 \u53f7\u7aef\u53e3\u8fdb\u884c\u76d1\u542c\uff0c\u5e76\u5411\u670d\u52a1\u5668\u53d1\u51faPORT N+1 \u547d\u4ee4\u3002\u670d\u52a1\u5668\u63a5\u6536\u5230\u547d\u4ee4\u540e\uff0c\u4f1a\u7528\u5176\u672c\u5730\u7684 FTP \u6570\u636e\u7aef\u53e3\uff08\u901a\u5e38\u662f 20 \uff09\u6765\u8fde\u63a5\u5ba2\u6237\u7aef\u6307\u5b9a\u7684\u7aef\u53e3 N+1 \uff0c\u8fdb\u884c\u6570\u636e\u4f20\u8f93</p> <pre><code>         client                           server\n\n\u547d\u4ee4\u63a7\u5236    1088         ------&gt;             21\n\n\u6570\u636e\u4f20\u8f93    1089         &lt;------     \u3000\u3000\u3000\u3000 20\n</code></pre> <p>1.2 \u88ab\u52a8\u6a21\u5f0f\uff08Passive FTP\uff09</p> <p>\u5ba2\u6237\u7aef\u4e3b\u52a8\u94fe\u63a5\u670d\u52a1\u5668\u7aef</p> <p>FTP \u5ba2\u6237\u7aef\u968f\u673a\u5f00\u542f\u4e00\u4e2a\u5927\u4e8e1024 \u7684\u7aef\u53e3 N \u5411\u670d\u52a1\u5668\u7684 21 \u53f7\u7aef\u53e3\u53d1\u8d77\u8fde\u63a5\uff0c\u540c\u65f6\u4f1a\u5f00\u542f N+1 \u53f7\u7aef\u53e3\u3002\u7136\u540e\u5411\u670d\u52a1\u5668\u53d1\u9001PASV \u547d\u4ee4\uff0c\u901a\u77e5\u670d\u52a1\u5668\u81ea\u5df1\u5904\u4e8e\u88ab\u52a8\u6a21\u5f0f\u3002\u670d\u52a1\u5668\u6536\u5230\u547d\u4ee4\u540e\uff0c\u4f1a\u5f00\u653e\u4e00\u4e2a\u5927\u4e8e 1024 \u7684\u7aef\u53e3 P \u8fdb\u884c\u76d1\u542c\uff0c\u7136\u540e\u7528 PORT P \u547d\u4ee4\u901a\u77e5\u5ba2\u6237\u7aef\uff0c\u81ea\u5df1\u7684\u6570\u636e\u7aef\u53e3\u662f P \u3002\u5ba2\u6237\u7aef\u6536\u5230\u547d\u4ee4\u540e\uff0c\u4f1a\u901a\u8fc7 N+1\u53f7\u7aef\u540e\u8fde\u63a5\u670d\u52a1\u5668\u7684\u7aef\u53e3 P \uff0c\u7136\u540e\u5728\u4e24\u4e2a\u7aef\u53e3\u4e4b\u95f4\u8fdb\u884c\u6570\u636e\u4f20\u8f93</p> <pre><code>            client                      server\n\u547d\u4ee4\u63a7\u5236     1088      ----------&gt;         21\n\u6570\u636e\u4f20\u8f93     1089      -- PASV --&gt;        1099\n</code></pre> <p>\u5173\u4e8e\u4e24\u8005\u7684\u533a\u522b\u53c2\u8003\uff1ahttp://slacksite.com/other/ftp.html</p>"},{"location":"linux/service/#2","title":"2.\u7528\u6237\u8ba4\u8bc1\u65b9\u5f0f","text":""},{"location":"linux/service/#1ftp","title":"1.\u533f\u540d\u7528\u6237\uff1aftp","text":""},{"location":"linux/service/#2linux","title":"2.\u7cfb\u7edf\u7528\u6237\uff1aLinux\u7cfb\u7edf\u7528\u6237","text":""},{"location":"linux/service/#3","title":"3.\u865a\u62df\u7528\u6237\uff1a\u591a\u4e2a\u865a\u62df\u7528\u6237\u6620\u5c04\u5230\u4e00\u4e2a\u7cfb\u7edf\u7528\u6237","text":""},{"location":"linux/service/#2_1","title":"2.\u5b89\u88c5","text":"<p>ubuntu14.04</p> <pre><code>$ sudo dpkg -i vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb\n$ netstat  -lant | grep 21\ntcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN\n</code></pre>"},{"location":"linux/service/#3_1","title":"3. \u914d\u7f6e\u6587\u4ef6","text":"<ul> <li>\u7528\u6237\u8ba4\u8bc1\u914d\u7f6e\u6587\u4ef6:/etc/pam.d/vsftpd</li> <li> <p>\u4e3b\u914d\u7f6e\u6587\u4ef6:/etc/vsftpd.conf</p> </li> <li> <p>\u533f\u540d\u7528\u6237\uff08\u6620\u5c04\u4e3a\u7cfb\u7edf\u7528\u6237ftp \uff09\u5171\u4eab\u6587\u4ef6\u4f4d\u7f6e\uff1a/srv/ftp</p> </li> </ul> <pre><code>anonymous_enable=NO             # \u662f\u5426\u5141\u8bb8\u533f\u540d\u7528\u6237\u767b\u9646\uff0c\u6a21\u5f0f\u4e0d\u5141\u8bb8\nlocal_enable=YES                # \u5141\u8bb8\u7cfb\u7edf\u7528\u6237\u767b\u9646\n#write_enable=YES               # \u5141\u8bb8\u767b\u9646\u7528\u6237\u8fdb\u884c\u5199\u64cd\u4f5c\uff0c\u9ed8\u8ba4\u4e0d\u5141\u8bb8\n#local_umask=022                #\u3000\u7528\u6237\u767b\u9646\u540e\u521b\u5efa\u6587\u4ef6\u7684umask\u503c\n#anon_upload_enable=YES         #\u3000\u5141\u8bb8\u533f\u540d\u7528\u6237\u4e0a\u4f20\u6587\u4ef6\n#anon_mkdir_write_enable=YES    #\u3000\u5141\u8bb8\u533f\u540d\u7528\u6237\u521b\u5efa\u76ee\u5f55\ndirmessage_enable=YES           #\u3000\u662f\u5426\u663e\u793a\u76ee\u5f55\u8bf4\u660e\u6587\u4ef6, \u9700\u8981\u6536\u5de5\u521b\u5efa.message\u6587\u4ef6\nuse_localtime=YES               #\u3000\u4f7f\u7528\u672c\u5730\u65f6\u95f4\nxferlog_enable=YES              #\u3000\u5f00\u542f\u4e0a\u4f20\u4e0b\u8f7d\u65e5\u5fd7\nconnect_from_port_20=YES        #\u3000\u6570\u636e\u4f20\u8f93\u7aef\u53e3\n#chown_uploads=YES              # \u662f\u5426\u6539\u53d8\u4e0a\u4f20\u6587\u4ef6\u7684\u5c5e\u4e3b  \n#chown_username=whoever     \u00b7   # \u5982\u679c\u662f\u9700\u8981\u8f93\u5165\u4e00\u4e2a\u7cfb\u7edf\u7528\u6237\u540d\n#xferlog_file=/var/log/vsftpd.log   \uff03\u3000\u65e5\u5fd7\u6587\u4ef6\u7684\u8def\u5f84\n#xferlog_std_format=YES # \u662f\u5426\u4f7f\u7528\u6807\u51c6\u7684ftp xferlog\u6a21\u5f0f\n#idle_session_timeout=600   # session\u8d85\u65f6\u65f6\u95f4\n#data_connection_timeout=120\u3000\u3000 # \u8bbe\u7f6e\u6570\u636e\u4f20\u8f93\u8d85\u65f6\u65f6\u95f4\n#nopriv_user=ftpsecure          # \u8fd0\u884cvsftpd\u9700\u8981\u7684\u975e\u7279\u6743\u7cfb\u7edf\u7528\u6237\u9ed8\u8ba4\u662fnobody\n#async_abor_enable=YES          # \u662f\u5426\u5141\u8bb8\u8fd0\u884c\u7279\u6b8a\u7684ftp\u547d\u4ee4async ABOR\n#ascii_upload_enable=YES        # \u662f\u5426\u4f7f\u7528ascii\u7801\u65b9\u5f0f\u4e0a\u4f20\u6587\u4ef6\n#ascii_download_enable=YES      # \u662f\u5426\u4f7f\u7528ascii\u7801\u65b9\u5f0f\u4e0b\u8f7d\u6587\u4ef6\n#ftpd_banner=Welcome to blah FTP service. # \u5b9a\u5236\u6b22\u8fce\u4fe1\u606f\n#deny_email_enable=YES          # \u662f\u5426\u5141\u8bb8\u7981\u6b62\u533f\u540d\u7528\u6237\u4f7f\u7528\u67d0\u4e9b\u90ae\u4ef6\u5730\u5740\n#banned_email_file=/etc/vsftpd.banned_emails    # \u7981\u6b62\u90ae\u4ef6\u5730\u5740\u7684\u6587\u4ef6\u8def\u5f84\n#chroot_local_user=YES          # \u672c\u5730\u7528\u6237\u7981\u9522\u5728\u5bbf\u4e3b\u76ee\u5f55\u4e2d\n#chroot_list_enable=YES         # \u662f\u5426\u5c06\u7cfb\u7edf\u7528\u6237\u9650\u6b62\u5728\u81ea\u5df1\u7684home\u76ee\u5f55\u4e0b\n#chroot_list_file=/etc/vsftpd.chroot_list   # \u5217\u51fa\u7684\u662f\u4e0dchroot\u7684\u7528\u6237\u7684\u5217\u8868\n#ls_recurse_enable=YES          # \u662f\u5426\u5141\u8bb8\u4f7f\u7528ls -R\u7b49\u547d\u4ee4\nsecure_chroot_dir=/var/run/vsftpd/empty\npam_service_name=vsftpd         # pam\u7684\u914d\u7f6e\u6587\u4ef6\u540d\u79f0 /etc/pam.d/vsftpd\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\n</code></pre>"},{"location":"linux/service/#4","title":"4. \u7528\u6237\u7ba1\u7406","text":""},{"location":"linux/service/#1_1","title":"\uff11. \u533f\u540d\u7528\u6237","text":""},{"location":"linux/service/#11","title":"1.1 \u5141\u8bb8\u533f\u540d\u7528\u6237\u767b\u9646","text":"<p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6</p> <pre><code>$ sudo vim /etc/vsftpd.conf\nnonymous_enable=YES\n$ sudo service vsftpd restart\n</code></pre> <p>\u6d4b\u8bd5\uff1a</p> <pre><code>shuowei@gaopeng:~$ ftp 172.16.10.101\nConnected to 172.16.10.101.\n220 (vsFTPd 3.0.2)\nName (172.16.10.101:shuowei): ftp   # \u767b\u9646\u7528\u6237\u4e3aftp\n331 Please specify the password.\nPassword:                           # \u5bc6\u7801\u968f\u610f\uff0c\u53ef\u4ee5\u4e3a\u7a7a\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n-rw-r--r--    1 0        0               0 Jan 25 11:12 test.txt\n226 Directory send OK.\nftp&gt; get test.txt                   # \u6709\u4e0b\u8f7d\u7684\u6743\u9650\nlocal: test.txt remote: test.txt\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for test.txt (0 bytes).\n226 Transfer complete.\nftp&gt; delete test.txt                # \u6ca1\u6709\u5199\u7684\u6743\u9650\n550 Permission denied.\nftp&gt;\n</code></pre>"},{"location":"linux/service/#12","title":"1.2 \u5141\u8bb8\u533f\u540d\u7528\u6237\u4e0a\u4f20\u548c\u5efa\u7acb\u76ee\u5f55","text":"<p>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6</p> <pre><code>$ sudo vim /etc/vsftpd.conf\nnonymous_enable=YES\nwrite_enable=YES\nanon_upload_enable=YES\nanon_mkdir_write_enable=YES\n$ sudo service vsftpd restart\n</code></pre> <pre><code>$ sudo mkdir /srv/ftp/pub\n$ sudo chown ftp. /srv/ftp/pub/\n$ sudo chmod 777  /srv/ftp/pub/\n</code></pre> <pre><code>shuowei@gaopeng:~$ ftp 172.16.10.101\nConnected to 172.16.10.101.\n220 (vsFTPd 3.0.2)\nName (172.16.10.101:shuowei): ftp\n331 Please specify the password.\nPassword:\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwxrwxrwx    2 105      112          4096 Jan 25 11:33 pub\n-rw-r--r--    1 0        0               0 Jan 25 11:12 test.txt\n226 Directory send OK.\nftp&gt; cd pub             # \u8fdb\u5165pub\u76ee\u5f55\n250 Directory successfully changed.\nftp&gt; ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n226 Directory send OK.\nftp&gt; mkdir testdir      # \u6587\u4ef6\u521b\u5efa\u6210\u529f\n257 \"/pub/testdir\" created\nftp&gt; put zabbix-3.0.tar.gz  # \u53ef\u4ee5\u4e0a\u4f20\u6587\u4ef6\nlocal: zabbix-3.0.tar.gz remote: zabbix-3.0.tar.gz\n200 PORT command successful. Consider using PASV.\n150 Ok to send data.\n226 Transfer complete.\n15653160 bytes sent in 0.10 secs (143.7224 MB/s)\nftp&gt; ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\ndrwx------    2 105      112          4096 Jan 25 11:36 testdir\n-rw-------    1 105      112      15653160 Jan 25 11:42 zabbix-3.0.tar.gz\n226 Directory send OK.\n</code></pre>"},{"location":"linux/service/#2_2","title":"2. \u7cfb\u7edf\u7528\u6237","text":""},{"location":"linux/service/#1_2","title":"1. \u7cfb\u7edf\u7528\u6237\u767b\u9646","text":"<pre><code>shuowei@gaopeng:~$ ftp 172.16.10.101\nConnected to 172.16.10.101.\n220 (vsFTPd 3.0.2)\nName (172.16.10.101:shuowei): ubuntu    # \u7cfb\u7edf\u7528\u6237\u540d\n331 Please specify the password.\nPassword:                               # \u7cfb\u7edf\u7528\u6237\u7684\u5bc6\u7801\n230 Login successful.\nRemote system type is UNIX.\nUsing binary mode to transfer files.\nftp&gt; ls\n200 PORT command successful. Consider using PASV.\n150 Here comes the directory listing.\n-rw-r--r--    1 1000     1000       111462 Jan 25 10:30 vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb\n226 Directory send OK.\nftp&gt; pwd\n257 \"/home/ubuntu\"  # \u767b\u9646\u540e\u5728\u81ea\u5df1\u7684\u5bb6\u76ee\u5f55\nftp&gt; get vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb# \u6709\u4e0b\u8f7d\u7684\u6743\u9650\nlocal: vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb remote: vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb\n200 PORT command successful. Consider using PASV.\n150 Opening BINARY mode data connection for vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb (111462 bytes).\n226 Transfer complete.\n111462 bytes received in 0.00 secs (52.1582 MB/s)\nftp&gt; delete vsftpd_3.0.2-1ubuntu2.14.04.1_amd64.deb # \u6ca1\u6709\u5199\u7684\u6743\u9650\u3000\u9700\u8981\u5f00\u542fwrite_enable=YES\n550 Permission denied.\n</code></pre>"},{"location":"linux/service/#3_2","title":"3.\u865a\u62df\u7528\u6237","text":"<p>VSFTP \u4e00\u4e2a\u79f0\u4e3a\u5b89\u5168\u7684\u4fdd\u8bc1\u662f\u91c7\u7528\u4e86\u865a\u62df\u7528\u6237\u7684\u8ba4\u8bc1\u65b9\u5f0f\uff0c\u5b83\u9760\u5bf9 /etc/pam.d/ \u76ee\u5f55\u4e0b\u6307\u5b9a\u7684\u4e00\u4e2a\u8ba4\u8bc1\u6587\u4ef6\u5bf9\u7528\u6237\u8fdb\u884c\u8ba4\u8bc1\uff0c\u8ba4\u8bc1\u6210\u529f\u540e\u518d\u628a\u865a\u62df\u7528\u6237\u6620\u5c04\u4e3a\u672c\u5730\u7528\u6237\uff0c\u8be5\u672c\u5730\u7528\u6237\u7531\u670d\u52a1\u5668\u914d\u7f6e\u6587\u4ef6\u91cc\u7684\u8bed\u53e5 ftp_username \u7684\u503c\u6307\u5b9a\u3002\u4f7f\u7528\u865a\u62df\u7528\u6237\u8ba4\u8bc1\uff0c\u5219\u539f\u6709\u7cfb\u7edf\u8d26\u6237\u5c06\u4e0d\u518d\u53ef\u7528\u3002</p> <p>\u6240\u6709\u865a\u62df\u7528\u6237\u4f1a\u7edf\u4e00\u6620\u5c04\u4e3a\u4e00\u4e2a\u6307\u5b9a\u7684\u7cfb\u7edf\u666e\u901a\u8d26\u53f7\uff1a\u8bbf\u95ee\u5171\u4eab\u4f4d\u7f6e\uff0c\u5373\u4e3a\u6b64\u7cfb\u7edf\u666e\u901a\u7528\u6237\u7684\u5bb6\u76ee\u5f55\uff0c\u5f53\u7136\u6bcf\u4e2a\u865a\u62df\u7528\u6237\u4e5f\u53ef\u88ab\u8d4b\u4e88\u4e0d\u540c\u7684\u8bbf\u95ee\u6743\u9650\uff0c\u901a\u8fc7\u533f\u540d\u7528\u6237\u7684\u6743\u9650\u63a7\u5236\u53c2\u6570\u8fdb\u884c\u6307\u5b9a</p> <p>\u4e3a\u4e86\u5b9e\u73b0\u865a\u62df\u7528\u6237\u6211\u4eec\u9700\u8981\u51c6\u5907\u7684\u73af\u5883</p> <ol> <li>\u4e00\u4e2a\u4e0d\u53ef\u767b\u9646\u7684\u7cfb\u7edf\u8d26\u6237\uff0c\u5e76\u4e3a\u8fd9\u4e2a\u7cfb\u7edf\u521b\u5efa\u4e00\u4e2a\u5bb6\u76ee\u5f55\u3002\u865a\u62df\u8d26\u6237\u5c31\u5728\u8fd9\u4e2a\u5bb6\u76ee\u5f55\u91cc\u6d3b\u52a8\u3002</li> <li>\u521b\u5efa\u865a\u62df\u8d26\u6237\u540d\u5355\uff0c\u5e76\u4e3a\u8fd9\u4e9b\u7528\u6237\u521b\u5efa\u4e00\u4e2a\u8ba4\u8bc1\u6570\u636e\u5e93</li> </ol>"},{"location":"linux/service/#31","title":"3.1 \u521b\u5efa\u865a\u62df\u7528\u6237","text":""},{"location":"linux/service/#311","title":"3.1.\uff11. \u521b\u5efa\u672c\u5730\u7cfb\u7edf\u7528\u6237","text":"<pre><code>$ sudo mkdir /data\n$ sudo useradd -m  -d /data/ftp -s /bin/false  ftpadmin\n$ sudo chwon -R  ftpadmin /data/ftp\n</code></pre>"},{"location":"linux/service/#312","title":"3.1.2. \u5efa\u7acb\u865a\u62df\u8d26\u6237\u540d\u5355","text":"<pre><code>ubuntu@node1:~$ sudo mkdir /etc/vsftpd/\nubuntu@node1:~$ sudo vim /etc/vsftpd/ftpusers.txt\njdyyy\n123456\nyuanzhi\n123456\n</code></pre>"},{"location":"linux/service/#313","title":"3.1.\uff13.\u751f\u6210\u865a\u62df\u8d26\u6237\u7684\u6570\u636e\u5e93","text":"<p>\u521b\u5efa\u6570\u636e\u5e93\u6587\u4ef6\u9700\u8981\u5b89\u88c5db-util</p> <pre><code>$ sudo dpkg -i db5.3-util_5.3.28-3ubuntu3.1_amd64.deb  db-util_1%3a5.3.21~exp1ubuntu1_all.deb\n</code></pre> <p>\u751f\u6210\u8ba4\u8bc1\u6570\u636e\u5e93\u6587\u4ef6</p> <pre><code>ubuntu@node1:~$ sudo db_load -T -t hash -f /etc/vsftpd/ftpusers.txt  /etc/vsftpd/ftpusers.db\n# -T: \u5141\u8bb8\u4f7f\u7528\u6587\u672c\u6587\u4ef6\u4fe1\u606f\u52a0\u8f7d\u5230\u6570\u636e\u5e93\u4e2d\n# -t : \u6307\u5b9a\u52a0\u5bc6\u7b97\u6cd5\n# -f : \u6307\u5b9a\u6587\u4ef6\nubuntu@node1:~$ sudo chmod  600 /etc/vsftpd/ftpusers.db\n</code></pre> <p>\u521b\u5efa\u6570\u636e\u5e93\u7684pam\u6587\u4ef6</p> <pre><code># \u5907\u4efd\u539f\u6765\u7684pam\u6587\u4ef6\n$ sudo cp /etc/pam.d/vsftpd  /etc/pam.d/vsftpd.bak\n# \u62f7\u8d1dpam\u6a21\u677f\u6587\u4ef6\u5230/etc/pam.d/\n$ sudo cp /usr/share/doc/vsftpd/examples/VIRTUAL_USERS/vsftpd.pam /etc/pam.d/vsftpd\n# \u7f16\u8bd1\u65b0\u7684pam\u6587\u4ef6\n# \u6ce8\u610fpam_userdb.so\u7684\u4f4d\u7f6e\uff0c\u6a21\u677f\u4e2d/lib/security/pam_userdb.so\u662f\u627e\u4e0d\u5230\u7684\n# \u6839\u636e\u7cfb\u7edf\u7684\u60c5\u51b5\u6539\uff0cdb=/etc/vsftpd/ftpusers ftpuser\u662f\u8ba4\u8bc1\u6570\u636e\u5e93\u6587\u4ef6\u7684\u6587\u4ef6\u540d\uff0c\u8fd9\u91cc\u4e0d\u9700\u8981\u52a0\u540e\u7f00\n$ sudo vim /etc/pam.d/vsftpd\nauth required /lib/x86_64-linux-gnu/security/pam_userdb.so db=/etc/vsftpd/ftpusers\naccount required /lib/x86_64-linux-gnu/security/pam_userdb.so db=/etc/vsftpd/ftpusers\n</code></pre>"},{"location":"linux/service/#314","title":"3.1.4.\u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<pre><code># \u6fc0\u6d3b\u865a\u62df\u7528\u6237\nguest_enable=YES\n# \u865a\u62df\u7528\u6237\u6620\u5c04\u5230\u7cfb\u7edf\u7528\u6237\u7684\u7528\u6237\u540d\u79f0(\u7cfb\u7edf\u7528\u6237\u7684\u540d\u79f0)\nguest_username=ftpadmin\n# \u865a\u62df\u7528\u6237\u62e5\u6709\u4e0e\u7cfb\u7edf\u7528\u6237\u76f8\u540c\u7684\u6743\u9650\nvirtual_use_local_privs=YES\n</code></pre>"},{"location":"linux/service/#315","title":"3.1.5.\u91cd\u542f\u670d\u52a1","text":"<p>\u5f02\u5e38\u5904\u7406</p> <p>\u5982\u679c\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ca1\u6709\u52a0\uff1avirtual_use_local_privs=YES</p> <p>\u767b\u9646\u62a5\u9519\uff1a500 OOPS: vsftpd: refusing to run with writable root inside chroot()</p> <pre><code>shuowei@gaopeng:~$ ftp 172.16.10.101\nConnected to 172.16.10.101.\n220 (vsFTPd 3.0.2)\nName (172.16.10.101:shuowei): jdyyy\n331 Please specify the password.\nPassword:\n500 OOPS: vsftpd: refusing to run with writable root inside chroot()\nLogin failed.\nftp&gt;\n</code></pre> <p>\u53bb\u9664\u7cfb\u7edf\u7528\u6237\u5bb6\u76ee\u5f55\u5199\u6743\u9650</p> <pre><code>$ sudo chmod a-w /data/ftp/\n</code></pre> <p>\u4f46\u662f\u53c8\u6ca1\u6709\u5199\u7684\u6743\u9650\u4e86\u3002</p>"},{"location":"linux/service/#316","title":"3.1.6. \u6700\u7ec8\u914d\u7f6e","text":"<pre><code>listen=YES\nanonymous_enable=NO\nlocal_enable=YES\nwrite_enable=YES\ndirmessage_enable=YES\nuse_localtime=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nxferlog_file=/var/log/vsftpd.log\nsecure_chroot_dir=/var/run/vsftpd/empty\npam_service_name=vsftpd\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nguest_enable=YES\nguest_username=ftpadmin\nvirtual_use_local_privs=YES\n</code></pre> <p>\u8fd9\u6837\u865a\u62df\u7528\u6237\u8bfb\u5199\u5220\u6743\u9650\u90fd\u6709</p>"},{"location":"linux/service/#32","title":"3.2. \u5b9e\u73b0\u865a\u62df\u7528\u6237\u4e0d\u540c\u6743\u9650","text":""},{"location":"linux/service/#321-ftp","title":"3.2.1 \u4fee\u6539FTP\u4e3b\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>$ sudo vim /etc/vsftpd.conf\nuser_config_dir=/etc/vsftpd_user_conf\n</code></pre>"},{"location":"linux/service/#322-1","title":"3.2.2 \u7ed9\u6bcf\u4e2a\u865a\u62df\u7528\u6237\u521b\u5efa\u4e00\u4e2a\u72ec\u7acb\u7684\u6743\u9650\u914d\u7f6e\u6587\u4ef6-\u7248\u672c1","text":"<pre><code>$ sudo mkdir /data/ftp/jdyyy\n$ sudo mkdir /etc/vsftpd_user_conf\n$ sudo vim /etc/vsftpd_user_conf/jdyyy\n# \u53ea\u6709\u4e0a\u4f20\u6743\u9650\uff0c\u6ca1\u6709\u4e0b\u8f7d\u6743\u9650\nwrite_enable=YES\nvirtual_use_local_privs=NO\nanon_upload_enable=YES\nanon_world_readable_only=YES\nanon_mkdir_write_enable=YES\nanon_other_write_enable=NO\n\n$ sudo vim /etc/vsftpd_user_conf/yuanzhi\n# \u53ea\u6709\u4e0b\u8f7d\u6743\u9650\nwrite_enable=NO\nvirtual_use_local_privs=NO\nanon_upload_enable=NO\nanon_world_readable_only=NO\nanon_mkdir_write_enable=NO\nanon_other_write_enable=NO\n\n# \u6ce8\u610fftp\u6587\u4ef6\u5939\u7684\u6743\u9650\nubuntu@node1:/$ ll /data/\ntotal 12\ndrwxr-xr-x  3 root     root     4096 Jan 25 16:17 ./\ndrwxr-xr-x 23 root     root     4096 Jan 25 16:17 ../\ndrwxr-xr-x  4 ftpadmin ftpadmin 4096 Jan 25 17:50 ftp/\n# \u4e3b\u914d\u7f6e\u6587\u4ef6\nubuntu@node1:/$ grep -Ev \"(^#|^$)\" /etc/vsftpd.conf  \nlisten=YES\nanonymous_enable=NO\nlocal_enable=YES\ndirmessage_enable=YES\nuse_localtime=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nxferlog_file=/var/log/vsftpd.log\nchroot_local_user=YES\nsecure_chroot_dir=/var/run/vsftpd/empty\npam_service_name=vsftpd\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nguest_enable=YES\nguest_username=ftpadmin\nvirtual_use_local_privs=YES\nallow_writeable_chroot=YES\nuser_config_dir=/etc/vsftpd_user_conf\n</code></pre>"},{"location":"linux/service/#323-2","title":"3.2.3 \u7ed9\u6bcf\u4e2a\u865a\u62df\u7528\u6237\u521b\u5efa\u4e00\u4e2a\u72ec\u7acb\u7684\u6743\u9650\u914d\u7f6e\u6587\u4ef6-\u7248\u672c2","text":"\u6743\u9650 upload download admin \u4e0b\u8f7d - + + \u4e0a\u4f20 + - + \u521b\u5efa\u76ee\u5f55 + - + \u5220\u9664 - - + <pre><code>root@node1:~# ls -ld /data/ftp/*\ndrwxr-xr-x 2 ftpadmin ftpadmin 4096 Jan 28 18:50 /data/ftp/download\ndrwxr-xr-x 3 ftpadmin ftpadmin 4096 Jan 28 18:54 /data/ftp/upload\n\nvsftpd\u670d\u52a1\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\nubuntu@node1:~$ grep -Ev \"(^#|^$)\" /etc/vsftpd.conf \nlisten=YES\nanonymous_enable=NO\nlocal_enable=YES\ndirmessage_enable=YES\nuse_localtime=YES\nxferlog_enable=YES\nconnect_from_port_20=YES\nxferlog_file=/var/log/vsftpd.log\nchroot_local_user=YES\nsecure_chroot_dir=/var/run/vsftpd/empty\npam_service_name=vsftpd\nrsa_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem\nrsa_private_key_file=/etc/ssl/private/ssl-cert-snakeoil.key\nguest_enable=YES\nguest_username=ftpadmin\nallow_writeable_chroot=YES\nuser_config_dir=/etc/vsftpd_user_conf\n</code></pre> <p>\u521b\u5efa\u4e0d\u540c\u7528\u6237\u5404\u81ea\u7684\u7684\u914d\u7f6e\u6587\u4ef6</p> <pre><code>root@node1:~# ls /etc/vsftpd_user_conf/\nadmin  download  upload\n\nubuntu@node1:~$ cat /etc/vsftpd_user_conf/download \nwrite_enable=NO\nanon_upload_enable=NO\nanon_world_readable_only=NO\nanon_mkdir_write_enable=NO\nanon_other_write_enable=NO\nlocal_root=/data/ftp/download\n\nubuntu@node1:~$ cat /etc/vsftpd_user_conf/upload \nwrite_enable=YES\nanon_upload_enable=YES\nanon_world_readable_only=YES\nanon_mkdir_write_enable=YES\nanon_other_write_enable=NO\nlocal_root=/data/ftp/upload\n\n\nubuntu@node1:~$ cat /etc/vsftpd_user_conf/admin\nwrite_enable=YES\nanon_upload_enable=YES\nanon_world_readable_only=NO\nanon_mkdir_write_enable=YES\nanon_other_write_enable=YES\n</code></pre> <p>\u751f\u6210\u7528\u6237\u6570\u636e\u5e93\u6587\u4ef6</p> <pre><code>ubuntu@node1:~$ cat  /etc/vsftpd/ftpusers.txt upload\n123456\ndownload\n123456\nadmin\nadmin\nubuntu@node1:~$ sudo db_load -T -t hash -f /etc/vsftpd/ftpusers.txt  /etc/vsftpd/ftpusers.db\n</code></pre> <p>\u91cd\u542f\u670d\u52a1</p>"},{"location":"linux/service/#ssh","title":"\u4e8c\u3001SSH","text":""},{"location":"linux/service/#1_3","title":"1. \u6267\u884c\u547d\u4ee4","text":""},{"location":"linux/service/#1_4","title":"1. \u6267\u884c\u5355\u6761\u547d\u4ee4","text":"<pre><code>    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 hostname\n    ubuntu@172.16.10.102's password: \n    node2\n</code></pre>"},{"location":"linux/service/#2_3","title":"2. \u6267\u884c\u5e26\u53c2\u6570\u7684\u547d\u4ee4","text":"<pre><code>    ssh ubuntu@172.16.10.102 grep root /etc/passwd\n    ubuntu@172.16.10.102's password: \n    root:x:0:0:root:/root:/bin/bash\n</code></pre>"},{"location":"linux/service/#3_3","title":"3. \u6267\u884c\u591a\u6761\u547d\u4ee4","text":"<p>\u6267\u884c\u591a\u6761\u547d\u4ee4\u65f6\uff0c\u53ea\u8981\u7528\u5206\u53f7\u628a\u547d\u4ee4\u5206\u5272\u5f00\u5c31\u53ef\u4ee5\u4e86\uff0c\u4f46\u662f\u8981\u628a\u591a\u6761\u547d\u4ee4\u7528\u5f15\u53f7\u5f15\u8d77\u6765\uff0c\u5426\u5219\u5206\u53f7\u540e\u9762\u7684\u547d\u4ee4\u5c31\u662f\u5728\u672c\u5730\u6267\u884c\u7684\u3002</p> <pre><code>    # \u4e0d\u52a0\u5206\u53f7\n    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 cat /etc/hostname;hostname -I\n    node2\n    172.16.10.101\n</code></pre> <pre><code>    # \u52a0\u5206\u53f7\n    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 \"cat /etc/hostname;hostname -I\"\n    node2\n    172.16.10.102\n</code></pre>"},{"location":"linux/service/#4_1","title":"4. \u6267\u884c\u591a\u884c\u547d\u4ee4","text":"<p>\u7528\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u5f00\u5934\uff0c\u7136\u540e\u5199\u4e0a\u51e0\u884c\u547d\u4ee4\uff0c\u6700\u540e\u518d\u7528\u76f8\u540c\u7684\u5f15\u53f7\u6765\u7ed3\u675f\u3002</p> <pre><code>    ubuntu@node1:~$ ssh   ubuntu@172.16.10.102 \"\n    &gt; hostname -I\n    &gt; uname -r\n    &gt; uptime\n    &gt; \"\n    ubuntu@172.16.10.102's password: \n    172.16.10.102 \n    4.4.0-31-generic\n    15:39:13 up  6:28,  2 users,  load average: 0.00, 0.00, 0.00\n</code></pre>"},{"location":"linux/service/#5","title":"5. \u6267\u884c\u4ea4\u4e92\u547d\u4ee4","text":"<pre><code>    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 \"sudo apt install nginx\"\n    ubuntu@172.16.10.102's password: \n    sudo: no tty present and no askpass program specified\n</code></pre> <p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u5f53\u4f60\u6267\u884c\u4e0d\u5e26\u547d\u4ee4\u7684 ssh \u8fde\u63a5\u65f6\uff0c\u4f1a\u4e3a\u4f60\u5206\u914d\u4e00\u4e2a TTY\u3002\u56e0\u4e3a\u6b64\u65f6\u4f60\u5e94\u8be5\u662f\u60f3\u8981\u8fd0\u884c\u4e00\u4e2a shell \u4f1a\u8bdd\u3002</p> <p>\u4f46\u662f\u5f53\u4f60\u901a\u8fc7 ssh \u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u6267\u884c\u547d\u4ee4\u65f6\uff0c\u5e76\u4e0d\u4f1a\u4e3a\u8fd9\u4e2a\u8fdc\u7a0b\u4f1a\u8bdd\u5206\u914d TTY\u3002\u6b64\u65f6 ssh \u4f1a\u7acb\u5373\u9000\u51fa\u8fdc\u7a0b\u4e3b\u673a\uff0c\u6240\u4ee5\u9700\u8981\u4ea4\u4e92\u7684\u547d\u4ee4\u4e5f\u968f\u4e4b\u7ed3\u675f\u3002</p> <p>\u8fd9\u65f6\u9700\u8981\u7528 -t \u53c2\u6570\u663e\u5f0f\u7684\u544a\u8bc9 ssh\uff0c\u6211\u4eec\u9700\u8981\u4e00\u4e2a TTY \u8fdc\u7a0b shell \u8fdb\u884c\u4ea4\u4e92\uff0c\u6dfb\u52a0 -t \u53c2\u6570\u540e\uff0cssh \u4f1a\u4fdd\u6301\u767b\u5f55\u72b6\u6001\uff0c\u76f4\u5230\u4f60\u9000\u51fa\u9700\u8981\u4ea4\u4e92\u7684\u547d\u4ee4\u3002</p> <pre><code>    ubuntu@node1:~$ ssh -t  ubuntu@172.16.10.102 \"sudo apt install nginx\"\n    ubuntu@172.16.10.102's password:\n    [sudo] password for ubuntu:\n    Reading package lists... Done\n    Building dependency tree\n    Reading state information... Done\n    The following extra packages will be installed:\n    fontconfig-config fonts-dejavu-core libfontconfig1 libgd3 libjbig0\n    libjpeg-turbo8 libjpeg8 libtiff5 libvpx1 libxpm4 libxslt1.1 nginx-common\n    nginx-core\n    Suggested packages:\n    libgd-tools fcgiwrap nginx-doc\n    The following NEW packages will be installed:\n    fontconfig-config fonts-dejavu-core libfontconfig1 libgd3 libjbig0\n    libjpeg-turbo8 libjpeg8 libtiff5 libvpx1 libxpm4 libxslt1.1 nginx\n    nginx-common nginx-core\n    0 upgraded, 14 newly installed, 0 to remove and 8 not upgraded.\n    Need to get 2,681 kB of archives.\n    After this operation, 9,073 kB of additional disk space will be used.\n    Do you want to continue? [Y/n] n\n    Abort.\n    Connection to 172.16.10.102 closed.\n</code></pre>"},{"location":"linux/service/#6","title":"6. \u4f7f\u7528\u672c\u5730\u53d8\u91cf","text":"<pre><code>    ubuntu@node1:~$ name=\"nginx\"\n    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 \"echo \"Install $name\"\"\n    ubuntu@172.16.10.102's password: \n    Install nginx\n</code></pre>"},{"location":"linux/service/#2-ssh","title":"2. ssh\u6267\u884c\u811a\u672c","text":""},{"location":"linux/service/#1_5","title":"1. \u6267\u884c\u8fdc\u7a0b\u4e0d\u5e26\u53c2\u6570\u7684\u811a\u672c","text":"<pre><code>    #\u8fdc\u7a0b\u811a\u672c\u6587\u4ef6\u5185\u5bb9\n    ubuntu@node2:~$ cat hello.sh\n    #!/bin/bash\n    echo \"hello world\"\n</code></pre> <pre><code>    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 \"$HOME/hello.sh\"\n    ubuntu@172.16.10.102's password:\n    hello world\n</code></pre>"},{"location":"linux/service/#2_4","title":"2. \u6267\u884c\u8fdc\u7a0b\u9700\u8981\u53c2\u6570\u7684\u811a\u672c","text":"<pre><code>    # \u8fdc\u7a0b\u811a\u672c\u6587\u4ef6\u5185\u5bb9\n    ubuntu@node2:~$ cat script.sh\n    #!/bin/bash\n    name=$1\n    echo \"install $name\"\n    echo \"installed succeed!\"\n</code></pre> <pre><code>    ubuntu@node1:~$ name=nginx\n    ubuntu@node1:~$ ssh ubuntu@172.16.10.102   \"$HOME/script.sh $name\"\n    ubuntu@172.16.10.102's password:\n    install nginx\n    installed succeed!\n</code></pre>"},{"location":"linux/service/#3_4","title":"3. \u6267\u884c\u672c\u5730\u4e0d\u5e26\u53c2\u6570\u7684\u811a\u672c","text":"<pre><code>    ubuntu@node1:~$ cat hello.sh\n    #!/bin/bash\n    hostname\n    touch hello.txt\n    ls\n\n    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 &lt; hello.sh\n    Pseudo-terminal will not be allocated because stdin is not a terminal.\n    ubuntu@172.16.10.102's password:\n    node2\n    hello.txt\n</code></pre>"},{"location":"linux/service/#4_2","title":"4. \u6267\u884c\u672c\u5730\u9700\u8981\u53c2\u6570\u7684\u811a\u672c\u6587\u4ef6","text":"<pre><code>    # \u811a\u672c\u5185\u5bb9\uff0c\u9700\u8981\u4f20\u5165\u4e00\u4e2a\u53c2\u6570\n    ubuntu@node1:~$ cat script.sh\n    #!/bin/bash\n    name=$1\n    echo \"install $name\"\n    echo \"installed succeed!\"\n    # \u9700\u8981\u52a0\u4e0abash -s\n    ubuntu@node1:~$ ssh ubuntu@172.16.10.102 \"bash -s\" &lt; script.sh nginx\n    ubuntu@172.16.10.102's password:\n    install nginx\n    installed succeed!\n</code></pre>"},{"location":"linux/vim/","title":"VIM","text":"<p>Vim\u662f\u4ece vi \u53d1\u5c55\u51fa\u6765\u7684\u4e00\u4e2a\u6587\u672c\u7f16\u8f91\u5668</p>"},{"location":"linux/vim/#vim_1","title":"\u4e00\u3001VIM\u6a21\u5f0f","text":"<p>6\u79cd\u57fa\u672c\u6a21\u5f0f</p> <ol> <li>\u666e\u901a\u6a21\u5f0f\uff08Normal\uff09</li> <li>\u63d2\u5165\u6a21\u5f0f\uff08INSERT\uff09</li> <li>\u53ef\u89c6\u6a21\u5f0f\uff08VISUAL\uff09</li> <li>\u9009\u62e9\u6a21\u5f0f\uff08SELECT\uff09</li> <li>\u547d\u4ee4\u884c\u6a21\u5f0f\uff08Command line\uff09</li> <li>Ex\u6a21\u5f0f</li> </ol>"},{"location":"linux/vim/#_1","title":"\u4e8c\u3001\u6a21\u5f0f\u5207\u6362","text":""},{"location":"linux/vim/#1","title":"1. \u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u63d2\u5165\u6a21\u5f0f","text":"\u6309\u952e \u8bf4\u660e \u52a9\u8bb0 <code>i</code> \u5728\u5f53\u524d\u5149\u6807\u5904\u8fdb\u884c\u7f16\u8f91 insert <code>I</code> \u5728\u884c\u9996\u63d2\u5165 Insert <code>a</code> \u5728\u5149\u6807\u540e\u63d2\u5165\u7f16\u8f91 append <code>A</code> \u5728\u884c\u672b\u63d2\u5165 Append <code>o</code> \u5728\u5f53\u524d\u884c\u540e\u63d2\u5165\u4e00\u4e2a\u65b0\u884c open <code>O</code> \u5728\u5f53\u524d\u884c\u524d\u63d2\u5165\u4e00\u4e2a\u65b0\u884c Open"},{"location":"linux/vim/#2","title":"2.\u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u547d\u4ee4\u884c\u6a21\u5f0f","text":"<p>\u666e\u901a\u6a21\u5f0f\u4e0b\u6309\u4e0b<code>:</code></p>"},{"location":"linux/vim/#3","title":"3.\u666e\u901a\u6a21\u5f0f\u5207\u6362\u5230\u53ef\u89c6\u6a21\u5f0f","text":"<p>\u666e\u901a\u6a21\u5f0f\u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>v</code> \u8fdb\u5165\u5b57\u7b26\u9009\u62e9\u6a21\u5f0f\uff0c\u518d\u6b21\u6309\u4e0b\u540e\u53d6\u6d88\u9009\u53d6 <code>V</code> \u8fdb\u5165\u884c\u9009\u62e9\u6a21\u5f0f\uff0c\u518d\u6b21\u6309\u4e0b\u540e\u53d6\u6d88\u9009\u53d6 <code>Ctrl + v</code> \u8fdb\u5165\u533a\u57df\u9009\u62e9\u6a21\u5f0f\uff0c\u518d\u6b21\u6309\u4e0b\u540e\u53d6\u6d88\u9009\u53d6"},{"location":"linux/vim/#4","title":"4.\u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f","text":"\u547d\u4ee4 \u8bf4\u660e <code>[ESC]</code> \u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f <code>Ctrl + c</code> \u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f <code>Ctrl + [</code> \u5207\u6362\u5230\u666e\u901a\u6a21\u5f0f"},{"location":"linux/vim/#_2","title":"\u4e09\u3001\u9000\u51fa","text":""},{"location":"linux/vim/#1_1","title":"1. \u4f7f\u7528\u547d\u4ee4\u884c\u6a21\u5f0f\u9000\u51fa","text":"\u547d\u4ee4 \u8bf4\u660e <code>:q</code> \u9000\u51fa <code>:q!</code> \u5f3a\u5236\u9000\u51fa <code>:wq</code> \u4fdd\u5b58\u9000\u51fa <code>:wq!</code> \u5f3a\u5236\u4fdd\u5b58\u9000\u51fa <code>:x</code> \u4fdd\u5b58\u5e76\u9000\u51fa <code>:w &lt;\u6587\u4ef6\u8def\u5f84&gt;</code> \u53e6\u5b58\u4e3a <code>:saveas &lt;\u6587\u4ef6\u8def\u5f84&gt;</code> \u53e6\u5b58\u4e3a"},{"location":"linux/vim/#2_1","title":"2. \u666e\u901a\u6a21\u5f0f\u4e0b\u9000\u51fa","text":"\u547d\u4ee4 \u8bf4\u660e <code>ZZ</code> \u4fdd\u5b58\u5e76\u9000\u51fa <code>ZQ</code> \u4e0d\u4fdd\u5b58\u9000\u51fa"},{"location":"linux/vim/#_3","title":"\u4e09\u3001\u6e38\u6807\u79fb\u52a8","text":""},{"location":"linux/vim/#1_2","title":"1. \u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u79fb\u52a8","text":""},{"location":"linux/vim/#1_3","title":"1. \u666e\u901a\u79fb\u52a8","text":"\u6309\u952e \u8bf4\u660e <code>h</code> \u5149\u6807\u5de6\u79fb <code>j</code> \u5149\u6807\u4e0b\u79fb <code>k</code> \u5149\u6807\u4e0a\u79fb <code>l</code> \u5149\u6807\u53f3\u79fb <code>{n}h</code> \u5149\u6807\u5de6\u79fbn \u4e2a\u4f4d\u7f6e\uff0cn(umber) \u6307\u6570\u5b57 <code>{n}j</code> \u5149\u6807\u4e0b\u79fbn \u4e2a\u4f4d\u7f6e\uff0cn(umber) \u6307\u6570\u5b57 <code>{n}k</code> \u5149\u6807\u4e0a\u79fbn \u4e2a\u4f4d\u7f6e\uff0cn(umber) \u6307\u6570\u5b57 <code>{n}l</code> \u5149\u6807\u53f3\u79fbn \u4e2a\u4f4d\u7f6e\uff0cn(umber) \u6307\u6570\u5b57"},{"location":"linux/vim/#2_2","title":"2. \u5149\u6807\u8df3\u8f6c","text":""},{"location":"linux/vim/#1_4","title":"1. \u884c\u95f4\u8df3\u8f6c","text":"\u547d\u4ee4 \u8bf4\u660e <code>{n}G</code> \u79fb\u52a8\u5230\u7b2cn\u884c <code>gg</code> \u79fb\u52a8\u5230\u7b2c\u4e00\u884c <code>G</code> \u79fb\u52a8\u5230\u6700\u540e\u4e00\u884c <p>Ctrl + o: \u5feb\u901f\u56de\u5230\u4e0a\u4e00\u6b21(\u8df3\u8f6c\u524d)\u5149\u6807\u6240\u5728\u4f4d\u7f6e</p>"},{"location":"linux/vim/#2_3","title":"2. \u884c\u5185\u8df3\u8f6c","text":"\u547d\u4ee4 \u8bf4\u660e \u52a9\u8bb0 <code>w</code> \u5230\u4e0b\u4e00\u4e2a\u5355\u8bcd\u7684\u5f00\u5934 word <code>e</code> \u5230\u5f53\u524d\u5355\u8bcd\u7684\u7ed3\u5c3e end <code>b</code> \u5230\u524d\u4e00\u4e2a\u5355\u8bcd\u7684\u5f00\u5934 back-word <code>ge</code> \u5230\u524d\u4e00\u4e2a\u5355\u8bcd\u7684\u7ed3\u5c3e <code>0</code> \u5230\u884c\u9996 <code>^</code> \u8df3\u5230\u884c\u9996\u5f00\u59cb\u7684\u7b2c\u4e00\u4e2a\u975e\u7a7a\u767d\u5b57\u7b26 <code>$</code> \u5230\u884c\u5c3e <code>f&lt;\u5b57\u6bcd&gt;</code> \u5411\u540e\u641c\u7d22&lt;\u5b57\u6bcd&gt;\u5e76\u8df3\u8f6c\u5230\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u4f4d\u7f6e(\u975e\u5e38\u5b9e\u7528) <code>F&lt;\u5b57\u6bcd&gt;</code> \u5411\u524d\u641c\u7d22&lt;\u5b57\u6bcd&gt;\u5e76\u8df3\u8f6c\u5230\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u4f4d\u7f6e <code>t&lt;\u5b57\u6bcd</code> \u5411\u540e\u641c\u7d22&lt;\u5b57\u6bcd&gt;\u5e76\u8df3\u8f6c\u5230\u7b2c\u4e00\u4e2a\u5339\u914d\u4f4d\u7f6e\u4e4b\u524d\u7684\u4e00\u4e2a\u5b57\u6bcd(\u4e0d\u5e38\u7528) <code>T&lt;\u5b57\u6bcd&gt;</code> \u5411\u524d\u641c\u7d22&lt;\u5b57\u6bcd&gt;\u5e76\u8df3\u8f6c\u5230\u7b2c\u4e00\u4e2a\u5339\u914d\u4f4d\u7f6e\u4e4b\u540e\u7684\u4e00\u4e2a\u5b57\u6bcd(\u4e0d\u5e38\u7528)"},{"location":"linux/vim/#3_1","title":"3.\u6309\u53e5\u5b50\u6216\u6bb5\u843d\u79fb\u52a8","text":"\u547d\u4ee4 \u8bf4\u660e <code>)</code> \u5411\u524d\u79fb\u52a8\u4e00\u6761\u53e5\u5b50 <code>}</code> \u5411\u524d\u79fb\u52a8\u4e00\u4e2a\u6bb5\u843d"},{"location":"linux/vim/#3_2","title":"3. \u5728\u5c4f\u5e55\u95f4\u79fb\u52a8","text":"\u547d\u4ee4 \u8bf4\u660e <code>H</code> \u5411\u4e0a\u79fb\u52a8\u4e00\u5c4f <code>M</code> \u79fb\u52a8\u5230\u5c4f\u5e55\u4e2d\u95f4 <code>L</code> \u79fb\u52a8\u5230\u5c4f\u5e55\u5e95\u7aef <code>Ctrl + u</code> \u5411\u4e0a\u79fb\u52a8\u534a\u5c4f <code>Ctrl + d</code> \u5411\u4e0b\u79fb\u52a8\u534a\u5c4f <code>Ctrl + f</code> \u4e0b\u4e00\u9875 <code>Ctrl + b</code> \u4e0a\u4e00\u9875 <code>Ctrl + e</code> \u5411\u4e0b\u6eda\u52a8\u4e00\u884c <code>Ctrl + y</code> \u5411\u4e0a\u6eda\u52a8\u4e00\u884c"},{"location":"linux/vim/#2_4","title":"2.\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u79fb\u52a8","text":"<ol> <li><code>Alt + hjkl</code>\u8fdb\u5165\u666e\u901a\u6a21\u5f0f\u79fb\u52a8</li> <li>\u4f7f\u7528\u952e\u76d8\u4e0a\u7684\u65b9\u5411\u952e\u79fb\u52a8\uff08\u6548\u7387\u4f4e\uff0c\u4e0d\u63a8\u8350\uff09</li> </ol>"},{"location":"linux/vim/#_4","title":"\u56db\u3001\u5220\u9664\u6587\u672c","text":""},{"location":"linux/vim/#1_5","title":"1. \u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u5220\u9664","text":"\u6309\u952e \u8bf4\u660e <code>x</code> \u5220\u9664\u6e38\u6807\u6240\u5728\u7684\u5b57\u7b26 <code>X</code> \u5220\u9664\u6e38\u6807\u6240\u5728\u524d\u4e00\u4e2a\u5b57\u7b26 <code>dd</code> \u5220\u9664\u6574\u884c delete <code>{n}dd</code> \u5220\u9664n\u884c <code>d{n}w</code> \u5220\u9664n\u4e2a\u5355\u8bcd <code>d$ \u6216 D</code> \u5220\u9664\u81f3\u884c\u5c3e <code>d^</code> \u5220\u9664\u81f3\u884c\u9996 <code>dG</code> \u5220\u9664\u5230\u6587\u6863\u7ed3\u5c3e\u5904 <code>d1G</code> \u5220\u81f3\u6587\u6863\u9996\u90e8"},{"location":"linux/vim/#2_5","title":"2.\u5728\u63d2\u5165\u6a21\u5f0f\u4e0b\u5220\u9664","text":"\u6309\u952e \u8bf4\u660e Backspace \u5220\u9664\u5149\u6807\u524d\u4e00\u4e2a\u5b57\u7b26 Delete \u5220\u9664\u5149\u6807\u540e\u4e00\u4e2a\u5b57\u7b26"},{"location":"linux/vim/#yank","title":"\u4e94\u3001\u590d\u5236(yank\uff09","text":"\u547d\u4ee4 \u8bf4\u660e <code>y</code> \u590d\u5236\u5f53\u524d\u9009\u62e9\u533a\u57df <code>yy</code> \u6216 <code>Y</code> \u590d\u5236\u6e38\u6807\u6240\u5728\u7684\u6574\u884c <code>y^</code> \u6216 <code>y0</code> \u590d\u5236\u81f3\u884c\u9996\uff0c\u4e0d\u542b\u5149\u6807\u6240\u5728\u5904 <code>y$</code> \u590d\u5236\u81f3\u884c\u5c3e\uff0c\u542b\u5149\u6807\u6240\u5728\u5904\u5b57\u7b26\u3002 <code>yw</code> \u590d\u5236\u4e00\u4e2a\u5355\u8bcd <code>y2w</code> \u590d\u5236\u4e24\u4e2a\u5355\u8bcd <code>yG</code> \u590d\u5236\u81f3\u6587\u672c\u672b <code>y1G</code> \u590d\u5236\u81f3\u6587\u672c\u5f00\u5934\u3002"},{"location":"linux/vim/#_5","title":"\u516d\u3001\u7c98\u8d34","text":"\u547d\u4ee4 \u8bf4\u660e \u52a9\u8bb0 <code>p</code> \u7c98\u8d34\u81f3\u5149\u6807\u540e\uff08\u4e0b\uff09 paste <code>P</code> \u7c98\u8d34\u81f3\u5149\u6807\u524d\uff08\u4e0a\uff09 paste"},{"location":"linux/vim/#_6","title":"\u4e03\u3001\u66ff\u6362","text":"<p>\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u4f7f\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e \u52a9\u8bb0 <code>r&lt;\u5f85\u66ff\u6362\u5b57\u6bcd&gt;</code> \u5c06\u6e38\u6807\u6240\u5728\u5b57\u6bcd\u66ff\u6362\u4e3a\u6307\u5b9a\u5b57\u6bcd <code>R</code> \u8fde\u7eed\u66ff\u6362\uff0c\u76f4\u5230\u6309\u4e0b<code>Esc</code> <code>cc</code> \u66ff\u6362\u6574\u884c\uff0c\u5373\u5220\u9664\u6e38\u6807\u6240\u5728\u884c\uff0c\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f change <code>cw</code> \u66ff\u6362\u4e00\u4e2a\u5355\u8bcd\uff0c\u5373\u5220\u9664\u4e00\u4e2a\u5355\u8bcd\uff0c\u5e76\u8fdb\u5165\u63d2\u5165\u6a21\u5f0f <code>C</code> \u66ff\u6362\u6e38\u6807\u4ee5\u540e\u81f3\u884c\u672b <code>~</code> \u53cd\u8f6c\u6e38\u6807\u6240\u5728\u5b57\u6bcd\u5927\u5c0f\u5199"},{"location":"linux/vim/#_7","title":"\u516b\u3001\u64a4\u9500","text":"\u547d\u4ee4 \u8bf4\u660e <code>u{n}</code> \u64a4\u9500\u4e00\u6b21\u6216n\u6b21\u64cd\u4f5c <code>U</code> \u64a4\u9500\u5f53\u524d\u884c\u7684\u6240\u6709\u4fee\u6539 <code>Ctrl + r</code> redo\uff0c\u5373\u64a4\u9500undo\u7684\u64cd\u4f5c"},{"location":"linux/vim/#_8","title":"\u4e5d\u3001\u8c03\u6574\u6587\u672c\u4f4d\u7f6e","text":"<p>\u547d\u4ee4\u884c\u6a21\u5f0f\u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>:ce</code> (center)\u4f7f\u672c\u884c\u5185\u5bb9\u5c45\u4e2d <code>:ri</code> (right)\u547d\u4ee4\u4f7f\u672c\u884c\u6587\u672c\u9760\u53f3 <code>:le</code> (left)\u547d\u4ee4\u4f7f\u672c\u884c\u5185\u5bb9\u9760\u5de6"},{"location":"linux/vim/#_9","title":"\u5341\u3001\u67e5\u627e","text":""},{"location":"linux/vim/#1_6","title":"1. \u5feb\u901f\u67e5\u627e","text":"<p>\u666e\u901a\u6a21\u5f0f\u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>?&lt;\u67e5\u627e\u7684\u5b57\u7b26\u4e32&gt;</code> \u5411\u4e0a\u67e5\u627e <code>/&lt;\u67e5\u627e\u7684\u5b57\u7b26\u4e32&gt;</code> \u5411\u4e0b\u67e5\u627e"},{"location":"linux/vim/#2_6","title":"2. \u9ad8\u7ea7\u67e5\u627e","text":"<p>\u666e\u901a\u6a21\u5f0f\u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>*</code> \u5411\u540e\uff08\u4e0b\uff09\u5bfb\u627e\u6e38\u6807\u6240\u5728\u5904\u7684\u5355\u8bcd <code>#</code> \u5411\u524d\uff08\u4e0a\uff09\u5bfb\u627e\u6e38\u6807\u6240\u5728\u5904\u7684\u5355\u8bcd <code>g*</code> \u540c* \uff0c\u4f46\u90e8\u5206\u7b26\u5408\u8be5\u5355\u8bcd\u5373\u53ef <code>g#</code> \u540c#\uff0c\u4f46\u90e8\u5206\u7b26\u5408\u8be5\u5355\u8bcd\u5373\u53ef <p>n: \u5411\u4e0b\u7ee7\u7eed\u67e5\u627e</p> <p>N:\u5411\u4e0a\u7ee7\u7eed\u67e5\u627e</p>"},{"location":"linux/vim/#_10","title":"\u5341\u4e00\u3001\u591a\u6587\u4ef6\u7f16\u8f91","text":""},{"location":"linux/vim/#1-vim","title":"1. \u4f7f\u7528vim\u7f16\u8f91\u591a\u4e2a\u6587\u4ef6","text":"<pre><code># \u4f7f\u7528vim\u7f16\u8f91\u591a\u4e2a\u6587\u4ef6\n$ vim a.txt b.txt\n</code></pre> <p>\u547d\u4ee4\u884c\u6a21\u5f0f \u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>:n</code> \u5207\u6362\u5230\u4e0b\u4e00\u4e2a\u6587\u4ef6\uff0c\u53ef\u4ee5\u52a0<code>!</code> \u5f3a\u5236\u5207\u6362\uff08\u653e\u5f03\u5f53\u524d\u4fee\u6539\uff09 <code>:N</code> \u5207\u6362\u5230\u4e0a\u4e00\u4e2a\u6587\u4ef6\uff0c\u53ef\u4ee5\u52a0<code>!</code> \u5f3a\u5236\u5207\u6362\uff08\u653e\u5f03\u5f53\u524d\u4fee\u6539\uff09"},{"location":"linux/vim/#2-vim","title":"2. \u8fdb\u5165vim\u540e\u6253\u5f00\u65b0\u6587\u4ef6","text":"<p>\u547d\u4ee4\u884c\u6a21\u5f0f\u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>:e &lt;\u6587\u4ef6\u540d&gt;</code> \u6253\u5f00\u65b0\u6587\u4ef6 <code>:e#</code> \u56de\u5230\u524d\u4e00\u4e2a\u6587\u4ef6 <code>:ls</code> \u5217\u51fa\u4ee5\u524d\u7f16\u8f91\u8fc7\u7684\u6587\u6863 <code>:b &lt;\u6587\u4ef6\u540d&gt;\uff08\u6216\u8005\u7f16\u53f7\uff09</code> \u76f4\u63a5\u8fdb\u5165\u6587\u4ef6\u7f16\u8f91 <code>:bd</code> &lt;\u6587\u4ef6\u540d&gt;\uff08\u6216\u8005\u7f16\u53f7\uff09` \u5220\u9664\u4ee5\u524d\u7f16\u8f91\u8fc7\u7684\u5217\u8868\u4e2d\u7684\u6587\u4ef6\u9879\u76ee <code>e! &lt;\u6587\u4ef6\u540d&gt;</code> \u65b0\u6253\u5f00\u6587\u4ef6\uff0c\u653e\u5f03\u6b63\u5728\u7f16\u8f91\u7684\u6587\u4ef6 <code>:f</code> \u663e\u793a\u6b63\u5728\u7f16\u8f91\u7684\u6587\u4ef6\u540d <code>:f new.txt</code> \u6539\u53d8\u6b63\u5728\u7f16\u8f91\u7684\u6587\u4ef6\u540d\u5b57\u4e3anew.txt"},{"location":"linux/vim/#_11","title":"\u5341\u4e09\u3001\u89c6\u56fe\u64cd\u4f5c","text":"<p>vim \u53ef\u4ee5\u5728\u4e00\u4e2a\u754c\u9762\u91cc\u6253\u5f00\u591a\u4e2a\u7a97\u53e3\u8fdb\u884c\u7f16\u8f91\uff0c\u8fd9\u4e9b\u7f16\u8f91\u7a97\u53e3\u79f0\u4e3a vim \u7684\u89c6\u7a97\u3002</p>"},{"location":"linux/vim/#1_7","title":"1. \u547d\u4ee4\u884c\u6a21\u5f0f\u4e0b\u6253\u5f00\u89c6\u7a97","text":"\u547d\u4ee4 \u8bf4\u660e <code>:new</code> \u6253\u5f00\u4e00\u4e2a\u65b0\u7684 vim \u89c6\u7a97\uff0c\u5e76\u8fdb\u5165\u89c6\u7a97\u7f16\u8f91\u4e00\u4e2a\u65b0\u6587\u4ef6 <code>:sp &lt;\u6587\u4ef6\u540d&gt;</code> \u6253\u5f00\u65b0\u7684\u6c34\u5e73\u5206\u5c4f\u89c6\u7a97\u6765\u7f16\u8f91\u6587\u4ef6 <code>:vsp &lt;\u6587\u4ef6\u540d&gt;</code> \u6253\u5f00\u65b0\u7684\u5782\u76f4\u5206\u5c4f\u89c6\u7a97\u6765\u7f16\u8f91\u6587\u4ef6"},{"location":"linux/vim/#2_7","title":"2. \u666e\u901a\u6a21\u5f0f\u4e0b\u6253\u5f00\u89c6\u7a97","text":"\u547d\u4ee4 \u8bf4\u660e <code>Ctrl+w s</code> \u5c06\u5f53\u524d\u7a97\u53e3\u5206\u5272\u6210\u4e24\u4e2a\u6c34\u5e73\u7684\u7a97\u53e3 <code>Ctrl+w v</code> \u5c06\u5f53\u524d\u7a97\u53e3\u5206\u5272\u6210\u4e24\u4e2a\u5782\u76f4\u7684\u7a97\u53e3 <code>Ctrl+w q</code> \u5373 :q \u7ed3\u675f\u5206\u5272\u51fa\u6765\u7684\u89c6\u7a97 <code>Ctrl+w o</code> \u6253\u5f00\u4e00\u4e2a\u89c6\u7a97\u5e76\u4e14\u9690\u85cf\u4e4b\u524d\u7684\u6240\u6709\u89c6\u7a97 <code>Ctrl+w j</code> \u79fb\u81f3\u4e0b\u9762\u89c6\u7a97 <code>Ctrl+w k</code> \u79fb\u81f3\u4e0a\u9762\u89c6\u7a97 <code>Ctrl+w h</code> \u79fb\u81f3\u5de6\u8fb9\u89c6\u7a97 <code>Ctrl+w l</code> \u79fb\u81f3\u53f3\u8fb9\u89c6\u7a97 <code>Ctrl+w J</code> \u5c06\u5f53\u524d\u89c6\u7a97\u79fb\u81f3\u4e0b\u9762 <code>Ctrl+w K</code> \u5c06\u5f53\u524d\u89c6\u7a97\u79fb\u81f3\u4e0a\u9762 <code>Ctrl+w H</code> \u5c06\u5f53\u524d\u89c6\u7a97\u79fb\u81f3\u5de6\u8fb9 <code>Ctrl+w L</code> \u5c06\u5f53\u524d\u89c6\u7a97\u79fb\u81f3\u53f3\u8fb9 <code>Ctrl+w -</code> \u51cf\u5c0f\u89c6\u7a97\u7684\u9ad8\u5ea6 <code>Ctrl+w +</code> \u589e\u52a0\u89c6\u7a97\u7684\u9ad8\u5ea6"},{"location":"linux/vim/#tab","title":"\u5341\u56db\u3001\u5206\u9875(tab)","text":"<p>\u547d\u4ee4\u884c\u4e0b\u8f93\u5165</p> \u547d\u4ee4 \u8bf4\u660e <code>:tabnew filename</code> \u6253\u5f00\u65b0\u5206\u9875\u5e76\u7f16\u8f91\u65b0\u6587\u4ef6 <code>:tabclose</code> \u5173\u95ed\u5f53\u524d\u5206\u9875 <code>:tabonly</code> \u5173\u95ed\u5176\u4ed6\u6240\u6709\u7684\u5206\u9875\u3002 <code>:tabn</code> \u79fb\u52a8\u5230\u4e0a\u4e00\u4e2a\u6807\u7b7e\u9875\uff0c\u6216\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u8f93\u5165<code>gt</code> <code>:tabp</code> \u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a\u6807\u7b7e\u9875\uff0c\u6216\u5728\u666e\u901a\u6a21\u5f0f\u4e0b\u8f93\u5165<code>gT</code>"},{"location":"linux/vim/#_12","title":"\u5341\u4e94\u3001\u914d\u7f6e","text":""},{"location":"linux/vim/#1_8","title":"1. \u81ea\u52a8\u6dfb\u52a0\u6587\u4ef6\u5934\u90e8\u6ce8\u91ca\u4fe1\u606f","text":"<pre><code>func SetComment_c()\n        call setline(1,\"/*================================================================\")\n        call append(line(\".\"),   \"*   Copyright \u00a9 \".strftime(\"%Y\").\" Yuanzhi Gao. All rights reserved.\")\n        call append(line(\".\")+1, \"*   \")\n        call append(line(\".\")+2, \"*   FileName \uff1a\".expand(\"%:t\"))\n        call append(line(\".\")+3, \"*   Author   \uff1aYuanzhi Gao\")\n        call append(line(\".\")+4, \"*   Mail     \uff1agaopeng0214@126.com\")\n        call append(line(\".\")+5, \"*   Date     \uff1a\".strftime(\"%Y\u5e74%m\u6708%d\u65e5\"))\n        call append(line(\".\")+6, \"*\")\n        call append(line(\".\")+7, \"================================================================*/\")\n        call append(line(\".\")+8, \"\")\n        call append(line(\".\")+9, \"\")\nendfunc\n\n\" \u52a0\u5165shell,Makefile\u6ce8\u91ca\nfunc SetComment()\n        call setline(3, \"#================================================================\")\n        call setline(4, \"#   Copyright \u00a9 \".strftime(\"%Y\").\" Yuanzhi Gao. All rights reserved.\")\n        call setline(5, \"#   \")\n        call setline(6, \"#   FileName \uff1a\".expand(\"%:t\"))\n        call setline(7, \"#   Author   \uff1aYuanzhi Gao\")\n        call setline(8, \"#   Mail     \uff1agaopeng0214@126.com\")\n        call setline(9, \"#   Date     \uff1a\".strftime(\"%Y\u5e74%m\u6708%d\u65e5\"))\n        call setline(10,\"#\")\n        call setline(11,\"#================================================================\")\n        call setline(12, \"\")\n        call setline(13, \"\")\nendfunc\n\" \u5b9a\u4e49\u51fd\u6570SetTitle\uff0c\u81ea\u52a8\u63d2\u5165\u6587\u4ef6\u5934\nfunc SetTitle()\n       if &amp;filetype == 'sh'\n            call setline(1,\"#!/usr/bin/env bash\")\n            call setline(2,\"\")\n            call SetComment()\n        elseif &amp;filetype == 'python'\n            call setline(1,\"#!/usr/bin/env python3\")\n            call setline(2,\"#\")\n            call SetComment()\n        elseif &amp;filetype == 'c'\n            call SetComment_c()\n            call append(line(\".\")+10, \"#include &lt;stdio.h&gt;\")\n            call append(line(\".\")+11, \"\")\n        endif\nendfunc\n\" \u81ea\u52a8\u8df3\u5230\u6587\u4ef6\u672b\u5c3e\nautocmd BufNewFile * normal G\n</code></pre> <p>\u6548\u679c\uff1a</p> <pre><code>#!/usr/bin/env python3\n#\n#================================================================\n#   Copyright \u00a9 2019 Yuanzhi Gao. All rights reserved.\n#\n#   FileName \uff1atesss.py\n#   Author   \uff1aYuanzhi Gao\n#   Mail     \uff1agaopeng0214@126.com\n#   Date     \uff1a2019\u5e7403\u670816\u65e5  \n# \n#================================================================\n</code></pre>"},{"location":"linux/vim/#2_8","title":"2. \u7f29\u8fdb\u914d\u7f6e","text":"<pre><code>\" \u7f29\u8fdb\u8bbe\u7f6e\nset autoindent \" \u81ea\u52a8\u7f29\u8fdb\nset cindent \" c\u8bed\u8a00\u7f29\u8fdb\u98ce\u683c\nset tabstop=4 \" tab\u952e\u5bbd\u5ea6\n\" \u8bbe\u7f6e\u4f7f\u7528&lt;&lt; \u6216 &gt;&gt; \u65f6\u5de6\u53f3\u79fb\u52a8\u7684\u8ddd\u79bb\uff0c\u8bbe\u7f6e\u4e3a4\u4e2a\u7a7a\u683c\nset shiftwidth=4\n</code></pre>"},{"location":"linux/vim/#3_3","title":"3. \u8865\u9f50\u62ec\u53f7\u548c\u5f15\u53f7","text":"<pre><code>\" \u8865\u5168\u62ec\u53f7\uff0c\u5f15\u53f7\ninoremap ( ()&lt;ESC&gt;i\ninoremap [ []&lt;ESC&gt;i\ninoremap { {}&lt;ESC&gt;i\ninoremap &lt; &lt;&gt;&lt;ESC&gt;i\ninoremap ' ''&lt;ESC&gt;i\ninoremap \" \"\"&lt;ESC&gt;i\n</code></pre>"},{"location":"linux/vim/#4-80","title":"4. \u5728\u6bcf\u884c\u7b2c80\u4e2a\u5b57\u7b26\u5904\u663e\u793a\u7ad6\u7ebf, \u989c\u8272\u662f\u6de1\u84dd\u8272","text":"<pre><code>set  colorcolumn=80\nhi ColorColumn ctermbg=lightgreen\n</code></pre>"},{"location":"linux/vim/#5","title":"5. \u5176\u4ed6","text":"<pre><code>\" \u8bbe\u7f6e\u6807\u5c3a\uff08\u5149\u6807\u6240\u5728\u884c\u6709\u4e0b\u5212\u7ebf\u63d0\u793a\uff09\nset cursorline\n\" \u53ef\u7528\u9f20\u6807\nset mouse=a\n</code></pre>"},{"location":"linux/vim/#tmux","title":"\u5341\u516d\u3001tmux","text":""},{"location":"linux/vim/#1_9","title":"1. \u4f1a\u8bdd\u7ba1\u7406","text":""},{"location":"linux/vim/#1_10","title":"1. \u65b0\u5efa\u4f1a\u8bdd","text":"<pre><code>$ tmux new -s session-one -d\n# -s:\u6307\u5b9a\u56de\u8bdd\u540d\u79f0\n# -d:\u4f1a\u8bdd\u5728\u540e\u53f0\u8fd0\u884c\n</code></pre>"},{"location":"linux/vim/#2_9","title":"2. \u67e5\u770b\u6240\u6709\u4f1a\u8bdd","text":"<pre><code>$ tmux ls\nsession-one: 1 windows (created Mon Mar 25 21:11:28 2019) [80x23]\n</code></pre>"},{"location":"linux/vim/#3_4","title":"3. \u767b\u9646\u4f1a\u8bdd","text":"<pre><code>#\u767b\u9646\u4f1a\u8bdd\n$ tmux attach -t session-one\n</code></pre>"},{"location":"linux/vim/#4_1","title":"4. \u9000\u51fa\u4f1a\u8bdd","text":"<p><code>Ctrl-b + d</code></p>"},{"location":"linux/vim/#5_1","title":"5. \u9000\u51fa\u5e76\u5220\u9664\u4f1a\u8bdd","text":"<p><code>Ctrl - d</code></p>"},{"location":"linux/vim/#6","title":"6. \u5220\u9664\u4f1a\u8bdd","text":"<pre><code># \u5220\u9664\u4f1a\u8bdd\n$ tmux kill-session -t session-one\n</code></pre>"},{"location":"linux/vim/#7","title":"7. \u91cd\u547d\u540d\u4f1a\u8bdd","text":"<pre><code>$ tmux rename -t session-one session-test\n$ tmux ls\nsession-test: 1 windows (created Mon Mar 25 21:16:56 2019) [80x23]\n</code></pre> <p>tmux\u7684\u5feb\u6377\u952e\u4f7f\u7528\u65b9\u5f0f\uff1a \u5148\u6309prefix\u7ec4\u5408\u952e(\u9ed8\u8ba4\u662fCtrl-b\uff0c\u53ef\u4ee5\u81ea\u5b9a\u4e49)\uff0c\u7136\u540e\u518d\u6309\u5feb\u6377\u952e</p>"},{"location":"linux/vim/#2_10","title":"2. \u7cfb\u7edf\u64cd\u4f5c","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>?</code> \u5217\u51fa\u6240\u6709\u5feb\u6377\u952e\uff0c\u6309q\u8fd4\u56de <code>d</code> \u8131\u79bb\u5f53\u524d\u4f1a\u8bdd\uff0c\u6682\u65f6\u8fd4\u56deshell\u754c\u9762 <code>D</code> \u540c\u65f6\u5f00\u542f\u591a\u4e2a\u4f1a\u8bdd\u65f6\u9009\u62e9\u8981\u8131\u79bb\u7684\u4f1a\u8bdd <code>s</code> \u540c\u65f6\u5f00\u542f\u591a\u4e2a\u4f1a\u8bdd\u65f6\u5207\u6362\u4f1a\u8bdd <code>:</code> \u8fdb\u5165\u547d\u4ee4\u884c\u6a21\u5f0f\uff08\u6267\u884ctmux\u7684\u547d\u4ee4\uff0c\u4e0d\u662f\u7cfb\u7edf\u547d\u4ee4\uff09 <code>[</code> \u8fdb\u5165\u590d\u5236\u6a21\u5f0f"},{"location":"linux/vim/#3_5","title":"3. \u7a97\u53e3\u64cd\u4f5c","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>c</code> \u521b\u5efa\u65b0\u7a97\u53e3 <code>&amp;</code> \u5173\u95ed\u5f53\u524d\u7a97\u53e3 <code>0-9</code> \u8df3\u8f6c\u5230\u6307\u5b9a\u7a97\u53e3 <code>p</code> \u5207\u6362\u5230\u4e0a\u4e00\u4e2a\u7a97\u53e3 <code>n</code> \u5207\u6362\u5230\u4e0b\u4e00\u4e2a\u7a97\u53e3 <code>l</code> \u524d\u540e\u4e24\u4e2a\u7a97\u53e3\u76f4\u63a5\u5207\u6362 <code>w</code> \u901a\u8fc7\u7a97\u53e3\u5217\u8868\u5207\u6362\u7a97\u53e3 <code>,</code> \u91cd\u547d\u540d\u5f53\u524d\u7a97\u53e3 <code>.</code> \u4fee\u6539\u5f53\u524d\u7a97\u53e3\u7f16\u53f7 <code>f</code> \u5728\u6240\u6709\u7a97\u53e3\u4e2d\u67e5\u627e\u6307\u5b9a\u6587\u672c"},{"location":"linux/vim/#4_2","title":"4. \u9762\u677f\u64cd\u4f5c","text":"\u5feb\u6377\u952e \u8bf4\u660e <code>\"</code> \u4e0a\u4e0b\u5207\u5206\u9762\u677f <code>%</code> \u5de6\u53f3\u5207\u5206\u9762\u677f <code>x</code> \u5173\u95ed\u5f53\u524d\u9762\u677f <code>!</code> \u5728\u65b0\u7a97\u53e3\u4e2d\u6253\u5f00\u5f53\u524d\u9762\u677f <code>space</code> \u5faa\u73af\u5207\u6362\u9762\u677f\u5e03\u5c40 <code>q</code> \u663e\u793a\u9762\u677f\u7f16\u53f7 <code>o</code> \u5207\u6362\u5230\u4e0b\u4e00\u4e2a\u9762\u677f <code>{</code> \u5411\u524d\u7f6e\u6362\u5f53\u524d\u9762\u677f <code>}</code> \u5411\u540e\u7f6e\u6362\u5f53\u524d\u9762\u677f <code>ctrl+o</code> \u987a\u65f6\u9488\u65cb\u8f6c\u5f53\u524d\u9762\u677f <code>alt+o</code> \u9006\u65f6\u9488\u65cb\u8f6c\u5f53\u524d\u9762\u677f <code>alt+\u65b9\u5411\u952e</code> \u4ee55\u4e2a\u5355\u4f4d\u79fb\u52a8\u8fb9\u7f18\u4ee5\u8c03\u6574\u9762\u677f\u5927\u5c0f <code>ctrl+\u65b9\u5411\u952e</code> \u4ee51\u4e2a\u5355\u4f4d\u79fb\u52a8\u8fb9\u7f18\u4ee5\u8c03\u6574\u9762\u677f\u5927\u5c0f <code>\u65b9\u5411\u952e</code> \u79fb\u52a8\u5149\u6807\u4ee5\u9009\u62e9\u9762\u677f <code>z</code> \u6700\u5927\u5316/\u6062\u590d\u5f53\u524d\u9762\u677f"},{"location":"linux/vim/#5_2","title":"5. \u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u7684\u67e5\u627e\u987a\u5e8f\u4e3a/etc/tmux.conf,~/.tmux.conf\u3002\u8fd9\u4e24\u4e2a\u6587\u4ef6\u6ca1\u6709\u7684\u8bdd\u9700\u8981\u81ea\u5df1\u521b\u5efa</p> <pre><code># \u8bbe\u7f6e\u64cd\u4f5c\u6a21\u5f0f\u4e3avi\nset-window-option -g mode-keys vi\n# \u8bbe\u7f6e\u5b57\u7b26\u96c6\nset-window-option -g utf8 on\n# \u91cd\u65b0\u7ed1\u5b9a\u5feb\u6377\u952e\u8bbe\u7f6e\u4e3aCtrl-a\nset-option -g prefix C-a\nunbind-key C-b\nbind-key C-a send-prefix\n# \u7a97\u53e3\u5e8f\u53f7\u4ece1\u5f00\u59cb\u8ba1\u6570\nset -g base-index 1\n# \u4fee\u6539\u53f3\u4e0b\u89d2\u65f6\u95f4\u663e\u793a\u683c\u5f0f\nset -g status-right '[%Y-%m-%d %H:%M]'\n# \u8bbe\u7f6e\u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\u7684\u5feb\u6377\u952e\u4e3aprefix + r\nbind r source-file ~/.tmux.conf \\; display-message \"Config reloaded..\"\n</code></pre>"},{"location":"linux/vim/#6-tmux","title":"6. \u5728tmux\u4e2d\u7c98\u8d34\u590d\u5236","text":"<ul> <li>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6.tmux.conf</li> </ul> <pre><code>set-window-option -g mode-keys vi\nset-window-option -g utf8 on\n</code></pre> <ul> <li>\u91cd\u65b0\u767b\u9646shell(\u91cd\u8981)</li> <li>Ctrl-b + [ \u8fdb\u5165\u590d\u5236\u6a21\u5f0f</li> <li>space \u9009\u62e9</li> <li>Enter\u7ed3\u675f\u9009\u62e9</li> <li>Ctrl-b + ] \u7c98\u8d34</li> </ul>"},{"location":"linux/vim/#_13","title":"\u9644\uff1a","text":""},{"location":"linux/network/TCP/","title":"TCP/IP","text":"<p>TCP\u57fa\u7840\u77e5\u8bc6\u4e0eLinux\u5185\u6838\u53c2\u6570\u8c03\u4f18</p>"},{"location":"linux/network/TCP/#_1","title":"\u4e00\u3001\u6982\u5ff5","text":"<ol> <li>\u5904\u7406\u901a\u4fe1\u5dee\u9519\u7684\u65b9\u6cd5\uff1a     \u4f7f\u7528\u5dee\u9519\u6821\u6b63\u7801     \u91cd\u8bd5\u91cd\u65b0\u53d1\u9001\uff0c\u5373\u81ea\u52a8\u91cd\u590d\u8bf7\u6c42\uff08AutoARQ\uff09</li> <li>ACK(acknowledgment\uff0c\u786e\u8ba4\u53f7)\uff1a\u8be5\u786e\u8ba4\u53f7\u7684\u53d1\u9001\u65b9\u671f\u5f85\u63a5\u6536\u7684\u4e0b\u4e00\u4e2a\u5e8f\u5217\u53f7\uff0c\u5373\u6700\u540e\u88ab\u6210\u529f\u63a5\u6536\u7684\u6570\u636e\u5b57\u8282\u7684\u5e8f\u5217\u53f7+1</li> <li>seq(sequence number\uff0c\u5e8f\u5217\u53f7)\uff1a\u6807\u8bc6\u4e86TCP\u53d1\u9001\u7aef\u5230TCP\u63a5\u6536\u7aef\u7684\u6570\u636e\u6d41\u7684\u4e00\u4e2a\u5b57\u8282\uff0c\u8be5\u5b57\u8282\u4ee3\u8868\u8005\u8be5\u5e8f\u5217\u53f7\u62a5\u6587\u6bb5\u7684\u6570\u636e\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282</li> <li>TCP\uff1a\u9762\u5411\u8fde\u63a5\u7684\uff08\u4f7f\u7528TCP\u7684\u4e24\u4e2a\u5e94\u7528\u5fc5\u987b\u5728\u4ed6\u4eec\u4ea4\u6362\u6570\u636e\u4e4b\u524d\uff0c\u901a\u8fc7\u76f8\u4e92\u8054\u7cfb\u6765\u5efa\u7acb\u4e00\u4e2aTCP\u8fde\u63a5\uff09\u3001\u53ef\u9760\u7684\u5b57\u8282\u6d41\u670d\u52a1\u3002</li> <li>TCP\u8fde\u63a5\u662f\u53cc\u5411\u548c\u5bf9\u79f0\u7684\uff0c\u6570\u636e\u53ef\u4ee5\u5728\u4e24\u4e2a\u65b9\u5411\u4e0a\u5e73\u7b49\u7684\u6d41\u52a8</li> <li>socket\uff08\u5957\u63a5\u5b57\uff09\uff1a\u4e00\u4e2aIP\u5730\u5740\u548c\u4e00\u4e2a\u7aef\u53e3\u7684\u7ec4\u5408</li> <li>\u8fde\u63a5\u6807\u8bc6\uff1a4\u5143\u7ec4(\u5ba2\u6237\u7aefIP\u3001\u5ba2\u6237\u7aef\u7aef\u53e3\u3001\u670d\u52a1\u7aefIP\u3001\u670d\u52a1\u7aef\u7aef\u53e3)</li> </ol>"},{"location":"linux/network/TCP/#tcp","title":"\u4e8c\u3001TCP\u8fde\u63a5\u7684\u5efa\u7acb\u4e0e\u7ec8\u6b62","text":"<ol> <li>TCP\u8fde\u63a5\u7684\u6784\u6210\uff1a\u5ba2\u6237\u7aefIP\u3001\u5ba2\u6237\u7aef\u7aef\u53e3\u3001\u670d\u52a1\u7aefIP\u3001\u670d\u52a1\u7aef\u7aef\u53e3</li> <li>TCP\u8fde\u63a5\u76843\u4e2a\u9636\u6bb5\uff1a\u542f\u52a8\u3001\u6570\u636e\u4f20\u8f93\u3001\u9000\u51fa(\u5173\u95ed)</li> <li>ISN(Initail Sequence Number\uff0c\u521d\u59cb\u5e8f\u5217\u53f7)\uff1a\u5728\u53d1\u9001\u7528\u4e8e\u5efa\u7acb\u8fde\u63a5\u7684SYN\u4e4b\u524d\uff0c\u901a\u4fe1\u53cc\u65b9\u4f1a\u9009\u62e9\u4e00\u4e2a\u521d\u59cb\u5e8f\u5217\u53f7\uff0c\u5e8f\u5217\u53f7\u4f1a\u968f\u7740\u65f6\u95f4\u800c\u6539\u53d8\uff0c\u56e0\u6b64\u6bcf\u4e00\u4e2a\u8fde\u63a5\u62e5\u6709\u4e0d\u540c\u7684\u521d\u59cb\u5e8f\u5217\u53f7\uff0c[RFC0793]\u6307\u51fa\u521d\u59cb\u5e8f\u5217\u53f7\u662f\u4e00\u4e2a32\u4f4d\u7684\u8ba1\u6570\u5668\uff0c\u8be5\u8ba1\u6570\u5668\u7684\u503c\u6bcf4\u6beb\u79d2+1\u3002Linux\u662f\u91c7\u7528\u57fa\u4e8e\u65f6\u949f\u7684\u65b9\u6848\uff0c\u5e76\u4e14\u9488\u5bf9\u6bcf\u4e00\u4e2a\u8fde\u63a5\u4e3a\u65f6\u949f\u8bbe\u7f6e\u968f\u673a\u7684\u504f\u79fb\u91cf\uff0c\u968f\u673a\u504f\u79fb\u91cf\u662f\u5728\u8fde\u63a5\u6807\u8bc6\u7684\u57fa\u7840\u4e0a\u5229\u7528\u52a0\u5bc6\u6563\u5217\u51fd\u6570\u5f97\u5230\u7684\uff0c\u6563\u5217\u51fd\u6570\u7684\u8f93\u5165\u6bcf\u96945\u5206\u949f\u5c31\u4f1a\u66f4\u6539\u4e00\u6b21\u3002\u751f\u4ea7\u7684\u5e8f\u5217\u53f7\u968f\u7740\u65f6\u95f4\u7684\u589e\u52a0\u800c\u589e\u52a0\u3002</li> </ol>"},{"location":"linux/network/TCP/#1","title":"1. \u4e09\u6b21\u63e1\u624b","text":"<ol> <li>\u5ba2\u6237\u7aef\u53d1\u9001\u4e00\u4e2aSYN\u62a5\u6587\u6bb5\uff0c\u5e76\u6307\u660e\u81ea\u5df1\u60f3\u8981\u8fde\u63a5\u7684\u7aef\u53e3\u53f7\u548c\u5ba2\u6237\u7aef\u521d\u59cb\u5e8f\u5217\u53f7(ISN(c))</li> <li>\u670d\u52a1\u5668\u4e5f\u53d1\u9001\u81ea\u5df1\u7684SYN\u62a5\u6587\u6bb5\u4f5c\u4e3a\u54cd\u5e94\uff0c\u5e76\u5305\u542b\u4e86\u5b83\u7684\u521d\u59cb\u5e8f\u5217\u53f7(ISN(s))\uff0c\u6b64\u5916\uff0c\u4e3a\u4e86\u786e\u8ba4\u5ba2\u6237\u7aef\u7684SYN\uff0c\u670d\u52a1\u7aef\u5c06\u5176\u5305\u542b\u7684ISN(c)\u6570\u503c+1\u540e\u4f5c\u4e3a\u8fd4\u56de\u7684ACK\u6570\u503c</li> <li>\u4e3a\u4e86\u786e\u8ba4\u670d\u52a1\u5668\u7684SYN\uff0c\u5ba2\u6237\u7aef\u5c06ISN(s)\u7684\u6570\u503c+1\u540e\u4f5c\u4e3a\u8fd4\u56de\u7684ACK\u6570\u503c</li> </ol>"},{"location":"linux/network/TCP/#2","title":"2. \u6570\u636e\u4f20\u8f93","text":"<p>\u4ea4\u4e92\u6570\u636e\u6d41-\u4ee5ssh\u4e3a\u4f8b</p> <p></p>"},{"location":"linux/network/TCP/#3","title":"3.\u56db\u6b21\u6325\u624b","text":"<ol> <li>\u8fde\u63a5\u7684\u4e3b\u52a8\u5173\u95ed\u8005\u53d1\u9001\u4e00\u4e2aFIN\u6bb5\u6307\u660e\u63a5\u6536\u8005\u5e0c\u671b\u770b\u5230\u7684\u81ea\u5df1\u5f53\u524d\u7684\u5e8f\u5217\u53f7(K)\uff0cFIN\u8fd8\u5305\u542b\u4e86\u4e00\u4e2aACK\u6bb5\u7528\u4e8e\u786e\u8ba4\u5bf9\u65b9\u6700\u540e\u4e00\u6b21\u53d1\u6765\u7684\u6570\u636e(L)</li> <li>\u8fde\u63a5\u7684\u88ab\u52a8\u5173\u95ed\u8005\u5c06K\u7684\u6570\u503c+1,\u6700\u4e3a\u54cd\u5e94\u7684ACK\uff0c\u4ee5\u8868\u9762\u5b83\u5df2\u7ecf\u6210\u529f\u63a5\u6536\u5230\u4e3b\u52a8\u5173\u95ed\u8005\u53d1\u9001\u7684FIN\u3002\u6b64\u65f6\u4e0a\u5c42\u5e94\u7528\u7a0b\u5e8f\u4f1a\u88ab\u544a\u77e5\u8fde\u63a5\u7684\u53e6\u4e00\u7aef\u5df2\u7ecf\u63d0\u51fa\u4e86\u5173\u95ed\u8fde\u63a5\u989d\u8bf7\u6c42\uff0c\u7136\u540e\u5e94\u7528\u7a0b\u5e8f\u53d1\u8d77\u81ea\u5df1\u7684\u5173\u95ed\u64cd\u4f5c\u3002\u63a5\u7740\u88ab\u52a8\u5173\u95ed\u8005\u5c06\u8eab\u4efd\u8f6c\u53d8\u4e3a\u4e3b\u52a8\u5173\u95ed\u8fd9\uff0c\u5e76\u53d1\u9001\u81ea\u5df1\u7684FIN\uff0c\u8be5\u62a5\u6587\u6bb5\u7684\u5e8f\u5217\u53f7\u4e3aL</li> <li>\u4e3a\u4e86\u5b8c\u6210\u8fde\u63a5\u7684\u5173\u95ed\uff0c\u6700\u540e\u53d1\u9001\u7684\u62a5\u6587\u8fd8\u5e94\u5305\u542b\u4e00\u4e2aACK\u7528\u4e8e\u786e\u8ba4\u4e0a\u4e00\u4e2aFIN\u3002\u5982\u679cFIN\u4e22\u5931\u7684\uff0c\u90a3\u4e48\u53d1\u9001\u65b9\u6781\u7231\u90a3\u4e2a\u91cd\u65b0\u4f20\u8f93\u76f4\u5230\u63a5\u6536\u4e00\u4e2aACK\u786e\u8ba4\u4e3a\u6b62\u3002</li> </ol> <p>\u6ce8\u610f\uff1a\u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u8d1f\u8d23\u53d1\u8d77\u5173\u95ed\u8fde\u63a5\u7684\u901a\u5e38\u662f\u5ba2\u6237\u7aef\uff0c\u4f46\u662f\u5728\u4e00\u4e9b\u670d\u52a1\u5668(Web\u670d\u52a1\u5668)\u5728\u5bf9\u8bf7\u6c42\u505a\u51fa\u54cd\u5e94\u4e4b\u540e\u4e5f\u4f1a\u53d1\u8d77\u4e00\u4e2a\u5173\u95ed\u64cd\u4f5c\u3002</p> <p>\u5b9e\u4f8b\uff1a <pre><code>$ curl http://192.168.1.60\nhello\n</code></pre></p> <p>tcp\u6293\u5305\u5206\u6790 <pre><code>[root@localhost ~]# tcpdump -i enp0s3 tcp port 80 -S\ntcpdump: verbose output suppressed, use -v or -vv for full protocol decode\nlistening on enp0s3, link-type EN10MB (Ethernet), capture size 262144 bytes\n# \u4e09\u6b21\u63e1\u624b\u7b2c\u4e00\u6b65\uff1a\u5ba2\u6237\u7aef\u53d1\u8d77\u8bf7\u6c42\uff0c\u5e8f\u5217\u53f7\u4e3a129238614\n11:33:44.910398 IP 192.168.1.41.54890 &gt; 192.168.1.60.http: Flags [S], seq 129238614, win 29200, options [mss 1460,sackOK,TS val 2499218799 ecr 0,nop,wscale 7], length 0\n# \u4e09\u6b21\u63e1\u624b\u7b2c\u4e8c\u6b65\uff1a\u670d\u52a1\u7aef\u786e\u8ba4\uff0c\u786e\u8ba4\u53f7\u4e3a129238615\uff0c\u540c\u65f6\u53d1\u9001\u7684\u5e8f\u5217\u53f7\u4e3a2856829331\n11:33:44.910433 IP 192.168.1.60.http &gt; 192.168.1.41.54890: Flags [S.], seq 2856829331, ack 129238615, win 28960, options [mss 1460,sackOK,TS val 4721674 ecr 2499218799,nop,wscale 7], length 0\n#\u3000\u4e09\u6b21\u63e1\u624b\u7b2c\u4e09\u6b65\uff1a\u5ba2\u6237\u7aef\u786e\u8ba4\uff0c\u786e\u8ba4\u53f7\u4e3a2856829332\n11:33:44.910530 IP 192.168.1.41.54890 &gt; 192.168.1.60.http: Flags [.], ack 2856829332, win 229, options [nop,nop,TS val 2499218799 ecr 4721674], length 0\n--------------------------------------\u6570\u636e\u4f20\u8f93----------------------------------------\n# \u5ba2\u6237\u7aef\u53d1\u8d77\u8bf7\u6c42\uff0c\u8bf7\u6c42\u7684\u5e8f\u53f7\u4e3a129238615:129238691\uff0c\u517176\u5b57\u8282\uff0c\u4f7f\u7528\u7684\u662fHTTP\u7684GET\u65b9\u6cd5\n11:33:44.910542 IP 192.168.1.41.54890 &gt; 192.168.1.60.http: Flags [P.], seq 129238615:129238691, ack 2856829332, win 229, options [nop,nop,TS val 2499218799 ecr 4721674], length 76: HTTP: GET / HTTP/1.1\n# \u670d\u52a1\u5668\u6536\u5230\u8bf7\u6c42\u540e\u53d1\u9001\u4e00\u4e2a\u786e\u8ba4\u5e27\n11:33:44.910559 IP 192.168.1.60.http &gt; 192.168.1.41.54890: Flags [.], ack 129238691, win 227, options [nop,nop,TS val 4721674 ecr 2499218799], length 0\n# \u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u4f20\u8f93\u6570\u636e\n11:33:44.910695 IP 192.168.1.60.http &gt; 192.168.1.41.54890: Flags [P.], seq 2856829332:2856829572, ack 129238691, win 227, options [nop,nop,TS val 4721674 ecr 2499218799], length 240: HTTP: HTTP/1.1 200 OK\n# \u5ba2\u6237\u7aef\u6536\u5230\u6570\u636e\u540e\u5411\u670d\u52a1\u7aef\u786e\u8ba4\n11:33:44.910766 IP 192.168.1.41.54890 &gt; 192.168.1.60.http: Flags [.], ack 2856829572, win 237, options [nop,nop,TS val 2499218799 ecr 4721674], length 0\n--------------------------------------\u6570\u636e\u4f20\u8f93----------------------------------------\n# \u5ba2\u6237\u7aef\u53d1\u8d77\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\uff0c\u53d1\u9001FIN\uff0c\u5e8f\u5217\u53f7\u4e3a129238691\uff0c\u786e\u8ba4\u53f7\u4e3a2856829572\uff0c\u4e3a\u6700\u540e\u4e00\u6b21\u53d1\u6765\u7684\u6570\u636e\n11:33:44.910814 IP 192.168.1.41.54890 &gt; 192.168.1.60.http: Flags [F.], seq 129238691, ack 2856829572, win 237, options [nop,nop,TS val 2499218799 ecr 4721674], length 0\n# \u670d\u52a1\u7aef\u786e\u8ba4(ACK)\u4e86\u5ba2\u6237\u7aef\u7684\u5e8f\u5217\u53f7129238691+1=129238692\uff0c\u540c\u65f6\u53d1\u9001FIN\uff0c\u540c\u65f6\u53d1\u9001\u5e8f\u5217\u53f72856829572\n11:33:44.918483 IP 192.168.1.60.http &gt; 192.168.1.41.54890: Flags [F.], seq 2856829572, ack 129238692, win 227, options [nop,nop,TS val 4721676 ecr 2499218799], length 0\n# \u5ba2\u6237\u7aef\u56de\u590d\u786e\u8ba4\uff0c\u786e\u8ba4\u53f7\u4e3a\u670d\u52a1\u7aef\u7684\u5e8f\u5217\u53f72856829572+1=2856829573\n11:33:44.918565 IP 192.168.1.41.54890 &gt; 192.168.1.60.http: Flags [.], ack 2856829573, win 237, options [nop,nop,TS val 2499218801 ecr 4721676], length 0\n</code></pre></p> <p>\u95ee\u9898\uff1a \u4e3a\u4ec0\u4e48<code>tcpdump</code>\u5728\u56db\u6b21\u6325\u624b\u4e2d\u53ea\u6293\u5230\u4e09\u4e2a\u6b65\u9aa4\uff1f</p> <p>\u8fd9\u91cc\u6d89\u53ca\u5230TCP\u7684\u5ef6\u65f6\u786e\u8ba4\uff0c\u5728\u8bb8\u591a\u60c5\u51b5\u4e0b\uff0cTCP\u5e76\u4e0d\u5bf9\u6bcf\u4e2a\u5230\u6765\u7684\u6570\u636e\u5305\u90fd\u8fd4\u56de<code>ACK</code>\uff0c\u5229\u7528TCP\u7684\u7d2f\u8ba1<code>ACK</code>\u5b57\u6bb5\u5c31\u80fd\u5b9e\u73b0\u8be5\u529f\u80fd\uff0c\u7d2f\u79ef\u786e\u8ba4\u5141\u8bb8TCP\u5ef6\u65f6\u4e00\u6bb5\u65f6\u95f4\u53d1\u9001<code>ACK</code>\uff0c\u4ee5\u4fbf\u5c06<code>ACK</code>\u548c\u76f8\u540c\u65b9\u5411\u65b9\u5411\u4e0a\u9700\u8981\u4f20\u7684\u6570\u636e\u7ed3\u5408\u53d1\u9001\u3002 \u5728\u5b9e\u9a8c\u4e2d\u4f7f\u7528curl\u547d\u4ee4\u65f6\u56db\u6b21\u6325\u624b\u8fc7\u7a0b\u53ea\u80fd\u6293\u5230\u4e09\u4e2a\uff0c\u4f7f\u7528\u6d4f\u89c8\u5668\u7684\u60c5\u51b5\u4e0b\uff0c\u65ad\u5f00\u8fde\u63a5\u7531\u670d\u52a1\u5668\u7aef\u53d1\u8d77\uff0c\u6293\u5230\u56db\u6b21\u6325\u624b\u7684\u5168\u8fc7\u7a0b\uff0c\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code># 1. \u670d\u52a1\u7aef\u53d1\u8d77\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\n12:04:58.068808 IP 192.168.1.60.http &gt; 192.168.1.41.56736: Flags [F.], seq 79265592, ack 2919233145, win 235, options [nop,nop,TS val 6594833 ecr 2499670825], length 0\n# 2. \u5ba2\u6237\u7aef\u786e\u8ba4\u6536\u5230\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\n12:04:58.115367 IP 192.168.1.41.56736 &gt; 192.168.1.60.http: Flags [.], ack 79265593, win 237, options [nop,nop,TS val 2499687101 ecr 6594833], length 0\n# 3.  \u5ba2\u6237\u7aef\u53d1\u8d77\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\n12:04:58.123188 IP 192.168.1.41.56736 &gt; 192.168.1.60.http: Flags [F.], seq 2919233145, ack 79265593, win 237, options [nop,nop,TS val 2499687102 ecr 6594833], length 0\n# 4. \u670d\u52a1\u7aef\u786e\u8ba4\u6536\u5230\u65ad\u5f00\u8fde\u63a5\u7684\u8bf7\u6c42\uff0cTCP\u8fde\u63a5\u65ad\u5f00\n12:04:58.123239 IP 192.168.1.60.http &gt; 192.168.1.41.56736: Flags [.], ack 2919233146, win 235, options [nop,nop,TS val 6594887 ecr 2499687102], length 0\n</code></pre> <p>flags\u542b\u4e49\uff1a \u6807\u8bc6|\u7f29\u5199|\u63cf\u8ff0 :-:|:-:|:-- S|SYN|\u540c\u6b65\u5e8f\u53f7 F|FIN|\u53d1\u9001\u65b9\u5b8c\u6210\u6570\u636e\u4f20\u9001 R|RST|\u590d\u4f4d\u8fde\u63a5 P|PSH|\u5c3d\u53ef\u80fd\u5feb\u7684\u5c06\u6570\u636e\u53d1\u9001\u5f80\u63a5\u6536\u8fdb\u7a0b .||\u4ee5\u4e0a\u56db\u4e2a\u6807\u8bc6\u6bd4\u7279\u5747\u7f6e0</p> <p></p>"},{"location":"linux/network/TCP/#linux","title":"Linux\u5bf9\u4e8e\u8fde\u63a5\u7684\u5904\u7406\uff1a","text":"<ol> <li>\u5f53\u4e00\u4e2a\u8bf7\u6c42\u5230\u8fbe(\u5373SYN\u62a5\u6587\u6bb5)\uff0c\u5c06\u4f1a\u68c0\u67e5\u7cfb\u7edf\u53c2\u6570<code>net.ipv4.tcp_max_syn_backlog = 512</code>\uff0c\u5982\u679c\u5904\u4e8e<code>SYN_RCVD</code>\u72b6\u6001\u7684\u8fde\u63a5\u6570\u76ee\u8d85\u8fc7\u8fd9\u4e00\u9600\u503c\uff0c\u8fdb\u5165\u7684\u8fde\u63a5\u5c06\u4f1a\u88ab\u62d2\u7edd\u3002</li> <li>\u5904\u4e8e\u76d1\u542c\u72b6\u6001\u4e0b\u7684\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u56fa\u5b9a\u957f\u5ea6\u7684\u8fde\u63a5\u5217\u961f\u3002\u5982\u679c\u8fde\u63a5\u5df2\u7ecf\u88abTCP\u63a5\u53d7(\u5b8c\u6210\u4e09\u6b21\u63e1\u624b)\uff0c\u4f46\u672a\u88ab\u7a0b\u5e8f\u63a5\u53d7\uff0c\u5e94\u7528\u7a0b\u5e8f\u4f1a\u5bf9\u8fd9\u4e00\u5217\u961f\u505a\u51fa\u9650\u5236\uff0c\u901a\u5e38\u79f0\u4e3a\u672a\u5b8c\u6210\u8fde\u63a5(backlog)\u3002Linux\u9ed8\u8ba4\u503c\u4e3a\uff1a<code>net.core.somaxconn = 128</code></li> </ol> <p>\u51e0\u79cd\u8fde\u63a5\u72b6\u6001(<code>man netstat</code>)\uff1a</p> \u72b6\u6001 \u542b\u4e49 ESTABLISHED The socket has an established connection. SYN_SENT The socket is actively attempting to establish a connection. SYN_RECV A connection request has been received from the network. FIN_WAIT1 The socket is closed, and the connection is shutting down. FIN_WAIT2 Connection is closed, and the socket is waiting for a shutdown from the remote end. TIME_WAIT The socket is waiting after close to handle packets still in the network. CLOSE The socket is not being used. CLOSE_WAIT The remote end has shut down, waiting for the socket to close. LAST_ACK The remote end has shut down, and the socket is closed. Waiting for acknowledgement. LISTEN The  socket  is  listening  for  incoming  connections.   Such sockets are not included in the output unless you specify the --listening (-l) or --all (-a) option. CLOSING Both sockets are shut down but we still don't have all our data sent. <p>\u66f4\u591a\u89e3\u91ca IBM \u77e5\u8bc6\u5e93tcp\u72b6\u6001 \u7ef4\u57fa\u767e\u79d1 rfc793</p> <p>TIME_WAIT(2MSL,Maximum Segment Lifetime)\uff1a\u7b49\u5f85\u4e24\u500d\u4e0e\u6700\u5927\u6bb5\u5b58\u8d27\u5176\u7684\u65f6\u95f4\uff0c\u53c8\u79f0\u52a0\u500d\u7b49\u5f85\u3002\u5728Linux\u7cfb\u7edf\u4e2dnet.ipv4.tcp_fin_timeout\u7684\u6570\u503c\u8bb0\u5f55\u4e862MSL\u72b6\u6001\u9700\u8981\u7b49\u5f85\u7684\u8d85\u65f6\u65f6\u95f4\uff08net.ipv4.tcp_fin_timeout = 60\uff09\u3002\u5728\u53d1\u9001\u6700\u540e\u4e00\u4e2aACK\u4e4b\u524d\u5fc5\u987b\u7b49\u5f8560\u79d2\uff0c\u5728\u6b64\u671f\u95f4Server\u7aef\u4f1a\u91cd\u4f20\u5b83\u7684FIN(\u6d88\u8017\u4e00\u4e2a\u5e8f\u5217\u53f7)\u4e4b\u540e\u6536\u5230\u6700\u7ec8\u7684ACK\u3002</p>"},{"location":"linux/network/TCP/#tcp_1","title":"TCP\uff1a\u653b\u51fb","text":"<p>SYN\u6cdb\u6d2a\uff1aTCP\u62d2\u7edd\u670d\u52a1\u653b\u51fb\u3002\u653b\u51fb\u8005\u7528\u4e00\u4e2a\u6216\u591a\u4e2a\u5ba2\u6237\u7aef\u4f2a\u9020\u968f\u673a\u6e90IP\u5730\u5740\uff0c\u4ea7\u751f\u4e00\u7cfb\u5217TCP\u8fde\u63a5\u5c1d\u8bd5(SYN\u62a5\u6587\u6bb5)\u5e76\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u670d\u52a1\u5668\u4e3a\u6bcf\u4e00\u6761\u8fde\u63a5\u5206\u914d\u4e00\u5b9a\u6570\u91cf\u7684\u8fde\u63a5\u8d44\u6e90\uff0c\u7531\u4e8e\u8fde\u63a5\u5c1a\u672a\u5b8c\u5168\u5efa\u7acb\uff0c\u670d\u52a1\u5668\u4e3a\u4e86\u7ef4\u62a4\u5927\u91cf\u7684\u534a\u6253\u5f00\u8fde\u63a5\u4f1a\u5728\u8017\u5c3d\u81ea\u8eab\u5185\u5b58\u540e\u62d2\u7edd\u4e3a\u540e\u7eed\u5408\u6cd5\u7684\u8fde\u63a5\u8bf7\u6c42\u670d\u52a1\u3002 Linux\u670d\u52a1\u5668\u5728\u63a5\u6536\u5230SYN\u540e\u624d\u91c7\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u8bbe\u7f6e\u6811\u6c60\u5b66\u5217\u597d</p>"},{"location":"linux/network/TCP/#linux_1","title":"\u4e09\u3001Linux\u5185\u6838\u53c2\u6570\u4f18\u5316","text":"\u53c2\u6570 \u63cf\u8ff0 \u9ed8\u8ba4\u503c \u4f18\u5316\u503c net.ipv4.tcp_max_syn_backlog TCP\u4e09\u6b21\u63e1\u624b\u65f6\uff0c\u670d\u52a1\u5668\u6ca1\u6709\u6536\u5230\u5ba2\u6237\u7aef\u786e\u8ba4\u8bf7\u6c42\u7684\u8fde\u63a5\u6570\u91cf(\u5373SYN_RCVD\u72b6\u6001\u7684\u8fde\u63a5\u6570\u91cf)\uff0c\u5bf9\u4e8e\u5185un\u8f83\u5c0f\u7684\u673a\u5668\u6700\u5c0f\u503c\u662f128\uff0c\u5982\u679c\u673a\u5668\u8d1f\u8f7d\u8fc7\u9ad8\u53ef\u4ee5\u8c03\u9ad8 512 \u4f18\u5316\u503c net.ipv4.tcp_synack_retries \u4e3a\u4e86\u6253\u5f00\u5bf9\u7aef\u7684\u8fde\u63a5\uff0c\u5185\u6838\u9700\u8981\u53d1\u9001\u4e00\u4e2aSYN \u5e76\u9644\u5e26\u4e00\u4e2a\u56de\u5e94\u524d\u9762\u4e00\u4e2aSYN\u7684ACK\u3002\u4e5f\u5c31\u662f\u6240\u8c13\u4e09\u6b21\u63e1\u624b\u4e2d\u7684\u7b2c\u4e8c\u6b21\u63e1\u624b\u3002\u8fd9\u4e2a\u8bbe\u7f6e\u51b3\u5b9a\u4e86\u5185\u6838\u653e\u5f03\u8fde\u63a5\u4e4b\u524d\u53d1\u9001SYN+ACK\u5305\u7684\u6570\u91cf\u3002 5 3 net.ipv4.tcp_syncookies \u9632\u6b62SYN Flood\u653b\u51fb 1 1 net.ipv4.tcp_keepalive_intvl \u63a2\u6d4b\u6d88\u606f\u672a\u83b7\u5f97\u54cd\u5e94\u65f6\uff0c\u91cd\u53d1\u8be5\u6d88\u606f\u7684\u95f4\u9694\u65f6\u95f4\uff08\u79d2\uff09 75 30 net.ipv4.tcp_keepalive_probes \u5728\u8ba4\u5b9aTCP\u8fde\u63a5\u5931\u6548\u4e4b\u524d\uff0c\u6700\u591a\u53d1\u9001\u591a\u5c11\u4e2akeepalive\u63a2\u6d4b\u6d88\u606f 9 3 net.ipv4.tcp_keepalive_time TCP\u53d1\u9001keepalive\u63a2\u6d4b\u6d88\u606f\u7684\u95f4\u9694\u65f6\u95f4\uff08\u79d2\uff09\uff0c\u7528\u4e8e\u786e\u8ba4TCP\u8fde\u63a5\u662f\u5426\u6709\u6548\u3002 7200 1800 net.ipv4.tcp_tw_reuse \u8868\u793a\u662f\u5426\u5141\u8bb8\u5c06\u5904\u4e8eTIME-WAIT\u72b6\u6001\u7684socket\uff08TIME-WAIT\u7684\u7aef\u53e3\uff09\u7528\u4e8e\u65b0\u7684TCP\u8fde\u63a5 \u3002 0 1 net.ipv4.tcp_tw_recycle \u66f4\u5feb\u5730\u56de\u6536TIME-WAIT\u5957\u63a5\u5b57\uff0c\u4e0d\u5efa\u8bae\u6539\uff0ckernel4.12\u4ee5\u540e\u88ab\u53bb\u9664 0 0 net.ipv4.tcp_max_tw_buckets \u7cfb\u7edf\u540c\u65f6\u4fdd\u7559\u7684\u6700\u5927\u65f6\u95f4\u7b49\u5f85\u5957\u63a5\u5b57\u6570\u3002 \u5982\u679c\u8d85\u8fc7\u6b64\u6570\u91cf\uff0c\u5219\u4f1a\u7acb\u5373\u9500\u6bc1\u7b49\u5f85\u5957\u63a5\u5b57\u5e76\u6253\u5370\u8b66\u544a\u3002\u8fd9\u4e2a\u503c\u4e0d\u5efa\u8bae\u8c03\u4f4e\uff0c\u5982\u679c\u51fa\u73b0\u5f02\u5e38\u9700\u8981\u589e\u5927\u8fd9\u4e2a\u503c\u3002\u5e76\u6269\u5927\u5185\u5b58\u3002 65536 65536 net.core.somaxconn \u5904\u4e8e\u76d1\u542c\u72b6\u6001\u4e0b\u7684\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u56fa\u5b9a\u957f\u5ea6\u7684\u8fde\u63a5\u5217\u961f\u3002\u5982\u679c\u8fde\u63a5\u5df2\u7ecf\u88abTCP\u63a5\u53d7(\u5b8c\u6210\u4e09\u6b21\u63e1\u624b)\uff0c\u4f46\u672a\u88ab\u7a0b\u5e8f\u63a5\u53d7\uff0c\u5e94\u7528\u7a0b\u5e8f\u4f1a\u5bf9\u8fd9\u4e00\u5217\u961f\u505a\u51fa\u9650\u5236\uff0c\u901a\u5e38\u79f0\u4e3a\u672a\u5b8c\u6210\u8fde\u63a5\u3002 128 1024 <p>\u6ce8\u610f\uff1a\u8c03\u6574\u5185\u6838\u53c2\u6570\u540e\u5185\u6838\u5904\u4e8e\u4e0d\u7a33\u5b9a\u72b6\u6001\uff0c\u8bf7\u52a1\u5fc5\u91cd\u542f\u5b9e\u4f8b\u3002</p> <p>\u66f4\u591a\u5185\u5bb9\u540e\u671f\u8865\u5145...</p>"},{"location":"linux/network/iptables/","title":"iptables","text":""},{"location":"linux/network/iptables/#iptables_1","title":"\u4e00\u3001iptables\u6982\u8ff0","text":""},{"location":"linux/network/iptables/#1netfilteriptables","title":"1.Netfilter/iptables","text":"<ol> <li>Netfilter\u662f\u5185\u6838\u7684\u4e00\u90e8\u5206\uff0c\u7531\u4e00\u4e9b\u4fe1\u606f\u5305\u8fc7\u6ee4\u8868\u7ec4\u6210\uff0c\u8fd9\u4e9b\u8868\u5305\u542b\u5185\u6838\u7528\u6765\u63a7\u5236\u4fe1\u606f\u5305\u8fc7\u6ee4\u5904\u7406\u7684\u89c4\u5219\u96c6\u3002</li> <li>iptables\u662f\u7528\u6237\u7ba1\u7406Netfilter\u9632\u706b\u5899\u7684\u7528\u6237\u7a0b\u5e8f\u3002</li> </ol>"},{"location":"linux/network/iptables/#2iptables","title":"2.iptables\u7684\u7ec4\u6210","text":""},{"location":"linux/network/iptables/#1","title":"1. \u8868","text":"<ol> <li>raw \u4ec5\u7528\u4e8e\u914d\u7f6e\u6570\u636e\u5305\uff0c\u5904\u7406\u5f02\u5e38</li> <li>filter \u662f\u9ed8\u8ba4\u8868\uff0c\u8d1f\u8d23\u8fc7\u6ee4\u6570\u636e\u5305\uff0c\u51b3\u5b9a\u662f\u5426\u5141\u8bb8\u6570\u636e\u5305\u5230\u8fbe\u76ee\u7684\u5730</li> <li>nat\u7528\u4e8e\u7f51\u7edc\u5730\u5740\u8f6c\u6362\uff08\u4f8b\u5982\u7aef\u53e3\u8f6c\u53d1\uff09</li> <li>mangle \u7528\u4e8e\u4fee\u6539\u6570\u636e\u5305\u5185\u5bb9\uff0c\u7528\u6765\u505a\u6d41\u91cf\u6574\u5f62\uff08\u7ed9\u6570\u636e\u5305\u6253\u6807\u8bc6\u7b49\uff09</li> <li>security\u7528\u4e8e\u5f3a\u5236\u8bbf\u95ee\u63a7\u5236\u7f51\u7edc\u89c4\u5219\uff08\u4f8b\u5982SELinux\uff09</li> </ol> <p>\u8868\u95f4\u7684\u4f18\u5148\u987a\u5e8f\uff1araw&gt;mangle&gt;nat&gt;filter</p>"},{"location":"linux/network/iptables/#2","title":"2. \u94fe","text":"<p>\u8868\u662f\u7531\u51e0\u4e2a\u9ed8\u8ba4\u94fe\u7ec4\u6210\u7684\u3002</p> <ol> <li>PREROUTING\uff1a\u7528\u6765\u4fee\u6539\u76ee\u7684\u5730\u5740\uff0c\u7528\u6765\u7528DNAT\u3002\u5b58\u5728\u4e8eraw,mangle,nat</li> <li>INPUT\uff1a\u5339\u914d\u76ee\u6807IP\u662f\u672c\u673a\u7684\u6570\u636e\u5305\u3002\u5b58\u5728\u4e8emangle,filter,nat</li> <li>OUTPUT\uff1a\u51fa\u53e3\u6570\u636e\u5305\uff0c\u4e00\u822c\u4e0d\u5728\u6b64\u94fe\u4e0a\u505a\u914d\u7f6e\u3002\u5b58\u5728\u4e8emangle,filter</li> <li>FORWARD:\uff1a\u5339\u914d\u6d41\u7ecf\u672c\u673a\u7684\u6570\u636e\u5305\u3002\u5b58\u5728\u4e8eraw,mangle,nat,filter</li> <li>POSTROUTING \uff1a\u7528\u6765\u4fee\u6539\u6e90\u5730\u5740\uff0c\u7528\u6765\u505aSNAT\u3002\u5b58\u5728\u4e8emangle\uff0cnat</li> <li>\u81ea\u5b9a\u4e49\u94fe</li> </ol> <p></p>"},{"location":"linux/network/iptables/#3","title":"3. \u89c4\u5219","text":"<p>\u5305\u7684\u8fc7\u6ee4\u662f\u57fa\u4e8e\u89c4\u5219\u7684\u3002\u89c4\u5219\u7531\u6761\u4ef6\u548ctarget\u7ec4\u6210\u3002\u5f88\u636e\u5339\u914d\u6761\u4ef6\u6765\u5339\u914d\u6bcf\u4e00\u4e2a\u6d41\u7ecf\u6b64\u5904\u7684\u62a5\u6587\uff0c\u4e00\u65e6\u5339\u914d\u6210\u529f\u5219\u4ea4\u7ed9\u540e\u9762\u7684target\u8fdb\u884c\u5904\u7406\u3002</p>"},{"location":"linux/network/iptables/#1_1","title":"1. \u6761\u4ef6","text":"<p>\u5305\u7684\u6765\u6e90\u3001\u7c7b\u578b(ICMP\u3001TCP\u3001UDP)\u3001\u76ee\u6807\u7aef\u53e3</p>"},{"location":"linux/network/iptables/#2_1","title":"2. \u52a8\u4f5c","text":""},{"location":"linux/network/iptables/#1-target","title":"1. \u5185\u5efatarget","text":"<ul> <li>ACCEPT  \u5141\u8bb8\u6570\u636e\u5305\u901a\u8fc7 </li> <li>DROP  \u76f4\u63a5\u4e22\u5f03\u6570\u636e\u5305\uff0c\u4e0d\u7ed9\u4efb\u4f55\u56de\u5e94\u4fe1\u606f </li> <li>QUEUE</li> <li>RETURN</li> </ul>"},{"location":"linux/network/iptables/#2-target","title":"2. \u6269\u5c55target","text":"<ul> <li>REJECT  \u62d2\u7edd\u6570\u636e\u5305\u901a\u8fc7\uff0c\u5fc5\u8981\u65f6\u4f1a\u7ed9\u6570\u636e\u53d1\u9001\u7aef\u4e00\u4e2a\u54cd\u5e94\u7684\u4fe1\u606f\uff0c\u5ba2\u6237\u7aef\u521a\u8bf7\u6c42\u5c31\u4f1a\u6536\u5230\u62d2\u7edd\u7684\u4fe1\u606f </li> <li>LOG  \u5728/var/log/messages\u6587\u4ef6\u4e2d\u8bb0\u5f55\u65e5\u5fd7\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u6570\u636e\u5305\u4f20\u9012\u7ed9\u4e0b\u4e00\u6761\u89c4\u5219\uff0c\u4e5f\u5c31\u662f\u8bf4\u9664\u4e86\u8bb0\u5f55\u4ee5\u5916\u4e0d\u5bf9\u6570\u636e\u5305\u505a\u4efb\u4f55\u5176\u4ed6\u64cd\u4f5c\uff0c\u4ecd\u7136\u8ba9\u4e0b\u4e00\u6761\u89c4\u5219\u53bb\u5339\u914d\u3002 </li> <li>MASQUERADE  \u662fSNAT\u7684\u4e00\u79cd\u7279\u6b8a\u5f62\u5f0f\uff0c\u9002\u7528\u4e8e\u52a8\u6001\u7684\u3001\u4e34\u65f6\u4f1a\u53d8\u7684ip\u4e0a\u3002 </li> </ul>"},{"location":"linux/network/iptables/#4-iptables","title":"4. \u6570\u636e\u7ecf\u8fc7iptables\u7684\u6d41\u7a0b","text":""},{"location":"linux/network/iptables/#iptables_2","title":"\u4e8c\u3001iptables\u64cd\u4f5c","text":"<p>\u8bed\u6cd5\u683c\u5f0f</p> <pre><code>iptables [-t \u8868\u540d] \u7ba1\u7406\u9009\u9879 [\u94fe\u540d] [\u5339\u914d\u6761\u4ef6] [-j \u76ee\u6807\u52a8\u4f5c\u6216\u8df3\u8f6c]\n\u4e0d\u6307\u5b9a\u8868\u540d\u65f6\uff0c\u9ed8\u8ba4\u8868\u793afilter\u8868\n\u4e0d\u6267\u884c\u94fe\u540d\u65f6\uff0c\u6a21\u5f0f\u8868\u793a\u8be5\u8868\u5185\u6240\u6709\u7684\u94fe\n</code></pre>"},{"location":"linux/network/iptables/#1_2","title":"1. \u67e5","text":""},{"location":"linux/network/iptables/#11","title":"1.1 \u67e5\u770b\u8868\u7684\u89c4\u5219","text":"<p>\u8bed\u6cd5\uff1a<code>iptables -t \u8868\u540d -L</code></p> <pre><code># iptables -t filter -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination\n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination\n</code></pre>"},{"location":"linux/network/iptables/#12","title":"1.2 \u67e5\u770b\u8868\u4e2d\u6307\u5b9a\u94fe\u7684\u89c4\u5219","text":"<p>\u8bed\u6cd5\uff1a<code>iptables -t \u8868\u540d -L \u94fe\u540d</code></p> <pre><code># iptables -t filter -L INPUT\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination \n</code></pre>"},{"location":"linux/network/iptables/#13","title":"1.3 \u67e5\u770b\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f","text":""},{"location":"linux/network/iptables/#131-v","title":"1.3.1 <code>-v</code> \u663e\u793a\u8be6\u7ec6\u4fe1\u606f","text":"<pre><code># iptables -t filter -vL INPUT\nChain INPUT (policy ACCEPT 379 packets, 26956 bytes)\n pkts bytes target     prot opt in     out     source               destination\n    0     0 ACCEPT     udp  --  virbr0 any     anywhere             anywhere             udp dpt:domain\n</code></pre> <p>\u5404\u5b57\u6bb5\u7684\u542b\u4e49\uff1a</p> <pre><code>pkts\uff1a\u5bf9\u5e94\u89c4\u5219\u5339\u914d\u5230\u7684\u62a5\u6587\u6570\nbytes\uff1a\u5bf9\u5e94\u89c4\u5219\u5339\u914d\u5230\u7684\u62a5\u6587\u5305\u5927\u5c0f\u603b\u548c\ntarget\uff1a\u89c4\u5219\u5bf9\u5e94\u7684target\nprot\uff1a\u89c4\u5219\u5bf9\u5e94\u7684\u534f\u8bae\nopt\uff1a\u89c4\u5219\u5bf9\u5e94\u7684\u9009\u9879\nin\uff1a\u6570\u636e\u5305\u4ece\u54ea\u4e2a\u63a5\u53e3\u6d41\u5165\nout\uff1a\u6570\u636e\u5305\u4ece\u54ea\u4e2a\u63a5\u53e3\u6d41\u51fa\nsource\uff1a\u6e90\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2aIP\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7f51\u6bb5\ndestination\uff1a\u76ee\u6807\u5730\u5740\uff0c\u53ef\u4ee5\u662f\u4e00\u4e2aIP\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e00\u4e2a\u7f51\u6bb5\n</code></pre>"},{"location":"linux/network/iptables/#132-nip","title":"1.3.2 <code>-n</code>\u4e0d\u5bf9IP\u5730\u5740\u53cd\u89e3","text":"<pre><code># iptables -t filter -vnL INPUT\nChain INPUT (policy ACCEPT 24M packets, 12G bytes)\n pkts bytes target     prot opt in     out     source               destination\n    0     0 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:53\n</code></pre>"},{"location":"linux/network/iptables/#133-x","title":"1.3.3 <code>-x</code> \u663e\u793a\u7cbe\u786e\u6570\u503c","text":"<pre><code># iptables -t filter -vnL INPUT --line-number -x\nChain INPUT (policy ACCEPT 24568391 packets, 11707358586 bytes)\nnum      pkts      bytes target     prot opt in     out     source               destination\n1           0        0 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:53\n</code></pre>"},{"location":"linux/network/iptables/#134-line-number","title":"1.3.4 <code>--line-number</code> \u663e\u793a\u89c4\u5219\u7f16\u53f7","text":"<pre><code># iptables -t filter -vnL INPUT --line-number\nChain INPUT (policy ACCEPT 24M packets, 12G bytes)\nnum   pkts bytes target     prot opt in     out     source               destination\n1        0     0 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:53\n2        0     0 ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            tcp dpt:53\n3        0     0 ACCEPT     udp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            udp dpt:67\n4        0     0 ACCEPT     tcp  --  virbr0 *       0.0.0.0/0            0.0.0.0/0            tcp dpt:67\n</code></pre>"},{"location":"linux/network/iptables/#2_2","title":"2. \u589e","text":""},{"location":"linux/network/iptables/#21","title":"2.1 \u63d2\u5165\u4e00\u6761\u89c4\u5219","text":"<p><code>-I \u94fe\u540d</code> Insert\uff0c\u9ed8\u8ba4\u63d2\u5165\u5230\u7b2c\u4e00\u884c</p> <p>\u8bed\u6cd5\uff1a<code>iptables -t \u8868\u540d -I \u94fe\u540d \u5339\u914d\u6761\u4ef6 -j \u52a8\u4f5c</code></p> <pre><code># iptables -t filter -I INPUT -s 172.16.10.102 -j DROP\n# \u6307\u5b9a\u63d2\u5165\u5230\u7b2c3\u884c\n# iptables -t filter -A INPUT 3 -s 172.16.10.103 -j ACCEPT\n</code></pre> <p>\u53c2\u6570\uff1a</p> <pre><code>-t\uff1a\u64cd\u4f5c\u7684\u8868\n-I\uff1a\u63d2\u5165\u6307\u5b9a\u7684\u94fe\n-s\uff1a\u6e90\u5730\u5740\n-j\uff1a\u5339\u914d\u6761\u4ef6\u6ee1\u8db3\u540e\u6267\u884c\u7684target(\u52a8\u4f5c)\n</code></pre>"},{"location":"linux/network/iptables/#22","title":"2.2 \u8ffd\u52a0\u4e00\u6761\u89c4\u5219","text":"<p><code>-A \u94fe\u540d</code> APPEND\uff0c\u8ffd\u52a0\u5230\u6700\u540e\u4e00\u884c</p> <p>\u8bed\u6cd5\uff1a<code>iptables -t \u8868\u540d -A \u94fe\u540d \u5339\u914d\u6761\u4ef6 -j \u52a8\u4f5c</code></p> <pre><code># iptables -t filter -A INPUT -s 172.16.10.102 -j ACCEPT\n</code></pre> <p>\u6b64\u65f6filter\u8868\u7684\u72b6\u6001</p> <pre><code># iptables -nvL INPUT\nChain INPUT (policy ACCEPT 27 packets, 2764 bytes)\n pkts bytes target     prot opt in     out     source               destination\n  203 17052 DROP       all  --  *      *       172.16.10.102        0.0.0.0/0\n    0     0 ACCEPT     all  --  *      *       172.16.10.102        0.0.0.0/0  \n</code></pre> <p>\u89c4\u5219\u5339\u914d\u987a\u5e8f\uff1a\u4ece\u4e0a\u5230\u4e0b\u5339\u914d\uff0c\u5982\u679c\u524d\u9762\u7684\u89c4\u5219\u5339\u914d\u6210\u529f\u5c31\u4e0d\u4f1a\u6267\u884c\u540e\u9762\u7684\u89c4\u5219\u4e86\u3002</p>"},{"location":"linux/network/iptables/#3_1","title":"3. \u5220","text":"<p>\u8bed\u6cd5\uff1a<code>iptables -t \u8868\u540d -D \u94fe\u540d \u5339\u914d\u6761\u4ef6 -j \u52a8\u4f5c</code></p>"},{"location":"linux/network/iptables/#31","title":"3.1 \u6839\u636e\u89c4\u5219\u7684\u7f16\u53f7\u5220\u9664","text":"<p>\u8bed\u6cd5\uff1a<code>iptables -t filter -D INPUT \u7f16\u53f7</code></p> <pre><code># \u5220\u9664\u7b2c3\u6761\u89c4\u5219\n# iptables -t filter -D INPUT 3\n</code></pre>"},{"location":"linux/network/iptables/#32-target","title":"3.2 \u6839\u636e\u5177\u4f53\u7684\u5339\u914d\u6761\u4ef6\u4e0etarget\u5220\u9664","text":"<pre><code># iptables -t filter -D INPUT -s 172.16.10.102 -j DROP\n</code></pre>"},{"location":"linux/network/iptables/#33","title":"3.3 \u5220\u9664\u6307\u5b9a\u8868\u4e2d\u67d0\u6761\u94fe\u7684\u6240\u6709\u89c4\u5219","text":"<p><code>-F \u94fe\u540d</code>\uff1aFLUSH \u51b2\u5237\uff08\u5220\u9664\uff09\u6307\u5b9a\u94fe\u4e2d\u7684\u6240\u6709\u89c4\u5219</p> <pre><code># \u6e05\u9664INPUT\u94fe\u4e0a\u7684\u89c4\u5219\n# iptables -t filter -F INPUT\n# \u6e05\u9664filter\u8868\u603b\u6240\u6709\u94fe\u4e0a\u7684\u89c4\u5219\n# iptables -t filter -F\n</code></pre> <p>\u6ce8\u610f\uff1a</p> <ol> <li>\u82e5\u89c4\u5219\u8868\u4e2d\u6709\u591a\u6761\u76f8\u540c\u89c4\u5219\u65f6\uff0c\u6309\u5185\u5bb9\u5339\u914d\u53ea\u5220\u9664\u5e8f\u53f7\u6700\u5c0f\u7684\u4e00\u6761</li> <li>\u6309\u53f7\u7801\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u53f7\u5c0f\u4e8e\u7b49\u4e8e\u5df2\u6709\u89c4\u5219\u6570\uff0c\u5426\u5219\u62a5\u9519</li> <li>\u6309\u5185\u5bb9\u5339\u914d\u5220\u9664\u65f6\uff0c\u786e\u4fdd\u89c4\u5219\u5b58\u5728\uff0c\u5426\u5219\u62a5\u9519</li> </ol>"},{"location":"linux/network/iptables/#4","title":"4. \u6539","text":""},{"location":"linux/network/iptables/#41","title":"4.1 \u4fee\u6539\u94fe\u7684\u9ed8\u8ba4\u89c4\u5219","text":"<p>\u8bed\u6cd5\uff1a<code>iptables -P \u94fe\u540d \u52a8\u4f5c</code></p> <pre><code># iptables -t filter -P FORWARD DROP\n</code></pre>"},{"location":"linux/network/iptables/#42","title":"4.2 \u4fee\u6539\u89c4\u5219","text":"<p>\u8bed\u6cd5\uff1a<code>iptables -t \u8868\u540d -R \u94fe\u540d \u89c4\u5219\u5e8f\u53f7 \u89c4\u5219\u539f\u6765\u7684\u5339\u914d\u6761\u4ef6 -j \u52a8\u4f5c</code></p> <pre><code># iptables -t filter -R INPUT 1 -s 172.16.10.100 -j ACCEPT\n</code></pre> <p>\u6ce8\u610f\uff1a\u5fc5\u987b\u8981\u6307\u5b9a\u6e90\u5730\u5740</p> <p>ubuntu\u7cfb\u7edf\u53c2\u8003\uff1ahttps://help.ubuntu.com/community/IptablesHowTo</p>"},{"location":"linux/network/iptables/#_1","title":"\u4e09\u3001\u5339\u914d\u6761\u4ef6","text":""},{"location":"linux/network/iptables/#1_3","title":"1. \u57fa\u672c\u5339\u914d","text":""},{"location":"linux/network/iptables/#11_1","title":"1.1. \u6e90\u5730\u5740","text":"<p>\u8bed\u6cd5\uff1a<code>-s \u6765\u6e90\u5730\u5740</code>  \u53ef\u4ee5\u662fIP\u3001\u7f51\u6bb5\u3001\u57df\u540d\uff0c\u4e5f\u53ef\u4ee5\u662f\u7a7a</p>"},{"location":"linux/network/iptables/#111-ip","title":"1.1.1 \u6307\u5b9aIP","text":"<pre><code># iptables -t filter -I INPUT -s 172.16.10.100,172.16.10.102 -j DROP\n</code></pre>"},{"location":"linux/network/iptables/#112","title":"1.1.2 \u6307\u5b9a\u7f51\u6bb5","text":"<pre><code># iptables -t filter -I INPUT -s 172.16.10.0/24 -j DROP\n</code></pre>"},{"location":"linux/network/iptables/#113","title":"1.1.3 \u53d6\u53cd","text":"<pre><code># iptables -t filter -I INPUT ! -s 172.16.10.102 -j DROP\n</code></pre>"},{"location":"linux/network/iptables/#12_1","title":"1.2. \u76ee\u6807\u5730\u5740","text":"<p>\u8bed\u6cd5\uff1a <code>-d \u76ee\u7684\u5730\u5740</code> \u53ef\u4ee5\u662fIP\u3001\u7f51\u6bb5\u3001\u57df\u540d\uff0c\u4e5f\u53ef\u4ee5\u662f\u7a7a\uff08\u540c-s\uff09</p> <pre><code># iptables -t filter -I INPUT -d 172.16.10.101 -j DROP\n</code></pre>"},{"location":"linux/network/iptables/#13_1","title":"1.3. \u534f\u8bae\u7c7b\u578b","text":"<p>\u8bed\u6cd5\uff1a<code>-p [tcp|udp|icmp|udplite|icmpv6|ah|sctp]</code></p> <pre><code># iptables -t filter -I INPUT -s 172.16.10.102 -d 172.16.10.101 -p tcp -j REJECT\n</code></pre>"},{"location":"linux/network/iptables/#14-i-o","title":"1.4. \u7f51\u5361\u63a5\u53e3 -i/-o","text":"<p><code>-i \u5339\u914d\u6570\u636e\u8fdb\u5165\u7684\u7f51\u7edc\u63a5\u53e3</code>\uff1a\u6b64\u53c2\u6570\u4e3b\u8981\u7528\u4e8enat\u8868\uff0c\u4f8b\u5982\u76ee\u6807\u5730\u5740\u8f6c\u6362</p> <p><code>-o \u5339\u914d\u6570\u636e\u6d41\u51fa\u7684\u7f51\u7edc\u63a5\u53e3</code></p> <pre><code># iptables -t filter -I INPUT  -i eth0  -p icmp -j REJECT\n</code></pre> <p>-i: \u53ea\u80fd\u7528\u4e8ePREROUING\u3001INPUT\u3001FORWARD -o: \u53ea\u80fd\u7528\u4e8eFORWARD\u3001OUTPUT\u3001POSTROUTING</p>"},{"location":"linux/network/iptables/#2_3","title":"2. \u6269\u5c55\u5339\u914d","text":"<p>\u6269\u5c55\u5339\u914d\u6761\u4ef6\u4f7f\u7528\u65f6\u9700\u8981\u4f9d\u8d56\u4e00\u4e9b\u6269\u5c55\u6a21\u5757</p>"},{"location":"linux/network/iptables/#21-tcp","title":"2.1 tcp\u6a21\u5757","text":""},{"location":"linux/network/iptables/#211","title":"2.1.1 \u76ee\u6807\u7aef\u53e3","text":"<p>\u8bed\u6cd5\uff1a<code>-m \u6269\u5c55\u6a21\u5757\u540d -p \u534f\u8bae\u540d\u79f0 --dport \u7aef\u53e3</code> </p> <pre><code># iptables -t filter -I INPUT -s 172.16.10.102 -d 10.0.0.132  -p tcp --dport 80 -j REJECT\n</code></pre> <p>\u7aef\u53e3\u7684\u683c\u5f0f\uff1a<code>80</code> \u6216 <code>1000:</code> \u6216<code>:3000</code> \u6216 <code>6000:8000</code></p>"},{"location":"linux/network/iptables/#212","title":"2.1.2 \u6e90\u7aef\u53e3","text":"<p>\u8bed\u6cd5\uff1a<code>-m \u6269\u5c55\u6a21\u5757\u540d -p \u534f\u8bae\u540d\u79f0 --sport \u7aef\u53e3</code> </p> <pre><code># iptables -t filter -I INPUT -s 172.16.10.102 -m tcp -p tcp --sport 22 -j ACCEPT\n</code></pre>"},{"location":"linux/network/iptables/#213-tcp-flags","title":"2.1.3 <code>--tcp-flags</code>","text":"<p>\u8bed\u6cd5\uff1a<code>--tcp-flags SYN,ACK,FIN,RST URG,PSH  SYN</code></p> <pre><code># iptables -t filter -I INPUT -s 172.16.10.102 -m tcp -p tcp --dport 22 --tcp-flags SYN,ACK,FIN,RST,URG,PSH SYN -j REJECT\n\u6216\n# iptables -t filter -I INPUT -s 172.16.10.102 -m tcp -p tcp --dport 22 --tcp-flags ALL SYN -j REJECT\n</code></pre> <p>--tcp-flags \u9700\u8981\u5339\u914dTCP\u5934\u4e2d\u7684\u54ea\u4e9b\u6807\u5fd7\u4f4d    \u5728\u7b2c\u4e00\u90e8\u5206\u7684\u6807\u5fd7\u4f4d\u5217\u8868\u4e2d\uff0c\u54ea\u4e9b\u6807\u5fd7\u4f4d\u5fc5\u987b\u4e3a1</p>"},{"location":"linux/network/iptables/#22-udp","title":"2.2 udp\u6269\u5c55","text":"<pre><code># iptables -t filter -I INPUT -m udp -p udp --dport 137 -j ACCEPT\n# iptables -t filter -I INPUT -m udp -p udp --sport 138 -j ACCEPT\n</code></pre>"},{"location":"linux/network/iptables/#23-multiport","title":"2.3 multiport\u6a21\u5757(\u591a\u4e2a\u4e0d\u8fde\u7eed\u7684\u7aef\u53e3)","text":"<pre><code># iptables -t filter -I INPUT -s 172.16.10.102 -m multiport -p tcp --dport 22,80,8080 -j ACCEPT\n</code></pre>"},{"location":"linux/network/iptables/#24-icmp","title":"2.4 icmp\u6269\u5c55","text":"<pre><code># \u522b\u7684\u4e3b\u673aping\u4e0d\u8fdb\u6765\uff0c\u81ea\u5df1\u5411\u5916\u8bf7\u6c42\u56de\u590d\u7684\u62a5\u6587\u4e5f\u65e0\u6cd5\u8fdb\u5165\u9632\u706b\u5899\n# iptables -t filter -I INPUT -p icmp -j REJECT\n</code></pre> <p>\u53ea\u7981\u6b62\u88ab\u4ebaping</p> <pre><code># iptables -t filter -I INPUT -m icmp -p icmp --icmp-type 8/0 -j REJECT\n# \u6216\n# iptables -t filter -I INPUT -m icmp -p icmp --icmp-type \"echo-request\" -j REJECT\n</code></pre>"},{"location":"linux/network/iptables/#25-state","title":"2.5 state \u6269\u5c55","text":"<p>state\u6a21\u5757\u53ef\u4ee5\u5b9e\u73b0\u8fde\u63a5\u8ffd\u8e2a\u673a\u5236\uff0c\u6309\u5305\u72b6\u6001\u5339\u914d</p> <p>\u8fde\u63a5\u72b6\u6001\uff1aNEW\u3001ESTABLISHED\u3001RELATED\u3001INVALID\u3001UNTRACKED</p> <ol> <li>NEW\uff1a\u8fde\u63a5\u4e2d\u7684\u7b2c\u4e00\u4e2a\u5305\uff0c\u72b6\u6001\u5c31\u662fNEW</li> <li>ESTABLISHED\uff1a\u8fde\u63a5\u6001\uff0cNEW\u72b6\u6001\u540e\u9762\u7684\u5305\u7684\u72b6\u6001</li> <li>RELATED\uff1a\u884d\u751f\u6001\uff08\u4e00\u4e2a\u670d\u52a1\u5efa\u7acb\u4e86\u4e24\u4e2a\u8fde\u63a5\uff0c\u4e24\u4e2a\u8fde\u63a5\u4e2d\u7684\u67d0\u4e9b\u62a5\u6587\u76f4\u63a5\u6709\u5173\u7cfb\uff0c\u5982FTP\uff09</li> <li>INVALID\uff1a\u5305\u65e0\u6cd5\u88ab\u8bc6\u522b\uff08\u4e0d\u80fd\u88ab\u8bc6\u522b\u5c5e\u4e8e\u54ea\u4e2a\u8fde\u63a5\u6216\u6ca1\u6709\u4efb\u4f55\u72b6\u6001\uff09</li> <li>UNTRACKED\uff1a\u62a5\u6587\u672a\u88ab\u8ffd\u8e2a</li> </ol> <p>\u5b9e\u73b0\u53ea\u5141\u8bb8\u56de\u5e94\u7684\u62a5\u6587\u901a\u8fc7\u9632\u706b\u5899(\u53ea\u80fd\u8bbf\u95ee\u522b\u4eba\uff0c\u522b\u4eba\u4e0d\u80fd\u8bbf\u95ee\u81ea\u5df1)</p> <pre><code># iptables -t filter -I INPUT -m state --state  RELATED,ESTABLISHED -j ACCEPT\n# iptables -t filter -A INPUT -j REJECT\n</code></pre>"},{"location":"linux/network/iptables/#26-mac","title":"2.6 mac\u6269\u5c55","text":"<p>\u963b\u65ad\u6765\u81ea\u67d0MAC\u5730\u5740\u7684\u6570\u636e\u5305\u901a\u8fc7\u672c\u673a\uff0c\u4e0d\u5e38\u7528</p> <pre><code># iptables -A INPUT -m mac --mac-source 00:0c:29:53:ca:49 -j DROP\n</code></pre> <p>\u62a5\u6587\u7ecf\u8fc7\u8def\u7531\u540e\uff0c\u6570\u636e\u5305\u4e2d\u539f\u6709\u7684mac\u4fe1\u606f\u4f1a\u88ab\u66ff\u6362\uff0c\u6240\u4ee5\u5728\u8def\u7531\u540e\u7684iptables\u4e2d\u4f7f\u7528msc\u6a21\u5757\u65f6\u6ca1\u6709\u610f\u4e49\u7684\u3002</p>"},{"location":"linux/network/iptables/#27-limit","title":"2.7 limit\u6269\u5c55","text":"<p>\u7528\u4e00\u5b9a\u901f\u7387\u5339\u914d\u6570\u636e\u5305</p> <pre><code># iptables -A INPUT -d 10.0.0.132 -m limit --limit 50/s -j DROP\n# iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nDROP     all  --  anywhere             10.0.0.132           limit: avg 50/sec burst 5\n\nChain FORWARD (policy ACCEPT)\ntarget     prot opt source               destination         \n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination\n</code></pre>"},{"location":"linux/network/iptables/#_2","title":"\u56db\u3001\u9ed1\u767d\u540d\u5355","text":"<p>\u767d\u540d\u5355\uff1a\u653e\u884c\u5339\u914d\u89c4\u5219\u7684\u5305 \u9ed1\u540d\u5355\uff1a\u62d2\u7edd\u5339\u914d\u89c4\u5219\u7684\u5305</p> <p>\u767d\u540d\u5355\u7684\u5b9e\u73b0\uff1a</p> <pre><code># \u653e\u884c22\u7aef\u53e3\n# iptables -I INPUT -p tcp --dport 22 -j ACCEPT\n# INPUT\u94fe\u7684\u9ed8\u8ba4\u7b56\u7565\u6539\u4e3aDROP\n# iptables -P INPUT DROP\n</code></pre> <p>\u4e0d\u5efa\u8bae\u628a\u9ed8\u8ba4\u7b56\u7565\u8bbe\u7f6e\u4e3aDROP\uff0c\u4e00\u65e6\u6267\u884ciptables -F\uff0c\u4efb\u4f55\u5305\u90fd\u8fdb\u4e0d\u53bb\uff0cssh\u5c31\u4f1a\u65ad\u5f00</p> <p>\u4f18\u5316\u65b9\u6cd5</p> <pre><code># \u653e\u884c22\u7aef\u53e3\n# iptables -I INPUT -p tcp --dport 22 -j ACCEPT\n# \u5176\u4ed6\u90fd\u62d2\u7edd\n# iptables -A INPUT -j REJECT\n</code></pre>"},{"location":"linux/network/iptables/#_3","title":"\u4e94\u3001\u81ea\u5b9a\u4e49\u94fe","text":"<ol> <li>\u81ea\u5b9a\u4e49\u94fe\u7684\u610f\u4e49\uff1a \u4fbf\u4e8e\u5206\u7c7b\u7ba1\u7406</li> <li>\u81ea\u5b9a\u4e49\u94fe\u4e0d\u80fd\u76f4\u63a5\u4f7f\u7528\uff0c\u9700\u8981\u88ab\u9ed8\u8ba4\u94fe\u5f15\u7528\u624d\u53ef\u4ee5\u4f7f\u7528</li> </ol>"},{"location":"linux/network/iptables/#1_4","title":"1. \u521b\u5efa\u81ea\u5b9a\u4e49\u94fe","text":"<p>\u8bed\u6cd5\uff1a<code>-N \u81ea\u5b9a\u4e49\u94fe\u7684\u540d\u79f0</code></p> <pre><code># iptables -t filter -N IN_WEB\n# iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \n\nChain FORWARD (policy DROP)\ntarget     prot opt source               destination         \n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination         \n\nChain IN_WEB (0 references) # \u5f15\u7528\u8ba1\u6570\u4e3a0\ntarget     prot opt source               destination \n</code></pre>"},{"location":"linux/network/iptables/#2_4","title":"2. \u7ed9\u81ea\u5b9a\u4e49\u94fe\u6dfb\u52a0\u89c4\u5219","text":"<pre><code>root@node1:~# iptables -I IN_WEB -s 172.16.10.100 -j REJECT\nroot@node1:~# iptables -t filter -nvL IN_WEB\nChain IN_WEB (0 references)\n pkts bytes target     prot opt in     out     source               destination         \n    0     0 REJECT     all  --  *      *       172.16.10.100        0.0.0.0/0            reject-with icmp-port-unreachable\n</code></pre>"},{"location":"linux/network/iptables/#3_2","title":"3. \u5f15\u7528\u81ea\u5b9a\u4e49\u94fe","text":"<pre><code># iptables -I INPUT -p tcp --dport 80 -j IN_WEB\n# iptables -L\nChain INPUT (policy ACCEPT)\ntarget     prot opt source               destination         \nIN_WEB     tcp  --  anywhere             anywhere             tcp dpt:http\n\nChain FORWARD (policy DROP)\ntarget     prot opt source               destination         \n\nChain OUTPUT (policy ACCEPT)\ntarget     prot opt source               destination         \n\nChain IN_WEB (1 references)\ntarget     prot opt source               destination         \nREJECT     all  --  172.16.10.100        anywhere             reject-with icmp-port-unreachable\n</code></pre>"},{"location":"linux/network/iptables/#4_1","title":"4. \u91cd\u547d\u540d\u81ea\u5b9a\u4e49\u94fe","text":"<pre><code># iptables -E IN_WEB WEB\n</code></pre>"},{"location":"linux/network/iptables/#5","title":"5. \u5220\u9664\u81ea\u5b9a\u4e49\u94fe","text":"<p>\u5220\u9664\u6761\u4ef6</p> <ol> <li>\u81ea\u5b9a\u4e49\u94fe\u6ca1\u6709\u88ab\u4efb\u4f55\u9ed8\u8ba4\u94fe\u5f15\u7528\uff0c\u5373\u81ea\u5b9a\u4e49\u94fe\u7684\u5f15\u7528\u8ba1\u6570\u4e3a0</li> <li>\u81ea\u5b9a\u4e49\u94fe\u4e2d\u6ca1\u6709\u4efb\u4f55\u89c4\u5219</li> </ol> <pre><code># iptables -D INPUT 1\n# iptables -t filter -F WEB\n# iptables -X WEB\n</code></pre>"},{"location":"linux/network/iptables/#target","title":"\u516d\u3001\u52a8\u4f5c(target)","text":""},{"location":"linux/network/iptables/#1_5","title":"1. \u57fa\u7840\u52a8\u4f5c","text":""},{"location":"linux/network/iptables/#1-accept","title":"1. ACCEPT","text":"<p>\u901a\u8fc7\uff0c\u5141\u8bb8\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe\u800c\u4e0d\u62e6\u622a\u5b83</p>"},{"location":"linux/network/iptables/#2-drop","title":"2. DROP","text":"<p>\u4e22\u5f03\uff0c\u963b\u6b62\u6570\u636e\u5305\u901a\u8fc7\u672c\u94fe\u800c\u4e22\u5f03\u5b83</p>"},{"location":"linux/network/iptables/#2_5","title":"2. \u6269\u5c55\u52a8\u4f5c","text":""},{"location":"linux/network/iptables/#21-reject","title":"2.1. REJECT","text":"<p>\u8bed\u6cd5\uff1a<code>--reject-with\u3000\u5bf9\u65b9\u88ab\u62d2\u7edd\u65f6\u7684\u63d0\u793a\u4fe1\u606f</code></p> <p>\u5bf9\u65b9\u88ab\u62d2\u7edd\u65f6\u7684\u63d0\u793a\u4fe1\u606f\uff1a</p> <pre><code>icmp-port-unreachable \u9ed8\u8ba4\nicmp-net-unreachable\nicmp-host-unreachabe\nicmp-proto-unreachabe\nicmp-net-prohibited\nicmp-admin-prohibited\n</code></pre>"},{"location":"linux/network/iptables/#22-log","title":"2.2. LOG","text":"<p>\u5c06\u7b26\u5408\u6761\u4ef6\u7684\u62a5\u6587\u7684\u76f8\u5173\u4fe1\u606f\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d</p> <p>\u9009\u9879\uff1a<code>--log-level  [emerg|alert|crit|error|warning|notice|info|debug] --log-prefix \u4fe1\u606f\u524d\u7f00</code> \u4fe1\u606f\u524d\u7f0029\u4e2a\u5b57\u7b26\u4ee5\u5185</p> <pre><code># \u628a\u60f3\u8981\u4e3b\u52a8\u8fde\u63a522\u7aef\u53e3\u7684\u62a5\u6587\u53ca\u76f8\u5173\u4fe1\u606f\u8bb0\u5f55\u5230\u65e5\u5fd7\u4e2d\n# iptables -I INPUT -p tcp --dport 22 -m state --state NEW -j LOG --log-prefix \"want-in-from-port-22\"\n</code></pre>"},{"location":"linux/network/iptables/#23-snat","title":"2.3 SNAT","text":"<p>\u6e90\u5730\u5740\u8f6c\u6362</p> <pre><code># 1. \u8f6c\u6362\u4e3a\u5355IP\n# iptables -t nat -A POSTROUTING -s 10.1.0.0/16 -j SNAT --to-source 172.16.0.101\n# 2. \u8f6c\u6362\u5230IP\u5730\u5740\u6c60\n#iptables -t nat -A POSTROUTING -s 10.1.0.0/16 -j SNAT --to-source 172.16.0.101-172.16.0.200\n</code></pre> <p>\u53c2\u6570\uff1a</p> <pre><code>-t: \u64cd\u4f5cnat\u8868\n-A: \u5c06\u89c4\u5219\u6dfb\u52a0\u5230POSTROUTING\u94fe\u672b\u5c3e\n-s: \u6e90\u5730\u5740\n-j: \u4f7f\u7528 SNAT \u52a8\u4f5c\n--to-source: \u628a\u5339\u914d\u5230\u7684\u62a5\u6587\u4fee\u6539\u4e3a\u6307\u5b9a\u5730\u5740\n</code></pre>"},{"location":"linux/network/iptables/#24-dnat","title":"2.4 DNAT","text":"<p>\u76ee\u6807\u5730\u5740\u8f6c\u6362\uff0c\u8bed\u6cd5\u540cSNAT\u3002</p> <pre><code># iptables -t nat -I PREROUTING -d 172.16.10.101 -p tcp --dport 3389 -j DNAT --to-destination 10.1.1.6:3389\n</code></pre>"},{"location":"linux/network/iptables/#25-masquerade","title":"2.5 MASQUERADE","text":"<p>\u4e0eSNAT\u7c7b\u4f3c\uff0c\u4f46\u662f\u53ef\u4ee5\u52a8\u6001\u7684\u5c06\u6e90\u5730\u5740\u8f6c\u6362\u4e3a\u53ef\u7528\u7684IP\u5730\u5740</p> <pre><code># iptables -t nat -A POSTROUTING -s 10.1.0.0/16 -o eth0 -j MASQUERADE\n</code></pre>"},{"location":"linux/network/iptables/#26-redirect","title":"2.6 REDIRECT","text":"<p>\u5728\u672c\u673a\u8fdb\u7a0b\u7aef\u53e3\u6620\u5c04</p> <pre><code># iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8080\n</code></pre> <p>\u4f7f\u7528NAT\u9700\u8981\u5f00\u542f\u8f6c\u53d1\uff1a</p> <pre><code># echo 1 &gt; /proc/sys/net/ipv4/ip_forward\n</code></pre> <p>\u62d2\u7edd\u4e0e\u7981\u6b62\u4e00\u4e2a\u6570\u636e\u5305\u7684\u533a\u522b</p> <p>\u62d2\u7edd\uff1a\u4e22\u5f03\u6570\u636e\u5305\u7684\u540c\u65f6\u7ed9\u53d1\u9001\u8005\u8fd4\u56de\u4e00\u4f1aICMP\u9519\u8bef\u6d88\u606f</p> <p>\u4e22\u5f03\uff1a\u6570\u636e\u5305\u76f4\u63a5\u4e22\u5f03\u4e0d\u8fd4\u56de\u4efb\u4f55\u901a\u77e5</p> <p>\u4e3a\u4e86\u5b89\u5168\uff0c\u901a\u5e38\u76f4\u63a5\u4e22\u5f03\uff0c\u539f\u56e0\u67093\uff1a</p> <ol> <li> <p>\u53d1\u9001\u9519\u8bef\u6d88\u606f\u4f1a\u4f7f\u901a\u4fe1\u91cf\u52a0\u500d</p> </li> <li> <p>\u54cd\u5e94\u7684\u6570\u636e\u5305\u53ef\u80fd\u662f\u62d2\u7edd\u670d\u52a1\u5de5\u5177</p> </li> <li> <p>\u5373\u4f7f\u4e00\u4e2a\u9519\u8bef\u7684\u6d88\u606f\u90fd\u4f1a\u7ed9\u653b\u51fb\u8005\u63d0\u4f9b\u6f5c\u5728\u7684\u6709\u7528\u4fe1\u606f</p> </li> </ol>"},{"location":"linux/network/iptables/#_4","title":"\u4e03\u3001\u4fdd\u5b58","text":"<pre><code># \u4fdd\u5b58\n# iptables-save\n# \u6062\u590d\n# iptables-restore\n</code></pre> <p>\u53c2\u8003\uff1a</p> <p>https://wiki.archlinux.org/index.php/iptables</p> <p>http://www.zsythink.net/archives/1199 </p>"},{"location":"programming/CSS/","title":"CSS","text":""},{"location":"programming/CSS/#css","title":"\u4e00\u3001CSS \u7b80\u4ecb\uff1a","text":"<p>CSS \u6307\u5c42\u53e0\u6837\u5f0f\u8868 (Cascading Style Sheets)\uff0c\u7528\u6765\u8bbe\u7f6eHTML\u7684\u683c\u5f0f\u3002</p> <p>\u8bed\u6cd5\uff1a</p> <pre><code>\u9009\u62e9\u5668 \n    {\n        \u5c5e\u6027:\u503c;\n        \u5c5e\u6027:\u503c\n    }\n</code></pre> <p>\u6ce8\u91ca\uff1a</p> <pre><code>// \u5355\u884c\u6ce8\u91ca\n/*\u591a\u884c\u6ce8\u91ca*/\n</code></pre>"},{"location":"programming/CSS/#css_1","title":"\u4e8c\u3001CSS\u7684\u5f15\u5165\u65b9\u5f0f\uff1a\u884c\u5185\u5d4c\u3001\u5d4c\u5165\u5f0f\u3001\u94fe\u63a5\u5f0f\u3001\u5bfc\u5165\u5f0f","text":""},{"location":"programming/CSS/#1","title":"1.\u884c\u5185\u5d4c\uff1a","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;p style=\"color: red\"&gt;hello world&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#2","title":"2.\u5d4c\u5165\u5f0f\uff1a","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;style&gt;\n            p {\n                color: red;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;hello world&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#3","title":"3. \u94fe\u63a5\u5f0f\uff1a","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"mystyle.css\"&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;hello world&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>css\u6587\u4ef6</p> <pre><code>// filename: mystyle.css\np {\n    color: red;\n}\n</code></pre>"},{"location":"programming/CSS/#4","title":"4. \u5bfc\u5165\u5f0f\uff1a","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;style&gt;\n            @import \"mystyle.css\";\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;hello world&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>css\u6587\u4ef6</p> <pre><code>// filename: mystyle.css\np {\n    color: red;\n}\n</code></pre>"},{"location":"programming/CSS/#_1","title":"\u4e09\u3001\u9009\u62e9\u5668","text":""},{"location":"programming/CSS/#1_1","title":"1.\u57fa\u672c\u9009\u62e9\u5668","text":""},{"location":"programming/CSS/#11","title":"1.1 \u901a\u7528\u9009\u62e9\u5668","text":"<pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n        &lt;style&gt;\n            {#html\u9875\u9762\u7684\u6240\u6709\u5143\u7d20#}\n            * {\n                color: red;\n            }\n        &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;hello&lt;/h1&gt;\n    &lt;p&gt;world&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#12","title":"1.2 \u6807\u7b7e\u9009\u62e9\u5668","text":"<pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n        &lt;style&gt;\n            {#\u7ed9\u6240\u6709\u7684p\u6807\u7b7e\u6307\u5b9a\u6837\u5f0f#}\n            p {\n                color: red;\n            }\n        &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;hello&lt;/h1&gt;\n    &lt;p&gt;world&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#13-id","title":"1.3 ID\u9009\u62e9\u5668","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"zh\"&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;style&gt;\n            {# \u4e3aid\u4e3aname\u7684HTML\u5143\u7d20\u6307\u5b9a\u7279\u5b9a\u7684\u6837\u5f0f\u3002#}\n            #name {\n                color: red;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;hello&lt;/p&gt;\n        &lt;p id=\"name\"&gt;\u8bf8\u845b\u5b54\u660e&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#14-class","title":"1.4 class\u9009\u62e9\u5668","text":"<pre><code>&lt;!doctype html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n        &lt;style&gt;\n            .name {\n                color: red;\n            }\n        &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h3&gt;\u8bf8\u845b\u5144\u5f1f&lt;/h3&gt;\n    &lt;p class=\"name\"&gt;\u8bf8\u845b\u5b54\u660e&lt;/p&gt;\n    &lt;p class=\"name\"&gt;\u8bf8\u845b\u5b50\u745c&lt;/p&gt;\n    &lt;p class=\"name\"&gt;\u8bf8\u845b\u516c\u4f11&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#2_1","title":"2.\u7ec4\u5408\u9009\u62e9","text":""},{"location":"programming/CSS/#21","title":"2.1 \u540e\u4ee3\u9009\u62e9\u5668","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head lang=\"en\"&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;style type=\"text/css\"&gt;\n            #food p{\n                color: green;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"food\"&gt;\n            &lt;p&gt;\u6c34\u679c\uff1a&lt;/p&gt;\n            &lt;div class=\"fruits\"&gt;\n                &lt;p&gt;\u82f9\u679c&lt;/p&gt;\n                &lt;p&gt;\u9999\u8549&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;p&gt;\u751c\u54c1\uff1a&lt;/p&gt;\n            &lt;div class=\"dessert\"&gt;\n                &lt;p&gt;\u86cb\u7cd5&lt;/p&gt;\n                &lt;p&gt;\u5de7\u514b\u529b&lt;/p&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#22","title":"2.2 \u5b50\u4ee3\u9009\u62e9\u5668","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;style type=\"text/css\"&gt;\n            #food&gt;p{\n                color: green;\n            }\n            #food&gt;div{\n                font-size: 20px; \n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"food\"&gt;\n            &lt;div class=\"fruits\"&gt;\n                &lt;p&gt;\u82f9\u679c&lt;/p&gt;\n                &lt;p&gt;\u9999\u8549&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"dessert\"&gt;\n                &lt;p&gt;\u86cb\u7cd5&lt;/p&gt;\n                &lt;p&gt;\u5de7\u514b\u529b&lt;/p&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#23","title":"2.3 \u53d8\u5f62\u9009\u62e9\u5668","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;style type=\"text/css\"&gt;\n            #fav, .fruits{\n                color: red;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p id=\"fav\"&gt;Favourite&lt;/p&gt;\n        &lt;div id=\"food\"&gt;\n            &lt;div class=\"fruits\"&gt;\n                &lt;p&gt;\u82f9\u679c&lt;/p&gt;\n                &lt;p&gt;\u9999\u8549&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;div class=\"dessert\"&gt;\n                &lt;p&gt;\u86cb\u7cd5&lt;/p&gt;\n                &lt;p&gt;\u5de7\u514b\u529b&lt;/p&gt;\n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#24","title":"2.4  \u6bd7\u90bb\u9009\u62e9\u5668","text":"<p>\u7d27\u63a5\u5728\u53e6\u4e00\u5143\u7d20\u540e\u7684\u5143\u7d20\uff0c\u4e14\u4e8c\u8005\u6709\u76f8\u540c\u7236\u5143\u7d20\u3002</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;style type=\"text/css\"&gt;\n            div+p{\n                color: red;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;p 1&lt;/p&gt;\n        &lt;div&gt;\n            &lt;p&gt;div1&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;p&gt;p 2&lt;/p&gt;\n        &lt;p&gt;p 3&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#3_1","title":"3. \u5c5e\u6027\u9009\u62e9\u5668","text":"<pre><code>[attribute]            [target]    \u9009\u62e9\u6240\u6709\u5e26\u6709target\u5c5e\u6027\u5143\u7d20    \n[attribute=value]    [target=-blank]    \u9009\u62e9\u6240\u6709\u4f7f\u7528target=\"-blank\"\u7684\u5143\u7d20    \n[attribute~=value]    [title~=flower]    \u9009\u62e9\u6807\u9898\u5c5e\u6027\u5305\u542b\u5355\u8bcd\"flower\"\u7684\u6240\u6709\u5143\u7d20    \n[attribute|=language]    [lang|=en]    \u9009\u62e9\u4e00\u4e2alang\u5c5e\u6027\u7684\u8d77\u59cb\u503c=\"EN\"\u7684\u6240\u6709\u5143\u7d20    \n[attribute^=value]    a[src^=\"https\"]    \u9009\u62e9\u6bcf\u4e00\u4e2asrc\u5c5e\u6027\u7684\u503c\u4ee5\"https\"\u5f00\u5934\u7684\u5143\u7d20    \n[attribute$=value]    a[src$=\".pdf\"]    \u9009\u62e9\u6bcf\u4e00\u4e2asrc\u5c5e\u6027\u7684\u503c\u4ee5\".pdf\"\u7ed3\u5c3e\u7684\u5143\u7d20    \n[attribute*=value]    a[src*=\"runoob\"]    \u9009\u62e9\u6bcf\u4e00\u4e2asrc\u5c5e\u6027\u7684\u503c\u5305\u542b\u5b50\u5b57\u7b26\u4e32\"runoob\"\u7684\u5143\u7d20    \n</code></pre>"},{"location":"programming/CSS/#4_1","title":"4. \u4f2a\u7c7b","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    &lt;style&gt;\n        a:link{    /* \u6ca1\u6709\u8bbf\u95ee\u8fc7\u7684\u8fde\u63a5 */\n            color: red;\n        }\n        a:visited{ /* \u5df2\u7ecf\u8bbf\u95ee\u8fc7\u7684\u989c\u8272 */\n            color: green;\n        }\n        a:hover{ /* \u9f20\u6807\u653e\u4e0a\u7684\u989c\u8272 */\n            color: yellow;\n        }\n        a:active{ /* \u9f20\u6807\u70b9\u51fb\u65f6\u7684\u989c\u8272 */\n            color: blue;\n        }\n        p:after{ /* \u4f4d\u4e8e\u5143\u7d20\u4e4b\u540e\u7684\u683c\u5f0f */\n            content: ' world';\n        }\n        p:before{ /* \u4f4d\u4e8e\u5143\u7d20\u4e4b\u524d\u7684\u683c\u5f0f */\n            content: \"\u4f60\u597d \u4e16\u754c\";\n            color: green;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n\n&lt;a href=\"https://www.baidu.com\"&gt;\u767e\u5ea6\u4e00\u4e0b&lt;/a&gt;\n&lt;p&gt;hello&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#_2","title":"\u56db\u3001\u5c5e\u6027","text":""},{"location":"programming/CSS/#1_2","title":"1. \u80cc\u666f\u5c5e\u6027","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            div {\n                height: 1000px;\n                background-color: gray;\n                background-image: url(\"mayun.jpg\");\n                background-repeat: no-repeat;\n                background-size: 200px, 300px;\n                background-position:center;\n                /* background-attachment:fixed; */\n                //\u53ef\u4ee5\u7b80\u5199\u4e3a\u4e0b\u9762\u7684\u683c\u5f0f\n                //background: url(\"mayun.jpg\") gray no-repeat center;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div&gt;&lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#2_2","title":"2. \u989c\u8272\u5c5e\u6027","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Title&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            h1 {\n                color:     #87CEEB;\n                /* color: red; */\n                /* color: rgb(255,255,0); */\n                /* color:rgba(255,0,0,0.2); */\n                opacity: 0.5  /* \u900f\u660e\u5ea6 */\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;h1&gt;hello world&lt;/h1&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#3_2","title":"3. \u5b57\u4f53\u5c5e\u6027","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Title&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            h1 {\n                font-family:\"Times New Roman\", Times, serif;\n                font-size: 30px;\n                font-style: italic;\n                font-weight:lighter;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;h1&gt;hello world&lt;/h1&gt;\n    &lt;/body&gt;\n&lt;/html&gt;    \n</code></pre> <p>font-weight\u7684\u5c5e\u6027\u503c</p> <ol> <li> <p><code>normal</code> \u9ed8\u8ba4\u503c\u3002\u5b9a\u4e49\u6807\u51c6\u7684\u5b57\u7b26\u3002</p> </li> <li> <p><code>bold</code>   \u5b9a\u4e49\u7c97\u4f53\u5b57\u7b26\u3002</p> </li> <li> <p><code>bolder</code> \u5b9a\u4e49\u66f4\u7c97\u7684\u5b57\u7b26\u3002</p> </li> <li> <p><code>lighter</code>    \u5b9a\u4e49\u66f4\u7ec6\u7684\u5b57\u7b26\u3002</p> </li> <li> <p><code>100-900</code> \u5b9a\u4e49\u7531\u7c97\u5230\u7ec6\u7684\u5b57\u7b26\u3002400 \u7b49\u540c\u4e8e normal\uff0c\u800c 700 \u7b49\u540c\u4e8e bold\u3002</p> </li> </ol>"},{"location":"programming/CSS/#4_2","title":"4. \u6587\u672c\u5c5e\u6027","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Title&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            p {\n                color: green;                      /* \u5b57\u4f53\u989c\u8272 */\n                direction: ltr;                  /* \u5b57\u4f53\u65b9\u5411 rtl */\n                letter-spacing: 5px;             /* \u5b57\u6bcd\u95f4\u9694 */\n                word-spacing:30px;                /* \u5355\u8bcd\u95f4\u9694 */\n                line-height: 30px;                 /* \u884c\u8ddd */\n                text-align: center;              /* \u4f4d\u7f6e\uff1aleft|right|justify */\n                text-decoration:line-through;     /* \u5220\u9664\u7ebf\uff1aoverline | underline */\n                text-transform:capitalize;      /* \u5927\u5c0f\u5199\uff1auppercase|lowercase */    \n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;life is short, &lt;br&gt;you need python.&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#5","title":"5. \u5185\u5916\u8fb9\u8ddd","text":""},{"location":"programming/CSS/#1_3","title":"1. \u5916\u8fb9\u8ddd","text":"<pre><code>margin:10px 5px 15px 20px;\n//\u4e0a\u8fb9\u8ddd\u662f 10px\n//\u53f3\u8fb9\u8ddd\u662f 5px\n//\u4e0b\u8fb9\u8ddd\u662f 15px\n//\u5de6\u8fb9\u8ddd\u662f 20px\nmargin:10px 5px 15px;\n//\u4e0a\u8fb9\u8ddd\u662f 10px\n//\u53f3\u8fb9\u8ddd\u548c\u5de6\u8fb9\u8ddd\u662f 5px\n//\u4e0b\u8fb9\u8ddd\u662f 15px\nmargin:10px 5px;\n//\u4e0a\u8fb9\u8ddd\u548c\u4e0b\u8fb9\u8ddd\u662f 10px\n//\u53f3\u8fb9\u8ddd\u548c\u5de6\u8fb9\u8ddd\u662f 5px\nmargin:10px; \n//\u6240\u6709\u56db\u4e2a\u8fb9\u8ddd\u90fd\u662f 10px\n</code></pre> <p><code>margin-bottom</code> \u8bbe\u7f6e\u5143\u7d20\u7684\u4e0b\u5916\u8fb9\u8ddd <code>margin-left</code> \u8bbe\u7f6e\u5143\u7d20\u7684\u5de6\u5916\u8fb9\u8ddd <code>margin-right</code> \u8bbe\u7f6e\u5143\u7d20\u7684\u53f3\u5916\u8fb9\u8ddd <code>margin-top</code> \u8bbe\u7f6e\u5143\u7d20\u7684\u4e0a\u5916\u8fb9\u8ddd</p>"},{"location":"programming/CSS/#2_3","title":"2. \u5185\u8fb9\u8ddd","text":"<p><code>padding</code> \u4e0e<code>margin</code>\u76f8\u540c</p>"},{"location":"programming/CSS/#6","title":"6.\u8fb9\u6846","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;Title&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            div {\n                height: 200px;\n                width: 200px;\n                /* border:red solid 5px; */\n                border-bottom:red solid 5px;\n                border-top: green dotted 5px;\n                border-left: blue dashed 5px;\n                border-right: gray  double 5px;\n                border-radius:20%;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#7","title":"7. \u5bbd\u9ad8\u8bbe\u7f6e","text":"<p><code>height</code>        \u8bbe\u7f6e\u5143\u7d20\u7684\u9ad8\u5ea6\u3002 <code>line-height</code>  \u8bbe\u7f6e\u884c\u9ad8\u3002 <code>max-height</code>    \u8bbe\u7f6e\u5143\u7d20\u7684\u6700\u5927\u9ad8\u5ea6\u3002 <code>min-height</code>    \u8bbe\u7f6e\u5143\u7d20\u7684\u6700\u5c0f\u9ad8\u5ea6\u3002 <code>width</code>         \u8bbe\u7f6e\u5143\u7d20\u7684\u5bbd\u5ea6\u3002 <code>max-width</code>       \u8bbe\u7f6e\u5143\u7d20\u7684\u6700\u5927\u5bbd\u5ea6\u3002 <code>min-width</code>       \u8bbe\u7f6e\u5143\u7d20\u7684\u6700\u5c0f\u5bbd\u5ea6\u3002</p>"},{"location":"programming/CSS/#8-display","title":"8. display","text":"<p><code>none</code>                     \u6b64\u5143\u7d20\u4e0d\u4f1a\u88ab\u663e\u793a\u3002 <code>block</code>                   \u6b64\u5143\u7d20\u5c06\u663e\u793a\u4e3a\u5757\u7ea7\u5143\u7d20\uff0c\u6b64\u5143\u7d20\u524d\u540e\u4f1a\u5e26\u6709\u6362\u884c\u7b26\u3002 <code>inline</code>                 \u9ed8\u8ba4\u3002\u6b64\u5143\u7d20\u4f1a\u88ab\u663e\u793a\u4e3a\u5185\u8054\u5143\u7d20\uff0c\u5143\u7d20\u524d\u540e\u6ca1\u6709\u6362\u884c\u7b26\u3002 <code>inline-bloc</code>k    \u884c\u5185\u5757\u5143\u7d20\u3002\uff08CSS2.1 \u65b0\u589e\u7684\u503c\uff09</p>"},{"location":"programming/CSS/#_3","title":"\u4e94\u3001\u5143\u7d20\u4f4d\u7f6e","text":""},{"location":"programming/CSS/#1_4","title":"1.\u6b63\u5e38\u6587\u6863\u6d41","text":"<p>\u5c06\u5143\u7d20\uff08\u6807\u7b7e\uff09\u5728\u8fdb\u884c\u6392\u7248\u5e03\u5c40\u7684\u65f6\u5019\u6309\u4ece\u5de6\u5230\u53f3\uff0c\u4ece\u4e0a\u5230\u4e0b\u7684\u987a\u5e8f\u8fdb\u884c\u6392\u7248</p>"},{"location":"programming/CSS/#2_4","title":"2. \u8131\u79bb\u6587\u6863\u6d41","text":"<p>\u5c06\u5143\u7d20\uff08\u6807\u7b7e\uff09\u4ece\u6587\u6863\u6d41\u4e2d\u53d6\u51fa\u8fdb\u884c\u8986\u76d6\uff0c\u5176\u4ed6\u5143\u7d20\u4f1a\u6309\u6587\u6863\u6d41\u4e2d\u4e0d\u5b58\u5728\u8be5\u5143\u7d20\u91cd\u65b0\u8fdb\u884c\u5e03\u5c40 \u975e\u5b8c\u5168\u8131\u79bb\uff1afloat\uff08\u6d6e\u52a8\uff09 \u5b8c\u5168\u8131\u79bb\uff1aposition\uff08\u5b9a\u4f4d\uff09\u4e2d\u7684absolute,fixed</p>"},{"location":"programming/CSS/#1-float","title":"1. float","text":"<p>float \u4f7f\u5143\u7d20\u5411\u5de6\u6216\u5411\u53f3\u79fb\u52a8\uff0c\u5176\u5468\u56f4\u7684\u5143\u7d20\u4e5f\u4f1a\u91cd\u65b0\u6392\u5217 \u5c5e\u6027\u503c\uff1aleft | right clear \u6307\u5b9a\u4e0d\u5141\u8bb8\u5143\u7d20\u5468\u56f4\u6709\u6d6e\u52a8\u5143\u7d20\u3002 \u5c5e\u6027\u503c\uff1aleft | right | both</p>"},{"location":"programming/CSS/#2position","title":"2.position","text":""},{"location":"programming/CSS/#21static","title":"2.1<code>static</code>\uff1a\u9ed8\u8ba4\u503c","text":""},{"location":"programming/CSS/#22relative","title":"2.2<code>relative</code>\uff1a\u76f8\u5bf9\u5176\u6b63\u5e38\u4f4d\u7f6e","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            #p2{\n                position: relative;\n                left: 20px;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p id=\"p1\"&gt;hello world&lt;/p&gt;\n        &lt;p id=\"p2\"&gt;hello world&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;    \n</code></pre>"},{"location":"programming/CSS/#23-fixed","title":"2.3 <code>fixed</code>:\u4f4d\u7f6e\u76f8\u5bf9\u4e8e\u6d4f\u89c8\u5668\u7a97\u53e3\u662f\u56fa\u5b9a\u4f4d\u7f6e","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            a{\n                position: fixed;\n                right: 100px;\n                bottom: 100px;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"top\" style=\"height: 50px;background-color: green\"&gt;&lt;/div&gt;\n        &lt;div id=\"content\" style=\"height: 1000px; background-color: gray\"&gt;\n        &lt;/div&gt;\n        &lt;a href=\"#top\"&gt;\u8fd4\u56de\u9876\u90e8&lt;/a&gt;\n    &lt;/body&gt;\n&lt;/html&gt;    \n</code></pre>"},{"location":"programming/CSS/#24-absolute","title":"2.4 <code>absolute</code>","text":"<p>\u5982\u679c\u5176\u7236\u7ea7\u7684position\u8bbe\u7f6e\u4e3a\u975estatic\uff0c\u5219\u6309\u7167\u7236\u7ea7\u7684\u4f4d\u7f6e\u8fdb\u884c\u79fb\u52a8\uff0c\u5982\u679c\u6ca1\u6709\u5c31\u7ee7\u7eed\u5411\u4e0a\u627e\uff0c\u5982\u679c\u90fd\u6ca1\u6709\u5c31\u6309html\u7684\u4f4d\u7f6e\u8fdb\u884c\u79fb\u52a8. \u5728\u4e0b\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u5982\u679cdiv1\u6ca1\u6709\u8bbe\u7f6eposition\u7684\u5c5e\u6027\uff0c\u90a3\u4e48div2\u5c31\u4f1a\u6309\u7167HTML\u7684\u76f8\u5bf9\u4f4d\u7f6e\u8fdb\u884c\u5b9a\u4f4d\uff0c\u5982\u679c\u8bbe\u7f6e\u4e86div1\u7684relative\uff0c\u90a3\u4e48div2\u624d\u4f1a\u6309\u7167div1\u7684\u4f4d\u7f6e\u8fdb\u884c\u5b9a\u4f4d\u3002</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;style type=\"text/css\"&gt;\n            /*         #div1{\n            position: relative;\n            } */\n            #div2{\n                position: absolute;\n                top: 100px;\n\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div style=\"width: 300px;height: 200px;background-color: gray\"&gt;&lt;/div&gt;\n        &lt;div id=\"div1\" style=\"width: 300px;height: 200px;background-color: green\"&gt;\n            &lt;div id=\"div2\" style=\"width: 300px;height: 100px;background-color: red\"&gt;&lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#25-sticky","title":"2.5 sticky","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;style type=\"text/css\"&gt;\n            #div2{\n                position: -webkit-sticky;\n                position: sticky;\n                top: 0;\n            }\n        &lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"div1\" style=\"height: 200px;background-color: gray\"&gt;&lt;/div&gt;\n        &lt;div id=\"div2\" style=\"height: 100px;background-color: green\"&gt;&lt;/div&gt;\n        &lt;div id=\"div3\" style=\"height: 800px;background-color: gray\"&gt;&lt;/div&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#_4","title":"\u516d\u3001\u5bfc\u822a\u680f","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;\u6211\u7684\u4e3b\u9875&lt;/title&gt;\n    &lt;style type=\"text/css\"&gt;\n        /* \u5168\u5c40\u8bbe\u7f6e\uff0c\u53d6\u6d88\u5916\u8fb9\u6846 */\n        * {\n            margin: 0;\n            padding: 0;\n        }\n        /* \u9876\u90e8\u7684\u9ad8\u5ea6 \u548c\u80cc\u666f\u989c\u8272*/\n        .head{\n            height: 44px;\n            background-color: #2459a2;\n        }\n        .head-content {\n            position: relative;\n            margin: auto;\n            width: 1024px;\n            height: 44px;\n            line-height: 44px;\n            background-color: #2459a2;\n            /* background-color: red; */\n        }\n\n        .menu {\n            margin-left: 50px;\n        }\n\n\n        .menu ul li, .login a{\n            list-style-type: none;\n            display: inline-block;\n            float: left;\n            padding: 0 15px;    \n\n        }\n\n        .head-content a{\n            text-decoration: none;    \n            color: white;\n        }\n\n        .active{\n            background-color: #006400;\n        }\n\n        .menu li:hover:not(.active),.login a:hover{\n                background-color: gray;\n        }\n\n        .login {\n            /* background-color: blue; */\n            float: right;\n            margin-right: 50px;\n        }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"head\"&gt;\n        &lt;div class=\"head-content\"&gt;\n            &lt;div class=\"menu\"&gt;\n                &lt;ul&gt;\n                    &lt;li class=\"active\" &gt;&lt;a href=\"#home\"&gt;\u4e3b\u9875&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#news\"&gt;\u65b0\u95fb&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#blog\"&gt;\u535a\u5ba2&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#bbs\"&gt;\u8bba\u575b&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#contact\"&gt;\u8054\u7cfb&lt;/a&gt;&lt;/li&gt;\n                    &lt;li&gt;&lt;a href=\"#about\"&gt;\u5173\u4e8e&lt;/a&gt;&lt;/li&gt;    \n                &lt;/ul&gt;                                    \n            &lt;/div&gt;\n            &lt;div class=\"login\"&gt;\n                &lt;a href=\"#login\"&gt;\u6ce8\u518c&lt;/a&gt;\n                &lt;a href=\"#register\"&gt;\u767b\u5f55&lt;/a&gt;    \n            &lt;/div&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/CSS/#_5","title":"\u4e03\u3001\u4e0b\u62c9\u83dc\u5355","text":""},{"location":"programming/JavaScript/","title":"JavaScript","text":"<p><code>JavaScript</code>\u662f\u4e00\u79cd\u89e3\u91ca\u6027\u7684\u3001\u8de8\u5e73\u53f0\u7684\u3001\u57fa\u4e8e\u5bf9\u8c61\u7684\u811a\u672c\u8bed\u8a00\uff0c\u4e00\u822c\u7528\u4e8e\u5ba2\u6237\u7aef\u6765\u7ed9HTML\u9875\u9762\u589e\u52a0\u52a8\u6001\u7684\u529f\u80fd\u3002</p> <p>\u7ec4\u6210\uff1a</p> <ol> <li>ECMAScript\uff0c\u63cf\u8ff0\u4e86\u8be5\u8bed\u8a00\u7684\u8bed\u6cd5\u548c\u57fa\u672c\u5bf9\u8c61</li> <li>DOM \u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff0c\u63cf\u8ff0\u5904\u7406\u7f51\u9875\u5185\u5bb9\u7684\u65b9\u6cd5\u548c\u63a5\u53e3</li> <li>BOM \u6d4f\u89c8\u5668\u5bf9\u8c61\u6a21\u578b\uff0c\u63cf\u8ff0\u4e0e\u6d4f\u89c8\u5668\u8fdb\u884c\u4ea4\u4e92\u7684\u65b9\u6cd5\u548c\u63a5\u53e3\u3002</li> </ol>"},{"location":"programming/JavaScript/#javascript","title":"\u4e00\u3001JavaScript","text":""},{"location":"programming/JavaScript/#1-js","title":"1. js\u7684\u5f15\u5165\u65b9\u5f0f","text":"<ol> <li>\u653e\u5728HTML\u7684\u90e8\u5206 <li>\u653e\u5728HTML\u7684\u90e8\u5206 <li>\u4ece\u5916\u90e8\u6587\u4ef6\u5f15\u5165</li> <pre><code>&lt;script src=\"myScript.js\"&gt;&lt;/script&gt;\n</code></pre>"},{"location":"programming/JavaScript/#2","title":"2. \u53d8\u91cf","text":""},{"location":"programming/JavaScript/#1","title":"1. \u53d8\u91cf\u7684\u58f0\u660e","text":"<ol> <li>\u4f7f\u7528\u201cvar\u201d\u5173\u952e\u5b57\u6765\u58f0\u660e\u53d8\u91cf</li> <li>\u58f0\u660e\u65f6\u8d4b\u503c<code>var x=1</code></li> <li>\u6216\u5148\u58f0\u660e\u540e\u8d4b\u503c\uff1a<code>var x; x=1</code></li> <li>\u5bf9\u4e8e\u6ca1\u6709\u8d4b\u503c\u7684\u53d8\u91cf\uff0c\u5176\u503c\u4e3a\uff1a<code>undefined</code></li> </ol>"},{"location":"programming/JavaScript/#2_1","title":"2. \u53d8\u91cf\u7684\u547d\u540d\u89c4\u5219","text":"<p>\u82f1\u6587\u5b57\u6bcd\u3001\u6570\u5b57\u3001\u4e0b\u5212\u7ebf</p>"},{"location":"programming/JavaScript/#3","title":"3. \u53d8\u91cf\u540d\u683c\u5f0f","text":"<ol> <li>\u5308\u7259\u5229\u547d\u540d\u6cd5\uff1a\u53d8\u91cf\u540d=\u7c7b\u578b+\u5bf9\u8c61\u63cf\u8ff0 <code>var sname=\"hello\"; var nage=18</code></li> <li>\u9a7c\u5cf0\u547d\u540d\u6cd5</li> <li>\u5168\u90e8\u5c0f\u5199\uff0c\u5355\u8bcd\u7528\u4e0b\u5212\u7ebf\u5206\u5272</li> <li>\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u5927\u5199</li> <li>\u9996\u5b57\u6bcd\u5c0f\u5199\uff0c\u5176\u4ed6\u5355\u8bcd\u9996\u5b57\u6bcd\u5927\u5199</li> </ol>"},{"location":"programming/JavaScript/#4","title":"4. \u4f5c\u7528\u57df","text":"<ol> <li>\u5c40\u90e8\u4f5c\u7528\u57df\uff1a\u51fd\u6570\u5185\u90e8\u5b9a\u4e49</li> <li>\u5168\u5c40\u4f5c\u7528\u57df\uff1a\u51fd\u6570\u5916\u5b9a\u4e49</li> <li>\u4f18\u5148\u7ea7\uff1a\u5c40\u90e8\u53d8\u91cf&gt;\u5168\u5c40\u53d8\u91cf</li> </ol>"},{"location":"programming/JavaScript/#3_1","title":"3. \u8fd0\u7b97\u7b26","text":""},{"location":"programming/JavaScript/#31-","title":"3.1 \u7b97\u6570\u8fd0\u7b97\u7b26 <code>+ - * % ++ --</code>","text":"<pre><code>/*\nvar a=1\nb = a++    //\u5148\u8d4b\u503c\u540e\u52a0\u51cf\nalert(b)  //b=1\nalert(a)  //a=2\n*/\n/*\nvar a=1\n b=++a    //\u5148\u52a0\u51cf\u540e\u8d4b\u503c\nalert(b) //b=2\nalert(a) //a=2\n*/\n/*\nvar x=1\nalert(x++)   x=x+1  \u5148\u8d4b\u503c\uff0cx=1  alert\u7ed3\u679c\u4e3a1 \uff0c\u6267\u884c\u5b8c\u6210\u540ex=2\nalert(++x)   \u6b64\u65f6x=2\uff0c\u5148\u52a0\u51cf\u540e\u8d4b\u503c\uff0calert\u7ed3\u679c\u4e3a3  x=3\nalert(--x)   \u5148\u52a0\u51cf\uff0c\u540e\u8d4b\u503c\uff0c\u6b64\u65f6alert\u7ed3\u679c\u4e3a2\nalert(x--)\n*/                            \n</code></pre>"},{"location":"programming/JavaScript/#32-","title":"3.2 \u8d4b\u503c\u8fd0\u7b97\u7b26 <code>+=\u3001-=\u3001 *=\u3001 /=\u3001 %=</code>","text":""},{"location":"programming/JavaScript/#33","title":"3.3 \u5173\u7cfb\u8fd0\u7b97\u7b26 <code>==\u3001!=\u3001===</code>","text":"<pre><code>alert(2==\"2\")  --&gt; true\nalert(2===\"2\")  --&gt;flase\n===\u4e0d\u8fdb\u884c\u6570\u636e\u8f6c\u6362\uff0c\u76f4\u63a5\u8fdb\u884c\u6bd4\u8f83               \n</code></pre> <pre><code>var s=\"hello\"\nalert(typeof(s))\n// typeof:\u53ea\u80fd\u5224\u65ad\u57fa\u7840\u6570\u636e\u7c7b\u578b,\u5bf9\u4e8e\u5bf9\u8c61\u65e0\u6cd5\u51c6\u786e\u5224\u65ad\u5177\u4f53\u662f\u4ec0\u4e48\u5bf9\u8c61\nvar s2=new String(\"hello\")\nalert(typeof(s2))\nalert(s2 instanceof String);\n</code></pre>"},{"location":"programming/JavaScript/#34","title":"3.4 \u903b\u8f91\u8fd0\u7b97\u7b26 <code>\uff01\u3001&amp;&amp;\u3001||</code>","text":""},{"location":"programming/JavaScript/#35","title":"3.5 \u4f4d\u8fd0\u7b97\u7b26 <code>~\u3001&amp;\u3001|\u3001^\u3001&lt;&lt;\u3001&gt;&gt;</code>","text":""},{"location":"programming/JavaScript/#35_1","title":"3.5 \u4e00\u5143\u52a0\u51cf\u6cd5\uff1a","text":"<pre><code>&lt;!--\u4e00\u5143\u52a0\u51cf\u6cd5--&gt;\nvar a=3\nb=+a\nalert(b)\nalert(typeof(b))\n&lt;!--\u53ef\u4ee5\u5bf9\u6570\u636e\u7c7b\u578b\u8fdb\u884c\u8f6c\u6362--&gt;\nvar a=\"3\"\nb=+a\nalert(b)\nalert(typeof(b))\n&lt;!--\u6709\u975e\u6570\u5b57\u7c7b\u578b\uff0c\u8f6c\u6362\u5931\u8d25--&gt;\nvar a=\"3a\"\nb=+a\nalert(b)\nalert(typeof(b))\n</code></pre>"},{"location":"programming/JavaScript/#4_1","title":"4. \u57fa\u672c\u6570\u636e\u7c7b\u578b","text":"<ol> <li>number</li> <li>string</li> <li>Boolean</li> <li>null</li> <li>undefined</li> </ol>"},{"location":"programming/JavaScript/#5","title":"5. \u6d41\u7a0b\u8bed\u53e5","text":""},{"location":"programming/JavaScript/#51-while","title":"5.1 <code>while</code>","text":"<pre><code>&lt;script type=\"text/javascript\"&gt;\n    i=0\n    while (i&lt;5) {\n        // statement\n        console.log(i)\n        i++\n}\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/JavaScript/#52-do-while","title":"5.2 <code>do while</code>","text":"<pre><code>&lt;script type=\"text/javascript\"&gt;\n    i=0\n    do{  //\u81f3\u5c11\u6267\u884c\u4e00\u6b21\u5faa\u73af\n        console.log(i)\n        i++\n    } while (i&lt;5);\n&lt;/script&gt;        \n</code></pre>"},{"location":"programming/JavaScript/#53-for","title":"5.3 <code>for</code>","text":"<pre><code>&lt;script type=\"text/javascript\"&gt;\n    for (var i=0; i&lt;5; i++) {\n        console.log(i)\n    }\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/JavaScript/#54-for-in","title":"5.4 <code>for in</code>","text":"<pre><code>&lt;script type=\"text/javascript\"&gt;\n    for (i in [1,2,3,4]) {\n        console.log(i)\n    }\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/JavaScript/#55-if-else","title":"5.5 <code>if else</code>","text":"<pre><code>&lt;/html&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;title&gt;JavaScript&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n         &lt;script type=\"text/javascript\"&gt;\n            var d = new Date();\n            var time = d.getHours();\n            if (time&lt;10)\n            {\n                document.write(\"&lt;b&gt;\u65e9\u4e0a\u597d&lt;/b&gt;\");\n            }\n            else if (time&gt;=10 &amp;&amp; time&lt;14)\n            {\n                document.write(\"&lt;b&gt;\u4e2d\u5348\u597d&lt;/b&gt;\");\n            }\n            else\n            {\n                document.write(\"&lt;b&gt;\u4e0b\u5348\u597d!&lt;/b&gt;\");\n            }\n         &lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/JavaScript/#56-switch","title":"5.6 <code>switch</code>","text":"<pre><code> &lt;!DOCTYPE html&gt;\n &lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;title&gt;JavaScript&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n\n        &lt;button onclick=\"myFunction()\"&gt;\u4eca\u5929\u662f\u5468\u51e0\uff1f&lt;/button&gt;\n         &lt;p id=\"demo\"&gt;&lt;/p&gt;\n         &lt;script&gt;\n             function myFunction(){\n                 var x;\n                 var d=new Date().getDay();\n                 switch (d){\n                       case 0:x=\"\u4eca\u5929\u662f\u661f\u671f\u65e5\";\n                     break;\n                      case 1:x=\"\u4eca\u5929\u662f\u661f\u671f\u4e00\";\n                     break;\n                       case 2:x=\"\u4eca\u5929\u662f\u661f\u671f\u4e8c\";\n                     break;\n                     case 3:x=\"\u4eca\u5929\u662f\u661f\u671f\u4e09\";\n                         break;\n                       case 4:x=\"\u4eca\u5929\u662f\u661f\u671f\u56db\";\n                     break;\n                       case 5:x=\"\u4eca\u5929\u662f\u661f\u671f\u4e94\";\n                     break;\n                       case 6:x=\"\u4eca\u5929\u662f\u661f\u671f\u516d\";\n                     break;\n                  }\n                 document.getElementById(\"demo\").innerHTML=x;\n             }\n         &lt;/script&gt;\n    &lt;/body&gt;\n &lt;/html&gt;\n</code></pre>"},{"location":"programming/JavaScript/#57","title":"5.7 \u5f02\u5e38\u5904\u7406","text":"<pre><code>function func (argument) {\n    try {\n        console.log('hello')\n        if(true){\n            throw \"\u4e3b\u52a8\u629b\u51fa\u9519\u8bef\"\n        }\n    } catch(e) {\n        alert(e);\n    } finally {\n         console.log(\"\u6267\u884c\u5b8c\u6bd5\")\n    }\n}\nfunc()    \n</code></pre>"},{"location":"programming/JavaScript/#58continuebreakdefault","title":"5.8<code>continue</code>\u3001<code>break</code>\u3001<code>default</code>","text":""},{"location":"programming/JavaScript/#6","title":"6. \u5bf9\u8c61","text":""},{"location":"programming/JavaScript/#61-number","title":"6.1 Number","text":"<pre><code>var num=new Number(15)\nconsole.log(num)\nconsole.log(num.toString())   //\u6570\u5b57\u8f6c\u5b57\u7b26\u4e32\nconsole.log(num.toString(2))  //\u6570\u5b57\u8f6c2\u8fdb\u5236\nconsole.log(num.toString(8))    //\u6570\u5b57\u8f6c8\u8fdb\u5236\nconsole.log(num.toString(16))    //\u6570\u5b57\u8f6c16\u8fdb\u5236\n</code></pre>"},{"location":"programming/JavaScript/#62-string","title":"6.2 String","text":"<pre><code>var str1=new String(\"hello\");\nvar str2=\" world\";\n\n//\u5c5e\u6027\nconsole.log(str1.length); //\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\n// \u65b9\u6cd5\n//\u83b7\u53d6\u6307\u5b9a\u5b57\u7b26\u4e32\nconsole.log(str1.charAt('1')); //\u8fd4\u56de\u5728\u6307\u5b9a\u4f4d\u7f6e\u7684\u5b57\u7b26\u3002\n//\u67e5\u627e\nconsole.log(str1.indexOf('l')); //\u8fd4\u56de\u67d0\u4e2a\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\u503c\u5728\u5b57\u7b26\u4e32\u4e2d\u9996\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\nconsole.log(str1.lastIndexOf('l'));  //\u4ece\u540e\u5411\u524d\u641c\u7d22\u5b57\u7b26\u4e32\uff0c\u5e76\u4ece\u8d77\u59cb\u4f4d\u7f6e\uff080\uff09\u5f00\u59cb\u8ba1\u7b97\u8fd4\u56de\u5b57\u7b26\u4e32\u6700\u540e\u51fa\u73b0\u7684\u4f4d\u7f6e\u3002\nconsole.log(str1.replace('e','a')); //\u66ff\u6362\nconsole.log(str1.slice(1,3));  //\u5207\u7247[start,end)\nconsole.log(str1.substring(1,3))  //\u548cslice\u76f8\u540c\nconsole.log(str.split(\" \")); //\u628a\u5b57\u7b26\u4e32\u5206\u5272\u4e3a\u5b57\u7b26\u4e32\u6570\u7ec4\u3002\nconsole.log(str1.substr(1,3))  //\u4ece\u8d77\u59cb\u7d22\u5f15\u53f7\u63d0\u53d6\u5b57\u7b26\u4e32\u4e2d\u6307\u5b9a\u6570\u76ee\u7684\u5b57\u7b26 (index,num)\n//\u5927\u5c0f\u5199\u8f6c\u6362\nconsole.log(\"HELLO\".toLowerCase(str1))  //\u8f6c\u5c0f\u5199\nconsole.log(\"hello\".toUpperCase(str1))  //\u8f6c\u5927\u5199\n//\u7f16\u6392\u65b9\u6cd5\ndocument.write(s.italics());\ndocument.write(s.bold());\ndocument.write(s.anchor());    \nconsole.log(\" hello \".trim())  //\u53bb\u9664\u5b57\u7b26\u4e32\u4e24\u8fb9\u7684\u7a7a\u767d    \nvar str=str1.concat(str2);//\u5b57\u7b26\u4e32\u62fc\u63a5\nconsole.log(str);\n</code></pre>"},{"location":"programming/JavaScript/#63-array","title":"6.3 Array","text":"<pre><code>//\u58f0\u660e\nvar cars = [\"Volvo\",\"Saab\",\"BMW\"]; //\u65b9\u6cd5\u4e00\nvar arr1=[1,2,3,4]; //\u65b9\u6cd5\u4e8c\nvar arr3=new Array();  //\u65b9\u6cd5\u4e09\nvar arr4=new Array(3,);  //\u521d\u59cb\u5316\u4e00\u4e2a\u957f\u5ea6\u4e3a3\u7684\u6570\u7ec4\uff0c\u8be5\u6570\u7ec4\u53ef\u53d8\u957f\n//\u5c5e\u6027\nconsole.log(cars.length)\n//\u65b9\u6cd5\uff1a\n//\u63d2\u5165\u548c\u5220\u9664\nconsole.log([1,2,3].concat([4,5,6])) //\u6570\u5b57\u5408\u5e76\nconsole.log(cars.join(\"#\"))\nconsole.log(cars.pop()) //\u5220\u9664\u6700\u540e\u4e00\u4e2a\u5143\u7d20\nconsole.log(cars.push('jeep')) //\u6570\u7ec4\u7684\u672b\u5c3e\u6dfb\u52a0\u4e00\u4e2a\u6216\u66f4\u591a\u5143\u7d20\uff0c\u5e76\u8fd4\u56de\u65b0\u7684\u957f\u5ea6\nconsole.log(cars.shift()) //\u5220\u9664\u5e76\u8fd4\u56de\u6570\u7ec4\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\nconsole.log(cars.unshift('abc')) //\u5411\u6570\u7ec4\u7684\u5f00\u5934\u6dfb\u52a0\u4e00\u4e2a\u6216\u66f4\u591a\u5143\u7d20\uff0c\u5e76\u8fd4\u56de\u65b0\u7684\u957f\u5ea6\u3002\nconsole.log(cars)\n//\u6392\u5e8f\nconsole.log(cars.reverse()) //\u53cd\u8f6c\u6570\u7ec4\u987a\u5e8f\nconsole.log(cars.sort())  //\u6570\u7ec4\u6392\u5e8f\nconsole.log(cars.toString()) //\u6570\u7ec4\u8f6c\u5b57\u7b26\u4e32\n</code></pre>"},{"location":"programming/JavaScript/#64-boolean","title":"6.4 Boolean","text":"<pre><code>//\u65b9\u6cd5\nvar bool = new Boolean(1);\nconsole.log(bool.toString())\nconsole.log(bool.valueOf())\n</code></pre>"},{"location":"programming/JavaScript/#65-date","title":"6.5 Date","text":"<pre><code>//\u65f6\u95f4\u521b\u5efa\nvar today = new Date()\nvar d1 = new Date(\"October 13, 1975 11:13:00\")\nvar d2 = new Date(79,5,24)\nvar d3 = new Date(79,5,24,11,33,0)\n\nconsole.log(today)\nconsole.log(d1)\nconsole.log(d2)\nconsole.log(d3)\n//\u65b9\u6cd5\ny=today.getFullYear()\nm=today.getMonth()\nd=today.getDate()\nH=today.getHours()\nM=today.getMinutes()\nS=today.getSeconds()\n\nconsole.log(y+'\u5e74'+m+'\u6708' +d+'\u65e5'+\" \"+H+\":\"+M+\":\"+S)\nconsole.log(today.getTime()) \n</code></pre>"},{"location":"programming/JavaScript/#66-mtch","title":"6.6 Mtch","text":"<pre><code>console.log(Math.abs(-2))\nconsole.log(Math.max(1,3,5))\nconsole.log(Math.min(1,3,5))\nconsole.log(Math.random()) //[0.0,1.0)\u968f\u673a\u6570\nconsole.log(Math.round(2.5)); //\u56db\u820d\u4e94\u5165    \n</code></pre>"},{"location":"programming/JavaScript/#67-redexp","title":"6.7 RedExp","text":"<pre><code>//\u8bed\u6cd5\n// var patt=new RegExp(pattern,modifiers);\n// \u6216\u8005\u66f4\u7b80\u5355\u7684\u65b9\u5f0f:\n// var patt=/pattern/modifiers;\n/*    \n\u4fee\u9970\u7b26\ni    \u6267\u884c\u5bf9\u5927\u5c0f\u5199\u4e0d\u654f\u611f\u7684\u5339\u914d\u3002\ng    \u6267\u884c\u5168\u5c40\u5339\u914d\uff08\u67e5\u627e\u6240\u6709\u5339\u914d\u800c\u975e\u5728\u627e\u5230\u7b2c\u4e00\u4e2a\u5339\u914d\u540e\u505c\u6b62\uff09\u3002\nm    \u6267\u884c\u591a\u884c\u5339\u914d\u3002\n*/\nvar str=\"hello world\"\nconsole.log(str.search(\"o\")) //\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5339\u914d\u7684\u7d22\u5f15\u503c\nconsole.log(str.search(\"a\")) //\u6ca1\u627e\u5230\u8fd4\u56de-1\nconsole.log(str.match(/o/g));\nconsole.log(/hello/g.test(str))     \n</code></pre>"},{"location":"programming/JavaScript/#7","title":"7. \u51fd\u6570","text":""},{"location":"programming/JavaScript/#71","title":"7.1\u51fd\u6570\u521b\u5efa\u7684\u4e09\u79cd\u65b9\u6cd5","text":"<p>\u65b9\u6cd5\u4e00</p> <pre><code>function func (argument) {\n    return \"hello\"\n}\nconsole.log(func())\n</code></pre> <p>\u65b9\u6cd5\u4e8c\uff1a\u6784\u9020\u51fd\u6570 var func = new Function(\"\u53c2\u65701\", \"\u53c2\u65702\", \"\u51fd\u6570\u4f53\")</p> <pre><code>var func = new Function(\"a\",\"b\",\"return a+b\")\nconsole.log(func(1,2))\n</code></pre> <p>\u65b9\u6cd5\u4e09 \u533f\u540d\u51fd\u6570(\u51fd\u6570\u8868\u8fbe\u5f0f)</p> <pre><code>console.log(function(x,y){return x+y}(3,5))\n</code></pre>"},{"location":"programming/JavaScript/#72","title":"7.2 \u51fd\u6570\u8c03\u7528","text":"<p><code>this</code> \u5173\u952e\u5b57:\u4e00\u822c\u800c\u8a00\uff0c\u5728Javascript\u4e2d\uff0cthis\u6307\u5411\u51fd\u6570\u6267\u884c\u65f6\u7684\u5f53\u524d\u5bf9\u8c61\u3002</p> <pre><code>void()\n// void\u7684\u4f5c\u7528:\u963b\u62e6\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\nfunction f() {\n    return 8\n}\nalert(void(f()))\n</code></pre>"},{"location":"programming/JavaScript/#73","title":"7.3\u53c2\u6570","text":"<p>arguments\u5bf9\u8c61</p> <pre><code>//\u904d\u5386\u4f20\u5165\u7684\u53c2\u6570\nfunction func() {\n    for (var i = 0; i&lt;arguments.length; i++) {\n        console.log(arguments[i])\n    }\n}\nfunc(1,2,3,4,5)\n</code></pre>"},{"location":"programming/JavaScript/#dom","title":"\u4e8c\u3001DOM","text":""},{"location":"programming/JavaScript/#1_1","title":"1. \u4ecb\u7ecd","text":"<p>DOM \uff08Document Object Model\uff0c\u6587\u6863\u5bf9\u8c61\u6a21\u578b\uff09:W3C\u5b9a\u4e49\u7684\u8bbf\u95eeHTML\u548cXML\u6587\u6863\u7684\u6807\u51c6</p> <p>DOM\u7ec4\u6210\uff1a 1. \u6838\u5fc3DOM \uff1a\u9488\u5bf9\u4efb\u4f55\u7ed3\u6784\u5316\u6587\u6863\u7684\u6807\u51c6\u6a21\u578b 2. XML DOM \uff1a\u9488\u5bf9 XML \u6587\u6863\u7684\u6807\u51c6\u6a21\u578b 3. HTML DOM \uff1a\u9488\u5bf9 HTML \u6587\u6863\u7684\u6807\u51c6\u6a21\u578b</p>"},{"location":"programming/JavaScript/#2_2","title":"2.\u8282\u70b9","text":"<pre><code>1. \u6587\u6863\u8282\u70b9\n2. \u5143\u7d20\u8282\u70b9\n3. \u6587\u672c\u8282\u70b9\n4. \u5c5e\u6027\u8282\u70b9\n5. \u6ce8\u91ca\u8282\u70b9\n</code></pre>"},{"location":"programming/JavaScript/#3_2","title":"3. \u5c5e\u6027","text":""},{"location":"programming/JavaScript/#31","title":"3.1\u81ea\u8eab\u5c5e\u6027","text":"<ol> <li>nodeName</li> <li>nodeValue</li> <li>nodeType</li> </ol> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"h\"&gt;\n            &lt;p&gt;hello&lt;/p&gt;\n            &lt;p&gt;world&lt;/p&gt;\n        &lt;/div&gt;\n        &lt;script type=\"text/javascript\"&gt;\n            console.log(document.getElementById(\"h\").nodeName)\n            console.log(document.getElementById(\"h\").nodeValue)\n            console.log(document.getElementById(\"h\").nodeType)\n            console.log(document.getElementById(\"h\").innerHTML)\n        &lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/JavaScript/#32","title":"3.2\u5bfc\u822a\u5c5e\u6027","text":"<p>\u7b2c\u4e00\u7c7b\uff1a\u4e0d\u5efa\u8bae\u4f7f\u7528\uff0c\u5982\u679c\u4e24\u4e2a\u5143\u7d20\u4e4b\u95f4\u6709\u6587\u672c\uff08\u7a7a\u683c\u6216\u6362\u884c\uff09\u4f1a\u628a\u6587\u672c\u4f5c\u4e3a\u4e0b\u4e00\u4e2a\u5143\u7d20</p> <ol> <li>parentNode \u2606</li> <li>firstChild</li> <li>lastChild</li> <li>nextSibling</li> <li>previousSibling\u3000\u3000\u3000</li> </ol> <p>\u7b2c\u4e8c\u7c7b\uff1a\u5efa\u8bae\u4f7f\u7528</p> <p>1.getElementById(\"div1\") 2. firstElementChild 3. lastElementChild; 4. nextElementSibling;</p>"},{"location":"programming/JavaScript/#4_2","title":"4. \u5168\u5c40\u67e5\u627e\u4e0e\u5c40\u90e8\u67e5\u627e","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;title&gt;JavaScript&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;div id=\"div1\"&gt;\n            &lt;div class=\"div2\"&gt;hello&lt;/div&gt;\n            &lt;div class=\"div3\" name=\"name\"&gt;world\n                &lt;p&gt;\u4f60\u597d \u4e16\u754c\uff01&lt;/p&gt;\n                &lt;p class=\"ppp\"&gt;hello html&lt;/p&gt;\n            &lt;/div&gt;\n            &lt;p&gt;hello world&lt;/p&gt;\n        &lt;/div&gt;\n    &lt;script&gt;\n\n    // \u5168\u5c40\u67e5\u627e\n    // \u901a\u8fc7id\u67e5\u627e\n    var e=document.getElementById(\"div1\")\n    // \u901a\u8fc7class\u67e5\u627e\n    var ele=document.getElementsByClassName(\"div2\")[0] //\u7ed3\u679c\u662f\u4e00\u4e2a\u6570\u7ec4\n    var ele2=ele.nextElementSibling;\n    alert(ele2.innerHTML)\n    //\u901a\u8fc7\u6807\u7b7e\u67e5\u627e\n    var ele3=document.getElementsByTagName(\"p\");\n    alert(ele3[0].innerHTML)\n    //\u901a\u8fc7name\u67e5\u627e\n    ele4=document.getElementsByName(\"name\")\n    console.log(ele4[0].innerHTML)\n\n    //\u5c40\u90e8\u67e5\u627e\n    //\u901a\u8fc7tag\n    var ele5=document.getElementsByClassName(\"div3\");\n    var ele6=ele5[0].getElementsByTagName(\"p\")\n    console.log(ele6[0].innerHTML)\n    //\u901a\u8fc7class\n    var ele7=ele5[0].getElementsByClassName(\"ppp\")\n    console.log(ele7[0].innerHTML)\n\n    //\u4e0d\u53ef\u4ee5\u901a\u8fc7id\u548cname\u8fdb\u884c\u5c40\u90e8\u67e5\u627e\n    &lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html &gt;\n</code></pre>"},{"location":"programming/JavaScript/#5-dom","title":"5. DOM \u4fee\u6539\u3001\u6dfb\u52a0\u3001\u5220\u9664","text":""},{"location":"programming/JavaScript/#51html","title":"5.1\u521b\u5efaHTML\u5185\u5bb9\u5e76\u6539\u53d8\u6837\u5f0f","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p id=\"p1\"&gt;&lt;/p&gt;\n        &lt;script type=\"text/javascript\"&gt;\n            document.getElementById(\"p1\").innerHTML=\"hello world\" //\u521b\u5efa\u5185\u5bb9\n            document.getElementById(\"p1\").style.color = 'blue';  //\u66f4\u6539\u6837\u5f0f\n        &lt;/script&gt;\n    &lt;/body&gt;\n&lt;/html&gt;        \n</code></pre>"},{"location":"programming/JavaScript/#52-appendchild","title":"5.2 \u6dfb\u52a0\u65b0\u7684\u5143\u7d20:appendChild()","text":"<pre><code>&lt;script&gt;\n    //\u521b\u5efa &lt;p&gt; \u5143\u7d20:\n    var para = document.createElement(\"p\");\n    // &lt;p&gt; \u5143\u7d20\u6dfb\u52a0\u6587\u672c\u8282\u70b9\n    var node = document.createTextNode(\"\u8fd9\u662f\u4e00\u4e2a\u65b0\u7684\u6bb5\u843d\u3002\");\n    //\u5c06\u6587\u672c\u8282\u70b9\u6dfb\u52a0\u5230 &lt;p&gt; \u5143\u7d20\u4e2d\uff1a\n    para.appendChild(node);\n    //\u67e5\u627e\u5df2\u5b58\u5728\u7684\u5143\u7d20\n    var element = document.getElementById(\"div1\");\n    //\u6dfb\u52a0\u5230\u5df2\u5b58\u5728\u7684\u5143\u7d20\u4e2d:\n    element.appendChild(para);\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/JavaScript/#53-insertbefore","title":"5.3 \u63d2\u5165\u5230\u5df2\u6709\u5143\u7d20\u4e4b\u524d<code>insertBefore()</code>","text":""},{"location":"programming/JavaScript/#54-removechild","title":"5.4 \u79fb\u9664\u5143\u7d20:<code>removeChild()</code>","text":""},{"location":"programming/JavaScript/#55-replacechild","title":"5.5 \u66ff\u6362\u5143\u7d20:<code>replaceChild()</code>","text":""},{"location":"programming/JavaScript/#6_1","title":"6.\u4e8b\u4ef6","text":""},{"location":"programming/JavaScript/#61","title":"6.1 \u9f20\u6807\u4e8b\u4ef6","text":"<pre><code>&lt;p onclick=\"alert('\u5355\u51fb')\"&gt;\u5355\u51fb\u9f20\u6807&lt;/p&gt;\n&lt;p ondblclick=\"alert('\u53cc\u51fb')\"&gt;\u53cc\u51fb\u9f20\u6807&lt;/p&gt;\n&lt;p onmousedown=\"alert('\u9f20\u6807\u6309\u4e0b')\"&gt;\u9f20\u6807\u6309\u4e0b&lt;/p&gt;\n&lt;p onmouseup=\"alert('\u9f20\u6807\u677e\u5f00')\"&gt;\u9f20\u6807\u677e\u5f00&lt;/p&gt;\n&lt;p onmouseover=\"alert('\u653e\u4e0a\u9f20\u6807')\"&gt;\u9f20\u6807\u79fb\u5230\u5143\u7d20\u4e4b\u4e0a\u3002&lt;/p&gt;\n&lt;p onmouseout=\"alert('\u79fb\u5f00\u9f20\u6807')\"&gt;\u9f20\u6807\u79fb\u5f00&lt;/p&gt;\n</code></pre>"},{"location":"programming/JavaScript/#62","title":"6.2 \u6846\u67b6/\u5bf9\u8c61\u4e8b\u4ef6","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt;&lt;/title&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;script type=\"text/javascript\"&gt;\n            window.onload=function () {\n                //\u628ajs\u4ee3\u7801\u5199\u5728\u5934\u90e8\uff0c\u7b49\u9875\u9762\u52a0\u8f7d\u5b8c\u4e4b\u540e\u6267\u884c\n            }\n        &lt;/script&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;/body&gt;\n&lt;/html&gt;        \n</code></pre>"},{"location":"programming/JavaScript/#63","title":"6.3 \u8868\u5355\u4e8b\u4ef6","text":"<ol> <li> <p>onfocus\u4e0eonblur</p> </li> <li> <p>onsubmit</p> </li> <li> <p>onchange</p> </li> </ol>"},{"location":"programming/JavaScript/#bombrowser-object-model","title":"\u4e09\u3001BOM\uff08Browser Object Model\uff0c\u6d4f\u89c8\u5668\u5bf9\u8c61\u6a21\u578b\uff09","text":""},{"location":"programming/JavaScript/#1-window","title":"1. Window\u5bf9\u8c61","text":"<p>\u8868\u793a\u6d4f\u89c8\u5668\u7a97\u53e3</p> <p><pre><code>    \u5c5e\u6027\uff1a\n    &lt;script&gt;\n    var w=window.innerWidth\n    || document.documentElement.clientWidth\n    || document.body.clientWidth;\n    var h=window.innerHeight\n    || document.documentElement.clientHeight\n    || document.body.clientHeight;\n    x=document.getElementById(\"demo\");\n    x.innerHTML=\"\u6d4f\u89c8\u5668window\u5bbd\u5ea6: \" + w + \", \u9ad8\u5ea6: \" + h + \"\u3002\"\n    &lt;/script&gt;    \n    \u65b9\u6cd5\uff1a\n    window.alert(\"sometext\");\n</code></pre>  window.confirm(\"sometext\"); \u4f8b\uff1a<code>r=window.confirm(\"\u662f\u5426\u53d6\u6d88\uff1f\")</code></p> <p>\u8ba1\u65f6\u4e8b\u4ef6</p> <ol> <li>setInterval</li> <li>clearInterval</li> <li>setTimeout</li> <li>clearTimeout</li> </ol>"},{"location":"programming/JavaScript/#2-screen","title":"2. Screen\u5bf9\u8c61","text":"<pre><code>&lt;script&gt;\n    document.write(\"\u603b\u5bbd\u5ea6/\u9ad8\u5ea6: \");\n    document.write(screen.width + \"*\" + screen.height);\n    document.write(\"&lt;br&gt;\");\n    document.write(\"\u53ef\u7528\u5bbd\u5ea6/\u9ad8\u5ea6: \");\n    document.write(screen.availWidth + \"*\" + screen.availHeight);\n    document.write(\"&lt;br&gt;\");\n    document.write(\"\u8272\u5f69\u6df1\u5ea6: \");\n    document.write(screen.colorDepth);\n    document.write(\"&lt;br&gt;\");\n    document.write(\"\u8272\u5f69\u5206\u8fa8\u7387: \");\n    document.write(screen.pixelDepth);\n&lt;/script&gt;        \n</code></pre>"},{"location":"programming/JavaScript/#3-location","title":"3. Location\u5bf9\u8c61","text":"<pre><code>location.hostname \u8fd4\u56de web \u4e3b\u673a\u7684\u57df\u540d\nlocation.pathname \u8fd4\u56de\u5f53\u524d\u9875\u9762\u7684\u8def\u5f84\u548c\u6587\u4ef6\u540d\nlocation.port \u8fd4\u56de web \u4e3b\u673a\u7684\u7aef\u53e3 \uff0880 \u6216 443\uff09\nlocation.protocol \u8fd4\u56de\u6240\u4f7f\u7528\u7684 web \u534f\u8bae\uff08http:// \u6216 https://\uff09\nlocation.href \u5c5e\u6027\u8fd4\u56de\u5f53\u524d\u9875\u9762\u7684 URL\u3002\nlocation.pathname \u5c5e\u6027\u8fd4\u56de URL \u7684\u8def\u5f84\u540d\u3002\nlocation.assign() \u65b9\u6cd5\u52a0\u8f7d\u65b0\u7684\u6587\u6863\u3002\nlocation.reload() \u5237\u65b0\n</code></pre>"},{"location":"programming/JavaScript/#4-history","title":"4. History\u5bf9\u8c61","text":"<pre><code>history.length    \u8fd4\u56de\u5386\u53f2\u5217\u8868\u4e2d\u7684\u7f51\u5740\u6570\nhistory.back()    \u52a0\u8f7d history \u5217\u8868\u4e2d\u7684\u524d\u4e00\u4e2a URL\nhistory.forward()    \u52a0\u8f7d history \u5217\u8868\u4e2d\u7684\u4e0b\u4e00\u4e2a URL\nhistory.go(Number|URL)    \u52a0\u8f7d history \u5217\u8868\u4e2d\u7684\u67d0\u4e2a\u5177\u4f53\u9875\u9762\n</code></pre>"},{"location":"programming/html/","title":"\u4e00\u3001HTML","text":""},{"location":"programming/html/#_1","title":"\u4e00\u3001\u57fa\u672c\u6982\u5ff5","text":"<ol> <li>HTML\uff1a\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\uff08HyperText Markup Language\uff09\u662f\u4e00\u79cd\u7528\u4e8e\u521b\u5efa\u7f51\u9875\u7684\u6807\u51c6\u6807\u8bb0\u8bed\u8a00\u3002</li> <li>HTML\u6587\u6863\u7684\u540e\u7f00\u540d\uff1a.html \u6216 .htm</li> <li>\u6807\u7b7e\uff1a\u7531\u5c16\u62ec\u53f7\u5305\u56f4\u7684\u5173\u952e\u8bcd\uff0c\u6bd4\u5982 <code>&lt;html&gt;</code></li> <li>\u5143\u7d20\uff1a\u4ece\u5f00\u59cb\u6807\u7b7e\uff08start tag\uff09\u5230\u7ed3\u675f\u6807\u7b7e\uff08end tag\uff09\u7684\u6240\u6709\u4ee3\u7801\u3002\u6bd4\u5982\uff1a<code>&lt;p&gt;hello world&lt;/p&gt;</code></li> <li>\u7a7a\u5143\u7d20\uff1a\u5728\u5f00\u59cb\u6807\u7b7e\u4e2d\u8fdb\u884c\u5173\u95ed\u3002\u4f8b\u5982\uff1a\u6362\u884c <code>&lt;br/&gt;</code></li> <li>\u57fa\u672c\u683c\u5f0f\uff1a</li> </ol> <pre><code>&lt;!DOCTYPE html&gt; &lt;!--\u58f0\u660eHTML5\u6587\u6863--&gt;\n&lt;html&gt;  &lt;!--\u6839\u5143\u7d20--&gt;\n    &lt;head&gt;\n            &lt;!-- \u5143\u6570\u636e --&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n            &lt;!-- \u9875\u9762\u5185\u5bb9 --&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>7.\u6ce8\u91ca\u683c\u5f0f\uff1a</p> <pre><code>&lt;!-- \u6ce8\u91ca\u5185\u5bb9 --&gt;\n</code></pre>"},{"location":"programming/html/#html_1","title":"\u4e8c\u3001HTML\u5c5e\u6027","text":"<p>\u5c5e\u6027\u53ef\u4ee5\u5728\u5143\u7d20\u4e2d\u6dfb\u52a0\u9644\u52a0\u4fe1\u606f\uff0c\u4e00\u822c\u4f4d\u4e8e\u5f00\u59cb\u6807\u7b7e\uff0c\u4ee5\u952e\u503c\u5bf9\u7684\u5f62\u5f0f\u5b58\u5728\u3002</p> <p>\u4f8b\u5982\uff1a<code>&lt;a href=\"http://www.baidu.com\"&gt;\u767e\u5ea6\u4e00\u4e0b&lt;/a&gt;</code></p> <p>\u5e38\u7528\u5c5e\u6027\uff1a</p> <ol> <li>class  \u4e3ahtml\u5143\u7d20\u5b9a\u4e49\u4e00\u4e2a\u6216\u591a\u4e2a\u7c7b\u540d\uff08classname\uff09(\u7c7b\u540d\u4ece\u6837\u5f0f\u6587\u4ef6\u5f15\u5165)</li> <li>id     \u5b9a\u4e49\u5143\u7d20\u7684\u552f\u4e00id</li> <li>style \u89c4\u5b9a\u5143\u7d20\u7684\u884c\u5185\u6837\u5f0f\uff08inline style\uff09</li> <li>title \u63cf\u8ff0\u4e86\u5143\u7d20\u7684\u989d\u5916\u4fe1\u606f (\u4f5c\u4e3a\u5de5\u5177\u6761\u4f7f\u7528)</li> </ol>"},{"location":"programming/html/#head","title":"\u4e09\u3001<code>&lt;head&gt;</code>\u6807\u7b7e","text":""},{"location":"programming/html/#1title","title":"1.<code>&lt;title&gt;</code>","text":"<pre><code>&lt;title&gt;\u6211\u662f\u6807\u9898&lt;/title&gt;\n</code></pre> <p><code>&lt;title&gt;</code>\u6807\u7b7e\u7684\u4f5c\u7528\uff1a</p> <p>1.\u663e\u793a\u5728\u6d4f\u89c8\u5668\u5de5\u5177\u680f\u4e0a 2.\u7f51\u9875\u88ab\u6536\u85cf\u65f6\u9ed8\u8ba4\u7684\u540d\u5b57</p>"},{"location":"programming/html/#2base-html","title":"2.<code>&lt;base&gt;</code> \u6307\u5b9a\u4e86HTML\u6587\u6863\u4e2d\u6240\u6709\u7684\u94fe\u63a5\u6807\u7b7e\u7684\u9ed8\u8ba4\u94fe\u63a5:","text":""},{"location":"programming/html/#3link","title":"3.<code>&lt;link&gt;</code> \u94fe\u63a5\u5230\u6837\u5f0f\u8868","text":"<p>\u4f8b\uff1a\u4ece\u5916\u90e8\u6587\u4ef6\u5f15\u5165css\u6837\u5f0f</p> <pre><code>&lt;link rel=\"stylesheet\" type=\"text/css\" href=\"css.css\"&gt;\n</code></pre>"},{"location":"programming/html/#4style-css","title":"4.<code>&lt;style&gt;</code> \u6dfb\u52a0css\u6837\u5f0f","text":"<p>5.<code>&lt;meta&gt;</code> \u5143\u6570\u636e</p> <p>5.1 \u4e3a\u641c\u7d22\u5f15\u64ce\u6dfb\u52a0\u5173\u952e\u8bcd\uff0c\u901a\u8fc7\u6d4f\u89c8\u5668\u641c\u7d22\u8fd9\u4e9b\u5173\u952e\u8bcd\u5c31\u80fd\u627e\u5230\u8fd9\u4e2aHTML\u6587\u6863</p> <p>\u4f8b\uff1a</p> <pre><code>&lt;meta name=\"keywords\" content=\"HTML, CSS, XML, XHTML, JavaScript\"&gt;\n</code></pre> <p>5.2 \u63cf\u8ff0\u7f51\u9875\u7684\u5185\u5bb9</p> <p>\u4f8b\uff1a</p> <pre><code>&lt;meta name=\"keywords\" content=\"HTML, CSS, XML, XHTML, JavaScript\"&gt;\n</code></pre> <p>5.3 \u5b9a\u4e49\u7f51\u9875\u7684\u4f5c\u8005</p> <p>\u4f8b\uff1a</p> <pre><code>&lt;meta name=\"author\" content=\"Name\"&gt;\n</code></pre> <p>5.4 \u7f16\u7801\u683c\u5f0f</p> <p>\u4f8b\uff1a</p> <pre><code>&lt;meta charset=\"utf-8\"&gt;\n</code></pre> <p>6.<code>&lt;script&gt;</code> \u5b9a\u4e49JavaScript\u811a\u672c</p>"},{"location":"programming/html/#body","title":"\u56db\u3001<code>&lt;body&gt;</code>\u6807\u7b7e","text":"<p>1.<code>&lt;h&gt;</code> \u6807\u7b7e\uff1a\u6807\u9898</p> <p>6\u4e2a\u7ea7\u522b\uff1a<code>&lt;h1&gt; - &lt;h6&gt;</code></p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;    &lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;\u6807\u98981&lt;/h1&gt;\n    &lt;h2&gt;\u6807\u98982&lt;/h2&gt;\n    &lt;h3&gt;\u6807\u98983&lt;/h3&gt;\n    &lt;h4&gt;\u6807\u98984&lt;/h4&gt;\n    &lt;h5&gt;\u6807\u98985&lt;/h5&gt;\n    &lt;h6&gt;\u6807\u98986&lt;/h6&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>2.<code>&lt;hr&gt;</code> \u6807\u7b7e:\u6c34\u5e73\u7ebf</p> <p>3.<code>&lt;br&gt;</code> \u6807\u7b7e:\u6362\u884c</p> <p>4.<code>&lt;p&gt;</code> \u6807\u7b7e\uff1a\u6bb5\u843d</p> <p>5.\u6587\u672c\u683c\u5f0f\u5316</p> <pre><code>&lt;b&gt;\u52a0\u7c97\u6587\u672c&lt;/b&gt;&lt;br&gt;\n&lt;strong&gt;\u52a0\u7c97\u6587\u672c&lt;/strong&gt;&lt;br&gt;\n&lt;big&gt;\u6587\u672c\u653e\u5927&lt;/big&gt;&lt;br&gt;\n&lt;small&gt;\u6587\u672c\u7f29\u5c0f&lt;/small&gt;&lt;br&gt;\n&lt;i&gt;\u659c\u4f53\u6587\u672c&lt;/i&gt;&lt;br&gt;\n&lt;em&gt;\u659c\u4f53\u6587\u672c&lt;/em&gt;&lt;br&gt;\n&lt;sub&gt;\u4e0b&lt;/sub&gt;\u6807&lt;br&gt;\n\u6807&lt;sup&gt;\u4e0a&lt;/sup&gt;&lt;br&gt;\n&lt;pre&gt;\u7a7a   \u683c&lt;/pre&gt;\n&lt;del&gt;\u5220\u9664\u6548\u679c&lt;/del&gt;\n\n&lt;!-- \u8ba1\u7b97\u673a/\u7f16\u7a0b\u4ee3\u7801\u6837\u5f0f --&gt;\n&lt;code&gt;\u8ba1\u7b97\u673a\u8f93\u51fa&lt;/code&gt;&lt;br&gt;\n&lt;kbd&gt;\u952e\u76d8\u8f93\u5165&lt;/kbd&gt;&lt;br&gt;\n&lt;tt&gt;\u6253\u5b57\u673a\u6587\u672c&lt;/tt&gt;&lt;br&gt;\n&lt;samp&gt;\u8ba1\u7b97\u673a\u4ee3\u7801\u6837\u672c&lt;/samp&gt;&lt;br&gt;\n&lt;var&gt;\u8ba1\u7b97\u673a\u53d8\u91cf&lt;/var&gt;&lt;br&gt;\n\n&lt;address&gt;\n    \u5730\u5740\uff1a\u77f3\u5bb6\u5e84 \u6cb3\u5317 \u4e2d\u56fd\n&lt;/address&gt;\n&lt;p&gt;&lt;bdo dir=\"rtl\"&gt;\u5012\u53d9\u663e\u793a&lt;/bdo&gt;&lt;/p&gt;\n</code></pre> <p>6.<code>&lt;a&gt;</code> \u6807\u7b7e\uff1a\u94fe\u63a5</p> <pre><code>&lt;a href=\"http://www.baidu.com\"&gt;\u767e\u5ea6\u4e00\u4e0b&lt;/a&gt;\n</code></pre> <p>\u5c5e\u6027\uff1a\u5728\u65b0\u7a97\u53e3\u6253\u5f00</p> <pre><code>&lt;a href=\"http://www.baidu.com/\" target=\"_blank\"&gt;\u767e\u5ea6\u4e00\u4e0b&lt;/a&gt;\n</code></pre> <p><code>&lt;a&gt;</code>\u6807\u7b7e\u7684\u4f5c\u7528\uff1a</p> <ol> <li>\u94fe\u63a5\uff1a\u767e\u5ea6\u4e00\u4e0b</li> <li>\u951a\uff1a\u8f6c\u5230id\u4e3atips\u7684\u90e8\u5206</li> </ol> <p>7.<code>&lt;img&gt;</code> \u6807\u7b7e\uff1a\u56fe\u50cf</p> <pre><code>&lt;img src=\"mayun.jpg\" title=\"\u9a6c\u4e91\" alt=\"Ma Yun\" height=\"140\" width=\"121\" &gt;\n</code></pre> <p>title\u5c5e\u6027\uff1a\u5f53\u9f20\u6807\u653e\u5728\u56fe\u7247\u4e0a\u7684\u65f6\u5019\u663e\u793a\u7684\u5185\u5bb9 alt \u5c5e\u6027\uff1a\u5f53\u56fe\u7247\u52a0\u8f7d\u5931\u8d25\u7684\u65f6\u5019\u663e\u793a\u7684\u5c5e\u6027 height width\u5c5e\u6027\uff1a\u8bbe\u7f6e\u56fe\u7247\u7684\u9ad8\u548c\u5bbd</p> <p>8.<code>&lt;table&gt;</code> \u6807\u7b7e\uff1a\u8868\u683c</p> <pre><code>    &lt;table border=\"1\"&gt;\n        &lt;caption&gt;\u8868\u683c\u6807\u9898&lt;/caption&gt;\n        &lt;tr&gt;\n            &lt;th&gt;\u59d3\u540d&lt;/th&gt;\n            &lt;th&gt;\u6027\u522b&lt;/th&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;\u66f9\u64cd&lt;/td&gt;\n            &lt;td&gt;\u7537&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;\u8c82\u8749&lt;/td&gt;\n            &lt;td&gt;\u5973&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n</code></pre> <p>\u5e38\u7528\u6807\u7b7e:</p> <ol> <li><code>&lt;table&gt;</code> \u5b9a\u4e49\u8868\u683c</li> <li><code>&lt;caption&gt;</code> \u5b9a\u4e49\u8868\u683c\u6807\u9898</li> <li><code>&lt;th&gt;</code> \u5b9a\u4e49\u8868\u5934(\u6587\u672c\u52a0\u7c97)</li> <li><code>&lt;tr&gt;</code> \u5b9a\u4e49\u884c</li> <li><code>&lt;td&gt;</code> \u5b9a\u4e49\u5185\u5bb9</li> </ol> <p>\u5e38\u7528\u5c5e\u6027\uff1a</p> <ol> <li>border=\"1\" \u5b9a\u4e49\u8868\u683c\u8fb9\u6846</li> <li>colspan=\"2\" \u8de82\u884c</li> <li>rowspan=\"2\" \u8de82\u5217</li> </ol>"},{"location":"programming/html/#9-ul-ol","title":"9 <code>&lt;ul&gt;</code> <code>&lt;ol&gt;</code> \u6807\u7b7e\uff1a\u5217\u8868","text":"<p>9.1 <code>&lt;ul&gt;</code> \u65e0\u5e8f\u5217\u8868\uff1a\u7528\u70b9\u6807\u8bb0\u987a\u5e8f</p> <pre><code>       &lt;ul&gt;\n       \u3000\u3000 &lt;li&gt;\u5496\u5561&lt;/li&gt;\n       \u3000\u3000 &lt;li&gt;\u725b\u5976&lt;/li&gt;\n    \u3000\u3000&lt;/ul&gt;\n</code></pre> <p>9.2 <code>&lt;ol&gt;</code> \u6709\u5e8f\u5217\u8868\uff1a\u7528\u963f\u62c9\u4f2f\u6570\u5b57\u6807\u8bb0\u987a\u5e8f</p> <pre><code>    &lt;ol&gt;\n        &lt;li&gt;\u7eff\u8336&lt;/li&gt;\n        &lt;li&gt;\u7ea2\u8336&lt;/li&gt;\n    &lt;/ol&gt;\n</code></pre> <p><code>&lt;ol&gt;</code> \u5c5e\u6027\uff1atype=\"A\"|\"a\"|\"I\"|\"i\"</p> <p>9.3 <code>&lt;dl&gt;</code> \u81ea\u5b9a\u4e49\u5217\u8868</p> <pre><code>    &lt;dl&gt;\n        &lt;dt&gt;\u4e00\u7ea7\u5185\u5bb9&lt;/dt&gt;\n        &lt;dd&gt;\u4e8c\u7ea7\u5185\u5bb9&lt;/dd&gt;\n    &lt;/dl&gt;\n</code></pre> <p>10.<code>&lt;div&gt;</code> \u6807\u7b7e</p> <p><code>&lt;div&gt;</code> \u5143\u7d20\u6ca1\u6709\u7279\u5b9a\u7684\u542b\u4e49\uff0c\u5e38\u7528\u4e8e\u6587\u6863\u5e03\u5c40\u3002</p> <p>11.<code>&lt;span&gt;</code> \u6807\u7b7e \u6ca1\u6709\u7279\u5b9a\u7684\u542b\u4e49\uff0c\u7528\u4e8e\u4e3a\u90e8\u5206\u6587\u672c\u8bbe\u7f6e\u6837\u5f0f\u5c5e\u6027</p> <p>12.<code>&lt;form&gt;</code> \u6807\u7b7e:\u8868\u5355</p> <p>12.1 <code>&lt;input&gt;</code></p> <pre><code>\u3000\u3000\u3000\u3000&lt;form&gt;\n\u3000\u3000\u3000\u3000\u3000&lt;!-- \u6587\u672c --&gt;   &lt;!-- value \u5c5e\u6027\u503c\u4e3a\u6587\u672c\u6846\u4e2d\u7684\u9ed8\u8ba4\u503c --&gt;  \n        username:&lt;input type=\"text\" name=\"username\" value=\"\u8bf7\u8f93\u5165\u7528\u6237\u540d\"&gt;&lt;br&gt;\n        &lt;!-- \u5bc6\u7801 --&gt;\n        password:&lt;input type=\"password\" name=\"password\"&gt;&lt;br&gt;\n        &lt;!-- \u5355\u9009 --&gt;\n        &lt;input type=\"radio\" name=\"sex\" value=\"male\"&gt;\u7537&lt;br&gt;\n        &lt;input type=\"radio\" name=\"sex\" value=\"femail\"&gt;\u5973&lt;br&gt;\n        &lt;!-- \u590d\u9009 --&gt;\n        &lt;input type=\"checkbox\" name=\"language\" value=\"Bike\"&gt;Java&lt;br&gt;\n        &lt;input type=\"checkbox\" name=\"language\" value=\"Car\"&gt;Python&lt;br&gt;\n        &lt;input type=\"checkbox\" name=\"language\" value=\"Car\"&gt;JavaScript&lt;br&gt;\n        &lt;!-- \u63d0\u4ea4 --&gt;\n        &lt;input type=\"submit\" value=\"\u63d0\u4ea4\"&gt;\n        &lt;!-- \u91cd\u7f6e --&gt;\n        &lt;input type=\"reset\" value=\"\u91cd\u7f6e\"&gt;\n    &lt;/form&gt;\n</code></pre> <p>12.2 <code>&lt;select&gt;</code></p> <pre><code>        &lt;select name=\"city\"&gt;\n            &lt;option value=\"beijing\"&gt;\u5317\u4eac&lt;/option&gt;\n            &lt;option value=\"shanghai\"&gt;\u4e0a\u6d77&lt;/option&gt;\n            &lt;option value=\"shenzhen\"&gt;\u6df1\u5733&lt;/option&gt;\n            &lt;option value=\"xian\" selected&gt;\u897f\u5b89&lt;/option&gt;\n    \u3000\u3000&lt;/select&gt;\n</code></pre> <p>13 <code>&lt;textarea&gt;</code> \u591a\u884c\u6587\u672c</p> <pre><code>        &lt;textarea rows=\"10\" cols=\"10\"&gt;\n        \u3000\u3000\u9ed8\u8ba4\u6587\u672c\u5185\u5bb9\n    \u3000\u3000&lt;/textarea&gt;\n</code></pre> <p>14 <code>&lt;iframe&gt;</code> \u6807\u7b7e:\u6846\u67b6</p> <p>\u53ef\u4ee5\u5728\u540c\u4e00\u4e2a\u6d4f\u89c8\u5668\u7a97\u53e3\u63d2\u5165\u5176\u4ed6HTML\u9875\u9762</p> <pre><code>&lt;iframe src=\"http://www.baidu.com\" width=\"900\" height=\"300\" frameborder=\"0\"&gt;&lt;/iframe&gt;\n</code></pre> <p>\u56db\u3001\u5757\u7ea7\u6807\u7b7e\u4e0e\u5185\u8054\u6807\u7b7e</p> <p>1.\u5757\u7ea7\u6807\u7b7e\uff1a\u81ea\u52a8\u5730\u5728\u5143\u7d20\u7684\u524d\u540e\u6dfb\u52a0\u7a7a\u884c</p> <pre><code>  \u3000\u3000 &lt;div&gt;&lt;/div&gt; &lt;p&gt;&lt;/p&gt; &lt;h1&gt;&lt;/h1&gt; &lt;ul&gt;&lt;/ul&gt; &lt;ol&gt;&lt;/ol&gt; &lt;dl&gt;&lt;/dl&gt;\n</code></pre> <p>2.\u5185\u8054\u6807\u7b7e\uff1a</p> <pre><code> \u3000\u3000&lt;a&gt;&lt;/a&gt; &lt;img&gt; &lt;input&gt; &lt;span&gt;&lt;/span&gt; &lt;select&gt;&lt;/select&gt; &lt;textarea&gt;&lt;/textarea&gt;\n</code></pre>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/","title":"\u6570\u636e\u7ed3\u6784\u4e0e\u7b97\u6cd5","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#_1","title":"\u4e00\u3001 \u57fa\u672c\u6982\u5ff5","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#1","title":"1. \u6570\u636e","text":"<p>\u6570\u636e\u662f\u63cf\u8ff0\u5ba2\u89c2\u4e8b\u7269\u7684\u7b26\u53f7\uff0c\u662f\u8ba1\u7b97\u673a\u4e2d\u53ef\u4ee5\u64cd\u4f5c\u7684\u5bf9\u8c61\uff0c\u662f\u80fd\u88ab\u8ba1\u7b97\u673a\u8bc6\u522b\uff0c\u5e76\u8f93\u5165\u7ed9\u8ba1\u7b97\u673a\u5904\u7406\u7684\u7b26\u53f7\u96c6\u5408\u3002</p> <p>\u6570\u636e\u7684\u5206\u7c7b\uff1a</p> <ol> <li>\u6570\u503c\u7c7b\u578b\uff1a\u6574\u578b\u3001\u5b9e\u578b</li> <li>\u975e\u6570\u503c\u7c7b\u578b\uff1a\u5b57\u7b26\u3001\u58f0\u97f3\u3001\u56fe\u5f62\u3001\u89c6\u9891\u7b49</li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#2","title":"2. \u6570\u636e\u5143\u7d20","text":"<p>\u6570\u636e\u5143\u7d20\u503c\u7ec4\u6210\u6570\u636e\u7684\u3001\u6709\u4e00\u5b9a\u610f\u4e49\u7684\u57fa\u672c\u5355\u4f4d\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u901a\u5e38\u4f5c\u4e3a\u6574\u4f53\u5904\u7406\u3002\u4e5f\u88ab\u79f0\u4e3a\u8bb0\u5f55\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#3","title":"3. \u6570\u636e\u9879","text":"<p>\u4e00\u4e2a\u6570\u636e\u5143\u7d20\u53ef\u4ee5\u6709\u82e5\u5e72\u4e2a\u6570\u636e\u9879\u7ec4\u6210\u3002</p> <p>\u6570\u636e\u9879\u662f\u6570\u636e\u4e0d\u53ef\u5206\u5272\u7684\u505a\u5c0f\u5355\u4f4d\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#4","title":"4. \u6570\u636e\u5bf9\u8c61","text":"<p>\u6570\u636e\u5bf9\u8c61\u65f6\u6027\u8d28\u76f8\u540c\u7684\u6570\u636e\u5143\u7d20\u7684\u96c6\u5408\uff0c\u662f\u6570\u636e\u7684\u5b50\u96c6\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#5","title":"5. \u6570\u636e\u7ed3\u6784","text":"<p>\u6570\u636e\u7ed3\u6784\u662f\u76f8\u4e92\u4e4b\u95f4\u5b58\u5728\u4e00\u79cd\u591a\u591a\u79cd\u7279\u5b9a\u5173\u7cfb\u7684\u6570\u636e\u5143\u7d20\u7684\u96c6\u5408\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#_2","title":"\u4e8c\u3001\u903b\u8f91\u7ed3\u6784\u4e0e\u7269\u7406\u7ed3\u6784","text":"<p>\u6309\u7167\u89c6\u89d2\u7684\u4e0d\u540c\uff0c\u628a\u6570\u636e\u5206\u4e3a\u903b\u8f91\u7ed3\u6784\u548c\u7269\u7406\u7ed3\u6784</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#1_1","title":"1. \u903b\u8f91\u673a\u6784","text":"<p>\u6570\u636e\u5bf9\u8c61\u4e2d\u6b27\u51a0\u6570\u636e\u5143\u7d20\u4e4b\u95f4\u7684\u76f8\u4e92\u5173\u7cfb</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#11","title":"1.1 \u96c6\u5408\u7ed3\u6784","text":"<p>\u96c6\u5408\u7ed3\u6784\u4e2d\u7684\u6570\u636e\u5143\u7d20\u9664\u4e86\u5c5e\u4e8e\u540c\u4e00\u4e2a\u96c6\u5408\u5916\uff0c\u5b83\u4eec\u4e4b\u95f4\u6ca1\u6709\u5176\u4ed6\u5173\u7cfb\u3002</p> <p></p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#12","title":"1.2 \u7ebf\u6027\u7ed3\u6784","text":"<p>\u7ebf\u6027\u7ed3\u6784\u4e2d\u7684\u6570\u636e\u4e4b\u95f4\u662f\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb</p> <p></p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#13","title":"1.3 \u6811\u5f62\u7ed3\u6784","text":"<p>\u6811\u5f62\u7ed3\u6784\u4e2d\u7684\u5143\u7d20\u4e4b\u95f4\u5b58\u5728\u4e00\u79cd\u4e00\u5bf9\u591a\u7684\u5c42\u6b21\u5173\u7cfb</p> <p></p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#14","title":"1.4 \u56fe\u5f62\u7ed3\u6784","text":"<p>\u56fe\u5f62\u7ed3\u6784\u7684\u6570\u636e\u5143\u7d20\u4e4b\u95f4\u662f\u591a\u5bf9\u591a\u7684\u5173\u7cfb</p> <p></p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#2_1","title":"2. \u7269\u7406\u7ed3\u6784\uff08\u5b58\u50a8\u7ed3\u6784\uff09","text":"<p>\u7269\u7406\u7ed3\u6784\u503c\u6570\u636e\u7684\u903b\u8f91\u7ed3\u6784\u5728\u8ba1\u7b97\u673a\u4e2d\u7684\u5b58\u50a8\u5f62\u5f0f</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#21","title":"2.1 \u987a\u5e8f\u5b58\u50a8\u7ed3\u6784","text":"<p>\u6570\u636e\u5143\u7d20\u5b58\u653e\u5728\u5730\u5740\u8fde\u7eed\u7684\u5b58\u50a8\u5355\u5143\u5185\uff0c\u6570\u636e\u95f4\u7684\u903b\u8f91\u5173\u7cfb\u548c\u7269\u7406\u5173\u7cfb\u662f\u4e00\u81f4\u7684\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#22","title":"2.2 \u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784","text":"<p>\u6570\u636e\u5b58\u653e\u5728\u4efb\u610f\u7684\u5b58\u50a8\u5355\u5143\u91cc\uff0c\u8fd9\u7ec4\u5b58\u50a8\u5355\u5143\u53ef\u4ee5\u662f\u8fde\u7eed\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e0d\u8fde\u7eed\u7684\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#_3","title":"\u4e09\u3001\u62bd\u8c61\u6570\u636e\u7c7b\u578b","text":"<p>\u62bd\u8c61\u6570\u636e\u7c7b\u578b\uff08ADT\uff09\u662f\u6307\u4e00\u4e2a\u6570\u5b66\u6a21\u578b\u53ca\u5b9a\u4e49\u5728\u8be5\u6a21\u578b\u4e0a\u7684\u4e00\u7ec4\u64cd\u4f5c\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#_4","title":"\u56db\u3001\u7b97\u6cd5","text":"<p>\u7b97\u6cd5\u662f\u89e3\u51b3\u7279\u5b9a\u95ee\u9898\u6c42\u89e3\u6b65\u9aa4\u7684\u63cf\u8ff0\uff0c\u5728\u8ba1\u7b97\u673a\u4e2d\u8868\u73b0\u4e3a\u6307\u4ee4\u7684\u6709\u9650\u5e8f\u5217\uff0c\u51b0\u978b\u6bcf\u6761\u6307\u4ee4\u8868\u793a\u4e00\u4e2a\u6216\u591a\u4e2a\u64cd\u4f5c\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#1_2","title":"1. \u7b97\u6cd5\u7684\u7279\u6027","text":"<ol> <li>\u8f93\u5165\u8f93\u51fa\uff1a\u7b97\u6cd5\u5177\u6709\u96f6\u4e2a\u6216\u591a\u4e2a\u8f93\u5165\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u6216\u591a\u4e2a\u8f93\u51fa</li> <li>\u6709\u7a77\u6027\uff1a\u6709\u9650\u6b65\u9aa4\u4e4b\u540e\u81ea\u52a8\u7ed3\u675f</li> <li>\u786e\u5b9a\u6027\uff1a\u6bcf\u4e00\u6b65\u9aa4\u6709\u786e\u5b9a\u7684\u542b\u4e49</li> <li>\u53ef\u884c\u6027</li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#2_2","title":"2. \u7b97\u6cd5\u7684\u8bbe\u8ba1\u8981\u6c42","text":"<ol> <li>\u6b63\u786e\u6027</li> <li>\u53ef\u8bfb\u6027</li> <li>\u5065\u58ee\u6027</li> <li>\u65f6\u95f4\u6548\u7387\u9ad8\u548c\u5b58\u50a8\u91cf\u4f4e</li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#_5","title":"\u4e94\u3001\u7b97\u6cd5\u65f6\u95f4\u590d\u6742\u5ea6","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#1-o","title":"1. \u65f6\u95f4\u590d\u6742\u5ea6\u4e0e\u5927O\u8bb0\u6cd5","text":"<p>\u5927O\u8bb0\u6cd5\uff1a\u5bf9\u4e8e\u5355\u8c03\u7684\u6574\u6570\u51fd\u6570f\uff0c\u5982\u679c\u5b58\u5728\u4e00\u4e2a\u6574\u6570\u51fd\u6570g\u548c\u5b9e\u5e38\u6570c&gt;0\uff0c\u4f7f\u5f97\u5bf9\u4e8e\u5145\u5206\u5927\u7684n\u603b\u6709<code>f(n)\u2264c\u00b7g(n)</code>\uff0c\u5c31\u8bf4\u51fd\u6570g\u662ff\u7684\u4e00\u4e2a\u6e10\u8fd1\u51fd\u6570\uff08\u5ffd\u7565\u5e38\u6570\uff09\uff0c\u8bb0\u4e3a<code>f(n)=O(g(n))</code>\u3002\u4e5f\u5c31\u662f\u8bf4\uff0c\u5728\u8d8b\u5411\u65e0\u7a77\u7684\u6781\u9650\u610f\u4e49\u4e0b\uff0c\u51fd\u6570f\u7684\u589e\u957f\u901f\u5ea6\u53d7\u5230\u51fd\u6570g\u7684\u7ea6\u675f\uff0c\u4ea6\u5373\u51fd\u6570f\u4e0e\u51fd\u6570g\u7684\u7279\u5f81\u76f8\u4f3c\u3002</p> <p>\u65f6\u95f4\u590d\u6742\u5ea6\uff1a\u5047\u8bbe\u5b58\u5728\u51fd\u6570g\uff0c\u4f7f\u5f97\u7b97\u6cd5A\u5904\u7406\u89c4\u6a21\u4e3an\u7684\u95ee\u9898\u793a\u4f8b\u6240\u7528\u65f6\u95f4\u4e3a<code>T(n)=O(g(n))</code>\uff0c\u5219\u79f0<code>O(g(n))</code>\u4e3a\u7b97\u6cd5A\u7684\u6e10\u8fd1\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u7b80\u79f0\u65f6\u95f4\u590d\u6742\u5ea6\uff0c\u8bb0\u4e3a<code>T(n)</code></p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#2_3","title":"2. \u65f6\u95f4\u590d\u6742\u5ea6\u7684\u57fa\u672c\u8ba1\u7b97\u89c4\u5219","text":"<ol> <li>\u57fa\u672c\u64cd\u4f5c\uff0c\u5373\u53ea\u6709\u5e38\u6570\u9879\uff0c\u8ba4\u4e3a\u5176\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1)</li> <li>\u987a\u5e8f\u7ed3\u6784\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u6309\u52a0\u6cd5\u8fdb\u884c\u8ba1\u7b97</li> <li>\u5faa\u73af\u7ed3\u6784\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u6309\u4e58\u6cd5\u8fdb\u884c\u8ba1\u7b97</li> <li>\u5206\u652f\u7ed3\u6784\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u53d6\u6700\u5927\u503c</li> <li>\u5224\u65ad\u4e00\u4e2a\u7b97\u6cd5\u7684\u6548\u7387\u65f6\uff0c\u5f80\u5f80\u53ea\u9700\u8981\u5173\u6ce8\u64cd\u4f5c\u6570\u91cf\u7684\u6700\u9ad8\u6b21\u9879\uff0c\u5176\u5b83\u6b21\u8981\u9879\u548c\u5e38\u6570\u9879\u53ef\u4ee5\u5ffd\u7565</li> <li>\u5728\u6ca1\u6709\u7279\u6b8a\u8bf4\u660e\u65f6\uff0c\u6211\u4eec\u6240\u5206\u6790\u7684\u7b97\u6cd5\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u90fd\u662f\u6307\u6700\u574f\u65f6\u95f4\u590d\u6742\u5ea6</li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#3_1","title":"3. \u5e38\u89c1\u65f6\u95f4\u590d\u6742\u5ea6","text":"\u6267\u884c\u6b21\u6570\u51fd\u6570\u4e3e\u4f8b \u9636 \u975e\u6b63\u5f0f\u672f\u8bed 12 O(1) \u5e38\u6570\u9636 2n+3 O(n) \u7ebf\u6027\u9636 3n<sup>2</sup>+2n+1 O(n<sup>2</sup>) \u5e73\u65b9\u9636 5log<sub>2</sub><sup>n</sup>+20 O(logn) \u5bf9\u6570\u9636 2n+3nlog<sub>2</sub>n+19 O(nlogn) nlogn\u9636 6n<sup>3</sup>+2n<sup>2</sup>+3n+4 O(n<sup>3</sup>) \u7acb\u65b9\u9636 2<sup>n</sup> O(2<sup>n</sup>) \u6307\u6570\u9636 <p>\u65f6\u95f4\u590d\u6742\u5ea6\u6240\u6d88\u8017\u7684\u65f6\u95f4\u5927\u5c0f\u6392\u5e8f\uff1a</p> <p>O(1) &lt; O(log<sup>n</sup>) &lt; O(n) &lt; O(nlogn) &lt; O(n<sup>2</sup>) &lt; O(n<sup>3</sup>) &lt; O(2<sup>n</sup>) &lt; O(n!) &lt; O(n<sup>n</sup>)</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#_6","title":"\u516d\u3001\u7ebf\u6027\u8868","text":"<p>\u7ebf\u6027\u8868\uff1a\u96f6\u4e2a\u6216\u591a\u4e2a\u6570\u636e\u5143\u7d20\u7684\u6709\u9650\u5e8f\u5217</p> <ol> <li>\u5143\u7d20\u4e4b\u95f4\u662f\u6709\u987a\u5e8f\u7684</li> <li>\u82e5\u5143\u7d20\u5b58\u5728\u591a\u4e2a\uff0c\u5219\u7b2c\u4e00\u4e2a\u5143\u7d20\u65e0\u524d\u9a71\uff0c\u6700\u540e\u4e00\u4e2a\u5143\u7d20\u65e0\u540e\u7ee7</li> <li>\u5176\u4ed6\u6bcf\u4e2a\u5143\u7d20\u90fd\u6709\u4e14\u53ea\u6709\u4e00\u4e2a\u524d\u9a71\u548c\u540e\u7ee7</li> <li>\u7ebf\u6027\u8868\u793a\u6709\u9650\u7684</li> <li>\u7ebf\u6027\u8868\u5143\u7d20\u7684\u4e2a\u6570n(n\u22650)\u5b9a\u4e49\u4e3a\u7ebf\u6027\u8868\u7684\u957f\u5ea6\uff0c\u5f53n=0\u65f6\uff0c\u79f0\u4e3a\u7a7a\u8868\u3002</li> <li>\u6839\u636e\u7ebf\u6027\u8868\u7684\u5b9e\u9645\u5b58\u50a8\u65b9\u5f0f\uff0c\u5206\u4e3a\u987a\u5e8f\u8868\u548c\u94fe\u8868</li> </ol> <p></p> <p>\u62bd\u8c61\u6570\u636e\u7c7b\u578b\u5b9a\u4e49\uff1a</p> <pre><code>ADT \u7ebf\u6027\u8868(List)\nData\nOperation\n    InitList(*L): \u521d\u59cb\u5316\u64cd\u4f5c\uff0c\u5efa\u7acb\u4e00\u4e2a\u7a7a\u7684\u7ebf\u6027\u8868L\n    ListEmpty(L): \u82e5\u7ebf\u6027\u8868\u4e3a\u7a7a\uff0c\u8fd4\u56detrue\uff0c\u5426\u5219\u8fd4\u56defalse\n    ClearList(*L): \u5c06\u7ebf\u6027\u8868\u6e05\u7a7a\n    GetElem(L,i,*e): \u5c06\u7ebf\u6027\u8868L\u4e2d\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u5143\u7d20\u503c\u8fd4\u56de\u7ed9e\n    LocateElem(L,e): \u5728\u7ebf\u6027\u8868L\u4e2d\u67e5\u627e\u4e0e\u7ed9\u5b9a\u503ce\u76f8\u5bf9\u7684\u5143\u7d20\uff0c\u5982\u679c\u67e5\u627e\u6210\u529f\uff0c\u8fd4\u56de\u8be5\u5143\u7d20\u5728\u8868\u4e2d\u5e8f\u53f7\u8868\u793a\u6210\u529f\uff0c\u5426\u5219\u8fd4\u56de0\u8868\u793a\u5931\u8d25\u3002\n    ListInsert(*L,i,e): \u5728\u7ebf\u6027\u8868L\u4e2d\u7684\u7b2ci\u4e2a\u4f4d\u7f6e\u63d2\u5165\u65b0\u5143\u7d20e\n    ListDelete(*L,i,*e): \u5220\u9664\u7ebf\u6027\u8868L\u4e2d\u7b2ci\u4e2a\u4f4d\u7f6e\u5143\u7d20\uff0c\u5e76\u7528e\u8fd4\u56de\u5176\u503c\n    ListLength(L): \u8fd4\u56de\u7ebf\u6027\u8868L\u7684\u5143\u7d20\u4e2a\u6570\nendADT\n</code></pre>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#1_3","title":"1. \u7ebf\u6027\u8868\u7684\u987a\u5e8f\u5b58\u50a8\u7ed3\u6784","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#11_1","title":"1.1 \u5b9a\u4e49","text":"<p>\u6307\u7528\u4e00\u6bb5\u5730\u5740\u8fde\u7eed\u7684\u5b58\u50a8\u5355\u5143\u4f9d\u6b21\u5b58\u50a8\u7ebf\u6027\u8868\u7684\u6570\u636e\u5143\u7d20\u3002</p> <p>\u53ef\u4ee5\u7528\u4e00\u4f4d\u6570\u7ec4\u6765\u5b9e\u73b0\u987a\u5e8f\u5b58\u50a8\u7ed3\u6784\uff08\u628a\u7b2c\u4e00\u4e2a\u5143\u7d20\u5b58\u5230\u6570\u7ec4\u4e0b\u6807\u4e3a0\u7684\u4f4d\u7f6e\u4e2d\uff09\u3002</p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#12_1","title":"1.2 \u987a\u5e8f\u5b58\u50a8\u7ed3\u6784\u9700\u8981\u4e09\u4e2a\u5c5e\u6027","text":"<ol> <li> <p>\u5b58\u50a8\u7a7a\u95f4\u7684\u8d77\u59cb\u4f4d\u7f6e</p> </li> <li> <p>\u7ebf\u6027\u8868\u7684\u6700\u5927\u5b58\u50a8\u5bb9\u91cf</p> </li> <li> <p>\u7ebf\u6027\u8868\u5f53\u524d\u7684\u957f\u5ea6</p> </li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#13_1","title":"1.3 \u4f18\u7f3a\u70b9","text":"<ol> <li> <p>\u4f18\u70b9\uff1a</p> <ol> <li>\u65e0\u987b\u4e3a\u8868\u793a\u8868\u4e2d\u5143\u7d20\u4e4b\u95f4\u7684\u903b\u8f91\u5173\u7cfb\u800c\u589e\u52a0\u989d\u5916\u7684\u5b58\u50a8\u7a7a\u95f4</li> <li>\u53ef\u4ee5\u5feb\u901f\u7684\u5b58\u53d6\u8868\u4e2d\u4efb\u4e00\u4f4d\u7f6e\u7684\u5143\u7d20</li> </ol> </li> <li> <p>\u7f3a\u70b9\uff1a</p> <ol> <li>\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\u9700\u8981\u79fb\u52a8\u5927\u91cf\u5143\u7d20</li> <li>\u5f53\u7ebf\u6027\u8868\u957f\u5ea6\u53d8\u5316\u8f83\u5927\u65f6\uff0c\u96be\u4ee5\u786e\u5b9a\u5b58\u50a8\u7a7a\u95f4\u7684\u5bb9\u91cf</li> <li>\u9020\u6210\u5b58\u50a8\u7a7a\u95f4\u7684\u788e\u7247</li> <li>\u5728\u5b58\u3001\u8bfb\u6570\u636e\u65f6\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u4e3aO(1)\uff1b\u5728\u5220\u9664\u6216\u5220\u9664\u65f6\uff0c\u65f6\u95f4\u590d\u6742\u5ea6\u7b2cO(n)</li> </ol> </li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#2_4","title":"2. \u7ebf\u6027\u8868\u7684\u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#21_1","title":"2.1 \u5b9a\u4e49","text":"<p>\u7528\u4e00\u7ec4\u4efb\u610f\u7684\u5b58\u50a8\u5355\u5143\u5b58\u50a8\u7ebf\u6027\u8868\u7684\u6570\u636e\u5143\u7d20\uff0c\u8fd9\u7ec4\u5b58\u50a8\u5355\u5143\u53ef\u4ee5\u662f\u8fde\u7eed\u7684\uff0c\u4e5f\u53ef\u4ee5\u662f\u4e0d\u8fde\u7eed\u7684\u3002\u5728\u94fe\u5f0f\u7ed3\u6784\u4e2d\uff0c\u9664\u4e86\u8981\u5b58\u50a8\u6570\u636e\u5143\u7d20\u4fe1\u606f\u5916\uff0c\u8fd8\u8981\u5b58\u50a8\u5b83\u7684\u540e\u7ee7\u5143\u7d20\u7684\u5b58\u50a8\u5730\u5740\u3002</p> <p>\u5728\u94fe\u5f0f\u7ed3\u6784\u4e2d\uff0c\u4e3a\u4e86\u8868\u793a\u6570\u636e\u5143\u7d20a<sub>i</sub>\u4e0e\u5176\u76f4\u63a5\u540e\u7ee7\u6570\u636e\u5143\u7d20a<sub>i+1</sub>\u4e4b\u95f4\u7684\u903b\u8f91\u5173\u7cfb\uff0c\u5bf9\u4e8e\u6570\u636ea<sub>i</sub>\u6765\u8bf4\uff0c\u9664\u4e86\u5b58\u50a8\u5176\u672c\u8eab\u7684\u4fe1\u606f\u4e4b\u5916\uff0c\u8fd8\u9700\u5b58\u50a8\u4e00\u4e2a\u6307\u793a\u5176\u76f4\u63a5\u540e\u7ee7\u7684\u4fe1\u606f\uff08\u5373\u76f4\u63a5\u540e\u7ee7\u7684\u5b58\u50a8\u4f4d\u7f6e\uff09\u3002\u6211\u4eec\u628a\u5b58\u50a8\u6570\u636e\u5143\u7d20\u4fe1\u606f\u7684\u57df\u79f0\u4e3a\u6570\u636e\u57df\uff0c\u628a\u5b58\u50a8\u76f4\u63a5\u540e\u7ee7\u4f4d\u7f6e\u7684\u57df\u79f0\u4e3a\u6307\u9488\u57df\u3002\u6307\u9488\u57df\u4e2d\u5b58\u50a8\u7684\u4fe1\u606f\u79f0\u4e3a\u6307\u9488\u6216\u94fe\u3002\u8fd9\u4e24\u90e8\u5206\u4fe1\u606f\u7ec4\u6210\u6570\u636e\u5143\u7d20a<sub>i</sub>\u7684\u5b58\u50a8\u6620\u50cf\uff0c\u79f0\u4e3a\u7ed3\u70b9\uff08Node\uff09\u3002</p> <p></p> <p>n\u4e2a\u7ed3\u70b9\u94fe\u6210\u4e00\u4e2a\u94fe\u8868\uff0c\u5373\u4e3a\u7ebf\u6027\u8868\u7684\u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784\uff0c\u56e0\u4e3a\u6b64\u94fe\u8868\u7684\u6bcf\u4e2a\u7ed3\u70b9\u53ea\u5305\u542b\u4e00\u4e2a\u6307\u9488\u57df\uff0c\u6240\u4ee5\u53eb\u505a\u5355\u94fe\u8868\u3002</p> <ol> <li>\u7b2c\u4e00\u4e2a\u7ed3\u70b9\u7684\u5b58\u50a8\u4f4d\u7f6e\u53eb\u505a\u5934\u6307\u9488\u3002</li> <li>\u94fe\u8868\u4e2d\u6700\u540e\u4e00\u4e2a\u7ed3\u70b9\u6307\u9488\u4e3a\u7a7a\u3002</li> <li>\u4e3a\u4e86\u65b9\u4fbf\u5bf9\u6307\u9488\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f1a\u5728\u5355\u94fe\u8868\u7684\u7b2c\u4e00\u4e2a\u7ed3\u70b9\u524d\u9644\u8bbe\u4e00\u4e2a\u7ed3\u70b9\uff0c\u79f0\u4e3a\u5934\u7ed3\u70b9\u3002\u5934\u7ed3\u70b9\u53ef\u4ee5\u4e0d\u5b58\u50a8\u4efb\u4f55\u4fe1\u606f\uff0c\u4e5f\u53ef\u4ee5\u5b58\u50a8\u7ebf\u6027\u8868\u957f\u5ea6\u7b49\u9644\u52a0\u4fe1\u606f\u3002\u5934\u7ed3\u70b9\u7684\u6307\u9488\u57df\u5b58\u50a8\u6307\u5411\u7b2c\u4e00\u4e2a\u7ed3\u70b9\u7684\u6307\u9488\u3002</li> </ol> <p></p>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#22_1","title":"2.2 \u5934\u6307\u9488\u4e0e\u5934\u7ed3\u70b9\u7684\u5f02\u540c","text":"<ol> <li> <p>\u5934\u6307\u9488</p> <ol> <li>\u5934\u6307\u9488\u662f\u6307\u94fe\u8868\u6307\u5411\u7b2c\u4e00\u4e2a\u7ed3\u70b9\u7684\u6307\u9488\uff0c\u82e5\u94fe\u8868\u6709\u5934\u7ed3\u70b9\uff0c\u5219\u662f\u6307\u5411\u5934\u7ed3\u70b9\u7684\u6307\u9488</li> <li>\u5934\u6307\u9488\u5177\u6709\u6807\u8bc6\u4f5c\u7528\uff0c\u6240\u4ee5\u5e38\u7528\u5934\u6307\u9488\u51a0\u4ee5\u94fe\u8868\u7684\u540d\u5b57</li> <li>\u65e0\u8bba\u94fe\u8868\u662f\u5426\u4e3a\u7a7a\uff0c\u5934\u6307\u9488\u5747\u4e0d\u4e3a\u7a7a\u3002\u5934\u6307\u9488\u662f\u94fe\u8868\u7684\u5fc5\u8981\u5143\u7d20</li> </ol> </li> <li> <p>\u5934\u7ed3\u70b9</p> <ol> <li>\u5934\u7ed3\u70b9\u662f\u4e3a\u4e86\u64cd\u4f5c\u7684\u7edf\u4e00\u548c\u65b9\u4fbf\u800c\u8bbe\u7acb\u7684\uff0c\u521a\u5728\u7b2c\u4e00\u5143\u7d20\u7684\u7ed3\u70b9\u4e4b\u524d\uff0c\u5176\u6570\u636e\u57df\u4e00\u822c\u65e0\u610f\u4e49\uff08\u4e5f\u53ef\u5b58\u653e\u94fe\u8868\u7684\u957f\u5ea6\uff09</li> <li>\u6709\u4e86\u5934\u7ed3\u70b9\uff0c\u5bf9\u5728\u7b2c\u4e00\u5143\u7d20\u7ed3\u70b9\u524d\u63d2\u5165\u7ed3\u70b9\u548c\u5220\u9664\u7b2c\u4e00\u7ed3\u70b9\uff0c\u5176\u64cd\u4f5c\u4e0e\u5176\u4ed6\u7ed3\u70b9\u7684\u64cd\u4f5c\u5c31\u7edf\u4e00\u4e86</li> <li>\u5934\u7ed3\u70b9\u4e0d\u4e00\u5b9a\u662f\u94fe\u8868\u7684\u5fc5\u987b\u8981\u7d20</li> </ol> </li> </ol>"},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#23","title":"2.3 \u94fe\u5f0f\u5b58\u50a8\u7ed3\u6784\u7684\u5f62\u5f0f","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#1_4","title":"1. \u5355\u94fe\u8868","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#2_5","title":"2. \u9759\u6001\u94fe\u8868","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#3_2","title":"3. \u5faa\u73af\u94fe\u8868","text":""},{"location":"programming/DataStructuresAndAlgorithms/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/#4_1","title":"4. \u53cc\u5411\u94fe\u8868","text":""},{"location":"programming/c/%E5%87%BD%E6%95%B0/","title":"\u51fd\u6570","text":""},{"location":"programming/c/%E5%87%BD%E6%95%B0/#_1","title":"\u4e00\u3001\u51fd\u6570\u7684\u4f5c\u7528","text":"<ol> <li> <p>\u907f\u514d\u4e86\u91cd\u590d\u6027\u64cd\u4f5c</p> </li> <li> <p>\u6709\u5229\u4e8e\u7a0b\u5e8f\u7684\u6a21\u5757\u5316</p> </li> </ol>"},{"location":"programming/c/%E5%87%BD%E6%95%B0/#_2","title":"\u4e8c\u3001\u4ec0\u4e48\u662f\u51fd\u6570","text":"<p>\u51fd\u6570\u662f\u4e00\u4e2a\u5de5\u5177\uff0c\u662f\u4e3a\u4e86\u89e3\u51b3\u5927\u91cf\u7c7b\u4f3c\u95ee\u9898\u4e8c\u8bbe\u8ba1\u7684\uff0c\u51fd\u6570\u53ef\u4ee5\u5f53\u505a\u4e00\u4e2a\u9ed1\u5323\u5b50</p> <p>\u903b\u8f91\u4e0a\uff1a</p> <ol> <li>\u80fd\u591f\u5b8c\u6210\u7279\u5b9a\u529f\u80fd\u7684\u72ec\u7acb\u4ee3\u7801\u5757</li> </ol> <p>\u7269\u7406\u4e0a\uff1a</p> <ol> <li>\u80fd\u591f\u63a5\u6536\u6570\u636e\uff08\u4e5f\u53ef\u4ee5\u4e0d\u63a5\u6536\u6570\u636e\uff09</li> <li>\u80fd\u591f\u5bf9\u63a5\u6536\u7684\u6570\u636e\u8fdb\u884c\u5904\u7406</li> <li>\u80fd\u591f\u5c06\u6570\u636e\u5904\u7406\u7684\u7ed3\u679c\u8fd4\u56de\uff08\u4e5f\u53ef\u4ee5\u4e0d\u8fd4\u56de\u4efb\u4f55\u503c\uff09</li> </ol>"},{"location":"programming/c/%E5%87%BD%E6%95%B0/#_3","title":"\u4e09\u3001\u51fd\u6570\u7684\u5b9a\u4e49","text":"<pre><code>\u51fd\u6570\u7684\u8fd4\u56de\u503c \u51fd\u6570\u7684\u540d\u5b57(\u51fd\u6570\u7684\u5f62\u53c2\u5217\u8868){\n    \u51fd\u6570\u7684\u6267\u884c\u4f53\n}\n</code></pre> <p>\u51fd\u6570\u5b9a\u4e49\u7684\u672c\u8d28\u662f\u8be6\u7ec6\u63cf\u8ff0\u51fd\u6570\u80fd\u591f\u5b9e\u73b0\u67d0\u4e2a\u7279\u5b9a\u529f\u80fd\u7684\u5177\u4f53\u65b9\u6cd5\u3002</p>"},{"location":"programming/c/%E5%87%BD%E6%95%B0/#return","title":"\u56db\u3001<code>return</code>","text":"<p><code>return \u8868\u8fbe\u5f0f;</code>\u7684\u542b\u4e49\uff1a</p> <ol> <li>\u7ec8\u6b62\u88ab\u8c03\u51fd\u6570\uff0c\u5411\u4e3b\u8c03\u51fd\u6570\u8fd4\u56de\u8868\u8fbe\u5f0f\u7684\u503c</li> <li>\u5982\u679c\u8868\u8fbe\u5f0f\u4e3a\u7a7a\uff0c\u5219\u53ea\u7ec8\u6b62\u51fd\u6570\uff0c\u4e0d\u5411\u4e3b\u8c03\u51fd\u6570\u8fd4\u56de\u4efb\u4f55\u503c</li> <li>break\u662f\u7528\u6765\u7ec8\u6b62\u5faa\u73af\u548cswitch\u7684\uff0creturn\u662f\u7528\u6765\u7ec8\u6b62\u51fd\u6570\u7684</li> </ol> <p>\u51fd\u6570\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u4e5f\u79f0\u4e3a\u51fd\u6570\u7684\u7c7b\u578b\uff0c\u5982\u679c\u51fd\u6570\u540d\u524d\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u548c\u51fd\u6570\u6267\u884c\u4f53\u4e2d<code>return &lt;\u8868\u8fbe\u5f0f&gt;;</code>\u4e2d\u8868\u8fbe\u5f0f\u7684\u7c7b\u578b\u4e0d\u540c\u7684\u8bdd\uff0c\u5219\u6700\u7ec8\u51fd\u6570\u8fd4\u56de\u503c\u7684\u7c7b\u578b\u4ee5\u51fd\u6570\u540d\u524d\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u4e3a\u51c6\u3002</p>"},{"location":"programming/c/%E5%87%BD%E6%95%B0/#_4","title":"\u4e94\u3001\u51fd\u6570\u7684\u5206\u7c7b","text":"<ol> <li>\u6709\u53c2\u51fd\u6570\u548c\u65e0\u53c2\u51fd\u6570</li> <li>\u6709\u8fd4\u56de\u503c\u51fd\u6570\u548c\u65e0\u8fd4\u56de\u503c\u51fd\u6570</li> <li>\u5e93\u51fd\u6570\u548c\u7528\u6237\u81ea\u5b9a\u4e49\u51fd\u6570</li> <li>\u503c\u4f20\u9012\u51fd\u6570\u548c\u5730\u5740\u4f20\u9012\u51fd\u6570</li> <li>\u666e\u901a\u51fd\u6570\u548c\u4e3b\u51fd\u6570</li> </ol> <p>\u4e00\u4e2a\u7a0b\u5e8f\u5fc5\u987b\u6709\u4e14\u53ea\u80fd\u6709\u4e00\u4e2a\u4e3b\u51fd\u6570\uff1b\u4e3b\u51fd\u6570\u53ef\u4ee5\u8c03\u7528\u666e\u901a\u51fd\u6570\uff0c\u666e\u901a\u51fd\u6570\u4e0d\u80fd\u8c03\u7528\u4e3b\u51fd\u6570\uff0c\u666e\u901a\u51fd\u6570\u53ef\u4ee5\u76f8\u4e92\u8c03\u7528\uff1b\u4e3b\u51fd\u6570\u662f\u7a0b\u5e8f\u7684\u5165\u53e3\uff0c\u53ef\u4ee5\u7a0b\u5e8f\u7684\u51fa\u53e3\u3002</p>"},{"location":"programming/c/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/","title":"\u52a8\u6001\u5185\u5b58","text":""},{"location":"programming/c/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/#malloc","title":"\u4e00\u3001<code>malloc</code>\u51fd\u6570","text":"<p><code>malloc</code>\u662fmemory allocate\u7684\u7f29\u5199</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\nint main(void)\n{\n    int * p = (int *)malloc(4);\n    return 0;\n}\n</code></pre> <ol> <li>\u8981\u4f7f\u7528<code>malloc()</code>\u51fd\u6570\uff0c\u5fc5\u987b\u6dfb\u52a0<code>malloc.h</code>\u8fd9\u4e2a\u5934\u6587\u4ef6</li> <li><code>malloc()</code>\u51fd\u6570\u53ea\u6709\u4e00\u4e2a\u5f62\u53c2\uff0c\u5e76\u4e14\u5f62\u53c2\u65f6\u6574\u578b</li> <li>4\u8868\u793a\u8bf7\u6c42\u7cfb\u7edf\u4e3a\u672c\u7a0b\u5e8f\u5206\u914d4\u4e2a\u5b57\u8282</li> <li><code>malloc()</code>\u51fd\u6570\u53ea\u80fd\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740</li> </ol>"},{"location":"programming/c/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/#_1","title":"\u4e8c\u3001\u52a8\u6001\u5185\u5b58\u5206\u914d\u7684\u4f7f\u7528","text":"<pre><code>int *p = (int *)malloc(len);\n</code></pre> <ol> <li>\u672c\u8bed\u53e5\u5206\u914d\u4e86\u4e24\u5757\u5185\u5b58\uff1a\u4e00\u5757\u5185\u5b58\u662f\u52a8\u6001\u5206\u914d\u7684\uff0c\u5360len\u4e2a\u5b57\u8282\uff1b\u53e6\u4e00\u4e2a\u662f\u9759\u6001\u5206\u914d\u7684\uff0c\u5e76\u4e14\u8fd9\u5757\u9759\u6001\u5185\u5b58\u662fp\u53d8\u91cf\u672c\u8eab\u6240\u5360\u7684\u5b57\u8282\uff0c\u53604\u4e2a\u5b57\u8282</li> <li>malloc\u53ea\u6709\u4e00\u4e2aint\u578b\u7684\u5f62\u53c2\uff0c\u8868\u793a\u8981\u6c42\u7cfb\u7edf\u5206\u914d\u7684\u5b57\u8282\u6570</li> <li>malloc\u51fd\u6570\u7684\u529f\u80fd\u662f\u8bf7\u6c42\u7cfb\u7edflen\u4e2a\u5b57\u8282\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u5982\u679c\u8bf7\u6c42\u5206\u914d\u6210\u529f\uff0c\u5219\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740\u3002\u5982\u679c\u5206\u914d\u4e0d\u6210\u529f\uff0c\u5219\u8fd4\u56deNULL\u3002</li> <li>malloch\u51fd\u6570\u80fd\u4e14\u53ea\u80fd\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740\uff0c\u6240\u4ee5\u9700\u8981\u628a\u8fd9\u4e2a\u65e0\u4efb\u4f55\u5b9e\u9645\u610f\u4e49\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740\u8f6c\u5316\u4e3a\u4e00\u4e2a\u6709\u5b9e\u9645\u610f\u4e49\u7684\u5730\u5740\uff0c\u56e0\u6b64\uff0cmalloc\u524d\u9762\u5fc5\u987b\u52a0<code>&lt;\u6570\u636e\u7c7b\u578b&gt; *</code>\u8868\u793a\u628a\u8fd9\u4e2a\u65e0\u610f\u4e49\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740\u8f6c\u5316\u4e3a\u76f8\u5e94\u7c7b\u578b\u7684\u5730\u5740\u3002\u5982<code>int\u00a0*p\u00a0=\u00a0(int *)malloc(100);</code>\u7684\u542b\u4e49\u4e3a\uff1a\u5c06\u7cfb\u7edf\u5206\u914d\u597d\u7684100\u4e2a\u5b57\u8282\u7684\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740\u8f6c\u5316\u4e3a<code>int\u00a0*</code>\u578b\u7684\u5730\u5740\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\u662f\u5427\u7b2c\u4e00\u4e2a\u5b57\u8282\u7684\u5730\u5740\u8f6c\u4e3a4\u4e2a\u5b57\u8282\u7684\u5730\u5740\uff0c\u8fd9\u6837p\u5c31\u6307\u5411\u4e86\u7b2c\u4e00\u4e2a\u76844\u4e2a\u5b57\u8282\uff0cp+1\u5c31\u6307\u5411\u4e86\u7b2c2\u4e2a4\u4e2a\u5b57\u8282\uff0cp+i\u5c31\u6307\u5411\u4e86\u7b2ci+1\u4e2a\u76844\u4e2a\u5b57\u8282\u3002p[0]\u5c31\u662f\u7b2c\u4e00\u4e2a\u5143\u7d20\uff0cp[i]\u5c31\u662fi+1\u4e2a\u5143\u7d20\u3002</li> </ol>"},{"location":"programming/c/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/#3-freep","title":"3. freep","text":"<pre><code>freep(p);\n</code></pre> <p>\u8868\u793a\u628ap\u6240\u6307\u5411\u7684\u5185\u5b58\u7ed9\u91ca\u653e\u6389\u3002</p> <p>p\u672c\u8eab\u7684\u5185\u5b58\u662f\u9759\u6001\u7684\uff0c\u4e0d\u80fd\u7531\u7a0b\u5e8f\u5458\u624b\u52a8\u91ca\u653e\uff0cp\u672c\u8eab\u7684\u5185\u5b58\u53ea\u80fd\u5728p\u53d8\u91cf\u6240\u5728\u7684\u51fd\u6570\u8fd0\u884c\u7ec8\u6b62\u65f6\u7531\u7cfb\u7edf\u81ea\u52a8\u91ca\u653e\u3002</p>"},{"location":"programming/c/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/#4","title":"4. \u9759\u6001\u5185\u5b58\u548c\u52a8\u6001\u5185\u5b58\u7684\u6bd4\u8f83","text":"<ol> <li>\u9759\u6001\u5185\u5b58\u662f\u6709\u7cfb\u7edf\u81ea\u52a8\u5206\u914d\u7684\uff0c\u7531\u7cfb\u7edf\u81ea\u52a8\u91ca\u653e\uff1b\u9759\u6001\u5185\u5b58\u662f\u5728\u6808\u5206\u914d\u7684\u3002</li> <li>\u52a8\u6001\u5185\u5b58\u662f\u7531\u7a0b\u5e8f\u5458\u624b\u52a8\u5206\u914d\u7684\uff0c\u624b\u52a8\u91ca\u653e\uff1b\u52a8\u6001\u5185\u5b58\u662f\u5728\u5806\u5206\u914d\u7684\u3002</li> </ol>"},{"location":"programming/c/%E5%8A%A8%E6%80%81%E5%86%85%E5%AD%98/#5","title":"5. \u8de8\u51fd\u6570\u4f7f\u7528\u5185\u5b58","text":"<p>\u9759\u6001\u5185\u5b58\u4e0d\u80fd\u8de8\u51fd\u6570\u4f7f\u7528\uff1a</p> <ol> <li>\u9759\u6001\u5185\u5b58\u5728\u51fd\u6570\u6267\u884c\u671f\u95f4\u53ef\u4ee5\u88ab\u5176\u4ed6\u51fd\u6570\u4f7f\u7528</li> <li>\u9759\u6001\u5185\u5b58\u5728\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e\u5c31\u4e0d\u80fd\u88ab\u5176\u4ed6\u51fd\u6570\u4f7f\u7528\u4e86</li> </ol> <pre><code>#include &lt;stdio.h&gt;\n\nvoid f(int **q)  // q\u662f\u6307\u9488\u53d8\u91cf\u3002\u65e0\u8bbaq\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u6307\u9488\u53d8\u91cf\uff0c\u90fd\u53ea\u53604\u4e2a\u5b57\u8282\n{\n    int i = 5;\n    // *q\u7b49\u4ef7\u4e8ep\n    *q = &amp;i;  // p = &amp;i;\n}\n\nint main(void)\n{\n    int *p;\n    f(&amp;p);\n    printf(\"%d\\n\", *p); // 5  // \u672c\u8bed\u53e5\u8bed\u6cd5\u6ca1\u6709\u9519\u8bef\uff0c\u4f46\u662f\u903b\u8f91\u9519\u8bef\n    return 0;\n}\n</code></pre> <p>\u52a8\u6001\u5185\u5b58\u53ef\u4ee5\u8de8\u51fd\u6570\u4f7f\u7528\uff1a</p> <ol> <li>\u52a8\u6001\u5185\u5b58\u5728\u51fd\u6570\u6267\u884c\u5b8c\u6bd5\u4e4b\u540e\u4ecd\u53ef\u4ee5\u88ab\u5176\u4ed6\u51fd\u6570\u4f7f\u7528</li> </ol> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;malloc.h&gt;\nvoid f(int **q)  // q\u662f\u6307\u9488\u53d8\u91cf\u3002\u65e0\u8bbaq\u662f\u4ec0\u4e48\u7c7b\u578b\u7684\u6307\u9488\u53d8\u91cf\uff0c\u90fd\u53ea\u53604\u4e2a\u5b57\u8282\n{\n    *q = (int *)malloc(sizeof(int));\n    **q = 5;\n}\n\nint main(void)\n{\n    int *p;\n    f(&amp;p);\n    printf(\"%d\\n\", *p);\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/","title":"\u57fa\u672c\u6982\u5ff5","text":""},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_1","title":"\u4e00\u3001\u6570\u636e\u7c7b\u578b","text":""},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#1","title":"1. \u57fa\u672c\u6570\u636e\u7c7b\u578b","text":"<ol> <li>\u6574\u6570<ol> <li>int</li> <li>short int</li> <li>long int</li> </ol> </li> <li>\u6d6e\u70b9\u6570<ol> <li>float</li> <li>double </li> </ol> </li> <li>\u5b57\u7b26<ol> <li>char</li> </ol> </li> </ol>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#2","title":"2. \u590d\u5408\u6570\u636e\u7c7b\u578b","text":"<ol> <li>\u7ed3\u6784\u4f53</li> <li>\u679a\u4e3e</li> <li>\u5171\u7528\u4f53</li> </ol>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_2","title":"\u4e8c\u3001\u53d8\u91cf","text":"<p>\u53d8\u91cf\u7684\u672c\u8d28\u5c31\u662f\u5185\u5b58\u4e2d\u4e00\u6bb5\u5b58\u50a8\u7a7a\u95f4\uff0c \u662f\u4e00\u4e2a\u4fdd\u5b58\u6570\u636e\u7684\u5730\u65b9\uff0c\u53d8\u91cf\u9700\u8981\u4e00\u4e2a\u540d\u5b57\uff0c\u53d8\u91cf\u7684\u540d\u5b57\u662f\u4e00\u79cd\u6807\u8bc6\u7b26\u3002 </p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#1_1","title":"1. \u53d8\u91cf\u547d\u540d\u89c4\u5219","text":"<ol> <li>\u53ea\u80fd\u7531\u6570\u5b57\u3001\u5b57\u6bcd\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210</li> <li>\u6570\u5b57\u4e0d\u53ef\u4ee5\u51fa\u73b0\u5728\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\u4e0a</li> <li>C\u8bed\u8a00\u7684\u4fdd\u7559\u5b57\uff08\u5173\u952e\u5b57\uff09\u4e0d\u80fd\u505a\u6807\u8bc6\u7b26\u3002</li> </ol>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#2_1","title":"2. \u53d8\u91cf\u5b9a\u4e49","text":"<pre><code>//&lt;\u7c7b\u578b\u540d\u79f0&gt;  &lt;\u53d8\u91cf\u540d\u79f0&gt;;\nint price;\n</code></pre>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#3","title":"3. \u53d8\u91cf\u8d4b\u503c","text":"<pre><code>price = 100;\n</code></pre>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#4","title":"4. \u53d8\u91cf\u521d\u59cb\u5316","text":"<p>\u5f53\u8d4b\u503c\u53d1\u751f\u5728\u5b9a\u4e49\u53d8\u91cf\u7684\u65f6\u5019\uff0c\u5c31\u662f\u53d8\u91cf\u7684\u521d\u59cb\u5316\u3002\u6240\u6709\u7684\u53d8\u91cf\u5728\u7b2c\u4e00\u6b21\u88ab\u4f7f\u7528\u4e4b\u524d\u5e94\u8be5\u88ab\u8d4b\u503c\u4e00\u6b21\u3002 </p> <pre><code>// &lt;\u53d8\u91cf\u7c7b\u578b&gt; &lt;\u53d8\u91cf\u540d\u79f0&gt; = &lt;\u521d\u59cb\u503c&gt;\nint price = 0\n</code></pre>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#5","title":"5. \u53d8\u91cf\u7684\u5206\u7c7b","text":""},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#51","title":"5.1 \u6309\u4f5c\u7528\u57df\u5206","text":""},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#1_2","title":"1. \u5168\u5c40\u53d8\u91cf","text":"<p>\u5728\u6240\u6709\u51fd\u6570\u5916\u90e8\u5b9a\u4e49\u7684\u53d8\u91cf\u3002</p> <p>\u5168\u5c40\u53d8\u91cf\u4f7f\u7528\u8303\u56f4\uff1a\u4ece\u5b9a\u4e49\u4f4d\u7f6e\u5f00\u59cb\u5230\u6574\u4e2a\u7a0b\u5e8f\u7ed3\u675f</p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#2_2","title":"2. \u5c40\u90e8\u53d8\u91cf","text":"<p>\u5728\u4e00\u51fd\u6570\u5185\u90e8\u5b9a\u4e49\u7684\u53d8\u91cf\u6216\u51fd\u6570\u7684\u5f62\u53c2\u90fd\u7edf\u79f0\u4e3a\u5c40\u90e8\u53d8\u91cf</p> <p>\u5c40\u90e8\u53d8\u91cf\u7684\u4f7f\u7528\u8303\u56f4\uff1a\u53ea\u80fd\u5728\u672c\u51fd\u6570\u5185\u90e8\u4f7f\u7528</p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#52","title":"5.2 \u6309\u5b58\u50a8\u65b9\u5f0f\u5206","text":"<ol> <li>\u9759\u6001\u53d8\u91cf</li> <li>\u81ea\u52a8\u53d8\u91cf</li> <li>\u5bc4\u5b58\u5668\u53d8\u91cf</li> </ol>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_3","title":"\u4e09\u3001\u8868\u8fbe\u5f0f","text":"<p>\u8868\u8fbe\u5f0f\u662f\u7b97\u5b50\u548c\u8fd0\u7b97\u7b26\u7684\u7ec4\u5408 </p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#_4","title":"\u56db\u3001\u8fd0\u7b97\u7b26","text":""},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#1_3","title":"1. \u7b97\u6570\u8fd0\u7b97\u7b26","text":"<p><code>+</code>\u3001<code>-</code>\u3001<code>*</code>\u3001<code>/</code>\u3001<code>%</code></p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#2_3","title":"2. \u5173\u7cfb\u8fd0\u7b97\u7b26","text":"<p><code>&gt;</code>\u3001<code>&gt;=</code>\u3001<code>&lt;</code>\u3001<code>&lt;=</code>\u3001<code>!=</code>\u3001<code>==</code></p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#3_1","title":"3. \u903b\u8f91\u8fd0\u7b97\u7b26","text":"<p><code>!</code>\u3001<code>&amp;&amp;</code>\u3001<code>||</code></p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#4_1","title":"4. \u8d4b\u503c\u8fd0\u7b97\u7b26","text":"<p><code>=</code>\u3001<code>+=</code>\u3001<code>*=</code>\u3001<code>/=</code>\u3001<code>-=</code></p>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#5_1","title":"5. \u9012\u589e\u9012\u51cf\u8fd0\u7b97\u7b26","text":"<p><code>++</code>\u548c<code>--</code>\u53ef\u4ee5\u653e\u5728\u53d8\u91cf\u524d\u9762\uff0c\u53eb\u524d\u7f00\u5f62\u5f0f\uff0c\u653e\u5728\u53d8\u91cf\u540e\u9762\u53eb\u540e\u7f00\u5f62\u5f0f\u3002</p> <p><code>a++</code>\u7684\u503c\u662f<code>a+1</code>\u4ee5\u524d\u7684\u503c\uff0c<code>++a</code>\u7684\u503c\u662f\u52a01\u4ee5\u540e\u7684\u503c</p> \u8868\u8fbe\u5f0f \u8fd0\u7b97 \u8868\u8fbe\u5f0f\u7684\u503c a++ \u7ed9a\u52a01 a\u539f\u6765\u7684\u503c ++a \u7ed9a\u52a01 a+1\u4ee5\u540e\u7684\u503c a-- \u7ed9a\u51cf1 a\u539f\u6765\u7684\u503c --a \u7ed9a\u51cf1 a-1\u4ee5\u540e\u7684\u503c <pre><code>#include &lt;stdio.h&gt;\n\nint main(){\n    int a=10;\n    printf(\"a++=%d\\n\", a++);  //a++\u7684\u503c\u4e3a10\n    printf(\"a  =%d\\n\", a);    //a+1\u4ee5\u540e\u7684\u503c\uff0c\u6b64\u65f6a\u4e3a11\n    printf(\"++a=%d\\n\", ++a);  //++a\u7684\u503c\u4e3aa+1\u4ee5\u540e\u7684\u503c\uff0c\u7b49\u4e8e12\n    printf(\"a  =%d\\n\", a);    //a+1\u4ee5\u540e\u7684\u503c\uff0c\u7b49\u4e8e12\n    printf(\"a--=%d\\n\", a--);  //a--\u7684\u503c\u4e3aa\u539f\u6765\u7684\u503c\uff0c\u7b49\u4e8e12\n    printf(\"a  =%d\\n\", a);    //a=a\uff0811\uff09-1\u4ee5\u540e\u7684\u503c\uff0c\u7b49\u4e8e11\n    printf(\"--a=%d\\n\", --a);  //--a\u4e3aa-1\u4ee5\u540e\u7684\u503c\u7b49\u4e8e10\n    printf(\"a  =%d\\n\", a);    //a=a-1\u4ee5\u540e\u7684\u503c\uff0c\u7b49\u4e8e10\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/#6","title":"6. \u8fd0\u7b97\u7b26\u7684\u4f18\u5148\u7ea7","text":"<p>\u7b97\u6570&gt;\u5173\u7cfb&gt;\u903b\u8f91&gt;\u8d4b\u503c</p>"},{"location":"programming/c/%E6%8C%87%E9%92%88/","title":"\u6307\u9488","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#_1","title":"\u4e00\u3001\u6307\u9488\u7684\u91cd\u8981\u6027","text":"<ol> <li>\u8868\u793a\u4e00\u4e9b\u590d\u6742\u7684\u6570\u636e\u7ed3\u6784</li> <li>\u5feb\u901f\u7684\u4f20\u9012\u6570\u636e\uff0c\u51cf\u5c11\u4e86\u5185\u5b58\u7684\u6d88\u8017</li> <li>\u4f7f\u51fd\u6570\u8fd4\u56de\u4e00\u4e2a\u4ee5\u4e0a\u7684\u503c</li> <li>\u80fd\u76f4\u63a5\u8bbf\u95ee\u786c\u4ef6</li> <li>\u80fd\u591f\u65b9\u4fbf\u7684\u5904\u7406\u5b57\u7b26\u4e32</li> <li>\u662f\u7406\u89e3\u9762\u5411\u5bf9\u8c61\u8bed\u8a00\u4e2d\u5f15\u7528\u7684\u57fa\u7840</li> <li>\u6307\u9488\u662fC\u8bed\u8a00\u7684\u7075\u9b42</li> </ol>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#_2","title":"\u4e8c\u3001\u6307\u9488\u7684\u5b9a\u4e49","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#1","title":"1. \u5730\u5740","text":"<ol> <li>\u5185\u5b58\u5355\u5143\u7684\u7f16\u53f7</li> <li>\u4ece0\u5f00\u59cb\u7684\u975e\u8d1f\u6574\u6570</li> </ol>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#2","title":"2. \u6307\u9488","text":"<ol> <li>\u6307\u9488\u5c31\u662f\u5730\u5740\uff0c\u5730\u5740\u5c31\u662f\u6307\u9488</li> <li>\u6307\u9488\u53d8\u91cf\u5c31\u662f\u5b58\u653e\u5185\u5b58\u5355\u5143\u7f16\u53f7\u7684\u53d8\u91cf\uff0c\u6216\u8005\u8bf4\u6307\u9488\u53d8\u91cf\u5c31\u662f\u5b58\u653e\u5730\u5740\u7684\u53d8\u91cf</li> <li>\u6307\u9488\u548c\u6307\u9488\u53d8\u91cf\u7684\u4e24\u4e2a\u4e0d\u540c\u7684\u6982\u5ff5</li> <li>\u901a\u5e38\u6211\u4eec\u53d9\u8ff0\u65f6\u4f1a\u628a\u6307\u9488\u53d8\u91cf\u7b80\u79f0\u4e3a\u6307\u9488\uff0c\u5b9e\u9645\u5b83\u4eec\u542b\u4e49\u5e76\u4e0d\u4e00\u6837</li> <li>\u6307\u9488\u7684\u672c\u8d28\u5c31\u662f\u4e00\u4e2a\u64cd\u4f5c\u53d7\u9650\u7684\u975e\u8d1f\u6574\u6570</li> </ol>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#_3","title":"\u4e09\u3001\u6307\u9488\u7684\u5206\u7c7b","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#1_1","title":"1. \u57fa\u672c\u7c7b\u578b\u6307\u9488","text":"<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char const *argv[])\n{\n    int *p;\n    int i = 3;\n    p = &amp;i;\n    printf(\"%p\\n\", p);  // 0x7ffff3688088\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#1_2","title":"1. \u6307\u9488\u7684\u7406\u89e3","text":"<pre><code>int *p;\n</code></pre> <ol> <li> <p><code>p</code>\u662f\u53d8\u91cf\u7684\u540d\u5b57\uff0c<code>int *</code>\u8868\u793ap\u53d8\u91cf\u5b58\u653e\u7684\u662fint\u7c7b\u578b\u53d8\u91cf\u7684\u5730\u5740</p> </li> <li> <p><code>int\u00a0*p;</code>\u4e0d\u8868\u793a\u5b9a\u4e49\u4e86\u4e00\u4e2a\u540d\u5b57\u53eb\u505a<code>*p</code>\u7684\u53d8\u91cf</p> </li> <li>\u5e94\u8be5\u8fd9\u6837\u7406\u89e3\uff1a<code>p</code>\u662f\u53d8\u91cf\u540d\uff0c<code>p</code>\u53d8\u91cf\u7684\u6570\u636e\u7c7b\u578b\u662f<code>int *</code>\u7c7b\u578b\uff0c\u6240\u8c13<code>int *</code>\u7c7b\u578b\uff0c\u5b9e\u9645\u5c31\u662f\u5b58\u653e<code>int</code>\u53d8\u91cf\u5730\u5740\u7684\u7c7b\u578b</li> </ol> <pre><code>p = &amp;i;\n</code></pre> <ol> <li>p\u4fdd\u5b58\u4e86i\u7684\u5730\u5740\uff0c\u56e0\u6b64p\u6307\u5411i</li> <li>p\u4e0d\u662fi\uff0ci\u4e5f\u4e0d\u662fp\uff0c\u66f4\u51c6\u786e\u7684\u8bf4\uff1a\u4fee\u6539p\u7684\u503c\u4e0d\u5f71\u54cdi\u7684\u503c\uff0c\u4fee\u6539i\u7684\u503c\u4e5f\u4e0d\u4f1a\u5f71\u54cdp\u7684\u503c<ol> <li>\u5982\u679c\u4e00\u4e2a\u6307\u9488\u53d8\u91cf\u6307\u5411\u4e86\u67d0\u4e2a\u666e\u901a\u53d8\u91cf\uff0c\u5219<code>*\u6307\u9488\u53d8\u91cf</code>\u5c31\u5b8c\u5168\u7b49\u540c\u4e8e<code>\u666e\u901a\u53d8\u91cf</code>\uff0c\u4f8b\u5982\u6b64\u5904<code>*p</code>\u5c31\u5b8c\u5168\u7b49\u540c\u4e8e<code>i</code></li> </ol> </li> </ol> <p><code>*</code>\u7684\u542b\u4e49\uff1a</p> <ol> <li>\u4e58\u6cd5</li> <li>\u5b9a\u4e49\u6307\u9488\u53d8\u91cf</li> <li>\u6307\u9488\u8fd0\u7b97\u7b26\uff0c\u8be5\u8fd0\u7b97\u7b26\u653e\u5728\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u6307\u9488\u53d8\u91cf\u524d\u9762\uff0c\u5982\u679cp\u662f\u4e00\u4e2a\u5df2\u7ecf\u5b9a\u4e49\u597d\u7684\u6307\u9488\u53d8\u91cf\uff0c\u5219<code>*p</code>\u8868\u793a\u4ee5p\u7684\u5185\u5bb9\u4e3a\u5730\u5740\u7684\u53d8\u91cf\u3002</li> </ol>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#2_1","title":"2. \u6307\u9488\u5e38\u89c1\u9519\u8bef","text":"<p>\u9519\u8bef1\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char const *argv[])\n{\n    int *p;\n    int i = 5;\n    *p = i;\n    printf(\"%d\\n\", *p);\n    return 0;\n}\n// \u8fd0\u884c\u9519\u8befSegmentation fault (core dumped)\n</code></pre> <p>\u9519\u8bef2\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char const *argv[])\n{\n    int *p;\n    int *q;\n    int i = 5;\n    p = &amp;i;\n    *q = p;  // \u8bed\u6cd5\u9519\u8bef\n    printf(\"%d\\n\", *q);\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#3","title":"3. \u6307\u9488\u53d8\u91cf\u7684\u8fd0\u7b97","text":"<ol> <li>\u6307\u9488\u53d8\u91cf\u4e0d\u80fd\u76f8\u52a0\u3001\u4e0d\u80fd\u76f8\u4e58\u3001\u4e0d\u80fd\u76f8\u9664</li> <li>\u5982\u679c\u4e24\u4e2a\u6307\u9488\u53d8\u91cf\u6307\u5411\u7684\u662f\u540c\u4e00\u5757\u8fde\u7eed\u7a7a\u95f4\u4e2d\u7684\u4e0d\u540c\u5b58\u50a8\u5355\u5143\uff0c\u5219\u8fd9\u4e24\u4e2a\u6307\u9488\u53d8\u91cf\u624d\u53ef\u4ee5\u76f8\u51cf\u3002</li> </ol>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#4-","title":"4. \u6307\u9488\u7ecf\u5178\u7a0b\u5e8f-\u4e92\u6362\u4e24\u4e2a\u6570\u5b57","text":"<pre><code>#include &lt;stdio.h&gt;\nvoid swap(int *p, int *q)\n{\n    int t;\n    t = *p;\n    *p = *q;\n    *q = t;\n}\nint main(int argc, char const *argv[])\n{\n    int a = 3;\n    int b = 5;\n    swap(&amp;a, &amp;b);\n    printf(\"a = %d, b = %d\\n\", a, b);\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#2_2","title":"2. \u6307\u9488\u548c\u6570\u7ec4","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#21","title":"2.1 \u6307\u9488\u548c\u4e00\u7ef4\u6570\u7ec4","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#1_3","title":"1. \u6307\u9488\u548c\u6570\u7ec4\u540d","text":"<p>\u4e00\u7ef4\u6570\u7ec4\u540d\u662f\u4e2a\u6307\u9488\u5e38\u91cf\uff0c\u5b83\u5b58\u653e\u7684\u662f\u4e00\u7ef4\u6570\u7ec4\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5730\u5740</p>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#2_3","title":"2. \u6307\u9488\u548c\u4e0b\u6807","text":"<p>\u5982\u679cp\u662f\u4e2a\u6307\u9488\u53d8\u91cf\uff0c\u5219<code>p[i]</code>\u6c38\u8fdc\u7b49\u4ef7\u4e8e<code>*(p+i)</code></p>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#3_1","title":"3. \u51fd\u6570\u5904\u7406\u6570\u7ec4","text":"<p>\u5982\u679c\u51fd\u6570\u8981\u5904\u7406\u4e00\u4e2a\u4e00\u7ef4\u6570\u7ec4\uff0c\u5219\u9700\u8981\u63a5\u6536\u8be5\u6570\u7ec4\u76842\u4e2a\u4fe1\u606f\uff1a</p> <ol> <li>\u6570\u7ec4\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5730\u5740</li> <li>\u6570\u7ec4\u7684\u957f\u5ea6</li> </ol>"},{"location":"programming/c/%E6%8C%87%E9%92%88/#3_2","title":"3. \u6307\u9488\u548c\u51fd\u6570","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#4","title":"4. \u6307\u9488\u548c\u7ed3\u6784\u4f53","text":""},{"location":"programming/c/%E6%8C%87%E9%92%88/#5","title":"5. \u591a\u7ea7\u6307\u9488","text":"<pre><code>int i = 10; \nint *p = &amp;i;  // p\u53ea\u80fd\u5b58\u653eint\u7c7b\u578b\u53d8\u91cf\u7684\u5730\u5740\nint **q = &amp;p;  // q\u662fint **\u7c7b\u578b\uff0cp\u53ea\u80fd\u5b58\u653eint *\u7c7b\u578b\u53d8\u91cf\u7684\u5730\u5740\nint ***r = &amp;q;  // r\u662fint ***\u7c7b\u578b\uff0cr\u53ea\u80fd\u5b58\u653eint **\u7c7b\u578b\u53d8\u91cf\u7684\u5730\u5740\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/","title":"\u6570\u7ec4","text":"<p>\u6570\u7ec4\u7684\u4f5c\u7528\uff1a\u89e3\u51b3\u5927\u91cf\u540c\u7c7b\u6570\u636e\u7684\u5b58\u50a8\u548c\u4f7f\u7528\u95ee\u9898</p>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#_1","title":"\u4e00\u3001\u4e00\u7ef4\u6570\u7ec4","text":"<ol> <li>\u4e3an\u4e2a\u53d8\u91cf\u8fde\u7eed\u5206\u914d\u5b58\u50a8\u7a7a\u95f4</li> <li>\u6240\u6709\u7684\u53d8\u91cf\u6570\u636e\u7c7b\u578b\u5fc5\u987b\u76f8\u540c</li> <li>\u6240\u6709\u53d8\u91cf\u6240\u5360\u7684\u5b57\u8282\u5927\u5c0f\u5fc5\u987b\u76f8\u7b49</li> </ol>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#1","title":"1. \u5b9a\u4e49","text":"<pre><code>int arr[5];\n// \u4e00\u7ef4\u6570\u7ec4\u540d\u4e0d\u4ee3\u8868\u6570\u7ec4\u4e2d\u6240\u6709\u7684\u5143\u7d20\n// \u4e00\u4f4d\u6570\u7ec4\u540d\u4ee3\u8868\u6570\u7ec4\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5730\u5740\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#2","title":"2. \u521d\u59cb\u5316","text":""},{"location":"programming/c/%E6%95%B0%E7%BB%84/#1_1","title":"1. \u5b8c\u5168\u521d\u59cb\u5316","text":"<pre><code>int arr[5] = {1, 2, 3, 4, 5};\n// \u9519\u8bef\u5199\u6cd5\n// int arr[5];\n// arr[5] = {1, 2, 3, 4, 5};\n// \u53ea\u6709\u5728\u5b9a\u4e49\u521d\u59cb\u7684\u540c\u65f6\u624d\u53ef\u6574\u4f53\u8d4b\u503c\uff0c\u5176\u4ed6\u60c5\u51b5\u4e0b\u6574\u4f53\u8d4b\u503c\u90fd\u662f\u9519\u8bef\u7684\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#2_1","title":"2.\u4e0d\u5b8c\u5168\u521d\u59cb\u5316","text":"<pre><code>int arr[5] = {1, 2, 3};\n// \u672a\u521d\u59cb\u5316\u7684\u5143\u7d20\u81ea\u52a8\u4e3a0\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#3","title":"3. \u4e0d\u521d\u59cb\u5316","text":"<pre><code>int arr[5];\n// \u6240\u6709\u5143\u7d20\u90fd\u662f\u5783\u573e\u503c\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#4","title":"4. \u6e05\u96f6","text":"<pre><code>int arr[5] = {0};\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#_2","title":"\u4e8c\u3001\u4e8c\u7ef4\u6570\u7ec4","text":"<pre><code>int arr[3][4];\n//\u603b\u517112\u4e2a\u5143\u7d20\uff0c\u53ef\u4ee5\u5f533\u884c4\u5217\u6765\u770b\u5f85\uff0c\u8fd912\u4e2a\u5143\u7d20\u7684\u540d\u5b57\u4e00\u6b21\u662f\n//arr[0][0] arr[0][1] arr[0][2] arr[0][3]\n//arr[1][0] arr[1][1] arr[1][2] arr[1][2]\n//arr[2][0] arr[2][1] arr[2][2] arr[2][2]  \n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#1_2","title":"1. \u521d\u59cb\u5316","text":"<pre><code>int arr[3][4] = {1,2,3,4,5,6,7,8,9,10,11,12};\n//\u6216\nint arr[3][4] = {\n    {1, 2, 3, 4},\n    {5, 6, 7, 8},\n    {9, 10, 11, 12},\n}\n</code></pre>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#_3","title":"\u4e09\u3001\u591a\u7ef4\u6570\u7ec4","text":"<ol> <li>\u4e0d\u5b58\u5728\u591a\u7ef4\u6570\u7ec4</li> <li>\u5185\u5b58\u662f\u7ebf\u6027\u4e00\u7ef4\u7684</li> <li>n\u7ef4\u6570\u7ec4\u53ef\u4ee5\u5f53\u505a\u6bcf\u4e2a\u5143\u7d20\u662fn-1\u7ef4\u6570\u7ec4\u7684\u4e00\u7ef4\u6570\u7ec4</li> </ol>"},{"location":"programming/c/%E6%95%B0%E7%BB%84/#_4","title":"\u56db\u3001\u6570\u7ec4\u7684\u7f3a\u70b9","text":"<ol> <li>\u6570\u7ec4\u957f\u5ea6\u5fc5\u987b\u4e8b\u5148\u6307\u5b9a\uff0c\u4e14\u53ea\u80fd\u662f\u5e38\u6574\u6570\uff0c\u4e0d\u80fd\u662f\u53d8\u91cf</li> <li>\u4f20\u7edf\u5f62\u5f0f\u5b9a\u4e49\u7684\u6570\u7ec4\uff0c\u8be5\u6570\u7ec4\u7684\u5185\u5b58\u987b\u53d1\u624b\u52a8\u91ca\u653e</li> <li>\u6570\u7ec4\u7684\u957f\u5ea6\u4e00\u65e6\u5b9a\u4e49\uff0c\u5176\u957f\u5ea6\u5c31\u4e0d\u80fd\u66f4\u6539</li> <li>\u51fd\u6570f\u5b9a\u4e49\u7684\u6570\u7ec4\uff0c\u5728\u51fd\u6570f\u8fd0\u884c\u671f\u95f4\u53ef\u4ee5\u88ab\u5176\u4ed6\u51fd\u6570\u4f7f\u7528\uff0c\u4f46\u51fd\u6570\u8fd0\u884c\u5b8c\u6bd5\u4e4b\u540e\uff0c\u51fd\u6570\u4e2d\u7684\u6570\u7ec4\u5c06\u65e0\u6cd5\u88ab\u5176\u4ed6\u51fd\u6570\u4f7f\u7528</li> <li>\u4f20\u7edf\u65b9\u5f0f\u5b9a\u4e49\u7684\u6570\u7ec4\u4e0d\u80fd\u8de8\u51fd\u6570\u4f7f\u7528</li> </ol>"},{"location":"programming/c/%E6%9E%9A%E4%B8%BE/","title":"\u679a\u4e3e","text":""},{"location":"programming/c/%E6%9E%9A%E4%B8%BE/#_1","title":"\u4e00\u3001\u4ec0\u4e48\u662f\u679a\u4e3e","text":"<p>\u628a\u4e00\u4e2a\u4e8b\u7269\u6240\u6709\u53ef\u80fd\u7684\u53d6\u503c\u4e00\u4e00\u5217\u4e3e\u51fa\u6765</p>"},{"location":"programming/c/%E6%9E%9A%E4%B8%BE/#_2","title":"\u4e8c\u3001\u679a\u4e3e\u7684\u4f7f\u7528","text":"<pre><code>#include &lt;stdio.h&gt;\n\n// \u53ea\u5b9a\u4e49\u4e86\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\uff0c\u5e76\u6ca1\u6709\u5b9a\u4e49\u53d8\u91cf\uff0c\u8be5\u6570\u636e\u7c7b\u578b\u7684\u540d\u5b57\u53ebenum WeekDay\nenum WeekDay\n{\n    Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday\n};\n\nint main(void)\n{\n    enum WeekDay day = Monday;\n    printf(\"%d\\n\", day);  // 0\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%9E%9A%E4%B8%BE/#_3","title":"\u4e09\u3001\u679a\u4e3e\u7684\u4f18\u7f3a\u70b9","text":"<ol> <li>\u4ee3\u7801\u66f4\u5b89\u5168</li> <li>\u4e66\u5199\u9ebb\u70e6</li> </ol>"},{"location":"programming/c/%E6%A6%82%E8%BF%B0/","title":"\u6982\u8ff0","text":""},{"location":"programming/c/%E6%A6%82%E8%BF%B0/#c","title":"\u4e00\u3001\u7b2c\u4e00\u4e2aC\u7a0b\u5e8f","text":"<pre><code>#include &lt;stdio.h&gt;\nint main(int argc, char const *argv[])\n{\n    printf(\"Hello World!\\n\");\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%A6%82%E8%BF%B0/#c_1","title":"\u4e8c\u3001C\u8bed\u8a00\u6982\u8ff0","text":""},{"location":"programming/c/%E6%A6%82%E8%BF%B0/#1","title":"1. \u7279\u70b9","text":"<p>\u4f18\u70b9\uff1a</p> <ol> <li>\u4ee3\u7801\u91cf\u5c0f</li> <li>\u901f\u5ea6\u5feb</li> <li>\u529f\u80fd\u5f3a\u5927</li> </ol> <p>\u7f3a\u70b9\uff1a</p> <ol> <li>\u5371\u9669\u9ad8</li> <li>\u5f00\u53d1\u5468\u671f\u957f</li> <li>\u53ef\u79fb\u690d\u6027\u5dee</li> </ol>"},{"location":"programming/c/%E6%A6%82%E8%BF%B0/#2","title":"2. \u5e94\u7528\u9886\u57df","text":"<ol> <li>\u64cd\u4f5c\u7cfb\u7edf</li> <li>\u9a71\u52a8\u7a0b\u5e8f</li> <li>\u6570\u636e\u5e93</li> <li>\u5e94\u7528\u8f6f\u4ef6</li> </ol>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/","title":"\u6d41\u7a0b\u63a7\u5236","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#_1","title":"\u4e00\u3001\u4ec0\u4e48\u662f\u6d41\u7a0b\u63a7\u5236","text":"<p>\u4ee3\u7801\u6267\u884c\u7684\u987a\u5e8f</p>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#_2","title":"\u4e8c\u3001\u6d41\u7a0b\u63a7\u5236\u7684\u5206\u7c7b","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#1","title":"1. \u987a\u5e8f","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#2","title":"2. \u9009\u62e9","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#21-if","title":"2.1. <code>if</code>","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#1-if","title":"1. <code>if</code>","text":"<pre><code>if (/* condition */)\n{\n    /* code */\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#2-if-else","title":"2. <code>if\u00a0else</code>","text":"<pre><code>if (/* condition */)\n{\n     /* code */\n} else\n{\n    /* code */\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#3-if-else-if","title":"3. <code>if\u00a0else\u00a0if</code>","text":"<pre><code>if (/* condition */)\n{\n    /* code */\n}\nelse if (/* condition */)\n{\n    /* code */\n}\nelse\n{\n    /* code */\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#22-switch","title":"2.2 <code>switch</code>","text":"<pre><code>switch (expression)\n{\n    case /* constant-expression */:\n        /* code */\n        break;\n\n    default:\n        break;\n}\n</code></pre> <p>\u4f8b1\uff1a</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int type;\n    scanf(\"%d\", &amp;type);\n    switch (type)\n    {\n    case 1:\n        printf(\"\u65e9\u4e0a\u597d\\n\");\n        break;\n    case 2:\n        printf(\"\u4e2d\u5348\u597d\\n\");\n        break;\n    case 3:\n        printf(\"\u665a\u4e0a\u597d\\n\");\n        break;\n    default:\n        printf(\"\u554a\uff0c\u4ec0\u4e48\u554a\uff1f\\n\");\n        break;\n    }\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#3","title":"3. \u5faa\u73af","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#31-while","title":"3.1 <code>while</code>","text":"<p>\u8bed\u6cd5\u683c\u5f0f\uff1a</p> <pre><code>while (/* condition */)\n{\n    /* code */\n}\n</code></pre> <p>\u4f8b1\uff1a\u6c42\u6b63\u6574\u6570\u7684\u4f4d\u6570</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main()\n{\n    int n = 0;\n    int x;\n    scanf(\"%d\", &amp;x);\n    while (x &gt; 0)\n    {\n        n++;\n        x /= 10;\n    }\n    printf(\"%d\\n\", n);\n    return 0;\n}\n</code></pre> <p>\u4f8b2\uff1a\u6574\u6570\u6c42\u9006</p> <pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    //\u5b9a\u4e49\u8981\u6c42\u9006\u7684\u6574\u6570\n    int x = 12345;\n    //\u4fdd\u5b58\u5355\u4e2a\u6574\u6570\n    int digit;\n    //\u4fdd\u5b58\u6700\u540e\u7ed3\u679c\n    int ret = 0;\n    while (x &gt; 0)\n    {\n        //\u53d6\u51fa\u6574\u6570\u7684\u4e2a\u4f4d\n        digit = x % 10;\n\n        ret = ret * 10 + digit;\n        //\u53bb\u9664\u539f\u6574\u6570\u7684\u672b\u4f4d\n        x = x / 10;\n    }\n    printf(\"%d\\n\", ret);  // 54321\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#32-do-while","title":"3.2 <code>do while</code>","text":"<p>\u8bed\u6cd5\u683c\u5f0f\uff1a</p> <pre><code>do\n{\n    /* code */\n} while (/* condition */);\n</code></pre> <p>\u4f8b1\uff1a\u731c\u6570\u6e38\u620f</p> <pre><code>#include &lt;stdio.h&gt;\n#include &lt;time.h&gt;\n#include &lt;stdlib.h&gt;\nint main()\n{\n    srand(time(0));\n    //\u751f\u62101\u5230100\u7684\u968f\u673a\u6570\n    int number = rand() % 100 + 1;\n    int i = 0;\n    printf(\"\u6211\u5df2\u7ecf\u60f3\u597d\u4e861\u5230100\u4e4b\u95f4\u4e00\u4e2a\u6570\u3002\\n\");\n    do\n    {\n        printf(\"\u8bf7\u731c1\u5230100\u4e4b\u95f4\u7684\u6570\uff1a\");\n        scanf(\"%d\", &amp;i);\n        if (i &gt; number)\n        {\n            printf(\"\u4f60\u731c\u7684\u6570\u5927\u4e86\\n\");\n        }\n        else if (i &lt; number)\n        {\n            printf(\"\u4f60\u731c\u7684\u6570\u5c0f\u4e86\\n\");\n        }\n    } while (i != number);\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#33-for","title":"3.3 <code>for</code>","text":"<p>\u8bed\u6cd5\u683c\u5f0f\uff1a</p> <pre><code>for (int i = 0; i &lt; count; i++)\n{\n    /* code */\n}\n</code></pre> <p>\u4f8b1\uff1a</p> \\[ f(n)=1+\\frac{1}{2} +\\frac{1}{3}+\\frac{1}{4}+\\frac{1}{5}+\\cdots+\\frac{1}{n} \\] <pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int n;\n    scanf(\"%d\", &amp;n);\n    double sum = 0;\n    for (int i = 1; i &lt;= n; i++)\n    {\n        sum += 1.0 / i;\n        printf(\"%f\\n\", sum);\n    }\n    printf(\"f(%d)=%f\", n, sum);\n    return 0;\n}\n</code></pre> <p>\u4f8b2\uff1a</p> \\[ f(n)=1-\\frac{1}{2} +\\frac{1}{3}-\\frac{1}{4}+\\frac{1}{5}-\\cdots+\\frac{1}{n} \\] <pre><code>#include &lt;stdio.h&gt;\nint main()\n{\n    int n;\n    double sum = 0;\n    double sign = 1.0;\n    scanf(\"%d\", &amp;n);\n    for (int i = 1; i &lt;= n; i++)\n    {\n        sum += sign / i;\n        sign = -sign;\n    }\n    printf(\"f(%d)=%f\", n, sum);\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#4-breakcontinue","title":"4. <code>break</code>\u548c<code>continue</code>","text":""},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#41-break","title":"4.1 <code>break</code>","text":"<ol> <li>break\u5982\u679c\u7528\u4e8e\u5faa\u73af\u662f\u7528\u6765\u7ec8\u6b62\u5faa\u73af</li> <li>break\u5982\u679c\u7528\u4e8eswitch\u5219\u662f\u7528\u6765\u7ec8\u6b62switch\uff0c\u5728\u591a\u5c42switch\u5d4c\u5957\u4e2d\uff0cbreak\u53ea\u80fd\u7ec8\u6b62\u5177\u4f53\u5b83\u6700\u8fd1\u7684switch</li> <li>break\u4e0d\u80fd\u76f4\u63a5\u7528\u4e8eif\uff0c\u9664\u975eif\u5c5e\u4e8e\u5faa\u73af\u5185\u90e8\u7684\u4e00\u4e2a\u5b50\u53e5</li> </ol> <p>\u63a5\u529bbreak</p> <pre><code>#include &lt;stdio.h&gt;\n\nint main(void)\n{\n    int money;\n    scanf(\"%d\", &amp;money);\n\n    int one, two, five;\n    int exit = 0;\n\n    for (one = 1; one &lt;= money * 10; one++)\n    {\n        for (two = 1; two &lt;= money * (10 / 2); two++)\n        {\n            for (five = 1; five &lt;= money * (10 / 5); five++)\n            {\n                if (one + two * 2 + five * 5 == money * 10)\n                {\n                    printf(\"%d\u4e2a\u4e00\u89d2%d\u4e2a\u4e24\u89d2%d\u4e2a\u4e94\u89d2\u53ef\u4ee5\u51d1\u51fa%d\u5143\u4eba\u6c11\u5e01\\n\",\n                           one, two, five, money);\n                    exit = 1;\n                    break;\n                }\n            }\n            if (exit == 1)\n                break;\n        }\n        if (exit == 1)\n            break;\n    }\n\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6/#42-continue","title":"4.2 <code>continue</code>","text":"<p>\u7528\u4e8e\u8df3\u8fc7\u672c\u6b21\u5faa\u73af\u4f59\u4e0b\u7684\u8bed\u53e5\uff0c\u8f6c\u53bb\u5224\u65ad\u662f\u5426\u9700\u8981\u6267\u884c\u4e0b\u4e00\u6b21\u5faa\u73af</p>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/","title":"\u7ed3\u6784\u4f53","text":""},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#_1","title":"\u4e00\u3001\u4e3a\u4ec0\u4e48\u9700\u8981\u7ed3\u6784\u4f53","text":"<p>\u4e3a\u4e86\u8868\u793a\u4e00\u4e9b\u8d1f\u8d23\u7684\u4e8b\u7269\uff0c\u800c\u666e\u901a\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b\u65e0\u6cd5\u6ee1\u8db3\u5b9e\u9645\u8981\u6c42</p>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#_2","title":"\u4e8c\u3001\u4e3a\u4ec0\u4e48\u53eb\u7ed3\u6784\u4f53","text":"<p>\u628a\u4e00\u4e9b\u57fa\u672c\u7c7b\u578b\u6570\u636e\u7ec4\u5408\u5728\u4e00\u8d77\u5f62\u6210\u7684\u4e00\u4e2a\u65b0\u7684\u590d\u5408\u6570\u636e\u7c7b\u578b</p>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#_3","title":"\u4e09\u3001\u5982\u4f55\u5b9a\u4e49\u7ed3\u6784\u4f53","text":"<pre><code>// \u65b9\u5f0f\u4e00\nstruct Student\n{\n    int age;\n    float score;\n    char sex;\n};\n\n// \u65b9\u5f0f\u4e8c\nstruct Student\n{\n    int age;\n    float score;\n    char sex;\n} st;\n// \u65b9\u5f0f\u4e09\nstruct\n{\n    int age;\n    float score;\n    char sex;\n} st;\n</code></pre>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#_4","title":"\u56db\u3001\u7ed3\u6784\u4f53\u53d8\u91cf\u7684\u4f7f\u7528","text":""},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#1","title":"1. \u8d4b\u503c\u548c\u521d\u59cb\u5316","text":"<pre><code>#include &lt;stdio.h&gt;\nstruct Student\n{\n    int age;\n    float score;\n    char sex;\n};\nint main(void)\n{\n    // \u65b9\u5f0f\u4e00\n    // \u5b9a\u4e49\u7684\u540c\u65f6\u53ef\u4ee5\u6574\u4f53\u8d4b\u503c\n    struct Student st1 = {19, 66.6, 'F'}; // \u521d\u59cb\u5316 \u5b9a\u4e49\u7684\u540c\u65f6\u8d4b\u503c\n    // \u65b9\u5f0f\u4e8c\n    // \u5982\u679c\u5b9a\u4e49\u5b8c\u540e\uff0c\u53ea\u80fd\u5355\u4e2a\u8d4b\u521d\u503c\n    struct Student st2;\n    st2.age = 18;\n    st2.score= 88;\n    st2.sex = 'F';\n    printf(\"%d %f %c\\n\", st1.age, st1.score, st1.sex);  // 19 66.599998 F\n    printf(\"%d %f %c\\n\", st2.age, st2.score, st1.sex);  // 18 88.000000 F\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#2","title":"2. \u53d6\u51fa\u7ed3\u6784\u4f53\u53d8\u91cf\u4e2d\u7684\u6210\u5458","text":"<pre><code>#include &lt;stdio.h&gt;\nstruct Student\n{\n    int age;\n    float score;\n    char sex;\n};\nint main(void)\n{\n    struct Student st = {19, 66.6, 'F'};\n    // \u65b9\u5f0f\u4e00\n    // \u7ed3\u6784\u4f53\u53d8\u91cf.\u6210\u5458\u540d\n    printf(\"%d %f %c\\n\", st.age, st.score, st.sex);    // 19 66.599998 F\n    // \u65b9\u5f0f\u4e8c \u66f4\u5e38\u7528\n    // \u6307\u9488\u53d8\u91cf\u540d-&gt;\u6210\u5458\u540d\n    struct Student *pst = &amp;st;\n    printf(\"%d %f %c\\n\", pst-&gt;age, pst-&gt;score, pst-&gt;sex);    // 19 66.599998 F\n    // pst-&gt;age \u5728\u8ba1\u7b97\u673a\u5185\u90e8\u4f1a\u88ab\u8f6c\u6362\u4e3a(*pst).age\n    // \u6240\u4ee5pst-&gt;age\u7b49\u4ef7\u4e8e(*pst.age),\u4e5f\u7b49\u4ef7\u4e8est.age\n    // pst-&gt;age\u7684\u542b\u4e49\uff1apst\u6240\u6307\u5411\u7684\u6309\u4e2a\u7ed3\u6784\u4f53\u53d8\u91cf\u4e2d\u7684age\u8fd9\u4e2a\u6210\u5458\n    return 0;\n}\n</code></pre>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#3","title":"3. \u7ed3\u6784\u4f53\u53d8\u91cf\u548c\u7ed3\u6784\u4f53\u53d8\u91cf\u6307\u9488\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u4f20\u9012","text":"<p>\u63a8\u8350\u4f7f\u7528\u7ed3\u6784\u4f53\u6307\u9488\u53d8\u91cf\u4f5c\u4e3a\u51fd\u6570\u53c2\u6570\u6765\u4f20\u9012</p> <pre><code>// \u901a\u8fc7\u51fd\u6570\u5b8c\u6210\u5bf9\u7ed3\u6784\u53d8\u91cf\u7684\u8f93\u5165\u548c\u8f93\u51fa\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n\nstruct Student\n{\n    int age;\n    char sex;\n    char name[100];\n};\n\nvoid InputStudent(struct Student *pstu);\nvoid OutputStudent(struct Student *stu);\n\nint main(void)\n{\n    struct Student st;\n\n    InputStudent(&amp;st); // \u5bf9\u7ed3\u6784\u4f53\u53d8\u91cf\u8f93\u5165 \u5fc5\u987b\u53d1\u9001st\u7684\u5730\u5740\n    OutputStudent(&amp;st); // \u5bf9\u7ed3\u6784\u4f53\u53d8\u91cf\u8f93\u51fa \u53ef\u4ee5\u53d1\u9001st\u7684\u5730\u5740\uff0c\u4e5f\u53ef\u4ee5\u53d1\u9001st\u7684\u5185\u5bb9\n    return 0;\n}\n\n\nvoid InputStudent(struct Student *pstu)\n{\n    pstu-&gt;age = 10;\n    strcpy(pstu-&gt;name, \"\u5f20\u4e09\");\n    pstu-&gt;sex = 'F';\n}\n\nvoid OutputStudent(struct Student *pstu)\n{\n    printf(\"%d %c %s\\n\", pstu-&gt;age, pstu-&gt;sex, pstu-&gt;name);\n}\n\n//\n// void OutputStudent(struct Student stu)\n// {\n//     printf(\"%d %c %s\\n\", stu.age, stu.sex, stu.name);\n// }\n</code></pre>"},{"location":"programming/c/%E7%BB%93%E6%9E%84%E4%BD%93/#4","title":"4. \u7ed3\u6784\u4f53\u53d8\u91cf\u7684\u8fd0\u7b97","text":"<p>\u7ed3\u6784\u4f53\u53d8\u91cf\u4e0d\u80fd\u76f8\u52a0\uff0c\u4e0d\u80fd\u76f8\u51cf\uff0c\u4e5f\u4e0d\u80fd\u76f8\u4e92\u4e58\u9664</p> <p>\u53ef\u4ee5\u76f8\u4e92\u8d4b\u503c</p> <pre><code>struct Student\n{\n    int age;\n    float score;\n    char sex;\n};\n\nstruct Student st1, st2;\nst1 = st2;\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/","title":"JDBC\u6838\u5fc3\u6280\u672f","text":"<p>\u8bb2\u5e08\uff1a\u5b8b\u7ea2\u5eb7</p> <p>\u5fae\u535a\uff1a\u5c1a\u7845\u8c37-\u5b8b\u7ea2\u5eb7</p>"},{"location":"programming/java/JDBC/JDBC/#1jdbc","title":"\u7b2c1\u7ae0\uff1aJDBC\u6982\u8ff0","text":""},{"location":"programming/java/JDBC/JDBC/#11","title":"1.1 \u6570\u636e\u7684\u6301\u4e45\u5316","text":"<ul> <li> <p>\u6301\u4e45\u5316(persistence)\uff1a\u628a\u6570\u636e\u4fdd\u5b58\u5230\u53ef\u6389\u7535\u5f0f\u5b58\u50a8\u8bbe\u5907\u4e2d\u4ee5\u4f9b\u4e4b\u540e\u4f7f\u7528\u3002\u5927\u591a\u6570\u60c5\u51b5\u4e0b\uff0c\u7279\u522b\u662f\u4f01\u4e1a\u7ea7\u5e94\u7528\uff0c\u6570\u636e\u6301\u4e45\u5316\u610f\u5473\u7740\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u4fdd\u5b58\u5230\u786c\u76d8\u4e0a\u52a0\u4ee5\u201d\u56fa\u5316\u201d\uff0c\u800c\u6301\u4e45\u5316\u7684\u5b9e\u73b0\u8fc7\u7a0b\u5927\u591a\u901a\u8fc7\u5404\u79cd\u5173\u7cfb\u6570\u636e\u5e93\u6765\u5b8c\u6210\u3002</p> </li> <li> <p>\u6301\u4e45\u5316\u7684\u4e3b\u8981\u5e94\u7528\u662f\u5c06\u5185\u5b58\u4e2d\u7684\u6570\u636e\u5b58\u50a8\u5728\u5173\u7cfb\u578b\u6570\u636e\u5e93\u4e2d\uff0c\u5f53\u7136\u4e5f\u53ef\u4ee5\u5b58\u50a8\u5728\u78c1\u76d8\u6587\u4ef6\u3001XML\u6570\u636e\u6587\u4ef6\u4e2d\u3002</p> </li> </ul> <p> </p>"},{"location":"programming/java/JDBC/JDBC/#12-java","title":"1.2 Java\u4e2d\u7684\u6570\u636e\u5b58\u50a8\u6280\u672f","text":"<ul> <li>\u5728Java\u4e2d\uff0c\u6570\u636e\u5e93\u5b58\u53d6\u6280\u672f\u53ef\u5206\u4e3a\u5982\u4e0b\u51e0\u7c7b\uff1a</li> <li>JDBC\u76f4\u63a5\u8bbf\u95ee\u6570\u636e\u5e93</li> <li> <p>JDO (Java Data Object )\u6280\u672f</p> </li> <li> <p>\u7b2c\u4e09\u65b9O/R\u5de5\u5177\uff0c\u5982Hibernate, Mybatis \u7b49</p> </li> <li> <p>JDBC\u662fjava\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u57fa\u77f3\uff0cJDO\u3001Hibernate\u3001MyBatis\u7b49\u53ea\u662f\u66f4\u597d\u7684\u5c01\u88c5\u4e86JDBC\u3002</p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#13-jdbc","title":"1.3 JDBC\u4ecb\u7ecd","text":"<ul> <li>JDBC(Java Database Connectivity)\u662f\u4e00\u4e2a\u72ec\u7acb\u4e8e\u7279\u5b9a\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u3001\u901a\u7528\u7684SQL\u6570\u636e\u5e93\u5b58\u53d6\u548c\u64cd\u4f5c\u7684\u516c\u5171\u63a5\u53e3\uff08\u4e00\u7ec4API\uff09\uff0c\u5b9a\u4e49\u4e86\u7528\u6765\u8bbf\u95ee\u6570\u636e\u5e93\u7684\u6807\u51c6Java\u7c7b\u5e93\uff0c\uff08java.sql,javax.sql\uff09\u4f7f\u7528\u8fd9\u4e9b\u7c7b\u5e93\u53ef\u4ee5\u4ee5\u4e00\u79cd\u6807\u51c6\u7684\u65b9\u6cd5\u3001\u65b9\u4fbf\u5730\u8bbf\u95ee\u6570\u636e\u5e93\u8d44\u6e90\u3002</li> <li>JDBC\u4e3a\u8bbf\u95ee\u4e0d\u540c\u7684\u6570\u636e\u5e93\u63d0\u4f9b\u4e86\u4e00\u79cd\u7edf\u4e00\u7684\u9014\u5f84\uff0c\u4e3a\u5f00\u53d1\u8005\u5c4f\u853d\u4e86\u4e00\u4e9b\u7ec6\u8282\u95ee\u9898\u3002</li> <li>JDBC\u7684\u76ee\u6807\u662f\u4f7fJava\u7a0b\u5e8f\u5458\u4f7f\u7528JDBC\u53ef\u4ee5\u8fde\u63a5\u4efb\u4f55\u63d0\u4f9b\u4e86JDBC\u9a71\u52a8\u7a0b\u5e8f\u7684\u6570\u636e\u5e93\u7cfb\u7edf\uff0c\u8fd9\u6837\u5c31\u4f7f\u5f97\u7a0b\u5e8f\u5458\u65e0\u9700\u5bf9\u7279\u5b9a\u7684\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u7279\u70b9\u6709\u8fc7\u591a\u7684\u4e86\u89e3\uff0c\u4ece\u800c\u5927\u5927\u7b80\u5316\u548c\u52a0\u5feb\u4e86\u5f00\u53d1\u8fc7\u7a0b\u3002</li> <li>\u5982\u679c\u6ca1\u6709JDBC\uff0c\u90a3\u4e48Java\u7a0b\u5e8f\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\u662f\u8fd9\u6837\u7684\uff1a</li> </ul> <ul> <li>\u6709\u4e86JDBC\uff0cJava\u7a0b\u5e8f\u8bbf\u95ee\u6570\u636e\u5e93\u65f6\u662f\u8fd9\u6837\u7684\uff1a</li> </ul> <ul> <li>\u603b\u7ed3\u5982\u4e0b\uff1a</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#14-jdbc","title":"1.4 JDBC\u4f53\u7cfb\u7ed3\u6784","text":"<ul> <li>JDBC\u63a5\u53e3\uff08API\uff09\u5305\u62ec\u4e24\u4e2a\u5c42\u6b21\uff1a</li> <li>\u9762\u5411\u5e94\u7528\u7684API\uff1aJava API\uff0c\u62bd\u8c61\u63a5\u53e3\uff0c\u4f9b\u5e94\u7528\u7a0b\u5e8f\u5f00\u53d1\u4eba\u5458\u4f7f\u7528\uff08\u8fde\u63a5\u6570\u636e\u5e93\uff0c\u6267\u884cSQL\u8bed\u53e5\uff0c\u83b7\u5f97\u7ed3\u679c\uff09\u3002</li> <li>\u9762\u5411\u6570\u636e\u5e93\u7684API\uff1aJava Driver API\uff0c\u4f9b\u5f00\u53d1\u5546\u5f00\u53d1\u6570\u636e\u5e93\u9a71\u52a8\u7a0b\u5e8f\u7528\u3002</li> </ul> <p>JDBC\u662fsun\u516c\u53f8\u63d0\u4f9b\u4e00\u5957\u7528\u4e8e\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u63a5\u53e3\uff0cjava\u7a0b\u5e8f\u5458\u53ea\u9700\u8981\u9762\u5411\u8fd9\u5957\u63a5\u53e3\u7f16\u7a0b\u5373\u53ef\u3002</p> <p>\u4e0d\u540c\u7684\u6570\u636e\u5e93\u5382\u5546\uff0c\u9700\u8981\u9488\u5bf9\u8fd9\u5957\u63a5\u53e3\uff0c\u63d0\u4f9b\u4e0d\u540c\u5b9e\u73b0\u3002\u4e0d\u540c\u7684\u5b9e\u73b0\u7684\u96c6\u5408\uff0c\u5373\u4e3a\u4e0d\u540c\u6570\u636e\u5e93\u7684\u9a71\u52a8\u3002                                                               \u2014\u2014\u2014\u2014\u9762\u5411\u63a5\u53e3\u7f16\u7a0b</p>"},{"location":"programming/java/JDBC/JDBC/#15-jdbc","title":"1.5 JDBC\u7a0b\u5e8f\u7f16\u5199\u6b65\u9aa4","text":"<p>\u8865\u5145\uff1aODBC(Open Database Connectivity\uff0c\u5f00\u653e\u5f0f\u6570\u636e\u5e93\u8fde\u63a5)\uff0c\u662f\u5fae\u8f6f\u5728Windows\u5e73\u53f0\u4e0b\u63a8\u51fa\u7684\u3002\u4f7f\u7528\u8005\u5728\u7a0b\u5e8f\u4e2d\u53ea\u9700\u8981\u8c03\u7528ODBC API\uff0c\u7531 ODBC \u9a71\u52a8\u7a0b\u5e8f\u5c06\u8c03\u7528\u8f6c\u6362\u6210\u4e3a\u5bf9\u7279\u5b9a\u7684\u6570\u636e\u5e93\u7684\u8c03\u7528\u8bf7\u6c42\u3002</p>"},{"location":"programming/java/JDBC/JDBC/#2","title":"\u7b2c2\u7ae0\uff1a\u83b7\u53d6\u6570\u636e\u5e93\u8fde\u63a5","text":""},{"location":"programming/java/JDBC/JDBC/#21-driver","title":"2.1 \u8981\u7d20\u4e00\uff1aDriver\u63a5\u53e3\u5b9e\u73b0\u7c7b","text":""},{"location":"programming/java/JDBC/JDBC/#211-driver","title":"2.1.1 Driver\u63a5\u53e3\u4ecb\u7ecd","text":"<ul> <li> <p>java.sql.Driver \u63a5\u53e3\u662f\u6240\u6709 JDBC \u9a71\u52a8\u7a0b\u5e8f\u9700\u8981\u5b9e\u73b0\u7684\u63a5\u53e3\u3002\u8fd9\u4e2a\u63a5\u53e3\u662f\u63d0\u4f9b\u7ed9\u6570\u636e\u5e93\u5382\u5546\u4f7f\u7528\u7684\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u5382\u5546\u63d0\u4f9b\u4e0d\u540c\u7684\u5b9e\u73b0\u3002</p> </li> <li> <p>\u5728\u7a0b\u5e8f\u4e2d\u4e0d\u9700\u8981\u76f4\u63a5\u53bb\u8bbf\u95ee\u5b9e\u73b0\u4e86 Driver \u63a5\u53e3\u7684\u7c7b\uff0c\u800c\u662f\u7531\u9a71\u52a8\u7a0b\u5e8f\u7ba1\u7406\u5668\u7c7b(java.sql.DriverManager)\u53bb\u8c03\u7528\u8fd9\u4e9bDriver\u5b9e\u73b0\u3002</p> </li> <li>Oracle\u7684\u9a71\u52a8\uff1aoracle.jdbc.driver.OracleDriver</li> <li>mySql\u7684\u9a71\u52a8\uff1a com.mysql.jdbc.Driver</li> </ul> <p></p> <p></p> <ul> <li>\u5c06\u4e0a\u8ff0jar\u5305\u62f7\u8d1d\u5230Java\u5de5\u7a0b\u7684\u4e00\u4e2a\u76ee\u5f55\u4e2d\uff0c\u4e60\u60ef\u4e0a\u65b0\u5efa\u4e00\u4e2alib\u6587\u4ef6\u5939\u3002</li> </ul> <p></p> <p>\u5728\u9a71\u52a8jar\u4e0a\u53f3\u952e--&gt;Build Path--&gt;Add to Build Path</p> <p></p> <p>\u6ce8\u610f\uff1a\u5982\u679c\u662fDynamic Web Project\uff08\u52a8\u6001\u7684web\u9879\u76ee\uff09\u8bdd\uff0c\u5219\u662f\u628a\u9a71\u52a8jar\u653e\u5230WebContent\uff08\u6709\u7684\u5f00\u53d1\u5de5\u5177\u53ebWebRoot\uff09\u76ee\u5f55\u4e2d\u7684WEB-INF\u76ee\u5f55\u4e2d\u7684lib\u76ee\u5f55\u4e0b\u5373\u53ef</p> <p></p>"},{"location":"programming/java/JDBC/JDBC/#212-jdbc","title":"2.1.2 \u52a0\u8f7d\u4e0e\u6ce8\u518cJDBC\u9a71\u52a8","text":"<ul> <li> <p>\u52a0\u8f7d\u9a71\u52a8\uff1a\u52a0\u8f7d JDBC \u9a71\u52a8\u9700\u8c03\u7528 Class \u7c7b\u7684\u9759\u6001\u65b9\u6cd5 forName()\uff0c\u5411\u5176\u4f20\u9012\u8981\u52a0\u8f7d\u7684 JDBC \u9a71\u52a8\u7684\u7c7b\u540d</p> </li> <li> <p>Class.forName(\u201ccom.mysql.jdbc.Driver\u201d);</p> </li> <li> <p>\u6ce8\u518c\u9a71\u52a8\uff1aDriverManager \u7c7b\u662f\u9a71\u52a8\u7a0b\u5e8f\u7ba1\u7406\u5668\u7c7b\uff0c\u8d1f\u8d23\u7ba1\u7406\u9a71\u52a8\u7a0b\u5e8f</p> </li> <li> <p>\u4f7f\u7528DriverManager.registerDriver(com.mysql.jdbc.Driver)\u6765\u6ce8\u518c\u9a71\u52a8</p> </li> <li> <p>\u901a\u5e38\u4e0d\u7528\u663e\u5f0f\u8c03\u7528 DriverManager \u7c7b\u7684 registerDriver() \u65b9\u6cd5\u6765\u6ce8\u518c\u9a71\u52a8\u7a0b\u5e8f\u7c7b\u7684\u5b9e\u4f8b\uff0c\u56e0\u4e3a Driver \u63a5\u53e3\u7684\u9a71\u52a8\u7a0b\u5e8f\u7c7b\u90fd\u5305\u542b\u4e86\u9759\u6001\u4ee3\u7801\u5757\uff0c\u5728\u8fd9\u4e2a\u9759\u6001\u4ee3\u7801\u5757\u4e2d\uff0c\u4f1a\u8c03\u7528 DriverManager.registerDriver() \u65b9\u6cd5\u6765\u6ce8\u518c\u81ea\u8eab\u7684\u4e00\u4e2a\u5b9e\u4f8b\u3002\u4e0b\u56fe\u662fMySQL\u7684Driver\u5b9e\u73b0\u7c7b\u7684\u6e90\u7801\uff1a</p> <p></p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#22-url","title":"2.2 \u8981\u7d20\u4e8c\uff1aURL","text":"<ul> <li> <p>JDBC URL \u7528\u4e8e\u6807\u8bc6\u4e00\u4e2a\u88ab\u6ce8\u518c\u7684\u9a71\u52a8\u7a0b\u5e8f\uff0c\u9a71\u52a8\u7a0b\u5e8f\u7ba1\u7406\u5668\u901a\u8fc7\u8fd9\u4e2a URL \u9009\u62e9\u6b63\u786e\u7684\u9a71\u52a8\u7a0b\u5e8f\uff0c\u4ece\u800c\u5efa\u7acb\u5230\u6570\u636e\u5e93\u7684\u8fde\u63a5\u3002</p> </li> <li> <p>JDBC URL\u7684\u6807\u51c6\u7531\u4e09\u90e8\u5206\u7ec4\u6210\uff0c\u5404\u90e8\u5206\u95f4\u7528\u5192\u53f7\u5206\u9694\u3002 </p> </li> <li>jdbc:\u5b50\u534f\u8bae:\u5b50\u540d\u79f0</li> <li>\u534f\u8bae\uff1aJDBC URL\u4e2d\u7684\u534f\u8bae\u603b\u662fjdbc </li> <li>\u5b50\u534f\u8bae\uff1a\u5b50\u534f\u8bae\u7528\u4e8e\u6807\u8bc6\u4e00\u4e2a\u6570\u636e\u5e93\u9a71\u52a8\u7a0b\u5e8f</li> <li> <p>\u5b50\u540d\u79f0\uff1a\u4e00\u79cd\u6807\u8bc6\u6570\u636e\u5e93\u7684\u65b9\u6cd5\u3002\u5b50\u540d\u79f0\u53ef\u4ee5\u4f9d\u4e0d\u540c\u7684\u5b50\u534f\u8bae\u800c\u53d8\u5316\uff0c\u7528\u5b50\u540d\u79f0\u7684\u76ee\u7684\u662f\u4e3a\u4e86\u5b9a\u4f4d\u6570\u636e\u5e93\u63d0\u4f9b\u8db3\u591f\u7684\u4fe1\u606f\u3002\u5305\u542b\u4e3b\u673a\u540d(\u5bf9\u5e94\u670d\u52a1\u7aef\u7684ip\u5730\u5740)\uff0c\u7aef\u53e3\u53f7\uff0c\u6570\u636e\u5e93\u540d</p> </li> <li> <p>\u4e3e\u4f8b\uff1a</p> </li> </ul> <p></p> <ul> <li> <p>\u51e0\u79cd\u5e38\u7528\u6570\u636e\u5e93\u7684 JDBC URL</p> </li> <li> <p>MySQL\u7684\u8fde\u63a5URL\u7f16\u5199\u65b9\u5f0f\uff1a</p> <ul> <li>jdbc:mysql://\u4e3b\u673a\u540d\u79f0:mysql\u670d\u52a1\u7aef\u53e3\u53f7/\u6570\u636e\u5e93\u540d\u79f0?\u53c2\u6570=\u503c&amp;\u53c2\u6570=\u503c</li> <li>jdbc:mysql://localhost:3306/atguigu</li> <li>jdbc:mysql://localhost:3306/atguigu?useUnicode=true&amp;characterEncoding=utf8\uff08\u5982\u679cJDBC\u7a0b\u5e8f\u4e0e\u670d\u52a1\u5668\u7aef\u7684\u5b57\u7b26\u96c6\u4e0d\u4e00\u81f4\uff0c\u4f1a\u5bfc\u81f4\u4e71\u7801\uff0c\u90a3\u4e48\u53ef\u4ee5\u901a\u8fc7\u53c2\u6570\u6307\u5b9a\u670d\u52a1\u5668\u7aef\u7684\u5b57\u7b26\u96c6\uff09</li> <li>jdbc:mysql://localhost:3306/atguigu?user=root&amp;password=123456</li> </ul> </li> <li> <p>Oracle 9i\u7684\u8fde\u63a5URL\u7f16\u5199\u65b9\u5f0f\uff1a</p> <ul> <li>jdbc:oracle:thin:@\u4e3b\u673a\u540d\u79f0:oracle\u670d\u52a1\u7aef\u53e3\u53f7:\u6570\u636e\u5e93\u540d\u79f0</li> <li>jdbc:oracle:thin:@localhost:1521:atguigu</li> </ul> </li> <li> <p>SQLServer\u7684\u8fde\u63a5URL\u7f16\u5199\u65b9\u5f0f\uff1a</p> <ul> <li> <p>jdbc:sqlserver://\u4e3b\u673a\u540d\u79f0:sqlserver\u670d\u52a1\u7aef\u53e3\u53f7:DatabaseName=\u6570\u636e\u5e93\u540d\u79f0</p> </li> <li> <p>jdbc:sqlserver://localhost:1433:DatabaseName=atguigu</p> </li> </ul> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#23","title":"2.3 \u8981\u7d20\u4e09\uff1a\u7528\u6237\u540d\u548c\u5bc6\u7801","text":"<ul> <li>user,password\u53ef\u4ee5\u7528\u201c\u5c5e\u6027\u540d=\u5c5e\u6027\u503c\u201d\u65b9\u5f0f\u544a\u8bc9\u6570\u636e\u5e93</li> <li>\u53ef\u4ee5\u8c03\u7528 DriverManager \u7c7b\u7684 getConnection() \u65b9\u6cd5\u5efa\u7acb\u5230\u6570\u636e\u5e93\u7684\u8fde\u63a5</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#24","title":"2.4 \u6570\u636e\u5e93\u8fde\u63a5\u65b9\u5f0f\u4e3e\u4f8b","text":""},{"location":"programming/java/JDBC/JDBC/#241","title":"2.4.1 \u8fde\u63a5\u65b9\u5f0f\u4e00","text":"<pre><code>    @Test\n    public void testConnection1() {\n        try {\n            //1.\u63d0\u4f9bjava.sql.Driver\u63a5\u53e3\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\n            Driver driver = null;\n            driver = new com.mysql.jdbc.Driver();\n\n            //2.\u63d0\u4f9burl\uff0c\u6307\u660e\u5177\u4f53\u64cd\u4f5c\u7684\u6570\u636e\n            String url = \"jdbc:mysql://localhost:3306/test\";\n\n            //3.\u63d0\u4f9bProperties\u7684\u5bf9\u8c61\uff0c\u6307\u660e\u7528\u6237\u540d\u548c\u5bc6\u7801\n            Properties info = new Properties();\n            info.setProperty(\"user\", \"root\");\n            info.setProperty(\"password\", \"abc123\");\n\n            //4.\u8c03\u7528driver\u7684connect()\uff0c\u83b7\u53d6\u8fde\u63a5\n            Connection conn = driver.connect(url, info);\n            System.out.println(conn);\n        } catch (SQLException e) {\n            e.printStackTrace();\n        }\n    }\n</code></pre> <p>\u8bf4\u660e\uff1a\u4e0a\u8ff0\u4ee3\u7801\u4e2d\u663e\u5f0f\u51fa\u73b0\u4e86\u7b2c\u4e09\u65b9\u6570\u636e\u5e93\u7684API</p>"},{"location":"programming/java/JDBC/JDBC/#242","title":"2.4.2 \u8fde\u63a5\u65b9\u5f0f\u4e8c","text":"<pre><code>    @Test\n    public void testConnection2() {\n        try {\n            //1.\u5b9e\u4f8b\u5316Driver\n            String className = \"com.mysql.jdbc.Driver\";\n            Class clazz = Class.forName(className);\n            Driver driver = (Driver) clazz.newInstance();\n\n            //2.\u63d0\u4f9burl\uff0c\u6307\u660e\u5177\u4f53\u64cd\u4f5c\u7684\u6570\u636e\n            String url = \"jdbc:mysql://localhost:3306/test\";\n\n            //3.\u63d0\u4f9bProperties\u7684\u5bf9\u8c61\uff0c\u6307\u660e\u7528\u6237\u540d\u548c\u5bc6\u7801\n            Properties info = new Properties();\n            info.setProperty(\"user\", \"root\");\n            info.setProperty(\"password\", \"abc123\");\n\n            //4.\u8c03\u7528driver\u7684connect()\uff0c\u83b7\u53d6\u8fde\u63a5\n            Connection conn = driver.connect(url, info);\n            System.out.println(conn);\n\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n</code></pre> <p>\u8bf4\u660e\uff1a\u76f8\u8f83\u4e8e\u65b9\u5f0f\u4e00\uff0c\u8fd9\u91cc\u4f7f\u7528\u53cd\u5c04\u5b9e\u4f8b\u5316Driver\uff0c\u4e0d\u5728\u4ee3\u7801\u4e2d\u4f53\u73b0\u7b2c\u4e09\u65b9\u6570\u636e\u5e93\u7684API\u3002\u4f53\u73b0\u4e86\u9762\u5411\u63a5\u53e3\u7f16\u7a0b\u601d\u60f3\u3002</p>"},{"location":"programming/java/JDBC/JDBC/#243","title":"2.4.3 \u8fde\u63a5\u65b9\u5f0f\u4e09","text":"<pre><code>    @Test\n    public void testConnection3() {\n        try {\n            //1.\u6570\u636e\u5e93\u8fde\u63a5\u76844\u4e2a\u57fa\u672c\u8981\u7d20\uff1a\n            String url = \"jdbc:mysql://localhost:3306/test\";\n            String user = \"root\";\n            String password = \"abc123\";\n            String driverName = \"com.mysql.jdbc.Driver\";\n\n            //2.\u5b9e\u4f8b\u5316Driver\n            Class clazz = Class.forName(driverName);\n            Driver driver = (Driver) clazz.newInstance();\n            //3.\u6ce8\u518c\u9a71\u52a8\n            DriverManager.registerDriver(driver);\n            //4.\u83b7\u53d6\u8fde\u63a5\n            Connection conn = DriverManager.getConnection(url, user, password);\n            System.out.println(conn);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n    }\n</code></pre> <p>\u8bf4\u660e\uff1a\u4f7f\u7528DriverManager\u5b9e\u73b0\u6570\u636e\u5e93\u7684\u8fde\u63a5\u3002\u4f53\u4f1a\u83b7\u53d6\u8fde\u63a5\u5fc5\u8981\u76844\u4e2a\u57fa\u672c\u8981\u7d20\u3002</p>"},{"location":"programming/java/JDBC/JDBC/#244","title":"2.4.4 \u8fde\u63a5\u65b9\u5f0f\u56db","text":"<pre><code>    @Test\n    public void testConnection4() {\n        try {\n            //1.\u6570\u636e\u5e93\u8fde\u63a5\u76844\u4e2a\u57fa\u672c\u8981\u7d20\uff1a\n            String url = \"jdbc:mysql://localhost:3306/test\";\n            String user = \"root\";\n            String password = \"abc123\";\n            String driverName = \"com.mysql.jdbc.Driver\";\n\n            //2.\u52a0\u8f7d\u9a71\u52a8 \uff08\u2460\u5b9e\u4f8b\u5316Driver \u2461\u6ce8\u518c\u9a71\u52a8\uff09\n            Class.forName(driverName);\n\n\n            //Driver driver = (Driver) clazz.newInstance();\n            //3.\u6ce8\u518c\u9a71\u52a8\n            //DriverManager.registerDriver(driver);\n            /*\n            \u53ef\u4ee5\u6ce8\u91ca\u6389\u4e0a\u8ff0\u4ee3\u7801\u7684\u539f\u56e0\uff0c\u662f\u56e0\u4e3a\u5728mysql\u7684Driver\u7c7b\u4e2d\u58f0\u660e\u6709\uff1a\n            static {\n                try {\n                    DriverManager.registerDriver(new Driver());\n                } catch (SQLException var1) {\n                    throw new RuntimeException(\"Can't register driver!\");\n                }\n            }\n\n             */\n\n\n            //3.\u83b7\u53d6\u8fde\u63a5\n            Connection conn = DriverManager.getConnection(url, user, password);\n            System.out.println(conn);\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n\n    }\n</code></pre> <p>\u8bf4\u660e\uff1a\u4e0d\u5fc5\u663e\u5f0f\u7684\u6ce8\u518c\u9a71\u52a8\u4e86\u3002\u56e0\u4e3a\u5728DriverManager\u7684\u6e90\u7801\u4e2d\u5df2\u7ecf\u5b58\u5728\u9759\u6001\u4ee3\u7801\u5757\uff0c\u5b9e\u73b0\u4e86\u9a71\u52a8\u7684\u6ce8\u518c\u3002</p>"},{"location":"programming/java/JDBC/JDBC/#245","title":"2.4.5 \u8fde\u63a5\u65b9\u5f0f\u4e94(\u6700\u7ec8\u7248)","text":"<pre><code>    @Test\n    public  void testConnection5() throws Exception {\n        //1.\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\n        InputStream is = ConnectionTest.class.getClassLoader().getResourceAsStream(\"jdbc.properties\");\n        Properties pros = new Properties();\n        pros.load(is);\n\n        //2.\u8bfb\u53d6\u914d\u7f6e\u4fe1\u606f\n        String user = pros.getProperty(\"user\");\n        String password = pros.getProperty(\"password\");\n        String url = pros.getProperty(\"url\");\n        String driverClass = pros.getProperty(\"driverClass\");\n\n        //3.\u52a0\u8f7d\u9a71\u52a8\n        Class.forName(driverClass);\n\n        //4.\u83b7\u53d6\u8fde\u63a5\n        Connection conn = DriverManager.getConnection(url,user,password);\n        System.out.println(conn);\n\n    }\n</code></pre> <p>\u5176\u4e2d\uff0c\u914d\u7f6e\u6587\u4ef6\u58f0\u660e\u5728\u5de5\u7a0b\u7684src\u76ee\u5f55\u4e0b\uff1a\u3010jdbc.properties\u3011</p> <pre><code>user=root\npassword=abc123\nurl=jdbc:mysql://localhost:3306/test\ndriverClass=com.mysql.jdbc.Driver\n</code></pre> <p>\u8bf4\u660e\uff1a\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u7684\u65b9\u5f0f\u4fdd\u5b58\u914d\u7f6e\u4fe1\u606f\uff0c\u5728\u4ee3\u7801\u4e2d\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6</p> <p>\u4f7f\u7528\u914d\u7f6e\u6587\u4ef6\u7684\u597d\u5904\uff1a</p> <p>\u2460\u5b9e\u73b0\u4e86\u4ee3\u7801\u548c\u6570\u636e\u7684\u5206\u79bb\uff0c\u5982\u679c\u9700\u8981\u4fee\u6539\u914d\u7f6e\u4fe1\u606f\uff0c\u76f4\u63a5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u4fee\u6539\uff0c\u4e0d\u9700\u8981\u6df1\u5165\u4ee3\u7801 \u2461\u5982\u679c\u4fee\u6539\u4e86\u914d\u7f6e\u4fe1\u606f\uff0c\u7701\u53bb\u91cd\u65b0\u7f16\u8bd1\u7684\u8fc7\u7a0b\u3002</p>"},{"location":"programming/java/JDBC/JDBC/#3preparedstatementcrud","title":"\u7b2c3\u7ae0\uff1a\u4f7f\u7528PreparedStatement\u5b9e\u73b0CRUD\u64cd\u4f5c","text":""},{"location":"programming/java/JDBC/JDBC/#31","title":"3.1 \u64cd\u4f5c\u548c\u8bbf\u95ee\u6570\u636e\u5e93","text":"<ul> <li> <p>\u6570\u636e\u5e93\u8fde\u63a5\u88ab\u7528\u4e8e\u5411\u6570\u636e\u5e93\u670d\u52a1\u5668\u53d1\u9001\u547d\u4ee4\u548c SQL \u8bed\u53e5\uff0c\u5e76\u63a5\u53d7\u6570\u636e\u5e93\u670d\u52a1\u5668\u8fd4\u56de\u7684\u7ed3\u679c\u3002\u5176\u5b9e\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u5c31\u662f\u4e00\u4e2aSocket\u8fde\u63a5\u3002</p> </li> <li> <p>\u5728 java.sql \u5305\u4e2d\u6709 3 \u4e2a\u63a5\u53e3\u5206\u522b\u5b9a\u4e49\u4e86\u5bf9\u6570\u636e\u5e93\u7684\u8c03\u7528\u7684\u4e0d\u540c\u65b9\u5f0f\uff1a</p> </li> <li>Statement\uff1a\u7528\u4e8e\u6267\u884c\u9759\u6001 SQL \u8bed\u53e5\u5e76\u8fd4\u56de\u5b83\u6240\u751f\u6210\u7ed3\u679c\u7684\u5bf9\u8c61\u3002 </li> <li>PrepatedStatement\uff1aSQL \u8bed\u53e5\u88ab\u9884\u7f16\u8bd1\u5e76\u5b58\u50a8\u5728\u6b64\u5bf9\u8c61\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u6b64\u5bf9\u8c61\u591a\u6b21\u9ad8\u6548\u5730\u6267\u884c\u8be5\u8bed\u53e5\u3002</li> <li>CallableStatement\uff1a\u7528\u4e8e\u6267\u884c SQL \u5b58\u50a8\u8fc7\u7a0b</li> </ul> <p></p>"},{"location":"programming/java/JDBC/JDBC/#32-statement","title":"3.2 \u4f7f\u7528Statement\u64cd\u4f5c\u6570\u636e\u8868\u7684\u5f0a\u7aef","text":"<ul> <li> <p>\u901a\u8fc7\u8c03\u7528 Connection \u5bf9\u8c61\u7684 createStatement() \u65b9\u6cd5\u521b\u5efa\u8be5\u5bf9\u8c61\u3002\u8be5\u5bf9\u8c61\u7528\u4e8e\u6267\u884c\u9759\u6001\u7684 SQL \u8bed\u53e5\uff0c\u5e76\u4e14\u8fd4\u56de\u6267\u884c\u7ed3\u679c\u3002</p> </li> <li> <p>Statement \u63a5\u53e3\u4e2d\u5b9a\u4e49\u4e86\u4e0b\u5217\u65b9\u6cd5\u7528\u4e8e\u6267\u884c SQL \u8bed\u53e5\uff1a</p> </li> </ul> <pre><code>int excuteUpdate(String sql)\uff1a\u6267\u884c\u66f4\u65b0\u64cd\u4f5cINSERT\u3001UPDATE\u3001DELETE\nResultSet executeQuery(String sql)\uff1a\u6267\u884c\u67e5\u8be2\u64cd\u4f5cSELECT\n</code></pre> <ul> <li> <p>\u4f46\u662f\u4f7f\u7528Statement\u64cd\u4f5c\u6570\u636e\u8868\u5b58\u5728\u5f0a\u7aef\uff1a</p> </li> <li> <p>\u95ee\u9898\u4e00\uff1a\u5b58\u5728\u62fc\u4e32\u64cd\u4f5c\uff0c\u7e41\u7410</p> </li> <li> <p>\u95ee\u9898\u4e8c\uff1a\u5b58\u5728SQL\u6ce8\u5165\u95ee\u9898</p> </li> <li> <p>SQL \u6ce8\u5165\u662f\u5229\u7528\u67d0\u4e9b\u7cfb\u7edf\u6ca1\u6709\u5bf9\u7528\u6237\u8f93\u5165\u7684\u6570\u636e\u8fdb\u884c\u5145\u5206\u7684\u68c0\u67e5\uff0c\u800c\u5728\u7528\u6237\u8f93\u5165\u6570\u636e\u4e2d\u6ce8\u5165\u975e\u6cd5\u7684 SQL \u8bed\u53e5\u6bb5\u6216\u547d\u4ee4(\u5982\uff1aSELECT user, password FROM user_table WHERE user='a' OR 1 = ' AND password = ' OR '1' = '1') \uff0c\u4ece\u800c\u5229\u7528\u7cfb\u7edf\u7684 SQL \u5f15\u64ce\u5b8c\u6210\u6076\u610f\u884c\u4e3a\u7684\u505a\u6cd5\u3002</p> </li> <li> <p>\u5bf9\u4e8e Java \u800c\u8a00\uff0c\u8981\u9632\u8303 SQL \u6ce8\u5165\uff0c\u53ea\u8981\u7528 PreparedStatement(\u4eceStatement\u6269\u5c55\u800c\u6765) \u53d6\u4ee3 Statement \u5c31\u53ef\u4ee5\u4e86\u3002</p> </li> <li> <p>\u4ee3\u7801\u6f14\u793a\uff1a</p> </li> </ul> <pre><code>public class StatementTest {\n\n    // \u4f7f\u7528Statement\u7684\u5f0a\u7aef\uff1a\u9700\u8981\u62fc\u5199sql\u8bed\u53e5\uff0c\u5e76\u4e14\u5b58\u5728SQL\u6ce8\u5165\u7684\u95ee\u9898\n    @Test\n    public void testLogin() {\n        Scanner scan = new Scanner(System.in);\n\n        System.out.print(\"\u7528\u6237\u540d\uff1a\");\n        String userName = scan.nextLine();\n        System.out.print(\"\u5bc6   \u7801\uff1a\");\n        String password = scan.nextLine();\n\n        // SELECT user,password FROM user_table WHERE USER = '1' or ' AND PASSWORD = '='1' or '1' = '1';\n        String sql = \"SELECT user,password FROM user_table WHERE USER = '\" + userName + \"' AND PASSWORD = '\" + password\n                + \"'\";\n        User user = get(sql, User.class);\n        if (user != null) {\n            System.out.println(\"\u767b\u9646\u6210\u529f!\");\n        } else {\n            System.out.println(\"\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef\uff01\");\n        }\n    }\n\n    // \u4f7f\u7528Statement\u5b9e\u73b0\u5bf9\u6570\u636e\u8868\u7684\u67e5\u8be2\u64cd\u4f5c\n    public &lt;T&gt; T get(String sql, Class&lt;T&gt; clazz) {\n        T t = null;\n\n        Connection conn = null;\n        Statement st = null;\n        ResultSet rs = null;\n        try {\n            // 1.\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6\n            InputStream is = StatementTest.class.getClassLoader().getResourceAsStream(\"jdbc.properties\");\n            Properties pros = new Properties();\n            pros.load(is);\n\n            // 2.\u8bfb\u53d6\u914d\u7f6e\u4fe1\u606f\n            String user = pros.getProperty(\"user\");\n            String password = pros.getProperty(\"password\");\n            String url = pros.getProperty(\"url\");\n            String driverClass = pros.getProperty(\"driverClass\");\n\n            // 3.\u52a0\u8f7d\u9a71\u52a8\n            Class.forName(driverClass);\n\n            // 4.\u83b7\u53d6\u8fde\u63a5\n            conn = DriverManager.getConnection(url, user, password);\n\n            st = conn.createStatement();\n\n            rs = st.executeQuery(sql);\n\n            // \u83b7\u53d6\u7ed3\u679c\u96c6\u7684\u5143\u6570\u636e\n            ResultSetMetaData rsmd = rs.getMetaData();\n\n            // \u83b7\u53d6\u7ed3\u679c\u96c6\u7684\u5217\u6570\n            int columnCount = rsmd.getColumnCount();\n\n            if (rs.next()) {\n\n                t = clazz.newInstance();\n\n                for (int i = 0; i &lt; columnCount; i++) {\n                    // //1. \u83b7\u53d6\u5217\u7684\u540d\u79f0\n                    // String columnName = rsmd.getColumnName(i+1);\n\n                    // 1. \u83b7\u53d6\u5217\u7684\u522b\u540d\n                    String columnName = rsmd.getColumnLabel(i + 1);\n\n                    // 2. \u6839\u636e\u5217\u540d\u83b7\u53d6\u5bf9\u5e94\u6570\u636e\u8868\u4e2d\u7684\u6570\u636e\n                    Object columnVal = rs.getObject(columnName);\n\n                    // 3. \u5c06\u6570\u636e\u8868\u4e2d\u5f97\u5230\u7684\u6570\u636e\uff0c\u5c01\u88c5\u8fdb\u5bf9\u8c61\n                    Field field = clazz.getDeclaredField(columnName);\n                    field.setAccessible(true);\n                    field.set(t, columnVal);\n                }\n                return t;\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            // \u5173\u95ed\u8d44\u6e90\n            if (rs != null) {\n                try {\n                    rs.close();\n                } catch (SQLException e) {\n                    e.printStackTrace();\n                }\n            }\n            if (st != null) {\n                try {\n                    st.close();\n                } catch (SQLException e) {\n                    e.printStackTrace();\n                }\n            }\n\n            if (conn != null) {\n                try {\n                    conn.close();\n                } catch (SQLException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n\n        return null;\n    }\n}\n</code></pre> <p>\u7efc\u4e0a\uff1a</p> <p></p>"},{"location":"programming/java/JDBC/JDBC/#33-preparedstatement","title":"3.3 PreparedStatement\u7684\u4f7f\u7528","text":""},{"location":"programming/java/JDBC/JDBC/#331-preparedstatement","title":"3.3.1 PreparedStatement\u4ecb\u7ecd","text":"<ul> <li> <p>\u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 Connection \u5bf9\u8c61\u7684 preparedStatement(String sql) \u65b9\u6cd5\u83b7\u53d6 PreparedStatement \u5bf9\u8c61</p> </li> <li> <p>PreparedStatement \u63a5\u53e3\u662f Statement \u7684\u5b50\u63a5\u53e3\uff0c\u5b83\u8868\u793a\u4e00\u6761\u9884\u7f16\u8bd1\u8fc7\u7684 SQL \u8bed\u53e5</p> </li> <li> <p>PreparedStatement \u5bf9\u8c61\u6240\u4ee3\u8868\u7684 SQL \u8bed\u53e5\u4e2d\u7684\u53c2\u6570\u7528\u95ee\u53f7(?)\u6765\u8868\u793a\uff0c\u8c03\u7528 PreparedStatement \u5bf9\u8c61\u7684 setXxx() \u65b9\u6cd5\u6765\u8bbe\u7f6e\u8fd9\u4e9b\u53c2\u6570. setXxx() \u65b9\u6cd5\u6709\u4e24\u4e2a\u53c2\u6570\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u8981\u8bbe\u7f6e\u7684 SQL \u8bed\u53e5\u4e2d\u7684\u53c2\u6570\u7684\u7d22\u5f15(\u4ece 1 \u5f00\u59cb)\uff0c\u7b2c\u4e8c\u4e2a\u662f\u8bbe\u7f6e\u7684 SQL \u8bed\u53e5\u4e2d\u7684\u53c2\u6570\u7684\u503c</p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#332-preparedstatement-vs-statement","title":"3.3.2 PreparedStatement vs Statement","text":"<ul> <li> <p>\u4ee3\u7801\u7684\u53ef\u8bfb\u6027\u548c\u53ef\u7ef4\u62a4\u6027\u3002</p> </li> <li> <p>PreparedStatement \u80fd\u6700\u5927\u53ef\u80fd\u63d0\u9ad8\u6027\u80fd\uff1a</p> </li> <li>DBServer\u4f1a\u5bf9\u9884\u7f16\u8bd1\u8bed\u53e5\u63d0\u4f9b\u6027\u80fd\u4f18\u5316\u3002\u56e0\u4e3a\u9884\u7f16\u8bd1\u8bed\u53e5\u6709\u53ef\u80fd\u88ab\u91cd\u590d\u8c03\u7528\uff0c\u6240\u4ee5\u8bed\u53e5\u5728\u88abDBServer\u7684\u7f16\u8bd1\u5668\u7f16\u8bd1\u540e\u7684\u6267\u884c\u4ee3\u7801\u88ab\u7f13\u5b58\u4e0b\u6765\uff0c\u90a3\u4e48\u4e0b\u6b21\u8c03\u7528\u65f6\u53ea\u8981\u662f\u76f8\u540c\u7684\u9884\u7f16\u8bd1\u8bed\u53e5\u5c31\u4e0d\u9700\u8981\u7f16\u8bd1\uff0c\u53ea\u8981\u5c06\u53c2\u6570\u76f4\u63a5\u4f20\u5165\u7f16\u8bd1\u8fc7\u7684\u8bed\u53e5\u6267\u884c\u4ee3\u7801\u4e2d\u5c31\u4f1a\u5f97\u5230\u6267\u884c\u3002</li> <li>\u5728statement\u8bed\u53e5\u4e2d,\u5373\u4f7f\u662f\u76f8\u540c\u64cd\u4f5c\u4f46\u56e0\u4e3a\u6570\u636e\u5185\u5bb9\u4e0d\u4e00\u6837,\u6240\u4ee5\u6574\u4e2a\u8bed\u53e5\u672c\u8eab\u4e0d\u80fd\u5339\u914d,\u6ca1\u6709\u7f13\u5b58\u8bed\u53e5\u7684\u610f\u4e49.\u4e8b\u5b9e\u662f\u6ca1\u6709\u6570\u636e\u5e93\u4f1a\u5bf9\u666e\u901a\u8bed\u53e5\u7f16\u8bd1\u540e\u7684\u6267\u884c\u4ee3\u7801\u7f13\u5b58\u3002\u8fd9\u6837\u6bcf\u6267\u884c\u4e00\u6b21\u90fd\u8981\u5bf9\u4f20\u5165\u7684\u8bed\u53e5\u7f16\u8bd1\u4e00\u6b21\u3002</li> <li> <p>(\u8bed\u6cd5\u68c0\u67e5\uff0c\u8bed\u4e49\u68c0\u67e5\uff0c\u7ffb\u8bd1\u6210\u4e8c\u8fdb\u5236\u547d\u4ee4\uff0c\u7f13\u5b58)</p> </li> <li> <p>PreparedStatement \u53ef\u4ee5\u9632\u6b62 SQL \u6ce8\u5165 </p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#333-javasql","title":"3.3.3 Java\u4e0eSQL\u5bf9\u5e94\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u8868","text":"Java\u7c7b\u578b SQL\u7c7b\u578b boolean BIT byte TINYINT short SMALLINT int INTEGER long BIGINT String CHAR,VARCHAR,LONGVARCHAR byte   array BINARY  ,    VAR BINARY java.sql.Date DATE java.sql.Time TIME java.sql.Timestamp TIMESTAMP"},{"location":"programming/java/JDBC/JDBC/#334-preparedstatement","title":"3.3.4 \u4f7f\u7528PreparedStatement\u5b9e\u73b0\u589e\u3001\u5220\u3001\u6539\u64cd\u4f5c","text":"<pre><code>    //\u901a\u7528\u7684\u589e\u3001\u5220\u3001\u6539\u64cd\u4f5c\uff08\u4f53\u73b0\u4e00\uff1a\u589e\u3001\u5220\u3001\u6539 \uff1b \u4f53\u73b0\u4e8c\uff1a\u9488\u5bf9\u4e8e\u4e0d\u540c\u7684\u8868\uff09\n    public void update(String sql,Object ... args){\n        Connection conn = null;\n        PreparedStatement ps = null;\n        try {\n            //1.\u83b7\u53d6\u6570\u636e\u5e93\u7684\u8fde\u63a5\n            conn = JDBCUtils.getConnection();\n\n            //2.\u83b7\u53d6PreparedStatement\u7684\u5b9e\u4f8b (\u6216\uff1a\u9884\u7f16\u8bd1sql\u8bed\u53e5)\n            ps = conn.prepareStatement(sql);\n            //3.\u586b\u5145\u5360\u4f4d\u7b26\n            for(int i = 0;i &lt; args.length;i++){\n                ps.setObject(i + 1, args[i]);\n            }\n\n            //4.\u6267\u884csql\u8bed\u53e5\n            ps.execute();\n        } catch (Exception e) {\n\n            e.printStackTrace();\n        }finally{\n            //5.\u5173\u95ed\u8d44\u6e90\n            JDBCUtils.closeResource(conn, ps);\n\n        }\n    }\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#335-preparedstatement","title":"3.3.5 \u4f7f\u7528PreparedStatement\u5b9e\u73b0\u67e5\u8be2\u64cd\u4f5c","text":"<pre><code>    // \u901a\u7528\u7684\u9488\u5bf9\u4e8e\u4e0d\u540c\u8868\u7684\u67e5\u8be2:\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61 (version 1.0)\n    public &lt;T&gt; T getInstance(Class&lt;T&gt; clazz, String sql, Object... args) {\n\n        Connection conn = null;\n        PreparedStatement ps = null;\n        ResultSet rs = null;\n        try {\n            // 1.\u83b7\u53d6\u6570\u636e\u5e93\u8fde\u63a5\n            conn = JDBCUtils.getConnection();\n\n            // 2.\u9884\u7f16\u8bd1sql\u8bed\u53e5\uff0c\u5f97\u5230PreparedStatement\u5bf9\u8c61\n            ps = conn.prepareStatement(sql);\n\n            // 3.\u586b\u5145\u5360\u4f4d\u7b26\n            for (int i = 0; i &lt; args.length; i++) {\n                ps.setObject(i + 1, args[i]);\n            }\n\n            // 4.\u6267\u884cexecuteQuery(),\u5f97\u5230\u7ed3\u679c\u96c6\uff1aResultSet\n            rs = ps.executeQuery();\n\n            // 5.\u5f97\u5230\u7ed3\u679c\u96c6\u7684\u5143\u6570\u636e\uff1aResultSetMetaData\n            ResultSetMetaData rsmd = rs.getMetaData();\n\n            // 6.1\u901a\u8fc7ResultSetMetaData\u5f97\u5230columnCount,columnLabel\uff1b\u901a\u8fc7ResultSet\u5f97\u5230\u5217\u503c\n            int columnCount = rsmd.getColumnCount();\n            if (rs.next()) {\n                T t = clazz.newInstance();\n                for (int i = 0; i &lt; columnCount; i++) {// \u904d\u5386\u6bcf\u4e00\u4e2a\u5217\n\n                    // \u83b7\u53d6\u5217\u503c\n                    Object columnVal = rs.getObject(i + 1);\n                    // \u83b7\u53d6\u5217\u7684\u522b\u540d:\u5217\u7684\u522b\u540d\uff0c\u4f7f\u7528\u7c7b\u7684\u5c5e\u6027\u540d\u5145\u5f53\n                    String columnLabel = rsmd.getColumnLabel(i + 1);\n                    // 6.2\u4f7f\u7528\u53cd\u5c04\uff0c\u7ed9\u5bf9\u8c61\u7684\u76f8\u5e94\u5c5e\u6027\u8d4b\u503c\n                    Field field = clazz.getDeclaredField(columnLabel);\n                    field.setAccessible(true);\n                    field.set(t, columnVal);\n\n                }\n\n                return t;\n\n            }\n        } catch (Exception e) {\n\n            e.printStackTrace();\n        } finally {\n            // 7.\u5173\u95ed\u8d44\u6e90\n            JDBCUtils.closeResource(conn, ps, rs);\n        }\n\n        return null;\n\n    }\n</code></pre> <p>\u8bf4\u660e\uff1a\u4f7f\u7528PreparedStatement\u5b9e\u73b0\u7684\u67e5\u8be2\u64cd\u4f5c\u53ef\u4ee5\u66ff\u6362Statement\u5b9e\u73b0\u7684\u67e5\u8be2\u64cd\u4f5c\uff0c\u89e3\u51b3Statement\u62fc\u4e32\u548cSQL\u6ce8\u5165\u95ee\u9898\u3002 </p>"},{"location":"programming/java/JDBC/JDBC/#34-resultsetresultsetmetadata","title":"3.4 ResultSet\u4e0eResultSetMetaData","text":""},{"location":"programming/java/JDBC/JDBC/#341-resultset","title":"3.4.1 ResultSet","text":"<ul> <li> <p>\u67e5\u8be2\u9700\u8981\u8c03\u7528PreparedStatement \u7684 executeQuery() \u65b9\u6cd5\uff0c\u67e5\u8be2\u7ed3\u679c\u662f\u4e00\u4e2aResultSet \u5bf9\u8c61</p> </li> <li> <p>ResultSet \u5bf9\u8c61\u4ee5\u903b\u8f91\u8868\u683c\u7684\u5f62\u5f0f\u5c01\u88c5\u4e86\u6267\u884c\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u7ed3\u679c\u96c6\uff0cResultSet \u63a5\u53e3\u7531\u6570\u636e\u5e93\u5382\u5546\u63d0\u4f9b\u5b9e\u73b0</p> </li> <li> <p>ResultSet \u8fd4\u56de\u7684\u5b9e\u9645\u4e0a\u5c31\u662f\u4e00\u5f20\u6570\u636e\u8868\u3002\u6709\u4e00\u4e2a\u6307\u9488\u6307\u5411\u6570\u636e\u8868\u7684\u7b2c\u4e00\u6761\u8bb0\u5f55\u7684\u524d\u9762\u3002</p> </li> <li> <p>ResultSet \u5bf9\u8c61\u7ef4\u62a4\u4e86\u4e00\u4e2a\u6307\u5411\u5f53\u524d\u6570\u636e\u884c\u7684\u6e38\u6807\uff0c\u521d\u59cb\u7684\u65f6\u5019\uff0c\u6e38\u6807\u5728\u7b2c\u4e00\u884c\u4e4b\u524d\uff0c\u53ef\u4ee5\u901a\u8fc7 ResultSet \u5bf9\u8c61\u7684 next() \u65b9\u6cd5\u79fb\u52a8\u5230\u4e0b\u4e00\u884c\u3002\u8c03\u7528 next()\u65b9\u6cd5\u68c0\u6d4b\u4e0b\u4e00\u884c\u662f\u5426\u6709\u6548\u3002\u82e5\u6709\u6548\uff0c\u8be5\u65b9\u6cd5\u8fd4\u56de true\uff0c\u4e14\u6307\u9488\u4e0b\u79fb\u3002\u76f8\u5f53\u4e8eIterator\u5bf9\u8c61\u7684 hasNext() \u548c next() \u65b9\u6cd5\u7684\u7ed3\u5408\u4f53\u3002</p> </li> <li> <p>\u5f53\u6307\u9488\u6307\u5411\u4e00\u884c\u65f6, \u53ef\u4ee5\u901a\u8fc7\u8c03\u7528 getXxx(int index) \u6216 getXxx(int columnName) \u83b7\u53d6\u6bcf\u4e00\u5217\u7684\u503c\u3002</p> </li> <li> <p>\u4f8b\u5982: getInt(1), getString(\"name\")</p> </li> <li> <p>\u6ce8\u610f\uff1aJava\u4e0e\u6570\u636e\u5e93\u4ea4\u4e92\u6d89\u53ca\u5230\u7684\u76f8\u5173Java API\u4e2d\u7684\u7d22\u5f15\u90fd\u4ece1\u5f00\u59cb\u3002</p> </li> <li> <p>ResultSet \u63a5\u53e3\u7684\u5e38\u7528\u65b9\u6cd5\uff1a</p> </li> <li> <p>boolean next()</p> </li> <li> <p>getString()</p> </li> <li>\u2026</li> </ul> <p></p>"},{"location":"programming/java/JDBC/JDBC/#342-resultsetmetadata","title":"3.4.2 ResultSetMetaData","text":"<ul> <li> <p>\u53ef\u7528\u4e8e\u83b7\u53d6\u5173\u4e8e ResultSet \u5bf9\u8c61\u4e2d\u5217\u7684\u7c7b\u578b\u548c\u5c5e\u6027\u4fe1\u606f\u7684\u5bf9\u8c61</p> </li> <li> <p>ResultSetMetaData meta = rs.getMetaData();</p> </li> <li>getColumnName(int column)\uff1a\u83b7\u53d6\u6307\u5b9a\u5217\u7684\u540d\u79f0</li> <li>getColumnLabel(int column)\uff1a\u83b7\u53d6\u6307\u5b9a\u5217\u7684\u522b\u540d</li> <li> <p>getColumnCount()\uff1a\u8fd4\u56de\u5f53\u524d ResultSet \u5bf9\u8c61\u4e2d\u7684\u5217\u6570\u3002 </p> </li> <li> <p>getColumnTypeName(int column)\uff1a\u68c0\u7d22\u6307\u5b9a\u5217\u7684\u6570\u636e\u5e93\u7279\u5b9a\u7684\u7c7b\u578b\u540d\u79f0\u3002 </p> </li> <li>getColumnDisplaySize(int column)\uff1a\u6307\u793a\u6307\u5b9a\u5217\u7684\u6700\u5927\u6807\u51c6\u5bbd\u5ea6\uff0c\u4ee5\u5b57\u7b26\u4e3a\u5355\u4f4d\u3002 </li> <li> <p>isNullable(int column)\uff1a\u6307\u793a\u6307\u5b9a\u5217\u4e2d\u7684\u503c\u662f\u5426\u53ef\u4ee5\u4e3a null\u3002 </p> </li> <li> <p>isAutoIncrement(int column)\uff1a\u6307\u793a\u662f\u5426\u81ea\u52a8\u4e3a\u6307\u5b9a\u5217\u8fdb\u884c\u7f16\u53f7\uff0c\u8fd9\u6837\u8fd9\u4e9b\u5217\u4ecd\u7136\u662f\u53ea\u8bfb\u7684\u3002 </p> </li> </ul> <p></p> <p>\u95ee\u98981\uff1a\u5f97\u5230\u7ed3\u679c\u96c6\u540e, \u5982\u4f55\u77e5\u9053\u8be5\u7ed3\u679c\u96c6\u4e2d\u6709\u54ea\u4e9b\u5217 \uff1f \u5217\u540d\u662f\u4ec0\u4e48\uff1f</p> <p>\u200b     \u9700\u8981\u4f7f\u7528\u4e00\u4e2a\u63cf\u8ff0 ResultSet \u7684\u5bf9\u8c61\uff0c \u5373 ResultSetMetaData</p> <p>\u95ee\u98982\uff1a\u5173\u4e8eResultSetMetaData</p> <ol> <li>\u5982\u4f55\u83b7\u53d6 ResultSetMetaData\uff1a \u8c03\u7528 ResultSet \u7684 getMetaData() \u65b9\u6cd5\u5373\u53ef</li> <li>\u83b7\u53d6 ResultSet \u4e2d\u6709\u591a\u5c11\u5217\uff1a\u8c03\u7528 ResultSetMetaData \u7684 getColumnCount() \u65b9\u6cd5</li> <li>\u83b7\u53d6 ResultSet \u6bcf\u4e00\u5217\u7684\u5217\u7684\u522b\u540d\u662f\u4ec0\u4e48\uff1a\u8c03\u7528 ResultSetMetaData \u7684getColumnLabel() \u65b9\u6cd5</li> </ol> <p></p>"},{"location":"programming/java/JDBC/JDBC/#35","title":"3.5 \u8d44\u6e90\u7684\u91ca\u653e","text":"<ul> <li>\u91ca\u653eResultSet, Statement,Connection\u3002</li> <li>\u6570\u636e\u5e93\u8fde\u63a5\uff08Connection\uff09\u662f\u975e\u5e38\u7a00\u6709\u7684\u8d44\u6e90\uff0c\u7528\u5b8c\u540e\u5fc5\u987b\u9a6c\u4e0a\u91ca\u653e\uff0c\u5982\u679cConnection\u4e0d\u80fd\u53ca\u65f6\u6b63\u786e\u7684\u5173\u95ed\u5c06\u5bfc\u81f4\u7cfb\u7edf\u5b95\u673a\u3002Connection\u7684\u4f7f\u7528\u539f\u5219\u662f\u5c3d\u91cf\u665a\u521b\u5efa\uff0c\u5c3d\u91cf\u65e9\u7684\u91ca\u653e\u3002</li> <li>\u53ef\u4ee5\u5728finally\u4e2d\u5173\u95ed\uff0c\u4fdd\u8bc1\u53ca\u65f6\u5176\u4ed6\u4ee3\u7801\u51fa\u73b0\u5f02\u5e38\uff0c\u8d44\u6e90\u4e5f\u4e00\u5b9a\u80fd\u88ab\u5173\u95ed\u3002</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#36-jdbc-api","title":"3.6 JDBC API\u5c0f\u7ed3","text":"<ul> <li>\u4e24\u79cd\u601d\u60f3</li> <li> <p>\u9762\u5411\u63a5\u53e3\u7f16\u7a0b\u7684\u601d\u60f3</p> </li> <li> <p>ORM\u601d\u60f3(object relational mapping)</p> <ul> <li>\u4e00\u4e2a\u6570\u636e\u8868\u5bf9\u5e94\u4e00\u4e2ajava\u7c7b</li> <li>\u8868\u4e2d\u7684\u4e00\u6761\u8bb0\u5f55\u5bf9\u5e94java\u7c7b\u7684\u4e00\u4e2a\u5bf9\u8c61</li> <li>\u8868\u4e2d\u7684\u4e00\u4e2a\u5b57\u6bb5\u5bf9\u5e94java\u7c7b\u7684\u4e00\u4e2a\u5c5e\u6027</li> </ul> </li> </ul> <p>sql\u662f\u9700\u8981\u7ed3\u5408\u5217\u540d\u548c\u8868\u7684\u5c5e\u6027\u540d\u6765\u5199\u3002\u6ce8\u610f\u8d77\u522b\u540d\u3002</p> <ul> <li>\u4e24\u79cd\u6280\u672f</li> <li>JDBC\u7ed3\u679c\u96c6\u7684\u5143\u6570\u636e\uff1aResultSetMetaData<ul> <li>\u83b7\u53d6\u5217\u6570\uff1agetColumnCount()</li> <li>\u83b7\u53d6\u5217\u7684\u522b\u540d\uff1agetColumnLabel()</li> </ul> </li> <li>\u901a\u8fc7\u53cd\u5c04\uff0c\u521b\u5efa\u6307\u5b9a\u7c7b\u7684\u5bf9\u8c61\uff0c\u83b7\u53d6\u6307\u5b9a\u7684\u5c5e\u6027\u5e76\u8d4b\u503c</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#_1","title":"\u7ae0\u8282\u7ec3\u4e60","text":"<p>\u7ec3\u4e60\u98981\uff1a\u4ece\u63a7\u5236\u53f0\u5411\u6570\u636e\u5e93\u7684\u8868customers\u4e2d\u63d2\u5165\u4e00\u6761\u6570\u636e\uff0c\u8868\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p></p> <p>\u7ec3\u4e60\u98982\uff1a\u521b\u7acb\u6570\u636e\u5e93\u8868 examstudent\uff0c\u8868\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p></p> <p>\u5411\u6570\u636e\u8868\u4e2d\u6dfb\u52a0\u5982\u4e0b\u6570\u636e\uff1a</p> <p></p> <p>\u4ee3\u7801\u5b9e\u73b01\uff1a\u63d2\u5165\u4e00\u4e2a\u65b0\u7684student \u4fe1\u606f</p> <p>\u8bf7\u8f93\u5165\u8003\u751f\u7684\u8be6\u7ec6\u4fe1\u606f</p> <p>Type:  IDCard: ExamCard: StudentName: Location: Grade:</p> <p>\u4fe1\u606f\u5f55\u5165\u6210\u529f!</p> <p>\u4ee3\u7801\u5b9e\u73b02\uff1a\u5728 eclipse\u4e2d\u5efa\u7acb java \u7a0b\u5e8f\uff1a\u8f93\u5165\u8eab\u4efd\u8bc1\u53f7\u6216\u51c6\u8003\u8bc1\u53f7\u53ef\u4ee5\u67e5\u8be2\u5230\u5b66\u751f\u7684\u57fa\u672c\u4fe1\u606f\u3002\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u4ee3\u7801\u5b9e\u73b03\uff1a\u5b8c\u6210\u5b66\u751f\u4fe1\u606f\u7684\u5220\u9664\u529f\u80fd</p> <p></p>"},{"location":"programming/java/JDBC/JDBC/#4-blob","title":"\u7b2c4\u7ae0 \u64cd\u4f5cBLOB\u7c7b\u578b\u5b57\u6bb5","text":""},{"location":"programming/java/JDBC/JDBC/#41-mysql-blob","title":"4.1 MySQL BLOB\u7c7b\u578b","text":"<ul> <li>MySQL\u4e2d\uff0cBLOB\u662f\u4e00\u4e2a\u4e8c\u8fdb\u5236\u5927\u578b\u5bf9\u8c61\uff0c\u662f\u4e00\u4e2a\u53ef\u4ee5\u5b58\u50a8\u5927\u91cf\u6570\u636e\u7684\u5bb9\u5668\uff0c\u5b83\u80fd\u5bb9\u7eb3\u4e0d\u540c\u5927\u5c0f\u7684\u6570\u636e\u3002</li> <li> <p>\u63d2\u5165BLOB\u7c7b\u578b\u7684\u6570\u636e\u5fc5\u987b\u4f7f\u7528PreparedStatement\uff0c\u56e0\u4e3aBLOB\u7c7b\u578b\u7684\u6570\u636e\u65e0\u6cd5\u4f7f\u7528\u5b57\u7b26\u4e32\u62fc\u63a5\u5199\u7684\u3002</p> </li> <li> <p>MySQL\u7684\u56db\u79cdBLOB\u7c7b\u578b(\u9664\u4e86\u5728\u5b58\u50a8\u7684\u6700\u5927\u4fe1\u606f\u91cf\u4e0a\u4e0d\u540c\u5916\uff0c\u4ed6\u4eec\u662f\u7b49\u540c\u7684)</p> </li> </ul> <p></p> <ul> <li>\u5b9e\u9645\u4f7f\u7528\u4e2d\u6839\u636e\u9700\u8981\u5b58\u5165\u7684\u6570\u636e\u5927\u5c0f\u5b9a\u4e49\u4e0d\u540c\u7684BLOB\u7c7b\u578b\u3002</li> <li>\u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u5982\u679c\u5b58\u50a8\u7684\u6587\u4ef6\u8fc7\u5927\uff0c\u6570\u636e\u5e93\u7684\u6027\u80fd\u4f1a\u4e0b\u964d\u3002</li> <li>\u5982\u679c\u5728\u6307\u5b9a\u4e86\u76f8\u5173\u7684Blob\u7c7b\u578b\u4ee5\u540e\uff0c\u8fd8\u62a5\u9519\uff1axxx too large\uff0c\u90a3\u4e48\u5728mysql\u7684\u5b89\u88c5\u76ee\u5f55\u4e0b\uff0c\u627emy.ini\u6587\u4ef6\u52a0\u4e0a\u5982\u4e0b\u7684\u914d\u7f6e\u53c2\u6570\uff1a max_allowed_packet=16M\u3002\u540c\u65f6\u6ce8\u610f\uff1a\u4fee\u6539\u4e86my.ini\u6587\u4ef6\u4e4b\u540e\uff0c\u9700\u8981\u91cd\u65b0\u542f\u52a8mysql\u670d\u52a1\u3002</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#42","title":"4.2 \u5411\u6570\u636e\u8868\u4e2d\u63d2\u5165\u5927\u6570\u636e\u7c7b\u578b","text":"<pre><code>//\u83b7\u53d6\u8fde\u63a5\nConnection conn = JDBCUtils.getConnection();\n\nString sql = \"insert into customers(name,email,birth,photo)values(?,?,?,?)\";\nPreparedStatement ps = conn.prepareStatement(sql);\n\n// \u586b\u5145\u5360\u4f4d\u7b26\nps.setString(1, \"\u5f90\u6d77\u5f3a\");\nps.setString(2, \"xhq@126.com\");\nps.setDate(3, new Date(new java.util.Date().getTime()));\n// \u64cd\u4f5cBlob\u7c7b\u578b\u7684\u53d8\u91cf\nFileInputStream fis = new FileInputStream(\"xhq.png\");\nps.setBlob(4, fis);\n//\u6267\u884c\nps.execute();\n\nfis.close();\nJDBCUtils.closeResource(conn, ps);\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#43-blob","title":"4.3 \u4fee\u6539\u6570\u636e\u8868\u4e2d\u7684Blob\u7c7b\u578b\u5b57\u6bb5","text":"<pre><code>Connection conn = JDBCUtils.getConnection();\nString sql = \"update customers set photo = ? where id = ?\";\nPreparedStatement ps = conn.prepareStatement(sql);\n\n// \u586b\u5145\u5360\u4f4d\u7b26\n// \u64cd\u4f5cBlob\u7c7b\u578b\u7684\u53d8\u91cf\nFileInputStream fis = new FileInputStream(\"coffee.png\");\nps.setBlob(1, fis);\nps.setInt(2, 25);\n\nps.execute();\n\nfis.close();\nJDBCUtils.closeResource(conn, ps);\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#44","title":"4.4 \u4ece\u6570\u636e\u8868\u4e2d\u8bfb\u53d6\u5927\u6570\u636e\u7c7b\u578b","text":"<pre><code>String sql = \"SELECT id, name, email, birth, photo FROM customer WHERE id = ?\";\nconn = getConnection();\nps = conn.prepareStatement(sql);\nps.setInt(1, 8);\nrs = ps.executeQuery();\nif(rs.next()){\n    Integer id = rs.getInt(1);\n    String name = rs.getString(2);\n    String email = rs.getString(3);\n    Date birth = rs.getDate(4);\n    Customer cust = new Customer(id, name, email, birth);\n    System.out.println(cust); \n    //\u8bfb\u53d6Blob\u7c7b\u578b\u7684\u5b57\u6bb5\n    Blob photo = rs.getBlob(5);\n    InputStream is = photo.getBinaryStream();\n    OutputStream os = new FileOutputStream(\"c.jpg\");\n    byte [] buffer = new byte[1024];\n    int len = 0;\n    while((len = is.read(buffer)) != -1){\n        os.write(buffer, 0, len);\n    }\n    JDBCUtils.closeResource(conn, ps, rs);\n\n    if(is != null){\n        is.close();\n    }\n\n    if(os !=  null){\n        os.close();\n    }\n\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#5","title":"\u7b2c5\u7ae0 \u6279\u91cf\u63d2\u5165","text":""},{"location":"programming/java/JDBC/JDBC/#51-sql","title":"5.1 \u6279\u91cf\u6267\u884cSQL\u8bed\u53e5","text":"<p>\u5f53\u9700\u8981\u6210\u6279\u63d2\u5165\u6216\u8005\u66f4\u65b0\u8bb0\u5f55\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528Java\u7684\u6279\u91cf\u66f4\u65b0\u673a\u5236\uff0c\u8fd9\u4e00\u673a\u5236\u5141\u8bb8\u591a\u6761\u8bed\u53e5\u4e00\u6b21\u6027\u63d0\u4ea4\u7ed9\u6570\u636e\u5e93\u6279\u91cf\u5904\u7406\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\u6bd4\u5355\u72ec\u63d0\u4ea4\u5904\u7406\u66f4\u6709\u6548\u7387</p> <p>JDBC\u7684\u6279\u91cf\u5904\u7406\u8bed\u53e5\u5305\u62ec\u4e0b\u9762\u4e09\u4e2a\u65b9\u6cd5\uff1a - addBatch(String)\uff1a\u6dfb\u52a0\u9700\u8981\u6279\u91cf\u5904\u7406\u7684SQL\u8bed\u53e5\u6216\u662f\u53c2\u6570\uff1b - executeBatch()\uff1a\u6267\u884c\u6279\u91cf\u5904\u7406\u8bed\u53e5\uff1b - clearBatch():\u6e05\u7a7a\u7f13\u5b58\u7684\u6570\u636e</p> <p>\u901a\u5e38\u6211\u4eec\u4f1a\u9047\u5230\u4e24\u79cd\u6279\u91cf\u6267\u884cSQL\u8bed\u53e5\u7684\u60c5\u51b5\uff1a - \u591a\u6761SQL\u8bed\u53e5\u7684\u6279\u91cf\u5904\u7406\uff1b - \u4e00\u4e2aSQL\u8bed\u53e5\u7684\u6279\u91cf\u4f20\u53c2\uff1b</p>"},{"location":"programming/java/JDBC/JDBC/#52","title":"5.2 \u9ad8\u6548\u7684\u6279\u91cf\u63d2\u5165","text":"<p>\u4e3e\u4f8b\uff1a\u5411\u6570\u636e\u8868\u4e2d\u63d2\u516520000\u6761\u6570\u636e</p> <ul> <li>\u6570\u636e\u5e93\u4e2d\u63d0\u4f9b\u4e00\u4e2agoods\u8868\u3002\u521b\u5efa\u5982\u4e0b\uff1a</li> </ul> <pre><code>CREATE TABLE goods(\nid INT PRIMARY KEY AUTO_INCREMENT,\nNAME VARCHAR(20)\n);\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#521-statement","title":"5.2.1 \u5b9e\u73b0\u5c42\u6b21\u4e00\uff1a\u4f7f\u7528Statement","text":"<pre><code>Connection conn = JDBCUtils.getConnection();\nStatement st = conn.createStatement();\nfor(int i = 1;i &lt;= 20000;i++){\n    String sql = \"insert into goods(name) values('name_' + \"+ i +\")\";\n    st.executeUpdate(sql);\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#522-preparedstatement","title":"5.2.2 \u5b9e\u73b0\u5c42\u6b21\u4e8c\uff1a\u4f7f\u7528PreparedStatement","text":"<pre><code>long start = System.currentTimeMillis();\n\nConnection conn = JDBCUtils.getConnection();\n\nString sql = \"insert into goods(name)values(?)\";\nPreparedStatement ps = conn.prepareStatement(sql);\nfor(int i = 1;i &lt;= 20000;i++){\n    ps.setString(1, \"name_\" + i);\n    ps.executeUpdate();\n}\n\nlong end = System.currentTimeMillis();\nSystem.out.println(\"\u82b1\u8d39\u7684\u65f6\u95f4\u4e3a\uff1a\" + (end - start));//82340\n\n\nJDBCUtils.closeResource(conn, ps);\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#523","title":"5.2.3 \u5b9e\u73b0\u5c42\u6b21\u4e09","text":"<pre><code>/*\n * \u4fee\u65391\uff1a \u4f7f\u7528 addBatch() / executeBatch() / clearBatch()\n * \u4fee\u65392\uff1amysql\u670d\u52a1\u5668\u9ed8\u8ba4\u662f\u5173\u95ed\u6279\u5904\u7406\u7684\uff0c\u6211\u4eec\u9700\u8981\u901a\u8fc7\u4e00\u4e2a\u53c2\u6570\uff0c\u8ba9mysql\u5f00\u542f\u6279\u5904\u7406\u7684\u652f\u6301\u3002\n *       ?rewriteBatchedStatements=true \u5199\u5728\u914d\u7f6e\u6587\u4ef6\u7684url\u540e\u9762\n * \u4fee\u65393\uff1a\u4f7f\u7528\u66f4\u65b0\u7684mysql \u9a71\u52a8\uff1amysql-connector-java-5.1.37-bin.jar\n * \n */\n@Test\npublic void testInsert1() throws Exception{\n    long start = System.currentTimeMillis();\n\n    Connection conn = JDBCUtils.getConnection();\n\n    String sql = \"insert into goods(name)values(?)\";\n    PreparedStatement ps = conn.prepareStatement(sql);\n\n    for(int i = 1;i &lt;= 1000000;i++){\n        ps.setString(1, \"name_\" + i);\n\n        //1.\u201c\u6512\u201dsql\n        ps.addBatch();\n        if(i % 500 == 0){\n            //2.\u6267\u884c\n            ps.executeBatch();\n            //3.\u6e05\u7a7a\n            ps.clearBatch();\n        }\n    }\n\n    long end = System.currentTimeMillis();\n    System.out.println(\"\u82b1\u8d39\u7684\u65f6\u95f4\u4e3a\uff1a\" + (end - start));//20000\u6761\uff1a625                                                                         //1000000\u6761:14733  \n\n    JDBCUtils.closeResource(conn, ps);\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#524","title":"5.2.4 \u5b9e\u73b0\u5c42\u6b21\u56db","text":"<pre><code>/*\n* \u5c42\u6b21\u56db\uff1a\u5728\u5c42\u6b21\u4e09\u7684\u57fa\u7840\u4e0a\u64cd\u4f5c\n* \u4f7f\u7528Connection \u7684 setAutoCommit(false)  /  commit()\n*/\n@Test\npublic void testInsert2() throws Exception{\n    long start = System.currentTimeMillis();\n\n    Connection conn = JDBCUtils.getConnection();\n\n    //1.\u8bbe\u7f6e\u4e3a\u4e0d\u81ea\u52a8\u63d0\u4ea4\u6570\u636e\n    conn.setAutoCommit(false);\n\n    String sql = \"insert into goods(name)values(?)\";\n    PreparedStatement ps = conn.prepareStatement(sql);\n\n    for(int i = 1;i &lt;= 1000000;i++){\n        ps.setString(1, \"name_\" + i);\n\n        //1.\u201c\u6512\u201dsql\n        ps.addBatch();\n\n        if(i % 500 == 0){\n            //2.\u6267\u884c\n            ps.executeBatch();\n            //3.\u6e05\u7a7a\n            ps.clearBatch();\n        }\n    }\n\n    //2.\u63d0\u4ea4\u6570\u636e\n    conn.commit();\n\n    long end = System.currentTimeMillis();\n    System.out.println(\"\u82b1\u8d39\u7684\u65f6\u95f4\u4e3a\uff1a\" + (end - start));//1000000\u6761:4978 \n\n    JDBCUtils.closeResource(conn, ps);\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#6","title":"\u7b2c6\u7ae0\uff1a \u6570\u636e\u5e93\u4e8b\u52a1","text":""},{"location":"programming/java/JDBC/JDBC/#61","title":"6.1 \u6570\u636e\u5e93\u4e8b\u52a1\u4ecb\u7ecd","text":"<ul> <li> <p>\u4e8b\u52a1\uff1a\u4e00\u7ec4\u903b\u8f91\u64cd\u4f5c\u5355\u5143,\u4f7f\u6570\u636e\u4ece\u4e00\u79cd\u72b6\u6001\u53d8\u6362\u5230\u53e6\u4e00\u79cd\u72b6\u6001\u3002</p> </li> <li> <p>\u4e8b\u52a1\u5904\u7406\uff08\u4e8b\u52a1\u64cd\u4f5c\uff09\uff1a\u4fdd\u8bc1\u6240\u6709\u4e8b\u52a1\u90fd\u4f5c\u4e3a\u4e00\u4e2a\u5de5\u4f5c\u5355\u5143\u6765\u6267\u884c\uff0c\u5373\u4f7f\u51fa\u73b0\u4e86\u6545\u969c\uff0c\u90fd\u4e0d\u80fd\u6539\u53d8\u8fd9\u79cd\u6267\u884c\u65b9\u5f0f\u3002\u5f53\u5728\u4e00\u4e2a\u4e8b\u52a1\u4e2d\u6267\u884c\u591a\u4e2a\u64cd\u4f5c\u65f6\uff0c\u8981\u4e48\u6240\u6709\u7684\u4e8b\u52a1\u90fd\u88ab\u63d0\u4ea4(commit)\uff0c\u90a3\u4e48\u8fd9\u4e9b\u4fee\u6539\u5c31\u6c38\u4e45\u5730\u4fdd\u5b58\u4e0b\u6765\uff1b\u8981\u4e48\u6570\u636e\u5e93\u7ba1\u7406\u7cfb\u7edf\u5c06\u653e\u5f03\u6240\u4f5c\u7684\u6240\u6709\u4fee\u6539\uff0c\u6574\u4e2a\u4e8b\u52a1\u56de\u6eda(rollback)\u5230\u6700\u521d\u72b6\u6001\u3002</p> </li> <li> <p>\u4e3a\u786e\u4fdd\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u4e00\u81f4\u6027\uff0c\u6570\u636e\u7684\u64cd\u7eb5\u5e94\u5f53\u662f\u79bb\u6563\u7684\u6210\u7ec4\u7684\u903b\u8f91\u5355\u5143\uff1a\u5f53\u5b83\u5168\u90e8\u5b8c\u6210\u65f6\uff0c\u6570\u636e\u7684\u4e00\u81f4\u6027\u53ef\u4ee5\u4fdd\u6301\uff0c\u800c\u5f53\u8fd9\u4e2a\u5355\u5143\u4e2d\u7684\u4e00\u90e8\u5206\u64cd\u4f5c\u5931\u8d25\uff0c\u6574\u4e2a\u4e8b\u52a1\u5e94\u5168\u90e8\u89c6\u4e3a\u9519\u8bef\uff0c\u6240\u6709\u4ece\u8d77\u59cb\u70b9\u4ee5\u540e\u7684\u64cd\u4f5c\u5e94\u5168\u90e8\u56de\u9000\u5230\u5f00\u59cb\u72b6\u6001\u3002 </p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#62-jdbc","title":"6.2 JDBC\u4e8b\u52a1\u5904\u7406","text":"<ul> <li>\u6570\u636e\u4e00\u65e6\u63d0\u4ea4\uff0c\u5c31\u4e0d\u53ef\u56de\u6eda\u3002</li> <li>\u6570\u636e\u4ec0\u4e48\u65f6\u5019\u610f\u5473\u7740\u63d0\u4ea4\uff1f</li> <li>\u5f53\u4e00\u4e2a\u8fde\u63a5\u5bf9\u8c61\u88ab\u521b\u5efa\u65f6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u81ea\u52a8\u63d0\u4ea4\u4e8b\u52a1\uff1a\u6bcf\u6b21\u6267\u884c\u4e00\u4e2a SQL \u8bed\u53e5\u65f6\uff0c\u5982\u679c\u6267\u884c\u6210\u529f\uff0c\u5c31\u4f1a\u5411\u6570\u636e\u5e93\u81ea\u52a8\u63d0\u4ea4\uff0c\u800c\u4e0d\u80fd\u56de\u6eda\u3002</li> <li>\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u6570\u636e\u5c31\u4f1a\u81ea\u52a8\u7684\u63d0\u4ea4\u3002\u5982\u679c\u591a\u4e2a\u64cd\u4f5c\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u4f7f\u7528\u7684\u662f\u81ea\u5df1\u5355\u72ec\u7684\u8fde\u63a5\uff0c\u5219\u65e0\u6cd5\u4fdd\u8bc1\u4e8b\u52a1\u3002\u5373\u540c\u4e00\u4e2a\u4e8b\u52a1\u7684\u591a\u4e2a\u64cd\u4f5c\u5fc5\u987b\u5728\u540c\u4e00\u4e2a\u8fde\u63a5\u4e0b\u3002</li> <li> <p>JDBC\u7a0b\u5e8f\u4e2d\u4e3a\u4e86\u8ba9\u591a\u4e2a SQL \u8bed\u53e5\u4f5c\u4e3a\u4e00\u4e2a\u4e8b\u52a1\u6267\u884c\uff1a</p> </li> <li> <p>\u8c03\u7528 Connection \u5bf9\u8c61\u7684 setAutoCommit(false); \u4ee5\u53d6\u6d88\u81ea\u52a8\u63d0\u4ea4\u4e8b\u52a1</p> </li> <li>\u5728\u6240\u6709\u7684 SQL \u8bed\u53e5\u90fd\u6210\u529f\u6267\u884c\u540e\uff0c\u8c03\u7528 commit(); \u65b9\u6cd5\u63d0\u4ea4\u4e8b\u52a1</li> <li>\u5728\u51fa\u73b0\u5f02\u5e38\u65f6\uff0c\u8c03\u7528 rollback(); \u65b9\u6cd5\u56de\u6eda\u4e8b\u52a1</li> </ul> <p>\u82e5\u6b64\u65f6 Connection \u6ca1\u6709\u88ab\u5173\u95ed\uff0c\u8fd8\u53ef\u80fd\u88ab\u91cd\u590d\u4f7f\u7528\uff0c\u5219\u9700\u8981\u6062\u590d\u5176\u81ea\u52a8\u63d0\u4ea4\u72b6\u6001 setAutoCommit(true)\u3002\u5c24\u5176\u662f\u5728\u4f7f\u7528\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u6280\u672f\u65f6\uff0c\u6267\u884cclose()\u65b9\u6cd5\u524d\uff0c\u5efa\u8bae\u6062\u590d\u81ea\u52a8\u63d0\u4ea4\u72b6\u6001\u3002</p> <p>\u3010\u6848\u4f8b\uff1a\u7528\u6237AA\u5411\u7528\u6237BB\u8f6c\u8d26100\u3011</p> <pre><code>public void testJDBCTransaction() {\n    Connection conn = null;\n    try {\n        // 1.\u83b7\u53d6\u6570\u636e\u5e93\u8fde\u63a5\n        conn = JDBCUtils.getConnection();\n        // 2.\u5f00\u542f\u4e8b\u52a1\n        conn.setAutoCommit(false);\n        // 3.\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c\n        String sql1 = \"update user_table set balance = balance - 100 where user = ?\";\n        update(conn, sql1, \"AA\");\n\n        // \u6a21\u62df\u7f51\u7edc\u5f02\u5e38\n        //System.out.println(10 / 0);\n\n        String sql2 = \"update user_table set balance = balance + 100 where user = ?\";\n        update(conn, sql2, \"BB\");\n        // 4.\u82e5\u6ca1\u6709\u5f02\u5e38\uff0c\u5219\u63d0\u4ea4\u4e8b\u52a1\n        conn.commit();\n    } catch (Exception e) {\n        e.printStackTrace();\n        // 5.\u82e5\u6709\u5f02\u5e38\uff0c\u5219\u56de\u6eda\u4e8b\u52a1\n        try {\n            conn.rollback();\n        } catch (SQLException e1) {\n            e1.printStackTrace();\n        }\n    } finally {\n        try {\n            //6.\u6062\u590d\u6bcf\u6b21DML\u64cd\u4f5c\u7684\u81ea\u52a8\u63d0\u4ea4\u529f\u80fd\n            conn.setAutoCommit(true);\n        } catch (SQLException e) {\n            e.printStackTrace();\n        }\n        //7.\u5173\u95ed\u8fde\u63a5\n        JDBCUtils.closeResource(conn, null, null); \n    }  \n}\n</code></pre> <p>\u5176\u4e2d\uff0c\u5bf9\u6570\u636e\u5e93\u64cd\u4f5c\u7684\u65b9\u6cd5\u4e3a\uff1a</p> <pre><code>//\u4f7f\u7528\u4e8b\u52a1\u4ee5\u540e\u7684\u901a\u7528\u7684\u589e\u5220\u6539\u64cd\u4f5c\uff08version 2.0\uff09\npublic void update(Connection conn ,String sql, Object... args) {\n    PreparedStatement ps = null;\n    try {\n        // 1.\u83b7\u53d6PreparedStatement\u7684\u5b9e\u4f8b (\u6216\uff1a\u9884\u7f16\u8bd1sql\u8bed\u53e5)\n        ps = conn.prepareStatement(sql);\n        // 2.\u586b\u5145\u5360\u4f4d\u7b26\n        for (int i = 0; i &lt; args.length; i++) {\n            ps.setObject(i + 1, args[i]);\n        }\n        // 3.\u6267\u884csql\u8bed\u53e5\n        ps.execute();\n    } catch (Exception e) {\n        e.printStackTrace();\n    } finally {\n        // 4.\u5173\u95ed\u8d44\u6e90\n        JDBCUtils.closeResource(null, ps);\n\n    }\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#63-acid","title":"6.3 \u4e8b\u52a1\u7684ACID\u5c5e\u6027","text":"<ol> <li> <p>\u539f\u5b50\u6027\uff08Atomicity\uff09     \u539f\u5b50\u6027\u662f\u6307\u4e8b\u52a1\u662f\u4e00\u4e2a\u4e0d\u53ef\u5206\u5272\u7684\u5de5\u4f5c\u5355\u4f4d\uff0c\u4e8b\u52a1\u4e2d\u7684\u64cd\u4f5c\u8981\u4e48\u90fd\u53d1\u751f\uff0c\u8981\u4e48\u90fd\u4e0d\u53d1\u751f\u3002 </p> </li> <li> <p>\u4e00\u81f4\u6027\uff08Consistency\uff09     \u4e8b\u52a1\u5fc5\u987b\u4f7f\u6570\u636e\u5e93\u4ece\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u53d8\u6362\u5230\u53e6\u5916\u4e00\u4e2a\u4e00\u81f4\u6027\u72b6\u6001\u3002</p> </li> <li> <p>\u9694\u79bb\u6027\uff08Isolation\uff09     \u4e8b\u52a1\u7684\u9694\u79bb\u6027\u662f\u6307\u4e00\u4e2a\u4e8b\u52a1\u7684\u6267\u884c\u4e0d\u80fd\u88ab\u5176\u4ed6\u4e8b\u52a1\u5e72\u6270\uff0c\u5373\u4e00\u4e2a\u4e8b\u52a1\u5185\u90e8\u7684\u64cd\u4f5c\u53ca\u4f7f\u7528\u7684\u6570\u636e\u5bf9\u5e76\u53d1\u7684\u5176\u4ed6\u4e8b\u52a1\u662f\u9694\u79bb\u7684\uff0c\u5e76\u53d1\u6267\u884c\u7684\u5404\u4e2a\u4e8b\u52a1\u4e4b\u95f4\u4e0d\u80fd\u4e92\u76f8\u5e72\u6270\u3002</p> </li> <li> <p>\u6301\u4e45\u6027\uff08Durability\uff09     \u6301\u4e45\u6027\u662f\u6307\u4e00\u4e2a\u4e8b\u52a1\u4e00\u65e6\u88ab\u63d0\u4ea4\uff0c\u5b83\u5bf9\u6570\u636e\u5e93\u4e2d\u6570\u636e\u7684\u6539\u53d8\u5c31\u662f\u6c38\u4e45\u6027\u7684\uff0c\u63a5\u4e0b\u6765\u7684\u5176\u4ed6\u64cd\u4f5c\u548c\u6570\u636e\u5e93\u6545\u969c\u4e0d\u5e94\u8be5\u5bf9\u5176\u6709\u4efb\u4f55\u5f71\u54cd\u3002</p> </li> </ol>"},{"location":"programming/java/JDBC/JDBC/#631","title":"6.3.1 \u6570\u636e\u5e93\u7684\u5e76\u53d1\u95ee\u9898","text":"<ul> <li>\u5bf9\u4e8e\u540c\u65f6\u8fd0\u884c\u7684\u591a\u4e2a\u4e8b\u52a1, \u5f53\u8fd9\u4e9b\u4e8b\u52a1\u8bbf\u95ee\u6570\u636e\u5e93\u4e2d\u76f8\u540c\u7684\u6570\u636e\u65f6, \u5982\u679c\u6ca1\u6709\u91c7\u53d6\u5fc5\u8981\u7684\u9694\u79bb\u673a\u5236, \u5c31\u4f1a\u5bfc\u81f4\u5404\u79cd\u5e76\u53d1\u95ee\u9898:</li> <li>\u810f\u8bfb: \u5bf9\u4e8e\u4e24\u4e2a\u4e8b\u52a1 T1, T2, T1 \u8bfb\u53d6\u4e86\u5df2\u7ecf\u88ab T2 \u66f4\u65b0\u4f46\u8fd8\u6ca1\u6709\u88ab\u63d0\u4ea4\u7684\u5b57\u6bb5\u3002\u4e4b\u540e, \u82e5 T2 \u56de\u6eda, T1\u8bfb\u53d6\u7684\u5185\u5bb9\u5c31\u662f\u4e34\u65f6\u4e14\u65e0\u6548\u7684\u3002</li> <li>\u4e0d\u53ef\u91cd\u590d\u8bfb: \u5bf9\u4e8e\u4e24\u4e2a\u4e8b\u52a1T1, T2, T1 \u8bfb\u53d6\u4e86\u4e00\u4e2a\u5b57\u6bb5, \u7136\u540e T2 \u66f4\u65b0\u4e86\u8be5\u5b57\u6bb5\u3002\u4e4b\u540e, T1\u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u4e2a\u5b57\u6bb5, \u503c\u5c31\u4e0d\u540c\u4e86\u3002</li> <li> <p>\u5e7b\u8bfb: \u5bf9\u4e8e\u4e24\u4e2a\u4e8b\u52a1T1, T2, T1 \u4ece\u4e00\u4e2a\u8868\u4e2d\u8bfb\u53d6\u4e86\u4e00\u4e2a\u5b57\u6bb5, \u7136\u540e T2 \u5728\u8be5\u8868\u4e2d\u63d2\u5165\u4e86\u4e00\u4e9b\u65b0\u7684\u884c\u3002\u4e4b\u540e, \u5982\u679c T1 \u518d\u6b21\u8bfb\u53d6\u540c\u4e00\u4e2a\u8868, \u5c31\u4f1a\u591a\u51fa\u51e0\u884c\u3002</p> </li> <li> <p>\u6570\u636e\u5e93\u4e8b\u52a1\u7684\u9694\u79bb\u6027: \u6570\u636e\u5e93\u7cfb\u7edf\u5fc5\u987b\u5177\u6709\u9694\u79bb\u5e76\u53d1\u8fd0\u884c\u5404\u4e2a\u4e8b\u52a1\u7684\u80fd\u529b, \u4f7f\u5b83\u4eec\u4e0d\u4f1a\u76f8\u4e92\u5f71\u54cd, \u907f\u514d\u5404\u79cd\u5e76\u53d1\u95ee\u9898\u3002</p> </li> <li> <p>\u4e00\u4e2a\u4e8b\u52a1\u4e0e\u5176\u4ed6\u4e8b\u52a1\u9694\u79bb\u7684\u7a0b\u5ea6\u79f0\u4e3a\u9694\u79bb\u7ea7\u522b\u3002\u6570\u636e\u5e93\u89c4\u5b9a\u4e86\u591a\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b, \u4e0d\u540c\u9694\u79bb\u7ea7\u522b\u5bf9\u5e94\u4e0d\u540c\u7684\u5e72\u6270\u7a0b\u5ea6, \u9694\u79bb\u7ea7\u522b\u8d8a\u9ad8, \u6570\u636e\u4e00\u81f4\u6027\u5c31\u8d8a\u597d, \u4f46\u5e76\u53d1\u6027\u8d8a\u5f31\u3002</p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#632","title":"6.3.2 \u56db\u79cd\u9694\u79bb\u7ea7\u522b","text":"<ul> <li>\u6570\u636e\u5e93\u63d0\u4f9b\u76844\u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff1a</li> </ul> <ul> <li> <p>Oracle \u652f\u6301\u7684 2 \u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\uff1aREAD COMMITED, SERIALIZABLE\u3002 Oracle \u9ed8\u8ba4\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3a: READ COMMITED \u3002</p> </li> <li> <p>Mysql \u652f\u6301 4 \u79cd\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u3002Mysql \u9ed8\u8ba4\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u4e3a: REPEATABLE READ\u3002</p> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#633-mysql","title":"6.3.3 \u5728MySql\u4e2d\u8bbe\u7f6e\u9694\u79bb\u7ea7\u522b","text":"<ul> <li> <p>\u6bcf\u542f\u52a8\u4e00\u4e2a mysql \u7a0b\u5e8f, \u5c31\u4f1a\u83b7\u5f97\u4e00\u4e2a\u5355\u72ec\u7684\u6570\u636e\u5e93\u8fde\u63a5. \u6bcf\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u90fd\u6709\u4e00\u4e2a\u5168\u5c40\u53d8\u91cf @@tx_isolation, \u8868\u793a\u5f53\u524d\u7684\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b\u3002</p> </li> <li> <p>\u67e5\u770b\u5f53\u524d\u7684\u9694\u79bb\u7ea7\u522b: </p> </li> </ul> <pre><code>SELECT @@tx_isolation;\n</code></pre> <ul> <li>\u8bbe\u7f6e\u5f53\u524d mySQL \u8fde\u63a5\u7684\u9694\u79bb\u7ea7\u522b:  </li> </ul> <pre><code>set  transaction isolation level read committed;\n</code></pre> <ul> <li>\u8bbe\u7f6e\u6570\u636e\u5e93\u7cfb\u7edf\u7684\u5168\u5c40\u7684\u9694\u79bb\u7ea7\u522b:</li> </ul> <pre><code>set global transaction isolation level read committed;\n</code></pre> <ul> <li> <p>\u8865\u5145\u64cd\u4f5c\uff1a</p> </li> <li> <p>\u521b\u5efamysql\u6570\u636e\u5e93\u7528\u6237\uff1a</p> <pre><code>create user tom identified by 'abc123';\n</code></pre> </li> <li> <p>\u6388\u4e88\u6743\u9650</p> <pre><code>#\u6388\u4e88\u901a\u8fc7\u7f51\u7edc\u65b9\u5f0f\u767b\u5f55\u7684tom\u7528\u6237\uff0c\u5bf9\u6240\u6709\u5e93\u6240\u6709\u8868\u7684\u5168\u90e8\u6743\u9650\uff0c\u5bc6\u7801\u8bbe\u4e3aabc123.\ngrant all privileges on *.* to tom@'%'  identified by 'abc123'; \n\n #\u7ed9tom\u7528\u6237\u4f7f\u7528\u672c\u5730\u547d\u4ee4\u884c\u65b9\u5f0f\uff0c\u6388\u4e88atguigudb\u8fd9\u4e2a\u5e93\u4e0b\u7684\u6240\u6709\u8868\u7684\u63d2\u5220\u6539\u67e5\u7684\u6743\u9650\u3002\ngrant select,insert,delete,update on atguigudb.* to tom@localhost identified by 'abc123'; \n</code></pre> </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#7dao","title":"\u7b2c7\u7ae0\uff1aDAO\u53ca\u76f8\u5173\u5b9e\u73b0\u7c7b","text":"<ul> <li>DAO\uff1aData Access Object\u8bbf\u95ee\u6570\u636e\u4fe1\u606f\u7684\u7c7b\u548c\u63a5\u53e3\uff0c\u5305\u62ec\u4e86\u5bf9\u6570\u636e\u7684CRUD\uff08Create\u3001Retrival\u3001Update\u3001Delete\uff09\uff0c\u800c\u4e0d\u5305\u542b\u4efb\u4f55\u4e1a\u52a1\u76f8\u5173\u7684\u4fe1\u606f\u3002\u6709\u65f6\u4e5f\u79f0\u4f5c\uff1aBaseDAO</li> <li>\u4f5c\u7528\uff1a\u4e3a\u4e86\u5b9e\u73b0\u529f\u80fd\u7684\u6a21\u5757\u5316\uff0c\u66f4\u6709\u5229\u4e8e\u4ee3\u7801\u7684\u7ef4\u62a4\u548c\u5347\u7ea7\u3002</li> <li>\u4e0b\u9762\u662f\u5c1a\u7845\u8c37JavaWeb\u9636\u6bb5\u4e66\u57ce\u9879\u76ee\u4e2dDAO\u4f7f\u7528\u7684\u4f53\u73b0\uff1a</li> </ul> <ul> <li>\u5c42\u6b21\u7ed3\u6784\uff1a</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#basedaojava","title":"\u3010BaseDAO.java\u3011","text":"<pre><code>package com.atguigu.bookstore.dao;\n\nimport java.lang.reflect.ParameterizedType;\nimport java.lang.reflect.Type;\nimport java.sql.Connection;\nimport java.sql.SQLException;\nimport java.util.List;\n\nimport org.apache.commons.dbutils.QueryRunner;\nimport org.apache.commons.dbutils.handlers.BeanHandler;\nimport org.apache.commons.dbutils.handlers.BeanListHandler;\nimport org.apache.commons.dbutils.handlers.ScalarHandler;\n\n\n/**\n * \u5b9a\u4e49\u4e00\u4e2a\u7528\u6765\u88ab\u7ee7\u627f\u7684\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u57fa\u672c\u64cd\u4f5c\u7684Dao\n * \n * @author HanYanBing\n *\n * @param &lt;T&gt;\n */\npublic abstract class BaseDao&lt;T&gt; {\n    private QueryRunner queryRunner = new QueryRunner();\n    // \u5b9a\u4e49\u4e00\u4e2a\u53d8\u91cf\u6765\u63a5\u6536\u6cdb\u578b\u7684\u7c7b\u578b\n    private Class&lt;T&gt; type;\n\n    // \u83b7\u53d6T\u7684Class\u5bf9\u8c61\uff0c\u83b7\u53d6\u6cdb\u578b\u7684\u7c7b\u578b\uff0c\u6cdb\u578b\u662f\u5728\u88ab\u5b50\u7c7b\u7ee7\u627f\u65f6\u624d\u786e\u5b9a\n    public BaseDao() {\n        // \u83b7\u53d6\u5b50\u7c7b\u7684\u7c7b\u578b\n        Class clazz = this.getClass();\n        // \u83b7\u53d6\u7236\u7c7b\u7684\u7c7b\u578b\n        // getGenericSuperclass()\u7528\u6765\u83b7\u53d6\u5f53\u524d\u7c7b\u7684\u7236\u7c7b\u7684\u7c7b\u578b\n        // ParameterizedType\u8868\u793a\u7684\u662f\u5e26\u6cdb\u578b\u7684\u7c7b\u578b\n        ParameterizedType parameterizedType = (ParameterizedType) clazz.getGenericSuperclass();\n        // \u83b7\u53d6\u5177\u4f53\u7684\u6cdb\u578b\u7c7b\u578b getActualTypeArguments\u83b7\u53d6\u5177\u4f53\u7684\u6cdb\u578b\u7684\u7c7b\u578b\n        // \u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u8fd4\u56de\u4e00\u4e2aType\u7684\u6570\u7ec4\n        Type[] types = parameterizedType.getActualTypeArguments();\n        // \u83b7\u53d6\u5177\u4f53\u7684\u6cdb\u578b\u7684\u7c7b\u578b\u00b7\n        this.type = (Class&lt;T&gt;) types[0];\n    }\n\n    /**\n     * \u901a\u7528\u7684\u589e\u5220\u6539\u64cd\u4f5c\n     * \n     * @param sql\n     * @param params\n     * @return\n     */\n    public int update(Connection conn,String sql, Object... params) {\n        int count = 0;\n        try {\n            count = queryRunner.update(conn, sql, params);\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } \n        return count;\n    }\n\n    /**\n     * \u83b7\u53d6\u4e00\u4e2a\u5bf9\u8c61\n     * \n     * @param sql\n     * @param params\n     * @return\n     */\n    public T getBean(Connection conn,String sql, Object... params) {\n        T t = null;\n        try {\n            t = queryRunner.query(conn, sql, new BeanHandler&lt;T&gt;(type), params);\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } \n        return t;\n    }\n\n    /**\n     * \u83b7\u53d6\u6240\u6709\u5bf9\u8c61\n     * \n     * @param sql\n     * @param params\n     * @return\n     */\n    public List&lt;T&gt; getBeanList(Connection conn,String sql, Object... params) {\n        List&lt;T&gt; list = null;\n        try {\n            list = queryRunner.query(conn, sql, new BeanListHandler&lt;T&gt;(type), params);\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } \n        return list;\n    }\n\n    /**\n     * \u83b7\u53d6\u4e00\u4e2a\u4f46\u4e00\u503c\u5f97\u65b9\u6cd5\uff0c\u4e13\u95e8\u7528\u6765\u6267\u884c\u50cf select count(*)...\u8fd9\u6837\u7684sql\u8bed\u53e5\n     * \n     * @param sql\n     * @param params\n     * @return\n     */\n    public Object getValue(Connection conn,String sql, Object... params) {\n        Object count = null;\n        try {\n            // \u8c03\u7528queryRunner\u7684query\u65b9\u6cd5\u83b7\u53d6\u4e00\u4e2a\u5355\u4e00\u7684\u503c\n            count = queryRunner.query(conn, sql, new ScalarHandler&lt;&gt;(), params);\n        } catch (SQLException e) {\n            e.printStackTrace();\n        } \n        return count;\n    }\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#bookdaojava","title":"\u3010BookDAO.java\u3011","text":"<pre><code>package com.atguigu.bookstore.dao;\n\nimport java.sql.Connection;\nimport java.util.List;\n\nimport com.atguigu.bookstore.beans.Book;\nimport com.atguigu.bookstore.beans.Page;\n\npublic interface BookDao {\n\n    /**\n     * \u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u51fa\u6240\u6709\u7684\u8bb0\u5f55\n     * \n     * @return\n     */\n    List&lt;Book&gt; getBooks(Connection conn);\n\n    /**\n     * \u5411\u6570\u636e\u5e93\u4e2d\u63d2\u5165\u4e00\u6761\u8bb0\u5f55\n     * \n     * @param book\n     */\n    void saveBook(Connection conn,Book book);\n\n    /**\n     * \u4ece\u6570\u636e\u5e93\u4e2d\u6839\u636e\u56fe\u4e66\u7684id\u5220\u9664\u4e00\u6761\u8bb0\u5f55\n     * \n     * @param bookId\n     */\n    void deleteBookById(Connection conn,String bookId);\n\n    /**\n     * \u6839\u636e\u56fe\u4e66\u7684id\u4ece\u6570\u636e\u5e93\u4e2d\u67e5\u8be2\u51fa\u4e00\u6761\u8bb0\u5f55\n     * \n     * @param bookId\n     * @return\n     */\n    Book getBookById(Connection conn,String bookId);\n\n    /**\n     * \u6839\u636e\u56fe\u4e66\u7684id\u4ece\u6570\u636e\u5e93\u4e2d\u66f4\u65b0\u4e00\u6761\u8bb0\u5f55\n     * \n     * @param book\n     */\n    void updateBook(Connection conn,Book book);\n\n    /**\n     * \u83b7\u53d6\u5e26\u5206\u9875\u7684\u56fe\u4e66\u4fe1\u606f\n     * \n     * @param page\uff1a\u662f\u53ea\u5305\u542b\u4e86\u7528\u6237\u8f93\u5165\u7684pageNo\u5c5e\u6027\u7684page\u5bf9\u8c61\n     * @return \u8fd4\u56de\u7684Page\u5bf9\u8c61\u662f\u5305\u542b\u4e86\u6240\u6709\u5c5e\u6027\u7684Page\u5bf9\u8c61\n     */\n    Page&lt;Book&gt; getPageBooks(Connection conn,Page&lt;Book&gt; page);\n\n    /**\n     * \u83b7\u53d6\u5e26\u5206\u9875\u548c\u4ef7\u683c\u8303\u56f4\u7684\u56fe\u4e66\u4fe1\u606f\n     * \n     * @param page\uff1a\u662f\u53ea\u5305\u542b\u4e86\u7528\u6237\u8f93\u5165\u7684pageNo\u5c5e\u6027\u7684page\u5bf9\u8c61\n     * @return \u8fd4\u56de\u7684Page\u5bf9\u8c61\u662f\u5305\u542b\u4e86\u6240\u6709\u5c5e\u6027\u7684Page\u5bf9\u8c61\n     */\n    Page&lt;Book&gt; getPageBooksByPrice(Connection conn,Page&lt;Book&gt; page, double minPrice, double maxPrice);\n\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#userdaojava","title":"\u3010UserDAO.java\u3011","text":"<pre><code>package com.atguigu.bookstore.dao;\n\nimport java.sql.Connection;\n\nimport com.atguigu.bookstore.beans.User;\n\npublic interface UserDao {\n\n    /**\n     * \u6839\u636eUser\u5bf9\u8c61\u4e2d\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u4ece\u6570\u636e\u5e93\u4e2d\u83b7\u53d6\u4e00\u6761\u8bb0\u5f55\n     * \n     * @param user\n     * @return User \u6570\u636e\u5e93\u4e2d\u6709\u8bb0\u5f55 null \u6570\u636e\u5e93\u4e2d\u65e0\u6b64\u8bb0\u5f55\n     */\n    User getUser(Connection conn,User user);\n\n    /**\n     * \u6839\u636eUser\u5bf9\u8c61\u4e2d\u7684\u7528\u6237\u540d\u4ece\u6570\u636e\u5e93\u4e2d\u83b7\u53d6\u4e00\u6761\u8bb0\u5f55\n     * \n     * @param user\n     * @return true \u6570\u636e\u5e93\u4e2d\u6709\u8bb0\u5f55 false \u6570\u636e\u5e93\u4e2d\u65e0\u6b64\u8bb0\u5f55\n     */\n    boolean checkUsername(Connection conn,User user);\n\n    /**\n     * \u5411\u6570\u636e\u5e93\u4e2d\u63d2\u5165User\u5bf9\u8c61\n     * \n     * @param user\n     */\n    void saveUser(Connection conn,User user);\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#bookdaoimpljava","title":"\u3010BookDaoImpl.java\u3011","text":"<pre><code>package com.atguigu.bookstore.dao.impl;\n\nimport java.sql.Connection;\nimport java.util.List;\n\nimport com.atguigu.bookstore.beans.Book;\nimport com.atguigu.bookstore.beans.Page;\nimport com.atguigu.bookstore.dao.BaseDao;\nimport com.atguigu.bookstore.dao.BookDao;\n\npublic class BookDaoImpl extends BaseDao&lt;Book&gt; implements BookDao {\n\n    @Override\n    public List&lt;Book&gt; getBooks(Connection conn) {\n        // \u8c03\u7528BaseDao\u4e2d\u5f97\u5230\u4e00\u4e2aList\u7684\u65b9\u6cd5\n        List&lt;Book&gt; beanList = null;\n        // \u5199sql\u8bed\u53e5\n        String sql = \"select id,title,author,price,sales,stock,img_path imgPath from books\";\n        beanList = getBeanList(conn,sql);\n        return beanList;\n    }\n\n    @Override\n    public void saveBook(Connection conn,Book book) {\n        // \u5199sql\u8bed\u53e5\n        String sql = \"insert into books(title,author,price,sales,stock,img_path) values(?,?,?,?,?,?)\";\n        // \u8c03\u7528BaseDao\u4e2d\u901a\u7528\u7684\u589e\u5220\u6539\u7684\u65b9\u6cd5\n        update(conn,sql, book.getTitle(), book.getAuthor(), book.getPrice(), book.getSales(), book.getStock(),book.getImgPath());\n    }\n\n    @Override\n    public void deleteBookById(Connection conn,String bookId) {\n        // \u5199sql\u8bed\u53e5\n        String sql = \"DELETE FROM books WHERE id = ?\";\n        // \u8c03\u7528BaseDao\u4e2d\u901a\u7528\u589e\u5220\u6539\u7684\u65b9\u6cd5\n        update(conn,sql, bookId);\n\n    }\n\n    @Override\n    public Book getBookById(Connection conn,String bookId) {\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5bf9\u8c61\u7684\u65b9\u6cd5\n        Book book = null;\n        // \u5199sql\u8bed\u53e5\n        String sql = \"select id,title,author,price,sales,stock,img_path imgPath from books where id = ?\";\n        book = getBean(conn,sql, bookId);\n        return book;\n    }\n\n    @Override\n    public void updateBook(Connection conn,Book book) {\n        // \u5199sql\u8bed\u53e5\n        String sql = \"update books set title = ? , author = ? , price = ? , sales = ? , stock = ? where id = ?\";\n        // \u8c03\u7528BaseDao\u4e2d\u901a\u7528\u7684\u589e\u5220\u6539\u7684\u65b9\u6cd5\n        update(conn,sql, book.getTitle(), book.getAuthor(), book.getPrice(), book.getSales(), book.getStock(), book.getId());\n    }\n\n    @Override\n    public Page&lt;Book&gt; getPageBooks(Connection conn,Page&lt;Book&gt; page) {\n        // \u83b7\u53d6\u6570\u636e\u5e93\u4e2d\u56fe\u4e66\u7684\u603b\u8bb0\u5f55\u6570\n        String sql = \"select count(*) from books\";\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5355\u4e00\u503c\u7684\u65b9\u6cd5\n        long totalRecord = (long) getValue(conn,sql);\n        // \u5c06\u603b\u8bb0\u5f55\u6570\u8bbe\u7f6e\u90fdpage\u5bf9\u8c61\u4e2d\n        page.setTotalRecord((int) totalRecord);\n\n        // \u83b7\u53d6\u5f53\u524d\u9875\u4e2d\u7684\u8bb0\u5f55\u5b58\u653e\u7684List\n        String sql2 = \"select id,title,author,price,sales,stock,img_path imgPath from books limit ?,?\";\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u96c6\u5408\u7684\u65b9\u6cd5\n        List&lt;Book&gt; beanList = getBeanList(conn,sql2, (page.getPageNo() - 1) * Page.PAGE_SIZE, Page.PAGE_SIZE);\n        // \u5c06\u8fd9\u4e2aList\u8bbe\u7f6e\u5230page\u5bf9\u8c61\u4e2d\n        page.setList(beanList);\n        return page;\n    }\n\n    @Override\n    public Page&lt;Book&gt; getPageBooksByPrice(Connection conn,Page&lt;Book&gt; page, double minPrice, double maxPrice) {\n        // \u83b7\u53d6\u6570\u636e\u5e93\u4e2d\u56fe\u4e66\u7684\u603b\u8bb0\u5f55\u6570\n        String sql = \"select count(*) from books where price between ? and ?\";\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5355\u4e00\u503c\u7684\u65b9\u6cd5\n        long totalRecord = (long) getValue(conn,sql,minPrice,maxPrice);\n        // \u5c06\u603b\u8bb0\u5f55\u6570\u8bbe\u7f6e\u90fdpage\u5bf9\u8c61\u4e2d\n        page.setTotalRecord((int) totalRecord);\n\n        // \u83b7\u53d6\u5f53\u524d\u9875\u4e2d\u7684\u8bb0\u5f55\u5b58\u653e\u7684List\n        String sql2 = \"select id,title,author,price,sales,stock,img_path imgPath from books where price between ? and ? limit ?,?\";\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u96c6\u5408\u7684\u65b9\u6cd5\n        List&lt;Book&gt; beanList = getBeanList(conn,sql2, minPrice , maxPrice , (page.getPageNo() - 1) * Page.PAGE_SIZE, Page.PAGE_SIZE);\n        // \u5c06\u8fd9\u4e2aList\u8bbe\u7f6e\u5230page\u5bf9\u8c61\u4e2d\n        page.setList(beanList);\n\n        return page;\n    }\n\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#userdaoimpljava","title":"\u3010UserDaoImpl.java\u3011","text":"<pre><code>package com.atguigu.bookstore.dao.impl;\n\nimport java.sql.Connection;\n\nimport com.atguigu.bookstore.beans.User;\nimport com.atguigu.bookstore.dao.BaseDao;\nimport com.atguigu.bookstore.dao.UserDao;\n\npublic class UserDaoImpl extends BaseDao&lt;User&gt; implements UserDao {\n\n    @Override\n    public User getUser(Connection conn,User user) {\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5bf9\u8c61\u7684\u65b9\u6cd5\n        User bean = null;\n        // \u5199sql\u8bed\u53e5\n        String sql = \"select id,username,password,email from users where username = ? and password = ?\";\n        bean = getBean(conn,sql, user.getUsername(), user.getPassword());\n        return bean;\n    }\n\n    @Override\n    public boolean checkUsername(Connection conn,User user) {\n        // \u8c03\u7528BaseDao\u4e2d\u83b7\u53d6\u4e00\u4e2a\u5bf9\u8c61\u7684\u65b9\u6cd5\n        User bean = null;\n        // \u5199sql\u8bed\u53e5\n        String sql = \"select id,username,password,email from users where username = ?\";\n        bean = getBean(conn,sql, user.getUsername());\n        return bean != null;\n    }\n\n    @Override\n    public void saveUser(Connection conn,User user) {\n        //\u5199sql\u8bed\u53e5\n        String sql = \"insert into users(username,password,email) values(?,?,?)\";\n        //\u8c03\u7528BaseDao\u4e2d\u901a\u7528\u7684\u589e\u5220\u6539\u7684\u65b9\u6cd5\n        update(conn,sql, user.getUsername(),user.getPassword(),user.getEmail());\n    }\n\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#bookjava","title":"\u3010Book.java\u3011","text":"<pre><code>package com.atguigu.bookstore.beans;\n/**\n * \u56fe\u4e66\u7c7b\n * @author songhongkang\n *\n */\npublic class Book {\n\n    private Integer id;\n    private String title; // \u4e66\u540d\n    private String author; // \u4f5c\u8005\n    private double price; // \u4ef7\u683c\n    private Integer sales; // \u9500\u91cf\n    private Integer stock; // \u5e93\u5b58\n    private String imgPath = \"static/img/default.jpg\"; // \u5c01\u9762\u56fe\u7247\u7684\u8def\u5f84\n    //\u6784\u9020\u5668\uff0cget()\uff0cset()\uff0ctoString()\u65b9\u6cd5\u7565\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#pagejava","title":"\u3010Page.java\u3011","text":"<pre><code>package com.atguigu.bookstore.beans;\n\nimport java.util.List;\n/**\n * \u9875\u7801\u7c7b\n * @author songhongkang\n *\n */\npublic class Page&lt;T&gt; {\n\n    private List&lt;T&gt; list; // \u6bcf\u9875\u67e5\u5230\u7684\u8bb0\u5f55\u5b58\u653e\u7684\u96c6\u5408\n    public static final int PAGE_SIZE = 4; // \u6bcf\u9875\u663e\u793a\u7684\u8bb0\u5f55\u6570\n    private int pageNo; // \u5f53\u524d\u9875\n//  private int totalPageNo; // \u603b\u9875\u6570\uff0c\u901a\u8fc7\u8ba1\u7b97\u5f97\u5230\n    private int totalRecord; // \u603b\u8bb0\u5f55\u6570\uff0c\u901a\u8fc7\u67e5\u8be2\u6570\u636e\u5e93\u5f97\u5230\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#userjava","title":"\u3010User.java\u3011","text":"<pre><code>package com.atguigu.bookstore.beans;\n/**\n * \u7528\u6237\u7c7b\n * @author songhongkang\n *\n */\npublic class User {\n\n    private Integer id;\n    private String username;\n    private String password;\n    private String email;\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#8","title":"\u7b2c8\u7ae0\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u6c60","text":""},{"location":"programming/java/JDBC/JDBC/#81-jdbc","title":"8.1 JDBC\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u5fc5\u8981\u6027","text":"<ul> <li>\u5728\u4f7f\u7528\u5f00\u53d1\u57fa\u4e8e\u6570\u636e\u5e93\u7684web\u7a0b\u5e8f\u65f6\uff0c\u4f20\u7edf\u7684\u6a21\u5f0f\u57fa\u672c\u662f\u6309\u4ee5\u4e0b\u6b65\u9aa4\uff1a\u3000\u3000</li> <li>\u5728\u4e3b\u7a0b\u5e8f\uff08\u5982servlet\u3001beans\uff09\u4e2d\u5efa\u7acb\u6570\u636e\u5e93\u8fde\u63a5</li> <li>\u8fdb\u884csql\u64cd\u4f5c</li> <li> <p>\u65ad\u5f00\u6570\u636e\u5e93\u8fde\u63a5</p> </li> <li> <p>\u8fd9\u79cd\u6a21\u5f0f\u5f00\u53d1\uff0c\u5b58\u5728\u7684\u95ee\u9898:</p> </li> <li>\u666e\u901a\u7684JDBC\u6570\u636e\u5e93\u8fde\u63a5\u4f7f\u7528 DriverManager \u6765\u83b7\u53d6\uff0c\u6bcf\u6b21\u5411\u6570\u636e\u5e93\u5efa\u7acb\u8fde\u63a5\u7684\u65f6\u5019\u90fd\u8981\u5c06 Connection \u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u518d\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u5bc6\u7801(\u5f97\u82b1\u8d390.05s\uff5e1s\u7684\u65f6\u95f4)\u3002\u9700\u8981\u6570\u636e\u5e93\u8fde\u63a5\u7684\u65f6\u5019\uff0c\u5c31\u5411\u6570\u636e\u5e93\u8981\u6c42\u4e00\u4e2a\uff0c\u6267\u884c\u5b8c\u6210\u540e\u518d\u65ad\u5f00\u8fde\u63a5\u3002\u8fd9\u6837\u7684\u65b9\u5f0f\u5c06\u4f1a\u6d88\u8017\u5927\u91cf\u7684\u8d44\u6e90\u548c\u65f6\u95f4\u3002\u6570\u636e\u5e93\u7684\u8fde\u63a5\u8d44\u6e90\u5e76\u6ca1\u6709\u5f97\u5230\u5f88\u597d\u7684\u91cd\u590d\u5229\u7528\u3002\u82e5\u540c\u65f6\u6709\u51e0\u767e\u4eba\u751a\u81f3\u51e0\u5343\u4eba\u5728\u7ebf\uff0c\u9891\u7e41\u7684\u8fdb\u884c\u6570\u636e\u5e93\u8fde\u63a5\u64cd\u4f5c\u5c06\u5360\u7528\u5f88\u591a\u7684\u7cfb\u7edf\u8d44\u6e90\uff0c\u4e25\u91cd\u7684\u751a\u81f3\u4f1a\u9020\u6210\u670d\u52a1\u5668\u7684\u5d29\u6e83\u3002</li> <li>\u5bf9\u4e8e\u6bcf\u4e00\u6b21\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u4f7f\u7528\u5b8c\u540e\u90fd\u5f97\u65ad\u5f00\u3002\u5426\u5219\uff0c\u5982\u679c\u7a0b\u5e8f\u51fa\u73b0\u5f02\u5e38\u800c\u672a\u80fd\u5173\u95ed\uff0c\u5c06\u4f1a\u5bfc\u81f4\u6570\u636e\u5e93\u7cfb\u7edf\u4e2d\u7684\u5185\u5b58\u6cc4\u6f0f\uff0c\u6700\u7ec8\u5c06\u5bfc\u81f4\u91cd\u542f\u6570\u636e\u5e93\u3002\uff08\u56de\u5fc6\uff1a\u4f55\u4e3aJava\u7684\u5185\u5b58\u6cc4\u6f0f\uff1f\uff09</li> <li>\u8fd9\u79cd\u5f00\u53d1\u4e0d\u80fd\u63a7\u5236\u88ab\u521b\u5efa\u7684\u8fde\u63a5\u5bf9\u8c61\u6570\uff0c\u7cfb\u7edf\u8d44\u6e90\u4f1a\u88ab\u6beb\u65e0\u987e\u53ca\u7684\u5206\u914d\u51fa\u53bb\uff0c\u5982\u8fde\u63a5\u8fc7\u591a\uff0c\u4e5f\u53ef\u80fd\u5bfc\u81f4\u5185\u5b58\u6cc4\u6f0f\uff0c\u670d\u52a1\u5668\u5d29\u6e83\u3002 </li> </ul>"},{"location":"programming/java/JDBC/JDBC/#82","title":"8.2 \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u6280\u672f","text":"<ul> <li>\u4e3a\u89e3\u51b3\u4f20\u7edf\u5f00\u53d1\u4e2d\u7684\u6570\u636e\u5e93\u8fde\u63a5\u95ee\u9898\uff0c\u53ef\u4ee5\u91c7\u7528\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u6280\u672f\u3002</li> <li> <p>\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u57fa\u672c\u601d\u60f3\uff1a\u5c31\u662f\u4e3a\u6570\u636e\u5e93\u8fde\u63a5\u5efa\u7acb\u4e00\u4e2a\u201c\u7f13\u51b2\u6c60\u201d\u3002\u9884\u5148\u5728\u7f13\u51b2\u6c60\u4e2d\u653e\u5165\u4e00\u5b9a\u6570\u91cf\u7684\u8fde\u63a5\uff0c\u5f53\u9700\u8981\u5efa\u7acb\u6570\u636e\u5e93\u8fde\u63a5\u65f6\uff0c\u53ea\u9700\u4ece\u201c\u7f13\u51b2\u6c60\u201d\u4e2d\u53d6\u51fa\u4e00\u4e2a\uff0c\u4f7f\u7528\u5b8c\u6bd5\u4e4b\u540e\u518d\u653e\u56de\u53bb\u3002</p> </li> <li> <p>\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u8d1f\u8d23\u5206\u914d\u3001\u7ba1\u7406\u548c\u91ca\u653e\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u5b83\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u91cd\u590d\u4f7f\u7528\u4e00\u4e2a\u73b0\u6709\u7684\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u800c\u4e0d\u662f\u91cd\u65b0\u5efa\u7acb\u4e00\u4e2a\u3002</p> </li> <li>\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5728\u521d\u59cb\u5316\u65f6\u5c06\u521b\u5efa\u4e00\u5b9a\u6570\u91cf\u7684\u6570\u636e\u5e93\u8fde\u63a5\u653e\u5230\u8fde\u63a5\u6c60\u4e2d\uff0c\u8fd9\u4e9b\u6570\u636e\u5e93\u8fde\u63a5\u7684\u6570\u91cf\u662f\u7531\u6700\u5c0f\u6570\u636e\u5e93\u8fde\u63a5\u6570\u6765\u8bbe\u5b9a\u7684\u3002\u65e0\u8bba\u8fd9\u4e9b\u6570\u636e\u5e93\u8fde\u63a5\u662f\u5426\u88ab\u4f7f\u7528\uff0c\u8fde\u63a5\u6c60\u90fd\u5c06\u4e00\u76f4\u4fdd\u8bc1\u81f3\u5c11\u62e5\u6709\u8fd9\u4e48\u591a\u7684\u8fde\u63a5\u6570\u91cf\u3002\u8fde\u63a5\u6c60\u7684\u6700\u5927\u6570\u636e\u5e93\u8fde\u63a5\u6570\u91cf\u9650\u5b9a\u4e86\u8fd9\u4e2a\u8fde\u63a5\u6c60\u80fd\u5360\u6709\u7684\u6700\u5927\u8fde\u63a5\u6570\uff0c\u5f53\u5e94\u7528\u7a0b\u5e8f\u5411\u8fde\u63a5\u6c60\u8bf7\u6c42\u7684\u8fde\u63a5\u6570\u8d85\u8fc7\u6700\u5927\u8fde\u63a5\u6570\u91cf\u65f6\uff0c\u8fd9\u4e9b\u8bf7\u6c42\u5c06\u88ab\u52a0\u5165\u5230\u7b49\u5f85\u961f\u5217\u4e2d\u3002</li> </ul> <p></p> <ul> <li>\u5de5\u4f5c\u539f\u7406\uff1a</li> </ul> <p></p> <ul> <li>\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u6280\u672f\u7684\u4f18\u70b9</li> </ul> <p>1. \u8d44\u6e90\u91cd\u7528</p> <p>\u7531\u4e8e\u6570\u636e\u5e93\u8fde\u63a5\u5f97\u4ee5\u91cd\u7528\uff0c\u907f\u514d\u4e86\u9891\u7e41\u521b\u5efa\uff0c\u91ca\u653e\u8fde\u63a5\u5f15\u8d77\u7684\u5927\u91cf\u6027\u80fd\u5f00\u9500\u3002\u5728\u51cf\u5c11\u7cfb\u7edf\u6d88\u8017\u7684\u57fa\u7840\u4e0a\uff0c\u53e6\u4e00\u65b9\u9762\u4e5f\u589e\u52a0\u4e86\u7cfb\u7edf\u8fd0\u884c\u73af\u5883\u7684\u5e73\u7a33\u6027\u3002</p> <p>2. \u66f4\u5feb\u7684\u7cfb\u7edf\u53cd\u5e94\u901f\u5ea6</p> <p>\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5728\u521d\u59cb\u5316\u8fc7\u7a0b\u4e2d\uff0c\u5f80\u5f80\u5df2\u7ecf\u521b\u5efa\u4e86\u82e5\u5e72\u6570\u636e\u5e93\u8fde\u63a5\u7f6e\u4e8e\u8fde\u63a5\u6c60\u4e2d\u5907\u7528\u3002\u6b64\u65f6\u8fde\u63a5\u7684\u521d\u59cb\u5316\u5de5\u4f5c\u5747\u5df2\u5b8c\u6210\u3002\u5bf9\u4e8e\u4e1a\u52a1\u8bf7\u6c42\u5904\u7406\u800c\u8a00\uff0c\u76f4\u63a5\u5229\u7528\u73b0\u6709\u53ef\u7528\u8fde\u63a5\uff0c\u907f\u514d\u4e86\u6570\u636e\u5e93\u8fde\u63a5\u521d\u59cb\u5316\u548c\u91ca\u653e\u8fc7\u7a0b\u7684\u65f6\u95f4\u5f00\u9500\uff0c\u4ece\u800c\u51cf\u5c11\u4e86\u7cfb\u7edf\u7684\u54cd\u5e94\u65f6\u95f4</p> <p>3. \u65b0\u7684\u8d44\u6e90\u5206\u914d\u624b\u6bb5</p> <p>\u5bf9\u4e8e\u591a\u5e94\u7528\u5171\u4eab\u540c\u4e00\u6570\u636e\u5e93\u7684\u7cfb\u7edf\u800c\u8a00\uff0c\u53ef\u5728\u5e94\u7528\u5c42\u901a\u8fc7\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u914d\u7f6e\uff0c\u5b9e\u73b0\u67d0\u4e00\u5e94\u7528\u6700\u5927\u53ef\u7528\u6570\u636e\u5e93\u8fde\u63a5\u6570\u7684\u9650\u5236\uff0c\u907f\u514d\u67d0\u4e00\u5e94\u7528\u72ec\u5360\u6240\u6709\u7684\u6570\u636e\u5e93\u8d44\u6e90</p> <p>4. \u7edf\u4e00\u7684\u8fde\u63a5\u7ba1\u7406\uff0c\u907f\u514d\u6570\u636e\u5e93\u8fde\u63a5\u6cc4\u6f0f</p> <p>\u5728\u8f83\u4e3a\u5b8c\u5584\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5b9e\u73b0\u4e2d\uff0c\u53ef\u6839\u636e\u9884\u5148\u7684\u5360\u7528\u8d85\u65f6\u8bbe\u5b9a\uff0c\u5f3a\u5236\u56de\u6536\u88ab\u5360\u7528\u8fde\u63a5\uff0c\u4ece\u800c\u907f\u514d\u4e86\u5e38\u89c4\u6570\u636e\u5e93\u8fde\u63a5\u64cd\u4f5c\u4e2d\u53ef\u80fd\u51fa\u73b0\u7684\u8d44\u6e90\u6cc4\u9732</p>"},{"location":"programming/java/JDBC/JDBC/#83","title":"8.3 \u591a\u79cd\u5f00\u6e90\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60","text":"<ul> <li>JDBC \u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4f7f\u7528 javax.sql.DataSource \u6765\u8868\u793a\uff0cDataSource \u53ea\u662f\u4e00\u4e2a\u63a5\u53e3\uff0c\u8be5\u63a5\u53e3\u901a\u5e38\u7531\u670d\u52a1\u5668(Weblogic, WebSphere, Tomcat)\u63d0\u4f9b\u5b9e\u73b0\uff0c\u4e5f\u6709\u4e00\u4e9b\u5f00\u6e90\u7ec4\u7ec7\u63d0\u4f9b\u5b9e\u73b0\uff1a</li> <li>DBCP \u662fApache\u63d0\u4f9b\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002tomcat \u670d\u52a1\u5668\u81ea\u5e26dbcp\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002\u901f\u5ea6\u76f8\u5bf9c3p0\u8f83\u5feb\uff0c\u4f46\u56e0\u81ea\u8eab\u5b58\u5728BUG\uff0cHibernate3\u5df2\u4e0d\u518d\u63d0\u4f9b\u652f\u6301\u3002</li> <li>C3P0 \u662f\u4e00\u4e2a\u5f00\u6e90\u7ec4\u7ec7\u63d0\u4f9b\u7684\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u901f\u5ea6\u76f8\u5bf9\u8f83\u6162\uff0c\u7a33\u5b9a\u6027\u8fd8\u53ef\u4ee5\u3002hibernate\u5b98\u65b9\u63a8\u8350\u4f7f\u7528</li> <li>Proxool \u662fsourceforge\u4e0b\u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76ee\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u6709\u76d1\u63a7\u8fde\u63a5\u6c60\u72b6\u6001\u7684\u529f\u80fd\uff0c\u7a33\u5b9a\u6027\u8f83c3p0\u5dee\u4e00\u70b9</li> <li>BoneCP \u662f\u4e00\u4e2a\u5f00\u6e90\u7ec4\u7ec7\u63d0\u4f9b\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u901f\u5ea6\u5feb</li> <li>Druid \u662f\u963f\u91cc\u63d0\u4f9b\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u636e\u8bf4\u662f\u96c6DBCP \u3001C3P0 \u3001Proxool \u4f18\u70b9\u4e8e\u4e00\u8eab\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff0c\u4f46\u662f\u901f\u5ea6\u4e0d\u786e\u5b9a\u662f\u5426\u6709BoneCP\u5feb</li> <li>DataSource \u901a\u5e38\u88ab\u79f0\u4e3a\u6570\u636e\u6e90\uff0c\u5b83\u5305\u542b\u8fde\u63a5\u6c60\u548c\u8fde\u63a5\u6c60\u7ba1\u7406\u4e24\u4e2a\u90e8\u5206\uff0c\u4e60\u60ef\u4e0a\u4e5f\u7ecf\u5e38\u628a DataSource \u79f0\u4e3a\u8fde\u63a5\u6c60</li> <li>DataSource\u7528\u6765\u53d6\u4ee3DriverManager\u6765\u83b7\u53d6Connection\uff0c\u83b7\u53d6\u901f\u5ea6\u5feb\uff0c\u540c\u65f6\u53ef\u4ee5\u5927\u5e45\u5ea6\u63d0\u9ad8\u6570\u636e\u5e93\u8bbf\u95ee\u901f\u5ea6\u3002</li> <li>\u7279\u522b\u6ce8\u610f\uff1a</li> <li>\u6570\u636e\u6e90\u548c\u6570\u636e\u5e93\u8fde\u63a5\u4e0d\u540c\uff0c\u6570\u636e\u6e90\u65e0\u9700\u521b\u5efa\u591a\u4e2a\uff0c\u5b83\u662f\u4ea7\u751f\u6570\u636e\u5e93\u8fde\u63a5\u7684\u5de5\u5382\uff0c\u56e0\u6b64\u6574\u4e2a\u5e94\u7528\u53ea\u9700\u8981\u4e00\u4e2a\u6570\u636e\u6e90\u5373\u53ef\u3002</li> <li>\u5f53\u6570\u636e\u5e93\u8bbf\u95ee\u7ed3\u675f\u540e\uff0c\u7a0b\u5e8f\u8fd8\u662f\u50cf\u4ee5\u524d\u4e00\u6837\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\uff1aconn.close(); \u4f46conn.close()\u5e76\u6ca1\u6709\u5173\u95ed\u6570\u636e\u5e93\u7684\u7269\u7406\u8fde\u63a5\uff0c\u5b83\u4ec5\u4ec5\u628a\u6570\u636e\u5e93\u8fde\u63a5\u91ca\u653e\uff0c\u5f52\u8fd8\u7ed9\u4e86\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#831-c3p0","title":"8.3.1 C3P0\u6570\u636e\u5e93\u8fde\u63a5\u6c60","text":"<ul> <li>\u83b7\u53d6\u8fde\u63a5\u65b9\u5f0f\u4e00</li> </ul> <pre><code>//\u4f7f\u7528C3P0\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u65b9\u5f0f\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff1a\u4e0d\u63a8\u8350\npublic static Connection getConnection1() throws Exception{\n    ComboPooledDataSource cpds = new ComboPooledDataSource();\n    cpds.setDriverClass(\"com.mysql.jdbc.Driver\"); \n    cpds.setJdbcUrl(\"jdbc:mysql://localhost:3306/test\");\n    cpds.setUser(\"root\");\n    cpds.setPassword(\"abc123\");\n\n//  cpds.setMaxPoolSize(100);\n\n    Connection conn = cpds.getConnection();\n    return conn;\n}\n</code></pre> <ul> <li>\u83b7\u53d6\u8fde\u63a5\u65b9\u5f0f\u4e8c</li> </ul> <pre><code>//\u4f7f\u7528C3P0\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff1a\u63a8\u8350\nprivate static DataSource cpds = new ComboPooledDataSource(\"helloc3p0\");\npublic static Connection getConnection2() throws SQLException{\n    Connection conn = cpds.getConnection();\n    return conn;\n}\n</code></pre> <p>\u5176\u4e2d\uff0csrc\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u4e3a\uff1a\u3010c3p0-config.xml\u3011</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;c3p0-config&gt;\n    &lt;named-config name=\"helloc3p0\"&gt;\n        &lt;!-- \u83b7\u53d6\u8fde\u63a5\u76844\u4e2a\u57fa\u672c\u4fe1\u606f --&gt;\n        &lt;property name=\"user\"&gt;root&lt;/property&gt;\n        &lt;property name=\"password\"&gt;abc123&lt;/property&gt;\n        &lt;property name=\"jdbcUrl\"&gt;jdbc:mysql:///test&lt;/property&gt;\n        &lt;property name=\"driverClass\"&gt;com.mysql.jdbc.Driver&lt;/property&gt;\n\n        &lt;!-- \u6d89\u53ca\u5230\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u7ba1\u7406\u7684\u76f8\u5173\u5c5e\u6027\u7684\u8bbe\u7f6e --&gt;\n        &lt;!-- \u82e5\u6570\u636e\u5e93\u4e2d\u8fde\u63a5\u6570\u4e0d\u8db3\u65f6, \u4e00\u6b21\u5411\u6570\u636e\u5e93\u670d\u52a1\u5668\u7533\u8bf7\u591a\u5c11\u4e2a\u8fde\u63a5 --&gt;\n        &lt;property name=\"acquireIncrement\"&gt;5&lt;/property&gt;\n        &lt;!-- \u521d\u59cb\u5316\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u65f6\u8fde\u63a5\u7684\u6570\u91cf --&gt;\n        &lt;property name=\"initialPoolSize\"&gt;5&lt;/property&gt;\n        &lt;!-- \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4e2d\u7684\u6700\u5c0f\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6570 --&gt;\n        &lt;property name=\"minPoolSize\"&gt;5&lt;/property&gt;\n        &lt;!-- \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u4e2d\u7684\u6700\u5927\u7684\u6570\u636e\u5e93\u8fde\u63a5\u6570 --&gt;\n        &lt;property name=\"maxPoolSize\"&gt;10&lt;/property&gt;\n        &lt;!-- C3P0 \u6570\u636e\u5e93\u8fde\u63a5\u6c60\u53ef\u4ee5\u7ef4\u62a4\u7684 Statement \u7684\u4e2a\u6570 --&gt;\n        &lt;property name=\"maxStatements\"&gt;20&lt;/property&gt;\n        &lt;!-- \u6bcf\u4e2a\u8fde\u63a5\u540c\u65f6\u53ef\u4ee5\u4f7f\u7528\u7684 Statement \u5bf9\u8c61\u7684\u4e2a\u6570 --&gt;\n        &lt;property name=\"maxStatementsPerConnection\"&gt;5&lt;/property&gt;\n\n    &lt;/named-config&gt;\n&lt;/c3p0-config&gt;\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#832-dbcp","title":"8.3.2 DBCP\u6570\u636e\u5e93\u8fde\u63a5\u6c60","text":"<ul> <li>DBCP \u662f Apache \u8f6f\u4ef6\u57fa\u91d1\u7ec4\u7ec7\u4e0b\u7684\u5f00\u6e90\u8fde\u63a5\u6c60\u5b9e\u73b0\uff0c\u8be5\u8fde\u63a5\u6c60\u4f9d\u8d56\u8be5\u7ec4\u7ec7\u4e0b\u7684\u53e6\u4e00\u4e2a\u5f00\u6e90\u7cfb\u7edf\uff1aCommon-pool\u3002\u5982\u9700\u4f7f\u7528\u8be5\u8fde\u63a5\u6c60\u5b9e\u73b0\uff0c\u5e94\u5728\u7cfb\u7edf\u4e2d\u589e\u52a0\u5982\u4e0b\u4e24\u4e2a jar \u6587\u4ef6\uff1a</li> <li>Commons-dbcp.jar\uff1a\u8fde\u63a5\u6c60\u7684\u5b9e\u73b0</li> <li>Commons-pool.jar\uff1a\u8fde\u63a5\u6c60\u5b9e\u73b0\u7684\u4f9d\u8d56\u5e93</li> <li>Tomcat \u7684\u8fde\u63a5\u6c60\u6b63\u662f\u91c7\u7528\u8be5\u8fde\u63a5\u6c60\u6765\u5b9e\u73b0\u7684\u3002\u8be5\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u65e2\u53ef\u4ee5\u4e0e\u5e94\u7528\u670d\u52a1\u5668\u6574\u5408\u4f7f\u7528\uff0c\u4e5f\u53ef\u7531\u5e94\u7528\u7a0b\u5e8f\u72ec\u7acb\u4f7f\u7528\u3002</li> <li>\u6570\u636e\u6e90\u548c\u6570\u636e\u5e93\u8fde\u63a5\u4e0d\u540c\uff0c\u6570\u636e\u6e90\u65e0\u9700\u521b\u5efa\u591a\u4e2a\uff0c\u5b83\u662f\u4ea7\u751f\u6570\u636e\u5e93\u8fde\u63a5\u7684\u5de5\u5382\uff0c\u56e0\u6b64\u6574\u4e2a\u5e94\u7528\u53ea\u9700\u8981\u4e00\u4e2a\u6570\u636e\u6e90\u5373\u53ef\u3002</li> <li>\u5f53\u6570\u636e\u5e93\u8bbf\u95ee\u7ed3\u675f\u540e\uff0c\u7a0b\u5e8f\u8fd8\u662f\u50cf\u4ee5\u524d\u4e00\u6837\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\uff1aconn.close(); \u4f46\u4e0a\u9762\u7684\u4ee3\u7801\u5e76\u6ca1\u6709\u5173\u95ed\u6570\u636e\u5e93\u7684\u7269\u7406\u8fde\u63a5\uff0c\u5b83\u4ec5\u4ec5\u628a\u6570\u636e\u5e93\u8fde\u63a5\u91ca\u653e\uff0c\u5f52\u8fd8\u7ed9\u4e86\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u3002</li> <li>\u914d\u7f6e\u5c5e\u6027\u8bf4\u660e</li> </ul> \u5c5e\u6027 \u9ed8\u8ba4\u503c \u8bf4\u660e initialSize 0 \u8fde\u63a5\u6c60\u542f\u52a8\u65f6\u521b\u5efa\u7684\u521d\u59cb\u5316\u8fde\u63a5\u6570\u91cf maxActive 8 \u8fde\u63a5\u6c60\u4e2d\u53ef\u540c\u65f6\u8fde\u63a5\u7684\u6700\u5927\u7684\u8fde\u63a5\u6570 maxIdle 8 \u8fde\u63a5\u6c60\u4e2d\u6700\u5927\u7684\u7a7a\u95f2\u7684\u8fde\u63a5\u6570\uff0c\u8d85\u8fc7\u7684\u7a7a\u95f2\u8fde\u63a5\u5c06\u88ab\u91ca\u653e\uff0c\u5982\u679c\u8bbe\u7f6e\u4e3a\u8d1f\u6570\u8868\u793a\u4e0d\u9650\u5236 minIdle 0 \u8fde\u63a5\u6c60\u4e2d\u6700\u5c0f\u7684\u7a7a\u95f2\u7684\u8fde\u63a5\u6570\uff0c\u4f4e\u4e8e\u8fd9\u4e2a\u6570\u91cf\u4f1a\u88ab\u521b\u5efa\u65b0\u7684\u8fde\u63a5\u3002\u8be5\u53c2\u6570\u8d8a\u63a5\u8fd1maxIdle\uff0c\u6027\u80fd\u8d8a\u597d\uff0c\u56e0\u4e3a\u8fde\u63a5\u7684\u521b\u5efa\u548c\u9500\u6bc1\uff0c\u90fd\u662f\u9700\u8981\u6d88\u8017\u8d44\u6e90\u7684\uff1b\u4f46\u662f\u4e0d\u80fd\u592a\u5927\u3002 maxWait \u65e0\u9650\u5236 \u6700\u5927\u7b49\u5f85\u65f6\u95f4\uff0c\u5f53\u6ca1\u6709\u53ef\u7528\u8fde\u63a5\u65f6\uff0c\u8fde\u63a5\u6c60\u7b49\u5f85\u8fde\u63a5\u91ca\u653e\u7684\u6700\u5927\u65f6\u95f4\uff0c\u8d85\u8fc7\u8be5\u65f6\u95f4\u9650\u5236\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u5982\u679c\u8bbe\u7f6e-1\u8868\u793a\u65e0\u9650\u7b49\u5f85 poolPreparedStatements false \u5f00\u542f\u6c60\u7684Statement\u662f\u5426prepared maxOpenPreparedStatements \u65e0\u9650\u5236 \u5f00\u542f\u6c60\u7684prepared \u540e\u7684\u540c\u65f6\u6700\u5927\u8fde\u63a5\u6570 minEvictableIdleTimeMillis \u8fde\u63a5\u6c60\u4e2d\u8fde\u63a5\uff0c\u5728\u65f6\u95f4\u6bb5\u5185\u4e00\u76f4\u7a7a\u95f2\uff0c \u88ab\u9010\u51fa\u8fde\u63a5\u6c60\u7684\u65f6\u95f4 removeAbandonedTimeout 300 \u8d85\u8fc7\u65f6\u95f4\u9650\u5236\uff0c\u56de\u6536\u6ca1\u6709\u7528(\u5e9f\u5f03)\u7684\u8fde\u63a5 removeAbandoned false \u8d85\u8fc7removeAbandonedTimeout\u65f6\u95f4\u540e\uff0c\u662f\u5426\u8fdb \u884c\u6ca1\u7528\u8fde\u63a5\uff08\u5e9f\u5f03\uff09\u7684\u56de\u6536 <ul> <li>\u83b7\u53d6\u8fde\u63a5\u65b9\u5f0f\u4e00\uff1a</li> </ul> <pre><code>public static Connection getConnection3() throws Exception {\n    BasicDataSource source = new BasicDataSource();\n\n    source.setDriverClassName(\"com.mysql.jdbc.Driver\");\n    source.setUrl(\"jdbc:mysql:///test\");\n    source.setUsername(\"root\");\n    source.setPassword(\"abc123\");\n\n    //\n    source.setInitialSize(10);\n\n    Connection conn = source.getConnection();\n    return conn;\n}\n</code></pre> <ul> <li>\u83b7\u53d6\u8fde\u63a5\u65b9\u5f0f\u4e8c\uff1a</li> </ul> <pre><code>//\u4f7f\u7528dbcp\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u7684\u914d\u7f6e\u6587\u4ef6\u65b9\u5f0f\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u7684\u8fde\u63a5\uff1a\u63a8\u8350\nprivate static DataSource source = null;\nstatic{\n    try {\n        Properties pros = new Properties();\n\n        InputStream is = DBCPTest.class.getClassLoader().getResourceAsStream(\"dbcp.properties\");\n\n        pros.load(is);\n        //\u6839\u636e\u63d0\u4f9b\u7684BasicDataSourceFactory\u521b\u5efa\u5bf9\u5e94\u7684DataSource\u5bf9\u8c61\n        source = BasicDataSourceFactory.createDataSource(pros);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n\n}\npublic static Connection getConnection4() throws Exception {\n\n    Connection conn = source.getConnection();\n\n    return conn;\n}\n</code></pre> <p>\u5176\u4e2d\uff0csrc\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u4e3a\uff1a\u3010dbcp.properties\u3011</p> <pre><code>driverClassName=com.mysql.jdbc.Driver\nurl=jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true&amp;useServerPrepStmts=false\nusername=root\npassword=abc123\n\ninitialSize=10\n#...\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#833-druid","title":"8.3.3 Druid\uff08\u5fb7\u9c81\u4f0a\uff09\u6570\u636e\u5e93\u8fde\u63a5\u6c60","text":"<p>Druid\u662f\u963f\u91cc\u5df4\u5df4\u5f00\u6e90\u5e73\u53f0\u4e0a\u4e00\u4e2a\u6570\u636e\u5e93\u8fde\u63a5\u6c60\u5b9e\u73b0\uff0c\u5b83\u7ed3\u5408\u4e86C3P0\u3001DBCP\u3001Proxool\u7b49DB\u6c60\u7684\u4f18\u70b9\uff0c\u540c\u65f6\u52a0\u5165\u4e86\u65e5\u5fd7\u76d1\u63a7\uff0c\u53ef\u4ee5\u5f88\u597d\u7684\u76d1\u63a7DB\u6c60\u8fde\u63a5\u548cSQL\u7684\u6267\u884c\u60c5\u51b5\uff0c\u53ef\u4ee5\u8bf4\u662f\u9488\u5bf9\u76d1\u63a7\u800c\u751f\u7684DB\u8fde\u63a5\u6c60\uff0c\u53ef\u4ee5\u8bf4\u662f\u76ee\u524d\u6700\u597d\u7684\u8fde\u63a5\u6c60\u4e4b\u4e00\u3002</p> <pre><code>package com.atguigu.druid;\n\nimport java.sql.Connection;\nimport java.util.Properties;\n\nimport javax.sql.DataSource;\n\nimport com.alibaba.druid.pool.DruidDataSourceFactory;\n\npublic class TestDruid {\n    public static void main(String[] args) throws Exception {\n        Properties pro = new Properties();       pro.load(TestDruid.class.getClassLoader().getResourceAsStream(\"druid.properties\"));\n        DataSource ds = DruidDataSourceFactory.createDataSource(pro);\n        Connection conn = ds.getConnection();\n        System.out.println(conn);\n    }\n}\n</code></pre> <p>\u5176\u4e2d\uff0csrc\u4e0b\u7684\u914d\u7f6e\u6587\u4ef6\u4e3a\uff1a\u3010druid.properties\u3011</p> <pre><code>url=jdbc:mysql://localhost:3306/test?rewriteBatchedStatements=true\nusername=root\npassword=123456\ndriverClassName=com.mysql.jdbc.Driver\n\ninitialSize=10\nmaxActive=20\nmaxWait=1000\nfilters=wall\n</code></pre> <ul> <li>\u8be6\u7ec6\u914d\u7f6e\u53c2\u6570\uff1a</li> </ul> \u914d\u7f6e \u7f3a\u7701 \u8bf4\u660e name \u914d\u7f6e\u8fd9\u4e2a\u5c5e\u6027\u7684\u610f\u4e49\u5728\u4e8e\uff0c\u5982\u679c\u5b58\u5728\u591a\u4e2a\u6570\u636e\u6e90\uff0c\u76d1\u63a7\u7684\u65f6\u5019\u53ef\u4ee5\u901a\u8fc7\u540d\u5b57\u6765\u533a\u5206\u5f00\u6765\u3002   \u5982\u679c\u6ca1\u6709\u914d\u7f6e\uff0c\u5c06\u4f1a\u751f\u6210\u4e00\u4e2a\u540d\u5b57\uff0c\u683c\u5f0f\u662f\uff1a\u201dDataSource-\u201d +   System.identityHashCode(this) url \u8fde\u63a5\u6570\u636e\u5e93\u7684url\uff0c\u4e0d\u540c\u6570\u636e\u5e93\u4e0d\u4e00\u6837\u3002\u4f8b\u5982\uff1amysql :   jdbc:mysql://10.20.153.104:3306/druid2      oracle :   jdbc:oracle:thin:@10.20.149.85:1521:ocnauto username \u8fde\u63a5\u6570\u636e\u5e93\u7684\u7528\u6237\u540d password \u8fde\u63a5\u6570\u636e\u5e93\u7684\u5bc6\u7801\u3002\u5982\u679c\u4f60\u4e0d\u5e0c\u671b\u5bc6\u7801\u76f4\u63a5\u5199\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528ConfigFilter\u3002\u8be6\u7ec6\u770b\u8fd9\u91cc\uff1ahttps://github.com/alibaba/druid/wiki/%E4%BD%BF%E7%94%A8ConfigFilter driverClassName \u6839\u636eurl\u81ea\u52a8\u8bc6\u522b   \u8fd9\u4e00\u9879\u53ef\u914d\u53ef\u4e0d\u914d\uff0c\u5982\u679c\u4e0d\u914d\u7f6edruid\u4f1a\u6839\u636eurl\u81ea\u52a8\u8bc6\u522bdbType\uff0c\u7136\u540e\u9009\u62e9\u76f8\u5e94\u7684driverClassName(\u5efa\u8bae\u914d\u7f6e\u4e0b) initialSize 0 \u521d\u59cb\u5316\u65f6\u5efa\u7acb\u7269\u7406\u8fde\u63a5\u7684\u4e2a\u6570\u3002\u521d\u59cb\u5316\u53d1\u751f\u5728\u663e\u793a\u8c03\u7528init\u65b9\u6cd5\uff0c\u6216\u8005\u7b2c\u4e00\u6b21getConnection\u65f6 maxActive 8 \u6700\u5927\u8fde\u63a5\u6c60\u6570\u91cf maxIdle 8 \u5df2\u7ecf\u4e0d\u518d\u4f7f\u7528\uff0c\u914d\u7f6e\u4e86\u4e5f\u6ca1\u6548\u679c minIdle \u6700\u5c0f\u8fde\u63a5\u6c60\u6570\u91cf maxWait \u83b7\u53d6\u8fde\u63a5\u65f6\u6700\u5927\u7b49\u5f85\u65f6\u95f4\uff0c\u5355\u4f4d\u6beb\u79d2\u3002\u914d\u7f6e\u4e86maxWait\u4e4b\u540e\uff0c\u7f3a\u7701\u542f\u7528\u516c\u5e73\u9501\uff0c\u5e76\u53d1\u6548\u7387\u4f1a\u6709\u6240\u4e0b\u964d\uff0c\u5982\u679c\u9700\u8981\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6euseUnfairLock\u5c5e\u6027\u4e3atrue\u4f7f\u7528\u975e\u516c\u5e73\u9501\u3002 poolPreparedStatements false \u662f\u5426\u7f13\u5b58preparedStatement\uff0c\u4e5f\u5c31\u662fPSCache\u3002PSCache\u5bf9\u652f\u6301\u6e38\u6807\u7684\u6570\u636e\u5e93\u6027\u80fd\u63d0\u5347\u5de8\u5927\uff0c\u6bd4\u5982\u8bf4oracle\u3002\u5728mysql\u4e0b\u5efa\u8bae\u5173\u95ed\u3002 maxOpenPreparedStatements -1 \u8981\u542f\u7528PSCache\uff0c\u5fc5\u987b\u914d\u7f6e\u5927\u4e8e0\uff0c\u5f53\u5927\u4e8e0\u65f6\uff0cpoolPreparedStatements\u81ea\u52a8\u89e6\u53d1\u4fee\u6539\u4e3atrue\u3002\u5728Druid\u4e2d\uff0c\u4e0d\u4f1a\u5b58\u5728Oracle\u4e0bPSCache\u5360\u7528\u5185\u5b58\u8fc7\u591a\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e2a\u6570\u503c\u914d\u7f6e\u5927\u4e00\u4e9b\uff0c\u6bd4\u5982\u8bf4100 validationQuery \u7528\u6765\u68c0\u6d4b\u8fde\u63a5\u662f\u5426\u6709\u6548\u7684sql\uff0c\u8981\u6c42\u662f\u4e00\u4e2a\u67e5\u8be2\u8bed\u53e5\u3002\u5982\u679cvalidationQuery\u4e3anull\uff0ctestOnBorrow\u3001testOnReturn\u3001testWhileIdle\u90fd\u4e0d\u4f1a\u5176\u4f5c\u7528\u3002 testOnBorrow true \u7533\u8bf7\u8fde\u63a5\u65f6\u6267\u884cvalidationQuery\u68c0\u6d4b\u8fde\u63a5\u662f\u5426\u6709\u6548\uff0c\u505a\u4e86\u8fd9\u4e2a\u914d\u7f6e\u4f1a\u964d\u4f4e\u6027\u80fd\u3002 testOnReturn false \u5f52\u8fd8\u8fde\u63a5\u65f6\u6267\u884cvalidationQuery\u68c0\u6d4b\u8fde\u63a5\u662f\u5426\u6709\u6548\uff0c\u505a\u4e86\u8fd9\u4e2a\u914d\u7f6e\u4f1a\u964d\u4f4e\u6027\u80fd testWhileIdle false \u5efa\u8bae\u914d\u7f6e\u4e3atrue\uff0c\u4e0d\u5f71\u54cd\u6027\u80fd\uff0c\u5e76\u4e14\u4fdd\u8bc1\u5b89\u5168\u6027\u3002\u7533\u8bf7\u8fde\u63a5\u7684\u65f6\u5019\u68c0\u6d4b\uff0c\u5982\u679c\u7a7a\u95f2\u65f6\u95f4\u5927\u4e8etimeBetweenEvictionRunsMillis\uff0c\u6267\u884cvalidationQuery\u68c0\u6d4b\u8fde\u63a5\u662f\u5426\u6709\u6548\u3002 timeBetweenEvictionRunsMillis \u6709\u4e24\u4e2a\u542b\u4e49\uff1a 1)Destroy\u7ebf\u7a0b\u4f1a\u68c0\u6d4b\u8fde\u63a5\u7684\u95f4\u9694\u65f6\u95f42)testWhileIdle\u7684\u5224\u65ad\u4f9d\u636e\uff0c\u8be6\u7ec6\u770btestWhileIdle\u5c5e\u6027\u7684\u8bf4\u660e numTestsPerEvictionRun \u4e0d\u518d\u4f7f\u7528\uff0c\u4e00\u4e2aDruidDataSource\u53ea\u652f\u6301\u4e00\u4e2aEvictionRun minEvictableIdleTimeMillis connectionInitSqls \u7269\u7406\u8fde\u63a5\u521d\u59cb\u5316\u7684\u65f6\u5019\u6267\u884c\u7684sql exceptionSorter \u6839\u636edbType\u81ea\u52a8\u8bc6\u522b   \u5f53\u6570\u636e\u5e93\u629b\u51fa\u4e00\u4e9b\u4e0d\u53ef\u6062\u590d\u7684\u5f02\u5e38\u65f6\uff0c\u629b\u5f03\u8fde\u63a5 filters \u5c5e\u6027\u7c7b\u578b\u662f\u5b57\u7b26\u4e32\uff0c\u901a\u8fc7\u522b\u540d\u7684\u65b9\u5f0f\u914d\u7f6e\u6269\u5c55\u63d2\u4ef6\uff0c\u5e38\u7528\u7684\u63d2\u4ef6\u6709\uff1a   \u76d1\u63a7\u7edf\u8ba1\u7528\u7684filter:stat\u65e5\u5fd7\u7528\u7684filter:log4j\u9632\u5fa1sql\u6ce8\u5165\u7684filter:wall proxyFilters \u7c7b\u578b\u662fList\uff0c\u5982\u679c\u540c\u65f6\u914d\u7f6e\u4e86filters\u548cproxyFilters\uff0c\u662f\u7ec4\u5408\u5173\u7cfb\uff0c\u5e76\u975e\u66ff\u6362\u5173\u7cfb"},{"location":"programming/java/JDBC/JDBC/#9apache-dbutilscrud","title":"\u7b2c9\u7ae0\uff1aApache-DBUtils\u5b9e\u73b0CRUD\u64cd\u4f5c","text":""},{"location":"programming/java/JDBC/JDBC/#91-apache-dbutils","title":"9.1 Apache-DBUtils\u7b80\u4ecb","text":"<ul> <li> <p>commons-dbutils \u662f Apache \u7ec4\u7ec7\u63d0\u4f9b\u7684\u4e00\u4e2a\u5f00\u6e90 JDBC\u5de5\u5177\u7c7b\u5e93\uff0c\u5b83\u662f\u5bf9JDBC\u7684\u7b80\u5355\u5c01\u88c5\uff0c\u5b66\u4e60\u6210\u672c\u6781\u4f4e\uff0c\u5e76\u4e14\u4f7f\u7528dbutils\u80fd\u6781\u5927\u7b80\u5316jdbc\u7f16\u7801\u7684\u5de5\u4f5c\u91cf\uff0c\u540c\u65f6\u4e5f\u4e0d\u4f1a\u5f71\u54cd\u7a0b\u5e8f\u7684\u6027\u80fd\u3002</p> </li> <li> <p>API\u4ecb\u7ecd\uff1a</p> </li> <li>org.apache.commons.dbutils.QueryRunner</li> <li>org.apache.commons.dbutils.ResultSetHandler</li> <li>\u5de5\u5177\u7c7b\uff1aorg.apache.commons.dbutils.DbUtils   </li> <li>API\u5305\u8bf4\u660e\uff1a</li> </ul> <p></p> <p></p>"},{"location":"programming/java/JDBC/JDBC/#92-api","title":"9.2 \u4e3b\u8981API\u7684\u4f7f\u7528","text":""},{"location":"programming/java/JDBC/JDBC/#921-dbutils","title":"9.2.1 DbUtils","text":"<ul> <li>DbUtils \uff1a\u63d0\u4f9b\u5982\u5173\u95ed\u8fde\u63a5\u3001\u88c5\u8f7dJDBC\u9a71\u52a8\u7a0b\u5e8f\u7b49\u5e38\u89c4\u5de5\u4f5c\u7684\u5de5\u5177\u7c7b\uff0c\u91cc\u9762\u7684\u6240\u6709\u65b9\u6cd5\u90fd\u662f\u9759\u6001\u7684\u3002\u4e3b\u8981\u65b9\u6cd5\u5982\u4e0b\uff1a</li> <li>public static void close(\u2026) throws java.sql.SQLException\uff1a\u3000DbUtils\u7c7b\u63d0\u4f9b\u4e86\u4e09\u4e2a\u91cd\u8f7d\u7684\u5173\u95ed\u65b9\u6cd5\u3002\u8fd9\u4e9b\u65b9\u6cd5\u68c0\u67e5\u6240\u63d0\u4f9b\u7684\u53c2\u6570\u662f\u4e0d\u662fNULL\uff0c\u5982\u679c\u4e0d\u662f\u7684\u8bdd\uff0c\u5b83\u4eec\u5c31\u5173\u95edConnection\u3001Statement\u548cResultSet\u3002</li> <li>public static void closeQuietly(\u2026): \u8fd9\u4e00\u7c7b\u65b9\u6cd5\u4e0d\u4ec5\u80fd\u5728Connection\u3001Statement\u548cResultSet\u4e3aNULL\u60c5\u51b5\u4e0b\u907f\u514d\u5173\u95ed\uff0c\u8fd8\u80fd\u9690\u85cf\u4e00\u4e9b\u5728\u7a0b\u5e8f\u4e2d\u629b\u51fa\u7684SQLEeception\u3002</li> <li>public static void commitAndClose(Connection conn)throws SQLException\uff1a \u7528\u6765\u63d0\u4ea4\u8fde\u63a5\u7684\u4e8b\u52a1\uff0c\u7136\u540e\u5173\u95ed\u8fde\u63a5</li> <li>public static void commitAndCloseQuietly(Connection conn)\uff1a \u7528\u6765\u63d0\u4ea4\u8fde\u63a5\uff0c\u7136\u540e\u5173\u95ed\u8fde\u63a5\uff0c\u5e76\u4e14\u5728\u5173\u95ed\u8fde\u63a5\u65f6\u4e0d\u629b\u51faSQL\u5f02\u5e38\u3002 </li> <li>public static void rollback(Connection conn)throws SQLException\uff1a\u5141\u8bb8conn\u4e3anull\uff0c\u56e0\u4e3a\u65b9\u6cd5\u5185\u90e8\u505a\u4e86\u5224\u65ad</li> <li>public static void rollbackAndClose(Connection conn)throws SQLException</li> <li>rollbackAndCloseQuietly(Connection)</li> <li>public static boolean loadDriver(java.lang.String driverClassName)\uff1a\u8fd9\u4e00\u65b9\u88c5\u8f7d\u5e76\u6ce8\u518cJDBC\u9a71\u52a8\u7a0b\u5e8f\uff0c\u5982\u679c\u6210\u529f\u5c31\u8fd4\u56detrue\u3002\u4f7f\u7528\u8be5\u65b9\u6cd5\uff0c\u4f60\u4e0d\u9700\u8981\u6355\u6349\u8fd9\u4e2a\u5f02\u5e38ClassNotFoundException\u3002</li> </ul>"},{"location":"programming/java/JDBC/JDBC/#922-queryrunner","title":"9.2.2 QueryRunner\u7c7b","text":"<ul> <li> <p>\u8be5\u7c7b\u7b80\u5355\u5316\u4e86SQL\u67e5\u8be2\uff0c\u5b83\u4e0eResultSetHandler\u7ec4\u5408\u5728\u4e00\u8d77\u4f7f\u7528\u53ef\u4ee5\u5b8c\u6210\u5927\u90e8\u5206\u7684\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u80fd\u591f\u5927\u5927\u51cf\u5c11\u7f16\u7801\u91cf\u3002</p> </li> <li> <p>QueryRunner\u7c7b\u63d0\u4f9b\u4e86\u4e24\u4e2a\u6784\u9020\u5668\uff1a</p> </li> <li>\u9ed8\u8ba4\u7684\u6784\u9020\u5668</li> <li> <p>\u9700\u8981\u4e00\u4e2a javax.sql.DataSource \u6765\u4f5c\u53c2\u6570\u7684\u6784\u9020\u5668</p> </li> <li> <p>QueryRunner\u7c7b\u7684\u4e3b\u8981\u65b9\u6cd5\uff1a</p> </li> <li>\u66f4\u65b0<ul> <li>public int update(Connection conn, String sql, Object... params) throws SQLException:\u7528\u6765\u6267\u884c\u4e00\u4e2a\u66f4\u65b0\uff08\u63d2\u5165\u3001\u66f4\u65b0\u6216\u5220\u9664\uff09\u64cd\u4f5c\u3002</li> <li>......</li> </ul> </li> <li>\u63d2\u5165<ul> <li>public  T insert(Connection conn,String sql,ResultSetHandler rsh, Object... params) throws SQLException\uff1a\u53ea\u652f\u6301INSERT\u8bed\u53e5\uff0c\u5176\u4e2d rsh - The handler used to create the result object from the ResultSet of auto-generated keys.  \u8fd4\u56de\u503c: An object generated by the handler.\u5373\u81ea\u52a8\u751f\u6210\u7684\u952e\u503c <li>....</li> <li>\u6279\u5904\u7406<ul> <li>public int[] batch(Connection conn,String sql,Object[][] params)throws SQLException\uff1a INSERT, UPDATE, or DELETE\u8bed\u53e5</li> <li>public  T insertBatch(Connection conn,String sql,ResultSetHandler rsh,Object[][] params)throws SQLException\uff1a\u53ea\u652f\u6301INSERT\u8bed\u53e5 <li>.....</li> <li> <p>\u67e5\u8be2</p> <ul> <li>public Object query(Connection conn, String sql, ResultSetHandler rsh,Object... params) throws SQLException\uff1a\u6267\u884c\u4e00\u4e2a\u67e5\u8be2\u64cd\u4f5c\uff0c\u5728\u8fd9\u4e2a\u67e5\u8be2\u4e2d\uff0c\u5bf9\u8c61\u6570\u7ec4\u4e2d\u7684\u6bcf\u4e2a\u5143\u7d20\u503c\u88ab\u7528\u6765\u4f5c\u4e3a\u67e5\u8be2\u8bed\u53e5\u7684\u7f6e\u6362\u53c2\u6570\u3002\u8be5\u65b9\u6cd5\u4f1a\u81ea\u884c\u5904\u7406 PreparedStatement \u548c ResultSet \u7684\u521b\u5efa\u548c\u5173\u95ed\u3002</li> <li>...... </li> </ul> </li> <li> <p>\u6d4b\u8bd5</p> </li> <pre><code>// \u6d4b\u8bd5\u6dfb\u52a0\n@Test\npublic void testInsert() throws Exception {\n    QueryRunner runner = new QueryRunner();\n    Connection conn = JDBCUtils.getConnection3();\n    String sql = \"insert into customers(name,email,birth)values(?,?,?)\";\n    int count = runner.update(conn, sql, \"\u4f55\u6210\u98de\", \"he@qq.com\", \"1992-09-08\");\n\n    System.out.println(\"\u6dfb\u52a0\u4e86\" + count + \"\u6761\u8bb0\u5f55\");\n\n    JDBCUtils.closeResource(conn, null);\n\n}\n</code></pre> <pre><code>// \u6d4b\u8bd5\u5220\u9664\n@Test\npublic void testDelete() throws Exception {\n    QueryRunner runner = new QueryRunner();\n    Connection conn = JDBCUtils.getConnection3();\n    String sql = \"delete from customers where id &lt; ?\";\n    int count = runner.update(conn, sql,3);\n\n    System.out.println(\"\u5220\u9664\u4e86\" + count + \"\u6761\u8bb0\u5f55\");\n\n    JDBCUtils.closeResource(conn, null);\n\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#923-resultsethandler","title":"9.2.3 ResultSetHandler\u63a5\u53e3\u53ca\u5b9e\u73b0\u7c7b","text":"<ul> <li> <p>\u8be5\u63a5\u53e3\u7528\u4e8e\u5904\u7406 java.sql.ResultSet\uff0c\u5c06\u6570\u636e\u6309\u8981\u6c42\u8f6c\u6362\u4e3a\u53e6\u4e00\u79cd\u5f62\u5f0f\u3002</p> </li> <li> <p>ResultSetHandler \u63a5\u53e3\u63d0\u4f9b\u4e86\u4e00\u4e2a\u5355\u72ec\u7684\u65b9\u6cd5\uff1aObject handle (java.sql.ResultSet .rs)\u3002</p> </li> <li> <p>\u63a5\u53e3\u7684\u4e3b\u8981\u5b9e\u73b0\u7c7b\uff1a</p> </li> <li> <p>ArrayHandler\uff1a\u628a\u7ed3\u679c\u96c6\u4e2d\u7684\u7b2c\u4e00\u884c\u6570\u636e\u8f6c\u6210\u5bf9\u8c61\u6570\u7ec4\u3002</p> </li> <li>ArrayListHandler\uff1a\u628a\u7ed3\u679c\u96c6\u4e2d\u7684\u6bcf\u4e00\u884c\u6570\u636e\u90fd\u8f6c\u6210\u4e00\u4e2a\u6570\u7ec4\uff0c\u518d\u5b58\u653e\u5230List\u4e2d\u3002</li> <li>BeanHandler\uff1a\u5c06\u7ed3\u679c\u96c6\u4e2d\u7684\u7b2c\u4e00\u884c\u6570\u636e\u5c01\u88c5\u5230\u4e00\u4e2a\u5bf9\u5e94\u7684JavaBean\u5b9e\u4f8b\u4e2d\u3002</li> <li>BeanListHandler\uff1a\u5c06\u7ed3\u679c\u96c6\u4e2d\u7684\u6bcf\u4e00\u884c\u6570\u636e\u90fd\u5c01\u88c5\u5230\u4e00\u4e2a\u5bf9\u5e94\u7684JavaBean\u5b9e\u4f8b\u4e2d\uff0c\u5b58\u653e\u5230List\u91cc\u3002</li> <li>ColumnListHandler\uff1a\u5c06\u7ed3\u679c\u96c6\u4e2d\u67d0\u4e00\u5217\u7684\u6570\u636e\u5b58\u653e\u5230List\u4e2d\u3002</li> <li>KeyedHandler(name)\uff1a\u5c06\u7ed3\u679c\u96c6\u4e2d\u7684\u6bcf\u4e00\u884c\u6570\u636e\u90fd\u5c01\u88c5\u5230\u4e00\u4e2aMap\u91cc\uff0c\u518d\u628a\u8fd9\u4e9bmap\u518d\u5b58\u5230\u4e00\u4e2amap\u91cc\uff0c\u5176key\u4e3a\u6307\u5b9a\u7684key\u3002</li> <li>MapHandler\uff1a\u5c06\u7ed3\u679c\u96c6\u4e2d\u7684\u7b2c\u4e00\u884c\u6570\u636e\u5c01\u88c5\u5230\u4e00\u4e2aMap\u91cc\uff0ckey\u662f\u5217\u540d\uff0cvalue\u5c31\u662f\u5bf9\u5e94\u7684\u503c\u3002</li> <li>MapListHandler\uff1a\u5c06\u7ed3\u679c\u96c6\u4e2d\u7684\u6bcf\u4e00\u884c\u6570\u636e\u90fd\u5c01\u88c5\u5230\u4e00\u4e2aMap\u91cc\uff0c\u7136\u540e\u518d\u5b58\u653e\u5230List</li> <li> <p>ScalarHandler\uff1a\u67e5\u8be2\u5355\u4e2a\u503c\u5bf9\u8c61</p> </li> <li> <p>\u6d4b\u8bd5</p> </li> </ul> <pre><code>/*\n * \u6d4b\u8bd5\u67e5\u8be2:\u67e5\u8be2\u4e00\u6761\u8bb0\u5f55\n * \n * \u4f7f\u7528ResultSetHandler\u7684\u5b9e\u73b0\u7c7b\uff1aBeanHandler\n */\n@Test\npublic void testQueryInstance() throws Exception{\n    QueryRunner runner = new QueryRunner();\n\n    Connection conn = JDBCUtils.getConnection3();\n\n    String sql = \"select id,name,email,birth from customers where id = ?\";\n\n    //\n    BeanHandler&lt;Customer&gt; handler = new BeanHandler&lt;&gt;(Customer.class);\n    Customer customer = runner.query(conn, sql, handler, 23);\n    System.out.println(customer);   \n    JDBCUtils.closeResource(conn, null);\n}\n</code></pre> <pre><code>/*\n * \u6d4b\u8bd5\u67e5\u8be2:\u67e5\u8be2\u591a\u6761\u8bb0\u5f55\u6784\u6210\u7684\u96c6\u5408\n * \n * \u4f7f\u7528ResultSetHandler\u7684\u5b9e\u73b0\u7c7b\uff1aBeanListHandler\n */\n@Test\npublic void testQueryList() throws Exception{\n    QueryRunner runner = new QueryRunner();\n\n    Connection conn = JDBCUtils.getConnection3();\n\n    String sql = \"select id,name,email,birth from customers where id &lt; ?\";\n\n    //\n    BeanListHandler&lt;Customer&gt; handler = new BeanListHandler&lt;&gt;(Customer.class);\n    List&lt;Customer&gt; list = runner.query(conn, sql, handler, 23);\n    list.forEach(System.out::println);\n\n    JDBCUtils.closeResource(conn, null);\n}\n</code></pre> <pre><code>/*\n * \u81ea\u5b9a\u4e49ResultSetHandler\u7684\u5b9e\u73b0\u7c7b\n */\n@Test\npublic void testQueryInstance1() throws Exception{\n    QueryRunner runner = new QueryRunner();\n\n    Connection conn = JDBCUtils.getConnection3();\n\n    String sql = \"select id,name,email,birth from customers where id = ?\";\n\n    ResultSetHandler&lt;Customer&gt; handler = new ResultSetHandler&lt;Customer&gt;() {\n\n        @Override\n        public Customer handle(ResultSet rs) throws SQLException {\n            System.out.println(\"handle\");\n//          return new Customer(1,\"Tom\",\"tom@126.com\",new Date(123323432L));\n\n            if(rs.next()){\n                int id = rs.getInt(\"id\");\n                String name = rs.getString(\"name\");\n                String email = rs.getString(\"email\");\n                Date birth = rs.getDate(\"birth\");\n\n                return new Customer(id, name, email, birth);\n            }\n            return null;\n\n        }\n    };\n\n    Customer customer = runner.query(conn, sql, handler, 23);\n\n    System.out.println(customer);\n\n    JDBCUtils.closeResource(conn, null);\n}\n</code></pre> <pre><code>/*\n * \u5982\u4f55\u67e5\u8be2\u7c7b\u4f3c\u4e8e\u6700\u5927\u7684\uff0c\u6700\u5c0f\u7684\uff0c\u5e73\u5747\u7684\uff0c\u603b\u548c\uff0c\u4e2a\u6570\u76f8\u5173\u7684\u6570\u636e\uff0c\n * \u4f7f\u7528ScalarHandler\n * \n */\n@Test\npublic void testQueryValue() throws Exception{\n    QueryRunner runner = new QueryRunner();\n\n    Connection conn = JDBCUtils.getConnection3();\n\n    //\u6d4b\u8bd5\u4e00\uff1a\n//  String sql = \"select count(*) from customers where id &lt; ?\";\n//  ScalarHandler handler = new ScalarHandler();\n//  long count = (long) runner.query(conn, sql, handler, 20);\n//  System.out.println(count);\n\n    //\u6d4b\u8bd5\u4e8c\uff1a\n    String sql = \"select max(birth) from customers\";\n    ScalarHandler handler = new ScalarHandler();\n    Date birth = (Date) runner.query(conn, sql, handler);\n    System.out.println(birth);\n\n    JDBCUtils.closeResource(conn, null);\n}\n</code></pre>"},{"location":"programming/java/JDBC/JDBC/#jdbc_1","title":"JDBC\u603b\u7ed3","text":"<pre><code>\u603b\u7ed3\n@Test\npublic void testUpdateWithTx() {\n\n    Connection conn = null;\n    try {\n        //1.\u83b7\u53d6\u8fde\u63a5\u7684\u64cd\u4f5c\uff08\n        //\u2460 \u624b\u5199\u7684\u8fde\u63a5\uff1aJDBCUtils.getConnection();\n        //\u2461 \u4f7f\u7528\u6570\u636e\u5e93\u8fde\u63a5\u6c60\uff1aC3P0;DBCP;Druid\n        //2.\u5bf9\u6570\u636e\u8868\u8fdb\u884c\u4e00\u7cfb\u5217CRUD\u64cd\u4f5c\n        //\u2460 \u4f7f\u7528PreparedStatement\u5b9e\u73b0\u901a\u7528\u7684\u589e\u5220\u6539\u3001\u67e5\u8be2\u64cd\u4f5c\uff08version 1.0 \\ version 2.0)\n//version2.0\u7684\u589e\u5220\u6539public void update(Connection conn,String sql,Object ... args){}\n//version2.0\u7684\u67e5\u8be2 public &lt;T&gt; T getInstance(Connection conn,Class&lt;T&gt; clazz,String sql,Object ... args){}\n        //\u2461 \u4f7f\u7528dbutils\u63d0\u4f9b\u7684jar\u5305\u4e2d\u63d0\u4f9b\u7684QueryRunner\u7c7b\n\n        //\u63d0\u4ea4\u6570\u636e\n        conn.commit();\n\n\n    } catch (Exception e) {\n        e.printStackTrace();\n\n\n        try {\n            //\u56de\u6eda\u6570\u636e\n            conn.rollback();\n        } catch (SQLException e1) {\n            e1.printStackTrace();\n        }\n\n    }finally{\n        //3.\u5173\u95ed\u8fde\u63a5\u7b49\u64cd\u4f5c\n        //\u2460 JDBCUtils.closeResource();\n        //\u2461 \u4f7f\u7528dbutils\u63d0\u4f9b\u7684jar\u5305\u4e2d\u63d0\u4f9b\u7684DbUtils\u7c7b\u63d0\u4f9b\u4e86\u5173\u95ed\u7684\u76f8\u5173\u64cd\u4f5c\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/","title":"equals()\u548c==","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/#_1","title":"\u4e00\u3001<code>==</code>\u8fd0\u7b97\u7b26","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/#1","title":"1. <code>==</code>\u7684\u4f7f\u7528","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/#1_1","title":"1. \u4f7f\u7528\u5728\u57fa\u672c\u6570\u636e\u7c7b\u578b\u53d8\u91cf\u548c\u5f15\u7528\u6570\u636e\u7c7b\u578b\u53d8\u91cf\u4e2d","text":"<p>\u5982\u679c\u6bd4\u8f83\u7684\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\u53d8\u91cf\uff0c\u6bd4\u8f83\u4e24\u4e2a\u53d8\u91cf\u4fdd\u5b58\u7684\u6570\u636e\u662f\u5426\u76f8\u7b49\uff08\u7c7b\u578b\u4e0d\u4e00\u5b9a\u8981\u76f8\u540c\uff09</p> <pre><code>public class HelloWorld {\n    public static void main(String[] args) {\n        int i = 10;\n        int j = 10;\n        double k = 10.0;\n\n        System.out.println(i == j); // true\n        System.out.println(i == k); // true  \u81ea\u52a8\u7c7b\u578b\u63d0\u5347\n    }\n}\n</code></pre> <p>\u5982\u679c\u6bd4\u8f83\u7684\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u7684\u5730\u5740\u503c\u662f\u5426\u76f8\u540c\uff0c\u5373\u4e24\u4e2a\u5f15\u7528\u662f\u5426\u6307\u5411\u540c\u4e00\u4e2a\u5bf9\u8c61\u5b9e\u4f53\u3002</p> <pre><code>public class HelloWorld {\n    public static void main(String[] args) {\n        Person p1 = new Person(\"Tom\", 8);\n        Person p2 = new Person(\"Tom\", 8);\n        System.out.println(p1 == p2);  // false\n    }\n}\n\nclass Person {\n    private String name;\n    private int age;\n\n    public Person() {\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/#equals","title":"\u4e8c\u3001<code>equals()</code>\u65b9\u6cd5","text":"<p>\u53ea\u9002\u7528\u4e8e\u5f15\u7528\u6570\u636e\u7c7b\u578b\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/#1objectequals","title":"1.<code>Object</code>\u7c7b\u4e2d<code>equals()</code>\u7684\u5b9a\u4e49","text":"<pre><code>    public boolean equals(Object obj) {\n        return (this == obj);\n    }\n// `Object`\u7c7b\u4e2d`equals()` \u548c == \u7684\u4f5c\u7528\u662f\u76f8\u540c\u7684\uff1a\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u7684\u5730\u5740\u503c\u662f\u5426\u76f8\u540c\n</code></pre> <p>String\u3001Date\u3001File\u3001\u5305\u88c5\u7c7b\u7b49\u90fd\u91cd\u5199\u4e86<code>Object</code>\u7c7b\u4e2d\u7684<code>equals()</code>\u65b9\u6cd5\uff0c\u91cd\u5199\u4ee5\u540e\u6bd4\u8f83\u7684\u662f\u4e24\u4e2a\u5bf9\u8c61\u7684\u201d\u5b9e\u4f53\u5185\u5bb9\u201d\u662f\u5426\u76f8\u540c\u3002</p> <pre><code>public class HelloWorld {\n    public static void main(String[] args) {\n        Person p1 = new Person(\"Tom\", 8);\n        Person p2 = new Person(\"Tom\", 8);\n        System.out.println(p1.equals(p2));  // false\n\n        String str1 = new String(\"Hello\");\n        String str2 = new String(\"Hello\");\n        System.out.println(str1.equals(str2)); // true\n    }\n}\n\nclass Person {\n    private String name;\n    private int age;\n\n    public Person() {\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/equals%28%29%E5%92%8C%3D%3D/#2-equals","title":"2. \u91cd\u5199<code>equals()</code>","text":"<p>\u91cd\u5199\u539f\u5219\uff1a\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u7684\u201c\u5b9e\u4f53\u5185\u5bb9\u201d\u662f\u5426\u76f8\u540c\u3002</p> <pre><code>import java.util.Objects;\n\npublic class HelloWorld {\n    public static void main(String[] args) {\n        Person p1 = new Person(\"Tom\", 8);\n        Person p2 = new Person(\"Tom\", 8);\n        System.out.println(p1.equals(p2));  // true\n    }\n}\n\nclass Person {\n    private String name;\n    private int age;\n\n    public Person() {\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n\n    public boolean equals(Object obj) {\n        if (this == obj) {\n            return true;\n        }\n        if (obj instanceof Person) {\n            Person p = (Person) obj;\n            // \u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u7684\u6bcf\u4e2a\u5c5e\u6027\u662f\u5426\u76f8\u540c\n            return this.age == p.age &amp;&amp; this.name.equals(p.name);\n        }\n        return false;\n    }\n}\n</code></pre> <p>\u5728\u5b9e\u9645\u7684\u5f00\u53d1\u4e2d\u501f\u52a9IDE\u81ea\u52a8\u751f\u6210</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/","title":"\u5f02\u5e38\u5904\u7406","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_1","title":"\u4e00\u3001\u5f02\u5e38\u7684\u5206\u7c7b","text":"<ol> <li> <p><code>Error</code>\uff1aJava\u865a\u62df\u673a\u65e0\u6cd5\u89e3\u51b3\u7684\u4e25\u91cd\u95ee\u9898\u3002\u5982\uff1a<code>JVM</code>\u7cfb\u7edf\u5185\u90e8\u9519\u8bef\u3001\u8d44\u6e90\u8017\u5c3d\u7b49\u4e25\u91cd\u60c5\u51b5\u3002\u5fc5\u987b<code>StackOverflowError</code>\u548c<code>OOM</code>\u3002\u4e00\u822c\u4e0d\u7f16\u5199\u9488\u5bf9\u6027\u7684\u4ee3\u7801\u8fdb\u884c\u5904\u7406</p> <pre><code>public class ErrorTest {\n    public static void main(String[] args) {\n        // \u6808\u6ea2\u51fa java.lang.StackOverflowError\n//        main(args);\n        // \u5806\u6ea2\u51fa ava.lang.OutOfMemoryError\n//        Integer[] arr = new Integer[1024 * 1024 * 1024];\n    }\n}\n</code></pre> </li> <li> <p><code>Exception</code>\uff1a\u5176\u4ed6\u56e0\u7f16\u7a0b\u9519\u8bef\u6216\u5076\u7136\u7684\u5916\u5728\u56e0\u7d20\u5bfc\u81f4\u7684\u4e00\u822c\u6027\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528\u9488\u5bf9\u6027\u7684\u4ee3\u7801\u8fdb\u884c\u5904\u7406\u3002\u4f8b\u5982</p> <ol> <li>\u7a7a\u6307\u9488\u8bbf\u95ee</li> <li>\u8bd5\u56fe\u8bfb\u53d6\u4e0d\u5b58\u5728\u7684\u6587\u4ef6</li> <li>\u7f51\u7edc\u8fde\u63a5\u4e2d\u65ad</li> <li>\u6570\u7ec4\u89d2\u6807\u8d8a\u754c</li> </ol> </li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_2","title":"\u4e8c\u3001\u5e38\u89c1\u5f02\u5e38","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#1","title":"1. \u7f16\u8bd1\u65f6\u5f02\u5e38","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#2","title":"2. \u8fd0\u884c\u65f6\u5f02\u5e38","text":"<ol> <li><code>NullPointerException</code></li> </ol> <pre><code>public class ExceptionTest {\n    public static void main(String[] args) {\n        int[] arr = null;\n        System.out.println(arr[1]); // java.lang.NullPointerException\n    }\n}\n</code></pre> <p>2.<code>ArrayIndexOutOfBoundsException</code></p> <pre><code>public class ExceptionTest {\n    public static void main(String[] args) {\n        int[] arr = new int[5];\n        System.out.println(arr[5]);  // java.lang.ArrayIndexOutOfBoundsException: 5\n    }\n}\n</code></pre> <p>3.<code>NumberFormatException</code></p> <pre><code>public class ExceptionTest {\n    public static void main(String[] args) {\n        String str = \"abc\";\n        Integer.parseInt(str); // java.lang.NumberFormatException\n    }\n}\n</code></pre> <p>4.<code>ArithmeticException</code></p> <pre><code>public class ExceptionTest {\n    public static void main(String[] args) {\n        System.out.println(5 / 0); // java.lang.ArithmeticException\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_3","title":"\u4e09\u3001\u5f02\u5e38\u5904\u7406","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#1-try-catch","title":"1. <code>try-catch</code>","text":"<p>\u8bed\u6cd5\u683c\u5f0f\uff1a</p> <pre><code>try {\n    // \u53ef\u80fd\u51fa\u73b0\u5f02\u5e38\u7684\u4ee3\u7801\n}catch (\u5f02\u5e38\u7c7b\u578b1 \u53d8\u91cf\u540d1){\n    // \u5904\u7406\u5f02\u5e38\u7684\u65b9\u5f0f1\n}catch (\u5f02\u5e38\u7c7b\u578b2 \u53d8\u91cf\u540d2){\n    // \u5904\u7406\u5f02\u5e38\u7684\u65b9\u5f0f2\n}finally {\n    // \u4e00\u5b9a\u4f1a\u6267\u884c\u7684\u4ee3\u7801\n}\n</code></pre> <p>\u793a\u4f8b</p> <pre><code>public class ExceptionTest {\n    public static void main(String[] args) {\n        try {\n            Integer.parseInt(\"abc\");\n        }catch (NumberFormatException e){\n            System.out.println(\"\u6570\u503c\u8f6c\u6362\u5f02\u5e38\");\n            // \u4e24\u79cd\u5f02\u5e38\u5904\u7406\u7684\u65b9\u5f0f\n            System.out.println(e.getMessage());  // For input string: \"abc\"\n            e.printStackTrace(); // \u5e38\u7528\n        }\n    }\n}\n</code></pre> <p>\u4f7f\u7528<code>try</code>\u5c06\u53ef\u80fd\u51fa\u73b0\u5f02\u5e38\u7684\u4ee3\u7801\u5305\u88c5\u8d77\u6765\uff0c\u5728\u6267\u884c\u8fc7\u7a0b\u4e2d\uff0c\u4e00\u65e6\u51fa\u73b0\u5f02\u5e38\uff0c\u5c31\u4f1a\u751f\u6210\u4e00\u4e2a\u5bf9\u5e94\u5f02\u5e38\u7c7b\u7684\u5bf9\u8c61\uff0c\u6839\u636e\u6b64\u5bf9\u8c61\u7684\u7c7b\u578b\uff0c\u53d6<code>catch</code>\u4e2d\u8fdb\u884c\u5339\u914d\u3002</p> <p>\u4e00\u65e6<code>try</code>\u4e2d\u7684\u5f02\u5e38\u5bf9\u8c61\u5339\u914d\u5230\u67d0\u4e00\u4e2a<code>catch</code>\u65f6\uff0c\u5c31\u8fdb\u5165<code>catch</code>\u4e2d\u8fdb\u884c\u5f02\u5e38\u7684\u5904\u7406\uff0c\u4e00\u65e6\u5904\u7406\u5b8c\u6210\uff0c\u5c31\u8df3\u51fa\u5f53\u524d\u7684<code>try-catch</code>\u7ed3\u6784\u3002</p> <p><code>catch</code>\u4e2d\u7684\u5f02\u5e38\u7c7b\u578b\u5982\u679c\u6ca1\u6709\u5b50\u7236\u7c7b\u5173\u7cfb\uff0c\u5728\u58f0\u660e\u7684\u5148\u540e\u987a\u5e8f\u4e0a\u65e0\u6240\u8c13\uff0c\u5982\u679c\u6709\u5b50\u7236\u7c7b\u5173\u7cfb\uff0c\u8981\u6c42\u5b50\u7c7b\u58f0\u660e\u7684\u5728\u7236\u7c7b\u7684\u4e0a\u9762\uff0c\u5426\u5219\u62a5\u9519\u3002</p> <p>\u5728<code>try</code>\u4e2d\u58f0\u660e\u7684\u53d8\u91cf\uff0c\u51fa\u4e86<code>try</code>\u7ed3\u6784\u4ee5\u540e\u5c31\u4e0d\u80fd\u518d\u88ab\u8c03\u7528\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#2-try-catch-finally","title":"2. <code>try-catch-finally</code>","text":"<p><code>finally</code>\u4e2d\u58f0\u660e\u7684\u662f\u4e00\u5b9a\u4f1a\u6267\u884c\u7684\u4ee3\u7801\uff0c\u5373\u4f7fcatch\u4e2d\u6709\u5f02\u5e38\u3001try\u4e2d\u6709return\u6216catch\u4e2d\u6709return\u8bed\u53e5\u7b49\u60c5\u51b5\u3002</p> <p>\u50cf\u6570\u636e\u5e93\u8fde\u63a5\u3001\u8f93\u5165\u8f93\u51fa\u6d41\u3001\u7f51\u7edcsocket\u7b49\u8d44\u6e90\uff0c<code>JVM</code>\u4e0d\u80fd\u81ea\u52a8\u56de\u6536\uff0c\u6b64\u65f6\u9700\u8981\u624b\u52a8\u7684\u8fdb\u884c\u8d44\u6e90\u7684\u91ca\u653e\u3002\u6b64\u65f6\u8d44\u6e90\u7684\u91ca\u653e\u5c31\u9700\u8981\u58f0\u660e\u5728<code>finally</code>\u4e2d\u3002</p> <pre><code>public class ExceptionTest {\n    public static void main(String[] args) {\n        try {\n            System.out.println(5 / 0);\n        } catch (ArithmeticException e){\n            e.printStackTrace();\n            Integer.parseInt(\"abc\");\n        } finally {\n            System.out.println(\"finally\u4e2d\u7684\u4ee3\u7801\u5757\");  // \u6267\u884c\u4e86\n        }\n        System.out.println(\"try\u4e4b\u5916\u4ee3\u7801\u5757\"); // \u6ca1\u6709\u6267\u884c\n    }\n}\n</code></pre> <p><code>try-catch-finally</code>\u53ef\u4ee5\u6839\u636e\u9700\u8981\u5d4c\u5957\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#3-trows","title":"3. <code>trows + \u5f02\u5e38\u7c7b\u578b</code>","text":"<p>\u5199\u5728\u65b9\u6cd5\u7684\u58f0\u660e\u5904\uff0c\u6307\u660e\u6b64\u65b9\u6cd5\u6267\u884c\u65f6\u53ef\u80fd\u4f1a\u629b\u51fa\u7684\u5f02\u5e38\u7c7b\u578b\u3002</p> <p>\u4e00\u65e6\u6b64\u65b9\u6cd5\u6267\u884c\u65f6\uff0c\u51fa\u73b0\u5f02\u5e38\u65f6\u4ecd\u4f1a\u5728\u5f02\u5e38\u4ee3\u7801\u5904\u751f\u6210\u4e00\u4e2a\u5f02\u5e38\u7c7b\u7684\u5bf9\u8c61\uff0c\u6b64\u65f6\u6ee1\u8db3throws\u540e\u5f02\u5e38\u7c7b\u578b\u65f6\uff0c\u5c31\u4f1a\u88ab\u629b\u51fa\uff0c\u5f02\u5e38\u4ee3\u7801\u540e\u7eed\u7684\u4ee3\u7801\u5c31\u4e0d\u518d\u6267\u884c\u3002</p> <pre><code>import java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\n\n\npublic class ExceptionTest {\n    public static void main(String[] args) {\n        try {\n            method2();\n        } catch (IOException e){\n            e.printStackTrace();\n        }\n\n    }\n    public static void method2() throws FileNotFoundException, IOException{\n        method1();\n    }\n    public static void method1() throws FileNotFoundException, IOException {\n        File file = new File(\"hello.txt\");\n        FileInputStream fis = new FileInputStream(file);\n\n        int data = fis.read();\n        while (data != -1){\n            System.out.println((char) data);\n            data = fis.read();\n        }\n        fis.close();\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_4","title":"\u56db\u3001\u91cd\u5199\u65b9\u6cd5\u5f02\u5e38\u629b\u51fa","text":"<p>\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38\u7c7b\u578b\u4e0d\u5927\u4e8e\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38\u7c7b\u578b\u3002</p> <pre><code>import java.io.FileNotFoundException;\nimport java.io.IOException;\n\npublic class OverrideTest {\n    public static void main(String[] args) {\n        OverrideTest test = new OverrideTest();\n        test.display(new SubClass());\n    }\n\n    public void display(SuperClass s){\n        try {\n            s.method();\n        } catch (IOException e){\n            e.printStackTrace();\n        }\n    }\n}\n\nclass SuperClass{\n    public void method() throws IOException{\n\n    }\n}\n\nclass SubClass extends SuperClass {\n    public void method() throws FileNotFoundException {\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_5","title":"\u4e94\u3001\u624b\u52a8\u629b\u51fa\u5f02\u5e38","text":"<pre><code>public class StudentTest {\n    public static void main(String[] args) {\n        try {\n            Student stu = new Student();\n            stu.register(-1);\n            System.out.println(stu);\n        } catch (Exception e) {\n            System.out.println(e.getMessage());\n        }\n    }\n}\n\nclass Student {\n    private int id;\n\n    public void register(int id) throws Exception {\n        if (id &gt; 0) {\n            this.id = id;\n        } else {\n            throw new Exception(\"\u975e\u6cd5\u6570\u636e\");\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_6","title":"\u516d\u3001\u81ea\u5b9a\u4e49\u5f02\u5e38\u7c7b","text":"<pre><code>//1.\u7ee7\u627f\u73b0\u6709\u7684\u5f02\u5e38\u7c7bRuntimeException\u3001Exception\n//2.\u63d0\u4f9b\u5168\u5c40\u5e38\u91cf serialVersionUID\n//3.\u63d0\u4f9b\u91cd\u8f7d\u7684\u6784\u9020\u5668\npublic class MyException extends RuntimeException {\n    static final long serialVersionUID = -7034897190745766939L;\n\n    public MyException(){\n\n    }\n    public MyException(String msg){\n        super(msg);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#try-catchthrows","title":"\u4e03\u3001\u5f00\u53d1\u4e2d\u5982\u4f55\u9009\u62e9\u4f7f\u7528<code>try-catch</code>\u8fd8\u662f<code>throws</code>\uff1f","text":"<ol> <li>\u5982\u679c\u7236\u7c7b\u4e2d\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u6ca1\u6709<code>throws</code>\u65b9\u6cd5\u5904\u7406\u5f02\u5e38\uff0c\u5219\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u4e5f\u4e0d\u80fd\u4f7f\u7528<code>throws</code>\uff0c\u610f\u5473\u7740\u5982\u679c\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u4e2d\u6709\u5f02\u5e38\uff0c\u5fc5\u987b\u4f7f\u7528<code>try-catch</code>\u65b9\u5f0f\u5904\u7406\u3002</li> <li>\u6267\u884c\u7684\u65b9\u6cd5A\u4e2d\uff0c\u5148\u540e\u53c8\u8c03\u7528\u4e86\u53e6\u5916\u51e0\u4e2a\u65b9\u6cd5\uff0c\u8fd9\u51e0\u4e2a\u65b9\u6cd5\u662f\u9012\u8fdb\u5173\u7cfb\u6267\u884c\u7684\uff0c\u5efa\u8bae\u8fd9\u51e0\u4e2a\u65b9\u6cd5\u4f7f\u7528throws\u7684\u65b9\u5f0f\u8fdb\u884c\u5904\u7406\uff0c\u800c\u6267\u884c\u7684A\u65b9\u6cd5\u8003\u8651\u4f7f\u7528<code>try-catch</code>\u65b9\u5f0f\u8fdb\u884c\u5904\u7406\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/","title":"\u6570\u7ec4","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#_1","title":"\u4e00\u3001\u6982\u5ff5","text":"<ol> <li> <p>\u6570\u7ec4\u662f\u591a\u4e2a\u76f8\u540c\u6570\u636e\u7c7b\u578b\u6309\u4e00\u5b9a\u987a\u5e8f\u6392\u5217\u7684\u96c6\u5408\uff0c\u4f7f\u7528\u4e00\u4e2a\u540d\u5b57\u547d\u540d\uff0c\u5e76\u901a\u8fc7\u7f16\u53f7\u7684\u65b9\u5f0f\u5bf9\u8fd9\u4e9b\u6570\u636e\u8fdb\u884c\u7edf\u4e00\u7ba1\u7406\u3002</p> </li> <li> <p>\u6570\u7ec4\u672c\u8eab\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u800c\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u53ef\u4ee5\u662f\u4efb\u610f\u6570\u636e\u7c7b\u578b\uff0c\u5305\u62ec\u57fa\u672c\u6570\u636e\u7c7b\u578b\u548c\u5f15\u7528\u6570\u636e\u7c7b\u578b\u3002</p> </li> <li> <p>\u521b\u5efa\u6570\u7ec4\u5bf9\u8c61\u4f1a\u5728\u5185\u5bb9\u4e2d\u5f00\u8f9f\u4e00\u5757\u8fde\u7eed\u7684\u5185\u5b58\u7a7a\u95f4\uff0c\u800c\u6570\u7ec4\u540d\u4e2d\u5f15\u7528\u7684\u662f\u8fd9\u5757\u8fde\u7eed\u7a7a\u95f4\u7684\u9996\u5730\u5740\u3002</p> </li> <li> <p>\u6570\u7ec4\u7684\u957f\u5ea6\u4e00\u65e6\u786e\u5b9a\uff0c\u5c31\u4e0d\u80fd\u4fee\u6539\u3002</p> </li> <li>\u6570\u636e\u5206\u7c7b</li> <li>\u6309\u7ef4\u5ea6\u5206\uff1a\u4e00\u7ef4\u6570\u7ec4\u3001\u4e8c\u7ef4\u6570\u7ec4\u3001...</li> <li>\u6309\u5143\u7d20\u7c7b\u578b\u5206\uff1a\u57fa\u672c\u6570\u636e\u7c7b\u578b\u5143\u7d20\u7684\u6570\u7ec4\u3001\u5f15\u7528\u6570\u636e\u7c7b\u578b\u5143\u7d20\u7684\u6570\u7ec4</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#_2","title":"\u4e8c\u3001\u4e00\u7ef4\u6570\u7ec4","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#1","title":"1. \u58f0\u660e\u548c\u521d\u59cb\u5316","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        // 1. \u9759\u6001\u521d\u59cb\u5316\uff1a\u6570\u7ec4\u7684\u521d\u59cb\u5316\u548c\u6570\u7ec4\u5143\u7d20\u7684\u8d4b\u503c\u64cd\u4f5c\u540c\u65f6\u8fdb\u884c\n        int[] ids; // \u58f0\u660e\n        ids = new int[]{1001, 1002, 1003, 1004};\n\n        // 2. \u52a8\u6001\u521d\u59cb\u5316\uff1a\u6570\u7ec4\u7684\u521d\u59cb\u5316\u548c\u6570\u7ec4\u5143\u7d20\u7684\u8d4b\u503c\u64cd\u4f5c\u5206\u5f00\u8fdb\u884c\n        String[] names;\n        names = new String[5];\n\n        // \u58f0\u660e + \u521d\u59cb\u5316\n        String[] animals = new String[10];\n        char[] grades = new char[]{'A', 'B', 'C', 'D'};\n\n        // \u5176\u4ed6\u5199\u6cd5\n        int[] nums = {1, 2, 3, 4}; // \u7c7b\u578b\u63a8\u65ad\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#2","title":"2. \u6570\u7ec4\u7d22\u5f15","text":"<ol> <li>\u901a\u8fc7\u7d22\u5f15\u7684\u65b9\u5f0f\u8c03\u7528\u6570\u636e\u6307\u5b9a\u4f4d\u7f6e\u7684\u5143\u7d20\u3002</li> <li>\u6570\u7ec4\u7684\u7d22\u5f15\u4ece<code>0</code>\u5f00\u59cb\uff0c\u5230\u6570\u7ec4<code>\u957f\u5ea6-1</code>\u7ed3\u675f\u3002</li> </ol> <pre><code>package com.example.www;\n\npublic class ArrayTest {\n    public static void main(String[] args) {\n        String[] names;\n        names = new String[5];\n\n        names[0] = \"\u5173\u7fbd\";\n        names[1] = \"\u5f20\u98de\";\n        names[2] = \"\u9ec4\u5fe0\";\n        names[3] = \"\u9a6c\u8d85\";\n        names[4] = \"\u8d75\u4e91\";\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#3","title":"3. \u6570\u7ec4\u957f\u5ea6","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        String[] names;\n        names = new String[5];\n        System.out.println(names.length); // 5\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#4","title":"4. \u6570\u7ec4\u904d\u5386","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        String[] names;\n        names = new String[5];\n\n        names[0] = \"\u5173\u7fbd\";\n        names[1] = \"\u5f20\u98de\";\n        names[2] = \"\u9ec4\u5fe0\";\n        names[3] = \"\u9a6c\u8d85\";\n        names[4] = \"\u8d75\u4e91\";\n\n        for (int i = 0; i &lt; names.length; i++) {\n            System.out.println(names[i]);\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#5","title":"5. \u9ed8\u8ba4\u521d\u59cb\u5316\u503c","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        String[] names;\n        names = new String[5];\n        for (int i = 0; i &lt; names.length; i++) {\n            System.out.println(names[i]); // null\n        }\n    }\n}\n</code></pre> <p>\u6570\u7ec4\u5143\u7d20\u662f\u6574\u578b\uff1a<code>0</code></p> <p>\u6570\u7ec4\u5143\u7d20\u662f\u6d6e\u70b9\u578b\uff1a<code>0.0</code></p> <p>\u6570\u7ec4\u5143\u7d20\u662f<code>char</code>\u578b\uff1a<code>ASCII\u4e2d\u76840\uff08\u7a7a\u5b57\u7b26\uff09</code></p> <p>\u6570\u7ec4\u5143\u7d20\u662f<code>boolean</code>\u578b\uff1a<code>false</code></p> <p>\u6570\u7ec4\u5143\u7d20\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff1a<code>null</code></p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#6","title":"6. \u6570\u7ec4\u5185\u5b58\u89e3\u6790","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#_3","title":"\u4e09\u3001\u4e8c\u7ef4\u6570\u7ec4","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#1_1","title":"1. \u58f0\u660e\u548c\u521d\u59cb\u5316","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n       // 1. \u9759\u6001\u521d\u59cb\u5316\n       int[][] arr1 = new int[][]{{1,2,3},{4,5},{6}};\n       // 2. \u52a8\u6001\u521d\u59cb\u5316\n       int[][] arr2 = new int[3][];\n       int[][] arr3 = new int[3][2];\n\n       // \u5176\u4ed6\u5199\u6cd5\n        int arr4[][] =  new int[3][];\n        int[] arr5[] = new int[3][];\n        int[][] arr6 = {{1,2,3},{4,5},{6}};\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#2_1","title":"2. \u6570\u7ec4\u7d22\u5f15","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        int[][] arr1 = new int[][]{{1,2,3},{4,5},{6}};\n        System.out.println(arr1[0][1]); // 2\n        int[][] arr2 = new int[3][];\n        arr2[1] = new int[4];\n        System.out.println(arr2[1][0]); // 0\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#3_1","title":"3. \u6570\u7ec4\u957f\u5ea6","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        int[][] arr1 = new int[][]{{1,2,3},{4,5},{6}};\n        System.out.println(arr1.length); // 3\n        System.out.println(arr1[1].length); // 2\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#4_1","title":"4. \u6570\u7ec4\u904d\u5386","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        int[][] arr = new int[][]{{1,2,3},{4,5},{6}};\n        for (int i = 0; i &lt; arr.length; i++) {\n            for (int j = 0; j &lt; arr[i].length; j++) {\n                System.out.print(arr[i][j] + \" \");\n            }\n            System.out.println();\n        }\n    }\n}\n//1 2 3\n//4 5\n//6 \n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#5_1","title":"5. \u9ed8\u8ba4\u521d\u59cb\u5316\u503c","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args){\n        // \u521d\u59cb\u5316\u65b9\u5f0f\u4e00\uff1a\n        int[][] arr1 = new int[4][3];\n        System.out.println(arr1[0]); // [I@1b6d3586 \u5730\u5740\u503c\n        System.out.println(arr1[0][0]); // 0\n        System.out.println(arr1); // [[I@4554617c\n\n        // \u521d\u59cb\u5316\u65b9\u5f0f\u4e8c\uff1a\n        int[][] arr2 = new int[4][];\n        System.out.println(arr2[0]); // null\n        System.out.println(arr2[0][1]); // NullPointerException\uff0c \u4e0d\u80fd\u8c03\u7528\uff0c\u62a5\u9519\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#6_1","title":"6. \u6570\u7ec4\u5185\u5b58\u89e3\u6790","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#arrays","title":"\u56db\u3001Arrays\u5de5\u5177\u7c7b","text":"<pre><code>import java.util.Arrays;\n\npublic class ArrayTest {\n    public static void main(String[] args) {\n        int[] arr1 = new int[]{1, 2, 3, 4};\n        int[] arr2 = new int[]{2, 1, 4, 3};\n        boolean isEquals = Arrays.equals(arr1,arr2);\n        // \u5224\u65ad\u6570\u7ec4\u662f\u5426\u76f8\u7b49\n        System.out.println(isEquals); // false\n        // \u8f93\u51fa\u6570\u7ec4\u4fe1\u606f\n        System.out.println(Arrays.toString(arr1)); // [1, 2, 3, 4]\n        // \u5c06\u6307\u5b9a\u503c\u586b\u5145\u5230\u6570\u7ec4\u4e2d\n        Arrays.fill(arr1, 10);\n        System.out.println(Arrays.toString(arr1)); // [10, 10, 10, 10]\n        // \u6392\u5e8f\n        Arrays.sort(arr2);\n        System.out.println(Arrays.toString(arr2)); // [1, 2, 3, 4]\n        // \u4e8c\u5206\u67e5\u627e\n        int[] arr3 = new int[]{2, 3, 5, 7, 11, 13, 17, 19, 21, 23};\n        int index = Arrays.binarySearch(arr3, 17);\n        System.out.println(index); // 6\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#_4","title":"\u4e94\u3001\u6570\u7ec4\u7ec3\u4e60","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#1_2","title":"1. \u6768\u8f89\u4e09\u89d2","text":"<pre><code>// \u8003\u5bdf\u5143\u7d20\u8d4b\u503c\n\npublic class YangHuiTest {\n    public static void main(String[] args) {\n        // 1. \u58f0\u660e\u5e76\u521d\u59cb\u5316\u4e8c\u7ef4\u6570\u7ec4\n        int[][] yangHui = new int[10][];\n        // 2. \u7ed9\u6570\u7ec4\u7684\u5143\u7d20\u8d4b\u503c\n        for (int i = 0; i &lt; yangHui.length; i++) {\n            yangHui[i] = new int[i + 1];\n            // 2.1 \u5148\u7ed9\u9996\u672b\u5143\u7d20\u8d4b\u503c\n            yangHui[i][0] = yangHui[i][i] = 1;\n            // 2.2 \u7ed9\u6bcf\u884c\u7684\u975e\u9996\u672b\u5143\u7d20\u8d4b\u503c\n            if (i &gt; 1) {\n                for (int j = 1; j &lt; yangHui[i].length - 1; j++) {\n                    yangHui[i][j] = yangHui[i-1][j-1] + yangHui[i-1][j];\n                }\n            }\n        }\n        // 3. \u904d\u5386\u4e8c\u7ef4\u6570\u7ec4\n        for (int i = 0; i &lt; yangHui.length; i++) {\n            for (int j = 0; j &lt; yangHui[i].length; j++) {\n                System.out.print(yangHui[i][j] + \" \");\n            }\n            System.out.println();\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#2_2","title":"2.  \u6c42\u6570\u503c\u578b\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u3001\u5e73\u5747\u6570\u548c\u603b\u548c","text":"<p>\u5b9a\u4e49\u4e00\u4e2aint\u578b\u7684\u4e00\u7ef4\u6570\u7ec4\uff0c\u5305\u542b10\u4e2a\u5143\u7d20\uff0c\u5206\u522b\u8d4b\u4e88\u968f\u673a\u4e24\u4f4d\u6574\u6570\u3002\u7136\u540e\u6c42\u51fa\u6240\u6709\u5143\u7d20\u7684\u6700\u5927\u503c\u3001\u6700\u5c0f\u503c\u3001\u5e73\u5747\u6570\u3001\u548c\uff0c\u5e76\u8f93\u51fa\u3002</p> <pre><code>//\u83b7\u53d6[a,b]\u8303\u56f4\u7684\u968f\u673a\u6570\uff1a(int)(Math.random()*(b-a+1)+a)\n\npublic class ArrayTest {\n    public static void main(String[] args) {\n        int[] arr = new int[10];\n\n        for (int i = 0; i &lt; arr.length; i++) {\n            arr[i] = (int) (Math.random() * (99 - 10 + 1) + 10);\n        }\n\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.print(arr[i] + \" \");\n        }\n        System.out.println();\n        //\u6700\u5927\u503c\n        int maxValue = arr[0];\n        for (int i = 1; i &lt; arr.length; i++) {\n            if (maxValue &lt; arr[i]) {\n                maxValue = arr[i];\n            }\n        }\n        System.out.println(\"\u6700\u5927\u503c\u4e3a\uff1a\" + maxValue);\n        //\u6700\u5c0f\u503c\n        int minValue = arr[0];\n        for (int i = 1; i &lt; arr.length; i++) {\n            if (minValue &gt; arr[i]) {\n                minValue = arr[i];\n            }\n        }\n        System.out.println(\"\u6700\u5c0f\u503c\u4e3a\uff1a\" + minValue);\n        //\u6c42\u548c\n        int sum = 0;\n        for (int i = 0; i &lt; arr.length; i++) {\n            sum += arr[i];\n        }\n        System.out.println(\"\u548c\uff1a\" + sum);\n        //\u5e73\u5747\u6570\n        int avgValue = sum / arr.length;\n        System.out.println(\"\u5e73\u5747\u6570\u4e3a\uff1a\" + avgValue);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#3_2","title":"3. \u6570\u7ec4\u590d\u5236","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n        int[] arr1,arr2;\n        arr1 = new int[]{2, 3, 5, 7, 11, 13, 17, 19};\n        // \u663e\u793aarr1\u7684\u5185\u5bb9\n        for (int i = 0; i &lt; arr1.length; i++) {\n            System.out.print(arr1[i] + \" \"); // 2 3 5 7 11 13 17 19\n        }\n        System.out.println();\n        // 1.\u8d4b\u503carr2\u53d8\u91cf\u7b49\u4e8earr1\n        // \u4e0d\u80fd\u79f0\u4f5c\u6570\u7ec4\u7684\u590d\u5236\uff0carr1\u548carr2\u5730\u5740\u503c\u76f8\u540c\n        // arr2 = arr1;\n\n        // 2. \u904d\u5386\u8d4b\u503c\n        arr2 = new int[arr1.length];\n        for (int i = 0; i &lt; arr1.length; i++) {\n            arr2[i] = arr1[i];\n        }\n        // \u4fee\u6539arr2\u4e2d\u7684\u5143\u7d20\n        for (int i = 0; i &lt; arr2.length; i++) {\n            if (i % 2 == 0){\n                arr2[i] = i;\n            }\n        }\n        // \u663e\u793aarr1\u7684\u5185\u5bb9\n        for (int i = 0; i &lt; arr1.length; i++) {\n            System.out.print(arr1[i] + \" \"); // 2 3 5 7 11 13 17 19\n        }\n        System.out.println();\n        // \u663e\u793aarr2\u7684\u5185\u5bb9\n        for (int i = 0; i &lt; arr2.length; i++) {\n            System.out.print(arr2[i] + \" \"); // 0 3 2 7 4 13 6 19\n        }\n        System.out.println();\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#4_2","title":"4. \u6570\u7ec4\u53cd\u8f6c","text":"<pre><code>public class ArrayTest {\n    public static void main(String[] args) {\n\n        int[] arr = new int[]{2, 3, 5, 7, 11, 13, 17, 19};\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.print(arr[i] + \" \"); // 2 3 5 7 11 13 17 19\n        }\n        System.out.println();\n\n        // \u6570\u7ec4\u53cd\u8f6c\n        // \u65b9\u6cd5\u4e00\n//        for (int i = 0; i &lt; arr.length / 2; i++) {\n//            int tmp = arr[i];\n//            arr[i] = arr[arr.length - i - 1];\n//            arr[arr.length - i - 1] = tmp;\n//        }\n\n        // \u65b9\u6cd5\u4e8c\n        for (int i = 0, j = arr.length - 1; i&lt;j;i++,j--) {\n            int tmp = arr[i];\n            arr[i] = arr[j];\n            arr[j] = tmp;\n        }\n\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.print(arr[i] + \" \"); // 19 17 13 11 7 5 3 2\n        }\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#5_2","title":"5. \u67e5\u627e","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#51","title":"5.1 \u7ebf\u6027\u67e5\u627e","text":"<pre><code>public class SearchTest {\n    public static void main(String[] args) {\n        int[] arr = new int[]{2, 3, 5, 7, 11, 13, 17, 19};\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.print(arr[i] + \" \"); // 2 3 5 7 11 13 17 19\n        }\n        System.out.println();\n\n        int dest = 17;\n        // \u7ebf\u6027\u67e5\u627e\n        for (int i = 0; i &lt; arr.length; i++) {\n            if (dest == arr[i]){\n                System.out.println(\"Index:\"+i);\n                break;\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#52","title":"5.2 \u4e8c\u5206\u6cd5","text":"<p>\u524d\u63d0\uff1a\u6240\u8981\u67e5\u627e\u7684\u6570\u7ec4\u5fc5\u987b\u6709\u5e8f</p> <pre><code>public class SearchTest {\n    public static void main(String[] args) {\n        int[] arr = new int[]{2, 3, 5, 7, 11, 13, 17, 19, 21, 23};\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.print(arr[i] + \" \"); // 2 3 5 7 11 13 17 19\n        }\n        System.out.println();\n\n        int dest = 17;\n        // \u4e8c\u5206\u6cd5\u67e5\u627e\n        int head = 0; // \u521d\u59cb\u7684\u9996\u7d22\u5f15\n        int end = arr.length - 1; // \u521d\u59cb\u7684\u672b\u7d22\u5f15\n        boolean isFlag = true;\n        while (head &lt;= end){\n            int middle = (head + end) / 2;\n            if (dest == arr[middle]){\n                System.out.println(\"Index:\" + middle);\n                isFlag = false;\n                break;\n            }else if (arr[middle] &gt; dest) {\n                end = middle -1 ;\n            }else {\n                head = middle + 1;\n            }\n        }\n        if(isFlag){\n            System.out.println(\"Not found\");\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#6_2","title":"6. \u6392\u5e8f","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%95%B0%E7%BB%84/#61","title":"6.1 \u5192\u6ce1\u6392\u5e8f","text":"<pre><code>public class BubbleSortTest {\n    public static void main(String[] args) {\n        int[] arr = new int[]{11, 17, 2, 13, 5, 23, 7, 3};\n        // \u5192\u6ce1\u6392\u5e8f\n        for (int i = 0; i &lt; arr.length - 1; i++) {\n            for (int j = 0; j &lt; arr.length - 1 - i; j++) {\n                if (arr[j] &gt; arr[j+1]) {\n                    int tmp = arr[j];\n                    arr[j] = arr[j+1];\n                    arr[j+1] = tmp;\n                }\n            }\n        }\n\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.print(arr[i] + \" \"); // 2 3 5 7 11 13 17 23\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/","title":"Java\u6982\u8ff0","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#_1","title":"\u4e00\u3001\u5f00\u53d1\u73af\u5883\u914d\u7f6e","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#1-jdk","title":"1. \u4e0b\u8f7dJDK","text":"<p>jdk\u4e0b\u8f7d\u5730\u5740\uff1a https://www.oracle.com/java/technologies/javase-downloads.html</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#2","title":"2. \u89e3\u538b","text":"<pre><code>$ cd $HOME/software\n$ tar zxf jdk-8u231-linux-x64.tar.gz\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#3","title":"3. \u914d\u7f6e\u73af\u5883\u53d8\u91cf","text":"<pre><code>$ cat &gt;&gt; $HOME/.bashrc &lt;&lt; 'EOF'\nJAVA_HOME=$HOME/software/jdk1.8.0_231\nJRE_HOME=$JAVA_HOME/jre\nCLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar:$JRE_HOME/lib/rt.jar\nPATH=$PATH:$JAVA_HOME/bin:$JRE_HOME/bin\nEOF\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#4","title":"4.\u9a8c\u8bc1\u662f\u5426\u751f\u6548","text":"<pre><code>$ source $HOME/.bashrc\n$ java -version\njava version \"1.8.0_231\"\nJava(TM) SE Runtime Environment (build 1.8.0_231-b11)\nJava HotSpot(TM) 64-Bit Server VM (build 25.231-b11, mixed mode)\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#_2","title":"\u4e8c\u3001\u5f00\u53d1\u4f53\u9a8c","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#1-javajava","title":"1. \u5728\u6269\u5c55\u540d\u4e3a<code>.java</code>\u7684\u6587\u4ef6\u4e2d\u7f16\u5199Java\u6e90\u4ee3\u7801","text":"<pre><code>class HelloWorld {\n    public static void main(String[] args) {\n        System.out.println(\"Hello World!\");\n    }\n}\n</code></pre> <p><code>main()</code>\u65b9\u6cd5\uff1a</p> <ol> <li> <p><code>main()</code>\u65b9\u6cd5\u4f5c\u4e3a\u7a0b\u5e8f\u7684\u5165\u53e3</p> </li> <li> <p><code>main()</code>\u662f\u4e00\u4e2a\u666e\u901a\u7684\u9759\u6001\u65b9\u6cd5</p> </li> <li> <p><code>mian()</code>\u65b9\u6cd5\u53ef\u4ee5\u4f5c\u4e3a\u4e0e\u63a7\u5236\u53f0\u4ea4\u4e92\u7684\u65b9\u5f0f</p> <pre><code>java HelloWorld AA BB CC  # \u53c2\u6570\u4f20\u9012\u7ed9args\n</code></pre> </li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#2-javacjava","title":"2. \u901a\u8fc7<code>javac</code>\u547d\u4ee4\u7f16\u8bd1\u8be5<code>java</code>\u6587\u4ef6","text":"<pre><code>$ javac HelloWorld.java\n</code></pre> <p>\u6b64\u65f6\u4f1a\u751f\u6210\u4e0e\u7c7b\u540c\u540d\u7684\u5b57\u8282\u7801\u6587\u4ef6<code>HelloWorld.class</code></p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#3-javaclass","title":"3. \u901a\u8fc7<code>java</code>\u547d\u4ee4\u8fd0\u884c\u751f\u4ea7\u7684<code>class</code>\u6587\u4ef6","text":"<pre><code># \u547d\u4ee4\u683c\u5f0f\uff1a# java \u7c7b\u540d\n$ java HelloWorld \nHello World!\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#_3","title":"\u4e09\u3001\u6ce8\u91ca","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#1","title":"1.\u5355\u884c\u6ce8\u91ca","text":"<pre><code>// \u5355\u884c\u6ce8\u91ca\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#2_1","title":"2. \u591a\u884c\u6ce8\u91ca","text":"<pre><code>/*\n\u591a\u884c \n\u6ce8\u91ca\n*/\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#3_1","title":"3. \u6587\u6863\u6ce8\u91ca","text":"<p>\u6ce8\u91ca\u5185\u5bb9\u53ef\u4ee5\u88abJDK\u63d0\u4f9b\u7684\u5de5\u5177<code>javadoc</code>\u6240\u89e3\u6790\uff0c\u751f\u6210\u4e00\u5957\u4ee5\u7f51\u9875\u5f62\u5f0f\u4f53\u73b0\u7684\u8be5\u7a0b\u5e8f\u7684\u8bf4\u660e\u6587\u6863\u3002</p> <pre><code>/**\n\u7b2c\u4e00\u4e2aJava\u7a0b\u5e8f\n@author sufangmu\n@version v1.0\n*/\npublic class HelloWorld {\n    public static void main(String[] args) {\n        System.out.println(\"Hello World!\");\n    }\n}\n</code></pre> <p>\u751f\u6210\u6587\u6863</p> <pre><code>javadoc -d mydoc -author -version HelloWorld.java\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E6%A6%82%E8%BF%B0/#api","title":"\u56db\u3001API\u6587\u6863","text":"<p>\u6587\u6863\u5730\u5740\uff1ahttps://docs.oracle.com/javase/8/docs/api/index.html</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/","title":"\u8bed\u6cd5","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#_1","title":"\u4e00\u3001\u5173\u952e\u5b57\u548c\u4fdd\u7559\u5b57","text":"<p>\u5b9a\u4e49\uff1a\u88abJava\u8bed\u8a00\u8d4b\u4e88\u4e86\u7279\u6b8a\u542b\u4e49\uff0c\u7528\u505a\u4e13\u95e8\u7528\u9014\u7684\u5b57\u7b26\u4e32</p> <p>\u7279\u70b9\uff1a\u5173\u952e\u5b57\u4e2d\u6240\u6709\u7684\u5b57\u6bcd\u90fd\u4e3a\u5c0f\u5199</p> <p>\u5b98\u65b9\u5730\u5740\uff1ahttps://docs.oracle.com/javase/tutorial/java/nutsandbolts/_keywords.html</p> \u7c7b\u522b \u5173\u952e\u5b57 \u8bbf\u95ee\u63a7\u5236 private\u3001protected\u3001public\u3001default \u7c7b\u3001\u65b9\u6cd5\u548c\u53d8\u91cf\u4fee\u9970\u7b26 abstract\u3001class\u3001extends\u3001final\u3001implements\u3001interface\u3001native\u3001new\u3001static\u3001strictfp\u3001synchronized\u3001transient\u3001volatile \u7a0b\u5e8f\u63a7\u5236\u8bed\u53e5 break\u3001case\u3001continue\u3001default\u3001do\u3001else\u3001for\u3001if\u3001instanceof\u3001return\u3001switch\u3001while \u9519\u8bef\u5904\u7406 assert\u3001catch\u3001finally\u3001throw\u3001throws\u3001try \u5305\u76f8\u5173 import\u3001package \u57fa\u672c\u7c7b\u578b boolean\u3001byte\u3001char\u3001double\u3001float\u3001int\u3001long\u3001short \u53d8\u91cf\u5f15\u7528 super\u3001this\u3001void \u5b9a\u4e49\u6570\u636e\u7c7b\u578b\u503c\u5f97\u5b57\u9762\u91cf true\u3001false\u3001null \u4fdd\u7559\u5b57\uff08\u73b0\u6709\u7248\u672c\u672a\u4f7f\u7528\uff09 goto\uff0cconst"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#_2","title":"\u4e8c\u3001\u6807\u8bc6\u7b26","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#1","title":"1. \u6982\u5ff5","text":"<p>Java\u5bf9\u5404\u79cd\u53d8\u91cf\uff0c\u65b9\u6cd5\u548c\u7c7b\u7b49\u8981\u7d20\u547d\u540d\u65f6\u4f7f\u7528\u7684\u5b57\u7b26\u5e8f\u5217\u79f0\u4e3a\u6807\u8bc6\u7b26\u3002\u51e1\u662f\u53ef\u4ee5\u81ea\u5df1\u8d77\u540d\u5b57\u7684\u5730\u65b9\u90fd\u53eb\u6807\u8bc6\u7b26\uff0c\u6bd4\u5982\uff1a\u7c7b\u540d\u3001\u53d8\u91cf\u540d\u3001\u65b9\u6cd5\u540d\u3001\u63a5\u53e3\u540d\u3001\u5305\u540d...</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#2","title":"2. \u89c4\u5219","text":"<ol> <li>\u753126\u4e2a\u82f1\u6587\u5b57\u6bcd\u5927\u5c0f\u5199\u30010-9\u3001_\u6216$\u7ec4\u6210</li> <li>\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934</li> <li>\u4e0d\u80fd\u4f7f\u7528\u5173\u952e\u5b57\u548c\u4fdd\u7559\u5b57\uff0c\u4f46\u662f\u53ef\u4ee5\u5305\u542b\u5173\u952e\u5b57\u548c\u4fdd\u7559\u5b57</li> <li>\u5927\u5c0f\u5199\u654f\u611f\uff0c\u957f\u5ea6\u65e0\u9650\u5236</li> <li>\u6807\u8bc6\u7b26\u4e0d\u80fd\u5305\u542b\u7a7a\u683c</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#3","title":"3. \u547d\u540d\u89c4\u8303","text":"<ol> <li>\u5305\u540d\uff1a\u591a\u5355\u8bcd\u7ec4\u6210\u65f6\u6240\u6709\u5b57\u6bcd\u90fd\u5c0f\u5199</li> <li>\u7c7b\u540d\u3001\u63a5\u53e3\u540d\uff1a\u591a\u5355\u8bcd\u7ec4\u6210\u65f6\uff0c\u6240\u6709\u5355\u8bcd\u7684\u9996\u5b57\u6bcd\u5927\u5199</li> <li>\u53d8\u91cf\u540d\u3001\u65b9\u6cd5\u540d\uff1a\u591a\u5355\u8bcd\u7ec4\u6210\u65f6\uff0c\u7b2c\u4e00\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u5c0f\u5199\uff0c\u7b2c\u4e8c\u4e2a\u5355\u8bcd\u5f00\u59cb\u6bcf\u4e2a\u5355\u8bcd\u9996\u5b57\u6bcd\u5927\u5199</li> <li>\u5e38\u91cf\u540d\uff0c\u6240\u6709\u5b57\u6bcd\u90fd\u5927\u5199\uff0c\u591a\u5355\u8bcd\u65f6\u6bcf\u4e2a\u5355\u8bcd\u7528\u4e0b\u5212\u7ebf\u8fde\u63a5</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#_3","title":"\u4e09\u3001\u53d8\u91cf","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#1_1","title":"1. \u6982\u5ff5","text":"<ol> <li>\u5185\u5b58\u4e2d\u7684\u4e00\u4e2a\u5b58\u50a8\u533a\u57df</li> <li>\u8be5\u533a\u57df\u7684\u6570\u636e\u53ef\u4ee5\u518d\u540c\u4e00\u7c7b\u578b\u8303\u56f4\u5185\u4e0d\u65ad\u53d8\u5316</li> <li>\u53d8\u91cf\u662f\u7a0b\u5e8f\u4e2d\u6700\u57fa\u672c\u7684\u5b58\u50a8\u5355\u5143\u3002\u5305\u542b\u53d8\u91cf\u7c7b\u578b\u3001\u53d8\u91cf\u540d\u7684\u5b58\u50a8\u7684\u503c</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#2_1","title":"2. \u4f5c\u7528","text":"<p>\u7528\u4e8e\u5728\u5185\u5b58\u4e2d\u4fdd\u5b58\u6570\u636e</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#3_1","title":"3. \u4f7f\u7528\u6ce8\u610f","text":"<ol> <li>\u6bcf\u4e2a\u53d8\u91cf\u5fc5\u987b\u5148\u58f0\u660e\u540e\u4f7f\u7528</li> <li>\u4f7f\u7528\u53d8\u91cf\u540d\u6765\u8bbf\u95ee\u8fd9\u5757\u533a\u57df\u7684\u6570\u636e</li> <li>\u53d8\u91cf\u7684\u4f5c\u7528\u57df\uff1a\u5176\u5b9a\u4e49\u6240\u5728\u7684\u4e00\u5bf9<code>{}</code>\u5185</li> <li>\u53d8\u91cf\u53ea\u6709\u5728\u5176\u4f5c\u7528\u57df\u5185\u624d\u6709\u6548</li> <li>\u540c\u4e00\u4e2a\u4f5c\u7528\u57df\u5185\uff0c\u4e0d\u80fd\u5b9a\u4e49\u91cd\u540d\u7684\u53d8\u91cf</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#4","title":"4. \u5b9a\u4e49\u53d8\u91cf\u7684\u683c\u5f0f","text":"<pre><code>\u6570\u636e\u7c7b\u578b \u53d8\u91cf\u540d = \u53d8\u91cf\u503c;\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#5","title":"5. \u53d8\u91cf\u7684\u5206\u7c7b","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#51","title":"5.1 \u6309\u7167\u6570\u636e\u7c7b\u578b\u5206\u7c7b","text":"<ol> <li>\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff088\u79cd\uff09<ol> <li>\u6570\u503c\u578b</li> <li>\u6574\u6570\u7c7b\u578b\uff08byte\u3001short\u3001int\u3001long\uff09</li> <li>\u6d6e\u70b9\u7c7b\u578b\uff08float\u3001double\uff09</li> </ol> </li> <li>\u5b57\u7b26\u578b\uff08char\uff09</li> <li>\u5e03\u5c14\u578b\uff08boolean\uff09</li> <li>\u5f15\u7528\u6570\u636e\u7c7b\u578b</li> <li>\u7c7b\uff08class\uff09</li> <li>\u63a5\u53e3\uff08interface\uff09</li> <li>\u6570\u7ec4\uff08[]\uff09</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#52","title":"5.2 \u6309\u58f0\u660e\u7684\u4f4d\u7f6e\u5206\u7c7b","text":"<ol> <li>\u6210\u5458\u53d8\u91cf</li> <li>\u5b9e\u4f8b\u53d8\u91cf\uff08\u4e0d\u4ee5static\u4fee\u9970\uff09\u5c40\u90e8\u53d8\u91cf</li> <li>\u7c7b\u53d8\u91cf\uff08\u4ee5static\u4fee\u9970\uff09</li> <li>\u5c40\u90e8\u53d8\u91cf</li> <li>\u5f62\u53c2</li> <li>\u65b9\u6cd5\u5c40\u90e8\u53d8\u91cf</li> <li>\u4ee3\u7801\u5757\u5c40\u90e8\u53d8\u91cf</li> </ol> \u7c7b\u578b \u5360\u7528\u7a7a\u95f4 \u8303\u56f4 \u9ed8\u8ba4\u503c <code>byte</code> 1\u5b57\u8282 <code>-128\uff08-2^7\uff09</code>~ <code>127\uff082^7-1\uff09</code> <code>0</code> <code>short</code> 2\u5b57\u8282 <code>-32768(-2^15)</code>~<code>32767(2^15 - 1)</code> <code>0</code> <code>int</code> 4\u5b57\u8282 <code>-2,147,483,648(-2^31)</code>~<code>2,147,483,647(2^31-1)</code> <code>0</code> <code>long</code> 8\u5b57\u8282 <code>-9,223,372,036,854,775,808(-2^63)</code>~<code>9,223,372,036,854,775,807(2^63 -1)</code> <code>0L</code> <code>float</code> 4\u5b57\u8282 <code>1.4E-45</code>~<code>3.4028235E38</code> <code>0.0f</code> <code>double</code> 8\u5b57\u8282 <code>4.9E-324</code>~<code>1.7976931348623157E308</code> <code>0.0d</code> <code>boolean</code> 1\u4f4d <code>true</code> \u6216<code>false</code> <code>false</code> <code>char</code> 2\u5b57\u8282 <code>\\u0000(0)</code>~<code>\\uffff(65535)</code>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#6","title":"6. \u57fa\u672c\u6570\u636e\u7c7b\u578b\u4e4b\u95f4\u7684\u8fd0\u7b97\u89c4\u5219","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#61","title":"6.1 \u81ea\u52a8\u7c7b\u578b\u63d0\u5347","text":"<p>\u6574\u578b\u3001\u5b9e\u578b\uff08\u5e38\u91cf\uff09\u3001\u5b57\u7b26\u578b\u6570\u636e\u53ef\u4ee5\u6df7\u5408\u8fd0\u7b97\u3002\u8fd0\u7b97\u4e2d\uff0c\u4e0d\u540c\u7c7b\u578b\u7684\u6570\u636e\u5148\u8f6c\u5316\u4e3a\u540c\u4e00\u7c7b\u578b\uff0c\u7136\u540e\u8fdb\u884c\u8fd0\u7b97\u3002</p> <p>\u5f53\u5bb9\u91cf\u5c0f\u7684\u6570\u636e\u7c7b\u578b\u7684\u53d8\u91cf\u4e0e\u5bb9\u91cf\u5927\u7684\u6570\u636e\u7c7b\u578b\u7684\u53d8\u91cf\u505a\u8fd0\u7b97\u65f6\uff0c\u7ed3\u679c\u81ea\u52a8\u63d0\u5347\u4e3a\u5bb9\u91cf\u5927\u7684\u6570\u636e\u7c7b\u578b\u3002</p> <p>\u7279\u522b\u7684\uff0c\u5f53byte\u3001char\u3001short\u4e09\u79cd\u7c7b\u578b\u7684\u53d8\u91cf\u505a\u8fd0\u7b97\u65f6\uff0c\u7ed3\u679c\u4e3aint\u578b\u3002</p> <pre><code>// \u4f4e  ------------------------------------&gt;  \u9ad8\n// byte,short,char\u2014&gt; int \u2014&gt; long\u2014&gt; float \u2014&gt; double \n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#62","title":"6.2 \u5f3a\u5236\u7c7b\u578b\u8f6c\u6362","text":"<ol> <li>\u81ea\u52a8\u7c7b\u578b\u63d0\u5347\u7684\u9006\u8fd0\u7b97</li> <li>\u9700\u8981\u4f7f\u7528\u5f3a\u8f6c\u7b26<code>()</code></li> <li>\u53ef\u80fd\u5bfc\u81f4\u7cbe\u5ea6\u635f\u5931</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#7-string","title":"7. <code>String</code>\u7c7b\u578b","text":"<ol> <li>String\u5c5e\u4e8e\u5f15\u7528\u6570\u636e\u7c7b\u578b</li> <li>\u58f0\u660eString\u7c7b\u578b\u53d8\u91cf\u65f6\uff0c\u4f7f\u7528\u4e00\u5bf9<code>\"\"</code></li> <li>String\u53ef\u4ee5\u548c8\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u53d8\u91cf\u505a\u8fd0\u7b97\uff0c\u4e14\u8fd0\u7b97\u53ea\u80fd\u4f7f\u8fde\u63a5\u8fd0\u7b97\u3002</li> </ol> <pre><code>public class HelloWorld {\n    public static void main(String[] args) {\n        String str = \"Hello World!\";\n        System.out.println(str);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#_4","title":"\u56db\u3001\u8fd0\u7b97\u7b26","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#1_2","title":"1. \u7b97\u6570\u8fd0\u7b97\u7b26","text":"<pre><code>public class OperatorTest {\n\n  public static void main(String[] args) {\n     int a = 10;\n     int b = 20;\n     int c = 25;\n     int d = 25;\n     System.out.println(\"a + b = \" + (a + b) ); // a + b = 30\n     System.out.println(\"a - b = \" + (a - b) ); // a - b = -10\n     System.out.println(\"a * b = \" + (a * b) ); // a * b = 200\n     System.out.println(\"b / a = \" + (b / a) ); // b / a = 2\n     System.out.println(\"b % a = \" + (b % a) ); // b % a = 0\n     System.out.println(\"c % a = \" + (c % a) ); // c % a = 5\n     System.out.println(\"a++   = \" +  (a++) ); // a++   = 10\n     System.out.println(\"a--   = \" +  (a--) ); // a--   = 11\n     System.out.println(\"b++   = \" +  (b++) ); // b++   = 20\n     System.out.println(\"++b   = \" +  (++b) ); // ++b   = 22\n  }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#2_2","title":"2. \u8d4b\u503c\u8fd0\u7b97\u7b26","text":"<p>\u8d4b\u503c\uff08<code>=</code>\uff09\u652f\u6301\u8fde\u7eed\u8d4b\u503c</p> <pre><code>public class OperatorTest {\n    public static void main(String[] args) {\n        int a = 10;\n        int b = 15;\n        int c = 20;\n        c = a + b;\n        System.out.println(\"c = a + b c = \" + c ); // c = a + b c = 25 \u7b80\u5355\u8d4b\u503c\n        c += a ;\n        System.out.println(\"c += a c = \" + c ); // c += a c = 35\n        c -= a ;\n        System.out.println(\"c -= a c = \" + c ); // c -= a c = 25\n        c *= a ;\n        System.out.println(\"c *= a c = \" + c ); // c *= a c = 250\n        c /= a ;\n        System.out.println(\"c /= a c = \" + c ); // c /= a c = 25\n        c %= a ;\n        System.out.println(\"c %= a c = \" + c ); // c %= a c = 5\n        c &lt;&lt;= 2 ;\n        System.out.println(\"c &lt;&lt;= 2 c = \" + c ); // c &lt;&lt;= 2 c = 20\n        c &gt;&gt;= 2 ;\n        System.out.println(\"c &gt;&gt;= 2 c = \" + c ); // c &gt;&gt;= 2 c = 5\n        c &gt;&gt;= 2 ;\n        System.out.println(\"c &gt;&gt;= 2 c = \" + c ); // c &gt;&gt;= 2 c = 1\n        c &amp;= a ;\n        System.out.println(\"c &amp;= a c = \" + c ); // c &amp;= a c = 0\n        c ^= a ;\n        System.out.println(\"c ^= a c = \" + c ); // c ^= a c = 10\n        c |= a ;\n        System.out.println(\"c |= a c = \" + c ); // c |= a c = 10\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#3_2","title":"3. \u6bd4\u8f83\u8fd0\u7b97\u7b26\uff08\u5173\u7cfb\u8fd0\u7b97\u7b26\uff09","text":"<p>\u6bd4\u8f83\u8fd0\u7b97\u7b26\u7684\u7ed3\u679c\u662f<code>Boolean</code>\u7c7b\u578b</p> <pre><code>public class OperatorTest {\n    public static void main(String[] args) {\n        int a = 10;\n        int b = 20;\n        System.out.println(\"a == b = \" + (a == b) );  // a == b = false\n        System.out.println(\"a != b = \" + (a != b) );  // a != b = true\n        System.out.println(\"a &gt; b = \" + (a &gt; b) );  // a &gt; b = false\n        System.out.println(\"a &lt; b = \" + (a &lt; b) );  // a &lt; b = true\n        System.out.println(\"b &gt;= a = \" + (b &gt;= a) );  // b &gt;= a = true\n        System.out.println(\"b &lt;= a = \" + (b &lt;= a) );  // b &lt;= a = false\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#4_1","title":"4. \u903b\u8f91\u8fd0\u7b97\u7b26","text":"<p><code>&amp;</code>\uff1a\u903b\u8f91\u4e0e        <code>|</code>\uff1a\u903b\u8f91\u6216   <code>!</code>\uff1a\u903b\u8f91\u975e</p> <p><code>&amp;&amp;</code>\uff1a\u77ed\u8def\u4e0e    <code>||</code>\uff1a\u77ed\u8def\u4e0e   <code>^</code>\uff1a\u903b\u8f91\u5f02\u6216</p> a b a&amp;b a&amp;&amp;b a|b a||b !a a^b true true true true true true false false true false false false true true false true false true false false true true true true false false false false false false true false"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#5_1","title":"5. \u4f4d\u8fd0\u7b97\u7b26","text":"<pre><code>public class OperatorTest {\n  public static void main(String[] args) {\n     int a = 60; /* 60 = 0011 1100 */ \n     int b = 13; /* 13 = 0000 1101 */\n     int c = 0;\n     c = a &amp; b;       /* 12 = 0000 1100 */\n     System.out.println(\"a &amp; b = \" + c ); // a &amp; b = 12\n\n     c = a | b;       /* 61 = 0011 1101 */\n     System.out.println(\"a | b = \" + c ); // a | b = 61\n\n     c = a ^ b;       /* 49 = 0011 0001 */\n     System.out.println(\"a ^ b = \" + c ); // a ^ b = 49\n\n     c = ~a;          /*-61 = 1100 0011 */\n     System.out.println(\"~a = \" + c );  // ~a = -61\n\n     c = a &lt;&lt; 2;     /* 240 = 1111 0000 */\n     System.out.println(\"a &lt;&lt; 2 = \" + c ); // a &lt;&lt; 2 = 240\n\n     c = a &gt;&gt; 2;     /* 15 = 1111 */\n     System.out.println(\"a &gt;&gt; 2  = \" + c ); // a &gt;&gt; 2  = 15\n\n     c = a &gt;&gt;&gt; 2;     /* 15 = 0000 1111 */\n     System.out.println(\"a &gt;&gt;&gt; 2 = \" + c ); // a &gt;&gt;&gt; 2 = 15 \u65e0\u7b26\u53f7\u53f3\u79fb\n  }\n} \n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#6_1","title":"6. \u4e09\u5143\u8fd0\u7b97\u7b26","text":"<p>\u683c\u5f0f\uff1a<code>(\u6761\u4ef6\u8868\u8fbe\u5f0f)?\u8868\u8fbe\u5f0f1:\u8868\u8fbe\u5f0f2;</code></p> <p>\u8bf4\u660e\uff1a</p> <ol> <li>\u6761\u4ef6\u8868\u8fbe\u5f0f\u7684\u7ed3\u679c\u4e3aboolbean\u7c7b\u578b</li> <li>\u6839\u636e\u6761\u4ef6\u8868\u8fbe\u5f0f\u771f\u6216\u5047\uff0c\u51b3\u5b9a\u6267\u884c\u8868\u8fbe\u5f0f1\u8fd8\u662f\u8868\u8fbe\u5f0f2</li> <li>\u51e1\u662f\u53ef\u4ee5\u4f7f\u7528\u4e09\u5143\u8fd0\u7b97\u7b26\u7684\u5730\u65b9\u90fd\u53ef\u4ee5\u6539\u5199\u4e3a<code>if...else</code></li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#_5","title":"\u4e94\u3001\u6d41\u7a0b\u63a7\u5236","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#1-if-else","title":"1. <code>if-else</code>","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#11-if","title":"1.1 <code>if</code>","text":"<pre><code>public class IfTest {\n    public static void main(String[] args) {\n        int heartBeats = 79;\n        if (heartBeats &gt; 60 || heartBeats &lt; 100) {\n            System.out.println(\"\u5fc3\u7387\u6b63\u5e38\uff01\");\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#12-ifelse","title":"1.2 <code>if...else...</code>","text":"<pre><code>public class IfTest {\n    public static void main(String[] args) {\n        int age = 21;\n        if (age &lt; 18) {\n            System.out.println(\"\u672a\u6210\u5e74\u4eba\");\n        }else {\n            System.out.println(\"\u6210\u5e74\u4eba\");\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#13-ifelse-ifelse","title":"1.3 <code>if...else if...else...</code>","text":"<pre><code>public class IfTest {\n    public static void main(String[] args) {\n        int score = 61;\n        if (score &gt;= 0 &amp;&amp; score &lt; 60) {\n            System.out.println(\"\u4e0d\u53ca\u683c\");\n        }else if (score &gt; 60 &amp;&amp; score &lt;= 80) {\n            System.out.println(\"\u53ca\u683c\");\n    }else if (score &gt; 80 &amp;&amp; score &lt;= 100) {\n        System.out.println(\"\u4f18\u79c0\");\n        }else\n            System.out.println(\"\u9519\u8bef\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#2-switch-case","title":"2. <code>switch-case</code>","text":"<p>\u8bed\u6cd5\uff1a</p> <pre><code>switch(expression){\n    case value :\n       //\u8bed\u53e5\n       break; //\u53ef\u9009\n    case value :\n       //\u8bed\u53e5\n       break; //\u53ef\u9009\n    //\u4f60\u53ef\u4ee5\u6709\u4efb\u610f\u6570\u91cf\u7684case\u8bed\u53e5\n    default : //\u53ef\u9009\n       //\u8bed\u53e5\n}\n</code></pre> <ol> <li>\u6839\u636e<code>switch</code>\u8868\u8fbe\u5f0f\u4e2d\u7684\u503c\uff0c\u4f9d\u6b21\u5339\u914d\u5404\u4e2acase\u4e2d\u7684\u5e38\u91cf\uff0c\u4e00\u65e6\u5339\u914d\u6210\u529f\u5219\u8fdb\u5165\u76f8\u5e94case\u7ed3\u6784\u4e2d\uff0c\u8c03\u7528\u5176\u6267\u884c\u8bed\u53e5\u3002\u5f53\u8c03\u7528\u5b8c\u6267\u884c\u8bed\u53e5\u4ee5\u540e\uff0c\u5219\u4ecd\u7136\u7ee7\u7eed\u5411\u4e0b\u6267\u884c\u5176\u4ed6case\u7ed3\u6784\u4e2d\u7684\u6267\u884c\u8bed\u53e5\uff0c\u76f4\u5230\u9047\u5230<code>break</code>\u5173\u952e\u5b57\u6216\u6b64<code>switch-case</code>\u7ed3\u6784\u672b\u5c3e\u7ed3\u675f\u4e3a\u6b62\u3002</li> <li><code>break</code>\u53ef\u4ee5\u4f7f\u7528\u5728<code>switch-case</code>\u7ed3\u6784\u4e2d\uff0c\u8868\u793a\u4e00\u65e6\u6267\u884c\u5230\u6b64\u5173\u952e\u5b57\uff0c\u5c31\u8df3\u51fa<code>switch-case</code>\u7ed3\u6784\u3002</li> <li>switch\u7ed3\u6784\u4e2d\u7684\u8868\u8fbe\u5f0f\u53ea\u80fd\u662f\u5982\u4e0b\u76846\u4e2d\u6570\u636e\u7c7b\u578b\u4e4b\u4e00\uff1abyte\u3001short\u3001char\u3001int\u3001String\uff08JDK7.0\u65b0\u589e\uff09\u3001\u679a\u4e3e\uff08JDK5.0\u65b0\u589e\uff09\u3002</li> <li>case\u4e4b\u540e\u53ea\u80fd\u58f0\u660e\u5e38\u91cf\uff0c\u4e0d\u80fd\u58f0\u660e\u8303\u56f4\u3002</li> <li><code>break</code>\u5173\u952e\u5b57\u662f\u53ef\u9009\u7684\u3002</li> <li><code>default:</code>\u76f8\u5bf9\u4e8e<code>if-else</code>\u7ed3\u6784\u4e2d\u7684<code>else</code>\uff0c<code>default</code>\u7ed3\u6784\u662f\u53ef\u9009\u7684\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#3-for","title":"3. <code>for</code>","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#1_3","title":"1. \u5355\u5c42\u5faa\u73af","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>for(\u2460\u521d\u59cb\u5316; \u2461\u5faa\u73af\u6761\u4ef6\uff08\u5e03\u5c14\u8868\u8fbe\u5f0f\uff09; \u2463\u8fed\u4ee3\u6761\u4ef6) {\n    \u2462\u5faa\u73af\u4f53\n}\n</code></pre> <p>\u6267\u884c\u8fc7\u7a0b\uff1a\u2460--&gt; \u2461--&gt;\u2462--&gt;\u2463--&gt;\u2461--&gt;\u2462--&gt;\u2463--&gt;\u2461--&gt;\u2462--&gt;\u2463...--&gt;\u2461</p> <p>\u4f8b1\uff1a\u8f93\u51fa20\u4ee5\u5185\u7684\u5076\u6570\uff1a</p> <pre><code>public class ForTest {\n    public static void main(String[] args) {\n        for (int i = 0; i &lt;= 20; i++) {\n            if (i % 2 == 0) {\n                System.out.println(i);\n            }\n        }\n    } \n}\n</code></pre> <p>\u4f8b2\uff1a\u6c42\u4e24\u4e2a\u6570\u7684\u6700\u5927\u516c\u7ea6\u6570\u548c\u6700\u5c0f\u516c\u500d\u6570</p> <pre><code>public class CommonDivisorAndCommonMultiple {\n    public static void main(String[] args) {\n        int n = 12;\n        int m = 20;\n\n        // \u83b7\u53d6\u6700\u5927\u516c\u7ea6\u6570\n        // 1.\u83b7\u53d6\u4e24\u4e2a\u6570\u4e2d\u7684\u8f83\u5c0f\u503c\n        int min = (m &lt;= n)? m : n;\n        // 2.\u904d\u5386\n        for(int i = min; i &gt;= 1; i--){\n            if(m % i == 0 &amp;&amp; n % i == 0){\n                System.out.println(\"\u6700\u5927\u516c\u7ea6\u6570\u4e3a\uff1a\" + i);\n                break;\n            }\n        }\n\n        // \u83b7\u53d6\u6700\u5927\u516c\u500d\u6570\n        // 1.\u83b7\u53d6\u4e24\u4e2a\u6570\u4e2d\u7684\u6700\u5927\u662f\n        int max = (m &gt;= n)? m : n;\n        // 2.\u904d\u5386\n        for (int i = max; i &lt;= m*n; i++){\n            if(i % m == 0 &amp;&amp; i % n == 0){\n                System.out.println(\"\u6700\u5c0f\u516c\u500d\u6570\uff1a\" + i);\n                break;\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#2_3","title":"2. \u5d4c\u5957\u5faa\u73af","text":"<p>\u6280\u5de7\uff1a\u5185\u5c42\u5faa\u73af\u63a7\u5236\u884c\u6570\uff0c\u5916\u5c42\u5faa\u73af\u63a7\u5236\u5217\u6570</p> <p>\u4f8b1\uff1a\u4e5d\u4e5d\u4e58\u6cd5\u8868</p> <pre><code>public class NineNineMultiplicationTable {\n    public static void main(String[] args) {\n        for(int i = 1; i &lt;= 9; i++){\n            for(int j = 1; j &lt;= i; j++){\n                System.out.print(i + \"*\" + j + \" = \" + i*j + \" \");\n            }\n            System.out.println(\"\");\n        }    \n    }\n}\n</code></pre> <p>\u4f8b2\uff1a\u6253\u5370100\u4ee5\u5185\u7684\u8d28\u6570\uff08\u7d20\u6570\uff0c\u53ea\u80fd\u88ab1\u548c\u4ed6\u672c\u8eab\u6574\u9664\u7684\u81ea\u7136\u6570\uff09\uff1a</p> <p>\u65b9\u6cd5\u4e00\uff1a</p> <pre><code>// \u4ece2\u5f00\u59cb\uff0c\u5230\u8fd9\u4e2a\u6570-1\u7ed3\u675f\u4e3a\u6b62\uff0c\u90fd\u4e0d\u80fd\u88ab\u8fd9\u4e2a\u6570\u672c\u8eab\u6574\u9664\u3002\nclass PrimeNumberTest {\n    public static void main(String[] args){\n        boolean isFlag = true;\n        for(int i = 2; i &lt;= 100; i++){\n            for( int j = 2; j &lt; i; j++){\n                if (i % j == 0){\n                isFlag = false;\n                }\n            }\n            if (isFlag == true){\n                System.out.println(i);\n            }\n            isFlag = true;\n        }\n    }\n}\n</code></pre> <p>\u65b9\u6cd5\u4e8c\uff1a</p> <pre><code>class PrimeNumberTest {\n    public static void main(String[] args){\n        boolean isFlag = true;\n        for(int i = 2; i &lt;= 100; i++){\n        // \u4f18\u5316\u4e8c\uff1a\u5bf9\u672c\u8eab\u662f\u8d28\u6570\u7684\u81ea\u7136\u6570\u662f\u6709\u6548\u7684\n            for( int j = 2; j &lt;= Math.sqrt(i); j++){\n                if (i % j == 0){\n                isFlag = false;\n                break; // \u4f18\u5316\u4e00 : \u53ea\u5bf9\u672c\u8eab\u975e\u8d28\u6570\u7684\u81ea\u7136\u6570\u662f\u6709\u6548\u7684\n                }\n            }\n            if (isFlag == true){\n                System.out.println(i);\n            }\n            isFlag = true;\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#3-foreach","title":"3. <code>foreach</code>","text":"<p>\u589e\u5f3afor\u5faa\u73af</p> <pre><code>import java.util.ArrayList;\nimport java.util.Collection;\n\npublic class IteratorTest {\n    public static void main(String[] args) {\n        Collection collection = new ArrayList();\n        collection.add(\"A\");\n        collection.add(\"123\");\n        collection.add(\"Hello\");\n        // for (\u96c6\u5408\u4e2d\u5143\u7d20\u7684\u7c7b\u578b \u5c40\u90e8\u53d8\u91cf, \u96c6\u5408\u5bf9\u8c61)\n        for (Object obj : collection) {\n            System.out.println(obj);\n        }\n\n        int[] arr = new int[]{1, 2, 3, 4, 5};\n        for (int i : arr) {\n            // \u4ecearr\u4e2d1\u53d6\u51fa\u5143\u7d20\u8d4b\u503c\u7ed9i\uff0c\u5e76\u4e0d\u4f1a\u4fee\u6539\u539f\u6570\u7ec4\n            System.out.println(i);\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#4while","title":"4.<code>while</code>","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>\u2460\u521d\u59cb\u5316\u6761\u4ef6\nwhile(\u2461\u5faa\u73af\u6761\u4ef6) {\n    \u2462\u5faa\u73af\u4f53;\n    \u2463\u8fed\u4ee3\u6761\u4ef6;\n}\n</code></pre> <p>\u6267\u884c\u8fc7\u7a0b\uff1a\u2460--&gt; \u2461--&gt;\u2462--&gt;\u2463--&gt;\u2461--&gt;\u2462--&gt;\u2463--&gt;\u2461--&gt;\u2462--&gt;\u2463...--&gt;\u2461</p> <p>\u4f8b1\uff1a\u8f93\u51fa20\u4ee5\u5185\u7684\u5076\u6570\uff1a</p> <pre><code>public class WhileTest {\n     public static void main(String[] args) {\n         int i = 1;\n         while(i &lt;= 20){\n             if(i % 2 == 0){\n                 System.out.println(i);\n             }\n             i++;\n         }   \n     } \n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#5do-while","title":"5.<code>do-while</code>","text":"<p>\u683c\u5f0f\uff1a</p> <pre><code>\u2460\u521d\u59cb\u5316\u6761\u4ef6\ndo{\n    \u2462\u5faa\u73af\u4f53;\n    \u2463\u8fed\u4ee3\u6761\u4ef6;    \n}while(\u2461\u5faa\u73af\u6761\u4ef6);\n</code></pre> <p>\u6267\u884c\u8fc7\u7a0b\uff1a\u2460--&gt;\u2462--&gt;\u2463--&gt;\u2461--&gt;\u2462--&gt;\u2463--&gt;\u2461...--&gt;\u2461</p> <p>\u4f8b1\uff1a\u8f93\u51fa20\u4ee5\u5185\u7684\u5076\u6570\uff1a</p> <pre><code>public class DoWhileTest {\n     public static void main(String[] args) {\n         int i = 1;\n     do{\n         if(i % 2 == 0){\n             System.out.println(i);\n         }\n         i++;\n      }while(i &lt;= 20);\n     } \n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E8%AF%AD%E6%B3%95/#6breakcontinue","title":"6.<code>break</code>\u548c<code>continue</code>","text":"\u4f7f\u7528\u8303\u56f4 \u5faa\u73af\u4e2d\u7684\u4f5c\u7528\uff08\u4e0d\u540c\u70b9\uff09 \u76f8\u540c\u70b9 break switch-case\u3001\u5faa\u73af\u7ed3\u6784 \u7ed3\u675f\u5f53\u524d\u5faa\u73af \u5173\u952e\u5b57\u540e\u9762\u4e0d\u80fd\u58f0\u660e\u6267\u884c\u8bed\u53e5 continue \u5faa\u73af\u7ed3\u6784 \u7ed3\u675f\u5f53\u6b21\u5faa\u73af \u5173\u952e\u5b57\u540e\u9762\u4e0d\u80fd\u58f0\u660e\u6267\u884c\u8bed\u53e5 <pre><code>public class BreakTest {\n    public static void main(String[] args){\n        for(int i = 1; i &lt;= 4; i++){\n            for(int j = 1; j &lt;= 10; j++){\n                if(j % 4 == 0){\n                    break; // \u9ed8\u8ba4\u8df3\u51fa\u5305\u88f9\u6b64\u5173\u952e\u5b57\u6700\u8fd1\u7684\u4e00\u5c42\u5faa\u73af\n                }\n                System.out.print(j);\n            }\n            System.out.println();\n        }\n    }\n}\n</code></pre> <p>\u7ed3\u675f\u6307\u5b9a\u6807\u7b7e\u7684<code>for</code>\u5faa\u73af</p> <pre><code>public class BreakTest {\n    public static void main(String[] args){\n    label:for(int i = 1; i &lt;= 4; i++){\n            for(int j = 1; j &lt;= 10; j++){\n                if(j % 4 == 0){\n                    break label; //\u7ed3\u675f\u6307\u5b9a\u6807\u8bc6\u7684\u4e00\u5c42\u5faa\u73af\u7ed3\u6784\n                    // continue label; // \u7ed3\u675f\u6307\u5b9a\u6807\u8bc6\u7684\u4e00\u5c42\u5faa\u73af\u7ed3\u6784\u5f53\u6b21\u5faa\u73af\n                }\n                System.out.print(j);\n            }\n        System.out.println();\n        }\n    }\n} \n</code></pre> <p>\u4f8b\uff1a\u6253\u5370100\u4ee5\u5185\u7684\u8d28\u6570</p> <pre><code>class PrimeNumberTest {\n    public static void main(String[] args){\n    label:for(int i = 2; i &lt;= 100; i++){\n            for( int j = 2; j &lt;= Math.sqrt(i); j++){\n                if (i % j == 0){\n                    continue label;\n                }\n            }\n            System.out.println(i);\n        }\n    }\n} \n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/","title":"\u9762\u5411\u5bf9\u8c61\uff08\u4e00\uff09","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_1","title":"\u4e00\u3001\u7c7b\u548c\u5bf9\u8c61","text":"<p>\u7c7b\u662f\u5bf9\u4e00\u7c7b\u4e8b\u7269\u7684\u63cf\u8ff0\uff0c\u662f\u62bd\u8c61\u7684\u3001\u6982\u5ff5\u4e0a\u7684\u5b9a\u4e49</p> <p>\u5bf9\u8c61\u65f6\u5b9e\u9645\u5b58\u5728\u7684\u8be5\u7c7b\u4e8b\u7269\u7684\u6bcf\u4e00\u4e2a\u4e2a\u4f53\uff0c\u4e5f\u79f0\u4e3a\u5b9e\u4f8b</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_2","title":"\u4e8c\u3001\u7c7b\u7684\u6210\u5458","text":"<ol> <li>\u5c5e\u6027\uff1a\u7c7b\u4e2d\u7684\u6210\u5458\u53d8\u91cf</li> <li>\u884c\u4e3a\uff1a\u7c7b\u4e2d\u7684\u6210\u5458\u65b9\u6cd5</li> <li>\u6784\u9020\u5668</li> <li>\u4ee3\u7801\u5757</li> <li>\u5185\u90e8\u7c7b</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_3","title":"\u4e09\u3001\u7c7b\u548c\u5bf9\u8c61\u7684\u521b\u5efa","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#1","title":"1. \u4f7f\u7528\u6b65\u9aa4","text":"<ol> <li>\u521b\u5efa\u7c7b\uff1a\u8bbe\u8ba1\u7c7b\u7684\u6210\u5458</li> <li>\u521b\u5efa\u7c7b\u7684\u5bf9\u8c61</li> <li>\u901a\u8fc7<code>\u5bf9\u8c61.\u5c5e\u6027</code>\u6216<code>\u5bf9\u8c61.\u65b9\u6cd5</code>\u8c03\u7528\u5bf9\u8c61\u7684\u7ed3\u6784</li> </ol> <pre><code>public class PersonTest {\n    public static void main(String[] args) {\n        // \u521b\u5efaPerson\u7c7b\u7684\u5bf9\u8c61(\u5b9e\u4f8b\u5316\u4e00\u4e2a\u7c7b)\n        Person p = new Person();\n        // \u8c03\u7528\u5bf9\u8c61\u7684\u5c5e\u6027 \u5bf9\u8c61.\u5c5e\u6027\n        p.name = \"Tom\";\n        System.out.println(p.name);\n        // \u8c03\u7528\u5bf9\u8c61\u7684\u65b9\u6cd5 \u5bf9\u8c61.\u65b9\u6cd5\n        p.eat();\n        p.talk(\"Chinese\");\n\n    }\n}\n\n\n// \u7c7b\u7684\u521b\u5efa\nclass Person {\n    // \u5c5e\u6027\n    String name;\n    int age;\n    // \u65b9\u6cd5\n    public void eat(){\n        System.out.println(\"eat...\");\n    }\n    public void talk(String language){\n        System.out.println(language);\n    }\n}\n</code></pre> <p>\u5982\u679c\u521b\u5efa\u4e86\u4e00\u4e2a\u7c7b\u7684\u591a\u4e2a\u5bf9\u8c61\uff0c\u5219\u6bcf\u4e2a\u5bf9\u8c61\u90fd\u72ec\u7acb\u7684\u62e5\u6709\u4e00\u5957\u7c7b\u7684\u5c5e\u6027\uff08\u975estatic\u7684\uff09\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#2","title":"2. \u533f\u540d\u5bf9\u8c61","text":"<ol> <li> <p>\u521b\u5efa\u7684\u5bf9\u8c61\u6ca1\u6709\u663e\u5f0f\u7684\u8d4b\u503c\u7ed9\u4e00\u4e2a\u53d8\u91cf</p> </li> <li> <p>\u53ea\u80fd\u8c03\u7528\u4e00\u6b21</p> </li> </ol> <pre><code>public class PhoneTest {\n    public static void main(String[] args) {\n        new Phone().sendMsg();\n        new Phone().playGame();\n        // \u8fd9\u4e2a\u4e24\u4e2a\u4e0d\u540c\u7684\u5bf9\u8c61\n    }\n}\n\nclass Phone{\n    public void sendMsg(){\n        System.out.println(\"\u53d1\u77ed\u4fe1\");\n    }\n    public void playGame(){\n        System.out.println(\"\u73a9\u6e38\u620f\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_4","title":"\u56db\u3001\u5c5e\u6027","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#1_1","title":"1. \u5c5e\u6027\u548c\u5c40\u90e8\u53d8\u91cf\u7684\u533a\u522b","text":"<p>\u76f8\u540c\u70b9\uff1a</p> <ol> <li>\u5b9a\u4e49\u53d8\u91cf\u7684\u683c\u5f0f\uff1a<code>\u6570\u636e\u7c7b\u578b \u53d8\u91cf\u540d = \u53d8\u91cf\u503c</code></li> <li>\u5148\u58f0\u660e\u540e\u4f7f\u7528</li> <li>\u53d8\u91cf\u90fd\u6709\u5176\u5bf9\u5e94\u7684\u4f5c\u7528\u57df</li> </ol> <p>\u4e0d\u540c\u70b9\uff1a</p> <ol> <li>\u5728\u7c7b\u4e2d\u58f0\u660e\u7684\u4f4d\u7f6e\u4e0d\u540c</li> <li>\u5c5e\u6027\uff1a\u76f4\u63a5\u5b9a\u4e49\u5728\u7c7b\u7684\u4e00\u5bf9<code>{}</code>\u5185</li> <li>\u5c40\u90e8\u53d8\u91cf\uff1a\u58f0\u660e\u5728\u65b9\u6cd5\u5185\u3001\u65b9\u6cd5\u5f62\u53c2\u3001\u4ee3\u7801\u5757\u5185\u3001\u6784\u9020\u5668\u5f62\u53c2\u3001\u6784\u9020\u5668\u5185\u90e8\u7684\u53d8\u91cf</li> <li>\u5173\u4e8e\u6743\u9650\u4fee\u9970\u7b26\u7684\u4e0d\u540c</li> <li>\u5c5e\u6027\uff1a\u53ef\u4ee5\u5728\u58f0\u660e\u5c5e\u6027\u65f6\uff0c\u6307\u660e\u5176\u6743\u9650\u3002\u5e38\u7528\u7684\u6743\u9650\u4fee\u9970\u7b26\uff1aprivate\u3001public\u3001\u7f3a\u7701\u3001protected\u3002</li> <li>\u5c40\u90e8\u53d8\u91cf\uff1a\u4e0d\u53ef\u4ee5\u4f7f\u7528\u6743\u9650\u4fee\u9970\u7b26\u3002</li> <li>\u9ed8\u8ba4\u521d\u59cb\u5316\u503c</li> <li>\u5c5e\u6027\uff1a\u6839\u636e\u5176\u7c7b\u578b\uff0c\u90fd\u6709\u9ed8\u8ba4\u521d\u59cb\u5316\u503c</li> <li>\u5c40\u90e8\u53d8\u91cf\uff1a\u6ca1\u6709\u9ed8\u8ba4\u521d\u59cb\u5316\u503c\uff0c\u5728\u8c03\u7528\u5c40\u90e8\u53d8\u91cf\u4e4b\u524d\u4e00\u5b9a\u8981\u663e\u5f0f\u8d4b\u503c\u3002</li> <li>\u5728\u5185\u5b58\u4e2d\u52a0\u8f7d\u7684\u4f4d\u7f6e</li> <li>\u5c5e\u6027\uff1a\u52a0\u8f7d\u5230\u5806\u7a7a\u95f4\u4e2d\uff08\u975estatic\uff09</li> <li>\u5c40\u90e8\u53d8\u91cf\uff1a\u52a0\u8f7d\u5230\u6808\u7a7a\u95f4\u4e2d</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#2_1","title":"2. \u5c5e\u6027\u8d4b\u503c\u7684\u5148\u540e\u987a\u5e8f","text":"<ol> <li>\u9ed8\u8ba4\u521d\u59cb\u5316\uff1a<code>String name;</code></li> <li>\u663e\u5f0f\u521d\u59cb\u5316\uff1a<code>int age = 0;</code>/\u5728\u4ee3\u7801\u5757\u4e2d\u8d4b\u503c</li> <li>\u6784\u9020\u5668\u4e2d\u8d4b\u503c</li> <li><code>\u5bf9\u8c61.\u65b9\u6cd5</code>\u6216<code>\u5bf9\u8c61.\u5c5e\u6027</code></li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_5","title":"\u4e94\u3001\u65b9\u6cd5","text":"<p>\u65b9\u6cd5\uff1a\u63cf\u8ff0\u7c7b\u5e94\u8be5\u5177\u6709\u7684\u529f\u80fd\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#1_2","title":"1. \u65b9\u6cd5\u7684\u58f0\u660e","text":"<pre><code>\u6743\u9650\u4fee\u9970\u7b26 \u8fd4\u56de\u503c\u7c7b\u578b \u65b9\u6cd5\u540d(\u5f62\u53c2\u5217\u8868){\n    \u65b9\u6cd5\u4f53;\n}\n</code></pre> <ol> <li>\u6743\u9650\u4fee\u9970\u7b26\uff084\u79cd\uff09\uff1aprivate\u3001public\u3001\u7f3a\u7701\u3001protected</li> <li>\u8fd4\u56de\u503c</li> <li>\u5982\u679c\u65b9\u6cd5\u6709\u8fd4\u56de\u503c\uff0c\u5219\u5fc5\u987b\u5728\u65b9\u6cd5\u58f0\u660e\u65f6\u6307\u5b9a\u8fd4\u56de\u503c\u7c7b\u578b\uff0c\u540c\u65f6\u65b9\u6cd5\u4e2d\u9700\u8981\u4f7f\u7528<code>return</code>\u5173\u952e\u5b57\u6765\u8fd4\u56de\u6307\u5b9a\u7c7b\u578b\u7684\u53d8\u91cf\u6216\u5e38\u91cf\u3002</li> <li>\u5982\u679c\u65b9\u6cd5\u6ca1\u6709\u8fd4\u56de\u503c\uff0c\u5219\u65b9\u6cd5\u58f0\u660e\u65f6\u4f7f\u7528<code>void</code>\u6765\u8868\u793a\u3002\u901a\u5e38\u5728\u6ca1\u6709\u8fd4\u56de\u503c\u7684\u65b9\u6cd5\u4e2d\uff0c\u5c31\u4e0d\u80fd\u4f7f\u7528<code>return</code>\u5173\u952e\u5b57\uff0c\u5982\u679c\u4f7f\u7528\u7684\u8bdd\u53ea\u80fd\u4f7f\u7528<code>return;</code>\u6765\u8868\u793a\u6b64\u65b9\u6cd5\u7ed3\u675f\u3002</li> <li>\u65b9\u6cd5\u540d\uff1a\u5c5e\u4e8e\u6807\u8bc6\u7b26\uff0c\u9075\u5faa\u6807\u8bc6\u7b26\u7684\u89c4\u5219\u548c\u89c4\u8303\u3002</li> <li>\u5f62\u53c2\u5217\u8868\uff1a\u65b9\u6cd5\u53ef\u4ee5\u58f0\u660e0\u4e2a\u30011\u4e2a\u6216\u591a\u4e2a\u5f62\u53c2\u3002<code>\u6570\u636e\u7c7b\u578b1 \u5f62\u53c21, \u6570\u636e\u7c7b\u578b2 \u5f62\u53c22...</code></li> <li>\u65b9\u6cd5\u4f53\uff1a\u65b9\u6cd5\u529f\u80fd\u7684\u5b9e\u73b0</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#2return","title":"2.<code>return</code>\u5173\u952e\u5b57","text":"<ol> <li>\u4f7f\u7528\u8303\u56f4\uff1a\u4f7f\u7528\u5728\u65b9\u6cd5\u4f53\u4e2d</li> <li>\u4f5c\u7528\uff1a</li> <li>\u7ed3\u675f\u65b9\u6cd5</li> <li>\u9488\u5bf9\u4e8e\u6709\u8fd4\u56de\u503c\u7c7b\u578b\u7684\u65b9\u6cd5\uff0c\u4f7f\u7528<code>return \u6570\u636e</code>\u8fd4\u56de\u6240\u8981\u7684\u6570\u636e\u3002</li> <li>return\u5173\u952e\u5b57\u540e\u9762\u4e0d\u53ef\u4ee5\u58f0\u660e\u6267\u884c\u8bed\u53e5</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#3","title":"3. \u65b9\u6cd5\u7684\u4f7f\u7528","text":"<ol> <li>\u65b9\u6cd5\u5728\u4f7f\u7528\u4e2d\uff0c\u53ef\u4ee5\u8c03\u7528\u5f53\u524d\u7c7b\u7684\u5c5e\u6027\u6216\u65b9\u6cd5</li> <li>\u65b9\u6cd5\u4e2d\u4e0d\u80fd\u5b9a\u4e49\u65b9\u6cd5</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#4","title":"4. \u65b9\u6cd5\u91cd\u8f7d","text":"<p>\u5728\u4e00\u4e2a\u7c7b\u4e2d\uff0c\u5141\u8bb8\u5b58\u5728\u4e00\u4e2a\u4ee5\u4e0a\u7684\u540c\u540d\u65b9\u6cd5\uff0c\u53ea\u8981\u5b83\u4eec\u7684\u53c2\u6570\u4e2a\u6570\u6216\u8005\u53c2\u6570\u7c7b\u578b\u4e0d\u540c\u5373\u53ef\u3002</p> <p>\u4e0e\u8fd4\u56de\u503c\u7c7b\u578b\u65e0\u5173\uff0c\u53ea\u770b\u53c2\u6570\u5217\u8868\uff0c\u4e14\u53c2\u6570\u5217\u8868\u5fc5\u987b\u4e0d\u540c\uff0c\u8c03\u7528\u65f6\uff0c\u6839\u636e\u65b9\u6cd5\u53c2\u6570\u5217\u8868\u7684\u4e0d\u540c\u6765\u533a\u522b\u3002</p> <p>\u5224\u65ad\u65b9\u6cd5\u662f\u5426\u91cd\u8f7d\uff0c\u548c\u65b9\u6cd5\u7684\u6743\u9650\u4fee\u9970\u7b26\u3001\u8fd4\u56de\u503c\u7c7b\u578b\u3001\u5f62\u53c2\u53d8\u91cf\u540d\u3001\u65b9\u6cd5\u4f53\u90fd\u6ca1\u6709\u5173\u7cfb\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#5","title":"5. \u53ef\u53d8\u4e2a\u6570\u7684\u5f62\u53c2","text":"<p>\u5141\u8bb8\u76f4\u63a5\u5b9a\u4e49\u80fd\u548c\u591a\u4e2a\u5b9e\u53c2\u5411\u5339\u914d\u7684\u5f62\u53c2\uff0c\u4ece\u800c\u53ef\u4ee5\u7528\u4e00\u79cd\u66f4\u7b80\u5355\u7684\u65b9\u5f0f\u6765\u4f20\u9012\u4e2a\u6570\u53ef\u53d8\u7684\u5b9e\u53c2\u3002</p> <p>\u683c\u5f0f\uff1a<code>\u6570\u636e\u7c7b\u578b ... \u53d8\u91cf\u540d</code></p> <p>\u5f53\u8c03\u7528\u53ef\u53d8\u4e2a\u6570\u5f62\u53c2\u7684\u65b9\u6cd5\u65f6\uff0c\u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\u53ef\u4ee5\u662f0\u4e2a\uff0c1\u4e2a\u6216\u591a\u4e2a\u3002</p> <p>\u53ef\u53d8\u4e2a\u6570\u5f62\u53c2\u7684\u65b9\u6cd5\u4e0e\u672c\u7c7b\u4e2d\u65b9\u6cd5\u540d\u76f8\u540c\u3001\u5f62\u53c2\u4e0d\u540c\u7684\u65b9\u6cd5\u4e4b\u95f4\u6784\u6210\u91cd\u8f7d\u3002</p> <p>\u53ef\u53d8\u4e2a\u6570\u5f62\u53c2\u5728\u65b9\u6cd5\u7684\u5f62\u53c2\u4e2d\uff0c\u5fc5\u987b\u58f0\u660e\u5728\u672b\u5c3e\u3002</p> <p>\u53ef\u53d8\u4e2a\u6570\u5f62\u53c2\u5728\u65b9\u6cd5\u7684\u5f62\u53c2\u4e2d\uff0c\u6700\u591a\u53ea\u80fd\u58f0\u660e\u4e00\u4e2a\u53ef\u53d8\u5f62\u53c2\u3002</p> <pre><code>public class MethodArgsTest {\n    public static void main(String[] args) {\n        MethodArgsTest test = new MethodArgsTest();\n        test.show(\"Hello\");\n        test.show(\"Hello\", \"World\");\n//        test.show(new String[]{\"Hello\", \"World\"});\n    }\n//    public void show(String[] strs) {\n    public void show(String ... strs){\n        System.out.println(strs);\n        for (int i = 0; i &lt; strs.length; i++) {\n            System.out.println(strs[i]);\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#6","title":"6. \u65b9\u6cd5\u53c2\u6570\u7684\u503c\u4f20\u9012\u673a\u5236","text":"<p>Java\u4e2d\u65b9\u6cd5\u7684\u53c2\u6570\u4f20\u9012\u65b9\u5f0f\u53ea\u6709\u4e00\u79cd\uff1a\u503c\u4f20\u9012\u3002\u5373\u5c06\u5b9e\u9645\u53c2\u6570\u503c\u7684\u526f\u672c\u4f20\u5165\u65b9\u6cd5\u5185\uff0c\u800c\u53c2\u6570\u672c\u8eab\u4e0d\u53d7\u5f71\u54cd\u3002</p> <ol> <li>\u5f62\u53c2\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u5c06\u5b9e\u53c2\u57fa\u672c\u6570\u636e\u7c7b\u578b\u53d8\u91cf\u7684\"\u6570\u636e\u503c\"\u4f20\u9012\u7ed9\u5f62\u53c2</li> <li>\u5f62\u53c2\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u5c06\u5b9e\u53c2\u5f15\u7528\u6570\u636e\u7c7b\u578b\u53d8\u91cf\u7684\"\u5730\u5740\u503c\"\u4f20\u9012\u7ed9\u5f62\u53c2</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#61","title":"6.1 \u65b9\u6cd5\u4e2d\u53d8\u91cf\u7684\u8d4b\u503c\uff1a","text":"<ol> <li> <p>\u5982\u679c\u53d8\u91cf\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u6b64\u65f6\u8d4b\u503c\u7684\u662f\u53d8\u91cf\u6240\u4fdd\u5b58\u7684\u6570\u636e\u503c</p> </li> <li> <p>\u5982\u679c\u53d8\u91cf\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u6b64\u65f6\u8d4b\u503c\u7684\u662f\u53d8\u91cf\u6240\u4fdd\u5b58\u7684\u6570\u636e\u7684\u5730\u5740\u503c\u3002</p> </li> </ol> <pre><code>public class ValueTransferTest {\n    public static void main(String[] args) {\n        int m = 10;\n        int n = m;\n        System.out.println(\"m = \" + m + \", n = \" + n); // m = 10, n = 10\n        n = 20;\n        System.out.println(\"m = \" + m + \", n = \" + n); // m = 10, n = 20\n        User user1 = new User();\n        user1.name = \"Tom\";\n        User user2 = user1; // user1\u548cuser2\u7684\u5730\u5740\u503c\u76f8\u540c\n        System.out.println(\"user1.name = \" + user1.name + \", user2.name = \" + user2.name); // user1.name = Tom, user2.name = Tom\n        user2.name = \"Jerry\";\n        System.out.println(\"user1.name = \" + user1.name + \", user2.name = \" + user2.name); // user1.name = Jerry, user2.name = Jerry\n    }\n}\n\nclass User{\n    String name;\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#62","title":"6.2 \u65b9\u6cd5\u7684\u5f62\u53c2\u503c\u4f20\u9012\u673a\u5236","text":"<ol> <li>\u5f62\u53c2\uff1a\u65b9\u6cd5\u5b9a\u4e49\u65f6\uff0c\u58f0\u660e\u5728\u5c0f\u62ec\u53f7\u5185\u7684\u53c2\u6570</li> <li>\u5b9e\u53c2\uff1a\u65b9\u6cd5\u8c03\u7528\u65f6\u5b9e\u9645\u4f20\u9012\u7ed9\u5f62\u53c2\u7684\u503c\u3002</li> </ol> <p>\u503c\u4f20\u9012\u673a\u5236</p> <ol> <li>\u5982\u679c\u53c2\u6570\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u6b64\u65f6\u5b9e\u53c2\u8d4b\u7ed9\u5f62\u53c2\u7684\u662f\u5b9e\u53c2\u771f\u5b9e\u5b58\u50a8\u7684\u6570\u636e\u503c\u3002</li> <li>\u5982\u679c\u53c2\u6570\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b\uff0c\u6b64\u65f6\u5b9e\u53c2\u8d4b\u7ed9\u5f62\u53c2\u7684\u662f\u5b9e\u53c2\u5b58\u50a8\u6570\u636e\u7684\u5730\u5740\u503c\u3002</li> </ol> <p>\u4f8b\uff1a\u53c2\u6570\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b</p> <pre><code>public class ValueTransferTest {\n    public static void main(String[] args) {\n        int m = 10;\n        int n = 20;\n\n        ValueTransferTest test = new ValueTransferTest();\n        test.swap(m, n);\n\n        System.out.println(\"m = \" + m + \", n = \" + n); // m = 10, n = 20\n\n    }\n\n    public void swap(int m, int n){\n        int tmp = m;\n        m = n;\n        n = tmp;\n    }\n}\n</code></pre> <p>\u4f8b\uff1a\u53c2\u6570\u662f\u5f15\u7528\u6570\u636e\u7c7b\u578b</p> <pre><code>public class ValueTransferTest {\n    public static void main(String[] args) {\n\n        Data data = new Data();\n        data.m = 10;\n        data.n = 20;\n\n        ValueTransferTest test = new ValueTransferTest();\n        test.swap(data);\n        System.out.println(\"m = \" + data.m + \", n = \" + data.n); // m = 20, n = 10\n    }\n    public void swap(Data data){\n        int tmp = data.m;\n        data.m = data.n;\n        data.n = tmp;\n    }\n}\n\nclass Data{\n    int m;\n    int n;\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#7","title":"7. \u9012\u5f52","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#1_3","title":"1. \u9012\u5f52\u6c42\u548c","text":"<pre><code>public class RecursionTest {\n    public static void main(String[] args) {\n        int sum = new RecursionTest().getSum(100);\n        System.out.println(sum);\n    }\n    public int getSum(int n) {\n        if (n == 1){\n            return 1;\n        }else{\n            return n + getSum(n-1);\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#2_2","title":"2. \u6590\u6ce2\u90a3\u5951\u6570\u5217","text":"<pre><code>public class FibonacciTest {\n    public static void main(String[] args) {\n        for (int i = 0; i &lt; 10; i++) {\n            long num = fibanacci(i);\n            System.out.print(num + \" \");\n        }\n    }\n    public static long fibanacci(long number) {\n        if (number == 0 || number == 1){\n            return number;\n        }else{\n            return fibanacci(number -1 ) + fibanacci(number - 2);\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#3_1","title":"3. \u6c49\u8bfa\u5854","text":"<pre><code>// https://blog.csdn.net/ljmingcom304/article/details/50296939\npublic class HanoiTower {\n    public static void hanoi(int n, String a, String b,String c) {\n        if (n == 1) {\n            // \u53ea\u6709\u4e00\u4e2a\u5706\u76d8\u65f6\u76f4\u63a5\u4eceA\u77f3\u67f1\u79fb\u52a8\u5230C\u77f3\u67f1\n            move(n, a, c);\n        } else {\n            // \u5c06\u524dn-1\u4e2a\u5706\u76d8\u4ece\u77f3\u67f1A\u79fb\u52a8\u5230\u77f3\u67f1B\n            hanoi(n - 1, a, c, b);\n            // \u5c06\u7b2cn\u53f7\u5706\u76d8\u4ece\u77f3\u67f1A\u79fb\u52a8\u5230\u77f3\u67f1C\n            move(n, a, c);\n            // \u5c06\u524dn-1\u4e2a\u5706\u76d8\u4ece\u77f3\u67f1B\u79fb\u52a8\u5230\u77f3\u67f1C\n            hanoi(n - 1, b, a, c);\n        }\n    }\n\n    public static void move(int n, String i, String j) {\n        System.out.println(\"\u7b2c\" + n + \"\u4e2a\u5706\u76d8\uff0c\" + \"\u4ece\" + i + \"\u79fb\u52a8\u5230\" + j);\n    }\n\n    public static void main(String[] args) {\n        hanoi(3,\"A\",\"B\",\"C\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_6","title":"\u516d\u3001\u6784\u9020\u5668\uff08\u6784\u9020\u65b9\u6cd5\uff09","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#1_4","title":"1. \u4f5c\u7528","text":"<ol> <li>\u521b\u5efa\u5bf9\u8c61</li> <li>\u521d\u59cb\u5316\u5bf9\u8c61\u7684\u5c5e\u6027</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#2_3","title":"2. \u5b9a\u4e49","text":"<ol> <li>\u5982\u679c\u6ca1\u6709\u663e\u5f0f\u7684\u5b9a\u4e49\u7c7b\u7684\u6784\u9020\u5668\uff0c\u7cfb\u7edf\u9ed8\u8ba4\u63d0\u4f9b\u4e00\u4e2a\u7a7a\u53c2\u7684\u6784\u9020\u5668\u3002</li> <li>\u5b9a\u4e49\u6784\u9020\u5668\u7684\u683c\u5f0f\uff1a<code>\u6743\u9650\u4fee\u9970\u7b26 \u7c7b\u540d(\u5f62\u53c2\u5217\u8868){}</code>\u3002</li> <li>\u4e00\u4e2a\u7c7b\u4e2d\u5b9a\u4e49\u7684\u591a\u4e2a\u6784\u9020\u5668\u5f7c\u6b64\u6784\u6210\u91cd\u8f7d\u3002</li> <li>\u4e00\u65e6\u663e\u5f0f\u7684\u5b9a\u4e49\u4e86\u7c7b\u7684\u6784\u9020\u5668\u4e4b\u540e\uff0c\u7cfb\u7edf\u5c31\u4e0d\u518d\u63d0\u4f9b\u9ed8\u8ba4\u7684\u7a7a\u53c2\u6784\u9020\u5668\u3002</li> <li>\u4e00\u4e2a\u7c7b\u4e2d\u81f3\u5c11\u6709\u4e00\u4e2a\u6784\u9020\u5668\u3002</li> </ol> <pre><code>public class PersonTest {\n    public static void main(String[] args) {\n        // \u521b\u5efa\u7c7b\u7684\u5bf9\u8c61\uff1a new \u6784\u9020\u5668\n        Person p1 = new Person(); // \u8fd9\u662f\u4e00\u4e2a\u7a7a\u53c2\u6784\u9020\u5668\n        Person p2 = new Person(\"Tom\");\n        System.out.println(p2.name); // Tom\n    }\n}\n\nclass Person {\n    String name;\n\n    public Person() {\n        System.out.println(\"\u8fd9\u662f\u4e00\u4e2a\u7a7a\u53c2\u6784\u9020\u5668\");\n    }\n\n    public Person(String n) {\n        name = n;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_7","title":"\u4e03\u3001\u4ee3\u7801\u5757","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#1_5","title":"1. \u9759\u6001\u4ee3\u7801\u5757","text":"<ol> <li>\u5185\u90e8\u53ef\u4ee5\u6709\u8f93\u51fa\u8bed\u53e5</li> <li>\u968f\u7740\u7c7b\u7684\u52a0\u8f7d\u800c\u6267\u884c\uff0c\u53ea\u6267\u884c\u4e00\u6b21</li> <li>\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u591a\u4e2a\u9759\u6001\u4ee3\u7801\u5757\uff0c\u5219\u6309\u7167\u58f0\u660e\u7684\u5148\u540e\u987a\u5e8f\u6267\u884c</li> <li>\u9759\u6001\u4ee3\u7801\u5757\u7684\u6267\u884c\u8981\u4f18\u5148\u4e8e\u9759\u6001\u4ee3\u7801\u5757</li> <li>\u9759\u6001\u4ee3\u7801\u5757\u5185\u53ea\u80fd\u8c03\u7528\u9759\u6001\u7684\u5c5e\u6027\u3001\u65b9\u6cd5\uff0c\u4e0d\u80fd\u8c03\u7528\u975e\u9759\u6001\u7684\u7ed3\u6784</li> <li>\u4f5c\u7528\uff1a\u521d\u59cb\u5316\u7c7b\u7684\u4fe1\u606f</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#2_4","title":"2. \u975e\u9759\u6001\u9759\u6001\u5757","text":"<ol> <li>\u5185\u90e8\u53ef\u4ee5\u6709\u8f93\u51fa\u8bed\u53e5</li> <li>\u968f\u7740\u5bf9\u8c61\u7684\u521b\u5efa\u800c\u6267\u884c</li> <li>\u6bcf\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u5c31\u6267\u884c\u4e00\u6b21\u975e\u9759\u6001\u4ee3\u7801\u5757</li> <li>\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u591a\u4e2a\u975e\u9759\u6001\u4ee3\u7801\u5757\uff0c\u5219\u6309\u7167\u58f0\u660e\u7684\u5148\u540e\u987a\u5e8f\u6267\u884c</li> <li>\u5185\u90e8\u53ef\u4ee5\u8c03\u7528\u9759\u6001\u7684\u5c5e\u6027\u3001\u65b9\u6cd5\uff0c\u6216\u975e\u9759\u6001\u7684\u5c5e\u6027\u3001\u65b9\u6cd5</li> <li>\u4f5c\u7528\uff1a\u53ef\u4ee5\u5728\u521b\u5efa\u5bf9\u8c61\u65f6\uff0c\u5bf9\u5bf9\u8c61\u7684\u5c5e\u6027\u7b49\u8fdb\u884c\u521d\u59cb\u5316</li> </ol> <pre><code>public class CodeBlockTest {\n    public static void main(String[] args) {\n        String nation =  Person.nation; // Hello, static block\n        Person p1 = new Person();  // Hello\n        Person p2 = new Person();  // Hello\n    }\n}\n\nclass Person {\n    String name;\n    int age;\n    static String nation = \"China\";\n    public Person() {\n\n    }\n\n    // \u4ee3\u7801\u5757\n    {\n        System.out.println(\"Hello\");\n    }\n    // \u9759\u6001\u4ee3\u7801\u5757\n    static {\n        System.out.println(\"Hello, static block\");\n    }\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public void show() {\n        System.out.println(\"name:\" + name + \" age:\" + age);\n    }\n\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%80%EF%BC%89/#_8","title":"\u516b\u3001\u5185\u90e8\u7c7b","text":"<p>Java\u4e2d\u5141\u8bb8\u5c06\u4e00\u4e2a\u7c7b\u58f0\u660e\u5728\u53e6\u4e00\u4e2a\u7c7b\u4e2d\uff0c\u524d\u8005\u79f0\u4e3a\u5185\u90e8\u7c7b\uff0c\u540e\u8005\u79f0\u4e3a\u5916\u90e8\u7c7b</p> <p>\u5185\u90e8\u7c7b\u7684\u5206\u7c7b\uff1a</p> <ol> <li>\u6210\u5458\u5185\u90e8\u7c7b\uff1a\u9759\u6001\uff08static\uff09\u3001\u975e\u9759\u6001</li> <li>\u5c40\u90e8\u5185\u90e8\u7c7b\uff1a\u5b9a\u4e49\u5728\u65b9\u6cd5\u5185\u3001\u4ee3\u7801\u5757\u5185\u3001\u6784\u9020\u5668\u5185</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/","title":"\u9762\u5411\u5bf9\u8c61\uff08\u4e09\uff09","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#_1","title":"\u4e00\u3001\u5173\u952e\u5b57\u7684\u4f7f\u7528","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#1-packages","title":"1. <code>packages</code>","text":"<ol> <li>\u4e3a\u4e86\u66f4\u6539\u7684\u5b9e\u73b0\u9879\u76ee\u4e2d\u7c7b\u7684\u7ba1\u7406\u3002</li> <li>\u4f7f\u7528<code>packages</code>\u58f0\u660e\u7c7b\u6216\u63a5\u53e3\u6240\u5c5e\u7684\u5305\uff0c\u58f0\u660e\u5728\u6e90\u6587\u4ef6\u7684\u9996\u884c\u3002</li> <li>\u5305\u5c5e\u4e8e\u6807\u8bc6\u7b26\uff0c\u9075\u5faa\u6807\u8bc6\u7b26\u7684\u547d\u540d\u89c4\u5219\u548c\u89c4\u8303\u3002</li> <li>\u6bcf<code>.</code>\u4e00\u6b21\uff0c\u4ee3\u8868\u4e00\u5c42\u6587\u4ef6\u76ee\u5f55</li> <li>\u540c\u4e00\u4e2a\u5305\u4e0b\u4e0d\u80fd\u547d\u540d\u540c\u540d\u7684\u63a5\u53e3\u3001\u7c7b\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#2-import","title":"2. <code>import</code>","text":"<ol> <li>\u5728\u6e90\u6587\u4ef6\u4e2d\u663e\u5f0f\u7684\u4f7f\u7528<code>import</code>\u7ed3\u6784\u5bfc\u5165\u6307\u5b9a\u5305\u4e0b\u7684\u7c7b\u3001\u63a5\u53e3\u3002</li> <li>\u58f0\u660e\u5728\u5305\u7684\u58f0\u660e\u548c\u7c7b\u7684\u58f0\u660e\u4e4b\u95f4\u3002</li> <li>\u5982\u679c\u9700\u8981\u5bfc\u5165\u591a\u4e2a\u7ed3\u6784\uff0c\u5e76\u5217\u5199\u51fa\u5373\u53ef\u3002</li> <li>\u53ef\u4ee5\u4f7f\u7528<code>xxx.*</code>\u7684\u65b9\u5f0f\uff0c\u8868\u793a\u5bfc\u5165<code>xxx</code>\u5305\u4e0b\u7684\u6240\u6709\u7ed3\u6784\u3002</li> <li>\u5982\u679c\u4f7f\u7528\u7684\u7c7b\u6216\u63a5\u53e3\u662f<code>java.lang</code>\u5305\u4e0b\u5b9a\u4e49\u7684\uff0c\u5219\u53ef\u4ee5\u7701\u7565<code>import</code>\u7ed3\u6784\u3002</li> <li>\u5982\u679c\u5728\u6e90\u6587\u4ef6\u4e2d\u4f7f\u7528\u4e86\u4e0d\u540c\u5305\u4e0b\u540c\u540d\u7684\u7c7b\uff0c\u5219\u5fc5\u987b\u81f3\u5c11\u6709\u4e00\u4e2a\u7c7b\u4f7f\u7528\u5168\u7c7b\u540d\u7684\u65b9\u5f0f\u663e\u793a\u3002</li> <li>\u4f7f\u7528<code>xxx.*</code>\u53ef\u4ee5\u8c03\u7528<code>xxx</code>\u5305\u4e0b\u7684\u6240\u6709\u7ed3\u6784\uff0c\u4f46\u662f\u5982\u679c\u4f7f\u7528\u7684\u662f<code>xxx</code>\u5b50\u5305\u4e0b\u7684\u7ed3\u6784\uff0c\u5219\u4ecd\u9700\u8981\u5bfc\u5165\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#3-static","title":"3. <code>static</code>","text":"<p>\u7528\u6765\u4fee\u9970\u5c5e\u6027\u3001\u65b9\u6cd5\u3001\u4ee3\u7801\u5757\u3001\u5185\u90e8\u7c7b</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#31","title":"3.1 \u4fee\u9970\u5c5e\u6027","text":"<p>\u5c5e\u6027\u6309\u7167\u662f\u5426\u4f7f\u7528static\u4fee\u9970\uff0c\u5206\u4e3a\u9759\u6001\u5c5e\u6027\uff08\u7c7b\u53d8\u91cf\uff09\u548c\u975e\u9759\u6001\u5c5e\u6027\uff08\u5b9e\u4f8b\u53d8\u91cf\uff09\u3002</p> <ol> <li> <p>\u5b9e\u4f8b\u53d8\u91cf\uff1a\u5f53\u521b\u5efa\u4e86\u7c7b\u7684\u591a\u4e2a\u5bf9\u8c61\uff0c\u6bcf\u4e2a\u5bf9\u8c61\u72ec\u7acb\u7684\u62e5\u6709\u4e00\u5957\u7c7b\u4e2d\u7684\u975e\u9759\u6001\u5c5e\u6027\u3002\u5f53\u4fee\u6539\u5176\u4e2d\u4e00\u4e2a\u5bf9\u8c61\u7684\u975e\u9759\u6001\u5c5e\u6027\u65f6\u4e0d\u5bf9\u5bfc\u81f4\u5176\u4ed6\u5bf9\u8c61\u4e2d\u540c\u6837\u5c5e\u6027\u503c\u7684\u4fee\u6539\u3002</p> </li> <li> <p>\u9759\u6001\u53d8\u91cf\uff1a\u5f53\u521b\u5efa\u4e86\u7c7b\u7684\u591a\u4e2a\u5bf9\u8c61\uff0c\u591a\u4e2a\u5bf9\u8c61\u5171\u4eab\u540c\u4e00\u4e2a\u9759\u6001\u53d8\u91cf\uff0c\u5f53\u901a\u8fc7\u67d0\u4e00\u4e2a\u5bf9\u8c61\u4fee\u6539\u9759\u6001\u53d8\u91cf\u65f6\uff0c\u4f1a\u5bfc\u81f4\u5176\u4ed6\u5bf9\u8c61\u8c03\u7528\u6b64\u9759\u6001\u53d8\u91cf\u65f6\u662f\u4fee\u6539\u8fc7\u7684\u3002</p> </li> </ol> <p>\u9759\u6001\u53d8\u91cf\u968f\u7740\u7c7b\u7684\u52a0\u8f7d\u800c\u52a0\u8f7d\u3002\u53ef\u4ee5\u901a\u8fc7<code>\u7c7b.\u9759\u6001\u53d8\u91cf</code>\u7684\u65b9\u6cd5\u8fdb\u884c\u8c03\u7528\u3002</p> <p>\u9759\u6001\u53d8\u91cf\u7684\u52a0\u8f7d\u65e9\u4e0e\u5bf9\u8c61\u7684\u521b\u5efa\u3002</p> <p>\u9759\u6001\u53d8\u91cf\u5728\u5185\u5b58\u4e2d\u53ea\u4f1a\u5b58\u5728\u4e00\u4efd\uff0c\u5b58\u5728\u65b9\u6cd5\u533a\u7684\u9759\u6001\u57df\u4e2d\u3002</p> <pre><code>public class StaticTest {\n    public static void main(String[] args) {\n        System.out.println(Chinese.nation);  // null\n\n        Chinese c1 = new Chinese();\n        c1.nation = \"CHN\";\n        System.out.println(c1.nation);  // CHN\n        Chinese c2 = new Chinese();\n        System.out.println(c2.nation);  // CHN\n    }\n}\n\nclass Chinese{\n    static String nation;\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#32","title":"3.2 \u4fee\u9970\u65b9\u6cd5","text":"<p>\u968f\u7740\u7c7b\u7684\u52a0\u8f7d\u800c\u52a0\u8f7d\uff0c\u53ef\u4ee5\u901a\u8fc7<code>\u7c7b.\u9759\u6001\u65b9\u6cd5</code>\u7684\u65b9\u5f0f\u8c03\u7528\u3002</p> <pre><code>public class StaticTest {\n    public static void main(String[] args) {\n        Chinese.show();\n    }\n}\n\nclass Chinese {\n    public static void show() {\n        System.out.println(\"Hello, China\");  // Hello, China\n    }\n}\n</code></pre> <p>\u9759\u6001\u65b9\u6cd5\u4e2d\u53ea\u80fd\u8c03\u7528\u9759\u6001\u7684\u65b9\u6cd5\u6216\u5c5e\u6027\uff0c\u975e\u9759\u6001\u65b9\u6cd5\u4e2d\uff0c\u65e2\u53ef\u4ee5\u8c03\u7528\u975e\u9759\u6001\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u4e5f\u53ef\u4ee5\u8c03\u7528\u9759\u6001\u7684\u65b9\u6cd5\u548c\u5c5e\u6027\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#35","title":"3.5 \u5355\u4f8b\u6a21\u5f0f","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#1","title":"1. \u997f\u6c49\u5f0f","text":"<pre><code>public class SingletonTest {\n    public static void main(String[] args) {\n        Bank bank1 = Bank.getInstance();\n        Bank bank2 = Bank.getInstance();\n        System.out.println(bank1 == bank2);  // true\n    }\n}\n\n\nclass Bank{\n    // 1. \u79c1\u6709\u5316\u7c7b\u6784\u9020\u5668\n    private Bank(){\n    }\n    // 2. \u5185\u90e8\u521b\u5efa\u7c7b\u5bf9\u8c61\n    // 4.\u8981\u6c42\u6b64\u5bf9\u8c61\u5fc5\u987b\u58f0\u660e\u4e3a\u9759\u6001\u7684\n    private static Bank instance = new Bank();\n\n    // 3. \u63d0\u4f9b\u516c\u5171\u7684\u9759\u6001\u65b9\u6cd5\u8fd4\u56de\u7c7b\u7684\u5bf9\u8c61\n    public static Bank getInstance(){\n        return instance;\n    }\n\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#2","title":"2. \u61d2\u6c49\u5f0f","text":"<pre><code>public class SingletonTest {\n    public static void main(String[] args) {\n        Bank bank1 = Bank.getInstance();\n        Bank bank2 = Bank.getInstance();\n        System.out.println(bank1 == bank2);  // true\n    }\n}\n\n\nclass Bank {\n    // 1. \u79c1\u6709\u5316\u7c7b\u6784\u9020\u5668\n    private Bank() {\n    }\n\n    // 2. \u58f0\u660e\u5f53\u524d\u7c7b\u5bf9\u8c61\uff0c\u6ca1\u6709\u521d\u59cb\u5316\n    // 4. \u6b64\u5bf9\u8c61\u4e5f\u5fc5\u987b\u58f0\u660e\u4e3astatic\n    private static Bank instance = null;\n\n    // 3. \u63d0\u4f9b\u516c\u5171\u7684\u9759\u6001\u65b9\u6cd5\u8fd4\u56de\u7c7b\u7684\u5bf9\u8c61\n    public static synchronized Bank getInstance() {  // synchronized \u7ebf\u7a0b\u5b89\u5168\n        if (instance == null) {\n            instance = new Bank();\n        }\n        return instance;\n    }\n\n}\n</code></pre> <p>\u997f\u6c49\u5f0f\u548c\u61d2\u6c49\u5f0f\u7684\u533a\u522b\uff1a</p> <p>\u61d2\u6c49\u5f0f\uff1a\u5ef6\u8fdf\u5bf9\u8c61\u7684\u521b\u5efa</p> <p>\u997f\u6c49\u5f0f\uff1a\u5bf9\u8c61\u52a0\u8f7d\u65f6\u95f4\u8fc7\u957f\uff0c\u7ebf\u7a0b\u5b89\u5168\u7684</p> <p>\u5f15\u7528\u573a\u666f\uff1a</p> <ol> <li>\u7f51\u7ad9\u7684\u8ba1\u6570\u5668</li> <li>\u5e94\u7528\u7a0b\u5e8f\u7684\u65e5\u5fd7\u5e94\u7528</li> <li>\u6570\u636e\u5e93\u8fde\u63a5\u6c60</li> <li>\u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u7c7b</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#4-final","title":"4. <code>final</code>","text":"<p>\u7528\u6765\u4fee\u6539\u7ed3\u6784\u3001\u7c7b\u3001\u65b9\u6cd5\u3001\u53d8\u91cf</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#41","title":"4.1 \u4fee\u9970\u7c7b","text":"<pre><code>final class TestClass{}\n</code></pre> <p>\u7528\u6765\u4fee\u9970\u4e00\u4e2a\u7c7b\uff0c\u6b64\u7c7b\u4e0d\u80fd\u88ab\u5176\u4ed6\u7c7b\u6240\u7ee7\u627f\u3002\u6bd4\u5982\uff1a<code>String</code>\u7c7b\u3001<code>System</code>\u7c7b\u3001<code>StringBuffer</code>\u7c7b\u7b49\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#42","title":"4.2 \u4fee\u9970\u65b9\u6cd5","text":"<pre><code>public final void func(){}\n</code></pre> <p>\u7528\u6765\u4fee\u9970\u65b9\u6cd5\uff0c\u8868\u540d\u6b64\u65b9\u6cd5\u4e0d\u53ef\u4ee5\u88ab\u91cd\u5199\u3002\u6bd4\u5982<code>Object</code>\u4e2d\u7684<code>getClass()</code></p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#43","title":"4.3 \u4fee\u9970\u53d8\u91cf","text":"<pre><code>final int COUNT = 10;\n</code></pre> <p>\u7528\u6765\u4fee\u9970\u53d8\u91cf\uff0c\u6b64\u65f6\u7684\u201c\u53d8\u91cf\u201d\u5c31\u79f0\u4e3a\u4e00\u4e2a\u5e38\u91cf</p> <ol> <li>\u4fee\u9970\u5c5e\u6027\uff1a\u5728\u663e\u793a\u521d\u59cb\u5316\u3001\u4ee3\u7801\u5757\u4e2d\u3001\u6784\u9020\u5668\u4e2d\u8d4b\u503c</li> <li>\u4fee\u9970\u5c40\u90e8\u53d8\u91cf\uff1a\u4fee\u9970\u5f62\u53c2\u65f6\uff0c\u8868\u793a\u6b64\u5f62\u53c2\u662f\u4e00\u4e2a\u5e38\u91cf\uff0c\u5f53\u8c03\u7528\u6b64\u65b9\u6cd5\u65f6\uff0c\u7ed9\u5e38\u91cf\u5f62\u53c2\u8d4b\u4e00\u4e2a\u5b9e\u53c2\uff0c\u4e00\u65e6\u8d4b\u503c\u4ee5\u540e\uff0c\u5c31\u53ea\u80fd\u5728\u65b9\u6cd5\u4f53\u5185\u4f7f\u7528\u6b64\u5f62\u53c2\uff0c\u4f46\u4e0d\u80fd\u8fdb\u884c\u91cd\u65b0\u8d4b\u503c\u3002</li> </ol> <p><code>static final</code>\u7528\u6765\u4fee\u9970\u5c5e\u6027\uff1a\u5168\u5c40\u5e38\u91cf</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%B8%89%EF%BC%89/#javabean","title":"\u4e8c\u3001JavaBean","text":"<p>\u7b26\u5408\u5982\u4e0b\u6807\u51c6\u7684Java\u7c7b\uff1a</p> <ol> <li>\u7c7b\u662f\u516c\u5171\u7684</li> <li>\u6709\u4e00\u4e2a\u65e0\u53c2\u7684\u516c\u5171\u6784\u9020\u5668</li> <li>\u6709\u5c5e\u6027\uff0c\u4e14\u6709\u5bf9\u5e94\u7684get\u3001set\u65b9\u6cd5</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/","title":"\u9762\u5411\u5bf9\u8c61\uff08\u4e8c\uff09","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#_1","title":"\u4e00\u3001\u5c01\u88c5\u6027","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1","title":"1. \u5c01\u88c5\u6027\u7684\u4f53\u73b0","text":"<p>\u5f53\u521b\u5efa\u4e00\u4e2a\u7c7b\u7684\u5bf9\u8c61\u4ee5\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7<code>\u5bf9\u8c61.\u5c5e\u6027</code>\u7684\u65b9\u5f0f\u5bf9\u5bf9\u8c61\u7684\u5c5e\u6027\u8fdb\u884c\u8d4b\u503c\uff0c\u8fd9\u91cc\u8d4b\u503c\u64cd\u4f5c\u53d7\u5230\u6570\u636e\u7c7b\u578b\u548c\u5b58\u50a8\u8303\u56f4\u7684\u5236\u7ea6\uff0c\u9664\u6b64\u4e4b\u5916\u6ca1\u6709\u5176\u4ed6\u5236\u7ea6\u6761\u4ef6\u3002\u4f46\u662f\u5728\u5b9e\u9645\u95ee\u9898\u4e2d\uff0c\u5f80\u5f80\u9700\u8981\u7ed9\u5c5e\u6027\u8d4b\u503c\u52a0\u5165\u989d\u5916\u7684\u9650\u5236\u6761\u4ef6\uff0c\u8fd9\u4e2a\u6761\u4ef6\u5c31\u4e0d\u80fd\u5728\u5c5e\u6027\u58f0\u660e\u65f6\u4f53\u73b0\uff0c\u6211\u4eec\u53ea\u80fd\u901a\u8fc7\u65b9\u6cd5\u6dfb\u52a0\u9650\u5236\u6761\u4ef6\uff0c\u6bd4\u5982<code>setAge()</code>\u3002\u540c\u65f6\u9700\u8981\u907f\u514d\u7528\u6237\u518d\u4f7f\u7528<code>\u5bf9\u8c61.\u5c5e\u6027</code>\u5bf9\u5c5e\u6027\u8fdb\u884c\u8d4b\u503c\uff0c\u5219\u9700\u8981\u5c06\u5c5e\u6027\u58f0\u660e\u4e3a\u79c1\u6709\u7684\uff08private\uff09\u3002\u540c\u65f6\u63d0\u4f9b\u65b9\u6cd5<code>getAge()</code>\u83b7\u53d6\u5c5e\u6027\u3002\u6b64\u65f6\u5bf9\u4e8e\u5c5e\u6027\u5c31\u4f53\u73b0\u4e86\u5c01\u88c5\u6027\u3002</p> <pre><code>public class AnimalTest {\n    public static void main(String[] args) {\n        Animal cat = new Animal();\n        cat.name = \"Tom\";\n//        cat.age = 5;\n        cat.setAge(5); // \u901a\u8fc7\u65b9\u6cd5\u8d4b\u503c\uff0c\u9a8c\u8bc1\u6570\u636e\u7684\u6709\u6548\u6027\n        cat.show();\n    }\n\n}\n\nclass Animal {\n    String name;\n    //    int age;\n    private int age; // \u901a\u8fc7\u6743\u9650\u4fee\u9970\u7b26\uff0c\u53d8\u6210\u79c1\u6709\u5c5e\u6027\uff08\u5c01\u88c5\u6027\u7684\u4f53\u73b0\uff09\n\n    // \u5c5e\u6027\u7684\u8bbe\u7f6e\n    public void setAge(int a) {\n        if (a &gt; 0) {\n            age = a;\n        } else {\n            age = 0;\n        }\n    }\n\n    // \u5c5e\u6027\u7684\u83b7\u53d6\n    public int getAge() {\n        return age;\n    }\n\n    public void show() {\n        System.out.println(\"name:\" + name + \" age:\" + age);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2","title":"2. \u6743\u9650\u4fee\u9970\u7b26","text":"<p>\u5c01\u88c5\u6027\u7684\u4f53\u73b0\u9700\u8981\u6743\u9650\u4fee\u9970\u7b26\u6765\u914d\u7f6e\u3002</p> \u6743\u9650/\u4f5c\u7528\u57df \u7c7b\u5185\u90e8 \u540c\u4e00\u4e2a\u5305 \u4e0d\u540c\u5305\u7684\u5b50\u7c7b \u540c\u4e00\u4e2a\u5de5\u7a0b <code>private</code> \u221a \u00d7 \u00d7 \u00d7 <code>\u7f3a\u7701</code> \u221a \u221a \u00d7 \u00d7 <code>protected</code> \u221a \u221a \u221a \u00d7 <code>public</code> \u221a \u221a \u221a \u221a <p>\u8fd94\u79cd\u6743\u9650\u53ef\u4ee5\u7528\u6765\u4fee\u4fee\u9970\u7c7b\u53ca\u5185\u90e8\u7ed3\u6784\uff1a\u5c5e\u6027\u3001\u65b9\u6cd5\u3001\u6784\u9020\u5668\u3001\u5185\u90e8\u7c7b\u3002\u4fee\u9970\u7c7b\u7684\u8bdd\u53ea\u80fd\u4f7f\u7528<code>public</code>\u548c<code>\u7f3a\u7701</code>\u3002</p> <pre><code>package com.example.www;\n\npublic class Person {\n    private int personPrivate;\n    int personDefault;\n    protected int personProtected;\n    public int personPublic;\n\n    private void methodPrivate(){\n        personPrivate = 1;\n        personDefault = 2;\n        personProtected = 3;\n        personPublic = 4;\n    }\n    void methodDefault(){\n        personPrivate = 1;\n        personDefault = 2;\n        personProtected = 3;\n        personPublic = 4;\n    }\n    protected void methodProtected(){\n        personPrivate = 1;\n        personDefault = 2;\n        personProtected = 3;\n        personPublic = 4;\n    }\n    public void methodPublic(){\n        personPrivate = 1;\n        personDefault = 2;\n        personProtected = 3;\n        personPublic = 4;\n    }\n}\n</code></pre> <p><code>private</code>\u6d4b\u8bd5</p> <pre><code>package com.example.www;\n\npublic class HelloPerson {\n    public static void main(String[] args) {\n        Person p = new Person();\n\n        // \u540c\u4e00\u4e2a\u5305\u4e2d\u4e0d\u53ef\u4ee5\u8c03\u7528Person\u7c7b\u4e2d\u79c1\u6709\u7684\u5c5e\u6027\u3001\u65b9\u6cd5\n//        p.personPrivate = 1; // java: personPrivate \u5728 com.example.www.Person \u4e2d\u662f private \u8bbf\u95ee\u63a7\u5236\n//        p.methodPrivate(); // java: methodPrivate() \u5728 com.example.www.Person \u4e2d\u662f private \u8bbf\u95ee\u63a7\u5236\n\n        p.personDefault = 2;\n        p.personProtected = 3;\n        p.personPublic = 4;\n\n        p.methodDefault();\n        p.methodProtected();\n        p.methodPublic();\n    }\n}\n</code></pre> <p>\u7f3a\u7701\u6d4b\u8bd5</p> <pre><code>package com.example.api;\n\nimport com.example.www.Person;\n\npublic class Student extends Person {\n    public void methodStudent(){\n        personProtected = 1;\n        personPublic = 2;\n\n        methodProtected();\n        methodPublic();\n//        \u5728\u4e0d\u540c\u5305\u7684\u5b50\u7c7b\u4e2d\u4e0d\u80fd\u8c03\u7528Person\u7c7b\u4e2dprivate\u548c\u7f3a\u7701\u6743\u9650\u7684\u5c5e\u6027\u3001\u65b9\u6cd5\n\n//        personPrivate = 3;\n//        personDefault = 4;\n//        methodPrivate();\n//        methodDefault();\n    }\n}\n</code></pre> <p><code>protected</code>\u6d4b\u8bd5</p> <pre><code>package com.example.web;\n\nimport com.example.www.Person;\n\npublic class HelloWorld {\n    public static void main(String[] args) {\n        Person p = new Person();\n        p.personPublic = 1;\n        p.methodPublic();\n\n//        \u4e0d\u540c\u5305\u4e0b\u7684\u666e\u901a\u7c7b\uff08\u975e\u5b50\u7c7b\uff09\u8981\u4f7f\u7528Person\u7c7b\uff0c\u4e0d\u53ef\u4ee5\u8c03\u7528\u58f0\u660e\u4e3aprivate\u3001protected\u3001\u7f3a\u7701\u6743\u9650\u7684\u5c5e\u6027\u3001\u65b9\u6cd5\n//        p.personPrivate = 2;\n//        p.personDefault = 3;\n//        p.personProtected = 4;\n//\n//        p.methodPrivate();\n//        p.methodDefault();\n//        p.methodProtected();\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#3-this","title":"3. <code>this</code>\u5173\u952e\u5b57","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_1","title":"1. \u4f5c\u7528","text":"<ol> <li>\u53ef\u4ee5\u628a<code>this</code>\u7406\u89e3\u4e3a\u5f53\u524d\u5bf9\u8c61\u6216\u5f53\u524d\u6b63\u5728\u521b\u5efa\u7684\u5bf9\u8c61</li> <li>\u7528\u6765\u8c03\u7528\u5c5e\u6027\u548c\u65b9\u6cd5\u3001\u6784\u9020\u5668</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_1","title":"2. \u4fee\u9970\u5c5e\u6027\u548c\u65b9\u6cd5","text":"<ol> <li>\u5728\u7c7b\u7684\u65b9\u6cd5\uff08\u6216\u6784\u9020\u5668\uff09\u4e2d\u53ef\u4ee5\u4f7f\u7528<code>this.\u5c5e\u6027</code>\u6216<code>this.\u65b9\u6cd5</code>\u7684\u65b9\u5f0f\u8c03\u7528\u8c03\u7528\u5f53\u524d\u5bf9\u8c61\uff08\u6216\u5f53\u524d\u6b63\u5728\u521b\u5efa\u7684\u6c34\u4e0b\uff09\u7684\u5c5e\u6027\u6216\u65b9\u6cd5\u3002\u4f46\u662f\u901a\u5e38\u60c5\u51b5\u4e0b\uff0c\u90fd\u9009\u62e9\u7701\u7565<code>this.</code>\u3002\u7279\u6b8a\u60c5\u51b5\u4e0b\u5982\u679c\u65b9\u6cd5\uff08\u6216\u6784\u9020\u5668\uff09\u7684\u5f62\u53c2\u548c\u7c7b\u7684\u5c5e\u6027\u540c\u540d\uff0c\u5219\u5fc5\u987b\u663e\u5f0f\u7684\u4f7f\u7528<code>this.\u53d8\u91cf</code>\u7684\u65b9\u6cd5\uff0c\u8868\u660e\u6b64\u53d8\u91cf\u662f\u5c5e\u6027\uff0c\u800c\u975e\u5f62\u53c2\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#3","title":"3. \u8c03\u7528\u6784\u9020\u5668","text":"<ol> <li>\u5728\u7c7b\u7684\u6784\u9020\u5668\u4e2d\uff0c\u53ef\u4ee5\u663e\u793a\u7684\u4f7f\u7528<code>this(\u5f62\u53c2\u5217\u8868)</code>\u7684\u65b9\u6cd5\u8c03\u7528\u672c\u7c7b\u4e2d\u6307\u5b9a\u7684\u5176\u4ed6\u6784\u9020\u5668\u3002</li> <li>\u6784\u9020\u5668\u4e2d\u4e0d\u80fd\u901a\u8fc7<code>this(\u5f62\u53c2\u5217\u8868)</code>\u7684\u65b9\u6cd5\u8c03\u7528\u81ea\u5df1\u3002</li> <li>\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u6709n\u4e2a\u6784\u9020\u5668\uff0c\u5219\u6700\u591a\u6709n-1\u4e2a\u6784\u9020\u5668\u4e2d\u4f7f\u7528\u4e86<code>this(\u5f62\u53c2\u5217\u8868)</code>\u3002</li> <li>\u6784\u9020\u5668\u5185\u90e8\u6700\u591a\u53ea\u80fd\u58f0\u660e\u4e00\u4e2a<code>this(\u5f62\u53c2\u5217\u8868)</code>\uff0c\u7528\u6765\u8c03\u7528\u5176\u4ed6\u6784\u9020\u5668\u3002</li> </ol> <pre><code>public class AnimalTest {\n    public static void main(String[] args) {\n        Animal cat = new Animal();\n        cat.name = \"Tom\";\n        cat.setAge(5);\n        cat.show(); // name:Tom age:5\n\n        Animal mouse = new Animal(\"Jerry\", 6);\n        mouse.show(); // name:Jerry age:6\n    }\n\n}\n\nclass Animal {\n    String name;\n    private int age;\n\n    public Animal(){\n\n    }\n    public Animal(String name){\n        this.name = name;\n    }\n    public Animal(String name, int age){\n        this(name);\n        this.age = age;\n    }\n    public void setAge(int age) {\n//        age = age;  // name:Tom age:0\n        this.age = age; // name:Tom age:5\n        // this \u8868\u793a\u5f53\u524d\u5bf9\u8c61\n    }\n\n    public void show() {\n        System.out.println(\"name:\" + name + \" age:\" + age);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#_2","title":"\u4e8c\u3001\u7ee7\u627f\u6027","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_2","title":"1. \u4f5c\u7528","text":"<ol> <li>\u51cf\u5c11\u4ee3\u7801\u5197\u4f59\uff0c\u63d0\u9ad8\u4ee3\u7801\u7684\u590d\u7528\u6027</li> <li>\u4fbf\u4e8e\u529f\u80fd\u6269\u5c55</li> <li>\u4e3a\u591a\u6001\u6027\u7684\u4f7f\u7528\u63d0\u4f9b\u524d\u63d0</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_2","title":"2. \u683c\u5f0f","text":"<pre><code>class A extends B{\n\n}\n</code></pre> <p>A:\u5b50\u7c7b\u3001\u6d3e\u751f\u7c7b\u3001subclass</p> <p>B:\u7236\u7c7b\u3001\u8d85\u7c7b\u3001\u57fa\u7c7b\u3001superclass</p> <p>\u4e00\u65e6\u5b50\u7c7bA\u7ee7\u627f\u7236\u7c7bB\u4e4b\u540e\uff0c\u5b50\u7c7bA\u5c31\u83b7\u53d6\u4e86\u7236\u7c7bB\u4e2d\u58f0\u660e\u7684\u6240\u6709\u5c5e\u6027\u548c\u65b9\u6cd5\u3002\u7236\u7c7b\u4e2d\u58f0\u660e\u7684private\u7684\u5c5e\u6027\u6216\u65b9\u6cd5\uff0c\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u4ee5\u540e\uff0c\u4ecd\u7136\u8ba4\u4e3a\u83b7\u53d6\u4e86\u7236\u7c7b\u4e2d\u79c1\u6709\u7684\u7ed3\u6784\uff0c\u53ea\u662f\u56e0\u4e3a\u5c01\u88c5\u6027\u7684\u5f71\u54cd\uff0c\u4f7f\u5f97\u5b50\u7c7b\u4e0d\u80fd\u76f4\u63a5\u8c03\u7528\u7236\u7c7b\u7684\u7ed3\u6784\u3002</p> <p>\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u4ee5\u540e\uff0c\u8fd8\u53ef\u4ee5\u58f0\u660e\u81ea\u5df1\u7279\u6709\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u5b9e\u73b0\u529f\u80fd\u7684\u6269\u5c55\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#3_1","title":"3. \u7279\u70b9","text":"<ol> <li>\u4e00\u4e2a\u7c7b\u53ef\u4ee5\u88ab\u591a\u4e2a\u5b50\u7c7b\u7ee7\u627f</li> <li>\u5355\u7ee7\u627f\u6027\uff1a\u4e00\u4e2a\u7c7b\u53ea\u80fd\u6709\u4e00\u4e2a\u7236\u7c7b</li> <li>\u5b50\u7236\u7c7b\u662f\u76f8\u5bf9\u7684\u6982\u5ff5</li> <li>\u5b50\u7c7b\u76f4\u63a5\u7ee7\u627f\u7684\u7236\u7c7b\u79f0\u4e3a\u7236\u7c7b\uff0c\u95f4\u63a5\u7ee7\u627f\u7684\u7236\u7c7b\u79f0\u4e3a\u95f4\u63a5\u7236\u7c7b</li> <li>\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u4ee5\u540e\uff0c\u5c31\u83b7\u53d6\u4e86\u7236\u7c7b\u4ee5\u53ca\u6240\u6709\u95f4\u63a5\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u6240\u6709\u5c5e\u6027\u548c\u65b9\u6cd5</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#4","title":"4. \u4f7f\u7528","text":"<p>Person\u7236\u7c7b</p> <pre><code>package com.example.www;\n\npublic class Person {\n    String name;\n    int age;\n    public Person(){\n\n    }\n    public Person(String name, int age){\n        this.name = name;\n        this.age = age;\n    }\n\n    public void eat(){\n        System.out.println(\"eating\");\n    }\n    public void sleep(){\n        System.out.println(\"sleeping\");\n    }\n}\n</code></pre> <p>Student\u5b50\u7c7b</p> <pre><code>package com.example.www;\n\npublic class Student extends Person{\n    String major;\n    public Student() {\n\n    }\n    public Student(String name, int age, String major) {\n        this.name = name;\n        this.age = age;\n        this.major = major;\n    }\n\n    public void study(){\n        System.out.println(\"studying\");\n    }\n\n    public void show(){\n        System.out.println(\"name:\" + name + \" age:\" + age); // \u7ee7\u627f\u4e86\u7236\u7c7b\u7684\u5c5e\u6027\n    }\n}\n</code></pre> <p>\u6d4b\u8bd5</p> <pre><code>package com.example.www;\n\npublic class ExtendsTest {\n    public static void main(String[] args) {\n        Student stu = new Student();\n        stu.name = \"Tom\";\n        stu.age = 16;\n        stu.major = \"English\";\n        stu.study();  // studying\n        stu.show();  // name:Tom age:16\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#5-object","title":"5. <code>Object</code>\u7c7b","text":"<ol> <li>\u5982\u679c\u6ca1\u6709\u663e\u793a\u7684\u58f0\u660e\u4e00\u4e2a\u7c7b\u7684\u7236\u7c7b\uff0c\u6b64\u65f6\u7c7b\u7ee7\u627f\u4e8e<code>java.lang.Object</code>\u7c7b</li> <li>\u6240\u6709java\u7c7b\uff08\u9664<code>java.lang.Object</code>\u4e4b\u5916\uff09\u90fd\u76f4\u63a5\u6216\u95f4\u63a5\u7ee7\u627f\u4e8e<code>java.lang.Object</code>\u7c7b\u3002</li> <li>\u6240\u6709\u7684Java\u7c7b\u90fd\u5177\u6709<code>java.lang.Object</code>\u7c7b\u58f0\u660e\u7684\u529f\u80fd\u3002</li> <li>\u5e38\u7528\u65b9\u6cd5\uff1a<code>equals()</code>\u3001<code>toString()</code>\u3001<code>getClass()</code> \u3001<code>hashCode()</code></li> </ol> <p><code>toString()</code>\u7684\u4f7f\u7528\uff1a</p> <p>\u5f53\u8f93\u51fa\u4e00\u4e2a\u5bf9\u8c61\u7684\u5f15\u7528\u65f6\uff0c\u5b9e\u9645\u4e0a\u662f\u8c03\u7528\u5f53\u524d\u5bf9\u8c61\u7684<code>toString()</code></p> <p><code>Object</code>\u4e2d<code>toString()</code>\u7684\u5b9a\u4e49</p> <pre><code>    public String toString() {\n        return getClass().getName() + \"@\" + Integer.toHexString(hashCode());\n    }\n</code></pre> <p>String\u3001Date\u3001File\u3001\u5305\u88c5\u7c7b\u7b49\u90fd\u91cd\u5199\u4e86<code>Object</code>\u4e2d\u7684<code>toString()</code>\u3002\u4f7f\u5f97\u5728\u8c03\u7528\u5bf9\u8c61\u7684<code>toString()</code>\u65f6\uff0c\u8fd4\u56de\u201c\u5b9e\u4f53\u5185\u5bb9\u4fe1\u606f\u201d\u3002</p> <pre><code>public class HelloWorld {\n    public static void main(String[] args) {\n        Person p = new Person(\"Tom\", 8);\n        System.out.println(p.toString()); // Person@1b6d3586\n        System.out.println(p); // Person@1b6d3586\n\n        String str = new String(\"Hello\");\n        System.out.println(str); // Hello\n    }\n}\n\nclass Person {\n    private String name;\n    private int age;\n\n    public Person() {\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n}\n</code></pre> <p>\u81ea\u5b9a\u4e49\u7c7b\u4e5f\u53ef\u4ee5\u91cd\u5199<code>toString()</code>\u65b9\u6cd5\u3002\u5f53\u8c03\u7528\u6b64\u65b9\u6cd5\u65f6\uff0c\u8fd4\u56de\u5bf9\u8c61\u7684\u201c\u5b9e\u4f53\u5185\u5bb9\u201d\u3002</p> <pre><code>public class HelloWorld {\n    public static void main(String[] args) {\n        Person p = new Person(\"Tom\", 8);\n        System.out.println(p.toString()); // Person{name='Tom', age=8}\n        System.out.println(p); // Person{name='Tom', age=8}\n    }\n}\n\nclass Person {\n    private String name;\n    private int age;\n\n    public Person() {\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    // \u91cd\u5199toString()\n    public String toString() {\n        return \"Person{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n}\n</code></pre> <p>\u5728\u5b9e\u9645\u5f00\u53d1\u4e2d\u5229\u7528IDE\u81ea\u52a8\u751f\u6210\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#6","title":"6. \u65b9\u6cd5\u91cd\u5199","text":"<p>\u5728\u5b50\u7c7b\u4e2d\u6839\u636e\u9700\u8981\u5bf9\u4ece\u7236\u7c7b\u4e2d\u7ee7\u627f\u6765\u7684\u65b9\u6cd5\u8fdb\u884c\u6539\u9020\u3002\u5728\u7a0b\u5e8f\u6267\u884c\u65f6\uff0c\u5b50\u7c7b\u7684\u65b9\u6cd5\u5c06\u8986\u76d6\u7236\u7c7b\u7684\u65b9\u6cd5\u3002</p> <p>\u91cd\u5199\u4ee5\u540e\uff0c\u5f53\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u4ee5\u540e\uff0c\u901a\u8fc7\u5b50\u7c7b\u5bf9\u8c61\u8c03\u7528\u7236\u7c7b\u4e2d\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5\u65f6\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f\u5b50\u7c7b\u91cd\u5199\u7236\u7c7b\u7684\u65b9\u6cd5\u3002</p> <p>\u91cd\u5199\u7684\u89c4\u5b9a\uff1a</p> <ol> <li>\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u65b9\u6cd5\u540d\u548c\u5f62\u53c2\u5217\u8868\u4e0e\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u65b9\u6cd5\u540d\u548c\u5f62\u53c2\u76f8\u540c</li> <li>\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u6743\u9650\u4fee\u9970\u7b26\u4e0d\u5c0f\u4e8e\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u6743\u9650\u4fee\u9970\u7b26\u3002\u7279\u6b8a\u60c5\u51b5\uff1a\u5b50\u7c7b\u4e0d\u80fd\u91cd\u5199\u7236\u7c7b\u4e2d\u58f0\u660e\u4e3aprivate\u6743\u9650\u7684\u65b9\u6cd5\u3002</li> <li>\u8fd4\u56de\u503c\u7c7b\u578b<ol> <li>\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u662fvoid\uff0c\u5219\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u53ea\u80fd\u662fvoid</li> <li>\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u662fA\u7c7b\u578b\uff0c\u5219\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u53ef\u4ee5\u662fA\u7c7b\u6216A\u7c7b\u7684\u5b50\u7c7b\u3002</li> <li>\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff0c\u5219\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u7c7b\u578b\u5fc5\u987b\u662f\u76f8\u540c\u7684\u57fa\u672c\u6570\u636e\u7c7b\u578b</li> </ol> </li> <li>\u5b50\u7c7b\u91cd\u5199\u7684\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38\u7c7b\u578b\u4e0d\u5927\u4e8e\u7236\u7c7b\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u629b\u51fa\u7684\u5f02\u5e38\u7c7b\u578b</li> </ol> <p>\u5b50\u7c7b\u548c\u7236\u7c7b\u4e2d\u7684\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5\u8981\u4e48\u58f0\u660e\u4e3a\u975estatic\u7684\uff08\u8003\u8651\u91cd\u5199\uff09\uff0c\u8981\u4e48\u90fd\u58f0\u660e\u4e3astatic\u7684\uff08\u4e0d\u662f\u91cd\u5199\uff09\u3002</p> <p>Person\u7236\u7c7b</p> <pre><code>package com.example.www;\n\npublic class Person {\n    String name;\n    int age;\n    public Person(){\n\n    }\n    public Person(String name, int age){\n        this.name = name;\n        this.age = age;\n    }\n\n    public void eat(){\n        System.out.println(\"eating\");\n    }\n}\n</code></pre> <p>Student\u5b50\u7c7b</p> <pre><code>package com.example.www;\n\npublic class Student extends Person{\n    String major;\n    public Student() {\n\n    }\n    public Student(String name, int age, String major) {\n        this.name = name;\n        this.age = age;\n        this.major = major;\n    }\n\n    public void eat() { // \u91cd\u65b0\u7236\u7c7b\u7684\u65b9\u6cd5\n        System.out.printf(\"Eat healthy food\");\n    }\n}\n</code></pre> <p>\u6d4b\u8bd5\u7ee7\u627f\u6027</p> <pre><code>package com.example.www;\n\npublic class ExtendsTest {\n    public static void main(String[] args) {\n        Student stu = new Student(\"Tom\", 16, \"English\");\n        stu.eat();  // Eat healthy food\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#7-super","title":"7. <code>super</code>\u5173\u952e\u5b57","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_3","title":"1. \u4f5c\u7528","text":"<p>\u7528\u6765\u8c03\u7528\u7236\u7c7b\u7684\u5c5e\u6027\u3001\u65b9\u6cd5\u3001\u6784\u9020\u5668\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_3","title":"2. \u8c03\u7528\u7236\u7c7b\u7684\u5c5e\u6027\u548c\u65b9\u6cd5","text":"<ol> <li>\u5728\u5b50\u7c7b\u7684\u65b9\u6cd5\u6216\u6784\u9020\u5668\u4e2d\u901a\u8fc7<code>super.\u5c5e\u6027</code>\u6216<code>super.\u65b9\u6cd5</code>\u7684\u65b9\u5f0f\u663e\u5f0f\u7684\u8c03\u7528\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\u6216\u65b9\u6cd5\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\u7701\u7565<code>super.</code>\u3002</li> <li>\u5f53\u5b50\u7c7b\u548c\u7236\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u540c\u540d\u7684\u5c5e\u6027\u65f6\uff0c\u60f3\u8981\u65e9\u5b50\u7c7b\u4e2d\u8c03\u7528\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\u65f6\uff0c\u5219\u5fc5\u987b\u663e\u5f0f\u4f7f\u7528<code>super.\u5c5e\u6027</code>\u7684\u65b9\u5f0f\uff0c\u8868\u660e\u8c03\u7528\u7684\u662f\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\u3002</li> <li>\u5f53\u5b50\u7c7b\u91cd\u5199\u4e86\u7236\u7c7b\u4e2d\u7684\u65b9\u6cd5\u4ee5\u540e\uff0c\u5f53\u60f3\u5728\u5b50\u7c7b\u7684\u65b9\u6cd5\u4e2d\u8c03\u7528\u7236\u7c7b\u4e2d\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u65f6\uff0c\u5219\u5fc5\u987b\u663e\u5f0f\u7684\u4f7f\u7528<code>super.\u65b9\u6cd5</code>\u7684\u65b9\u5f0f\uff0c\u8868\u660e\u8c03\u7528\u7684\u662f\u7236\u7c7b\u4e2d\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#3_2","title":"3. \u8c03\u7528\u6784\u9020\u5668","text":"<ol> <li>\u53ef\u4ee5\u5b50\u7c7b\u7684\u6784\u9020\u5668\u4e2d\u663e\u5f0f\u7684\u4f7f\u7528<code>super(\u5f62\u53c2\u5217\u8868)</code>\u7684\u65b9\u6cd5\uff0c\u8c03\u7528\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u6307\u5b9a\u6784\u9020\u5668</li> <li><code>super(\u5f62\u53c2\u5217\u8868)</code>\u5fc5\u987b\u58f0\u660e\u5728\u5b50\u7c7b\u6784\u9020\u5668\u7684\u9996\u884c</li> <li>\u5728\u7c7b\u7684\u6784\u9020\u5668\u4e2d\uff0c\u9488\u5bf9<code>this(\u5f62\u53c2\u5217\u8868)</code>\u6216<code>super(\u5f62\u53c2\u5217\u8868)</code>\u53ea\u80fd\u4e8c\u9009\u4e00\uff0c\u4e0d\u80fd\u540c\u65f6\u51fa\u73b0</li> <li>\u5728\u6784\u9020\u5668\u7684\u9996\u884c\uff0c\u6ca1\u6709\u663e\u5f0f\u7684\u58f0\u660e<code>this(\u5f62\u53c2\u5217\u8868)</code>\u6216<code>super(\u5f62\u53c2\u5217\u8868)</code>\uff0c\u9ed8\u8ba4\u8c03\u7528\u7684\u662f\u7236\u7c7b\u4e2d\u7684\u7a7a\u53c2\u6784\u9020\u5668\u3002</li> <li>\u5728\u7c7b\u7684\u591a\u4e2a\u6784\u9020\u5668\u4e2d\uff0c\u81f3\u5c11\u6709\u4e00\u4e2a\u7c7b\u7684\u6784\u9020\u5668\u4e2d\u4f7f\u7528\u4e86<code>super(\u5f62\u53c2\u5217\u8868)</code>\u8c03\u7528\u7236\u7c7b\u4e2d\u7684\u6784\u9020\u5668\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#4_1","title":"4. \u793a\u4f8b","text":"<pre><code>package com.example.www;\n\npublic class Person {\n    String name;\n    int age;\n\n    public Person(){\n        System.out.println(\"I am PersonClass\");\n    }\n\n    public Person(String name, int age){\n        this.name = name;\n        this.age = age;\n    }\n\n    public void eat(){\n        System.out.println(\"eating\");\n    }\n}\n</code></pre> <pre><code>package com.example.www;\n\npublic class Student extends Person{\n    String major;\n    public Student(){\n\n    }\n    public Student(String name, int age, String major){\n        super(name, age);\n        this.major = major;\n    }\n    public void eat(){\n        super.eat();\n        System.out.println(\"Eat Healthy food\");\n    }\n}\n</code></pre> <pre><code>package com.example.www;\n\npublic class StudentTest {\n    public static void main(String[] args) {\n        Student stu1 = new Student(\"Tom\", 16, \"English\");\n        stu1.eat();\n//        eating\n//        Eat Healthy food\n        Student stu2 = new Student(); // I am PersonClass \u9ed8\u8ba4\u8c03\u7528\u7684\u662f\u7236\u7c7b\u4e2d\u7684\u7a7a\u53c2\u6784\u9020\u5668\u3002\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#8","title":"8. \u5b50\u7c7b\u5bf9\u8c61\u7684\u5b9e\u4f8b\u5316\u8fc7\u7a0b","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_4","title":"1. \u4ece\u7ed3\u679c\u4e0a\u770b","text":"<ol> <li>\u5b50\u7c7b\u7ee7\u627f\u7236\u7c7b\u4ee5\u540e\uff0c\u5c31\u83b7\u53d6\u4e86\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\u548c\u65b9\u6cd5</li> <li>\u521b\u5efa\u5b50\u7c7b\u7684\u5bf9\u8c61\uff0c\u5728\u5806\u7a7a\u95f4\u4e2d\u4f1a\u52a0\u8f7d\u6240\u6709\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_4","title":"2. \u4ece\u8fc7\u7a0b\u4e0a\u770b","text":"<p>\u5f53\u901a\u8fc7\u5b50\u7c7b\u7684\u6784\u9020\u5668\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4e00\u5b9a\u4f1a\u76f4\u63a5\u6216\u95f4\u63a5\u7684\u8c03\u7528\u5176\u7236\u7c7b\u7684\u6784\u9020\u5668\uff0c\u8fdb\u800c\u8c03\u7528\u7236\u7c7b\u7684\u7236\u7c7b\u7684\u6784\u9020\u5668\uff0c\u76f4\u5230\u8c03\u7528\u4e86<code>java.lang.Object</code>\u7c7b\u4e2d\u7684\u7a7a\u53c2\u6784\u9020\u5668\u4e3a\u6b62\u3002\u6b63\u56e0\u4e3a\u52a0\u8f7d\u8fc7\u6240\u6709\u7236\u7c7b\u7684\u7ed3\u6784\uff0c\u6240\u4ee5\u624d\u53ef\u4ee5\u770b\u5230\u5185\u5b58\u4e2d\u6709\u7236\u7c7b\u7684\u7ed3\u6784\uff0c\u5b50\u7c7b\u5bf9\u8c61\u624d\u53ef\u4ee5\u8003\u8651\u8c03\u7528\u3002</p> <p>\u867d\u7136\u521b\u5efa\u5b50\u7c7b\u5bf9\u8c61\u65f6\uff0c\u8c03\u7528\u4e86\u7236\u7c7b\u7684\u6784\u9020\u5668\uff0c\u4f46\u662f\u81ea\u59cb\u81f3\u7ec8\u53ea\u521b\u5efa\u4e86\u4e00\u4e2a\u5bf9\u8c61\uff0c\u5373new\u7684\u5b50\u7c7b\u5bf9\u8c61\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#_3","title":"\u4e09\u3001\u591a\u6001\u6027","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_5","title":"1. \u591a\u6001\u6027","text":"<p>\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e00\u4e2a\u4e8b\u7269\u7684\u591a\u79cd\u5f62\u6001\u3002\u591a\u6001\u6027\u6307\u7684\u662f\u5bf9\u8c61\u7684\u591a\u6001\u6027\uff1a\u7236\u7c7b\u7684\u5f15\u7528\u6307\u5411\u5b50\u7c7b\u7684\u5bf9\u8c61\uff08\u6216\u5b50\u7c7b\u7684\u5bf9\u8c61\u8d4b\u7ed9\u7236\u7c7b\u7684\u5f15\u7528\uff09\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_5","title":"2. \u591a\u6001\u6027\u7684\u4f7f\u7528","text":"<p>\u6709\u4e86\u5bf9\u8c61\u7684\u591a\u6001\u6027\u4ee5\u540e\uff0c\u5728\u7f16\u8bd1\u5668\u53ea\u80fd\u8c03\u7528\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\uff0c\u5728\u8fd0\u884c\u671f\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f\u5b50\u7c7b\u91cd\u5199\u7236\u7c7b\u7684\u65b9\u6cd5\uff08\u7f16\u8bd1\u770b\u5de6\u53f3\uff0c\u8fd0\u884c\u770b\u53f3\u8fb9\uff09\u3002</p> <p>\u5bf9\u8c61\u7684\u591a\u6001\u6027\u53ea\u9002\u7528\u4e8e\u65b9\u6cd5\uff0c\u4e0d\u9002\u7528\u4e8e\u5c5e\u6027\uff08\u8fb9\u548c\u548c\u8fd0\u884c\u90fd\u770b\u5de6\u8fb9\uff09\u3002</p> <pre><code>//public class AnimalTest {\n//    public static void main(String[] args) {\n//        // \u5bf9\u8c61\u7684\u591a\u6001\u6027\uff1a\u7236\u7c7b\u7684\u5f15\u7528\u6307\u5411\u5b50\u7c7b\u7684\u5bf9\u8c61\n//        Animal a1 = new Cat();\n//        // \u591a\u6001\u7684\u4f7f\u7528\uff0c\u5f53\u8c03\u7528\u5b50\u7236\u7c7b\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5\u65f6\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f\u5b50\u7c7b\u91cd\u5199\u7236\u7c7b\u7684\u65b9\u6cd5 -- \u865a\u62df\u65b9\u6cd5\u8c03\u7528\n//        a1.eat(); // \u5403\u9c7c\n////        a1.catchMouse();  // \u9519\u8bef \u53ea\u80fd\u8c03\u7528Animal\u4e2d\u5b9a\u4e49\u8fc7\u7684\n//    }\n//}\n\npublic class AnimalTest {\n    public static void main(String[] args) {\n        // \u5bf9\u8c61\u7684\u591a\u6001\u6027\uff1a\u7236\u7c7b\u7684\u5f15\u7528\u6307\u5411\u5b50\u7c7b\u7684\u5bf9\u8c61\n        Animal a1 = new Cat();\n//         \u591a\u6001\u7684\u4f7f\u7528\uff0c\u5f53\u8c03\u7528\u5b50\u7236\u7c7b\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5\u65f6\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f\u5b50\u7c7b\u91cd\u5199\u7236\u7c7b\u7684\u65b9\u6cd5 -- \u865a\u62df\u65b9\u6cd5\u8c03\u7528\n        a1.eat(); // \u5403\u9c7c\n//        a1.catchMouse();  // \u9519\u8bef \u53ea\u80fd\u8c03\u7528Animal\u4e2d\u5b9a\u4e49\u8fc7\u7684\n\n\n        // \u591a\u6001\u7684\u4f7f\u7528\n        AnimalTest test = new AnimalTest();\n        test.func(new Cat());  // \u5403\u9c7c\n        test.func(new Dog());  // \u5403\u9aa8\u5934\n\n    }\n\n    public void func(Animal animal) {\n        animal.eat();\n    }\n}\n\nclass Animal {\n    public void eat() {\n        System.out.println(\"\u5403\");\n    }\n}\n\nclass Cat extends Animal {\n    public void eat() {\n        System.out.println(\"\u5403\u9c7c\");\n    }\n\n    public void catchMouse() {\n        System.out.println(\"\u6293\u8001\u9f20\");\n    }\n}\n\nclass Dog extends Animal {\n    public void eat() {\n        System.out.println(\"\u5403\u9aa8\u5934\");\n    }\n\n    public void catcheFrisbee() {\n        System.out.println(\"\u63a5\u98de\u76d8\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#3_3","title":"3. \u591a\u6001\u7684\u4f7f\u7528\u524d\u63d0","text":"<ol> <li>\u7c7b\u7684\u7ee7\u627f\u5173\u7cfb</li> <li>\u65b9\u6cd5\u7684\u91cd\u5199</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#4_2","title":"4. \u865a\u62df\u65b9\u6cd5\u8c03\u7528","text":"<p>\u5b50\u7c7b\u4e2d\u5b9a\u4e49\u4e86\u4e0e\u7236\u7c7b\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5\u3002\u5728\u591a\u6001\u60c5\u51b5\u4e0b\uff0c\u5c06\u6b64\u65f6\u7236\u7c7b\u7684\u65b9\u6cd5\u79f0\u4e3a\u865a\u62df\u65b9\u6cd5\uff0c\u7236\u7c7b\u6839\u636e\u8d4b\u7ed9\u5b83\u7684\u4e0d\u540c\u5b50\u7c7b\u5bf9\u8c61\uff0c\u52a8\u6001\u8c03\u7528\u5c5e\u4e8e\u5b50\u7c7b\u7684\u8be5\u65b9\u6cd5\uff0c\u8fd9\u6837\u7684\u65b9\u6cd5\u8c03\u7528\u65f6\u5728\u7f16\u8bd1\u671f\u65e0\u6cd5\u786e\u5b9a\u7684\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#5","title":"5. \u5411\u4e0a\u8f6c\u578b\u548c\u5411\u4e0b\u8f6c\u578b","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_6","title":"1. \u5411\u4e0b\u8f6c\u578b","text":"<pre><code>package com.example.www;\n\nclass Animal {\n}\n\nclass Cat extends Animal {\n    public void catchMouse() {\n        System.out.println(\"\u6293\u8001\u9f20\");\n    }\n}\n\npublic class HelloWorld {\n    public static void main(String[] args) {\n        Animal a = new Cat();\n        // \u4e0d\u80fd\u8c03\u7528\u5b50\u7c7b\u7279\u6709\u7684\n        a.catchMouse();  // IDEA\u4e2d\u63d0\u793a\uff1aCannot resolve method 'catchMouse' in 'Animal'\n    }\n}\n</code></pre> <p>\u6267\u884c\u7f16\u8bd1\u62a5\u9519</p> <pre><code>HelloWorld.java:13: error: cannot find symbol\n        a.catchMouse();\n         ^\n  symbol:   method catchMouse()\n  location: variable a of type Animal\n1 error\n</code></pre> <p>\u6709\u4e86\u5bf9\u8c61\u7684\u591a\u6001\u6027\u4ee5\u540e\uff0c\u5185\u5b58\u4e2d\u5b9e\u9645\u4e0a\u662f\u52a0\u8f7d\u4e86\u5b50\u7c7b\u7279\u6709\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u7684\uff0c\u4f46\u662f\u7531\u4e8e\u53d8\u91cf\u58f0\u660e\u4e3a\u7236\u7c7b\u7c7b\u578b\uff0c\u5bfc\u81f4\u7f16\u8bd1\u65f6\u53ea\u80fd\u8c03\u7528\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\uff0c\u5b50\u7c7b\u7279\u6709\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u4e0d\u80fd\u8c03\u7528\u3002</p> <p>\u6240\u4ee5\u9700\u8981\u4f7f\u7528\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u7b26\uff08\u5411\u4e0b\u8f6c\u578b\uff09\uff0c\u8fd9\u6837\u5c31\u80fd\u8c03\u7528\u5b50\u7c7b\u7279\u6b8a\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002</p> <pre><code>class Animal {\n}\n\nclass Cat extends Animal {\n    public void catchMouse() {\n        System.out.println(\"\u6293\u8001\u9f20\");\n    }\n}\n\npublic class HelloWorld {\n    public static void main(String[] args) {\n        Animal a = new Cat();\n        Cat tom = (Cat) a;  // \u5411\u4e0b\u8f6c\u578b\uff1a\u4f7f\u7528\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u7b26\n        tom.catchMouse();  // \u6293\u8001\u9f20\n    }\n}\n</code></pre> <p>\u5f53\u8bd5\u56fe\u5c06\u5bf9\u8c61\u5f3a\u5236\u8f6c\u6362\u4e3a\u4e0d\u662f\u5b9e\u4f8b\u7684\u5b50\u7c7b\u65f6\uff0c\u53ef\u80fd\u51fa\u73b0ClassCastException\u7684\u5f02\u5e38\u3002</p> <pre><code>class Animal {\n}\n\nclass Cat extends Animal {\n    public void catchMouse() {\n        System.out.println(\"\u6293\u8001\u9f20\");\n    }\n}\n\nclass Dog extends Animal {\n    public void catcheFrisbee() {\n        System.out.println(\"\u63a5\u98de\u76d8\");\n    }\n}\npublic class HelloWorld {\n    public static void main(String[] args) {\n        Animal a = new Cat();\n        Cat tom = (Cat) a;  // \u5411\u4e0b\u8f6c\u578b\uff1a\u4f7f\u7528\u5f3a\u5236\u7c7b\u578b\u8f6c\u6362\u7b26\n        tom.catchMouse();  // \u6293\u8001\u9f20\n//        Dog Snoopy = (Dog) a;  // Exception in thread \"main\" java.lang.ClassCastException: Cat cannot be cast to Dog\n\n    }\n}\n</code></pre> <p>\u4e3a\u4e86\u907f\u514d\u51fa\u73b0\u8fd9\u6837\u7684\u95ee\u9898\uff0c\u53ef\u4ee5\u4f7f\u7528<code>instanceof</code>\u5173\u952e\u5b57\u3002</p> <p>\u683c\u5f0f\uff1a<code>\u5bf9\u8c61\u540d instanceof \u7c7b\u540d</code>\uff1a\u5224\u65ad\u5bf9\u8c61\u662f\u5426\u662f\u7c7b\u7684\u5b9e\u4f8b\uff0c\u5982\u679c\u662f\u8fd4\u56de<code>true</code>\uff0c\u5426\u5219\u8fd4\u56de<code>false</code></p> <p>\u4f7f\u7528\u573a\u666f\uff1a\u4e3a\u4e86\u907f\u514d\u5728\u5411\u4e0b\u8f6c\u578b\u65f6\u51fa\u73b0\u5f02\u5e38\uff0c\u5728\u5411\u4e0b\u8f6c\u578b\u524d\u4f7f\u7528<code>instanceof</code>\u8fdb\u884c\u5224\u65ad\uff0c\u8fd4\u56de<code>true</code>\u8fdb\u884c\u5411\u4e0b\u8f6c\u578b\u3002</p> <p>\u5982\u679c<code>a instanceof A</code>\u8fd4\u56de<code>true</code>\uff0c<code>a instanceof B</code>\u4e5f\u8fd4\u56de<code>true</code>\uff0c\u5176\u4e2d\u7c7bB\u662f\u7c7bA\u7684\u7236\u7c7b\u3002</p> <pre><code>class Animal {\n}\n\nclass Cat extends Animal {\n    public void catchMouse() {\n        System.out.println(\"\u6293\u8001\u9f20\");\n    }\n}\n\nclass Dog extends Animal {\n    public void catchFrisbee() {\n        System.out.println(\"\u63a5\u98de\u76d8\");\n    }\n}\n\npublic class HelloWorld {\n    public static void main(String[] args) {\n        HelloWorld test = new HelloWorld();\n        test.func(new Cat());  // \u6293\u8001\u9f20\n        test.func(new Dog());  // \u63a5\u98de\u76d8\n\n    }\n\n    public void func(Animal animal) {\n        if (animal instanceof Cat) {\n            Cat a = (Cat) animal;\n            a.catchMouse();\n        }\n        if (animal instanceof Dog) {\n            Dog a = (Dog) animal;\n            a.catchFrisbee();\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#_4","title":"\u56db\u3001\u5305\u88c5\u7c7b","text":"<p>\u9488\u5bf98\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u5b9a\u4e49\u76f8\u5e94\u7684\u5f15\u7528\u6570\u636e\u7c7b\u578b--\u5305\u88c5\u7c7b\uff08\u5c01\u88c5\u7c7b\uff09\u3002</p> \u57fa\u672c\u6570\u636e\u7c7b\u578b \u5305\u88c5\u7c7b <code>byte</code> <code>Byte</code> <code>short</code> <code>Short</code> <code>int</code> <code>Integer</code> <code>long</code> <code>Long</code> <code>float</code> <code>Float</code> <code>double</code> <code>Double</code> <code>boolean</code> <code>Boolean</code> <code>char</code> <code>Character</code> <p>Java\u63d0\u4f9b\u4e868\u79cd\u57fa\u672c\u6570\u636e\u7c7b\u578b\u5bf9\u5e94\u7684\u5305\u88c5\u7c7b\uff0c\u4f7f\u5f97\u57fa\u672c\u6570\u636e\u7c7b\u578b\u7684\u53d8\u91cf\u5177\u6709\u7c7b\u7684\u7279\u5f81\u3002</p> <p>\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3001\u5305\u88c5\u7c7b\u3001String\u4e4b\u95f4\u7684\u8f6c\u6362</p> <pre><code>public class WrapperTest {\n    public static void main(String[] args) {\n        // \u57fa\u672c\u6570\u636e\u7c7b\u578b--&gt;\u5305\u88c5\u7c7b\uff1a\u8c03\u7528\u5305\u88c5\u7c7b\u7684\u6784\u9020\u5668\n        int num = 10;\n        Integer i = new Integer(num);\n        System.out.println(i.toString()); // 10\n\n        Integer j = new Integer(\"123\");\n        System.out.println(j.toString()); // 123\n\n        Boolean b1 = new Boolean(true);\n        System.out.println(b1.toString());  // true  \u770b\u6e90\u7801\n        Boolean b2 = new Boolean(\"xxx\");\n        System.out.println(b2.toString());  // false\n\n\n        // \u5305\u88c5\u7c7b--&gt;\u57fa\u672c\u6570\u636e\u7c7b\u578b\uff1a\u8c03\u7528\u5305\u88c5\u7c7b\u7684xxxValue()\n        Integer n = new Integer(12);\n        int m = n.intValue();\n        System.out.println(m + 3);  // 15\n\n        // \u81ea\u52a8\u88c5\u7bb1\u4e0e\u81ea\u52a8\u62c6\u7bb1\uff08JDK5.0\uff09\n        // \u81ea\u52a8\u88c5\u7bb1\uff1a\u57fa\u672c\u6570\u636e\u7c7b\u578b--&gt;\u5305\u88c5\u7c7b\n        int a = 5;\n        Integer b = a;\n        // \u81ea\u52a8\u62c6\u7bb1\uff1a\u5305\u88c5\u7c7b--&gt;\u57fa\u672c\u6570\u636e\u7c7b\u578b\n        int c = b;\n\n\n        // \u57fa\u672c\u6570\u636e\u7c7b\u578b\u3001\u5305\u88c5\u7c7b--&gt;String\n        int k = 10;\n        // \u65b9\u5f0f\u4e00\uff1a\u8fde\u63a5\u8fd0\u7b97\n        String str1 = k + \"\";\n        // \u65b9\u5f0f\u4e8c\uff1a\u8c03\u7528String\u91cd\u8f7d\u5728ValueOf(xxx)\n        float f = 1.23f;\n        String str2 = String.valueOf(f);\n\n\n        // String--&gt;\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3001\u5305\u88c5\u7c7b\n        String s = \"123\";\n        // \u8c03\u7528\u5305\u88c5\u7c7b\u7684parseXxx()\n        int x = Integer.parseInt(s);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#_5","title":"\u4e94\u3001\u62bd\u8c61\u7c7b\u548c\u62bd\u8c61\u65b9\u6cd5","text":"<p><code>abstract</code>\u5173\u952e\u5b57\uff1a</p> <ol> <li>\u7528\u6765\u4fee\u9970\u7c7b\u548c\u65b9\u6cd5\u3002</li> <li>\u4e0d\u80fd\u7528\u6765\u4fee\u9970\u79c1\u6709\u65b9\u6cd5\u3001\u9759\u6001\u65b9\u6cd5\u3001<code>final</code>\u7684\u65b9\u6cd5\u3001<code>final</code>\u7684\u7c7b</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_7","title":"1. \u62bd\u8c61\u7c7b","text":"<ol> <li>\u62bd\u8c61\u7c7b\u4e0d\u80fd\u5b9e\u4f8b\u5316</li> <li>\u62bd\u8c61\u7c7b\u4e2d\u4e00\u5b9a\u6709\u6784\u9020\u5668\uff0c\u4fbf\u4e8e\u5b50\u7c7b\u5b9e\u4f8b\u5316\u65f6\u8c03\u7528</li> <li>\u5f00\u53d1\u4e2d\u90fd\u4f1a\u63d0\u4f9b\u62bd\u8c61\u7c7b\u7684\u5b50\u7c7b\uff0c\u8ba9\u5b50\u7c7b\u5bf9\u8c61\u5b9e\u4f8b\u5316\uff0c\u5b8c\u6210\u76f8\u5173\u7684\u64cd\u4f5c\u3002</li> </ol>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_6","title":"2. \u62bd\u8c61\u65b9\u6cd5","text":"<pre><code>public abstract void func();\n</code></pre> <ol> <li>\u62bd\u8c61\u65b9\u6cd5\u53ea\u65b9\u6cd5\u58f0\u660e\uff0c\u6ca1\u6709\u65b9\u6cd5\u4f53</li> <li>\u5305\u542b\u62bd\u8c61\u65b9\u6cd5\u7684\u7c7b\u4e00\u5b9a\u662f\u62bd\u8c61\u7c7b\uff0c\u53cd\u4e4b\uff0c\u62bd\u8c61\u7c7b\u4e2d\u53ef\u4ee5\u6ca1\u6709\u62bd\u8c61\u65b9\u6cd5</li> <li>\u82e5\u5b50\u7c7b\u91cd\u5199\u4e86\u7236\u7c7b\u4e2d\u7684\u6240\u6709\u62bd\u8c61\u65b9\u6cd5\u540e\uff0c\u6b64\u7c7b\u65b9\u53ef\u5b9e\u4f8b\u5316\u3002\u5982\u679c\u6ca1\u6709\u91cd\u5199\u7236\u7c7b\u6240\u6709\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u6b64\u7c7b\u4e5f\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b</li> </ol> <pre><code>public class AbstractTest {\n    public static void main(String[] args) {\n        Cat Tom = new Cat(\"Tom\", 6);\n        Tom.eat();\n        Dog Snoopy = new Dog(\"Snoopy\", 8);\n        Snoopy.eat();\n    }\n}\n\nabstract class Animal {\n    String name;\n    int age;\n\n    public abstract void eat();\n}\n\nclass Cat extends Animal {\n\n    public Cat(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public void eat() {\n        System.out.println(\"\u5403\u9c7c\");\n    }\n}\n\nclass Dog extends Animal {\n    public Dog(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public void eat() {\n        System.out.println(\"\u5403\u9aa8\u5934\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#3_4","title":"3. \u533f\u540d\u5b50\u7c7b","text":"<pre><code>public class PersonTest {\n    public static void main(String[] args) {\n        // \u521b\u5efa\u4e86\u4e00\u4e2a\u533f\u540d\u5b50\u7c7b\u7684\u5bf9\u8c61:p\n        Person p = new Person(){\n            public void method(){\n            }\n        };\n    }\n}\n\nabstract class Person{\n    public abstract void method();\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#_6","title":"\u516d\u3001\u63a5\u53e3","text":"<p>Java\u4e0d\u652f\u6301\u591a\u91cd\u7ee7\u627f\uff0c\u6709\u4e86\u63a5\u53e3\uff0c\u5c31\u53ef\u4ee5\u5b9e\u73b0\u591a\u91cd\u7ee7\u627f\u7684\u6548\u679c\u3002</p>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#1_8","title":"1. \u4f7f\u7528","text":"<ol> <li>\u4f7f\u7528<code>interface</code>\u5173\u952e\u5b57\u5b9a\u4e49</li> <li>\u63a5\u53e3\u548c\u7c7b\u662f\u5e76\u5217\u7684\u4e24\u4e2a\u7ed3\u6784</li> <li>\u63a5\u53e3\u4e2d\u4e0d\u80fd\u5b9a\u4e49\u6784\u9020\u5668\uff0c\u610f\u5473\u7740\u63a5\u53e3\u4e0d\u53ef\u4ee5\u5b9e\u4f8b\u5316</li> <li>\u63a5\u53e3\u901a\u8fc7\u8ba9\u7c7b\u5b9e\u73b0\uff08<code>implements</code>\uff09\u7684\u65b9\u5f0f\u6765\u4f7f\u7528\uff0c\u5982\u679c\u5b9e\u73b0\u7c7b\u8986\u76d6\u4e86\u63a5\u53e3\u4e2d\u6240\u6709\u7684\u62bd\u8c61\u65b9\u6cd5\uff0c\u5219\u6b64\u7c7b\u5c31\u53ef\u4ee5\u5b9e\u4f8b\u5316</li> <li>\u63a5\u53e3\u7684\u4e3b\u8981\u7528\u9014\u5c31\u662f\u88ab\u5b9e\u73b0\u7c7b\u5b9e\u73b0\uff08\u9762\u5411\u63a5\u53e3\u7f16\u7a0b\uff09</li> <li>\u53ef\u4ee5\u5b9e\u73b0\u591a\u4e2a\u63a5\u53e3\uff0c\u5f25\u8865\u4e86Java\u5355\u7ee7\u627f\u7684\u5c40\u9650\u6027</li> <li>\u63a5\u53e3\u4e0e\u63a5\u53e3\u76f4\u63a5\u53ef\u4ee5\u7ee7\u627f\uff0c\u800c\u4e14\u53ef\u4ee5\u591a\u7ee7\u627f</li> </ol> <pre><code>public class InterfaceTest {\n    public static void main(String[] args) {\n        Plane plane = new Plane();\n        plane.fly();  // \u8d77\u98de...\n        Bullet bullet = new Bullet();\n        bullet.attack();\n    }\n}\n\n// \u5b9a\u4e49\u4e00\u4e2a\u63a5\u53e3\ninterface Flyable {\n    // \u5168\u5c40\u5e38\u91cf\n    public static final int MAX_SPEED = 7900;\n\n    // \u62bd\u8c61\u65b9\u6cd5\n    public abstract void fly();\n}\n\ninterface Attackable {\n    void attack();\n}\n\n\n// \u5b9e\u73b0\u63a5\u53e3\nclass Plane implements Flyable {\n    // \u5b9e\u73b0\u63a5\u53e3\u4e2d\u7684\u65b9\u6cd5\n    public void fly() {\n        System.out.println(\"\u8d77\u98de...\");\n    }\n}\n\n// \u5b9e\u73b0\u591a\u4e2a\u63a5\u53e3\nclass Bullet extends Object implements Flyable, Attackable {\n    public void fly(){\n        System.out.println(\"\u98de\u884c\");\n    }\n    public void attack(){\n        System.out.println(\"\u653b\u51fb\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#2_7","title":"2. \u5b9a\u4e49","text":""},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#21-jdk7","title":"2.1 JDK7\u53ca\u4ee5\u524d","text":"<ol> <li>\u5168\u5c40\u5e38\u91cf\uff1a<code>public static final</code>\u7684\uff0c\u53ef\u4ee5\u4e0d\u5199</li> <li>\u62bd\u8c61\u65b9\u6cd5\uff1a<code>public abstract</code>\u7684</li> </ol> <pre><code>/*\n* \u63a5\u53e3\u7684\u4f7f\u7528\n* 1. \u63a5\u53e3\u5728\u4f7f\u7528\u4e0a\u4e5f\u6ee1\u8db3\u591a\u6001\u6027\n* 2. \u63a5\u53e3\uff0c\u5b9e\u9645\u4e0a\u5c31\u662f\u5b9a\u4e49\u4e86\u4e00\u79cd\u89c4\u8303\n* */\n\npublic class USBTest {\n    public static void main(String[] args) {\n        Computer computer = new Computer();\n        // \u521b\u5efa\u63a5\u53e3\u7684\u975e\u533f\u540d\u5b9e\u73b0\u7c7b\u7684\u975e\u533f\u540d\u5bf9\u8c61\n        Flash flash = new Flash();\n        computer.transferData(flash);\n\n        // \u521b\u5efa\u63a5\u53e3\u7684\u975e\u533f\u540d\u5b9e\u73b0\u7c7b\u7684\u533f\u540d\u5bf9\u8c61\n        computer.transferData(new Printer());\n\n        // \u521b\u5efa\u63a5\u53e3\u7684\u533f\u540d\u5b9e\u73b0\u7c7b\u7684\u975e\u533f\u540d\u5bf9\u8c61\n        USB phone = new USB() {\n            @Override\n            public void start() {\n                System.out.println(\"\u624b\u673a\u5f00\u59cb\u5de5\u4f5c\");\n            }\n\n            @Override\n            public void end() {\n                System.out.println(\"\u624b\u673a\u7ed3\u675f\u5de5\u4f5c\");\n            }\n        };\n        computer.transferData(phone);\n\n        // \u521b\u5efa\u63a5\u53e3\u7684\u533f\u540d\u5b9e\u73b0\u7c7b\u7684\u533f\u540d\u5bf9\u8c61\n\n        computer.transferData(new USB() {\n            @Override\n            public void start() {\n                System.out.println(\"mp3\u5f00\u59cb\u5de5\u4f5c\");\n            }\n\n            @Override\n            public void end() {\n                System.out.println(\"mp3\u7ed3\u675f\u5de5\u4f5c\");\n            }\n        });\n\n\n\n    }\n}\n\n\nclass Computer{\n    public void transferData(USB usb){ // USB usb = new Flash()  \u591a\u6001\u7684\u4f53\u73b0\n        usb.start();\n        System.out.println(\"\u4f20\u8f93\u6570\u636e\");\n        usb.end();\n    }\n}\n\n\ninterface USB{\n    void start();\n    void end();\n}\n\nclass Flash implements USB {\n\n    @Override\n    public void start() {\n        System.out.println(\"U\u76d8\u5f00\u59cb\u5de5\u4f5c\");\n    }\n\n    @Override\n    public void end() {\n        System.out.println(\"U\u76d8\u7ed3\u675f\u5de5\u4f5c\");\n    }\n}\n\nclass Printer implements USB {\n\n    @Override\n    public void start() {\n        System.out.println(\"\u6253\u5370\u673a\u5f00\u59cb\u5de5\u4f5c\");\n    }\n\n    @Override\n    public void end() {\n        System.out.println(\"\u6253\u5370\u673a\u7ed3\u675f\u5de5\u4f5c\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E5%9F%BA%E7%A1%80/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%EF%BC%88%E4%BA%8C%EF%BC%89/#22-jdk8","title":"2.2 JDK8","text":"<ol> <li>\u5168\u5c40\u5e38\u91cf\uff1a<code>public static final</code>\u7684</li> <li>\u62bd\u8c61\u65b9\u6cd5\uff1a<code>public abstract</code>\u7684</li> <li>\u9759\u6001\u65b9\u6cd5</li> <li>\u9ed8\u8ba4\u65b9\u6cd5</li> </ol> <pre><code>// \u9759\u6001\u65b9\u6cd5\u548c\u62bd\u8c61\u65b9\u6cd5\npublic class InterfaceTest {\n    public static void main(String[] args) {\n\n        // 1. \u63a5\u53e3\u4e2d\u5b9a\u4e49\u7684\u9759\u6001\u65b9\u6cd5\uff0c\u53ea\u80fd\u901a\u8fc7\u63a5\u53e3\u6765\u8c03\u7528\n        MyInterface.method1();  // \u9759\u6001\u65b9\u6cd5:method1\n\n        // 2. \u901a\u8fc7\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\uff0c\u53ef\u4ee5\u8c03\u7528\u63a5\u53e3\u4e2d\u7684\u9ed8\u8ba4\u65b9\u6cd5\n        // \u5982\u679c\u5b9e\u73b0\u7c7b\u91cd\u5199\u4e86\u63a5\u53e3\u4e2d\u7684\u9ed8\u8ba4\u65b9\u6cd5\uff0c\u8c03\u7528\u65f6\u4ecd\u7136\u8c03\u7528\u7684\u662f\u91cd\u5199\u540e\u7684\u65b9\u6cd5\n        SubClass obj = new SubClass(); // SubClass:method2\n        obj.method2();\n\n        // 3. \u5982\u679c\u5b50\u7c7b\u6216\u5b9e\u73b0\u7c7b\u7ee7\u627f\u7684\u7236\u7c7b\u548c\u5b9e\u73b0\u7684\u63a5\u53e3\u58f0\u660e\u4e86\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5\n        // \u90a3\u4e48\u5b50\u7c7b\u5728\u6ca1\u6709\u91cd\u5199\u6b64\u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff0c\u9ed8\u8ba4\u8c03\u7528\u7684\u662f\u7236\u7c7b\u4e2d\u7684\u540c\u540d\u540c\u53c2\u6570\u7684\u65b9\u6cd5 -- \u7c7b\u4f18\u5148\u539f\u5219\n        obj.method3(); // SuperClass:method3\n\n        // 4. \u5982\u679c\u5b9e\u73b0\u7c7b\u5b9e\u73b0\u4e86\u591a\u4e2a\u63a5\u53e3\uff0c\u800c\u8fd9\u591a\u4e2a\u63a5\u53e3\u4e2d\u5b9a\u4e49\u4e86\u540c\u540d\u540c\u53c2\u6570\u7684\u9ed8\u8ba4\u65b9\u6cd5\n        // \u90a3\u4e48\u5728\u5b9e\u73b0\u7c7b\u6ca1\u6709\u91cd\u5199\u6b64\u65b9\u6cd5\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u62a5\u9519 -- \u63a5\u53e3\u51b2\u7a81\n        // \u5c31\u5fc5\u987b\u5728\u5b9e\u73b0\u7c7b\u4e2d\u91cd\u65b0\u6b64\u65b9\u6cd5\n\n        obj.method5();\n    }\n}\n\ninterface MyInterface {\n    // \u9759\u6001\u65b9\u6cd5\n\n    public static void method1() {\n        System.out.println(\"\u9759\u6001\u65b9\u6cd5:method1\");\n    }\n\n    // \u9ed8\u8ba4\u65b9\u6cd5\n    public default void method2() {\n        System.out.println(\"\u9ed8\u8ba4\u65b9\u6cd5:method2\");\n    }\n\n    public default void method3() {\n        System.out.println(\"\u9ed8\u8ba4\u65b9\u6cd5:method3\");\n    }\n\n}\n\nclass SuperClass {\n    public void method3() {\n        System.out.println(\"SuperClass:method3\");\n    }\n}\n\nclass SubClass extends SuperClass implements MyInterface {\n    public void method2() {\n        System.out.println(\"SubClass:method2\");\n    }\n\n    // 5. \u5728\u5b50\u7c7b\uff08\u6216\u5b9e\u73b0\u7c7b\uff09\u7684\u65b9\u6cd5\u4e2d\u8c03\u7528\u7236\u7c7b\u3001\u63a5\u53e3\u4e2d\u88ab\u91cd\u5199\u7684\u65b9\u6cd5\n    public void method5(){\n        // \u8c03\u7528\u81ea\u5df1\u5b9a\u4e49\u7684\u91cd\u5199\u7684\u65b9\u6cd5\n        method2();\n        // \u8c03\u7528\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u65b9\u6cd5\n        super.method3();\n        // \u8c03\u7528\u63a5\u53e3\u4e2d\u7684\u9ed8\u8ba4\u65b9\u6cd5\n        MyInterface.method1();\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/","title":"IO\u6d41","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#file","title":"\u4e00\u3001<code>File</code>","text":"<p><code>File</code>\u7c7b\u7684\u4e00\u4e2a\u5bf9\u8c61\uff0c\u4ee3\u8868\u4e00\u4e2a\u6587\u4ef6\u6216\u76ee\u5f55.</p> <p><code>File</code>\u7c7b\u4e2d\u6d89\u53ca\u5230\u5173\u4e8e\u6587\u4ef6\u6216\u76ee\u5f55\u7684\u521b\u5efa\u3001\u5220\u9664\u3001\u91cd\u547d\u540d\u3001\u4fee\u6539\u65f6\u95f4\u3001\u6587\u4ef6\u5927\u5c0f\u7b49\u65b9\u6cd5\uff0c\u5e76\u672a\u6d89\u53ca\u5230\u5199\u5165\u6216\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u7684\u64cd\u4f5c\uff0c\u5982\u679c\u9700\u8981\u8bfb\u53d6\u6216\u5199\u5165\u6587\u4ef6\u5185\u5bb9\uff0c\u5fc5\u987b\u4f7f\u7528IO\u6d41\u6765\u5b8c\u6210\u3002</p> <p><code>File</code>\u7c7b\u7684\u5bf9\u8c61\u5e38\u4f1a\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230\u6d41\u7684\u6784\u9020\u5668\u4e2d\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#1","title":"1. \u5b9e\u4f8b\u5316","text":"<pre><code>import java.io.File;\n\npublic class FileTest {\n    public static void main(String[] args) {\n        // \u521b\u5efaFile\u7c7b\u7684\u5b9e\u4f8b\n\n        // \u6784\u9020\u56681\n        // 1. \u76f8\u5bf9\u8def\u5f84\n        File file1 = new File(\"hello.txt\");\n        System.out.println(file1);\n        // 2. \u7edd\u5bf9\u8def\u5f84\n        File file2 = new File(\"C:\\\\hello.txt\");\n        System.out.println(file2);\n\n        // \u6784\u9020\u56682\n        File file3 = new File(\"C:\", \"project\");\n        System.out.println(file3);\n\n        // \u6784\u9020\u56683\n        File file4 = new File(file3, \"hello.txt\");\n        System.out.println(file4);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#2","title":"2.\u5e38\u7528\u65b9\u6cd5","text":"<pre><code>import java.io.File;\nimport java.io.IOException;\n\npublic class FileTest {\n    public static void main(String[] args) {\n        File file = new File(\"hello.txt\");\n\n        // \u83b7\u53d6\u76f8\u5bf9\u8def\u5f84\n        System.out.println(file.getPath());  // hello.txt\n\n        // \u83b7\u53d6\u7edd\u5bf9\u8def\u5f84\n        System.out.println(file.getAbsolutePath());  // E:\\project\\IDEA-workspace\\1217\\hello.txt\n\n        // \u83b7\u53d6\u6587\u4ef6\u540d\n        System.out.println(file.getName());  // hello.txt\n\n        // \u83b7\u53d6\u4e0a\u5c42\u76ee\u5f55\u8def\u5f84\uff0c\u82e5\u65e0\uff0c\u8fd4\u56denull\n        System.out.println(file.getParent());  // null\n\n        // \u83b7\u53d6\u6587\u4ef6\u957f\u5ea6\uff08\u5b57\u8282\u6570\uff09\n        System.out.println(file.length());  // 12\n\n        // \u83b7\u53d6\u6700\u540e\u4e00\u6b21\u4fee\u6539\u65f6\u95f4 \u6beb\u79d2\n        System.out.println(file.lastModified());  // 1639750041765\n\n        // \u83b7\u53d6\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u6216\u6587\u4ef6\u76ee\u5f55\u7684\u540d\u79f0\u6570\u7ec4\n        String[] list = new File(\"C:\\\\Windows\\\\System32\\\\drivers\\\\etc\").list();\n\n        // \u83b7\u53d6\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u6216\u6587\u4ef6\u76ee\u5f55\u7684File\u6570\u7ec4\n        File[] listFiles = new File(\"C:\\\\Windows\\\\System32\\\\drivers\\\\etc\").listFiles();\n\n\n        // \u5224\u65ad\u662f\u5426\u662f\u76ee\u5f55\n        System.out.println(file.isDirectory());\n\n        // \u5224\u65ad\u662f\u5426\u662f\u6587\u4ef6\n        System.out.println(file.isFile());\n\n        // \u5224\u65ad\u6587\u4ef6\u662f\u5426\u5b58\u5728\n        System.out.println(file.exists());\n\n        // \u5224\u65ad\u662f\u5426\u53ef\u8bfb\n        System.out.println(file.canRead());\n\n        // \u5224\u65ad\u662f\u5426\u53ef\u5199\n        System.out.println(file.canWrite());\n\n        // \u5224\u65ad\u662f\u5426\u9690\u85cf\n        System.out.println(file.isHidden());\n\n\n        // \u628a\u6587\u4ef6\u91cd\u547d\u540d\u4e3a\u6307\u5b9a\u7684\u6587\u4ef6\u8def\u5f84\n        // \u9700\u8981\u4fdd\u8bc1\u6e90\u6587\u4ef6\u5b58\u5728\uff0c\u4e14\u76ee\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u624d\u4f1a\u8fd4\u56detrue\n        boolean rename = file.renameTo(new File(\"C:\\\\hello.txt\"));\n        System.out.println(rename);\n\n\n        // \u521b\u5efa\u6587\u4ef6\u3002\u82e5\u6587\u4ef6\u5b58\u5728\uff0c\u5219\u4e0d\u521b\u5efa\uff0c\u8fd4\u56defalse\n        try {\n            System.out.println(file.createNewFile());\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n\n        // \u521b\u5efa\u76ee\u5f55\uff0c\u82e5\u76ee\u5f55\u5b58\u5728\uff0c\u5219\u4e0d\u521b\u5efa\n        File dir = new File(\"C:\\\\project\\\\java\");\n        System.out.println(dir.mkdir());\n\n        // \u521b\u5efa\u6587\u4ef6\uff0c\u5982\u679c\u4e0a\u5c42\u76ee\u5f55\u4e0d\u5b58\u5728\uff0c\u4e00\u5e76\u521b\u5efa\n        System.out.println(dir.mkdirs());\n\n        // \u5220\u9664\u6587\u4ef6\u6216\u6587\u4ef6\u76ee\u5f55\uff0c\n        System.out.println(dir.delete());\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#io","title":"\u4e8c\u3001IO\u6d41","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#1_1","title":"1. \u5206\u7c7b","text":"<ol> <li>\u6309\u64cd\u4f5c\u6570\u636e\u5355\u4f4d\u5206\uff1a\u5b57\u8282\u6d41\u3001\u5b57\u7b26\u6d41</li> <li>\u6309\u6570\u636e\u7684\u6d41\u7a0b\uff1a\u6570\u636e\u6d41\u3001\u8f93\u51fa\u6d41</li> <li>\u6309\u6d41\u7684\u89d2\u8272\uff1a\u8282\u70b9\u6d41\u3001\u5904\u7406\u6d41</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#2_1","title":"2. \u4f53\u7cfb\u7ed3\u6784","text":"<p>Java\u7684IO\u6d41\u4e00\u5171\u6d89\u53ca40\u591a\u4e2a\u7c7b\uff0c\u4ed6\u4eec\u90fd\u662f\u4ece\u5982\u4e0b\u56db\u4e2a\u62bd\u8c61\u57fa\u7c7b\u6d3e\u751f\u7684\u3002\u7531\u8fd9\u56db\u4e2a\u7c7b\u6d3e\u751f\u51fa\u6765\u7684\u5b50\u7c7b\u540d\u79f0\u90fd\u662f\u4ee5\u5176\u7236\u7c7b\u540d\u4f5c\u4e3a\u5b50\u7c7b\u540d\u540e\u7f00\u3002</p> \u62bd\u8c61\u57fa\u7c7b \u5b57\u8282\u6d41 \u5b57\u7b26\u6d41 \u8f93\u5165\u6d41 <code>InputStream</code> <code>Reader</code> \u8f93\u51fa\u6d41 <code>OutputStream</code> <code>Writer</code>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#_1","title":"\u4e09\u3001\u6587\u4ef6\u6d41","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#1-filereader","title":"1. <code>FileReader</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#11","title":"1.1 \u6bcf\u6b21\u8bfb\u4e00\u4e2a\u5b57\u7b26","text":"<pre><code>//\u62bd\u8c61\u57fa\u7c7b        \u8282\u70b9\u6d41(\u6587\u4ef6\u6d41)\n//InputStream     FileInputStream\n//OutputStream    FileOutputStream\n//Reader          FileReader\n//Writer          FileWriter\n\nimport java.io.File;\nimport java.io.FileReader;\nimport java.io.IOException;\n\npublic class FileReaderTest {\n    public static void main(String[] args) {\n        FileReader reader = null;\n        // \u4e3a\u4e86\u4fdd\u8bc1\u6d41\u8d44\u6e90\u4e00\u5b9a\u53ef\u4ee5\u6267\u884c\u5173\u95ed\u64cd\u4f5c\uff0c\u9700\u8981\u4f7f\u7528try-catch-finally\u6765\u5904\u7406\u5f02\u5e38\n        try {\n            // 1. \u5b9e\u4f8b\u5316File\u7c7b\u7684\u5bf9\u8c61, \u6b64\u6587\u4ef6\u4e00\u5b9a\u8981\u5b58\u5728\n            File file = new File(\"hello.txt\");\n            // 2. \u63d0\u4f9b\u5177\u4f53\u7684\u6d41\n            reader = new FileReader(file);\n            // 3. \u6570\u636e\u7684\u8bfb\u5165\n            // read() \u8fd4\u56de\u8bfb\u5165\u7684\u5b57\u7b26\uff0c\u5982\u679c\u8fbe\u5230\u6587\u4ef6\u672b\u5c3e\uff0c\u8fd4\u56de-1\n            int data = reader.read();\n            while (data != -1) {\n                System.out.print((char) data);\n                data = reader.read();\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                // 3.\u6d41\u7684\u5173\u95ed\u64cd\u4f5c\n                if (reader != null) {\n                    reader.close();\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#12","title":"1.2 \u6bcf\u6b21\u8bfb\u591a\u4e2a\u5b57\u7b26","text":"<pre><code>import java.io.File;\nimport java.io.FileReader;\nimport java.io.IOException;\n\npublic class FileReaderTest {\n    public static void main(String[] args) {\n        FileReader reader = null;\n        // \u4e3a\u4e86\u4fdd\u8bc1\u6d41\u8d44\u6e90\u4e00\u5b9a\u53ef\u4ee5\u6267\u884c\u5173\u95ed\u64cd\u4f5c\uff0c\u9700\u8981\u4f7f\u7528try-catch-finally\u6765\u5904\u7406\u5f02\u5e38\n        try {\n            // 1. \u5b9e\u4f8b\u5316File\u7c7b\u7684\u5bf9\u8c61, \u6b64\u6587\u4ef6\u4e00\u5b9a\u8981\u5b58\u5728\n            File file = new File(\"hello.txt\");\n            // 2. \u63d0\u4f9b\u5177\u4f53\u7684\u6d41\n            reader = new FileReader(file);\n            // 3. \u6570\u636e\u7684\u8bfb\u5165\n\n            char[] cbuf = new char[5];  // \u6bcf\u6b21\u8bfb\u53d6cbuf\u4e2d\u7684\u5b57\u7b26\u4e2a\u6570\uff0c\u5982\u679c\u8fbe\u5230\u6587\u4ef6\u672b\u5c3e\uff0c\u8fd4\u56de-1\n            int len;\n            while ((len = reader.read(cbuf)) != -1) {\n                for (int i = 0; i &lt; len; i++) {\n                    System.out.print(cbuf[i]);\n                }\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                // 3.\u6d41\u7684\u5173\u95ed\u64cd\u4f5c\n                if (reader != null) {\n                    reader.close();\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#2-filewriter","title":"2. <code>FileWriter</code>","text":"<pre><code>import java.io.File;\nimport java.io.FileWriter;\nimport java.io.IOException;\n\npublic class FileWriterTest {\n    public static void main(String[] args) {\n        FileWriter writer = null;\n        try {\n            // 1. \u5b9e\u4f8b\u5316File\u7c7b\u7684\u5bf9\u8c61, \u6b64\u6587\u4ef6\u53ef\u4ee5\u4e0d\u5b58\u5728\n            File file = new File(\"hello.txt\");\n            // 2. \u63d0\u4f9bFileWriter\u5bf9\u8c61\uff0c\u7528\u4e8e\u6570\u636e\u7684\u5199\u51fa\n            //  \u4f1a\u8986\u76d6\u539f\u6709\u7684\u6587\u4ef6\n            writer = new FileWriter(file);\n            //  \u8ffd\u52a0\u6587\u4ef6\n            // FileWriter writer = new FileWriter(file, true);\n\n            // 3. \u5199\u51fa\u7684\u64cd\u4f5c\n            writer.write(\"Hello World!\");\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            try {\n                if (writer != null) {\n                    // 4. \u6d41\u8d44\u6e90\u7684\u5173\u95ed\n                    writer.close();\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#3-fileinputstreamfileoutputstream","title":"3. <code>FileInputStream</code>\u548c<code>FileOutputStream</code>","text":"<p>\u5bf9\u4e8e\u6587\u672c\u6587\u4ef6\u4f7f\u7528\u5b57\u7b26\u6d41\u5904\u7406\uff1b\u5bf9\u4e8e\u975e\u6587\u672c\u6587\u4ef6\u4f7f\u7528\u5b57\u8282\u6d41\u5904\u7406\u3002</p> <pre><code>import java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\n\npublic class FileInputOutputStream {\n    public static void main(String[] args) {\n        FileInputStream inputStream = null;\n        FileOutputStream outputStream = null;\n        try {\n            File srcFile = new File(\"image.jpg\");\n            File destFile = new File(\"image.bak.jpg\");\n\n            inputStream = new FileInputStream(srcFile);\n            outputStream = new FileOutputStream(destFile);\n\n            byte[] buffer = new byte[5];\n            int len;\n            while ((len = inputStream.read(buffer)) != -1) {\n                outputStream.write(buffer, 0, len);\n\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (inputStream != null) {\n                try {\n                    inputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n            if (outputStream != null) {\n                try {\n                    outputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#_2","title":"\u56db\u3001\u7f13\u5b58\u6d41","text":"<p>\u5185\u90e8\u63d0\u4f9b\u4e86\u4e00\u4e2a\u7f13\u5b58\u533a\uff0c\u63d0\u9ad8\u6d41\u7684\u8bfb\u53d6\u548c\u5199\u5165\u7684\u901f\u5ea6\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#1-bufferedinputstreambufferedoutputstream","title":"1. <code>BufferedInputStream</code>\u548c<code>BufferedOutputStream</code>","text":"<pre><code>import java.io.BufferedInputStream;\nimport java.io.BufferedOutputStream;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\n\npublic class BufferedInputOutputStreamTest {\n    public static void main(String[] args) {\n        BufferedInputStream bufferedInputStream = null;\n        BufferedOutputStream bufferedOutputStream = null;\n        try {\n            File secFile = new File(\"image.jpg\");\n            File destFile = new File(\"image.bak.jpg\");\n            // \u8282\u70b9\u6d41\n            FileInputStream inputStream = new FileInputStream(secFile);\n            FileOutputStream outputStream = new FileOutputStream(destFile);\n            // \u7f13\u51b2\u6d41\n            bufferedInputStream = new BufferedInputStream(inputStream);\n            bufferedOutputStream = new BufferedOutputStream(outputStream);\n\n            byte[] buffer = new byte[1024];\n            int len;\n            while ((len = bufferedInputStream.read(buffer)) != -1) {\n                bufferedOutputStream.write(buffer, 0, len);\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            // \u8d44\u6e90\u5173\u95ed\n            // \u5148\u5173\u95ed\u5916\u5c42\u7684\u6d41\uff0c\u518d\u5173\u95ed\u5185\u5c42\u7684\u6d41\n            // \u5728\u5173\u95ed\u5916\u5c42\u6d41\u98df\uff0c\u5185\u5c42\u6d41\u4e5f\u4f1a\u81ea\u52a8\u5173\u95ed\n            if (bufferedInputStream != null){\n                try {\n                    bufferedInputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n            if (bufferedOutputStream != null) {\n                try {\n                    bufferedOutputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#2-bufferedreaderbufferedwriter","title":"2. <code>BufferedReader</code>\u548c<code>BufferedWriter</code>","text":"<pre><code>import java.io.BufferedReader;\nimport java.io.BufferedWriter;\nimport java.io.File;\nimport java.io.FileReader;\nimport java.io.FileWriter;\nimport java.io.IOException;\n\npublic class BufferedReaderWriterTest {\n    public static void main(String[] args) {\n        BufferedReader bufferedReader = null;\n        BufferedWriter bufferedWriter = null;\n        try {\n            bufferedReader = new BufferedReader(new FileReader(new File(\"hello.txt\")));\n            bufferedWriter = new BufferedWriter(new FileWriter(new File(\"hello.bak.txt\")));\n            // \u65b9\u5f0f1\n            /*\n            char[] buffer = new char[1024];\n            int len;\n            while ((len = bufferedReader.read()) != -1) {\n                bufferedWriter.write(buffer, 0, len);\n            }\n            */\n\n            // \u65b9\u5f0f2\n            String data;\n            while ((data = bufferedReader.readLine()) != null){\n                bufferedWriter.write(data); // data\u4e2d\u4e0d\u5305\u542b\u6362\u884c\u7b26\n                bufferedWriter.newLine();\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (bufferedReader != null) {\n                try {\n                    bufferedReader.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n            if (bufferedWriter != null) {\n                try {\n                    bufferedWriter.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#_3","title":"\u4e94\u3001\u8f6c\u6362\u6d41","text":"<p>\u63d0\u4f9b\u4e86\u5b57\u8282\u6d41\u548c\u5b57\u7b26\u6d41\u4e4b\u95f4\u7684\u8f6c\u6362\uff0c\u5c5e\u4e8e\u5b57\u7b26\u6d41</p> <ol> <li><code>InputStreamReader</code>\uff1a\u5c06\u4e00\u4e2a\u5b57\u8282\u7684\u8f93\u5165\u6d41\u8f6c\u6362\u4e3a\u5b57\u7b26\u7684\u8f93\u5165\u6d41</li> <li><code>OutputStreamWriter</code>\uff1a\u5c06\u4e00\u4e2a\u5b57\u7b26\u7684\u8f93\u5904\u6d41\u8f6c\u6362\u4e3a\u5b57\u8282\u7684\u8f93\u51fa\u6d41</li> </ol> <pre><code>import java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.InputStreamReader;\nimport java.io.OutputStreamWriter;\n\npublic class InputStreamReaderOutputStreamWriterTest {\n    public static void main(String[] args) {\n        InputStreamReader inputStreamReader = null;\n        OutputStreamWriter outputStreamWriter = null;\n        try {\n            File file1 = new File(\"hello.txt\");\n            File file2 = new File(\"hello.bak.txt\");\n\n            FileInputStream fileInputStream = new FileInputStream(file1);\n            FileOutputStream fileOutputStream = new FileOutputStream(file2);\n\n            inputStreamReader = new InputStreamReader(fileInputStream, \"UTF-8\");\n            outputStreamWriter = new OutputStreamWriter(fileOutputStream, \"GBK\");\n\n            char[] buffer = new char[1024];\n            int len;\n            while ((len = inputStreamReader.read(buffer)) != -1) {\n                outputStreamWriter.write(buffer, 0, len);\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (inputStreamReader != null) {\n                try {\n                    inputStreamReader.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n            if (outputStreamWriter != null) {\n                try {\n                    outputStreamWriter.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#_4","title":"\u516d\u3001\u5bf9\u8c61\u6d41","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#1-objectinputstreamobjectoutputstream","title":"1. <code>ObjectInputStream</code>\u548c<code>ObjectOutputStream</code>","text":"<p>\u7528\u4e8e\u8bfb\u53d6\u548c\u5b58\u50a8\u57fa\u672c\u6570\u636e\u7c7b\u578b\u6570\u636e\u6216\u5bf9\u8c61\u7684\u5904\u7406\u6d41\u3002</p> <pre><code>import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\n\npublic class ObjectInputOutputStreamTest {\n    public static void main(String[] args) {\n        // \u5e8f\u5217\u5316\n        ObjectOutputStream objectOutputStream = null;\n        try {\n            objectOutputStream = new ObjectOutputStream(new FileOutputStream(\"hello.txt\"));\n            objectOutputStream.writeObject(new String(\"Hello, \u5317\u4eac\"));\n            objectOutputStream.flush();\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (objectOutputStream != null) {\n                try {\n                    objectOutputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n        // \u53cd\u5e8f\u5217\u5316\n        ObjectInputStream objectInputStream = null;\n        try {\n            objectInputStream = new ObjectInputStream(new FileInputStream(\"hello.txt\"));\n            Object object = objectInputStream.readObject();\n            String str = (String) object;\n            System.out.println(str);\n        } catch (IOException e) {\n            e.printStackTrace();\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } finally {\n            if (objectInputStream != null) {\n                try {\n                    objectInputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/IO%E6%B5%81/#2_2","title":"2. \u81ea\u5b9a\u4e49\u7c7b\u7684\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316","text":"<pre><code>import java.io.*;\n\npublic class ObjectInputOutputStreamTest {\n    public static void main(String[] args) {\n        // \u5e8f\u5217\u5316\n        ObjectOutputStream objectOutputStream = null;\n        try {\n            objectOutputStream = new ObjectOutputStream(new FileOutputStream(\"hello.txt\"));\n            objectOutputStream.writeObject(new Person(\"Tom\", 18));\n            objectOutputStream.flush();\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (objectOutputStream != null) {\n                try {\n                    objectOutputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n        // \u53cd\u5e8f\u5217\u5316\n        ObjectInputStream objectInputStream = null;\n        try {\n            objectInputStream = new ObjectInputStream(new FileInputStream(\"hello.txt\"));\n            Object object = objectInputStream.readObject();\n            System.out.println(object);\n        } catch (IOException e) {\n            e.printStackTrace();\n        } catch (ClassNotFoundException e) {\n            e.printStackTrace();\n        } finally {\n            if (objectInputStream != null) {\n                try {\n                    objectInputStream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n\n// \u81ea\u5b9a\u4e49\u7c7b\u9700\u8981\u6ee1\u8db3\u5982\u4e0b\u7684\u8981\u6c42\u65b9\u53ef\u5e8f\u5217\u5316\n// 1. \u5b9e\u73b0Serializable\u63a5\u53e3\n// 2. \u5f53\u524d\u7c7b\u63d0\u4f9b\u4e00\u4e2a\u5168\u5c40\u5e38\u91cf serialVersionUID\n// 3. \u9664\u4e86\u5f53\u524d\u7c7b\u9700\u8981\u5b9e\u73b0Serializable\u63a5\u53e3\u4ee5\u5916\uff0c\u8fd8\u5fc5\u987b\u4fdd\u8bc1\u5176\u5185\u90e8\u6240\u6709\u5c5e\u6027\u4e5f\u5fc5\u987b\u662f\u53ef\u5e8f\u5217\u5316\u7684\n// 4. \u4e0d\u80fd\u5e8f\u5217\u5316static\u548ctransient\u4fee\u9970\u7684\u6210\u5458\u53d8\u91cf\nclass Person implements Serializable {\n    public static final long serialVersionUID = 3141592657L;\n    String name;\n    int age;\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    @Override\n    public String toString() {\n        return \"Person{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/","title":"\u53cd\u5c04","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#_1","title":"\u4e00\u3001\u53cd\u5c04\u673a\u5236\u63d0\u4f9b\u7684\u529f\u80fd","text":"<ol> <li>\u5728\u8fd0\u884c\u65f6\u5224\u65ad\u4efb\u610f\u4e00\u4e2a\u5bf9\u8c61\u6240\u5c5e\u7684\u7c7b</li> <li>\u5728\u8fd0\u884c\u65f6\u6784\u9020\u4efb\u610f\u4e00\u4e2a\u7c7b\u7684\u5bf9\u8c61</li> <li>\u5728\u8fd0\u884c\u65f6\u5224\u65ad\u4efb\u610f\u4e00\u4e2a\u7c7b\u6240\u5177\u6709\u7684\u6210\u5458\u53d8\u91cf\u548c\u65b9\u6cd5</li> <li>\u5728\u8fd0\u884c\u65f6\u83b7\u53d6\u6cdb\u578b\u4fe1\u606f</li> <li>\u5728\u8fd0\u884c\u65f6\u8c03\u7528\u4efb\u610f\u4e00\u4e2a\u5bf9\u8c61\u7684\u6210\u5458\u53d8\u91cf\u548c\u65b9\u6cd5</li> <li>\u5728\u8fd0\u884c\u65f6\u5904\u7406\u6ce8\u89e3</li> <li>\u751f\u6210\u52a8\u6001\u4ee3\u7406</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#api","title":"\u4e8c\u3001\u53cd\u5c04\u76f8\u5173\u7684<code>API</code>","text":"<pre><code>import java.lang.reflect.Constructor;\nimport java.lang.reflect.Field;\nimport java.lang.reflect.Method;\n\npublic class ReflectionTest {\n    public static void main(String[] args) throws Exception {\n        // \u901a\u8fc7\u53cd\u5c04\u521b\u5efaPerson\u7c7b\u7684\u5bf9\u8c61\n        Class&lt;Person&gt; cls = Person.class;\n        Constructor&lt;Person&gt; constructor = cls.getConstructor(String.class, int.class);\n        Object obj = constructor.newInstance(\"Tom\", 12);\n        Person p = (Person) obj;\n        System.out.println(p.toString());  // Person{name='Tom', age=12}\n\n        // \u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u5bf9\u8c61\u6307\u5b9a\u7684\u5c5e\u6027\n        Field age = cls.getDeclaredField(\"age\");\n        age.set(p, 10);\n        System.out.println(p.toString());  // Person{name='Tom', age=10}\n\n        // \u901a\u8fc7\u53cd\u5c04\u8c03\u7528\u5bf9\u8c61\u6307\u5b9a\u7684\u65b9\u6cd5\n        Method show = cls.getDeclaredMethod(\"show\");  // Hello\n        show.invoke(p);\n\n        // \u901a\u8fc7\u53cd\u5c04\u8c03\u7528Person\u7684\u79c1\u6709\u6784\u9020\u5668\n        Constructor&lt;Person&gt; constructor1 = cls.getDeclaredConstructor(String.class);\n        constructor1.setAccessible(true);\n        Person p1 = (Person) constructor1.newInstance(\"Jerry\");\n        System.out.println(p1);  // Process finished with exit code 0\n\n        // \u901a\u8fc7\u53cd\u5c04\u8c03\u7528Person\u7684\u79c1\u6709\u5c5e\u6027\n        Field name = cls.getDeclaredField(\"name\");\n        name.setAccessible(true);\n        name.set(p1, \"HanMeimei\");\n        System.out.println(p1);\n\n        // \u901a\u8fc7\u53cd\u5c04\u8c03\u7528Person\u7684\u79c1\u6709\u65b9\u6cd5\n        Method showNation = cls.getDeclaredMethod(\"showNation\", String.class);\n        showNation.setAccessible(true);\n        showNation.invoke(p1, \"Chinese\");  // Chinese\n\n\n    }\n}\n\n\nclass Person{\n    private String name;\n    public int age;\n\n    @Override\n    public String toString() {\n        return \"Person{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    private Person(String name) {\n        this.name = name;\n    }\n\n    public void show(){\n        System.out.println(\"Hello\");\n    }\n\n    private void showNation(String nation){\n        System.out.println(nation);\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#javalangclass","title":"\u4e09\u3001<code>java.lang.Class</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#1","title":"1. \u7c7b\u7684\u52a0\u8f7d\u8fc7\u7a0b","text":"<p>\u7a0b\u5e8f\u7ecf\u8fc7<code>Javac</code>\u547d\u4ee4\u4ee5\u540e\uff0c\u4f1a\u751f\u6210\u4e00\u4e2a\u6216\u591a\u4e2a\u5b57\u8282\u7801\u6587\u4ef6\uff08<code>.class</code>\u7ed3\u5c3e\uff09\uff0c\u63a5\u7740\u4f7f\u7528<code>java</code>\u547d\u4ee4\u5bf9\u67d0\u4e2a\u5b57\u8282\u7801\u6587\u4ef6\u8fdb\u884c\u89e3\u91ca\u8fd0\u884c\u3002\u76f8\u5bf9\u4e8e\u5c06\u67d0\u4e2a\u5b57\u8282\u7801\u6587\u4ef6\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\uff0c\u6b64\u8fc7\u7a0b\u5c31\u79f0\u4e3a\u7c7b\u7684\u52a0\u8f7d\u3002\u52a0\u8f7d\u5230\u5185\u5b58\u4e2d\u7684\u7c7b\u5c31\u79f0\u4e3a\u8fd0\u884c\u65f6\u7c7b\uff0c\u6b64\u65f6\u7684\u8fd0\u884c\u65f6\u7c7b\u5c31\u4f5c\u4e3a<code>Class</code>\u7684\u4e00\u4e2a\u5b9e\u4f8b.</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#2-class","title":"2. \u83b7\u53d6Class\u5b9e\u4f8b\u7684\u65b9\u5f0f","text":"<p>\u52a0\u8f7d\u5230\u4f60\u5185\u5b58\u4e2d\u7684\u8fd0\u884c\u65f6\u7c7b\uff0c\u4f1a\u7f13\u5b58\u4e00\u5b9a\u7684\u65f6\u95f4\uff0c\u5728\u6b64\u65f6\u95f4\u4e4b\u5185\uff0c\u53ef\u4ee5\u901a\u8fc7\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u83b7\u53d6\u6b64\u8fd0\u884c\u65f6\u7c7b\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#1-class","title":"1. \u8c03\u7528\u8fd0\u884c\u65f6\u7c7b\u7684\u5c5e\u6027\uff1a<code>.class</code>","text":"<pre><code>Class&lt;Person&gt; cls = Person.class;\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#2","title":"2. \u901a\u8fc7\u8fd0\u884c\u65f6\u7c7b\u7684\u5bf9\u8c61","text":"<pre><code>Person p = new Person();\nClass cls = p.getClass();\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#3-class","title":"3. \u8c03\u7528Class\u7684\u9759\u6001\u65b9\u6cd5","text":"<pre><code>Class&lt;?&gt; cls = Class.forName(\"Person\");\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#4","title":"4. \u4f7f\u7528\u7c7b\u7684\u52a0\u8f7d\u5668","text":"<pre><code>ClassLoader classLoader = ReflectionTest.class.getClassLoader();\nClass&lt;?&gt; cls = classLoader.loadClass(\"Person\");\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#4-class","title":"4. \u54ea\u4e9b\u7c7b\u578b\u53ef\u4ee5\u6709<code>Class</code>\u5bf9\u8c61","text":"<ol> <li>\u5916\u90e8\u7c7b\uff0c\u6210\u5458\uff08\u6210\u5458\u5185\u90e8\u7c7b\u3001\u9759\u6001\u5185\u90e8\u7c7b\uff09\uff0c\u5c40\u90e8\u5185\u90e8\u7c7b\uff0c\u533f\u540d\u5185\u90e8\u7c7b</li> <li>\u63a5\u53e3</li> <li>\u6570\u7ec4</li> <li>\u679a\u4e3e</li> <li>\u6ce8\u89e3</li> <li>\u57fa\u672c\u6570\u636e\u7c7b\u578b</li> <li><code>void</code></li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#5-classloader","title":"5. \u4f7f\u7528<code>ClassLoader</code>\u52a0\u8f7d\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>import java.io.IOException;\nimport java.io.InputStream;\nimport java.util.Properties;\n\npublic class ClassLoaderTest {\n    public static void main(String[] args) {\n        Properties properties = new Properties();\n        ClassLoader classLoader = ClassLoaderTest.class.getClassLoader();\n        // \u914d\u7f6e\u6587\u4ef6\u9ed8\u8ba4\u8bc6\u522b\u4e3a\u5f53\u524dmodule\u7684src\u4e0b\n        InputStream resource = classLoader.getResourceAsStream(\"conf.properties\");\n        try {\n            properties.load(resource);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        String user = properties.getProperty(\"user\");\n        System.out.println(user);\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#_2","title":"\u56db\u3001\u521b\u5efa\u8fd0\u884c\u65f6\u7c7b\u7684\u5bf9\u8c61","text":"<pre><code>public class newInstanceTest {\n    public static void main(String[] args) throws IllegalAccessException, InstantiationException {\n        Class&lt;Person&gt; cls = Person.class;\n        /*\n         * newInstance() \u8c03\u7528\u6b64\u65b9\u6cd5\uff0c\u521b\u5efa\u5bf9\u5e94\u7684\u8fd0\u884c\u65f6\u7c7b\u7684\u5bf9\u8c61\n         * \u5185\u90e8\u8c03\u7528\u4e86\u8fd0\u884c\u65f6\u7c7b\u7684\u7a7a\u53c2\u6784\u9020\u5668\n         * \u8981\u60f3\u6b64\u65b9\u6cd5\u6b63\u5e38\u7684\u521b\u5efa\u8fd0\u884c\u65f6\u7c7b\u7684\u5bf9\u8c61\uff0c\u8981\u6c42\uff1a\n         *   1. \u8fd0\u884c\u65f6\u7c7b\u5fc5\u987b\u63d0\u4f9b\u7a7a\u53c2\u7684\u6784\u9020\u5668\n         *   2. \u7a7a\u53c2\u6784\u9020\u5668\u7684\u8bbf\u95ee\u6743\u9650\u901a\u5e38\u8bbe\u7f6e\u4e3apublic\n         * \u5728JavaBean\u4e2d\u8981\u6c42\u63d0\u4f9b\u4e00\u4e2apublic\u7684\u7a7a\u53c2\u6784\u9020\u5668\u7684\u539f\u56e0\uff1a\n         *   1. \u4fbf\u4e8e\u901a\u8fc7\u53cd\u5c04\uff0c\u521b\u5efa\u8fd0\u884c\u65f6\u7c7b\u7684\u5bf9\u8c61\n         *   2. \u4fbf\u4e8e\u5b50\u7c7b\u7ee7\u627f\u6b64\u8fd0\u884c\u7c7b\u662f\uff0c\u9ed8\u8ba4\u8c03\u7528super()\u65f6\uff0c\u4fdd\u8bc1\u7236\u7c7b\u6709\u6b64\u6784\u9020\u5668\n         * */\n        Person p = cls.newInstance();\n        System.out.println(p);  // Person@1b6d3586\n\n    }\n}\n\nclass Person {\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#_3","title":"\u4e94\u3001\u83b7\u53d6\u8fd0\u884c\u65f6\u7c7b\u7684\u5b8c\u6574\u7ed3\u6784","text":"<pre><code>import java.io.Serializable;\nimport java.lang.annotation.Annotation;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\nimport java.lang.reflect.*;\n\nimport static java.lang.annotation.ElementType.*;\nimport static java.lang.annotation.ElementType.LOCAL_VARIABLE;\n\npublic class ReflectionTest {\n    public static void main(String[] args) {\n        Class&lt;Person&gt; cls = Person.class;\n        // 1. \u83b7\u53d6\u5f53\u524d\u8fd0\u884c\u65f6\u7c7b\u7684\u6240\u6709\u5c5e\u6027\u7ed3\u6784\n        // getFields(): \u83b7\u53d6\u5f53\u524d\u8fd0\u884c\u65f6\u7c7b\u53ca\u5176\u7236\u7c7b\u4e2d\u58f0\u660e\u4e3apublic\u8bbf\u95ee\u6743\u9650\u7684\u5c5e\u6027\n        Field[] fields = cls.getFields();\n        for (Field f : fields) {\n            System.out.println(f);\n        }\n        System.out.println(\"================================\");\n        //      public int Person.id\n        //      public double Creature.weight\n\n\n        // getDeclaredFields(): \u83b7\u53d6\u5f53\u524d\u8fd0\u884c\u65f6\u7c7b\u4e2d\u58f0\u660e\u7684\u6240\u6709\u5c5e\u6027\uff08\u4e0d\u5305\u542b\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\uff09\n        Field[] declaredFields = cls.getDeclaredFields();\n        for (Field f : declaredFields) {\n            System.out.println(f);\n        }\n        //        public int Person.id\n        //        private java.lang.String Person.name\n        //        int Person.age\n        System.out.println(\"================================\");\n        for (Field f : declaredFields) {\n            // \u83b7\u53d6\u4fee\u9970\u7b26\n            int modifiers = f.getModifiers();\n            System.out.println(Modifier.toString(modifiers));\n        }\n        System.out.println(\"================================\");\n        for (Field f : declaredFields) {\n            // \u83b7\u53d6\u6570\u636e\u7c7b\u578b\n            Class&lt;?&gt; type = f.getType();\n            System.out.println(type);\n        }\n        System.out.println(\"================================\");\n        for (Field f : declaredFields) {\n            // \u83b7\u53d6\u53d8\u91cf\u540d\n            String name = f.getName();\n            System.out.println(name);\n        }\n        System.out.println(\"================================\");\n\n\n        // 2. \u83b7\u53d6\u8fd0\u884c\u65f6\u7c7b\u7684\u65b9\u6cd5\u7ed3\u6784\n        // getMethods(): \u83b7\u53d6\u5f53\u524d\u8fd0\u884c\u65f6\u7c7b\u53ca\u5176\u7236\u7c7b\u4e2d\u58f0\u660e\u4e3apublic\u8bbf\u95ee\u6743\u9650\u7684\u65b9\u6cd5\n        Method[] methods = cls.getMethods();\n        for (Method m : methods) {\n            System.out.println(m);\n        }\n        System.out.println(\"================================\");\n\n        // getDeclaredMethods(): \u83b7\u53d6\u5f53\u524d\u8fd0\u884c\u65f6\u7c7b\u4e2d\u58f0\u660e\u7684\u6240\u6709\u65b9\u6cd5\uff08\u4e0d\u5305\u542b\u7236\u7c7b\u4e2d\u58f0\u660e\u7684\u5c5e\u6027\uff09\n        Method[] declaredMethods = cls.getDeclaredMethods();\n        for (Method m : declaredMethods) {\n            System.out.println(m);\n        }\n        System.out.println(\"================================\");\n\n\n        // 3. \u83b7\u53d6\u65b9\u6cd5\u7684\u5185\u90e8\u7ed3\u6784\n        Method[] dMethods = cls.getDeclaredMethods();\n        for (Method m : dMethods) {\n            System.out.println(\"---------------------------\");\n            // \u83b7\u53d6\u65b9\u6cd5\u7684\u6ce8\u89e3\n            Annotation[] annotations = m.getAnnotations();\n            for (Annotation a : annotations) {\n                System.out.println(a);\n            }\n            // \u83b7\u53d6\u6743\u9650\u4fee\u9970\u7b26\n            System.out.println(Modifier.toString(m.getModifiers()));\n            // \u83b7\u53d6\u8fd4\u56de\u503c\u7c7b\u578b\n            System.out.println(m.getReturnType().getName());\n            // \u83b7\u53d6\u65b9\u6cd5\u540d\n            System.out.println(m.getName());\n            // \u83b7\u53d6\u5f62\u53c2\n            Class&lt;?&gt;[] parameterTypes = m.getParameterTypes();\n            if (!(parameterTypes == null &amp;&amp; parameterTypes.length == 0)) {\n                for (int i = 0; i &lt; parameterTypes.length; i++) {\n                    System.out.println(parameterTypes[i].getName());\n                }\n            }\n        }\n\n        // 4. \u83b7\u53d6\u6784\u9020\u5668\u7ed3\u6784\n        System.out.println(\"================================\");\n        // getConstructors() \u5f53\u524d\u8fd0\u884c\u65f6\u7c7b\u4e2d\u58f0\u660e\u4e3apublic\u7684\u6784\u9020\u5668\n        Constructor&lt;?&gt;[] constructors = cls.getConstructors();\n        for(Constructor c: constructors){\n            System.out.println(c);\n        }\n        System.out.println(\"================================\");\n        Constructor&lt;?&gt;[] declaredConstructors = cls.getDeclaredConstructors();\n        for(Constructor c: declaredConstructors){\n            System.out.println(c);\n        }\n        System.out.println(\"================================\");\n\n\n        // 5. \u83b7\u53d6\u8fd0\u884c\u7c7b\u7684\u7236\u7c7b\u53ca\u7236\u7c7b\u7684\u6cdb\u578b\n        Class&lt;? super Person&gt; superclass = cls.getSuperclass();\n        System.out.println(superclass);\n\n        Type genericSuperclass = cls.getGenericSuperclass();\n        System.out.println(genericSuperclass);\n        ParameterizedType parameterizedType = (ParameterizedType) genericSuperclass;\n        Type[] actualTypeArguments = parameterizedType.getActualTypeArguments();\n        // \u83b7\u53d6\u5e26\u6cdb\u578b\u7684\u7236\u7c7b\u7684\u6cdb\u578b\n        System.out.println(actualTypeArguments[0].getTypeName());\n        System.out.println(\"================================\");\n\n        // 6. \u83b7\u53d6\u8fd0\u884c\u65f6\u7c7b\u7684\u63a5\u53e3\u3001\u6240\u5728\u5305\u3001\u6ce8\u89e3\n        Class&lt;?&gt;[] interfaces = cls.getInterfaces();\n        for (Class i: interfaces){\n            System.out.println(i);\n        }\n        System.out.println(\"---------------------------\");\n\n        Package aPackage = cls.getPackage();\n        System.out.println(aPackage);\n        System.out.println(\"---------------------------\");\n\n        Annotation[] annotations = cls.getAnnotations();\n        for (Annotation a: annotations){\n            System.out.println(a);\n        }\n    }\n\n}\n\ninterface MyInterface {\n    void info();\n}\n\n@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})\n@Retention(RetentionPolicy.RUNTIME)\n@interface MyAnnotation {\n    String[] value() default \"hello\";\n}\n\n\nclass Creature&lt;T&gt; implements Serializable {\n    private char gender;\n    public double weight;\n\n    public void breath() {\n        System.out.println(\"breath...\");\n    }\n\n    private void eat() {\n        System.out.println(\"eating\");\n    }\n}\n\n@MyAnnotation(value = \"hi\")\nclass Person extends Creature&lt;String&gt; implements Comparable&lt;String&gt;, MyInterface {\n    public int id;\n    private String name;\n\n    int age;\n\n\n    public Person() {\n\n    }\n\n    public Person(String name) {\n        this.name = name;\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    private void showNation(String nation) {\n        System.out.println(nation);\n    }\n\n    @MyAnnotation\n    public String display(String msg) {\n        return msg;\n    }\n\n    @Override\n    public void info() {\n        System.out.println(\"info...\");\n    }\n\n    @Override\n    public int compareTo(String o) {\n        return 0;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%8F%8D%E5%B0%84/#_4","title":"\u516d\u3001\u8c03\u7528\u8fd0\u884c\u65f6\u7c7b\u7684\u6307\u5b9a\u7ed3\u6784","text":"<pre><code>import java.io.Serializable;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\nimport java.lang.annotation.Target;\nimport java.lang.reflect.*;\n\nimport static java.lang.annotation.ElementType.*;\nimport static java.lang.annotation.ElementType.LOCAL_VARIABLE;\n\npublic class ReflectionTest {\n    public static void main(String[] args) throws NoSuchFieldException, IllegalAccessException, InstantiationException, NoSuchMethodException, InvocationTargetException {\n        Class&lt;Person&gt; cls = Person.class;\n        // \u521b\u5efa\u8fd0\u884c\u65f6\u7c7b\u7684\u5bf9\u8c61\n        Person person = cls.newInstance();\n        // 1. \u64cd\u4f5c\u8fd0\u884c\u65f6\u7c7b\u4e2d\u7684\u5c5e\u6027\n        // \u83b7\u53d6\u6307\u5b9a\u7684\u5c5e\u6027 \u8981\u6c42\u5c5e\u6027\u662fpublic\u7684\n        Field id = cls.getField(\"id\");\n        // \u8bbe\u7f6e\u5f53\u524d\u5c5e\u6027\u7684\u503c\n        id.set(person, 1001);\n        // \u83b7\u53d6\u5f53\u524d\u5c5e\u6027\u7684\u503c\n        int pId = (int) id.get(person);\n        System.out.println(pId);\n\n        // \u83b7\u53d6\u6307\u5b9a\u7684\u5c5e\u6027\n        Field name = cls.getDeclaredField(\"name\");\n        // \u4fdd\u8bc1\u5f53\u524d\u5c5e\u6027\u65f6\u53ef\u8bbf\u95ee\u7684\n        name.setAccessible(true);\n        // \u8bbe\u7f6e\u6307\u5b9a\u5bf9\u8c61\u7684\u5c5e\u6027\u503c\n        name.set(person, \"Tom\");\n        System.out.println(name.get(person));\n\n        // 2. \u64cd\u4f5c\u8fd0\u884c\u65f6\u7c7b\u4e2d\u7684\u65b9\u6cd5\n        // \u83b7\u53d6\u6307\u5b9a\u7684\u65b9\u6cd5\n        Method showNation = cls.getDeclaredMethod(\"showNation\", String.class);\n        showNation.setAccessible(true);\n        // invoke()\u7684\u8fd4\u56de\u503c\u5373\u4e3a\u5bf9\u5e94\u7c7b\u4e2d\u8c03\u7528\u7684\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\n        Object o = showNation.invoke(person, \"Chinese\");\n        System.out.println((String) o);\n\n\n        // 3. \u64cd\u4f5c\u8fd0\u884c\u65f6\u7c7b\u4e2d\u7684\u6784\u9020\u5668\n        Constructor&lt;Person&gt; declaredConstructor = cls.getDeclaredConstructor(String.class);\n        declaredConstructor.setAccessible(true);\n        Person jerry = declaredConstructor.newInstance(\"Jerry\");\n        System.out.println(jerry);\n    }\n\n}\n\ninterface MyInterface {\n    void info();\n}\n\n@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})\n@Retention(RetentionPolicy.RUNTIME)\n@interface MyAnnotation {\n    String[] value() default \"hello\";\n}\n\n\nclass Creature&lt;T&gt; implements Serializable {\n    private char gender;\n    public double weight;\n\n    public void breath() {\n        System.out.println(\"breath...\");\n    }\n\n    private void eat() {\n        System.out.println(\"eating\");\n    }\n}\n\n@MyAnnotation(value = \"hi\")\nclass Person extends Creature&lt;String&gt; implements Comparable&lt;String&gt;, MyInterface {\n    public int id;\n    private String name;\n\n    int age;\n\n\n    public Person() {\n\n    }\n\n    public Person(String name) {\n        this.name = name;\n    }\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    @Override\n    public String toString() {\n        return \"Person{\" +\n                \"id=\" + id +\n                \", name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n\n    private void showNation(String nation) {\n        System.out.println(nation);\n    }\n\n    @MyAnnotation\n    public String display(String msg) {\n        return msg;\n    }\n\n    @Override\n    public void info() {\n        System.out.println(\"info...\");\n    }\n\n    @Override\n    public int compareTo(String o) {\n        return 0;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/","title":"\u591a\u7ebf\u7a0b","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_1","title":"\u4e00\u3001\u7ebf\u7a0b\u7684\u521b\u5efa\u548c\u4f7f\u7528","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#1-thread","title":"1. \u65b9\u5f0f\u4e00\uff1a\u7ee7\u627fThread\u7c7b","text":"<pre><code>public class ThreadTest {\n    public static void main(String[] args) {\n        // 3. \u521b\u5efaThread\u7c7b\u5b50\u7c7b\u7684\u5bf9\u8c61\n        MyThread t = new MyThread();\n        // 4. \u901a\u8fc7\u6b64\u5bf9\u8c61\u8c03\u7528start(): \u2460\u542f\u52a8\u5f53\u524d\u7ebf\u7a0b\uff1b\u2461\u8c03\u7528\u5f53\u524d\u7ebf\u7a0b\u7684run()\n        t.start();\n        // \u5176\u4ed6\u4ee3\u7801\u4ecd\u7136\u5728main\u7ebf\u7a0b\u4e2d\u6267\u884c\n    }\n}\n\n// 1. \u521b\u5efa\u7ee7\u627f\u4e8eThread\u7c7b\u7684\u5b50\u7c7b\nclass MyThread extends Thread {\n    // 2. \u91cd\u5199Thread\u7c7b\u7684run\u65b9\u6cd5\n    public void run() {\n        for (int i = 0; i &lt; 100; i++) {\n            if (i % 2 == 0) {\n                System.out.println(i);\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#2-runnable","title":"2. \u65b9\u5f0f\u4e8c\uff1a\u5b9e\u73b0<code>Runnable</code>\u63a5\u53e3","text":"<pre><code>package com.example.www;\n\npublic class ThreadTest {\n    public static void main(String[] args) {\n        // 3. \u521b\u5efa\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\n        MyThread myThread = new MyThread();\n        // 4. \u5c06\u6b64\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230Thread\u7c7b\u7684\u6784\u9020\u5668\u4e2d\uff0c\u521b\u5efaThread\u7c7b\u7684\u5bf9\u8c61\n        Thread t = new Thread(myThread);\n        // 5. \u901a\u8fc7Thread\u7c7b\u7684\u5bf9\u8c61\u8c03\u7528start()\n        t.start();\n    }\n}\n\n// 1. \u521b\u5efa\u4e00\u4e2a\u5b9e\u73b0\u4e86Runnable\u63a5\u53e3\u7684\u7c7b\nclass MyThread implements Runnable {\n    // 2. \u5b9e\u73b0\u7c7b\u53bb\u5b9e\u73b0Runnable\u4e2d\u7684\u62bd\u8c61\u65b9\u6cd5run()\n    public void run() {\n        for (int i = 0; i &lt; 100; i++) {\n            if (i % 2 == 0) {\n                System.out.println(i);\n            }\n        }\n    }\n}\n</code></pre> <p>\u5f00\u53d1\u4e2d\u4f18\u5148\u4f7f\u7528\u8fd9\u79cd\u65b9\u5f0f</p> <ol> <li>\u5b9e\u73b0\u7684\u65b9\u6cd5\u6ca1\u6709\u7c7b\u7684\u5355\u7ee7\u627f\u6027\u7684\u5c40\u9650\u6027</li> <li>\u5b9e\u73b0\u7684\u65b9\u6cd5\u66f4\u9002\u5408\u6765\u5904\u7406\u6709\u5171\u4eab\u6570\u636e\u7684\u60c5\u51b5</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#3-callable","title":"3. \u65b9\u5f0f\u4e09\uff1a\u5b9e\u73b0Callable\u63a5\u53e3","text":"<ol> <li>\u53ef\u4ee5\u6709\u8fd4\u56de\u503c</li> <li>\u65b9\u6cd5\u53ef\u4ee5\u8dd1\u51fa\u5f02\u5e38</li> <li>\u652f\u6301\u6cdb\u578b\u7684\u8fd4\u56de\u503c</li> <li>\u9700\u8981\u501f\u52a9<code>FutureTask</code>\u7c7b\uff0c\u5fc5\u987b\u83b7\u53d6\u8fd4\u56de\u7ed3\u679c\u3002<ol> <li>\u53ef\u4ee5\u5bf9\u5177\u4f53<code>Runnable</code>\u3001<code>Callable</code>\u4efb\u52a1\u7684\u6267\u884c\u7ed3\u679c\u8fdb\u884c\u53d6\u6d88\u3001\u67e5\u8be2\u662f\u5426\u5b8c\u6210\u3001\u83b7\u53d6\u7ed3\u679c\u7b49\u3002</li> <li><code>FutureTask</code>\u662fFuture\u63a5\u53e3\u7684\u552f\u4e00\u7684\u5b9e\u73b0\u7c7b</li> <li><code>FutureTask</code>\u540c\u65f6\u5b9e\u73b0\u4e86<code>Runnable</code>\u3001<code>Future</code>\u63a5\u53e3\u3002\u65e2\u53ef\u4ee5\u4f5c\u4e3a<code>Runnable</code>\u88ab\u7ebf\u7a0b\u6267\u884c\uff0c\u53c8\u53ef\u4ee5\u4f5c\u4e3a<code>Future</code>\u5f97\u5230<code>Callable</code>\u7684\u8fd4\u56de\u503c\u3002</li> </ol> </li> </ol> <pre><code>/*\nCallable\u6bd4Runnable\u66f4\u5f3a\u5927\n1. call()\u53ef\u4ee5\u6709\u8fd4\u56de\u503c\n2. call()\u53ef\u4ee5\u8dd1\u51fa\u5f02\u5e38\uff0c\u88ab\u5916\u9762\u7684\u64cd\u4f5c\u6355\u83b7\uff0c\u83b7\u53d6\u5f02\u5e38\u7684\u4fe1\u606f\n3. Callable\u662f\u652f\u6301\u6cdb\u578b\u7684\n*/\nimport java.util.concurrent.Callable;\nimport java.util.concurrent.ExecutionException;\nimport java.util.concurrent.FutureTask;\n\npublic class ThreadTest {\n    public static void main(String[] args) {\n\n        // 3. \u521b\u5efaCallable\u63a5\u53e3\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\n        MyThread t = new MyThread();\n        // 4. \u5c06\u6b64Callable\u63a5\u53e3\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\u4f20\u9012\u5230FutureTask\u6784\u9020\u5668\u4e2d\uff0c\u521b\u5efaFutureTask\u7684\u5bf9\u8c61\n        FutureTask&lt;Integer&gt; futureTask = new FutureTask&lt;Integer&gt;(t);\n        // 5. \u5c06FutureTask\u7684\u5bf9\u8c61\u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u5230Thread\u7c7b\u7684\u6784\u9020\u5668\u4e2d\uff0c\u521b\u5efaThread\u5bf9\u8c61\uff0c\u5e76\u8c03\u7528start()\n        new Thread(futureTask).start();\n\n        try {\n            // get() \u8fd4\u56de\u503c\u662fFutureTask\u6784\u9020\u5668\u53c2\u6570Callable\u5b9e\u73b0\u7c7b\u91cd\u5199\u7684call()\u7684\u8fd4\u56de\u503c\n            // 6. \u83b7\u53d6Callable\u4e2dcall\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\n            Integer sum =  futureTask.get();\n            System.out.println(sum);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } catch (ExecutionException e) {\n            e.printStackTrace();\n        }\n    }\n}\n\n// 1 \u521b\u5efa\u4e00\u4e2a\u5b9e\u73b0Callable\u7684\u5b9e\u73b0\u7c7b\nclass MyThread implements Callable&lt;Integer&gt; {\n\n    // 2. \u5b9e\u73b0call()\u65b9\u6cd5\uff0c\u5c06\u6b64\u7ebf\u7a0b\u9700\u8981\u6267\u884c\u7684\u64cd\u4f5c\u58f0\u660e\u5728call()\u65b9\u6cd5\u4e2d\n    @Override\n    public Integer call() throws Exception {\n        int sum = 0;\n        for (int i = 1; i &lt; 100; i++) {\n            if (i % 2 == 0){\n                sum += i;\n            }\n        }\n        return sum; // \u53ef\u4ee5\u6709\u8fd4\u56de\u503c\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#4","title":"4. \u65b9\u5f0f\u56db\uff1a\u4f7f\u7528\u7ebf\u7a0b\u6c60","text":"<pre><code>/*\n* \u7ebf\u7a0b\u6c60\u7684\u597d\u5904\uff1a\n* 1. \u63d0\u9ad8\u54cd\u5e94\u901f\u5ea6\n* 2. \u964d\u4f4e\u8d44\u6e90\u6d88\u8017\n* 3. \u4fbf\u4e8e\u7ebf\u7a0b\u7ba1\u7406\n*/\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.ThreadPoolExecutor;\n\npublic class ThreadPoolTest {\n    public static void main(String[] args) {\n        ExecutorService executorService = Executors.newFixedThreadPool(10);\n        ThreadPoolExecutor service = (ThreadPoolExecutor) executorService;\n        // \u8bbe\u7f6e\u7ebf\u7a0b\u6c60\u5c5e\u6027\n        service.setCorePoolSize(15);\n        //        service.setKeepAliveTime();\n\n        //        service.execute(); // \u9002\u7528\u4e8eRunnable\n        //        service.submit(); // \u9002\u7528\u4e8eCallable\n        service.execute(new MyThread1());\n        service.shutdown();\n    }\n}\n\n\nclass MyThread1 implements Runnable {\n    @Override\n    public void run() {\n        for (int i = 0; i &lt;= 100; i++) {\n            if (i % 2 == 0) {\n                System.out.println(i);\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#5","title":"5. \u7ebf\u7a0b\u7684\u5e38\u7528\u65b9\u6cd5","text":"<pre><code>package com.example.www;\n\npublic class ThreadMethodTest {\n    public static void main(String[] args) {\n        MyThread t = new MyThread();\n        t.setName(\"Thread-zero\"); // \u81ea\u5b9a\u4e49\u7ebf\u7a0b\u540d\n        t.start();\n        // \u5224\u65ad\u5f53\u524d\u8fdb\u7a0b\u662f\u5426\u5b58\u6d3b\n        System.out.println(t.isAlive()); // true\n        for (int i = 0; i &lt; 100; i++) {\n            if (i % 2 != 0) {\n                System.out.println(Thread.currentThread().getName() + \":\" + i);\n            }\n            if (i == 20) {\n                try {\n                    // \u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u76f4\u5230\u7ebf\u7a0bt\u5b8c\u5168\u6267\u884c\u5b8c\u4ee5\u540e\n                    t.join();\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n\nclass MyThread extends Thread {\n    public void run() {\n        for (int i = 0; i &lt; 100; i++) {\n            if (i % 2 == 0) {\n                // currentThread() \u9759\u6001\u65b9\u6cd5\uff0c\u8fd4\u56de\u6267\u884c\u5f53\u524d\u4ee3\u7801\u7684\u7ebf\u7a0b\n                // getName() \u83b7\u53d6\u5f53\u524d\u7ebf\u7a0b\u540d\n                System.out.println(Thread.currentThread().getName() + \":\" + i); // Thread-zero \u9ed8\u8ba4\u662f\uff1aThread-0\n            }\n//            if (i % 20 == 0) {\n//                yield(); // \u91ca\u653e\u5f53\u524dCPU\u7684\u6267\u884c\u6743\n//            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#6","title":"6. \u7ebf\u7a0b\u4f18\u5148\u7ea7","text":"<pre><code>// MIN_PRIORITY = 1\n// NORM_PRIORITY = 5\n// MAX_PRIORITY = 10\npublic class ThreadMethodTest {\n    public static void main(String[] args) {\n        MyThread t = new MyThread();\n        // \u8bbe\u7f6e\u7ebf\u7a0b\u7684\u4f18\u5148\u7ea7\n        t.setPriority(7);\n        t.start();\n        // \u83b7\u53d6\u7ebf\u7a0b\u7684\u4f18\u5148\u7ea7\n        System.out.println(t.getPriority()); // 7\n    }\n}\n\nclass MyThread extends Thread {\n    public void run() {\n        for (int i = 0; i &lt; 100; i++) {\n            if (i % 2 == 0) {\n                System.out.println(i);\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_2","title":"\u4e8c\u3001\u7ebf\u7a0b\u7684\u751f\u547d\u5468\u671f","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_3","title":"\u4e09\u3001\u7ebf\u7a0b\u540c\u6b65","text":"<p>\u4e70\u7968\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u4e86\u91cd\u7968\u548c\u9519\u7968 --&gt; \u51fa\u73b0\u4e86\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898</p> <p>\u5728Java\u4e2d\u901a\u8fc7\u540c\u6b65\u673a\u5236\u6765\u89e3\u51b3\u7ebf\u7a0b\u7684\u5b89\u5168\u95ee\u9898</p> <p>\u64cd\u4f5c\u540c\u6b65\u4ee3\u7801\u65f6\uff0c\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u53c2\u4e0e\uff0c\u5176\u4ed6\u7ebf\u7a0b\u7b49\u5f85\uff0c\u76f8\u5f53\u4e8e\u662f\u4e00\u4e2a\u5355\u7ebf\u7a0b\u7684\u8fc7\u7a0b\uff0c\u6548\u7387\u4f4e\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#1","title":"1. \u65b9\u6cd5\u4e00\uff1a\u540c\u6b65\u4ee3\u7801\u5757","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#11-runnable","title":"1.1 \u540c\u6b65\u4ee3\u7801\u5757\u5904\u7406\u5b9e\u73b0<code>Runnable</code>\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<pre><code>/*\nsynchronized(\u540c\u6b65\u76d1\u89c6\u5668){ // \u540c\u6b65\u76d1\u89c6\u5668\uff1a\u4fd7\u79f0\u9501\uff0c\u4efb\u4f55\u4e00\u4e2a\u7c7b\u7684\u5bf9\u8c61\u90fd\u53ef\u4ee5\u5145\u5f53\u9501\n     \u9700\u8981\u88ab\u540c\u6b65\u7684\u4ee3\u7801 // \u64cd\u4f5c\u5171\u4eab\u6570\u636e\u7684\u4ee3\u7801\n}\n*/\npublic class TicketWindowTest {\n    public static void main(String[] args) {\n        Window window = new Window();\n        Thread t1 = new Thread(window);\n        Thread t2 = new Thread(window);\n        Thread t3 = new Thread(window);\n\n        t1.setName(\"\u7a97\u53e31\");\n        t2.setName(\"\u7a97\u53e32\");\n        t3.setName(\"\u7a97\u53e33\");\n\n        t1.start();\n        t2.start();\n        t3.start();\n    }\n}\n\n\nclass Window implements Runnable {\n    private int ticket = 100;\n    // new \u4e00\u4e2a\u5bf9\u8c61\u5145\u5f53\u9501\n    // Object obj = new Object(); // \u591a\u4e2a\u7ebf\u7a0b\u5fc5\u987b\u8981\u516c\u7528\u4e00\u628a\u9501\n\n\n    public void run() {\n        while (true) {\n            // synchronized(obj) {\n            synchronized(this) { // \u7528\u5f53\u524d\u5bf9\u8c61\u5145\u5f53\u9501\uff0c\u6b64\u65f6\u7684this\u662f\u552f\u4e00\u7684Window\u5bf9\u8c61\n                if (ticket &gt; 0) {\n                    try {\n                        Thread.sleep(100);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    System.out.println(Thread.currentThread().getName() + \":\u4e70\u7968\uff0c\u7968\u53f7\u4e3a\uff1a\" + ticket);\n                    ticket--;\n                } else {\n                    break;\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#12-thread","title":"1.2 \u540c\u6b65\u4ee3\u7801\u5757\u5904\u7406\u7ee7\u627fThread\u7c7b\u65b9\u5f0f\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<pre><code>public class TicketWindowTest {\n    public static void main(String[] args) {\n        Window t1 = new Window();\n        Window t2 = new Window();\n        Window t3 = new Window();\n\n        t1.setName(\"\u7a97\u53e31\");\n        t2.setName(\"\u7a97\u53e32\");\n        t3.setName(\"\u7a97\u53e33\");\n\n        t1.start();\n        t2.start();\n        t3.start();\n    }\n}\n\nclass Window extends Thread {\n    private static int ticket = 100;\n//    private static Object obj = new Object();\n    public void run() {\n        while (true){\n//            synchronized (obj) {\n            synchronized (Window.class) { // Window\u7c7b\u53ea\u4f1a\u52a0\u8f7d\u4e00\u6b21\uff0c\u6240\u4ee5\u53ef\u4ee5\u4f7f\u7528\u5f53\u524d\u7c7b\u5145\u5f53\u9501\n                if (ticket &gt; 0) {\n                    try {\n                        Thread.sleep(100); // \u6dfb\u52a0\u5ef6\u65f6\uff0c\u589e\u52a0\u51fa\u9519\u6982\u7387\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    System.out.println(getName() + \":\u4e70\u7968\uff0c\u7968\u53f7\u4e3a\uff1a\" + ticket);\n                    ticket--;\n                } else {\n                    break;\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#2","title":"2. \u65b9\u6cd5\u4e00\uff1a\u540c\u6b65\u65b9\u6cd5","text":"<ol> <li>\u540c\u6b65\u65b9\u6cd5\u4ecd\u7136\u6d89\u53ca\u5230\u540c\u6b65\u76d1\u89c6\u5668\uff0c\u53ea\u662f\u4e0d\u9700\u8981\u663e\u793a\u58f0\u660e\u3002</li> <li>\u975e\u9759\u6001\u7684\u540c\u6b65\u65b9\u6cd5\uff0c\u540c\u6b65\u76d1\u89c6\u5668\u662f<code>this</code>\u3002</li> <li>\u9759\u6001\u7684\u540c\u6b65\u65b9\u6cd5\uff0c\u540c\u6b65\u76d1\u89c6\u5668\u662f\u5f53\u524d\u7c7b\u672c\u8eab\u3002</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#21-runnable","title":"2.1 \u540c\u6b65\u4ee3\u7801\u5757\u5904\u7406\u5b9e\u73b0<code>Runnable</code>\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<p>\u5982\u679c\u64cd\u4f5c\u5171\u4eab\u6570\u636e\u7684\u4ee3\u7801\u5b8c\u6574\u7684\u58f0\u660e\u5728\u4e00\u4e2a\u65b9\u6cd5\u4e2d\uff0c\u53ef\u4ee5\u5c06\u6b64\u65b9\u6cd5\u58f0\u660e\u4e3a\u540c\u6b65\u7684\u3002</p> <pre><code>package com.example.www;\n\npublic class TicketWindowTest {\n    public static void main(String[] args) {\n        Window window = new Window();\n        Thread t1 = new Thread(window);\n        Thread t2 = new Thread(window);\n        Thread t3 = new Thread(window);\n\n        t1.setName(\"\u7a97\u53e31\");\n        t2.setName(\"\u7a97\u53e32\");\n        t3.setName(\"\u7a97\u53e33\");\n\n        t1.start();\n        t2.start();\n        t3.start();\n    }\n}\n\n\nclass Window implements Runnable {\n    private int ticket = 100;\n\n    public void run() {\n        while (ticket &gt; 0) {\n            ticket();\n        }\n    }\n\n    public synchronized void ticket() {  // \u540c\u6b65\u65b9\u6cd5\n        if (ticket &gt; 0) {\n            try {\n                Thread.sleep(100);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(Thread.currentThread().getName() + \":\u4e70\u7968\uff0c\u7968\u53f7\u4e3a\uff1a\" + ticket);\n            ticket--;\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#22-thread","title":"2.2 \u540c\u6b65\u4ee3\u7801\u5757\u5904\u7406\u5b9e\u73b0\u7ee7\u627fThread\u7c7b\u65b9\u5f0f\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<pre><code>package com.example.www;\n\n/*\n\u4f7f\u7528\u540c\u6b65\u65b9\u6cd5\u5904\u7406\u7ee7\u627fThread\u7684\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\n*/\npublic class TicketWindowTest {\n    public static void main(String[] args) {\n        Window t1 = new Window();\n        Window t2 = new Window();\n        Window t3 = new Window();\n\n        t1.setName(\"\u7a97\u53e31\");\n        t2.setName(\"\u7a97\u53e32\");\n        t3.setName(\"\u7a97\u53e33\");\n\n        t1.start();\n        t2.start();\n        t3.start();\n    }\n}\n\nclass Window extends Thread {\n    private static int ticket = 100;\n\n    public void run() {\n        while (ticket &gt; 0) {\n            ticket();\n        }\n    }\n\n    public static synchronized void ticket() { // \u9700\u8981\u5305\u88c5\u6b64\u65b9\u6cd5\u65f6\u9759\u6001\u7684, \u6b64\u65f6\u7684\u540c\u6b65\u76d1\u89c6\u5668\u662f\u5f53\u524d\u7c7b\n        if (ticket &gt; 0) {\n            try {\n                Thread.sleep(100);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            System.out.println(Thread.currentThread().getName() + \":\u4e70\u7968\uff0c\u7968\u53f7\u4e3a\uff1a\" + ticket);\n            ticket--;\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_4","title":"\u56db\u3001\u6b7b\u9501","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#1_1","title":"1. \u6b7b\u9501","text":"<pre><code>/*\n\u6a21\u62df\u7ebf\u7a0b\u6b7b\u9501\n\u4f7f\u7528\u540c\u6b65\u65f6\u8981\u907f\u514d\u6b7b\u9501\n*/\n\npublic class LockTest {\n    public static void main(String[] args) {\n        StringBuffer str1 = new StringBuffer();\n        StringBuffer str2 = new StringBuffer();\n\n        new Thread(){\n            @Override\n            public void run() {\n                synchronized (str1){\n                    str1.append(\"A\");\n                    str2.append(\"1\");\n                    try {\n                        Thread.sleep(100);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    synchronized (str2){\n                        str1.append(\"B\");\n                        str2.append(\"2\");\n                        System.out.println(str1);\n                        System.out.println(str2);\n                    }\n                }\n            }\n        }.start();\n\n        new Thread(new Runnable() {\n            @Override\n            public void run() {\n                synchronized (str2){\n                    str1.append(\"C\");\n                    str2.append(\"3\");\n                    try {\n                        Thread.sleep(100);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    synchronized (str1){\n                        str1.append(\"D\");\n                        str2.append(\"4\");\n                        System.out.println(str1);\n                        System.out.println(str2);\n                    }\n                }\n            }\n        }).start();\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#2-lock","title":"2. Lock\u9501\u65b9\u6cd5\u89e3\u51b3\u7ebf\u7a0b\u5b89\u5168\u95ee\u9898","text":"<pre><code>package com.example.www;\n\nimport java.util.concurrent.locks.ReentrantLock;\n\npublic class TicketWindowTest {\n    public static void main(String[] args) {\n        Window window = new Window();\n        Thread t1 = new Thread(window);\n        Thread t2 = new Thread(window);\n        Thread t3 = new Thread(window);\n\n        t1.setName(\"\u7a97\u53e31\");\n        t2.setName(\"\u7a97\u53e32\");\n        t3.setName(\"\u7a97\u53e33\");\n\n        t1.start();\n        t2.start();\n        t3.start();\n    }\n}\n\n\nclass Window implements Runnable {\n    private int ticket = 100;\n    // 1. \u521b\u5efa\u9501\n    private ReentrantLock lock = new ReentrantLock();\n\n    public void run() {\n        while (true) {\n            try {\n                // 2. \u8c03\u7528\u9501\u5b9a\u65b9\u6cd5\n                lock.lock();\n                if (ticket &gt; 0) {\n                    try {\n                        Thread.sleep(100);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    System.out.println(Thread.currentThread().getName() + \":\u4e70\u7968\uff0c\u7968\u53f7\u4e3a\uff1a\" + ticket);\n                    ticket--;\n                } else {\n                    break;\n                }\n            } finally {\n                // 3. \u91ca\u653e\u9501\n                lock.unlock();\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_5","title":"\u4e94\u3001\u7ebf\u7a0b\u901a\u4fe1","text":"<pre><code>// \u7ebf\u7a0b\u901a\u4fe1\u793a\u4f8b\n// \u4e24\u4e2a\u7ebf\u7a0b\u4ea4\u66ff\u6253\u53701-100\n/*\n\u6d89\u53ca\u5230\u7684\u65b9\u6cd5\nwait(): \u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\uff0c\u5e76\u91ca\u653e\u540c\u6b65\u76d1\u89c6\u5668\nnotify(): \u5524\u9192\u4e00\u4e2a\u88abwait()\u7684\u7ebf\u7a0b\nnotifyAll(): \u5524\u9192\u6240\u6709\u88abwait()\u7684\u7ebf\u7a0b\n\u6ce8\u610f\uff1a\n1. \u53ea\u80fd\u5728\u540c\u6b65\u4ee3\u7801\u5757\u6216\u540c\u6b65\u65b9\u6cd5\u4e2d\u4f7f\u7528\n2. \u8c03\u7528\u8005\u5fc5\u987b\u662f\u540c\u6b65\u4ee3\u7801\u5757\u6216\u540c\u6b65\u65b9\u6cd5\u4e2d\u7684\u540c\u6b65\u76d1\u89c6\u5668\n3. \u8fd9\u4e09\u4e2a\u65b9\u6cd5\u5b9a\u4e49\u5728Object\u4e2d\n*/\npublic class CommunicationTest {\n    public static void main(String[] args) {\n        Number number = new Number();\n        Thread t1 = new Thread(number);\n        Thread t2 = new Thread(number);\n        t1.start();\n        t2.start();\n    }\n}\n\n\nclass Number implements Runnable {\n    private int number = 1;\n\n    @Override\n    public void run() {\n        while (true) {\n            synchronized (this) {\n                notify();\n                try {\n                    Thread.sleep(100);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                if (number &lt;= 100){\n                    System.out.println(Thread.currentThread().getName() + \":\" + number);\n                    number++;\n                    try {\n                        wait(); // \u4f7f\u5f97\u8c03\u7528\u5982\u4e0bwait()\u65b9\u6cd5\u7684\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }else {\n                    break;\n                }\n            }\n\n        }\n    }\n}\n</code></pre> <p><code>sleep()</code>\u548c<code>wait()</code>\u7684\u5f02\u540c</p> <p>\u76f8\u540c\u70b9\uff1a</p> <ol> <li>\u90fd\u53ef\u4ee5\u4f7f\u5f53\u524d\u7ebf\u7a0b\u8fdb\u5165\u963b\u585e\u72b6\u6001</li> </ol> <p>\u4e0d\u540c\u7684\uff1a</p> <ol> <li>\u4e24\u4e2a\u65b9\u6cd5\u58f0\u660e\u7684\u4f4d\u7f6e\u4e0d\u540c\uff1aThread\u7c7b\u4e2d\u58f0\u660e<code>sleep()</code>\uff0cObject\u4e2d\u58f0\u660e<code>wait()</code></li> <li>\u8c03\u7528\u7684\u8981\u6c42\u4e0d\u540c\uff1a<code>sleep()</code>\u53ef\u4ee5\u5728\u4efb\u4f55\u9700\u8981\u7684\u573a\u666f\u4e0b\u8c03\u7528\u3002<code>wait()</code>\u5fc5\u987b\u4f7f\u7528\u5728\u540c\u6b65\u4ee3\u7801\u5757\u6216\u540c\u6b65\u65b9\u6cd5\u4e2d\u3002</li> <li>\u5173\u4e8e\u662f\u5426\u91ca\u653e\u540c\u6b65\u76d1\u89c6\u5668\uff1a\u5982\u679c\u4e24\u4e2a\u65b9\u6cd5\u90fd\u4f7f\u7528\u5728\u540c\u6b65\u4ee3\u7801\u5757\u6216\u540c\u6b65\u65b9\u6cd5\u4e2d\uff0c<code>sleep()</code>\u4e0d\u4f1a\u91ca\u653e\u9501\uff0c<code>wait()</code>\u4f1a\u91ca\u653e\u9501\u3002</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%A4%9A%E7%BA%BF%E7%A8%8B/#_6","title":"\u516d\u3001\u751f\u4ea7\u8005\u6d88\u8d39\u8005","text":"<pre><code>package com.example.www;\n\n/*\n * \u7ebf\u7a0b\u901a\u4fe1\u7684\u5e94\u7528\n * \u591a\u7ebf\u7a0b\uff1a\u751f\u4ea7\u8005 \u6d88\u8d39\u8005\n * \u6570\u636e\u5171\u4eab\n * \u7ebf\u7a0b\u5b89\u5168\u95ee\u9898\u5904\u7406\n * \u7ebf\u7a0b\u901a\u4fe1\n */\npublic class ProductorCustomerTest {\n    public static void main(String[] args) {\n        Clerk clerk = new Clerk();\n        Productor p1 = new Productor(clerk);\n        p1.setName(\"\u751f\u4ea7\u80051\");\n        Customer c1 = new Customer(clerk);\n        c1.setName(\"\u6d88\u8d39\u80051\");\n        p1.start();\n        c1.start();\n    }\n}\n\nclass Clerk {\n\n    private int produceCount = 0;\n\n    public synchronized void ProduceProduct() {\n        if (produceCount &lt; 20) {\n            produceCount++;\n            System.out.println(Thread.currentThread().getName() + \"\uff1a\u5f00\u59cb\u751f\u4ea7\u7b2c\" + produceCount + \"\u4e2a\u4ea7\u54c1\");\n            notify();\n        } else {\n            // \u7b49\u5f85\n            try {\n                wait();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n\n    public synchronized void CustomeProduct() {\n        if (produceCount &gt; 0) {\n            System.out.println(Thread.currentThread().getName() + \"\uff1a\u5f00\u59cb\u6d88\u8d39\u7b2c\" + produceCount + \"\u4e2a\u4ea7\u54c1\");\n            produceCount--;\n            notify();\n        } else {\n            //\u7b49\u5f85\n            try {\n                wait();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n\nclass Productor extends Thread {\n    private Clerk clerk;\n\n    public Productor(Clerk clerk) {\n        this.clerk = clerk;\n    }\n\n    @Override\n    public void run() {\n        System.out.println(getName() + \"\uff1a\u5f00\u59cb\u751f\u4ea7\u4ea7\u54c1...\");\n\n        while (true) {\n            try {\n                Thread.sleep(100);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            clerk.ProduceProduct();\n        }\n    }\n}\n\nclass Customer extends Thread {\n    private Clerk clerk;\n\n    public Customer(Clerk clerk) {\n        this.clerk = clerk;\n    }\n\n    public void run() {\n        System.out.println(getName() + \"\uff1a\u5f00\u59cb\u751f\u4ea7\u4ea7\u54c1...\");\n\n        while (true) {\n            try {\n                Thread.sleep(100);\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n            clerk.CustomeProduct();\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/","title":"\u5e38\u7528\u7c7b","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#_1","title":"\u4e00\u3001\u5b57\u7b26\u4e32\u76f8\u5173","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#1string","title":"1.<code>String</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#11-string","title":"1.1 <code>String</code>\u7684\u4e0d\u53ef\u53d8\u6027","text":"<pre><code>/*\n * 1. \u58f0\u660e\u4e3afinal\u7684\uff0c\u4e0d\u53ef\u88ab\u57fa\u7840\n * 2. \u5b9e\u73b0\u4e86Serializable\u63a5\u53e3\uff1a\u8868\u793a\u5b57\u7b26\u4e32\u662f\u652f\u6301\u5e8f\u5217\u5316\u7684\n * 3. \u5b9e\u73b0\u4e86Comparable\u63a5\u53e3\uff1a\u8868\u793a\u5b57\u7b26\u4e32\u53ef\u4ee5\u6bd4\u8f83\u5927\u5c0f\n * 4. \u5185\u90e8\u5b9a\u4e49\u4e86final char[] value\u7528\u4e8e\u5b58\u50a8\u5b57\u7b26\u4e32\u6570\u636e\n * 5. Sting\uff1a\u4ee3\u8868\u4e0d\u53ef\u53d8\u7684\u5b57\u7b26\u5e8f\u5217\uff0c\u7b80\u79f0\uff1a\u4e0d\u53ef\u53d8\u6027\n *    \u5f53\u5bf9\u5b57\u7b26\u4e32\u91cd\u65b0\u8d4b\u503c\u65f6\uff0c\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u5185\u5b58\u533a\u57df\u8d4b\u503c\uff0c\u4e0d\u80fd\u5728\u539f\u6709\u7684value\u8fdb\u884c\u8d4b\u503c\n *    \u5f53\u5bf9\u73b0\u6709\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u8fde\u63a5\u64cd\u4f5c\u65f6\uff0c\u4e5f\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u5185\u5b58\u533a\u57df\u8d4b\u503c\uff0c\u4e0d\u80fd\u5728\u539f\u6709\u7684value\u8fdb\u884c\u8d4b\u503c\n *    \u5f53\u8c03\u7528String\u7684replace\u65b9\u6cd5\u4fee\u6539\u6307\u5b9a\u5b57\u7b26\u6216\u5b57\u7b26\u4e32\u65f6\uff0c\u4e5f\u9700\u8981\u91cd\u65b0\u6307\u5b9a\u5185\u5b58\u533a\u57df\u8d4b\u503c\uff0c\u4e0d\u80fd\u5728\u539f\u6709\u7684value\u8fdb\u884c\u8d4b\u503c\n * 6. \u901a\u8fc7\u5b57\u9762\u91cf\u7684\u65b9\u6cd5\uff08\u533a\u522b\u4e8enew\uff09\u7ed9\u4e00\u4e2a\u5b57\u7b26\u4e32\u8d4b\u503c\uff0c\u6b64\u65f6\u7684\u5b57\u7b26\u4e32\u503c\u58f0\u660e\u5728\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u4e2d\u3002\n * 7. \u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u4e2d\u7684\u4e0d\u4f1a\u5b58\u50a8\u76f8\u540c\u5185\u5bb9\u7684\u5b57\u7b26\u4e32\u7684\n */\npublic class StringTest {\n    public static void main(String[] args) {\n        String str1 = \"abc\"; // \u5b57\u9762\u91cf\u7684\u5b9a\u4e49\u65b9\u5f0f\n        String str2 = \"abc\";\n        System.out.println(str1 == str2); // true \u5730\u5740\u503c\u76f8\u540c\n        str1 = \"hello\";\n\n        System.out.println(str1); // hello\n        System.out.println(str2); // abc\n\n        System.out.println(\"*************\");\n\n        String str3 = \"abc\";\n        str3 += \"def\";\n        System.out.println(str3); // abcdef\n        System.out.println(str2); // abc\n\n        System.out.println(\"*************\");\n        String str4 = \"abc\";\n        String str5 = str4.replace(\"a\",\"A\");\n        System.out.println(str4);  // abc\n        System.out.println(str5);  // Abc\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#12","title":"1.2 \u4e0d\u540c\u5b9e\u4f8b\u5316\u65b9\u6cd5\u7684\u5bf9\u6bd4","text":"<pre><code>/*\n * String\u7684\u5b9e\u4f8b\u5316\u65b9\u6cd5\n * 1. \u901a\u8fc7\u5b57\u9762\u91cf\u5b9a\u4e49\u7684\u65b9\u6cd5\n * 2. \u901a\u8fc7new \u6784\u9020\u5668\u7684\u65b9\u6cd5\n *\n */\npublic class StringTest {\n    public static void main(String[] args) {\n        // str1 \u548c str2 \u7684\u6570\u636e\u58f0\u660e\u5728\u65b9\u6cd5\u533a\u7684\u5b57\u7b26\u4e32\u5e38\u91cf\u6c60\u4e2d\n        String str1 = \"abc\";\n        String str2 = \"abc\";\n        // str3 \u548c str4 \u4fdd\u5b58\u7684\u5730\u5740\u503c\uff0c\u662f\u6570\u636e\u5728\u5806\u7a7a\u95f4\u5f00\u8f9f\u7a7a\u95f4\u4ee5\u5bf9\u5e94\u7684\u5730\u5740\u503c\n        String str3 = new String(\"abc\");\n        String str4 = new String(\"abc\");\n\n        System.out.println(str1 == str2); // true\n        System.out.println(str3 == str4); // false\n\n        Person p1 = new Person(\"Tom\");\n        Person p2 = new Person(\"Tom\");\n\n        System.out.println(p1.name == p2.name); // true\n    }\n}\n\n\nclass Person {\n    String name;\n\n    public Person(String name) {\n        this.name = name;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#13","title":"1.3 \u4e0d\u540c\u62fc\u63a5\u65b9\u5f0f\u7684\u5bf9\u6bd4","text":"<pre><code>/*\n * \u5e38\u91cf\u4e0e\u5e38\u91cf\u7684\u62fc\u63a5\u7ed3\u679c\u5728\u5e38\u91cf\u6c60\uff0c\u4e14\u5e38\u91cf\u6c60\u4e2d\u4e0d\u4f1a\u5b58\u5728\u76f8\u540c\u5185\u5bb9\u7684\u53d8\u91cf\n * \u53ea\u6709\u5176\u4e2d\u6709\u4e00\u4e2a\u53d8\u91cf\uff0c\u7ed3\u679c\u5c31\u5728\u5806\u4e2d\n * \u5982\u679c\u62fc\u63a5\u7684\u7ed3\u679c\u8c03\u7528intern()\u65b9\u6cd5\uff0c\u8fd4\u56de\u503c\u5c31\u5728\u5e38\u91cf\u6c60\u4e2d\n */\npublic class StringTest {\n    public static void main(String[] args) {\n        String str1 = \"hello\";\n        String str2 = \"world\";\n\n        String str3 = \"helloworld\";\n        String str4 = \"hello\" + \"world\"; // \u5b57\u9762\u91cf\u7684\u8fde\u63a5\n        String str5 = str1 + \"world\";\n        String str6 = \"hello\" + str2;\n        String str7 = str1 + str2;\n\n        System.out.println(str3 == str4); // true\n        System.out.println(str3 == str5); // false\n        System.out.println(str3 == str6); // false\n        System.out.println(str3 == str7); // false\n        System.out.println(str5 == str6); // false\n        System.out.println(str5 == str7); // false\n        System.out.println(str6 == str7); // false\n\n        String str8 = str5.intern(); // \u8fd4\u56de\u503c\u5f97\u5230\u7684str8\u4f7f\u7528\u7684\u662f\u5e38\u91cf\u6c60\u4e2d\u5df2\u5b58\u5728\u7684helloworld\n        System.out.println(str3 == str8); // true\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#14-string","title":"1.4 <code>String</code>\u5e38\u7528\u65b9\u6cd5","text":"<pre><code>import java.util.Locale;\n\npublic class StringMethodTest {\n    public static void main(String[] args) {\n        String str1 = \"Hello World\";\n        String str2 = \"hello world\";\n        // \u8fd4\u56de\u5b57\u7b26\u4e32\u957f\u5ea6\n        System.out.println(str1.length()); // 11\n        // \u8fd4\u56de\u67d0\u7d22\u5f15\u4f4d\u7f6e\u7684\u5b57\u7b26\n        System.out.println(str1.charAt(1)); // e\n        // \u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u662f\u7a7a\u5b57\u7b26\u4e32\n        System.out.println(str1.isEmpty()); // false\n        // \u4f7f\u7528\u9ed8\u8ba4\u8bed\u8a00\u73af\u5883\uff0c\u5c06\u6240\u6709\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5c0f\u5199\n        System.out.println(str1.toLowerCase()); // hello world\n        // \u4f7f\u7528\u9ed8\u8ba4\u8bed\u8a00\u73af\u5883\uff0c\u5c06\u6240\u6709\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5927\u5199\n        System.out.println(str1.toUpperCase()); // HELLO WORLD\n        // \u53bb\u9664\u5b57\u7b26\u4e32\u524d\u540e\u7a7a\u767d\n        System.out.println(str1.trim()); // Hello World\n        // \u5b57\u7b26\u4e32\u62fc\u63a5\uff0c\u76f8\u5f53\u4e8e\u7528\u201c+\u201d\n        System.out.println(str1.concat(\"!\")); // Hello World!\n        // \u6bd4\u8f83\u4e24\u4e2a\u5b57\u7b26\u4e32\u7684\u5927\u5c0f\n        System.out.println(str1.compareTo(str2)); // -32\n        // \u8fd4\u56de\u73b0\u6709\u5b57\u7b26\u4e32\u7684\u5b50\u4e32\n        System.out.println(str1.substring(6)); // World\n        System.out.println(str1.substring(6, 8)); // Wo  \u5de6\u95ed\u53f3\u5f00\n        // \u5224\u65ad\u662f\u5426\u4ee5\u6307\u5b9a\u540e\u7f00\u7ed3\u675f\n        System.out.println(str1.endsWith(\"W\")); // false\n        // \u5224\u65ad\u662f\u5426\u4ee5\u6307\u5b9a\u540e\u7f00\u5f00\u59cb\n        System.out.println(str1.startsWith(\"He\")); // true\n        // \u5224\u65ad\u4ece\u6307\u5b9a\u5e8f\u7d22\u5f15\u4f4d\u7f6e\u5f00\u59cb\uff0c\u662f\u5426\u4ee5\u6307\u5b9a\u540e\u7f00\u5f00\u59cb\n        System.out.println(str1.startsWith(\"W\", 6)); // true\n        // \u5224\u65ad\u5f53\u524d\u5b57\u7b26\u4e32\u662f\u5426\u5305\u542b\u6307\u5b9a\u5b57\u7b26\u4e32\n        System.out.println(str1.contains(\"ll\")); // true\n        // \u8fd4\u56de\u6307\u5b9a\u5b57\u7b26\u4e32\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u5904\u7684\u7d22\u5f15\n        System.out.println(str1.indexOf(\"l\")); // 2  \u627e\u4e0d\u5230\u8fd4\u56de-1\n        // \u4ece\u6307\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u5f00\u59cb\u67e5\u627e\uff0c\u8fd4\u56de\u6307\u5b9a\u5b57\u7b26\u4e32\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u5904\u7684\u7d22\u5f15\n        System.out.println(str1.indexOf(\"ld\", 5)); // 9\n        // \u8fd4\u56de\u6307\u5b9a\u5b57\u7b26\u4e32\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u5904\u7684\u7d22\u5f15(\u4ece\u53f3\u5f80\u5de6)\n        System.out.println(str1.lastIndexOf(\"l\")); // 9\n        // \u4ece\u6307\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u53cd\u5411\u5f00\u59cb\u67e5\u627e\uff0c\u8fd4\u56de\u6307\u5b9a\u5b57\u7b26\u4e32\u5728\u6b64\u5b57\u7b26\u4e32\u4e2d\u7b2c\u4e00\u6b21\u51fa\u73b0\u5904\u7684\u7d22\u5f15(\u4ece\u53f3\u5f80\u5de6)\n        System.out.println(str1.lastIndexOf(\"lo\", 7)); // 3\n\n        //\u66ff\u6362\n        // \u66ff\u6362\u5b57\u7b26\n        System.out.println(str1.replace('o', 'e')); // Helle Werld\n        // \u66ff\u6362\u5b57\u7b26\u4e32\n        System.out.println(str1.replace(\"ll\", \"LL\")); // HeLLo World\n        // \u6b63\u5219\u5339\u914d\u66ff\u6362\n        System.out.println(str1.replaceAll(\"l[a-z]\", \"xx\")); // Hexxo Worxx\n        // \u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u5339\u914d\u6b63\u5219\u8868\u8fbe\u5f0f\n        System.out.println(str1.matches(\"\\\\S{5}\\\\s\\\\S{5}\")); // true\n        //\u5207\u7247\n        String[] strs = str1.split(\" \"); // \u4ee5\u7a7a\u683c\u5206\u9694\n        for (int i = 0; i &lt; strs.length; i++) {\n            System.out.println(strs[i]);\n        }\n        // Hello\n        // World\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#15-stringchar","title":"1.5 <code>String</code>\u4e0e<code>char[]</code>\u4e4b\u95f4\u7684\u8f6c\u6362","text":"<p><code>String</code>\u8f6c\u6362\u4e3a<code>char[]</code></p> <pre><code>public class StringToCharTest {\n    public static void main(String[] args) {\n        // String \u4e0e Char[] \u4e4b\u95f4\u7684\u8f6c\u6362\n        String str = \"Hello World\";\n        char[] charArr = str.toCharArray();\n        for (int i = 0; i &lt; charArr.length; i++) {\n            System.out.println(charArr[i]);\n        }\n    }\n}\n</code></pre> <p><code>char[]</code>\u8f6c\u6362\u4e3a<code>String</code></p> <pre><code>public class StringToCharTest {\n    public static void main(String[] args) {\n        char[] charArr = new char[]{'h', 'e', 'l', 'l', 'o'};\n        String str = new String(charArr);\n        System.out.println(str); // hello\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#16-stringbyte","title":"1.6 <code>String</code>\u4e0e<code>byte[]</code>\u4e4b\u95f4\u7684\u8f6c\u6362","text":"<pre><code>import java.util.Arrays;\n\npublic class StringToCharTest {\n    public static void main(String[] args) {\n        String str = \"abc123\";\n        byte[] strBytes = str.getBytes();  // \u4f7f\u7528\u9ed8\u8ba4\u7684\u5b57\u7b26\u96c6\u8fdb\u884c\u7f16\u7801\n        System.out.println(Arrays.toString(strBytes)); // [97, 98, 99, 49, 50, 51]\n        String str1 = new String(strBytes);\n        System.out.println(str1); // abc123  // \u89e3\u7801\n\n    }\n}\n// \u7f16\u7801\u548c\u89e3\u7801\u65f6\u4f7f\u7528\u7684\u5b57\u7b26\u96c6\u8981\u4e00\u81f4\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#2stringbufferstringbuilder","title":"2.<code>StringBuffer</code>\u548c<code>StringBuilder</code>","text":"<pre><code>// StringBuffer: \u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u6548\u7387\u4f4e\n// StringBuilder: \u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\uff0c\u6548\u7387\u9ad8\n// \u5e95\u5c42\u90fd\u4f7f\u7528char[]\u5b58\u50a8\n// \u53ef\u90fd\u662f\u53d8\u7684\u5b57\u7b26\u5e8f\u5217\n\npublic class StringBufferTest {\n    public static void main(String[] args) {\n        // new StringBuffer()  // new char[16] \u5e95\u5c42\u521b\u5efa\u4e86\u4e00\u4e2a\u957f\u5ea6\u662f16\u7684\u6570\u7ec4\n        StringBuffer str = new StringBuffer(\"hollo\"); // new char[\"abc\".length() + 16]\n        str.setCharAt(1, 'e');\n        System.out.println(str); // hello   // \u53ef\u53d8\u7684\u5b57\u7b26\u5e8f\u5217\n        System.out.println(str.length());  // 5\n        // \u5982\u679c\u8981\u6dfb\u52a0\u7684\u6570\u636e\u5e95\u5c42\u6570\u636e\u76db\u4e0d\u4e0b\uff0c\u5c31\u9700\u8981\u6269\u5bb9\u5e95\u5c42\u7684\u6570\u7ec4\u3002\n        // \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u6269\u5bb9\u4e3a\u539f\u6765\u5bb9\u91cf\u76842\u500d+2\uff0c\u540c\u65f6\u5c06\u539f\u6709\u7684\u6570\u7ec4\u4e2d\u7684\u5143\u7d20\u8d4b\u503c\u5230\u65b0\u7684\u6570\u7ec4\u4e2d\u3002\n\n        // \u5728\u5f00\u53d1\u4e2d\u5efa\u8bae\u4f7f\u7528 StringBuffer(int capacity)\n\n        // \u5e38\u7528\u65b9\u6cd5\n\n        str.append(\" world\");\n        System.out.println(str); // hello world\n        str.delete(10, 11);\n        System.out.println(str); // hello worl\n        str.replace(6, 10, \"xx\");\n        System.out.println(str); // hello xx\n        str.insert(8, '!');\n        System.out.println(str); // hello xx!\n        str.reverse();\n        System.out.println(str); // !xx olleh\n    }\n}\n</code></pre> <p>\u4e09\u8005\u7684\u6548\u7387\uff1a<code>StringBuilder</code>&gt;<code>StringBuffer</code>&gt;<code>String</code></p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#_2","title":"\u4e8c\u3001\u65e5\u671f\u548c\u65f6\u95f4","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#1systemcurrenttimemillis","title":"1.<code>System.currentTimeMillis</code>","text":"<pre><code>// JDK8 \u4e4b\u524d\nimport java.util.Date;\n\nimport static java.lang.System.currentTimeMillis;\n\npublic class DateTimeTest {\n    public static void main(String[] args) {\n\n        long timestamp =  currentTimeMillis();\n        System.out.println(timestamp); // 1636377265852\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#2javautildate","title":"2.<code>java.util.Date</code>","text":"<pre><code>// JDK8 \u4e4b\u524d\nimport java.util.Date;\n\npublic class DateTimeTest {\n    public static void main(String[] args) {\n\n        /*\n        * java.util.Date\u7c7b\n        * 1. \u4e24\u4e2a\u6784\u9020\u5668\u7684\u4f7f\u7528\n        * 2. \u4e24\u4e2a\u65b9\u6cd5\u7684\u4f7f\u7528:toString();  getTime()\n        */\n        // \u521b\u5efa\u4e00\u4e2a\u5bf9\u5e94\u5f53\u524d\u65f6\u95f4\u7684Date\u5bf9\u8c61\n        Date date1 = new Date();\n        System.out.println(date1.toString());  // Mon Nov 08 21:14:25 CST 2021\n        System.out.println(date1.getTime());  // 1636377265853\n        // \u521b\u5efa\u6307\u5b9a\u6beb\u79d2\u6570\u7684Date\u5bf9\u8c61\n        Date date2 = new Date(1636377265853L);\n        System.out.println(date2);\n\n        // java.sql.Date() \u5bf9\u5e94\u6570\u636e\u5e93\u4e2d\u65e5\u671f\u7c7b\u578b\u7684\u53d8\u91cf\n        java.sql.Date date3 = new java.sql.Date(1636377265853L);\n        System.out.println(date3.toString());  // 2021-11-08\n\n        // java.util.Date\u5bf9\u8c61\u8f6c\u6362\u4e3ajava.sql.Date\u5bf9\u8c61\n        Date date4 = new Date();\n        java.sql.Date date5 = new java.sql.Date(date4.getTime());\n        System.out.println(date5);  // 2021-11-08\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#3simpledateformat","title":"3.<code>SimpleDateFormat</code>","text":"<pre><code>// JDK8\u4ee5\u524d\nimport java.text.ParseException;\nimport java.text.SimpleDateFormat;\nimport java.util.Date;\n\npublic class SimpleDateFormatTest {\n    public static void main(String[] args) throws ParseException {\n        // JDK8 \u4e4b\u524d\n        /*\n         * \u683c\u5f0f\u5316\uff1a \u65e5\u671f--&gt;\u5b57\u7b26\u4e32\n         * \u89e3\u6790\uff1a\u5b57\u7b26\u4e32--&gt;\u65e5\u671f\n         */\n        SimpleDateFormat sdf = new SimpleDateFormat();\n\n        Date date = new Date();\n        System.out.println(date);  // Mon Nov 08 21:43:34 CST 2021\n        String format = sdf.format(date);\n        System.out.println(format); // 21-11-8 \u4e0b\u53489:43\n\n        // \u89e3\u6790\n        String str = \"21-11-8 \u4e0b\u53489:47\";\n        Date date1 = sdf.parse(str);\n        System.out.println(date1); // Mon Nov 08 21:47:00 CST 2021\n\n\n        // \u5e26\u53c2\u6570\u7684\u6784\u9020\u5668\n        SimpleDateFormat sdf1 = new SimpleDateFormat(\"yyyy-MM-dd hh:mm:ss\");\n        String format1 = sdf1.format(date);\n        System.out.println(format1);  // 2021-11-08 09:55:19\n\n        // \u89e3\u6790\n        Date date2 = sdf1.parse(\"2021-11-08 09:55:19\");\n        System.out.println(date2); // Mon Nov 08 09:55:19 CST 2021\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#4calendar","title":"4.<code>Calendar</code>","text":"<pre><code>// JDK8\u4ee5\u524d\nimport java.util.Calendar;\nimport java.util.Date;\n\npublic class CalendarTest {\n    public static void main(String[] args) {\n        // Calendar\u662f\u4e00\u4e2a\u62bd\u8c61\u7c7b\n        // \u65b9\u6cd5\u4e00\uff1a\u521b\u5efa\u5176\u5b50\u7c7b\u7684\u5bf9\u8c61\n        // \u65b9\u6cd5\u4e8c\uff1a\u8c03\u7528\u9759\u6001\u65b9\u6cd5 getInstance()\n        Calendar calendar = Calendar.getInstance();\n\n        // \u5e38\u7528\u65b9\u6cd5\n        // get()\n        int month = calendar.get(Calendar.DAY_OF_MONTH);\n        System.out.println(month); // 8\n        // set()  // Calendar\u662f\u53ef\u53d8\u7684\n        calendar.set(Calendar.DAY_OF_MONTH, 1);\n        System.out.println(calendar.get(Calendar.DAY_OF_MONTH)); // 1\n        // add()\n        calendar.add(Calendar.DAY_OF_MONTH, 2); // 3\n        System.out.println(calendar.get(Calendar.DAY_OF_MONTH));\n        //getTime()\n        Date date = calendar.getTime();\n        System.out.println(date);  // Wed Nov 03 22:15:35 CST 2021\n        //setTime()\n        Date now = new Date();\n        calendar.setTime(now);\n        System.out.println(calendar.getTime());  // Mon Nov 08 22:16:55 CST 2021\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#5-localdatelocaltimelocaldatetime","title":"5. <code>LocalDate</code>\u3001<code>LocalTime</code>\u548c<code>LocalDateTime</code>","text":"<pre><code>// JDK8 \u7279\u6027\nimport java.time.LocalDate;\nimport java.time.LocalDateTime;\nimport java.time.LocalTime;\n\npublic class JDK8DateTimeTest {\n    public static void main(String[] args) {\n        // now()\u83b7\u53d6\u5f53\u524d\u7684\u65e5\u671f\u548c\u65f6\u95f4\n        LocalDate localDate = LocalDate.now();\n        LocalTime localTime = LocalTime.now();\n        LocalDateTime localDateTime = LocalDateTime.now(); // \u66f4\u5e38\u7528\n\n        System.out.println(localDate); // 2021-11-16\n        System.out.println(localTime); // 22:07:40.540\n        System.out.println(localDateTime); // 2021-11-16T22:07:40.540\n\n        // of \u8bbe\u7f6e\u6307\u5b9a\u7684\u5e74\u6708\u65e5\u65f6\u5206\u79d2\uff0c\u6ca1\u6709\u504f\u79fb\u91cf\n        LocalDateTime localDateTime1 = LocalDateTime.of(2021, 10, 1, 10, 00, 10);\n        System.out.println(localDateTime1);  // 2021-10-01T10:00:10\n\n\n        // getxx()\n        System.out.println(localDateTime.getDayOfYear()); // 320\n        System.out.println(localDateTime.getDayOfMonth());  // 16\n        System.out.println(localDateTime.getDayOfWeek());  // TUESDAY\n        System.out.println(localDateTime.getMonth());  // NOVEMBER\n\n        // withxx \u8bbe\u7f6e\u65f6\u95f4\u76f8\u5173\u7684\u5c5e\u6027\n        LocalDateTime localDateTime2 = localDateTime1.withDayOfMonth(12);\n        System.out.println(localDateTime1); // 2021-10-01T10:00:10\n        System.out.println(localDateTime2); // 2021-10-12T10:00:10\n\n        // \u65f6\u95f4\u52a0\u51cf\n        System.out.println(localDateTime.plusHours(1)); // 2021-11-16T23:18:42.867  \u52a0\u65f6\u95f4\n        System.out.println(localDateTime.minusHours(1)); // 2021-11-16T21:19:44.087  \u51cf\u65f6\u95f4\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#6instant","title":"6.<code>Instant</code>","text":"<pre><code>import java.time.Instant;\nimport java.time.OffsetDateTime;\nimport java.time.ZoneOffset;\n\npublic class InstantTest {\n    public static void main(String[] args) {\n        Instant instant = Instant.now();\n        System.out.println(instant);  // 2021-11-16T14:24:13.265Z    \u672c\u521d\u5b50\u5348\u7ebf\u65f6\u95f4\n\n        OffsetDateTime offsetDateTime = instant.atOffset(ZoneOffset.ofHours(8));\n        System.out.println(offsetDateTime);  // 2021-11-16T22:27:34.906+08:00 \u4e1c\u516b\u533a\u65f6\u95f4\n\n        // \u81ea1970\u5e741\u67081\u65e50\u65f60\u52060\u79d2\u5f00\u59cb\u7684\u6beb\u79d2\u6570\n        System.out.println(instant.toEpochMilli());  // 1637072931402\n\n        // \u901a\u8fc7\u7ed9\u5b9a\u7684\u6beb\u79d2\u6570\u83b7\u53d6Instant\u5b9e\u4f8b\n        Instant instant1 = Instant.ofEpochMilli(1637072931402L);\n        System.out.println(instant1);  // 2021-11-16T14:28:51.402Z\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#7-datetimeformatter","title":"7. <code>DateTimeFormatter</code>","text":"<pre><code>import java.time.LocalDateTime;\nimport java.time.format.DateTimeFormatter;\nimport java.time.format.FormatStyle;\nimport java.time.temporal.TemporalAccessor;\n\npublic class DateTimeFormatterTest {\n    public static void main(String[] args) {\n        // \u5b9e\u4f8b\u5316\u65b9\u5f0f\u4e00\uff1a\u9884\u5b9a\u4e49\u7684\u6807\u51c6\u683c\u5f0f  \u8f83\u5c11\u4f7f\u7528\n        DateTimeFormatter formatter1 = DateTimeFormatter.ISO_LOCAL_DATE_TIME;\n        // \u683c\u5f0f\u5316\uff1a\u65e5\u671f--&gt;\u5b57\u7b26\u4e32\n        LocalDateTime localDateTime = LocalDateTime.now();\n        String formatStr1 = formatter1.format(localDateTime);\n        System.out.println(formatStr1);  // 2021-11-16T22:37:41.47\n        // \u89e3\u6790\uff1a\u5b57\u7b26\u4e32--&gt;\u65e5\u671f\n        TemporalAccessor parse1 = formatter1.parse(\"2021-11-16T22:37:41.47\");\n        System.out.println(parse1);  // {},ISO resolved to 2021-11-16T22:37:41.470\n\n        // \u5b9e\u4f8b\u5316\u65b9\u5f0f\u4e8c\uff1a\u672c\u5730\u5316\u76f8\u5173\u7684\u683c\u5f0f  \u8f83\u5c11\u4f7f\u7528\n        // FormatStyle.LONG: 2021\u5e7411\u670816\u65e5 \u4e0b\u534810\u65f644\u520605\u79d2\n        // FormatStyle.MEDIUM: 2021-11-16 22:44:59\n        // FormatStyle.SHORT: 21-11-16 \u4e0b\u534810:45\n        DateTimeFormatter formatter2 = DateTimeFormatter.ofLocalizedDateTime(FormatStyle.SHORT);\n        String formatStr2 = formatter2.format(localDateTime);\n        System.out.println(formatStr2);\n\n        // \u5b9e\u4f8b\u5316\u65b9\u5f0f\u4e09\uff1a\u81ea\u5b9a\u4e49\u7684\u683c\u5f0f\n        DateTimeFormatter formatter3 = DateTimeFormatter.ofPattern(\"yyyy-MM-dd hh:mm:ss\");\n        String formatStr3 = formatter3.format(LocalDateTime.now());\n        System.out.println(formatStr3); // 2021-11-16 10:50:36\n        // \u89e3\u6790\n        TemporalAccessor parse2 = formatter3.parse(\"2021-11-16 10:50:36\");\n        System.out.println(parse2);  // {MinuteOfHour=50, HourOfAmPm=10, MilliOfSecond=0, MicroOfSecond=0, SecondOfMinute=36, NanoOfSecond=0},ISO resolved to 2021-11-16\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#java","title":"\u4e09\u3001Java\u6bd4\u8f83\u5668","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#1comparable","title":"1.<code>Comparable</code>\u81ea\u7136\u6392\u5e8f","text":"<pre><code>/*\n * Java \u4e2d\u7684\u5bf9\u8c61\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u53ea\u80fd\u8fdb\u884c==\u3001!= \u6bd4\u8f83\n * \u4e0d\u80fd\u4f7f\u7528 &gt; \u6216 &lt;\n * \u4f46\u662f\u5728\u5f00\u53d1\u573a\u666f\u4e2d\uff0c\u9700\u8981\u5bf9\u591a\u4e2a\u5bf9\u8c61\u8fdb\u884c\u6392\u5e8f\uff0c\u5c31\u9700\u8981\u6bd4\u8f83\u5bf9\u8c61\u7684\u5927\u5c0f\u3002\n * Java\u4e2d\u53ef\u4ee5\u4f7f\u7528Comparable\u6216Comparator\u63a5\u53e3\n */\n\nimport java.util.Arrays;\n\n/*\n Comparable \u63a5\u53e3\u7684\u4f7f\u7528 \uff08\u81ea\u7136\u6392\u5e8f\uff09\n\n \u50cfString\u3001\u5305\u88c5\u7c7b\u7b49\u5b9e\u73b0\u4e86Comparable\u63a5\u53e3\uff0c\u91cd\u5199\u4e86CompareTo()\u65b9\u6cd5\uff0c\u7ed9\u51fa\u4e86\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u5927\u5c0f\u7684\u65b9\u5f0f\n \u8fdb\u884c\u4ece\u5c0f\u5230\u5927\u7684\u6392\u5e8f\n\n \u91cd\u5199CompareTo()\u7684\u89c4\u5219:\n    1. \u5982\u679c\u5f53\u524d\u5bf9\u8c61this\u5927\u4e8e\u5f62\u53c2\u5bf9\u8c61obj\uff0c\u5219\u8fd4\u56de\u6b63\u6574\u6570\uff1b\n        \u5982\u679c\u5f53\u524d\u5bf9\u8c61this\u5c0f\u4e8e\u5f62\u53c2\u5bf9\u8c61obj\uff0c\u5219\u8fd4\u56de\u8d1f\u6574\u6570\uff1b\n        \u5982\u679c\u5f53\u524d\u5bf9\u8c61this\u7b49\u4e8e\u5f62\u53c2\u5bf9\u8c61obj\uff0c\u5219\u8fd4\u56de\u96f6\u3002\n\n \u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7c7b\u6765\u8bf4\uff0c\u5982\u679c\u9700\u8981\u6392\u5e8f\uff0c\u9700\u8981\u81ea\u5b9a\u4e49\u7c7b\u5b9e\u73b0Comparable\u63a5\u53e3\uff0c\u91cd\u5199CompareTo()\u65b9\u6cd5\n \u5728CompareTo(obj)\u4e2d\u6307\u660e\u5982\u4f55\u6392\u5e8f\u3002\n*/\n\npublic class ComparableTest {\n    public static void main(String[] args) {\n        String[] arr1 = new String[]{\"AA\", \"ZZ\", \"CC\", \"XX\"};\n        Arrays.sort(arr1);\n        System.out.println(Arrays.toString(arr1));  // [AA, CC, XX, ZZ]\n\n\n        Goods[] arr2 = new Goods[5];\n        arr2[0] = new Goods(\"OPPO\", 3199);\n        arr2[1] = new Goods(\"Iphone\", 6999);\n        arr2[2] = new Goods(\"Vivo\", 3199);\n        arr2[3] = new Goods(\"Xiaomi\", 1999);\n        arr2[4] = new Goods(\"Huawei\", 5999);\n\n        Arrays.sort(arr2);\n        System.out.println(Arrays.toString(arr2));\n        // [Goods{name='Xiaomi', price=1999.0}, Goods{name='OPPO', price=3199.0}, Goods{name='Vivo', price=3199.0}, Goods{name='Huawei', price=5999.0}, Goods{name='Iphone', price=6999.0}]\n    }\n}\n\nclass Goods implements Comparable {\n    private String name;\n    private double price;\n\n    @Override\n    public String toString() {\n        return \"Goods{\" +\n                \"name='\" + name + '\\'' +\n                \", price=\" + price +\n                '}';\n    }\n\n    public Goods(String name, double price) {\n        this.name = name;\n        this.price = price;\n    }\n\n\n    // \u6307\u660e\u5546\u54c1\u6bd4\u8f83\u5927\u5c0f\u7684\u65b9\u5f0f\uff1a\u6309\u7167\u4ef7\u683c\u4ece\u4f4e\u5230\u9ad8\u6392\u5e8f\n    // \u518d\u6309\u7167\u5546\u54c1\u540d\u79f0\u4ece\u4f4e\u5230\u9ad8\u6392\u5e8f\n    @Override\n    public int compareTo(Object o) {\n        if (o instanceof Goods) {\n            Goods goods = (Goods) o;\n            if (this.price &gt; goods.price) {\n                return 1;\n            } else if (this.price &lt; goods.price) {\n                return -1;\n            } else {\n                return this.name.compareTo(goods.name);\n                // return 0;\n            }\n        }\n        throw new RuntimeException(\"\u4f20\u5165\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4\uff01\");\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#2comparator","title":"2.<code>Comparator</code>\u5b9a\u5236\u6392\u5e8f","text":"<pre><code>import java.util.Arrays;\nimport java.util.Comparator;\n\n//Comparator \u5b9a\u5236\u6392\u5e8f\n/*\n * 1. \u80cc\u666f\uff1a\n *   \u5f53\u5143\u7d20\u7684\u7c7b\u578b\u6ca1\u6709\u5b9e\u73b0java.lang.Comparable\u63a5\u53e3\u800c\u53c8\u4e0d\u65b9\u4fbf\u4fee\u6539\u4ee3\u7801\uff0c\n *   \u6216\u8005\u5b9e\u73b0\u4e86java.lang.Comparable\u63a5\u53e3\u7684\u6392\u5e8f\u89c4\u5219\u4e0d\u9002\u5408\u5f53\u524d\u7684\u64cd\u4f5c\uff0c\n *   \u90a3\u4e48\u53ef\u4ee5\u8003\u8651\u4f7f\u7528Comparator\u7684\u5bf9\u8c61\u6765\u6392\u5e8f\u3002\n * 2. \u91cd\u5199compare(Object o1, Object o2)\u65b9\u6cd5\uff0c\u6bd4\u8f83o1\u548co2\u7684\u5927\u5c0f\n *    \u5982\u679c\u65b9\u6cd5\u8fd4\u56de\u6b63\u6574\u6570\uff0c\u5219\u8868\u793ao1\u5927\u4e8eo2\uff1b\n *    \u5982\u679c\u8fd4\u56de0\uff0c\u8868\u793a\u76f8\u7b49\uff1b\n *    \u5982\u679c\u8fd4\u56de\u8d1f\u6574\u6570\uff0c\u8868\u793ao1\u5c0f\u4e8eo2\u3002\n *\n */\npublic class ComparatorTest {\n    public static void main(String[] args) {\n        String[] arr1 = new String[]{\"AA\", \"ZZ\", \"CC\", \"XX\"};\n        Arrays.sort(arr1, new Comparator&lt;String&gt;() {\n            // \u6309\u7167\u5b57\u7b26\u4e32\u4ece\u5927\u5230\u5c0f\u7684\u987a\u5e8f\u6392\u5217\n            @Override\n            public int compare(String o1, String o2) {\n                if (o1 instanceof String &amp;&amp; o2 instanceof String) {\n                    String s1 = (String) o1;\n                    String s2 = (String) o2;\n                    return -s1.compareTo(s2);\n                }\n                throw new RuntimeException(\"\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4\");\n            }\n        });\n        System.out.println(Arrays.toString(arr1));  // [ZZ, XX, CC, AA]\n\n        Goods[] arr2 = new Goods[5];\n        arr2[0] = new Goods(\"OPPO\", 3199);\n        arr2[1] = new Goods(\"Iphone\", 6999);\n        arr2[2] = new Goods(\"Iphone\", 9999);\n        arr2[3] = new Goods(\"Xiaomi\", 1999);\n        arr2[4] = new Goods(\"Huawei\", 5999);\n\n        Arrays.sort(arr2, new Comparator() {\n            // \u6307\u660e\u5546\u54c1\u6bd4\u8f83\u5927\u5c0f\u7684\u65b9\u5f0f\uff1a\u5148\u6309\u7167\u5546\u54c1\u540d\u79f0\u4ece\u4f4e\u5230\u9ad8\uff0c\u5728\u6309\u7167\u4ef7\u683c\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f\n            @Override\n            public int compare(Object o1, Object o2) {\n                if (o1 instanceof Goods &amp;&amp; o2 instanceof Goods) {\n                    Goods g1 = (Goods) o1;\n                    Goods g2 = (Goods) o2;\n                    if (g1.getName().equals(g2.getName())) {\n                        return -Double.compare(g1.getPrice(), g2.getPrice());\n                    } else {\n                        return g1.getName().compareTo(g2.getName());\n                    }\n                }\n                throw new RuntimeException(\"\u8f93\u5165\u7684\u6570\u636e\u7c7b\u578b\u4e0d\u4e00\u81f4\");\n            }\n        });\n        System.out.println(Arrays.toString(arr2)); // [Goods{name='Huawei', price=5999.0}, Goods{name='Iphone', price=9999.0}, Goods{name='Iphone', price=6999.0}, Goods{name='OPPO', price=3199.0}, Goods{name='Xiaomi', price=1999.0}]\n    }\n}\n\n\nclass Goods {\n    private String name;\n    private double price;\n\n    @Override\n    public String toString() {\n        return \"Goods{\" +\n                \"name='\" + name + '\\'' +\n                \", price=\" + price +\n                '}';\n    }\n\n    public Goods(String name, double price) {\n        this.name = name;\n        this.price = price;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public double getPrice() {\n        return price;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#system","title":"\u56db\u3001<code>System</code>\u7c7b","text":"<pre><code>public class SystemTest {\n    public static void main(String[] args) {\n        System.out.println(System.getProperty(\"java.version\")); // 1.8.0_291\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#math","title":"\u4e94\u3001<code>Math</code>\u7c7b","text":"<pre><code>public class MathTest {\n    public static void main(String[] args) {\n        System.out.println(\"90 \u5ea6\u7684\u6b63\u5f26\u503c\uff1a\" + Math.sin(Math.PI/2));\n        System.out.println(\"0\u5ea6\u7684\u4f59\u5f26\u503c\uff1a\" + Math.cos(0));\n        System.out.println(\"60\u5ea6\u7684\u6b63\u5207\u503c\uff1a\" + Math.tan(Math.PI/3));\n        System.out.println(\"1\u7684\u53cd\u6b63\u5207\u503c\uff1a \" + Math.atan(1));\n        System.out.println(\"\u03c0/2\u7684\u89d2\u5ea6\u503c\uff1a\" + Math.toDegrees(Math.PI/2));\n        System.out.println(Math.PI);\n//        90 \u5ea6\u7684\u6b63\u5f26\u503c\uff1a1.0\n//        0\u5ea6\u7684\u4f59\u5f26\u503c\uff1a1.0\n//        60\u5ea6\u7684\u6b63\u5207\u503c\uff1a1.7320508075688767\n//        1\u7684\u53cd\u6b63\u5207\u503c\uff1a 0.7853981633974483\n//        \u03c0/2\u7684\u89d2\u5ea6\u503c\uff1a90.0\n//        3.141592653589793\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E5%B8%B8%E7%94%A8%E7%B1%BB/#bigintegerbigdecimal","title":"\u516d\u3001<code>BigInteger</code>\u4e0e<code>BigDecimal</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%96%B0%E7%89%B9%E6%80%A7/","title":"\u65b0\u7279\u6027","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%96%B0%E7%89%B9%E6%80%A7/#lambda","title":"\u4e00\u3001Lambda\u8868\u8fbe\u5f0f","text":"<pre><code>import java.util.Comparator;\nimport java.util.function.Consumer;\n\npublic class LambdaTest {\n    public static void main(String[] args) {\n\n        // Lambda\u8868\u8fbe\u5f0f\n        // \u672c\u8d28\uff1a\u4f5c\u4e3a\u51fd\u6570\u5f0f\u63a5\u53e3\u7684\u5b9e\u4f8b\n\n\n        // \u683c\u5f0f\u4e00\uff1a\u65e0\u53c2\u3001\u65e0\u8fd4\u56de\u503c\n        Runnable runnable1 = new Runnable() {\n            public void run() {\n                System.out.println(\"Hello World!\");\n            }\n        };\n        runnable1.run();\n\n        Runnable runnable2 = () -&gt; {\n            System.out.println(\"Hello World!\");\n        };\n        runnable2.run();\n\n\n        // \u683c\u5f0f\u4e8c\uff1a\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u3001\u65e0\u8fd4\u56de\u503c\n        Consumer&lt;String&gt; consumer1 = new Consumer&lt;String&gt;() {\n            @Override\n            public void accept(String s) {\n                System.out.println(s);\n            }\n        };\n        consumer1.accept(\"Hello World!\");\n\n        Consumer&lt;String&gt; consumer2 = (String s) -&gt; {\n            System.out.println(s);\n        };\n        consumer2.accept(\"Hello World!\");\n\n\n        // \u683c\u5f0f\u4e09\uff1a\u6570\u636e\u7c7b\u578b\u53ef\u4ee5\u7701\u7565\uff0c\u56e0\u4e3a\u53ef\u7531\u7f16\u8bd1\u5668\u63a8\u65ad\u5f97\u51fa\uff0c\u79f0\u4e3a\u7c7b\u578b\u63a8\u65ad\n        Consumer&lt;String&gt; consumer3 = (s) -&gt; {\n            System.out.println(s);\n        };\n        consumer3.accept(\"Hello World!\");\n\n\n        // \u683c\u5f0f\u56db\uff1aLambda\u82e5\u53ea\u9700\u8981\u4e00\u4e2a\u53c2\u6570\u65f6\uff0c\u53c2\u6570\u7684\u5c0f\u62ec\u53f7\u53ef\u4ee5\u7701\u7565\n        Consumer&lt;String&gt; consumer4 = s -&gt; {\n            System.out.println(s);\n        };\n        consumer4.accept(\"Hello World!\");\n\n        // \u683c\u5f0f\u4e94\uff1aLambda\u82e5\u53ea\u9700\u8981\u4e24\u4e2a\u6216\u4e24\u4e2a\u4ee5\u4e0a\u7684\u53c2\u6570\uff0c\u591a\u6761\u6267\u884c\u8bed\u53e5\uff0c\u5e76\u4e14\u53ef\u4ee5\u6709\u8fd4\u56de\u503c\n        Comparator&lt;Integer&gt; comparator1 = new Comparator&lt;Integer&gt;() {\n            @Override\n            public int compare(Integer o1, Integer o2) {\n                System.out.println(o1);\n                System.out.println(o2);\n                return o1.compareTo(o2);\n            }\n        };\n        System.out.println(comparator1.compare(21, 25));\n\n        Comparator&lt;Integer&gt; comparator2 = (o1, o2) -&gt; {\n            System.out.println(o1);\n            System.out.println(o2);\n            return o1.compareTo(o2);\n        };\n        System.out.println(comparator2.compare(25, 21));\n\n\n        // \u683c\u5f0f\u516d\uff1a\u5f53Lambda\u4f53\u53ea\u6709\u4e00\u6761\u8bed\u53e5\u65f6\uff0creturn\u4e0e\u5927\u62ec\u53f7\u82e5\u6709\uff0c\u90fd\u53ef\u4ee5\u7701\u7565\n        Comparator&lt;Integer&gt; comparator3 = (o1, o2) -&gt; o1.compareTo(o2);\n        System.out.println(comparator3.compare(21, 21));\n\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%96%B0%E7%89%B9%E6%80%A7/#_1","title":"\u4e8c\u3001\u51fd\u6570\u5f0f\u63a5\u53e3","text":"<p>\u5982\u679c\u4e00\u4e2a\u63a5\u53e3\u4e2d\uff0c\u53ea\u58f0\u660e\u4e86\u4e00\u4e2a\u62bd\u8c61\u65b9\u6cd5\uff0c\u5219\u6b64\u63a5\u53e3\u79f0\u4e3a\u51fd\u6570\u5f0f\u63a5\u53e3\u3002</p> <pre><code>// \u5185\u7f6e\u76844\u5927\u6838\u5fc3\u51fd\u6570\u5f0f\u63a5\u53e3\n\n// \u6d88\u8d39\u578b\u63a5\u53e3 Consumer&lt;T&gt;    void accept(T t)\n// \u4f9b\u7ed9\u578b\u63a5\u53e3 Supplier&lt;T&gt; T  get()\n// \u51fd\u6570\u578b\u63a5\u53e3 Function&lt;T, R&gt; R apply(T t)\n// \u65ad\u5b9a\u578b\u63a5\u53e3 Predicate&lt;T&gt;   boolean test(T t)\n\n\nimport java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.List;\nimport java.util.function.Consumer;\nimport java.util.function.Predicate;\n\npublic class LambdaTest {\n    public static void main(String[] args) {\n        method1(500, new Consumer&lt;Double&gt;() {\n            @Override\n            public void accept(Double aDouble) {\n                System.out.println(aDouble);\n            }\n        });\n        // Lambda\n        method1(500, money -&gt; System.out.println(money));\n\n\n        List&lt;String&gt; list = Arrays.asList(\"Beijing\", \"Tianjin\", \"Shanghai\", \"Guangzhou\");\n        List&lt;String&gt; filterString1 = filterString(list, new Predicate&lt;String&gt;() {\n            @Override\n            public boolean test(String s) {\n                return s.contains(\"Beijing\");\n            }\n        });\n        System.out.println(filterString1);\n        // Lambda\n        List&lt;String&gt; filterString2 = filterString(list, s -&gt; s.contains(\"Beijing\"));\n        System.out.println(filterString2);\n    }\n\n    public static void method1(double money, Consumer&lt;Double&gt; consumer) {\n        consumer.accept(money);\n    }\n\n    // \u6839\u636e\u7ed9\u5b9a\u7684\u89c4\u5219\uff0c\u8fc7\u6ee4\u96c6\u5408\u4e2d\u7684\u5b57\u7b26\u4e32\uff0c\u6b64\u89c4\u5219\u6709Predicate\u7684\u65b9\u6cd5\u51b3\u5b9a\n    public static List&lt;String&gt; filterString(List&lt;String&gt; list, Predicate&lt;String&gt; predicate) {\n        ArrayList&lt;String&gt; filterList = new ArrayList&lt;&gt;();\n        for (String str : list) {\n            if (predicate.test(str)) {\n                filterList.add(str);\n            }\n        }\n        return filterList;\n    }\n\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%96%B0%E7%89%B9%E6%80%A7/#_2","title":"\u4e09\u3001\u65b9\u6cd5\u5f15\u7528\u4e0e\u6784\u9020\u5668\u5f15\u7528","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%96%B0%E7%89%B9%E6%80%A7/#stream-api","title":"\u56db\u3001<code>Stream API</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%96%B0%E7%89%B9%E6%80%A7/#optional","title":"\u4e94\u3001<code>Optional</code>\u7c7b","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%9E%9A%E4%B8%BE%E7%B1%BB/","title":"\u679a\u4e3e\u7c7b","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%9E%9A%E4%B8%BE%E7%B1%BB/#_1","title":"\u4e00\u3001\u81ea\u5b9a\u4e49\u679a\u4e3e\u7c7b","text":"<pre><code>public class CustomEnumTest {\n    public static void main(String[] args) {\n        Season spring = Season.SPRING;\n        System.out.println(spring);  // Season{seasonName='\u6625\u5929', seasonDesc='\u6625\u5929'}\n    }\n}\n\nclass Season {\n    // 1. \u58f0\u660eSeason\u5bf9\u8c61\u7684\u5c5e\u6027:private final \u4fee\u9970\n    private final String seasonName;\n    private final String seasonDesc;\n\n    // 2. \u79c1\u6709\u5316\u7c7b\u7684\u6784\u9020\u5668\n    private Season(String seasonName, String seasonDesc){\n        this.seasonName = seasonName;\n        this.seasonDesc = seasonName;\n    }\n\n    // 3. \u63d0\u4f9b\u5f53\u524d\u679a\u4e3e\u7c7b\u7684\u591a\u4e2a\u5bf9\u8c61 \u58f0\u660e\u4e3apublic static final\n    public static final Season SPRING = new Season(\"\u6625\u5929\", \"\u6625\u6696\u82b1\u5f00\");\n    public static final Season SUMMER = new Season(\"\u590f\u5929\", \"\u590f\u65e5\u708e\u708e\");\n    public static final Season AUTUMN = new Season(\"\u79cb\u5929\", \"\u79cb\u9ad8\u6c14\u723d\");\n    public static final Season WINTER = new Season(\"\u51ac\u5929\", \"\u51b0\u5929\u96ea\u5730\");\n\n    // 4.\u83b7\u53d6\u679a\u4e3e\u7c7b\u5bf9\u8c61\u7684\u5c5e\u6027\n    public String getSeasonName() {\n        return seasonName;\n    }\n\n    public String getSeasonDesc() {\n        return seasonDesc;\n    }\n\n    @Override\n    public String toString() {\n        return \"Season{\" +\n                \"seasonName='\" + seasonName + '\\'' +\n                \", seasonDesc='\" + seasonDesc + '\\'' +\n                '}';\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%9E%9A%E4%B8%BE%E7%B1%BB/#enum","title":"\u4e8c\u3001<code>enum</code>\u5b9a\u4e49\u679a\u4e3e\u7c7b","text":"<pre><code>// \u5b9a\u4e49\u7684\u679a\u4e3e\u7c7b\u9ed8\u8ba4\u7ee7\u627f\u4e8ejava.lang.Enum\npublic class enumTest {\n    public static void main(String[] args) {\n        Season spring = Season.SPRING;\n        System.out.println(spring);  // SPRING\n    }\n}\n\nenum Season {\n    // 1. \u63d0\u4f9b\u5f53\u524d\u679a\u4e3e\u7c7b\u7684\u5bf9\u8c61\uff0c\u591a\u4e2a\u5bf9\u8c61\u76f4\u63a5\u7528\u9017\u53f7\uff0c\u672b\u5c3e\u7528\u5206\u53f7\u7ed3\u675f\n    SPRING(\"\u6625\u5929\", \"\u6625\u6696\u82b1\u5f00\"),\n    SUMMER(\"\u590f\u5929\", \"\u590f\u65e5\u708e\u708e\"),\n    AUTUMN(\"\u79cb\u5929\", \"\u79cb\u9ad8\u6c14\u723d\"),\n    WINTER(\"\u51ac\u5929\", \"\u51b0\u5929\u96ea\u5730\");\n\n\n    // 2. \u58f0\u660eSeason\u5bf9\u8c61\u7684\u5c5e\u6027:private final \u4fee\u9970\n    private final String seasonName;\n    private final String seasonDesc;\n\n    // 3. \u79c1\u6709\u5316\u7c7b\u7684\u6784\u9020\u5668\n    private Season(String seasonName, String seasonDesc) {\n        this.seasonName = seasonName;\n        this.seasonDesc = seasonName;\n    }\n\n\n    // 4.\u83b7\u53d6\u679a\u4e3e\u7c7b\u5bf9\u8c61\u7684\u5c5e\u6027\n    public String getSeasonName() {\n        return seasonName;\n    }\n\n    public String getSeasonDesc() {\n        return seasonDesc;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%9E%9A%E4%B8%BE%E7%B1%BB/#enum_1","title":"\u4e09\u3001<code>Enum</code>\u7c7b\u7684\u4e3b\u8981\u65b9\u6cd5","text":"<pre><code>/*\nEnum\u7c7b\u4e2d\u7684\u5e38\u7528\u65b9\u6cd5\nvalueOf(String str): \u53ef\u4ee5\u628a\u4e00\u4e2a\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5bf9\u5e94\u7684\u679a\u4e3e\u7c7b\u5bf9\u8c61\uff0c\u8981\u6c42\u5b57\u7b26\u4e32\u5fc5\u987b\u662f\u679a\u4e3e\u7c7b\u5bf9\u8c61\n*/\npublic class enumTest {\n    public static void main(String[] args) {\n        Season spring = Season.SPRING;\n\n        // toString(): \u8fd4\u56de\u5f53\u524d\u679a\u4e3e\u7c7b\u5bf9\u8c61\u5e38\u91cf\u7684\u540d\u79f0\n        System.out.println(spring.toString());  // SPRING\n\n        // values(): \u8fd4\u56de\u679a\u4e3e\u7c7b\u578b\u7684\u5bf9\u8c61\u6570\u7ec4\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u904d\u5386\u6240\u6709\u7684\u679a\u4e3e\u503c\n        Season[] values = Season.values();\n        for (int i = 0; i &lt; values.length; i++) {\n            System.out.println(values[i]);\n        }\n        //        SPRING\n        //        SUMMER\n        //        AUTUMN\n        //        WINTER\n\n        // \u8fd4\u56de\u679a\u4e3e\u7c7b\u4e2d\u5bf9\u8c61\u540d\u662fobjName\u7684\u5bf9\u8c61\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5219\u629b\u51faIllegalArgumentException\u5f02\u5e38\n        Season summer = Season.valueOf(\"SUMxMER\");\n        System.out.println(summer); // SUMMER\n    }\n}\n\nenum Season {\n    // 1. \u63d0\u4f9b\u5f53\u524d\u679a\u4e3e\u7c7b\u7684\u5bf9\u8c61\uff0c\u591a\u4e2a\u5bf9\u8c61\u76f4\u63a5\u7528\u9017\u53f7\uff0c\u672b\u5c3e\u7528\u5206\u53f7\u7ed3\u675f\n    SPRING(\"\u6625\u5929\", \"\u6625\u6696\u82b1\u5f00\"),\n    SUMMER(\"\u590f\u5929\", \"\u590f\u65e5\u708e\u708e\"),\n    AUTUMN(\"\u79cb\u5929\", \"\u79cb\u9ad8\u6c14\u723d\"),\n    WINTER(\"\u51ac\u5929\", \"\u51b0\u5929\u96ea\u5730\");\n\n\n    // 2. \u58f0\u660eSeason\u5bf9\u8c61\u7684\u5c5e\u6027:private final \u4fee\u9970\n    private final String seasonName;\n    private final String seasonDesc;\n\n    // 3. \u79c1\u6709\u5316\u7c7b\u7684\u6784\u9020\u5668\n    private Season(String seasonName, String seasonDesc) {\n        this.seasonName = seasonName;\n        this.seasonDesc = seasonName;\n    }\n\n\n    // 4.\u83b7\u53d6\u679a\u4e3e\u7c7b\u5bf9\u8c61\u7684\u5c5e\u6027\n    public String getSeasonName() {\n        return seasonName;\n    }\n\n    public String getSeasonDesc() {\n        return seasonDesc;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%9E%9A%E4%B8%BE%E7%B1%BB/#_2","title":"\u56db\u3001\u5b9e\u73b0\u63a5\u53e3\u7684\u679a\u4e3e\u7c7b","text":"<pre><code>/*\nEnum\u7c7b\u4e2d\u7684\u5e38\u7528\u65b9\u6cd5\nvalueOf(String str): \u53ef\u4ee5\u628a\u4e00\u4e2a\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5bf9\u5e94\u7684\u679a\u4e3e\u7c7b\u5bf9\u8c61\uff0c\u8981\u6c42\u5b57\u7b26\u4e32\u5fc5\u987b\u662f\u679a\u4e3e\u7c7b\u5bf9\u8c61\n*/\npublic class enumTest {\n    public static void main(String[] args) {\n        Season[] values = Season.values();\n        for (int i = 0; i &lt; values.length; i++) {\n            values[i].show();\n        }\n        //        Hello SPRING\n        //        Hello SUMMER\n        //        Hello AUTUMN\n        //        Hello WINTER\n    }\n}\n\ninterface Info {\n    void show();\n}\n\nenum Season implements Info{\n    // 1. \u63d0\u4f9b\u5f53\u524d\u679a\u4e3e\u7c7b\u7684\u5bf9\u8c61\uff0c\u591a\u4e2a\u5bf9\u8c61\u76f4\u63a5\u7528\u9017\u53f7\uff0c\u672b\u5c3e\u7528\u5206\u53f7\u7ed3\u675f\n    SPRING(\"\u6625\u5929\", \"\u6625\u6696\u82b1\u5f00\"){\n        @Override\n        public void show() {\n            System.out.println(\"Hello SPRING\");\n        }\n    },\n    SUMMER(\"\u590f\u5929\", \"\u590f\u65e5\u708e\u708e\"){\n        @Override\n        public void show() {\n            System.out.println(\"Hello SUMMER\");\n        }\n    },\n    AUTUMN(\"\u79cb\u5929\", \"\u79cb\u9ad8\u6c14\u723d\"){\n        @Override\n        public void show() {\n            System.out.println(\"Hello AUTUMN\");\n        }\n    },\n    WINTER(\"\u51ac\u5929\", \"\u51b0\u5929\u96ea\u5730\"){\n        @Override\n        public void show() {\n            System.out.println(\"Hello WINTER\");\n        }\n    };\n\n\n    // 2. \u58f0\u660eSeason\u5bf9\u8c61\u7684\u5c5e\u6027:private final \u4fee\u9970\n    private final String seasonName;\n    private final String seasonDesc;\n\n    // 3. \u79c1\u6709\u5316\u7c7b\u7684\u6784\u9020\u5668\n    private Season(String seasonName, String seasonDesc) {\n        this.seasonName = seasonName;\n        this.seasonDesc = seasonName;\n    }\n\n\n    // 4.\u83b7\u53d6\u679a\u4e3e\u7c7b\u5bf9\u8c61\u7684\u5c5e\u6027\n    public String getSeasonName() {\n        return seasonName;\n    }\n\n    public String getSeasonDesc() {\n        return seasonDesc;\n    }\n\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/","title":"\u6cdb\u578b","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#_1","title":"\u4e00\u3001\u6982\u5ff5","text":"<p>\u6240\u8c13\u6cdb\u578b\uff0c\u5c31\u662f\u5141\u8bb8\u5728\u5b9a\u4e49\u7c7b\u3001\u63a5\u53e3\u65f6\u901a\u8fc7\u4e00\u4e2a\u6807\u8bc6\u8868\u793a\u7c7b\u4e2d\u67d0\u4e2a\u5c5e\u6027\u7684\u7c7b\u578b\u6216\u8005\u662f\u67d0\u4e2a\u65b9\u6cd5\u7684\u8fd4\u56de\u503c\u53ca\u53c2\u6570\u7c7b\u578b\u3002\u8fd9\u4e2a\u7c7b\u578b\u53c2\u6570\u5c06\u5728\u4f7f\u7528\u65f6\uff08\u4f8b\u5982\u7ee7\u627f\u6216\u5b9e\u73b0\u8fd9\u4e2a\u63a5\u53e3\uff0c\u7528\u8fd9\u4e2a\u7c7b\u578b\u58f0\u660e\u53d8\u91cf\uff0c\u521b\u5efa\u5bf9\u8c61\u65f6\uff09\u786e\u5b9a\uff08\u5373\u4f20\u5165\u5b9e\u9645\u7684\u7c7b\u578b\u53c2\u6570\uff0c\u4e5f\u79f0\u4e3a\u7c7b\u578b\u5b9e\u53c2\uff09</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#_2","title":"\u4e8c\u3001\u6ca1\u6709\u6cdb\u578b\u4f1a\u51fa\u73b0\u7684\u95ee\u9898","text":"<pre><code>import java.util.ArrayList;\n\npublic class GenericTest {\n    public static void main(String[] args) {\n        ArrayList list = new ArrayList();\n\n        list.add(78);\n        list.add(63);\n        list.add(43);\n        list.add(87);\n\n        // \u4e0d\u4f7f\u7528\u6cdb\u578b\u7684\u95ee\u9898\n        // 1. \u7c7b\u578b\u4e0d\u5b89\u5168\n        list.add(\"A\");\n\n        for (Object score : list) {\n            // 2. \u5f3a\u8f6c\u65f6\u51fa\u73b0ClassCastException\n            int stuScore = (Integer) score;\n            System.out.println(stuScore);\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#_3","title":"\u4e09\u3001\u4f7f\u7528\u6cdb\u578b","text":"<p>\u6cdb\u578b\u7684\u7c7b\u578b\u5fc5\u987b\u662f\u7c7b\uff0c\u4e0d\u80fd\u662f\u57fa\u672c\u6570\u636e\u7c7b\u578b\u3002\u5982\u679c\u5b9e\u4f8b\u5316\u65f6\u6ca1\u6709\u6307\u660e\u6cdb\u578b\u7684\u7c7b\u578b\uff0c\u9ed8\u8ba4\u7c7b\u578b\u4e3a<code>java.lang.Object</code>\u7c7b\u578b</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#1","title":"1.  \u96c6\u5408\u4e2d\u4f7f\u7528\u6cdb\u578b","text":"<pre><code>import java.util.ArrayList;\nimport java.util.Iterator;\n\npublic class GenericTest {\n    public static void main(String[] args) {\n        ArrayList&lt;Integer&gt; list = new ArrayList&lt;Integer&gt;();\n        // \u7c7b\u578b\u63a8\u65ad\uff0cjdk7\u4e2d\u5f15\u5165\n        // ArrayList&lt;Integer&gt; list = new ArrayList&lt;&gt;();\n\n        list.add(78);\n        list.add(63);\n        list.add(43);\n        list.add(87);\n\n        // \u5728\u7f16\u8bd1\u65f6\u5c31\u4f1a\u8fdb\u884c\u7c7b\u578b\u68c0\u67e5\uff0c\u4fdd\u8bc1\u6570\u636e\u7684\u5b89\u5168\n        // list.add(\"A\");\n\n        for (Integer score : list) {\n            // \u7701\u53bb\u4e86\u5f3a\u8f6c\u64cd\u4f5c\n            int stuScore = score;\n            System.out.println(stuScore);\n        }\n\n        Iterator&lt;Integer&gt; iterator = list.iterator();\n        while (iterator.hasNext()) {\n            System.out.println(iterator.next());\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#2-map","title":"2. Map\u4e2d\u4f7f\u7528\u6cdb\u578b","text":"<pre><code>import java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.Map;\nimport java.util.Set;\n\npublic class GenericTest {\n    public static void main(String[] args) {\n        HashMap&lt;String, Integer&gt; map = new HashMap&lt;&gt;();\n        map.put(\"Tom\", 78);\n        map.put(\"Jerry\", 81);\n        // \u6cdb\u578b\u5d4c\u5957\n        Set&lt;Map.Entry&lt;String, Integer&gt;&gt; entries = map.entrySet();\n        Iterator&lt;Map.Entry&lt;String, Integer&gt;&gt; iterator = entries.iterator();\n        while (iterator.hasNext()){\n            Map.Entry&lt;String, Integer&gt; next = iterator.next();\n            System.out.println(next.getKey() + \"--&gt;\" + next.getValue());\n        }\n        // Tom--&gt;78\n        // Jerry--&gt;81\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#_4","title":"\u56db\u3001\u81ea\u5b9a\u4e49\u6cdb\u578b\u7ed3\u6784","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#1_1","title":"1. \u6cdb\u578b\u7c7b\u3001\u6cdb\u578b\u63a5\u53e3","text":"<pre><code>public class GenericTest {\n    public static void main(String[] args) {\n\n        // \u5982\u679c\u5b9a\u4e49\u4e86\u6cdb\u578b\u7c7b\uff0c\u5b9e\u4f8b\u5316\u6ca1\u6709\u6307\u660e\u6cdb\u578b\u7c7b\uff0c\u9ed8\u8ba4\u4e3a\u6b64\u6cdb\u578b\u7c7b\u578b\u4e3aObject\u7c7b\u578b\n        // Order order = new Order();\n\n        // \u5982\u679c\u5b9a\u4e49\u4e86\u7c7b\u662f\u5e26\u6cdb\u578b\u7684\uff0c\u5efa\u8bae\u5728\u5b9e\u4f8b\u5316\u65f6\u8981\u6307\u660e\u7c7b\u7684\u6cdb\u578b\n        Order&lt;String&gt; order1 = new Order&lt;&gt;(\"A\", 1001, \"a:1001\");\n        order1.setOrderT(\"a:1001\");\n\n        // \u7531\u4e8e\u5b50\u7c7b\u5728\u7ee7\u627f\u5e26\u6cdb\u578b\u7684\u7236\u7c7b\u662f\uff0c\u6307\u660e\u4e86\u6cdb\u578b\u7c7b\u578b\uff0c\u5219\u5b9e\u4f8b\u5316\u5b50\u7c7b\u5bf9\u8c61\u65f6\uff0c\u4e0d\u9700\u8981\u6307\u660e\u6cdb\u578b\n        SubOrder order2 = new SubOrder();\n        order2.setOrderT(123);\n\n        ChildrenOrder&lt;Object&gt; order3 = new ChildrenOrder&lt;&gt;();\n        order3.setOrderT(\"BBB\");\n    }\n}\n\n\nclass Order&lt;T&gt; {\n    String orderName;\n    int orderId;\n    // \u7c7b\u7684\u5185\u90e8\u7ed3\u6784\u5c31\u53ef\u4ee5\u4f7f\u7528\u7c7b\u7684\u6cdb\u578b\n    T orderT;\n\n    public T getOrderT() {\n        return orderT;\n    }\n\n    public void setOrderT(T orderT) {\n        this.orderT = orderT;\n    }\n\n\n    public Order() {\n    }\n\n\n    public Order(String orderName, int orderId, T orderT) {\n        this.orderName = orderName;\n        this.orderId = orderId;\n        this.orderT = orderT;\n    }\n}\n\n\nclass SubOrder extends Order&lt;Integer&gt; {\n\n}\n\n\nclass ChildrenOrder&lt;T&gt; extends Order&lt;T&gt; {\n\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#2","title":"2. \u6cdb\u578b\u65b9\u6cd5","text":"<p>\u5728\u65b9\u6cd5\u4e2d\u51fa\u73b0\u4e86\u6cdb\u578b\u7684\u7ed3\u6784\uff0c\u6cdb\u578b\u53c2\u6570\u4e0e\u7c7b\u7684\u6cdb\u578b\u53c2\u6570\u6ca1\u6709\u4efb\u4f55\u5173\u7cfb\u3002</p> <pre><code>import java.util.ArrayList;\nimport java.util.List;\n\npublic class GenericTest {\n    public static void main(String[] args) {\n        MyClass myClass = new MyClass();\n        Integer[] arr = new Integer[]{1, 2, 3, 4};\n        List&lt;Integer&gt; list = myClass.method(arr);\n        System.out.println(list);\n    }\n}\n\n\nclass MyClass {\n    // \u6cdb\u578b\u65b9\u6cd5\u53ef\u4ee5\u58f0\u660e\u4e3a\u9759\u6001\u7684\uff0c\u56e0\u4e3a\u6cdb\u578b\u53c2\u6570\u662f\u5728\u8c03\u7528\u65b9\u6cd5\u65f6\u786e\u5b9a\u7684\uff0c\u5e76\u975e\u5728\u5b9e\u4f8b\u5316\u65f6\u786e\u5b9a\n    public &lt;E&gt; List&lt;E&gt; method(E[] arr) {\n        ArrayList&lt;E&gt; list = new ArrayList&lt;&gt;();\n        for (E e : arr) {\n            list.add(e);\n        }\n        return list;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#_5","title":"\u4e94\u3001\u6cdb\u578b\u5728\u7ee7\u627f\u65b9\u9762\u7684\u4f53\u73b0","text":"<p>\u7c7bA\u662f\u7c7bB\u7684\u7236\u7c7b\uff0c<code>G&lt;A&gt;</code>\u548c<code>G&lt;B&gt;</code>\u4e8c\u8005\u4e0d\u5177\u5907\u7236\u5b50\u7c7b\u5173\u7cfb\uff0c\u4e8c\u8005\u662f\u5e76\u5217\u5173\u7cfb\uff1b<code>A&lt;G&gt;</code>\u662f<code>B&lt;G&gt;</code>\u7684\u7236\u7c7b\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%9B%E5%9E%8B/#_6","title":"\u516d\u3001\u901a\u914d\u7b26\u7684\u4f7f\u7528","text":"<p>\u7c7bA\u662f\u7c7bB\u7684\u7236\u7c7b\uff0c<code>G&lt;A&gt;</code>\u548c<code>G&lt;B&gt;</code>\u662f\u6ca1\u6709\u5173\u7cfb\u7684\uff0c\u4e8c\u8005\u5171\u540c\u7684\u7236\u7c7b\u662f<code>G&lt;?&gt;</code>\u3002</p> <pre><code>import java.util.ArrayList;\nimport java.util.Iterator;\nimport java.util.List;\n\npublic class GenericTest {\n    public static void main(String[] args) {\n        List&lt;Object&gt; list1 = new ArrayList&lt;&gt;();\n        List&lt;String&gt; list2 = new ArrayList&lt;&gt;();\n        list1.add(1);\n        list2.add(\"A\");\n        List&lt;?&gt; list = null;\n\n        list = list1;\n        list = list2;\n\n        show(list1);\n        show(list2);\n        // \u6dfb\u52a0\n        // \u5bf9\u4e8eList&lt;?&gt; \u4e0d\u80fd\u50cf\u5176\u5185\u90e8\u6dfb\u52a0\u6570\u636e\u3002\n        // \u9664\u4e86null\u4e4b\u5916\n        // list.add(\"2\");\n        list.add(null);\n        show(list2);\n\n        // \u8bfb\u53d6 \u5141\u8bb8\u8bfb\u53d6\u6570\u636e\uff0c\u8bfb\u53d6\u7684\u6570\u636e\u7c7b\u578b\u4e3aObject\n        Object o = list.get(0);\n        System.out.println(o);\n    }\n\n    public static void show(List&lt;?&gt; list) {\n        Iterator&lt;?&gt; iterator = list.iterator();\n        while (iterator.hasNext()) {\n            Object obj = iterator.next();\n            System.out.println(obj);\n        }\n    }\n}\n</code></pre> <p>\u6709\u9650\u5236\u6761\u4ef6\u7684\u901a\u914d\u7b26</p> <pre><code>// ? extends A:  G&lt;? extends A&gt; \u53ef\u4ee5\u4f5c\u4e3aG&lt;A&gt;\u548cG&lt;B&gt;\u7684\u7236\u7c7b\uff0c\u5176\u4e2dB\u662fA\u7684\u5b50\u7c7b\n// ? super A: G&lt;? super A&gt; \u53ef\u4ee5\u4f5c\u4e3aG&lt;A&gt;\u548cG&lt;B&gt;\u7684\u7236\u7c7b\uff0c\u5176\u4e2dB\u662fA\u7684\u7236\u7c7b\n\nimport java.util.Iterator;\nimport java.util.List;\n\npublic class GenericTest {\n    public static void main(String[] args) {\n        List&lt;? extends Person&gt; list1 = null;\n        List&lt;? super Person&gt; list2 = null;\n\n        List&lt;Student&gt; list3 = null;\n        List&lt;Person&gt; list4 = null;\n        List&lt;Object&gt; list5 = null;\n\n        list1 = list3;\n        list1 = list4;\n        // list1 = list5;  // \u4e0d\u5141\u8bb8\n\n\n        // list2 = list3;  // \u4e0d\u5141\u8bb8\n        list2 = list4;\n        list2 = list5;\n    }\n\n    public static void show(List&lt;?&gt; list) {\n        Iterator&lt;?&gt; iterator = list.iterator();\n        while (iterator.hasNext()) {\n            Object obj = iterator.next();\n            System.out.println(obj);\n        }\n    }\n}\n\n\nclass Person {\n\n}\n\nclass Student extends Person {\n\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/","title":"\u6ce8\u89e3","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#_1","title":"\u4e00\u3001\u6982\u8ff0","text":"<p>\u200b    \u6ce8\u89e3(Annotation)\u5c31\u662f\u4ee3\u7801\u91cc\u7684\u7279\u6b8a\u6807\u8bb0\uff0c\u8fd9\u4e9b\u6807\u8bb0\u53ef\u4ee5\u5728\u7f16\u8bd1\uff0c\u7c7b\u52a0\u8f7d\u3001\u8fd0\u884c\u65f6\u88ab\u8bfb\u53d6\uff0c\u5e76\u6267\u884c\u76f8\u5e94\u7684\u5904\u7406\u3002\u901a\u8fc7 Annotation \uff0c\u7a0b\u5e8f\u5458\u53ef\u4ee5\u5728\u4e0d\u6539\u53d8\u539f\u6709\u903b\u8f91\u7684\u60c5\u51b5\u4e0b\uff0c\u5728\u6e90\u6587\u4ef6\u4e2d\u5d4c\u5165\u4e00\u4e9b\u8865\u5145\u4fe1\u606f\u3002\u4ee3\u7801\u5206\u6790\u5de5\u5177\u3001\u5f00\u53d1\u5de5\u5177\u548c\u90e8\u7f72\u5de5\u5177\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e9b\u8865\u5145\u4fe1\u606f\u8fdb\u884c\u9a8c\u8bc1\u6216\u8005\u8fdb\u884c\u90e8\u7f72\u3002</p> <p>\u200b    Annotation \u53ef\u4ee5\u50cf\u4fee\u9970\u7b26\u4e00\u6837\u88ab\u4f7f\u7528\uff0c\u53ef\u7528\u4e8e\u4fee\u9970\u5305\u3001\u7c7b\u3001\u6784\u9020\u5668\u3001\u65b9\u6cd5\u3001\u6210\u5458\u53d8\u91cf\u3001\u53c2\u6570\u3001\u5c40\u90e8\u53d8\u91cf\u7684\u58f0\u660e\uff0c\u8fd9\u4e9b\u4fe1\u606f\u88ab\u4fdd\u5b58\u5728 Annotation \u7684<code>name=value</code>\u5bf9\u4e2d\u3002</p> <p>\u4f7f\u7528\u793a\u4f8b\uff1a</p> <ol> <li>\u751f\u6210\u6587\u6863\u76f8\u5173\u7684\u6ce8\u89e3</li> <li>\u5728\u7f16\u8bd1\u65f6\u8fdb\u884c\u683c\u5f0f\u68c0\u67e5\uff08JDK\u5185\u7f6e\u7684\u4e09\u4e2a\u57fa\u672c\u6ce8\u89e3\uff09</li> <li>\u8ddf\u8e2a\u4ee3\u7801\u4f9d\u8d56\u6027\uff0c\u5b9e\u73b0\u4ee3\u66ff\u914d\u7f6e\u6587\u4ef6\u7684\u529f\u80fd</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#_2","title":"\u4e8c\u3001\u5e38\u89c1\u6ce8\u89e3","text":"<pre><code>@Override  // \u7f16\u8bd1\u65f6\u6821\u9a8c\u662f\u4e0d\u662f\u91cd\u5199\u4e86\u7236\u7c7b\u7684\u65b9\u6cd5\n@Deprecated // \u6240\u6807\u6ce8\u5185\u5bb9\uff0c\u4e0d\u518d\u88ab\u5efa\u8bae\u4f7f\u7528\u3002\n@SuppressWarnings // \u6291\u5236\u7f16\u8bd1\u5668\u8b66\u544a\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#_3","title":"\u4e09\u3001\u81ea\u5b9a\u4e49\u6ce8\u89e3","text":"<pre><code>public class AnnotationTest {\n    public static void main(String[] args) {\n\n    }\n}\n\n\n//1. \u6ce8\u89e3\u58f0\u660e\u4e3a@interface\n//2. \u5185\u90e8\u5b9a\u4e49\u6210\u5458\uff0c\u901a\u5e38\u4f7f\u7528value\u8868\u793a\n//3. \u53ef\u4ee5\u6307\u5b9a\u6210\u5458\u7684\u9ed8\u8ba4\u503c\uff0c\u4f7f\u7528default\u5b9a\u4e49\n//4. \u5982\u679c\u81ea\u5b9a\u4e49\u6ce8\u89e3\u6ca1\u6709\u6210\u5458\uff0c\u8868\u660e\u662f\u4e00\u4e2a\u6807\u8bc6\u4f5c\u7528\n//5. \u5982\u679c\u6ce8\u89e3\u6709\u6210\u5458\uff0c\u5728\u4f7f\u7528\u6ce8\u89e3\u65f6\uff0c\u9700\u8981\u6307\u660e\u6210\u5458\u7684\u503c\n// \u81ea\u5b9a\u4e49\u6ce8\u89e3\u5fc5\u987b\u914d\u4e0a\u6ce8\u89e3\u7684\u4fe1\u606f\u5904\u7406\u6d41\u7a0b\uff08\u4f7f\u7528\u53cd\u5c04\u624d\u6709\u610f\u4e49\uff09\n@interface MyAnnotation {\n    String value() default \"hello\";\n}\n\n@MyAnnotation(value = \"Hi\")\nclass Person {\n\n    String name;\n    int age;\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#_4","title":"\u56db\u3001\u5143\u6ce8\u89e3","text":"<p>\u5143\u6ce8\u89e3\u7528\u4e8e\u4fee\u9970\u5176\u4ed6\u5143\u6ce8\u89e3\u3002<code>JDK5.0</code>\u63d0\u4f9b\u4e864\u4e2a\u6807\u51c6\u7684\u5143\u6ce8\u89e3\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#1-documented","title":"1. <code>@Documented</code>","text":"<p>\u7528\u4e8e\u6307\u5b9a\u88ab\u8be5\u5143Annotation\u4fee\u9970\u7684Annotation\u7c7b\u5c06\u88ab<code>javadoc</code>\u5de5\u5177\u63d0\u53d6\u6210\u6587\u6863\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b<code>javadoc</code>\u662f\u4e0d\u5305\u62ec\u6ce8\u89e3\u7684\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#2-inherited","title":"2. <code>@Inherited</code>","text":"<p>\u88ab\u5b83\u4fee\u9970\u7684Annotation\u5c06\u5177\u6709\u7ee7\u627f\u6027\u3002\u5982\u679c\u67d0\u4e2a\u7c7b\u4f7f\u7528\u4e86\u88ab<code>@Inherited</code>\u4fee\u9970\u7684Annotation\uff0c\u5219\u5b50\u7c7b\u5c06\u81ea\u52a8\u5177\u6709\u8be5\u6ce8\u89e3\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#3-retention","title":"3. <code>@Retention</code>","text":"<p>\u6307\u660eAnnotation\u7684\u751f\u547d\u5468\u671f\uff0c\u4f7f\u7528\u65f6\u5fc5\u987b\u4e3a\u8be5value\u6210\u5458\u53d8\u91cf\u6307\u5b9a\u503c\u3002</p> <p><code>RetentionPolicy.SOURCE</code>\uff1a\u5728\u6e90\u6587\u4ef6\u4e2d\u6709\u6548\uff08\u5373\u6e90\u6587\u4ef6\u4fdd\u7559\uff09\uff0c\u7f16\u8bd1\u5668\u76f4\u63a5\u4e22\u5f03\u8fd9\u79cd\u7b56\u7565\u7684\u6ce8\u89e3</p> <p><code>RetentionPolicy.CLASS</code>\uff1a\u5728class\u6587\u4ef6\u4e2d\u6709\u6548\uff08\u5373class\u4fdd\u7559\uff09\uff0c\u5f53\u8fd0\u884cJava\u7a0b\u5e8f\u65f6\uff0c<code>JVM</code>\u4e0d\u4f1a\u4fdd\u7559\u6ce8\u89e3\uff0c\u8fd9\u662f\u9ed8\u8ba4\u503c\u3002</p> <p><code>RetentionPolicy.RUNTIME</code>\uff1a\u5728\u8fd0\u884c\u65f6\u6709\u6548\uff08\u5373\u8fd0\u884c\u65f6\u4fdd\u7559\uff09\uff0c\u5f53\u8fd0\u884cJava\u7a0b\u5e8f\u65f6\uff0c<code>JVM</code>\u4f1a\u4fdd\u7559\u6ce8\u91ca\uff0c\u7a0b\u5e8f\u53ef\u4ee5==\u901a\u8fc7\u53cd\u5c04\u83b7\u53d6==\u8be5\u6ce8\u91ca\u3002</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#4-target","title":"4. <code>@Target</code>","text":"<p>\u7528\u4e8e\u6307\u5b9a\u88ab\u4fee\u9970\u7684Annotation\u80fd\u7528\u4e8e\u4fee\u9970\u54ea\u4e9b\u7a0b\u5e8f\u5143\u7d20\u3002</p> <pre><code>// \u6307\u660eSuppressWarnings\u8fd9\u4e2a\u6ce8\u89e3\u53ea\u80fd\u7528\u5728TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE\u8fd9\u4e9b\u7c7b\u578b\u4e0a\u3002\n@Target({TYPE, FIELD, METHOD, PARAMETER, CONSTRUCTOR, LOCAL_VARIABLE})\n@Retention(RetentionPolicy.SOURCE)\npublic @interface SuppressWarnings {\n    String[] value();\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#jdk8","title":"\u4e94\u3001<code>JDK8</code>\u4e2d\u6ce8\u89e3\u7684\u65b0\u7279\u6027","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#1","title":"1. \u53ef\u91cd\u590d\u6ce8\u89e3","text":"<pre><code>import java.lang.annotation.Repeatable;\nimport java.lang.annotation.Retention;\nimport java.lang.annotation.RetentionPolicy;\n\npublic class AnnotationTest {\n    public static void main(String[] args) {\n    }\n}\n\n@Retention(RetentionPolicy.RUNTIME)\n@interface MyAnnotations {\n    MyAnnotation[] value();\n}\n\n// MyAnnotation\u4e0a\u58f0\u660eRepeatable\uff0c\u6210\u5458\u503c\u4e3aMyAnnotations.class\n@Repeatable(MyAnnotations.class)\n@Retention(RetentionPolicy.RUNTIME)\n@interface MyAnnotation {\n    String value() default \"hello\";\n}\n\n\n@MyAnnotation(value = \"Hi\")\nclass Person {\n    String name;\n    int age;\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E6%B3%A8%E8%A7%A3/#2","title":"2. \u7c7b\u578b\u6ce8\u89e3","text":"<p><code>ElementType.TYPE_PARAMETER</code> \u8868\u793a\u8be5\u6ce8\u89e3\u80fd\u5199\u5728\u7c7b\u578b\u53d8\u91cf\u7684\u58f0\u660e\u8bed\u53e5\u4e2d\uff08\u5982\uff1a\u6cdb\u578b\u58f0\u660e\uff09\u3002</p> <p><code>ElementType.YTPE_USED</code>\u8868\u793a\u8be5\u6ce8\u89e3\u80fd\u5199\u5728\u4f7f\u7528\u7c7b\u578b\u7684\u4efb\u4f55\u8bed\u53e5\u4e2d\u3002</p> <pre><code>import java.lang.annotation.*;\nimport java.util.ArrayList;\n\npublic class AnnotationTest {\n    public static void main(String[] args) {\n    }\n}\n\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.TYPE_PARAMETER, ElementType.TYPE_USE})\n@interface MyAnnotations {\n    MyAnnotation[] value();\n}\n\n@Repeatable(MyAnnotations.class)\n@Retention(RetentionPolicy.RUNTIME)\n@Target({ElementType.TYPE_PARAMETER, ElementType.TYPE_USE})\n@interface MyAnnotation {\n    String value() default \"hello\";\n}\n\n\nclass Generic&lt;@MyAnnotation T&gt; {\n    public void bar() throws @MyAnnotation RuntimeException{\n        ArrayList&lt;@MyAnnotation String&gt; list = new ArrayList&lt;&gt;();\n        int num = (@MyAnnotation int) 10;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/","title":"\u96c6\u5408","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#_1","title":"\u4e00\u3001\u6982\u8ff0","text":"<ol> <li>\u96c6\u5408\u3001\u6570\u7ec4\u90fd\u662f\u5bf9\u591a\u4e2a\u6570\u636e\u8fdb\u884c\u5b58\u50a8\u64cd\u4f5c\u7684\u7ed3\u6784\uff0c\u79f0\u4e3aJava\u5bb9\u5668\u3002</li> <li>\u6570\u7ec4\u5728\u5b58\u50a8\u5728\u591a\u4e2a\u6570\u636e\u7684\u7279\u70b9\uff1a<ol> <li>\u4e00\u65e6\u521d\u59cb\u5316\u4ee5\u540e\uff0c\u5176\u957f\u5ea6\u5c31\u786e\u5b9a\u4e86</li> <li>\u6570\u7ec4\u4e00\u65e6\u5b9a\u4e49\u597d\uff0c\u5176\u5143\u7d20\u7684\u7c7b\u578b\u4e5f\u5c31\u786e\u5b9a\u4e86\uff0c\u53ea\u80fd\u64cd\u4f5c\u6307\u5b9a\u7c7b\u578b\u7684\u6570\u636e\u3002</li> </ol> </li> <li>\u6570\u7ec4\u5728\u5b58\u50a8\u591a\u4e2a\u6570\u636e\u7684\u7f3a\u70b9\uff1a<ol> <li>\u4e00\u65e6\u521d\u59cb\u5316\u4ee5\u540e\uff0c\u957f\u5ea6\u4e0d\u53ef\u4ee5\u4fee\u6539\u3002</li> <li>\u6570\u7ec4\u4e2d\u63d0\u4f9b\u7684\u65b9\u6cd5\u6709\u9650\uff0c\u5bf9\u4e8e\u6dfb\u52a0\u3001\u5220\u9664\u3001\u64cd\u4f5c\u6570\u636e\u7b49\u64cd\u4f5c\uff0c\u975e\u5e38\u4e0d\u65b9\u4fbf\uff0c\u540c\u65f6\u6548\u7387\u4e0d\u9ad8\u3002</li> <li>\u83b7\u53d6\u6570\u7ec4\u4e2d\u5b9e\u9645\u5143\u7d20\u7684\u4e2a\u6570\uff0c\u6570\u7ec4\u4e2d\u6ca1\u6709\u73b0\u6210\u7684\u6570\u636e\u6216\u65b9\u6cd5\u53ef\u7528\u3002</li> <li>\u6570\u7ec4\u5b58\u50a8\u6570\u636e\u7684\u7279\u70b9\uff1a\u6709\u5e8f\u3001\u53ef\u91cd\u590d\u3002\u5bf9\u4e8e\u65e0\u5e8f\u3001\u4e0d\u53ef\u91cd\u590d\u7684\u9700\u6c42\uff0c\u4e0d\u80fd\u6ee1\u8db3\u3002</li> </ol> </li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#_2","title":"\u4e8c\u3001\u96c6\u5408\u6846\u67b6","text":"<p>\u96c6\u5408\u53ef\u5206\u4e3aCollection\u548cMap\u4e24\u79cd\u4f53\u7cfb</p> <ol> <li>Collection\u63a5\u53e3\uff1a\u5355\u5217\u6570\u636e\uff0c\u5b9a\u4e49\u4e86\u5b58\u53d6\u4e00\u7ec4\u5bf9\u8c61\u7684\u65b9\u6cd5\u7684\u96c6\u5408<ol> <li>List\u63a5\u53e3\uff1a\u5143\u7d20\u6709\u5e8f\u3001\u53ef\u91cd\u590d\u7684\u96c6\u5408\u3002--\u52a8\u6001\u6570\u7ec4<ol> <li><code>ArrayList</code></li> <li><code>LinkedList</code></li> <li><code>Vector</code></li> </ol> </li> <li>Set\u63a5\u53e3\uff1a\u5143\u7d20\u65e0\u5e8f\u3001\u4e0d\u53ef\u91cd\u590d\u7684\u96c6\u5408\u3002<ol> <li><code>HashSet</code>\uff1a\u4f5c\u4e3a<code>Set</code>\u63a5\u53e3\u7684\u4e3b\u8981\u5b9e\u73b0\u7c7b\uff1a\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\uff0c\u53ef\u4ee5\u5b58\u50a8<code>null</code>\u503c\u3002</li> <li><code>LinkedHashSet</code> \uff1a<code>HashSet</code>\u7684\u5b50\u7c7b\uff0c\u904d\u5386\u5176\u5185\u90e8\u6570\u636e\u65f6\uff0c\u53ef\u4ee5\u6309\u7167\u6dfb\u52a0\u7684\u987a\u5e8f\u904d\u5386\u3002</li> <li><code>TreeSet</code>\uff1a\u5e95\u5c42\u4e3a\u7ea2\u9ed1\u6811\uff0c\u53ef\u4ee5\u6309\u7167\u6dfb\u52a0\u5bf9\u8c61\u7684\u6307\u5b9a\u5c5e\u6027\u8fdb\u884c\u6392\u5e8f\u3002</li> </ol> </li> </ol> </li> <li>Map\u63a5\u53e3\uff1a\u53cc\u5217\u6570\u636e\uff0c\u5177\u6709\u4fdd\u5b58\u6620\u5c04\u5173\u7cfb\uff08key-value\uff09\u7684\u96c6\u5408<ol> <li><code>HashMap</code>\uff1a\u4f5c\u4e3a<code>Map</code>\u7684\u4e3b\u8981\u5b9e\u73b0\u7c7b\uff0c\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\uff0c\u6548\u7387\u9ad8\uff1b\u53ef\u4ee5\u5b58\u50a8<code>null</code>\u7684<code>key-value</code>\uff1b<ol> <li><code>LinkedHashMap</code>\uff1a\u4fdd\u8bc1\u5728\u904d\u5386<code>Map</code>\u5143\u7d20\u65f6\uff0c\u53ef\u4ee5\u6309\u7167\u6dfb\u52a0\u7684\u987a\u5e8f\u904d\u5386\uff08\u5728\u539f\u6709\u7684<code>HashMap</code>\u5e95\u5c42\u7ed3\u6784\u57fa\u7840\u4e0a\uff0c\u6dfb\u52a0\u4e86\u4e00\u5bf9\u6307\u9488\uff0c\u6307\u5411\u524d\u4e00\u4e2a\u548c\u540e\u4e00\u4e2a\u5143\u7d20\uff09\uff0c\u5bf9\u4e8e\u9891\u7e41\u7684\u904d\u5386\u64cd\u4f5c\u6548\u7387\u9ad8\u4e8e<code>HashMap</code></li> </ol> </li> <li><code>TreeMap</code>\uff1a\u53ef\u4ee5\u6309\u7167\u6dfb\u52a0\u7684<code>key-value</code>\u8fdb\u884c\u6392\u5e8f\uff0c\u5b9e\u73b0\u6392\u5e8f\u904d\u5386\uff0c\u6b64\u65f6\u8003\u8651<code>key</code>\u7684\u81ea\u7136\u6392\u5e8f\u548c\u5b9a\u5236\u6392\u5e8f\uff1b\u5e95\u5c42\u4f7f\u7528\u7ea2\u9ed1\u6811\u3002</li> <li><code>Hashtable</code>\uff1a\u4f5c\u4e3a\u53e4\u8001\u7684\u5b9e\u73b0\u7c7b\uff0c\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u6548\u7387\u4f4e\uff1b\u4e0d\u80fd\u5b58\u50a8<code>null</code>\u7684key\u548cvalue\uff1b<ol> <li><code>Properties</code>\uff1a\u5e38\u7528\u6765\u5904\u7406\u914d\u7f6e\u6587\u4ef6\uff1b<code>key-value</code>\u90fd\u662f<code>String</code>\u7c7b\u578b.</li> </ol> </li> </ol> </li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#collection","title":"\u4e09\u3001<code>Collection</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#1","title":"1. \u5e38\u7528\u65b9\u6cd5","text":"<pre><code>//Collection\u63a5\u53e3\u7684\u5e38\u7528\u65b9\u6cd5\n\nimport java.util.*;\n\npublic class CollectionTest {\n    public static void main(String[] args) {\n        Collection collection1 = new ArrayList();\n        Collection collection2 = new ArrayList();\n\n        // \u6dfb\u52a0\u5143\u7d20\n        collection1.add(\"ABC\");\n        collection2.add(123);\n\n        // \u83b7\u53d6\u6dfb\u52a0\u5143\u7d20\u7684\u4e2a\u6570\n        System.out.println(collection1.size());\n\n        // \u5c06collection2\u4e2d\u7684\u5143\u7d20\u6dfb\u52a0\u5230collection1\n        collection1.addAll(collection2);\n        System.out.println(collection1); // [ABC, 123]\n\n        // \u5224\u65ad\u5f53\u524d\u96c6\u5408\u662f\u5426\u4e3a\u7a7a\n        System.out.println(collection1.isEmpty()); // false\n\n        // \u6e05\u7a7a\u96c6\u5408\u5143\u7d20\n        collection2.clear();\n\n        // \u5224\u65ad\u5f53\u524d\u96c6\u5408\u662f\u5426\u5305\u542bobj\n        // \u5224\u65ad\u65f6\u4f1a\u8c03\u7528\u5bf9\u8c61\u6240\u5728\u7c7b\u7684equals()\u65b9\u6cd5\u8fdb\u884c\u6bd4\u8f83\n        boolean contains = collection1.contains(\"D\");\n        System.out.println(contains); // false\n\n        // ** \u5411Collection\u63a5\u53e3\u7684\u5b9e\u73b0\u7c7b\u7684\u5bf9\u8c61\u4e2d\u6dfb\u52a0\u6570\u636eobj\u65f6\uff0c\u8981\u6c42obj\u6240\u5728\u7c7b\u91cd\u5199equals()\n        collection1.add(new String(\"Hello\"));\n        System.out.println(collection1.contains(new String(\"Hello\"))); // true\n\n        collection1.add(new Person(\"Tom\", 18));\n        System.out.println(collection1.contains(new Person(\"Tom\", 18))); // true\n\n        // \u5224\u65adcollection3\u4e2d\u7684\u6240\u6709\u5143\u7d20\u662f\u5426\u90fd\u5728collection1\u4e2d\u3002\n        Collection collection3 = Arrays.asList(\"ABC\", 123);\n        boolean containsAll = collection1.containsAll(collection3);\n        System.out.println(containsAll); // true\n\n        // \u5220\u9664\uff0c\u5220\u9664\u6210\u529f\u8fd4\u56detrue\uff0c\u6ca1\u627e\u5230\u8fd4\u56defalse\n        boolean remove = collection1.remove(123);\n        System.out.println(remove);\n        System.out.println(collection1); // [ABC, Hello, Person{name='Tom', age=18}]\n\n        // \u5220\u9664collection3\u4e2d\u6240\u6709\u7684\u5143\u7d20\n        collection1.removeAll(collection3);\n        System.out.println(collection1); // [Hello, Person{name='Tom', age=18}]\n\n        // \u83b7\u53d6collection4\u548ccollection1\u7684\u4ea4\u96c6\n        Collection collection4 = Arrays.asList(\"Hello\");\n        collection1.retainAll(collection4);\n        System.out.println(collection1); // [Hello]\n\n        // \u5224\u65ad\u5f53\u524d\u96c6\u5408\u548c\u5f62\u53c2\u96c6\u5408\u5143\u7d20\u76f8\u540c\n        Collection collection5 = Arrays.asList(\"Hello\");\n        System.out.println(collection1.equals(collection5)); // true\n\n        //hashCode() \u8fd4\u56de\u5f53\u524d\u5bf9\u8c61\u7684Hash\u503c\n        System.out.println(collection1.hashCode()); // 69609681\n\n        collection1.add(123);\n        // \u96c6\u5408--&gt;\u6570\u7ec4\n        Object[] arr = collection1.toArray();\n        for (int i = 0; i &lt; arr.length; i++) {\n            System.out.println(arr[i]);\n        }\n\n        // \u6570\u7ec4--&gt;\u96c6\u5408\n        List&lt;String&gt; list1 = Arrays.asList(new String[]{\"AA\", \"BB\", \"CC\"});\n        System.out.println(list1); // [A, B, C]\n        List list2 = Arrays.asList(new int[]{1, 2, 3});\n        System.out.println(list2); // [[I@1b6d3586]\n        List list3 = Arrays.asList(1, 2, 3);\n        System.out.println(list3); // [1, 2, 3]\n    }\n}\n\n\nclass Person {\n    String name;\n    int age;\n\n    public Person(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    @Override\n    public String toString() {\n        return \"Person{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n        Person person = (Person) o;\n        return age == person.age &amp;&amp; Objects.equals(name, person.name);\n    }\n\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#2","title":"2. \u96c6\u5408\u5143\u7d20\u7684\u904d\u5386","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#21-hasnextnext","title":"2.1 <code>hasNext()</code>\u548c<code>next()</code>","text":"<pre><code>// Iterator\u7528\u6765\u904d\u5386Collection\u5bf9\u8c61\nimport java.util.Arrays;\nimport java.util.Collection;\nimport java.util.Iterator;\n\npublic class IteratorTest {\n    public static void main(String[] args) {\n        Collection collection = Arrays.asList(\"A\", \"B\", 123, \"Hello\");\n        Iterator iterator = collection.iterator();\n//        \u65b9\u5f0f\u4e00\n//        System.out.println(iterator.next());  // A\n//        System.out.println(iterator.next());  // B\n//        System.out.println(iterator.next());  // 123\n//        System.out.println(iterator.next());  // Hello\n//        System.out.println(iterator.next());  // NoSuchElementException\n\n//        \u65b9\u5f0f\u4e8c\n//        for (int i = 0; i &lt; collection.size(); i++) {\n//            System.out.println(iterator.next());\n//        }\n\n//        \u65b9\u5f0f\u4e09 \u63a8\u8350\n//      hasNext()\u5224\u65ad\u662f\u5426\u8fd8\u6709\u4e0b\u4e00\u4e2a\u5143\u7d20\n        while (iterator.hasNext()){\n//          next() \u2460\u6307\u9488\u4e0b\u79fb\u2461\u5c06\u4e0b\u79fb\u4ee5\u540e\u96c6\u5408\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u8fd4\u56de\n            System.out.println(iterator.next());\n        }\n//        \u9519\u8bef\u65b9\u5f0f\u4e00\n//        while ((iterator.next()) != null){\n//            System.out.println(iterator.next());\n//        }\n\n//        \u9519\u8bef\u65b9\u5f0f\u4e8c\n//        \u96c6\u5408\u5bf9\u8c61\u6bcf\u6b21\u8c03\u7528iterator()\u65b9\u6cd5\u90fd\u4f1a\u5f97\u5230\u4e00\u4e2a\u5168\u65b0\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u9ed8\u8ba4\u6e38\u6807\u90fd\u5728\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e4b\u524d\n//        while (collection.iterator().hasNext()){\n//            System.out.println(collection.iterator().next()); // \u6b7b\u5faa\u73af\u8f93\u51faA\n//        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#22-remove","title":"2.2 <code>remove()</code>","text":"<pre><code>import java.util.ArrayList;\nimport java.util.Collection;\nimport java.util.Iterator;\n\npublic class IteratorTest {\n    public static void main(String[] args) {\n        Collection collection = new ArrayList();\n        collection.add(\"A\");\n        collection.add(\"123\");\n        collection.add(\"Hello\");\n        Iterator iterator = collection.iterator();\n        while (iterator.hasNext()) {\n            Object obj = iterator.next();\n            if (\"Hello\".equals(obj)) {\n                iterator.remove();\n            }\n        }\n        iterator = collection.iterator();\n        while (iterator.hasNext()){\n            System.out.println(iterator.next());\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#3-list","title":"3. <code>List</code>\u63a5\u53e3","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#1-arraylist-linkedlist-vector","title":"1. <code>ArrayList</code>\u3001 <code>LinkedList</code>\u548c <code>Vector</code>\u4e09\u8005\u7684\u5f02\u540c","text":"<ol> <li>\u76f8\u540c\u70b9\uff1a<ol> <li>\u90fd\u5b9e\u73b0\u4e86<code>List</code>\u63a5\u53e3\uff0c\u5b58\u50a8\u6570\u636e\u7684\u7279\u70b9\u76f8\u540c\uff08\u5b58\u50a8\u6709\u5e8f\u7684\u3001\u53ef\u91cd\u590d\u7684\u6570\u636e\uff09</li> </ol> </li> <li>\u4e0d\u540c\u70b9<ol> <li><code>ArrayList</code>\u4f5c\u4e3a<code>List</code>\u63a5\u53e3\u7684\u4e3b\u8981\u5b9e\u73b0\u7c7b\u3002\u7ebf\u7a0b\u4e0d\u5b89\u5168\u7684\uff0c\u6548\u7387\u9ad8\u3002\u5e95\u5c42\u7528<code>Object[] elementData</code>\u5b58\u50a8</li> <li><code>Vector</code>\u662f<code>List</code>\u63a5\u53e3\u53e4\u8001\u7684\u5b9e\u73b0\u7c7b\u3002\u7ebf\u7a0b\u5b89\u5168\u7684\uff0c\u6548\u7387\u4f4e\u3002\u5e95\u5c42\u7528<code>Object[] elementData</code>\u5b58\u50a8</li> <li><code>LinkedList</code>\u5e95\u5c42\u4f7f\u7528\u53cc\u5411\u94fe\u8868\u5b58\u50a8\u3002\u5bf9\u4e8e\u9891\u7e41\u7684\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\uff0c\u6548\u7387\u6bd4<code>ArrayList</code>\u9ad8\u3002</li> </ol> </li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#2_1","title":"2. \u6e90\u7801\u5206\u6790","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#21-arraylist","title":"2.1 <code>ArrayList</code>\u6e90\u7801\u5206\u6790","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#22-linkedlist","title":"2.2 <code>LinkedList</code>\u6e90\u7801\u5206\u6790","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#23-vector","title":"2.3 <code>Vector</code>\u6e90\u7801\u5206\u6790","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#3","title":"3. \u5e38\u7528\u65b9\u6cd5","text":"<pre><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collection;\n\n\npublic class ListTest {\n    public static void main(String[] args) {\n        ArrayList list = new ArrayList();\n        // add()\n        list.add(\"A\");\n        list.add(\"Hello\");\n        list.add(123);\n\n        System.out.println(list);  // [A, Hello, 123]\n        list.add(2, \"Hello\");\n        System.out.println(list);  // [A, Hello, Hello, 123]\n\n        // addAll()\n        Collection&lt;Integer&gt; integerList = Arrays.asList(1, 2, 3);\n        list.addAll(integerList);\n        System.out.println(list);  // [A, Hello, Hello, 123, 1, 2, 3]\n\n        // indexOf() \u8fd4\u56deobj\u5728\u96c6\u5408\u4e2d\u9996\u6b21\u51fa\u73b0\u7684\u7d22\u5f15\u4f4d\u7f6e,\u4e0d\u5b58\u5728\u8fd4\u56de-1\n        System.out.println(list.indexOf(\"Hello\"));\n\n        // lastIndexOf() \u8fd4\u56deobj\u5728\u96c6\u5408\u4e2d\u672b\u6b21\u51fa\u73b0\u7684\u7d22\u5f15\u4f4d\u7f6e,\u4e0d\u5b58\u5728\u8fd4\u56de-1\n        System.out.println(list.lastIndexOf(\"Hello\")); // 2\n\n        // remote() \u8fd4\u56de\u5220\u9664\u7684\u5143\u7d20\n        Object obj = list.remove(1);\n        System.out.println(obj);  // Hello\n\n        // set()\n        list.set(0, \"B\");\n        System.out.println(list); // [B, Hello, 123, 1, 2, 3]\n\n        // subList()\n        System.out.println(list.subList(3, 6));  // [1, 2, 3]\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#4-set","title":"4. <code>Set\u63a5\u53e3</code>","text":""},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#1_1","title":"1. \u96c6\u5408\u7684\u7279\u70b9","text":"<pre><code>import java.util.HashSet;\n\npublic class SetTest {\n    public static void main(String[] args) {\n        // \u65e0\u5e8f\u6027\uff1a\u5b58\u50a8\u7684\u6570\u636e\u5728\u5e95\u5c42\u6570\u7ec4\u4e2d\u5e76\u975e\u6309\u7167\u6570\u7ec4\u7d22\u5f15\u7684\u987a\u5e8f\u6dfb\u52a0\uff0c\u800c\u662f\u6839\u636e\u6570\u636e\u7684\u54c8\u5e0c\u503c\u51b3\u5b9a\u7684\u3002\n        // \u4e0d\u53ef\u91cd\u590d\uff1a\u4fdd\u8bc1\u6dfb\u52a0\u7684\u5143\u7d20\u6309\u7167equals()\u5224\u65ad\u65f6\uff0c\u4e0d\u80fd\u8fd4\u56detrue,\u5373\u76f8\u540c\u7684\u5143\u7d20\u53ea\u80fd\u6dfb\u52a0\u4e00\u4e2a\u3002\n\n        HashSet set = new HashSet();\n        set.add(5);\n        set.add(1);\n        set.add(\"B\");\n        set.add(5);\n        System.out.println(set); // [1, B, 5]\n\n        // \u6dfb\u52a0\u5143\u7d20\u7684\u8fc7\u7a0b\n        // \u5411HashSet\u4e2d\u6dfb\u52a0\u5143\u7d20a\uff0c\u9996\u5148\u8c03\u7528\u5143\u7d20a\u6240\u5728\u7c7b\u7684hashCode()\u65b9\u6cd5\uff0c\u8ba1\u7b97\u5143\u7d20a\u7684\u54c8\u5e0c\u503c\u503c\uff0c\n        // \u6b64\u54c8\u5e0c\u503c\u63a5\u7740\u901a\u8fc7\u67d0\u79cd\u7b97\u6cd5\u8ba1\u7b97\u51fa\u5728HashSet\u5e95\u5c42\u6570\u7ec4\u4e2d\u7684\u5b58\u653e\u4f4d\u7f6e\uff08\u7d22\u5f15\u4f4d\u7f6e\uff09\uff0c\u5224\u65ad\n        // \u6570\u7ec4\u6b64\u4f4d\u7f6e\u4e0a\u662f\u5426\u5df2\u7ecf\u6709\u5143\u7d20\n        //     \u5982\u679c\u6b64\u4f4d\u7f6e\u4e0a\u6ca1\u6709\u5176\u4ed6\u5143\u7d20\uff0c\u5219\u5143\u7d20a\u6dfb\u52a0\u6210\u529f --&gt; \u60c5\u51b51\n        //     \u5982\u679c\u6b64\u4f4d\u7f6e\u4e0a\u53f3\u5176\u4ed6\u5143\u7d20b(\u6216\u8005\u4ee5\u94fe\u8868\u5f62\u5f0f\u5b58\u5728\u7684\u591a\u4e2a\u5143\u7d20)\uff0c\u5219\u6bd4\u8f83\u5143\u7d20a\u548c\u5143\u7d20b\u7684\u54c8\u5e0c\u503c\uff0c\n        //         \u5982\u679c\u54c8\u5e0c\u503c\u4e0d\u76f8\u540c\uff0c\u5219\u5143\u7d20a\u6dfb\u52a0\u6210\u529f\u3002 --&gt; \u60c5\u51b52\n        //         \u5982\u679c\u54c8\u5e0c\u503c\u76f8\u540c\uff0c\u8fdb\u884c\u9700\u8981\u8c03\u7528\u5143\u7d20a\u6240\u5728\u7c7b\u7684equals()\u65b9\u6cd5\uff1a\n        //             \u5982\u679c\u8fd4\u56detrue\uff0c\u5143\u7d20a\u6dfb\u52a0\u5931\u8d25\n        //             \u5982\u679c\u8fd4\u56defalse\uff0c\u5143\u7d20a\u6dfb\u52a0\u6210\u529f --&gt; \u60c5\u51b53\n\n        // \u5bf9\u4e8e\u6dfb\u52a0\u6210\u529f\u7684\u60c5\u51b52\u548c\u60c5\u51b53\u800c\u8a00: \u5143\u7d20a\u4e0e\u5df2\u7ecf\u5b58\u5728\u6307\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u4e0a\u6570\u636e\u4e00\u94fe\u8868\u7684\u65b9\u5f0f\u5b58\u50a8\u3002\n        // jdk8\u4e2d\uff0c\u539f\u6765\u7684\u5143\u7d20\u5728\u6570\u7ec4\u4e2d\u6307\u5411\u5143\u7d20a\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#2-hashcodeequals","title":"2. \u91cd\u5199<code>hashCode()</code>\u548c<code>equals()</code>","text":"<p>\u5411<code>Set</code>\u4e2d\u6dfb\u52a0\u7684\u6570\u636e\uff0c\u5176\u6240\u5728\u7684\u7c7b\u4e00\u5b9a\u8981\u91cd\u5199<code>hashCode()</code>\u548c<code>equals()</code>\u3002\u91cd\u5199\u7684\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u5c3d\u53ef\u4ee5\u4fdd\u6301\u4e00\u81f4\u6027\uff08\u76f8\u7b49\u7684\u5bf9\u8c61\u5fc5\u987b\u5177\u6709\u76f8\u7b49\u7684\u6563\u5217\u7801\uff09\u3002</p> <pre><code>import java.util.HashSet;\n\npublic class SetTest {\n    public static void main(String[] args) {\n        HashSet set = new HashSet();\n        set.add(5);\n        set.add(1);\n        set.add(new User(\"Tom\", 18));\n        set.add(new User(\"Tom\", 18));\n\n        System.out.println(set); // [1, 5, User{name='Tom', age=18}]\n\n\n    }\n}\n\nclass User {\n    String name;\n    int age;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    public User(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    @Override\n    public String toString() {\n        return \"User{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n\n        User user = (User) o;\n\n        if (age != user.age) return false;\n        return name != null ? name.equals(user.name) : user.name == null;\n    }\n\n    @Override\n    public int hashCode() {\n        int result = name != null ? name.hashCode() : 0;\n        result = 31 * result + age;\n        return result;\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#3-linkedhashset","title":"3. <code>LinkedHashSet</code>","text":"<p>\u505a\u4e3a<code>HashSet</code>\u7684\u5b50\u7c7b\uff0c\u5728\u6dfb\u52a0\u6570\u636e\u7684\u540c\u65f6\uff0c\u6bcf\u4e2a\u6570\u636e\u8fd8\u7ef4\u62a4\u4e86\u4e24\u4e2a\u5f15\u7528\uff0c\u8bb0\u5f55\u6b64\u6570\u636e\u524d\u4e00\u4e2a\u6570\u636e\u548c\u540e\u4e00\u4e2a\u6570\u636e\u3002</p> <p>\u5bf9\u4e8e\u9891\u7e41\u7684\u904d\u5386\u64cd\u4f5c\uff0c\u6548\u7387\u9ad8\u4e8e<code>HashSet</code>.</p> <pre><code>import java.util.Iterator;\nimport java.util.LinkedHashSet;\n\npublic class LinkedHashSetTest {\n    public static void main(String[] args) {\n        LinkedHashSet set = new LinkedHashSet();\n        set.add(5);\n        set.add(1);\n        set.add(\"A\");\n        Iterator iterator = set.iterator();\n        while (iterator.hasNext()) {\n            System.out.println(iterator.next());\n        }\n//        5\n//        1\n//        A\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#4-treeset","title":"4. <code>TreeSet</code>","text":"<pre><code>import java.util.Iterator;\nimport java.util.TreeSet;\n\npublic class TreeSetTest {\n    public static void main(String[] args) {\n        // \u5411TreeSet\u4e2d\u6dfb\u52a0\u7684\u6570\u636e\uff0c\u8981\u6c42\u76f8\u540c\u7c7b\u7684\u5bf9\u8c61\n        TreeSet set = new TreeSet();\n        set.add(12);\n        set.add(13);\n        set.add(-3);\n        set.add(0);\n\n        Iterator iterator = set.iterator();\n        while (iterator.hasNext()) {\n            System.out.println(iterator.next());\n            // \u6309\u4ece\u5c0f\u5230\u5927\u987a\u5e8f\u6392\n        }\n        //        -3\n        //        0\n        //        12\n        //        13\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#41","title":"4.1 \u81ea\u7136\u6392\u5e8f","text":"<p>\u81ea\u7136\u6392\u5e8f\u4e2d\uff0c\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u540c\u7684\u6807\u51c6\u4e3a\uff1a<code>compareTo()</code>\u8fd4\u56de0,\u4e0d\u518d\u662f<code>equals()</code>\u3002</p> <pre><code>import java.util.Iterator;\nimport java.util.TreeSet;\n\npublic class TreeSetTest {\n    public static void main(String[] args) {\n        TreeSet set = new TreeSet();\n\n        set.add(new User(\"Tom\", 18));\n        set.add(new User(\"Jerry\", 16));\n        set.add(new User(\"Jack\", 32));\n        set.add(new User(\"Jack\", 23));\n        Iterator iterator = set.iterator();\n        while (iterator.hasNext()) {\n            System.out.println(iterator.next());\n        }\n    }\n}\n\nclass User implements Comparable {\n    String name;\n    int age;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    public User(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    @Override\n    public String toString() {\n        return \"User{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n\n    @Override\n    public boolean equals(Object o) {\n        if (this == o) return true;\n        if (o == null || getClass() != o.getClass()) return false;\n\n        User user = (User) o;\n\n        if (age != user.age) return false;\n        return name != null ? name.equals(user.name) : user.name == null;\n    }\n\n    @Override\n    public int hashCode() {\n        int result = name != null ? name.hashCode() : 0;\n        result = 31 * result + age;\n        return result;\n    }\n\n    // \u6309\u7167\u59d3\u540d\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\uff0c\u5e74\u9f84\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\n    @Override\n    public int compareTo(Object o) {\n        if (o instanceof User) {\n            User user = (User) o;\n            int i = this.name.compareTo(user.name);\n            if (i != 0) {\n                return i;\n            } else {\n                return Integer.compare(this.age, user.age);\n            }\n        } else {\n            throw new RuntimeException(\"\u7c7b\u578b\u9519\u8bef\");\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#42","title":"4.2 \u5b9a\u5236\u6392\u5e8f","text":"<p>\u5b9a\u5236\u6392\u5e8f\u4e2d\uff0c\u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u540c\u7684\u6807\u51c6\u4e3a\uff1a<code>compare()</code>\u8fd4\u56de0,\u4e0d\u518d\u662f<code>equals()</code>\u3002</p> <pre><code>import java.util.Comparator;\nimport java.util.Iterator;\nimport java.util.TreeSet;\n\npublic class TreeSetTest {\n    public static void main(String[] args) {\n        // \u5b9a\u5236\u6392\u5e8f\n        Comparator comparator = new Comparator(){\n            @Override\n            public int compare(Object o1, Object o2) {\n                if (o1 instanceof User &amp;&amp; o2 instanceof User){\n                    User u1 = (User) o1;\n                    User u2 = (User) o2;\n                    return Integer.compare(u1.getAge(), u2.getAge());\n                }else{\n                    throw new RuntimeException(\"\u7c7b\u578b\u9519\u8bef\");\n                }\n            }\n        };\n\n        TreeSet set = new TreeSet(comparator);\n\n        set.add(new User(\"Tom\", 18));\n        set.add(new User(\"Jerry\", 16));\n        set.add(new User(\"Jack\", 16));\n        set.add(new User(\"Jack\", 23));\n        Iterator iterator = set.iterator();\n        while (iterator.hasNext()) {\n            System.out.println(iterator.next());\n        }\n        //        User{name='Jerry', age=16}\n        //        User{name='Tom', age=18}\n        //        User{name='Jack', age=23}\n    }\n}\n\nclass User {\n    String name;\n    int age;\n\n    public String getName() {\n        return name;\n    }\n\n    public void setName(String name) {\n        this.name = name;\n    }\n\n    public int getAge() {\n        return age;\n    }\n\n    public void setAge(int age) {\n        this.age = age;\n    }\n\n    public User(String name, int age) {\n        this.name = name;\n        this.age = age;\n    }\n\n    @Override\n    public String toString() {\n        return \"User{\" +\n                \"name='\" + name + '\\'' +\n                \", age=\" + age +\n                '}';\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#map","title":"\u56db\u3001<code>Map</code>\u63a5\u53e3","text":"<p><code>Map</code>\u4e2d\u7684<code>key</code>\uff1a\u65e0\u5e8f\u7684\u3001\u4e0d\u53ef\u91cd\u590d\u7684\uff0c\u4f7f\u7528<code>Set</code>\u5b58\u50a8\u6240\u6709\u7684<code>key</code></p> <p><code>Map</code>\u7684<code>value</code>\uff1a\u65e0\u5e8f\u7684\u3001\u53ef\u91cd\u590d\u7684\uff0c\u4f7f\u7528<code>Collection</code>\u5b58\u50a8\u6240\u6709\u7684<code>value</code></p> <p>\u4e00\u4e2a\u952e\u503c\u5bf9\uff1a<code>key-value</code>\u6784\u6210\u4e86\u4e00\u4e2a<code>Entry</code>\u5bf9\u8c61\uff1b<code>Map</code>\u4e2d\u7684<code>Entry</code>\u662f\u65e0\u5e8f\u7684\u3001\u4e0d\u53ef\u91cd\u590d\u7684\uff0c\u4f7f\u7528<code>Set</code>\u5b58\u50a8\u6240\u4ee5\u7684<code>Entry</code></p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#1-hashmap","title":"1. <code>HashMap</code>\u5e95\u5c42\u5b9e\u73b0\u539f\u7406","text":"<p><code>jdk7</code>\u7684\u5b9e\u73b0\uff1a</p> <ol> <li> <p><code>HashMap hashMap = new HashMap();</code>\u5728\u5b9e\u4f8b\u5316\u4ee5\u540e\uff0c\u5e95\u5c42\u521b\u5efa\u4e86\u957f\u5ea6\u662f16\u7684\u4e00\u7ef4\u6570\u7ec4<code>Entry[]\u00a0table</code></p> </li> <li> <p><code>map.put(key1, value2)</code></p> <ol> <li> <p>\u9996\u5148\u8c03\u7528<code>key1</code>\u6240\u5728\u7c7b\u7684<code>hashCode()</code>\u8ba1\u7b97<code>key1</code>\u7684\u54c8\u5e0c\u503c\uff0c\u6b64\u54c8\u5e0c\u503c\u7ecf\u8fc7\u67d0\u79cd\u7b97\u6cd5\u4ee5\u540e\uff0c\u5f97\u5230\u5728<code>Entry</code>\u6570\u7ec4\u4e2d\u7684\u5b58\u653e\u4f4d\u7f6e\u3002</p> <ol> <li>\u5982\u679c\u6b64\u4f4d\u7f6e\u4e0a\u7684\u6570\u636e\u4e3a\u7a7a\uff0c\u6b64\u65f6\u7684<code>key1-value1</code>\u6dfb\u52a0\u6210\u529f\u3002--&gt; \u60c5\u51b51</li> <li>\u5982\u679c\u6b64\u4f4d\u7f6e\u4e0a\u7684\u4f4d\u7f6e\u4e0d\u4e3a\u7a7a\uff0c\u4e00\u4f4d\u7740\u6b64\u4f4d\u7f6e\u4e0a\u5b58\u5728\u4e00\u4e2a\u6216\u591a\u4e2a\u6570\u636e\uff08\u4ee5\u94fe\u8868\u5f62\u5f0f\u5b58\u5728\uff09\uff0c\u6b64\u65f6\u6bd4\u8f83<code>key1</code>\u548c\u5df2\u7ecf\u5b58\u5728\u7684\u4e00\u4e2a\u6216\u591a\u4e2a\u6570\u636e\u7684\u54c8\u5e0c\u503c<ol> <li>\u5982\u679c<code>key1</code>\u7684\u54c8\u5e0c\u503c\u4e0e\u5df2\u7ecf\u5b58\u5728\u7684\u6570\u636e\u7684\u54c8\u5e0c\u503c\u90fd\u4e0d\u540c\uff0c\u6b64\u65f6<code>key1-value1</code>\u6dfb\u52a0\u6210\u529f\u3002 --&gt; \u60c5\u51b52</li> <li>\u5982\u679c<code>key1</code>\u7684\u54c8\u5e0c\u503c\u4e0e\u5df2\u7ecf\u5b58\u5728\u7684\u67d0\u4e00\u4e2a\u6570\u636e\u7684\u54c8\u5e0c\u503c\u76f8\u540c\uff0c\u7ee7\u7eed\u8c03\u7528<code>key</code>\u6240\u5728\u7c7b\u7684<code>equals()</code>\u65b9\u6cd5\u6bd4\u8f83\uff1a<ol> <li>\u5982\u679c<code>equals()</code>\u8fd4\u56de<code>false</code>\uff0c\u6b64\u65f6<code>key1-value1</code>\u6dfb\u52a0\u6210\u529f --&gt; \u60c5\u51b53</li> <li>\u5982\u679c<code>equals()</code>\u8fd4\u56de<code>true</code>\uff0c\u4f7f\u7528<code>value1</code>\u66ff\u6362\u76f8\u540c<code>key</code>\u7684<code>value</code>\u503c</li> </ol> </li> </ol> </li> </ol> <p>\u5173\u4e8e\u60c5\u51b52\u548c\u60c5\u51b53\uff0c\u6b64\u65f6<code>key1-value1</code>\u548c\u539f\u6765\u7684\u6570\u636e\u4ee5\u94fe\u8868\u7684\u65b9\u5f0f\u5b58\u50a8\u3002</p> </li> </ol> </li> <li> <p>\u5728\u4e0d\u65ad\u7684\u6dfb\u52a0\u8fc7\u7a0b\u4e2d\uff0c\u4f1a\u8bbe\u8ba1\u5230\u6269\u5bb9\u95ee\u9898\uff0c\u9ed8\u8ba4\u7684\u6269\u5bb9\u65b9\u5f0f\uff1a\u6269\u5bb9\u4e3a\u539f\u6765\u5bb9\u91cf\u76842\u500d\uff0c\u5e76\u5c06\u539f\u6709\u7684\u6570\u636e\u590d\u5236\u8fc7\u6765\u3002</p> </li> </ol> <p><code>jdk8</code>\u7684\u5b9e\u73b0</p> <ol> <li><code>HashMap hashMap = new HashMap();</code>\u5e95\u5c42\u6ca1\u6709\u957f\u5ea6\u4e3a16\u7684<code>Entry</code>\u6570\u7ec4\uff0c\u5e95\u5c42\u7684\u6570\u7ec4\u662f<code>Node[]</code>\uff0c\u800c\u975e<code>Entry[]</code></li> <li>\u9996\u6b21\u8c03\u7528<code>put()</code>\u65b9\u6cd5\u65f6\uff0c\u5e95\u5c42\u521b\u5efa\u957f\u5ea6\u4e3a16\u7684\u6570\u7ec4</li> <li><code>jdk7</code>\u7684\u5e95\u5c42\u7ed3\u6784\u53ea\u6709\u6570\u636e+\u94fe\u8868\u3002<code>jdk8</code>\u4e2d\u5e95\u5c42\u7ed3\u6784\u4e3a\u6570\u636e+\u94fe\u8868+\u7ea2\u9ed1\u6811\u3002\u5f53\u6570\u7ec4\u7684\u67d0\u4e00\u4e2a\u7d22\u5f15\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u4e00\u94fe\u8868\u5f62\u5f0f\u5b58\u5728\u7684\u6570\u636e\u4e2a\u6570&gt;8\u4e14\u5f53\u524d\u6570\u7ec4\u7684\u957f\u5ea6&gt;64\u65f6\uff0c\u6b64\u65f6\u6b64\u7d22\u5f15\u4f4d\u7f6e\u4e0a\u7684\u6240\u6709\u6570\u636e\u6539\u4e3a\u7ea2\u9ed1\u6811\u5b58\u50a8</li> </ol>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#2-map","title":"2. <code>Map</code>\u7684\u5e38\u7528\u65b9\u6cd5","text":"<pre><code>import java.util.Collection;\nimport java.util.HashMap;\nimport java.util.Iterator;\nimport java.util.Map;\nimport java.util.Set;\n\npublic class HashMapTest {\n    public static void main(String[] args) {\n        HashMap map1 = new HashMap();\n\n        // \u6dfb\u52a0 put()\n        map1.put(\"name\", \"Tom\");\n        map1.put(\"age\", 18);\n\n        HashMap map2 = new HashMap();\n        map2.put(\"gender\", \"man\");\n        // \u6dfb\u52a0 putAll()\n        map1.putAll(map2);\n        System.out.println(map1);  // {gender=man, name=Tom, age=18}\n\n        // \u5220\u9664\uff0c \u88ab\u5220\u9664\u7684\u5143\u7d20\u5b58\u5728\u8fd4\u56de\u8be5\u5143\u7d20\u7684\u503c\uff0c\u4e0d\u5b58\u5728\u8fd4\u56denull\n        Object value = map1.remove(\"name\");\n        System.out.println(value); // Tom\n        System.out.println(map1);  // {gender=man, age=18}\n\n        // \u4fee\u6539\n        map1.put(\"age\", 16);\n        System.out.println(map1);  // {gender=man, age=16}\n\n        // clear()\n//        map1.clear();\n//        System.out.println(map1);  // {}\n\n        // get() \u83b7\u53d6\u6307\u5b9akey\u5bf9\u5e94\u7684value\uff0c\u5b58\u5728\u5219\u8fd4\u56devalue\uff0c\u4e0d\u5b58\u5728\u8fd4\u56denull\n        System.out.println(map1.get(\"gender\"));  // man\n\n        // containsKey() \u662f\u5426\u5305\u542b\u6307\u5b9a\u7684key\n        System.out.println(map1.containsKey(\"age\")); // true\n\n        // containsValue() \u662f\u5426\u5305\u542b\u6307\u5b9a\u7684value\n        System.out.println(map1.containsValue(\"man\")); // true\n\n        // size() \u8fd4\u56demap\u4e2dkey-value\u7684\u4e2a\u6570\n        System.out.println(map1.size());  // 2\n\n        // isEmpty() \u5224\u65ad\u5f53\u524dmap\u662f\u5426\u4e3a\u7a7a\n        System.out.println(map1.isEmpty());  // false\n\n        // equals(obj) \u5224\u65ad\u5f53\u524dmap\u4e0e\u53c2\u6570\u5bf9\u8c61obj\u662f\u5426\u76f8\u7b49\n        System.out.println(map1.equals(map2));  // false\n\n        // keySet() \u904d\u5386\u6240\u6709\u7684key\n        Set set = map1.keySet();\n        Iterator iterator = set.iterator();\n        while (iterator.hasNext()) {\n            System.out.println(iterator.next());\n        }\n\n        // values() \u904d\u5386\u6240\u6709\u7684values\n        Collection values = map1.values();\n        for (Object obj : values) {\n            System.out.println(obj);\n        }\n\n\n        // entrySet() \u904d\u5386\u6240\u6709\u7684key-value\n        Set entrySet = map1.entrySet();\n        Iterator iterator1 = entrySet.iterator();\n        while (iterator1.hasNext()) {\n            Object obj = iterator1.next();\n            Map.Entry entry = (Map.Entry) obj;\n            System.out.println(entry.getKey() + \"--&gt;\" + entry.getValue());\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#3-treemap","title":"3. <code>TreeMap</code>","text":"<p>\u5411<code>TreeMap</code>\u4e2d\u6dfb\u52a0<code>key-value</code>\uff0c\u8981\u6c42key\u5fc5\u987b\u662f\u7531\u540c\u4e00\u4e2a\u7c7b\u521b\u5efa\u7684\u5bf9\u8c61\uff0c\u56e0\u4e3a\u8981\u6309\u7167key\u8fdb\u884c\u6392\u5e8f\uff1a\u81ea\u7136\u6392\u5e8f\u3001\u5b9a\u65f6\u6392\u5e8f</p>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#4-properties","title":"4. <code>Properties</code>","text":"<p>\u5728\u9879\u76ee\u4e0b\u521b\u5efa\u4e00\u4e2a\u6587\u4ef6<code>jdbc.properties</code></p> <pre><code>user=root\npasswd=123456\n</code></pre> <p>\u4f7f\u7528</p> <pre><code>import java.io.FileInputStream;\nimport java.io.FileNotFoundException;\nimport java.io.IOException;\nimport java.util.Properties;\n\npublic class PropertiesTest {\n    public static void main(String[] args) {\n        FileInputStream stream = null;\n        try {\n            Properties properties = new Properties();\n            stream = new FileInputStream(\"jdbc.properties\");\n            properties.load(stream);\n            String user = properties.getProperty(\"user\");\n            String passwd = properties.getProperty(\"passwd\");\n            System.out.println(user);\n            System.out.println(passwd);\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if (stream != null) {\n                try {\n                    stream.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n</code></pre>"},{"location":"programming/java/%E9%AB%98%E7%BA%A7/%E9%9B%86%E5%90%88/#collections","title":"\u4e94\u3001<code>Collections</code>\u5e38\u7528\u65b9\u6cd5","text":"<p>\u64cd\u4f5c<code>Collection</code>\u548c<code>Map</code>\u7684\u5de5\u5177\u7c7b</p> <pre><code>import java.util.ArrayList;\nimport java.util.Arrays;\nimport java.util.Collections;\nimport java.util.List;\n\npublic class CollectionsTest {\n    public static void main(String[] args) {\n\n        ArrayList list = new ArrayList();\n        list.add(8);\n        list.add(3);\n        list.add(9);\n        list.add(5);\n        System.out.println(list);  // [8, 3, 9, 5]\n\n        // reverse(list) \u53cd\u8f6c\n        Collections.reverse(list);\n        System.out.println(list);  // [5, 9, 3, 8]\n\n        // shuffle(list)  \u968f\u673a\u6392\u5e8f\n        Collections.shuffle(list);\n        System.out.println(list); // [9, 8, 5, 3]\n\n        // sort() \u6392\u5e8f\n        Collections.sort(list);\n        System.out.println(list);  // [3, 5, 8, 9]\n\n        System.out.println(Collections.max(list));\n        System.out.println(Collections.min(list));\n\n        // copy()\n        List dest = Arrays.asList(new Object[list.size()]);\n        Collections.copy(dest, list);\n        System.out.println(dest);  // [3, 5, 8, 9]\n    }\n}\n</code></pre>"},{"location":"programming/python/Jinja2/","title":"Jinja2","text":"<p>Jinja2\u662f\u57fa\u4e8epython\u7684\u6a21\u677f\u5f15\u64ce\u3002\u4ed6\u7684\u8bbe\u8ba1\u601d\u60f3\u6765\u6e90\u4e8eDjango\u7684\u6a21\u677f\u5f15\u64ce\uff0c\u5e76\u6269\u5c55\u4e86\u5176\u8bed\u6cd5\u548c\u4e00\u7cfb\u5217\u5f3a\u5927\u7684\u529f\u80fd\u3002</p>"},{"location":"programming/python/Jinja2/#_1","title":"\u4e00\u3001\u57fa\u672c\u5143\u7d20","text":""},{"location":"programming/python/Jinja2/#1","title":"1.\u5b57\u9762\u91cf","text":"<p>\u7528\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u62ec\u8d77\u6765\u7684\u3002\u5982<code>'hello'</code>\u6216<code>\"hello\"</code></p>"},{"location":"programming/python/Jinja2/#2","title":"2.\u5217\u8868","text":"<p>\u4e00\u5bf9\u4e2d\u62ec\u53f7\u62ec\u8d77\u6765\u7684\u4e1c\u897f\u662f\u4e00\u4e2a\u5217\u8868\u3002\u5217\u8868\u7528\u4e8e\u5b58\u50a8\u548c\u8fed\u4ee3\u5e8f\u5217\u5316\u7684\u6570\u636e\u3002</p> <p><code>['a', 'b', 'c']</code></p>"},{"location":"programming/python/Jinja2/#3","title":"3.\u5143\u7ec4","text":"<p>\u5143\u7ec4\u4e0e\u5217\u8868\u7c7b\u4f3c\uff0c\u53ea\u662f\u5143\u7ec4\u4e0d\u80fd\u4fee\u6539\u3002\u5982\u679c\u5143\u7ec4\u4e2d\u53ea\u6709\u4e00\u4e2a\u9879\uff0c\u9700\u8981\u4ee5\u9017\u53f7\u7ed3\u5c3e\u3002</p> <p><code>(\u2018tuple\u2019, \u2018of\u2019, \u2018values\u2019)</code></p>"},{"location":"programming/python/Jinja2/#4","title":"4.\u5b57\u5178","text":"<p>\u5b57\u5178\u5728\u6a21\u677f\u4e2d\u5f88\u5c11\u7528</p> <p><code>{'dict'\uff1a'of'\uff0c'key'\uff1a'and'\uff0c'value'\uff1a'pairs'}</code></p>"},{"location":"programming/python/Jinja2/#5","title":"5. \u8fd0\u7b97\u7b26","text":""},{"location":"programming/python/Jinja2/#51","title":"5.1. \u7b97\u6570\u8fd0\u7b97\u7b26","text":"\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>+</code> <code>{{ 1 + 1 }}</code> --&gt;2 <code>-</code> <code>{{ 3 - 2 }}</code> --&gt;1 <code>/</code> <code>{{ 1 / 2 }}</code> --&gt; 0.5 <code>//</code> <code>{{ 20 // 7 }}</code> --&gt; 2 <code>%</code> <code>{{ 11 % 7 }}</code>--&gt;4 <code>*</code> <code>{{ 2 * 2 }}</code>--&gt;4 <code>**</code> <code>{{ 2**3 }}</code>--&gt;8"},{"location":"programming/python/Jinja2/#52","title":"5.2. \u6bd4\u8f83\u8fd0\u7b97\u7b26","text":"\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>==</code> \u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u76f8\u7b49 <code>!=</code> \u6bd4\u8f83\u4e24\u4e2a\u5bf9\u8c61\u662f\u5426\u4e0d\u7b49 <code>&gt;</code> \u5982\u679c\u5de6\u8fb9\u5927\u4e8e\u53f3\u8fb9\uff0c\u8fd4\u56de true <code>&gt;=</code> \u5982\u679c\u5de6\u8fb9\u5927\u4e8e\u7b49\u4e8e\u53f3\u8fb9\uff0c\u8fd4\u56de true <code>&lt;</code> \u5982\u679c\u5de6\u8fb9\u5c0f\u4e8e\u53f3\u8fb9\uff0c\u8fd4\u56de true \u3002 <code>&lt;=</code> \u5982\u679c\u5de6\u8fb9\u5c0f\u4e8e\u7b49\u4e8e\u53f3\u8fb9\uff0c\u8fd4\u56de true \u3002"},{"location":"programming/python/Jinja2/#53","title":"5.3. \u903b\u8f91\u8fd0\u7b97\u7b26","text":"\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>and</code> \u4e0e <code>or</code> \u6216 <code>not</code> \u975e <code>()</code> \u8868\u8fbe\u5f0f\u7ec4"},{"location":"programming/python/Jinja2/#54","title":"5.4. \u5176\u4ed6\u8fd0\u7b97\u7b26","text":"\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>in</code> <code>{{ 1 in[1,2,3] }}</code> \u8fd4\u56detrue <code>is</code> \u6d4b\u8bd5 <code>~</code> \u628a\u6240\u6709\u7684\u64cd\u4f5c\u6570\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32\uff0c\u5e76\u4e14\u8fde\u63a5\u5b83\u4eec\uff0c<code>{{ \"Hello \" ~ name ~ \"!\" }}</code>--&gt;Hello John!"},{"location":"programming/python/Jinja2/#6","title":"6.\u53d8\u91cf","text":""},{"location":"programming/python/Jinja2/#61","title":"6.1. \u53d8\u91cf\u5c5e\u6027\u7684\u8bbf\u95ee\u65b9\u5f0f","text":"<pre><code>{{ foo.bar }}\n{{ foo['bar']}\n</code></pre> <p>\u4e24\u8005\u5728Python \u5c42\u4e2d\u7684\u533a\u522b\uff1a</p> <p>foo.bar</p> <ul> <li>\u68c0\u67e5 foo \u4e0a\u662f\u5426\u6709\u4e00\u4e2a\u540d\u4e3a bar \u7684\u5c5e\u6027\uff08<code>getattr(foo, 'bar')</code>\uff09</li> <li>\u5982\u679c\u6ca1\u6709\uff0c\u68c0\u67e5 foo \u4e2d\u662f\u5426\u6709\u4e00\u4e2a 'bar' \u9879\uff08<code>foo.__getitem__('bar')</code>\uff09</li> <li>\u5982\u679c\u6ca1\u6709\uff0c\u8fd4\u56de\u4e00\u4e2a\u672a\u5b9a\u4e49\u5bf9\u8c61</li> </ul> <p>foo['bar']</p> <ul> <li>\u68c0\u67e5\u5728 foo \u4e2d\u662f\u5426\u6709\u4e00\u4e2a 'bar' \u9879\uff08<code>foo.__getitem__('bar')</code>\uff09</li> <li>\u5982\u679c\u6ca1\u6709\uff0c\u68c0\u67e5 foo \u4e0a\u662f\u5426\u6709\u4e00\u4e2a\u540d\u4e3a bar \u7684\u5c5e\u6027\uff08<code>getattr(foo, 'bar')</code>\uff09</li> <li>\u5982\u679c\u6ca1\u6709\uff0c\u8fd4\u56de\u4e00\u4e2a\u672a\u5b9a\u4e49\u5bf9\u8c61</li> </ul>"},{"location":"programming/python/Jinja2/#62","title":"6.2. \u53d8\u91cf\u8d4b\u503c","text":""},{"location":"programming/python/Jinja2/#621-set","title":"6.2.1. \u53d8\u91cf\u8d4b\u503c<code>set</code>","text":"<p><code>{% set username='admin' %}</code></p>"},{"location":"programming/python/Jinja2/#622-with","title":"6.2.2. \u53d8\u91cf\u4f5c\u7528\u57df<code>with</code>","text":"<p>\u4f7f\u7528with\u53ef\u4ee5\u4fee\u6539\u53d8\u91cf\u4f5c\u7528\u57df\uff0c\u53ea\u6709\u5728with\u5757\u4e2d\u53ef\u4ee5\u4f7f\u7528\u5b9a\u4e49\u7684\u53d8\u91cf</p> <pre><code>{% with foo = 42 %}\n    {{ foo }}\n{% endwith %}\n{#\u7b49\u4ef7\u4e8e#}\n{% with %}\n    {% set foo = 42 %}\n    {{ foo }}\n{% endwith %}\n</code></pre>"},{"location":"programming/python/Jinja2/#7","title":"7. \u6a21\u677f\u7ec4\u6210","text":"<p>\u6a21\u677f\u4e2d\u5305\u62ec\u53d8\u91cf\u3001\u8868\u8fbe\u5f0f\u3001\u6807\u7b7e</p> <p><code>{% ... %}</code>: \u8bed\u53e5\uff08for \u5faa\u73af\u548c\u8d4b\u503c\u7b49\u8bed\u53e5\uff09</p> <p><code>{{ ... }}</code>: \u8868\u8fbe\u5f0f</p>"},{"location":"programming/python/Jinja2/#8","title":"8. \u6ce8\u91ca","text":"<p><code>{# ... #}</code></p>"},{"location":"programming/python/Jinja2/#_2","title":"\u4e8c\u3001\u6a21\u677f\u6e32\u67d3","text":""},{"location":"programming/python/Jinja2/#1_1","title":"1. \u5b57\u7b26\u4e32","text":"<pre><code>&gt;&gt;&gt; from jinja2 import Template\n&gt;&gt;&gt; template = Template(\"hello {{ name }}!\")\n&gt;&gt;&gt; template.render(name=\"\u5f20\u4e09\")\n'hello \u5f20\u4e09!'\n</code></pre>"},{"location":"programming/python/Jinja2/#2_1","title":"2. \u6a21\u677f\u52a0\u8f7d\u5668","text":"<pre><code>\u2514\u2500mysite\n    \u2502  test.py\n    \u2502  __init__.py\n    \u2502\n    \u251c\u2500templates\n           index.html\n</code></pre>"},{"location":"programming/python/Jinja2/#21","title":"2.1.  \u901a\u8fc7\u6a21\u5757\u52a0\u8f7d","text":"<pre><code># __file__: test.py\nimport os,sys\nfrom jinja2 import Environment, PackageLoader\nBASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))\nsys.path.append(BASE_DIR)\n\nenv = Environment(loader=PackageLoader('mysite', 'templates'))\ntemplate = env.get_template('index.html')\nprint(template.render(name=\"\u5f20\u4e09\"))\n</code></pre>"},{"location":"programming/python/Jinja2/#22","title":"2.2. \u901a\u8fc7\u6587\u4ef6\u7cfb\u7edf\u52a0\u8f7d","text":"<pre><code># __file__: test.py\nimport os\nfrom jinja2 import FileSystemLoader, Environment\n\ntemplate_path = os.path.join(os.path.dirname(__file__), 'templates')\nenv = Environment(loader = FileSystemLoader(template_path))\ntemplate = env.get_template('index.html')\nprint(template.render(name=\"\u5f20\u4e09\"))\n</code></pre>"},{"location":"programming/python/Jinja2/#_3","title":"\u4e09\u3001\u63a7\u5236\u7ed3\u6784","text":""},{"location":"programming/python/Jinja2/#1-for","title":"1. For","text":""},{"location":"programming/python/Jinja2/#11","title":"1.1. \u8fed\u4ee3\u4e00\u4e2a\u5217\u8868","text":"<pre><code>&lt;ul&gt;\n{% for user in users %}\n  &lt;li&gt;{{ user.username|e }}&lt;/li&gt;\n{# |e \u8868\u793a\u8f6c\u4e49 #}\n{% endfor %}\n&lt;/ul&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#12","title":"1.2. \u8fed\u4ee3\u4e00\u4e2a\u5b57\u5178","text":"<pre><code>{% for key, value in my_dict.items() %}\n    &lt;dt&gt;{{ key|e }}&lt;/dt&gt;\n    &lt;dd&gt;{{ value|e }}&lt;/dd&gt;\n{% endfor %}\n</code></pre>"},{"location":"programming/python/Jinja2/#13-else","title":"1.3. \u5982\u679c\u5e8f\u5217\u662f\u7a7a\uff0c\u53ef\u4ee5\u4f7f\u7528 else \u6e32\u67d3\u4e00\u4e2a\u7528\u4e8e\u66ff\u6362\u7684\u5757","text":"<pre><code>\u5982\u679c\u56e0\u5e8f\u5217\u662f\u7a7a\u6216\u8005\u8fc7\u6ee4\u79fb\u9664\u4e86\u5e8f\u5217\u4e2d\u7684\u6240\u6709\u9879\u76ee\u800c\u6ca1\u6709\u6267\u884c\u5faa\u73af\uff0c\u4f60\u53ef\u4ee5\u4f7f\u7528 else \u6e32\u67d3\u4e00\u4e2a\u7528\u4e8e\u66ff\u6362\u7684\u5757\n{% for user in users %}\n    &lt;li&gt;{{ user.username|e }}&lt;/li&gt;\n{% else %}\n    &lt;li&gt;&lt;em&gt;no users found&lt;/em&gt;&lt;/li&gt;\n{% endfor %}\n</code></pre> <p>\u5faa\u73af\u5757\u4e2d\u53ef\u4ee5\u8bbf\u95ee\u7684\u7279\u6b8a\u7684\u53d8\u91cf</p> \u53d8\u91cf \u63cf\u8ff0 loop.index \u5f53\u524d\u5faa\u73af\u8fed\u4ee3\u7684\u6b21\u6570\uff08\u4ece 1 \u5f00\u59cb\uff09 loop.index0 \u5f53\u524d\u5faa\u73af\u8fed\u4ee3\u7684\u6b21\u6570\uff08\u4ece 0 \u5f00\u59cb\uff09 loop.revindex \u5230\u5faa\u73af\u7ed3\u675f\u9700\u8981\u8fed\u4ee3\u7684\u6b21\u6570\uff08\u4ece 1 \u5f00\u59cb\uff09 loop.revindex0 \u5230\u5faa\u73af\u7ed3\u675f\u9700\u8981\u8fed\u4ee3\u7684\u6b21\u6570\uff08\u4ece 0 \u5f00\u59cb\uff09 loop.first \u5982\u679c\u662f\u7b2c\u4e00\u6b21\u8fed\u4ee3\uff0c\u4e3a True \u3002 loop.last \u5982\u679c\u662f\u6700\u540e\u4e00\u6b21\u8fed\u4ee3\uff0c\u4e3a True \u3002 loop.length \u5e8f\u5217\u4e2d\u7684\u9879\u76ee\u6570\u3002 <p>\u7279\u6b8a\u53d8\u91cf\u7684\u7528\u6cd5\uff1a</p> <pre><code>import os\nfrom jinja2 import FileSystemLoader, Environment\n\ntemplate_path = os.path.join(os.path.dirname(__file__), 'templates')\nenv = Environment(loader = FileSystemLoader(template_path))\ntemplate = env.get_template('index.html')\nletters = ['A', 'B', 'C']\nprint(template.render(letters=letters))\n</code></pre> <pre><code>{% for letter in letters -%}\n    {{ loop.index  }} : {{ letter }}\n{% endfor %}\n</code></pre> <p>\u6267\u884c\u7ed3\u679c\uff1a</p> <p>1 : A 2 : B 3 : C</p> <p>\u6ce8\u610f\uff1ajinja2\u4e2d\u4e0d\u53ef\u4ee5\u4f7f\u7528<code>continue</code>\u548c<code>break</code>\u8868\u8fbe\u5f0f\u63a7\u5236\u5faa\u73af</p>"},{"location":"programming/python/Jinja2/#2-if","title":"2. IF","text":"<p><code>if</code>\u8bed\u53e5\u4e0epython\u4e2d\u7684\u7c7b\u4f3c\uff0c\u53ef\u4ee5\u4f7f\u7528&gt;\u3001&gt;=\u3001&lt;\u3001&lt;=\u3001==\u3001!=\u6765\u8fdb\u884c\u5224\u65ad\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528and\u3001or\u3001not\u3001()\u8fdb\u884c\u903b\u8f91\u5408\u5e76\u64cd\u4f5c\u3002</p> <pre><code>{% if kenny.sick %}\n    Kenny is sick.\n{% elif kenny.dead %}\n    You killed Kenny!  You bastard!!!\n{% else %}\n    Kenny looks okay --- so far\n{% endif %}\n</code></pre>"},{"location":"programming/python/Jinja2/#3_1","title":"3. \u5b8f","text":"<p>\u5b8f\u7c7b\u4f3c\u5e38\u89c4\u7f16\u7a0b\u8bed\u8a00\u4e2d\u7684\u51fd\u6570\uff0c\u53ef\u4ee5\u4f20\u9012\u53c2\u6570\uff0c\u4f46\u4e0d\u80fd\u6709\u8fd4\u56de\u503c\u3002</p>"},{"location":"programming/python/Jinja2/#31","title":"3.1. \u5b9a\u4e49\u4e00\u4e2a\u5b8f","text":"<pre><code>{# \u5b9a\u4e49\u4e00\u4e2a\u5b8f #}\n{% macro input(name, value='', type='text', size=20) -%}\n    &lt;input type=\"{{ type }}\" name=\"{{ name }}\" value=\"{{ value|e }}\" size=\"{{ size }}\"&gt;\n{%- endmacro %}\n</code></pre>"},{"location":"programming/python/Jinja2/#32","title":"3.2. \u8c03\u7528\u5b8f","text":"<pre><code>{# \u8c03\u7528\u5b8f #}\n&lt;p&gt;{{ input('username') }}&lt;/p&gt;\n&lt;p&gt;{{ input('password', type='password') }}&lt;/p&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#33-import","title":"3.3. \u5bfc\u5165\u5b8f<code>import</code>","text":"<p>\u901a\u5e38\u4f1a\u628a\u6240\u6709\u7684\u5b8f\u5b9a\u4e49\u5728\u4e00\u4e2a\u6a21\u677f\u4e2d\uff0c\u5982\u679c\u5176\u4ed6\u6a21\u677f\u9700\u8981\u4f7f\u7528\uff0c\u5c31\u9700\u8981\u5148\u5bfc\u5165\u3002</p>"},{"location":"programming/python/Jinja2/#331","title":"3.3.1. \u5bfc\u5165\u6574\u4e2a\u6a21\u677f","text":"<pre><code>{% import 'forms.html' as forms %}\n&lt;dl&gt;\n    &lt;dt&gt;Username&lt;/dt&gt;\n    {# \u4f7f\u7528\u7684\u65f6\u5019\u8981\u52a0\u522b\u540d\u4f5c\u4e3a\u524d\u7f00 #}\n    &lt;dd&gt;{{ forms.input('username') }}&lt;/dd&gt;\n    &lt;dt&gt;Password&lt;/dt&gt;\n    &lt;dd&gt;{{ forms.input('password', type='password') }}&lt;/dd&gt;\n&lt;/dl&gt;\n&lt;p&gt;{{ forms.textarea('comment') }}&lt;/p&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#332","title":"3.3.2. \u4ece\u6a21\u677f\u4e2d\u5bfc\u5165\u6307\u5b9a\u7684\u5b8f\u540d\u79f0\u5230\u5f53\u524d\u7684\u547d\u540d\u7a7a\u95f4","text":"<pre><code>{% from 'forms.html' import input as input_field, textarea %}\n&lt;dl&gt;\n    &lt;dt&gt;Username&lt;/dt&gt;\n    {# \u4f7f\u7528\u7684\u65f6\u5019\u8981\u4f7f\u7528\u522b\u540d #}\n    &lt;dd&gt;{{ input_field('username') }}&lt;/dd&gt;\n    &lt;dt&gt;Password&lt;/dt&gt;\n    &lt;dd&gt;{{ input_field('password', type='password') }}&lt;/dd&gt;\n&lt;/dl&gt;\n&lt;p&gt;{{ textarea('comment') }}&lt;/p&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#333-with-context","title":"3.3.3. <code>with context</code>\u4f20\u9012\u4e0a\u4e0b\u6587\u5230\u6a21\u677f","text":"<pre><code>{# \u5982\u679c\u60f3\u8981\u5728\u5bfc\u5165\u5b8f\u7684\u65f6\u5019\u5c31\u628a\u5f53\u524d\u6a21\u677f\u7684\u4e00\u4e9b\u53c2\u6570\u4f20\u9012\u7ed9\u5b8f\u6240\u5728\u7684\u6a21\u677f\uff0c\u5c31\u5e94\u8be5\u5728\u5bfc\u5165\u7684\u65f6\u5019\u4f7f\u7528 with context #}\n{% from 'forms.html' import input with context %}\n</code></pre>"},{"location":"programming/python/Jinja2/#4-include","title":"4. \u5305\u542b<code>include</code>","text":"<p><code>include</code> \u8bed\u53e5\u7528\u4e8e\u5305\u542b\u4e00\u4e2a\u6a21\u677f\uff0c\u5e76\u5728\u5f53\u524d\u547d\u540d\u7a7a\u95f4\u4e2d\u8fd4\u56de\u90a3\u4e2a\u6587\u4ef6\u7684\u5185\u5bb9\u6e32\u67d3\u7ed3\u679c\u3002</p> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;title&gt;include\u7684\u7528\u6cd5&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        {% include 'header.html' %} {# \u76f8\u5f53\u4e8e\u628aheader.html\u7684\u5185\u5bb9\u62f7\u8d1d\u5230\u8fd9\u91cc #}\n            Body\n        {% include 'footer.html' %}\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6ce8\u610f\uff1a\u6a21\u677f\u8def\u5f84\u76f8\u5bf9\u4e8e<code>templates</code>\u76ee\u5f55</p>"},{"location":"programming/python/Jinja2/#6_1","title":"6. \u5b8f\u7279\u6b8a\u53d8\u91cf","text":"\u53d8\u91cf \u63cf\u8ff0 varargs \u5982\u679c\u6709\u591a\u4e8e\u5b8f\u63a5\u53d7\u7684\u53c2\u6570\u4e2a\u6570\u7684\u4f4d\u7f6e\u53c2\u6570\u88ab\u4f20\u5165\uff0c\u5b83\u4eec\u4f1a\u4f5c\u4e3a\u5217\u8868\u7684\u503c\u4fdd\u5b58\u5728 varargs\u53d8\u91cf\u4e0a\u3002 kwargs \u540c varargs \uff0c\u4f46\u53ea\u9488\u5bf9\u5173\u952e\u5b57\u53c2\u6570\u3002\u6240\u6709\u672a\u4f7f\u7528\u7684\u5173\u952e\u5b57\u53c2\u6570\u4f1a\u5b58\u50a8\u5728 \u8fd9\u4e2a\u7279\u6b8a\u53d8\u91cf\u4e2d\u3002 caller \u5982\u679c\u5b8f\u901a\u8fc7 call \u6807\u7b7e\u8c03\u7528\uff0c\u8c03\u7528\u8005\u4f1a\u4f5c\u4e3a\u53ef\u8c03\u7528\u7684\u5b8f\u88ab\u5b58\u50a8\u5728\u8fd9\u4e2a \u53d8\u91cf\u4e2d\u3002"},{"location":"programming/python/Jinja2/#7_1","title":"7. \u5b8f\u5bf9\u8c61\u5c5e\u6027","text":"\u5c5e\u6027 \u63cf\u8ff0 name \u5b8f\u7684\u540d\u79f0\u3002 {{ input.name }} \u4f1a\u6253\u5370 input \u3002 arguments \u4e00\u4e2a\u5b8f\u63a5\u53d7\u7684\u53c2\u6570\u540d\u7684\u5143\u7ec4\u3002 defaults \u9ed8\u8ba4\u503c\u7684\u5143\u7ec4\u3002 catch_kwargs \u5982\u679c\u5b8f\u63a5\u53d7\u989d\u5916\u7684\u5173\u952e\u5b57\u53c2\u6570\uff08\u4e5f\u5c31\u662f\u8bbf\u95ee\u7279\u6b8a\u7684 kwargs \u53d8\u91cf\uff09\uff0c\u4e3a true \u3002 catch_varargs \u5982\u679c\u5b8f\u63a5\u53d7\u989d\u5916\u7684\u4f4d\u7f6e\u53c2\u6570\uff08\u4e5f\u5c31\u662f\u8bbf\u95ee\u7279\u6b8a\u7684 varargs \u53d8\u91cf\uff09\uff0c\u4e3a true \u3002 caller \u5982\u679c\u5b8f\u8bbf\u95ee\u7279\u6b8a\u7684 caller \u53d8\u91cf\u4e14\u7531 call \u6807\u7b7e\u8c03\u7528\uff0c\u4e3a true \u3002"},{"location":"programming/python/Jinja2/#4-call","title":"4. \u8c03\u7528call","text":""},{"location":"programming/python/Jinja2/#41","title":"4.1. \u65e0\u53c2\u6570\u8c03\u7528","text":"<pre><code>{% macro render_dialog(title, class='dialog') -%}\n    &lt;div class=\"{{ class }}\"&gt;\n        &lt;h2&gt;{{ title }}&lt;/h2&gt;\n        &lt;div class=\"contents\"&gt;\n            {{ caller() }}\n        &lt;/div&gt;\n    &lt;/div&gt;\n{%- endmacro %}\n\n{# \u5b8f\u8c03\u7528 #}\n{% call render_dialog('Hello World') %}\n    This is a simple dialog rendered by using a macro and\n    a call block.\n{% endcall %}\n</code></pre> <p>\u6e32\u67d3\u7ed3\u679c</p> <pre><code>    &lt;div class=\"dialog\"&gt;\n            &lt;h2&gt;Hello World&lt;/h2&gt;\n            &lt;div class=\"contents\"&gt;\n\n        This is a simple dialog rendered by using a macro and\n        a call block.\n\n            &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#42","title":"4.2. \u5e26\u53c2\u6570\u8c03\u7528","text":"<pre><code>{% macro dump_users(users) -%}\n    &lt;ul&gt;\n    {%- for user in users %}\n        &lt;li&gt;&lt;p&gt;{{ user.username|e }}&lt;/p&gt;{{ caller(user) }}&lt;/li&gt;\n    {%- endfor %}\n    &lt;/ul&gt;\n{%- endmacro %}\n\n{% call(user) dump_users(list_of_user) %}\n    &lt;dl&gt;\n        &lt;dl&gt;Realname&lt;/dl&gt;\n        &lt;dd&gt;{{ user.realname|e }}&lt;/dd&gt;\n        &lt;dl&gt;Description&lt;/dl&gt;\n        &lt;dd&gt;{{ user.description }}&lt;/dd&gt;\n    &lt;/dl&gt;\n{% endcall %}\n</code></pre>"},{"location":"programming/python/Jinja2/#_4","title":"\u56db\u3001\u8fc7\u6ee4\u5668","text":"<p>\u8fc7\u6ee4\u5668\u53ef\u4ee5\u7528\u6765\u4fee\u6539\u53d8\u91cf\uff0c\u8fc7\u6ee4\u5668\u7531\u7ad6\u7ebf\u7b26\u53f7\uff08<code>|</code>\uff09\u4e0e\u53d8\u91cf\u5206\u5f00\uff0c\u53ef\u4ee5\u94fe\u63a5\u591a\u4e2a\u8fc7\u6ee4\u5668\u3002\u4e00\u4e2a\u6ee4\u6ce2\u5668\u7684\u8f93\u51fa\u5c06\u5e94\u7528\u4e8e\u4e0b\u4e00\u4e2a\u3002</p> <p><code>{{ num|abs }}</code></p>"},{"location":"programming/python/Jinja2/#1_2","title":"1. \u5185\u7f6e\u8fc7\u6ee4\u5668","text":"\u8fc7\u6ee4\u5668 \u529f\u80fd <code>abs()</code> \u8fd4\u56de\u4e00\u4e2a\u6570\u7684\u7edd\u5bf9\u503c <code>escape()</code> \u5bf9\u67d0\u4e00\u4e2a\u5b57\u7b26\u8f6c\u4e49,\u522b\u540d<code>e</code> <code>safe()</code> \u5173\u95ed\u4e00\u4e2a\u5b57\u7b26\u4e32\u7684\u81ea\u52a8\u8f6c\u4e49, \u7981\u7528\u8f6c\u4e49 <code>default()</code> <code>{{ value | default('\u9ed8\u8ba4\u503c')</code> <code>first()</code> \u8fd4\u56de\u5e8f\u5217\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 <code>last()</code> \u8fd4\u56de\u5e8f\u5217\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20 <code>format()</code> \u683c\u5f0f\u5316\u5b57\u7b26\u4e32<code>{{ \"%s, %s!\" | format(greeting, name) }}</code> <code>length()</code> \u8fd4\u56de\u4e00\u4e2a\u5e8f\u5217\u7c7b\u578b\u7684\u957f\u5ea6 <code>join()</code> \u5c06\u4e00\u4e2a\u5e8f\u5217\uff0c\u7528\u6307\u5b9a\u7684\u53c2\u6570\u62fc\u63a5\u6210\u5b57\u7b26\u4e32,<code>{{ [1, 2, 3]|join('|')</code> --&gt;1|2|3 <code>int()</code> \u5c06\u503c\u8f6c\u6362\u4e3a int \u7c7b\u578b <code>float()</code> \u5c06\u503c\u8f6c\u6362\u4e3a float \u7c7b\u578b <code>string()</code> \u5c06\u53d8\u91cf\u8f6c\u6362\u4e3a\u5b57\u7b26\u4e32 <code>lower()</code> \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5c0f\u5199 <code>upper()</code> \u5c06\u5b57\u7b26\u4e32\u8f6c\u6362\u4e3a\u5927\u5199 <code>replace()</code> \u66ff\u6362\u5b57\u7b26\u4e32\uff0c<code>{{ \"Hello World\"|replace(\"Hello\", \"Goodbye\") }}</code>--&gt;Goodbye World <code>truncate()</code> \u622a\u53d6\u6307\u5b9a\u957f\u5ea6\u7684\u5b57\u7b26\u4e32\uff0c  <code>{{ \"foo bar baz qux\"|truncate(9) }}</code> <code>striptags()</code> \u5220\u9664\u5b57\u7b26\u4e32\u4e2d\u6240\u6709\u7684HTML\u6807\u7b7e\uff0c\u5982\u679c\u51fa\u73b0\u591a\u4e2a\u7a7a\u683c\uff0c\u5c06\u66ff\u6362\u6210\u4e00\u4e2a\u7a7a\u683c <code>trim()</code> \u53bb\u9664\u5f00\u5934\u548c\u7ed3\u5c3e\u5b57\u7b26 <code>wordcount()</code> \u8ba1\u7b97\u4e00\u4e2a\u957f\u5b57\u7b26\u4e32\u4e2d\u5355\u8bcd\u7684\u4e2a\u6570"},{"location":"programming/python/Jinja2/#2_2","title":"2. \u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668","text":"<pre><code>import os\nfrom jinja2 import FileSystemLoader, Environment\n\n# \u5b9a\u4e49\u4e00\u4e2a\u8fc7\u6ee4\u5668\u51fd\u6570\ndef say_hello(name):\n    return name + ' hello'\ntemplate_path = os.path.join(os.path.dirname(__file__), 'templates')\nenv = Environment(loader = FileSystemLoader(template_path))\n# \u5c06\u51fd\u6570\u6dfb\u52a0\u5230\u8fc7\u6ee4\u5668\u5b57\u5178\u4e2d\nenv.filters['say_hello'] = say_hello\ntemplate = env.get_template('index.html')\nprint(template.render(name=\"\u5f20\u4e09\"))\n</code></pre> <pre><code># __file__ : index.html\n# \u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u8fc7\u6ee4\u5668\n{{ name|say_hello }}\n</code></pre>"},{"location":"programming/python/Jinja2/#_5","title":"\u4e94\u3001\u6d4b\u8bd5","text":"<p>\u6d4b\u8bd5\u4e00\u4e2a\u53d8\u91cf\u6216\u8868\u8fbe\u5f0f</p> <p>\u4f8b\u5982\uff1a<code>{% if loop.index is divisibleby 3 %}</code></p>"},{"location":"programming/python/Jinja2/#1_3","title":"1. \u5185\u7f6e\u6d4b\u8bd5\u51fd\u6570","text":"\u51fd\u6570 \u529f\u80fd <code>defined()</code> <code>{% if variable is defined %}</code> <code>divisibleby()</code> \u68c0\u67e5\u53d8\u91cf\u662f\u5426\u53ef\u88ab\u6570\u5b57\u6574\u9664\u3002 <code>escaped()</code> \u68c0\u67e5\u8be5\u503c\u662f\u5426\u8f6c\u4e49 <code>even()</code> \u5982\u679c\u53d8\u91cf\u4e3a\u5076\u6570\uff0c\u5219\u8fd4\u56detrue <code>iterable()</code> \u68c0\u67e5\u662f\u5426\u53ef\u4ee5\u8fed\u4ee3\u5bf9\u8c61\u3002 <code>lower()</code> \u5982\u679c\u53d8\u91cf\u662f\u5c0f\u5199\u7684\uff0c\u5219\u8fd4\u56detrue <code>number()</code> \u5982\u679c\u53d8\u91cf\u662f\u6570\u5b57\uff0c\u5219\u8fd4\u56detrue <code>odd()</code> \u5982\u679c\u53d8\u91cf\u4e3a\u5947\u6570\uff0c\u5219\u8fd4\u56detrue <code>sequence()</code> \u5982\u679c\u53d8\u91cf\u662f\u5e8f\u5217\uff0c\u5219\u8fd4\u56detrue <code>string()</code> \u5982\u679c\u5bf9\u8c61\u662f\u5b57\u7b26\u4e32\uff0c\u5219\u8fd4\u56detrue"},{"location":"programming/python/Jinja2/#2_3","title":"2. \u81ea\u5b9a\u4e49\u6d4b\u8bd5","text":"<pre><code># __file__:index.html\n{% if num is prime %}\n    {{ num }} is a prime number\n{% else %}\n    {{ num }} is not a prime number\n{% endif %}\n</code></pre> <pre><code>import os\nfrom jinja2 import FileSystemLoader, Environment\nimport math\n\n# \u5b9a\u4e49\u4e00\u4e2a\u6d4b\u8bd5\u51fd\u6570\ndef is_prime(n):\n    if n == 2:\n        return True\n    for i in range(2, int(math.ceil(math.sqrt(n))) + 1):\n        if n % i == 0:\n            return False\n    return True\n\ntemplate_path = os.path.join(os.path.dirname(__file__), 'templates')\nenv = Environment(loader = FileSystemLoader(template_path))\n\n# \u5c06\u51fd\u6570\u6dfb\u52a0\u5230\u6d4b\u8bd5\u5b57\u5178\u4e2d\nenv.tests['prime'] = is_prime\ntemplate = env.get_template('index.html')\nprint(template.render(num=11))\n# \u8fd0\u884c\u7ed3\u679c\n11 is a prime number\n</code></pre>"},{"location":"programming/python/Jinja2/#_6","title":"\u516d\u3001\u6a21\u677f\u7ee7\u627f","text":"<p>\u6a21\u677f\u7ee7\u627f\u53ef\u4ee5\u628a\u4e00\u90e8\u5206\u516c\u7528\u7684\u4ee3\u7801\u62bd\u53d6\u51fa\u6765\u653e\u5230\u4e00\u4e2a\u7236\u6a21\u677f\u4e2d\uff0c\u4ee5\u540e\u5b50\u6a21\u677f\u76f4\u63a5\u7ee7\u627f\u5c31\u53ef\u4ee5\u4f7f\u7528\u4e86\u3002</p>"},{"location":"programming/python/Jinja2/#1_4","title":"1. \u7236\u6a21\u677f","text":"<p>\u628a\u76f8\u540c\u90e8\u5206\u90fd\u653e\u5728\u7236\u6a21\u677f\u4e2d<code>base.html</code></p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    {% block head %}\n    &lt;link rel=\"stylesheet\" href=\"style.css\" /&gt;\n    &lt;title&gt;{% block title %}{% endblock %} - My Webpage&lt;/title&gt;\n    {% endblock %}\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div id=\"content\"&gt;{% block content %}{% endblock %}&lt;/div&gt;\n    &lt;div id=\"footer\"&gt;\n        {% block footer %}\n        &amp;copy; Copyright 2008 by &lt;a href=\"http://domain.invalid/\"&gt;you&lt;/a&gt;.\n        {% endblock %}\n    &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#2_4","title":"2. \u5b50\u6a21\u677f","text":"<p>\u5148\u7528<code>extends</code>\u7ee7\u627f\u7236\u6a21\u677f\uff0c\u628a\u4e2a\u6027\u90e8\u5206\u653e\u5728<code>block</code>\u5757\u4e2d</p> <pre><code>{% extends \"base.html\" %}\n{% block title %}Index{% endblock %}\n{% block head %}\n    {{ super() }}\n    &lt;style type=\"text/css\"&gt;\n        .important { color: #336699; }\n    &lt;/style&gt;\n{% endblock %}\n{% block content %}\n    &lt;h1&gt;Index&lt;/h1&gt;\n    &lt;p class=\"important\"&gt;\n      Welcome to my awesome homepage.\n    &lt;/p&gt;\n{% endblock %}\n</code></pre>"},{"location":"programming/python/Jinja2/#3-super","title":"3. \u4f7f\u7528\u7236\u6a21\u677f\u4e2d\u7684\u5185\u5bb9<code>super()</code>","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u5728\u5b50\u6a21\u677f\u5185\u5bb9\u4f1a\u8986\u76d6\u7236\u6a21\u677f\u5757\u4e2d\u7684\u5185\u5bb9\uff0c\u53ef\u4ee5\u901a\u8fc7</p> <p><code>{{ super() }}</code>\u4fdd\u7559\u7236\u5757\u7684\u5185\u5bb9\u3002\u4f8b\u5b50\u540c\u4e0a\u3002</p>"},{"location":"programming/python/Jinja2/#4-blockself","title":"4. \u8c03\u7528\u53e6\u4e00\u4e2ablock\u4e2d\u7684\u4ee3\u7801<code>self.\u5176\u4ed6\u5757\u7684\u540d\u5b57()</code>","text":"<pre><code>{% block title %}\n    Hello World!\n{% endblock %}\n\n{% block body %}\n    {{ self.title() }}\n{% endblock %}\n</code></pre>"},{"location":"programming/python/Jinja2/#5_1","title":"5. \u5757\u4e2d\u53d8\u91cf\u7684\u4f5c\u7528\u57df","text":"<p>\u9ed8\u8ba4\u7684\u5757\u4e0d\u5141\u8bb8\u8bbf\u95ee\u5757\u5916\u4f5c\u7528\u57df\u4e2d\u7684\u53d8\u91cf\uff0c\u52a0<code>scoped</code>\u4fee\u6539\u4f5c\u7528\u57df</p> <pre><code>{% for item in seq %}\n    &lt;li&gt;{% block loop_item scoped %}{{ item }}{% endblock %}&lt;/li&gt;\n{% endfor %}\n</code></pre>"},{"location":"programming/python/Jinja2/#_7","title":"\u4e03\u3001\u7a7a\u767d\u63a7\u5236","text":"<p>\u4f7f\u7528\u4e0b\u9762\u7684\u6a21\u677f\u6e32\u67d3\uff0c</p> <pre><code>&lt;div&gt;\n    {% if True %}\n        yay\n    {% endif %}\n&lt;/div&gt;\n</code></pre> <p>\u751f\u6210\u7684\u7ed3\u679c\u4f1a\u6709\u7a7a\u884c</p> <pre><code>&lt;div&gt;\n\n        yay\n\n&lt;/div&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#1-","title":"1. \u4f7f\u7528\u51cf\u53f7\uff08<code>-</code>\uff09\u5220\u9664\u7a7a\u884c","text":"<pre><code>&lt;div&gt;\n    {% if True -%}\n        {{ name }}\n    {%- endif %}\n&lt;/div&gt;\n</code></pre>"},{"location":"programming/python/Jinja2/#_8","title":"\u516b\u3001\u8f6c\u4e49","text":""},{"location":"programming/python/Jinja2/#1_5","title":"1. \u90e8\u5206\u8f6c\u4e49","text":"<p>\u4f7f\u7528\u53d8\u91cf\u5206\u9694\u7b26</p> <p><code>{{ '{{' }}</code></p>"},{"location":"programming/python/Jinja2/#2-raw","title":"2. \u5757\u8f6c\u4e49<code>raw</code>","text":"<p>\u7528<code>raw</code>\u6807\u8bb0</p> <pre><code>{% raw %}\n    &lt;ul&gt;\n    {% for item in seq %}\n        &lt;li&gt;{{ item }}&lt;/li&gt;\n    {% endfor %}\n    &lt;/ul&gt;\n{% endraw %}\n</code></pre>"},{"location":"programming/python/Jinja2/#3-autoescape","title":"3. \u81ea\u52a8\u8f6c\u4e49<code>autoescape</code>","text":"<pre><code>{% autoescape true %}\n\u81ea\u52a8\u8f6c\u4e49\u5728\u8fd9\u5757\u6587\u672c\u4e2d\u662f\u5f00\u542f\u7684\u3002\n{% endautoescape %}\n\n{% autoescape false %}\n\u81ea\u52a8\u8f6c\u4e49\u5728\u8fd9\u5757\u6587\u672c\u4e2d\u662f\u5173\u95ed\u7684\u3002\n{% endautoescape %}\n</code></pre>"},{"location":"programming/python/DRF/install/","title":"\u5b89\u88c5","text":""},{"location":"programming/python/DRF/install/#_2","title":"\u4e00\u3001\u5b98\u7f51","text":"<pre><code>https://www.django-rest-framework.org/\n</code></pre>"},{"location":"programming/python/DRF/install/#_3","title":"\u4e8c\u3001\u5b89\u88c5","text":"<pre><code>$ pip install djangorestframework==3.10\n</code></pre>"},{"location":"programming/python/DRF/install/#_4","title":"\u4e09\u3001\u6ce8\u518c","text":"<pre><code># filename: settings.py\nINSTALLED_APPS = [\n    ...\n    'rest_framework',\n]\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/","title":"\u5e8f\u5217\u5316\uff08Serializers\uff09","text":""},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#_1","title":"\u4e00\u3001\u5e8f\u5217\u5316","text":"<ol> <li> <p>\u5e8f\u5217\u5316\uff1a\u5e8f\u5217\u5316\u5668\u4f1a\u628a\u6a21\u578b\u5bf9\u8c61\u8f6c\u6362\u6210\u5b57\u5178,\u7ecf\u8fc7<code>response</code>\u4ee5\u540e\u53d8\u6210<code>json</code>\u5b57\u7b26\u4e32</p> </li> <li> <p>\u53cd\u5e8f\u5217\u5316\uff1a\u628a\u5ba2\u6237\u7aef\u53d1\u9001\u8fc7\u6765\u7684\u6570\u636e\u7ecf\u8fc7<code>request</code>\u4ee5\u540e\u53d8\u6210\u5b57\u5178\uff0c\u5e8f\u5217\u5316\u5668\u53ef\u4ee5\u628a\u5b57\u5178\u8f6c\u6210\u6a21\u578b\u3002</p> </li> </ol>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#_2","title":"\u4e8c\u3001\u57fa\u672c\u4f7f\u7528","text":""},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#1","title":"1. \u67e5","text":"<p>\u4f7f\u7528\u6d41\u7a0b\uff1a</p> <ol> <li>\u65b0\u5efa\u4e00\u4e2a<code>py</code>\u6587\u4ef6\uff08\u4e13\u95e8\u7528\u6765\u5199\u5e8f\u5217\u5316\u7c7b\uff09\u5199\u4e00\u4e2a\u5e8f\u5217\u5316\u7684\u7c7b\uff0c\u7ee7\u627f<code>Serializer</code>\u3002\u5728\u7c7b\u4e2d\u5199\u8981\u5e8f\u5217\u5316\u7684\u5b57\u6bb5\uff08\u60f3\u5e8f\u5217\u5316\u54ea\u4e2a\u5b57\u6bb5\uff0c\u5c31\u5728\u7c7b\u4e2d\u5199\u54ea\u4e2a\u5b57\u6bb5\uff09\u3002</li> <li>\u5728\u89c6\u56fe\u7c7b\u4e2d\u4f7f\u7528\uff1a\u5bfc\u5165\u5e8f\u5217\u5316\u7c7b\u7136\u540e\u5b9e\u4f8b\u5316\u5f97\u5230\u5e8f\u5217\u5316\u7c7b\u7684\u5bf9\u8c61\uff0c\u5e76\u4e14\u628a\u8981\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\u4f20\u5165\u3002</li> <li><code>\u5e8f\u5217\u5316\u7c7b\u7684\u5bf9\u8c61.data</code>\u53ef\u4ee5\u5f97\u5230\u4e00\u4e2a\u5b57\u5178</li> <li>\u628a\u5b57\u5178\u8fd4\u56de\uff1a\u5982\u679c\u4e0d\u4f7f\u7528<code>rest_framework</code>\u7684<code>Response</code>\uff0c\u5c31\u5f97\u4f7f\u7528<code>JsonResponse</code></li> </ol>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#1-modelspy","title":"1. \u51c6\u5907<code>models.py</code>","text":"<p>\u5e8f\u5217\u5316<code>Serializers</code>\u662f\u4e3a\u4e86\u65b9\u4fbf\u64cd\u4f5c\u6a21\u578b\uff0c\u5148\u51c6\u5907models\u3002</p> <pre><code>class Book(models.Model):\n    title = models.CharField(max_length=32, verbose_name=\"\u4e66\u540d\")\n    price = models.DecimalField(max_digits=8, decimal_places=2, verbose_name=\"\u4ef7\u683c\")\n    sales = models.IntegerField(verbose_name='\u9500\u552e\u91cf')\n\n    publish = models.ForeignKey(to='Publish')\n    authors = models.ManyToManyField(to='Author')\n\n\nclass Publish(models.Model):\n    name = models.CharField(max_length=32, verbose_name=\"\u51fa\u7248\u793e\u540d\u79f0\")\n    addr = models.CharField(max_length=64, verbose_name=\"\u901a\u8baf\u5730\u5740\")\n\n\nclass Author(models.Model):\n    name = models.CharField(max_length=32, verbose_name=\"\u4f5c\u8005\u59d3\u540d\")\n    age = models.IntegerField(verbose_name=\"\u5e74\u9f84\")\n\n    author_detail = models.OneToOneField(to='AuthorDetail')\n\n\nclass AuthorDetail(models.Model):\n    email = models.EmailField(verbose_name=\"\u90ae\u7bb1\")\n    addr = models.CharField(max_length=32, verbose_name=\"\u901a\u8baf\u5730\u5740\")\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#2","title":"2. \u521b\u5efa\u5e8f\u5217\u5316\u7684\u7c7b","text":"<p>\u65b0\u5efa\u4e00\u4e2a<code>serializers.py</code></p> <pre><code>from rest_framework import serializers\n\n\nclass BookSerializer(serializers.Serializer):\n    # \u5199\u4e0a\u8981\u5e8f\u5217\u5316\u7684\u5b57\u6bb5\uff1aserializers.\u5b57\u6bb5\u7c7b\u578b()\n    # \u952e\u7684\u540d\u5b57\u8981\u548cmodel.py\u4e2d\u7684\u4e00\u6837\n    id = serializers.IntegerField()\n    title = serializers.CharField()\n    price = serializers.DecimalField(max_digits=8, decimal_places=2)\n    sales = serializers.IntegerField()\n    publish_id = serializers.IntegerField()\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#3-viewspy","title":"3. \u5728<code>views.py</code>\u5199\u89c6\u56fe","text":"<p>\u9700\u8981\u7ee7\u627f<code>rest_framework</code>\u4e2d\u7684<code>APIView</code>\u3002</p> <pre><code>from django.shortcuts import render, HttpResponse\n\n# Create your views here.\nfrom rest_framework.views import APIView\nfrom app.models import Book\nfrom app.serializers import BookSerializer\nfrom rest_framework.response import Response\n\n\nclass BookView(APIView):\n    # \u67e5\u8be2\u4e00\u6761\u6570\u636e\n    def get(self, request, pk):\n        book = Book.objects.filter(id=pk).first()\n        book_ser_obj = BookSerializer(book)  # \u5b9e\u4f8b\u5316\uff0c\u4f20\u5165\u8981\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\n\n        return Response(book_ser_obj.data)  # \u8fd4\u56de\u5e8f\u5217\u5316\u4ee5\u540e\u7684\u5b57\u5178\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#4-urlspy","title":"4. \u5728<code>urls.py</code>\u6ce8\u518c\u8def\u7531","text":"<pre><code>from django.conf.urls import url\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    url(r'^admin/', admin.site.urls),\n    url(r'^books/(?P&lt;pk&gt;\\d)', views.BookView.as_view()),\n]\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#5","title":"5. \u9a8c\u8bc1","text":""},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#2_1","title":"2. \u6539","text":"<p>\u4f7f\u7528\u6d41\u7a0b\uff1a</p> <ol> <li>\u5199\u4e00\u4e2a\u5e8f\u5217\u5316\u7684\u7c7b\uff0c\u7ee7\u627f<code>Serializer</code>\u3002\u5728\u7c7b\u4e2d\u5199\u8981\u53cd\u5e8f\u5217\u5316\u7684\u5b57\u6bb5\u3002</li> <li>\u5728\u89c6\u56fe\u7c7b\u4e2d\u4f7f\u7528\uff1a\u5bfc\u5165\u5e8f\u5217\u5316\u7c7b\uff1b\u5b9e\u4f8b\u5316\u5f97\u5230\u5e8f\u5217\u5316\u7c7b\u7684\u5bf9\u8c61\uff0c\u628a\u8981\u4fee\u6539\u7684\u5bf9\u8c61\u548c\u4fee\u6539\u7684\u6570\u636e\u4f20\u5165\u3002\u5982\uff1a<code>book_ser_obj=BookSerializer(instance=book,data=request.data)</code></li> <li> <p>\u6570\u636e\u6821\u9a8c <code>book_ser_obj.is_valid()</code></p> </li> <li> <p>\u5982\u679c\u6821\u9a8c\u901a\u8fc7\uff0c\u5c31\u4fdd\u5b58\uff1a<code>book_ser_obj.save()</code></p> </li> <li>\u5982\u679c\u6821\u9a8c\u4e0d\u901a\u8fc7\uff0c\u81ea\u5df1\u5199\u903b\u8f91\u5904\u7406</li> <li> <p>\u5982\u679c\u5b57\u6bb5\u7684\u6821\u9a8c\u89c4\u5219\u4e0d\u591f\uff0c\u53ef\u4ee5\u5199\u94a9\u5b50\u51fd\u6570</p> </li> <li> <p>\u5c40\u90e8\u94a9\u5b50\uff1a\u6821\u9a8c\u4e00\u4e2a\u5b57\u6bb5</p> </li> <li>\u5168\u5c40\u94a9\u5b50\uff1a\u540c\u65f6\u6821\u9a8c\u591a\u4e2a\u5b57\u6bb5</li> </ol>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#21-put","title":"2.1 \u5728\u89c6\u56fe\u7c7b\u4e2d\u5199<code>put()</code>\u65b9\u6cd5","text":"<pre><code>class BookView(APIView):\n    ...\n    def put(self, request, pk):\n        # \u5b9a\u4e49\u4e00\u4e2a\u8fd4\u56de\u7684\u6570\u636e\n        response_msg = {'status': 100, 'msg': '\u6210\u529f'}\n\n        # \u627e\u5230\u8981\u4fee\u6539\u7684\u5bf9\u8c61\n        book = Book.objects.filter(id=pk).first()\n\n        # \u5f97\u5230\u4e00\u4e2a\u5e8f\u5217\u5316\u7c7b\u7684\u5bf9\u8c61\n        # \u9700\u8981\u4f20\u5165\u7684\u53c2\u6570\u53ef\u4ee5\u518d\u7236\u7c7b\u4e2d\u627e\u5230\n        # class BaseSerializer(Field):\n        #     def __init__(self, instance=None, data=empty, **kwargs):\n        book_ser_obj = BookSerializer(instance=book, data=request.data)\n\n        # \u8fdb\u884c\u6570\u636e\u9a8c\u8bc1\n        if book_ser_obj.is_valid():  # \u8fd4\u56deTrue\u8868\u793a\u9a8c\u8bc1\u901a\u8fc7\n            book_ser_obj.save()\n            response_msg['data'] = book_ser_obj.data  # \u5b57\u5178\u683c\u5f0f\n        else:\n            response_msg['status'] = 101\n            response_msg['msg'] = '\u6570\u636e\u6821\u9a8c\u5931\u8d25'\n            response_msg['data'] = book_ser_obj.errors\n\n        return Response(response_msg)\n</code></pre> <p>\u5f53\u76f4\u63a5\u53d1\u9001<code>PUT</code>\u8bf7\u6c42\u65f6\uff0c\u4f1a\u629b\u51fa\u5f02\u5e38</p> <pre><code>  File \"D:\\APP\\python36\\lib\\site-packages\\rest_framework\\serializers.py\", line 165, in update\n    raise NotImplementedError('`update()` must be implemented.')   \n</code></pre> <p>\u5728<code>serializers.py</code>\u4e2d\u901a\u8fc7\u6765<code>raise</code>\u629b\u51fa\u5f02\u5e38\uff0c\u8981\u6c42\u6211\u4eec\u91cd\u65b0<code>update()</code>\u65b9\u6cd5\u3002</p> <pre><code>#  serializers.py\nclass BaseSerializer(Field):\n    ...\n    def update(self, instance, validated_data):\n        raise NotImplementedError('`update()` must be implemented.')\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#22-serializespyupdate","title":"2.2 \u5728<code>serializes.py</code>\u4e2d\u91cd\u5199<code>update()</code>\u65b9\u6cd5","text":"<pre><code>class BookSerializer(serializers.Serializer):\n    ...\n   def update(self, instance, validated_data):\n        # instance\u662fbook\u8fd9\u4e2a\u5bf9\u8c61\n        # validated_data\u662f\u6821\u9a8c\u540e\u7684\u6570\u636e\n        instance.title = validated_data.get('title')\n        instance.price = validated_data.get('price')\n        instance.sales = validated_data.get('sales')\n        instance.publish_id = validated_data.get('publish_id')\n        instance.save()  # book.save()   django \u7684orm\u63d0\u4f9b\u7684\n        return instance\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#23","title":"2.3 \u6570\u636e\u6821\u9a8c\u7684\u94a9\u5b50\u51fd\u6570","text":""},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#231","title":"2.3.1 \u5c40\u90e8\u94a9\u5b50","text":"<pre><code># serializers.py\nfrom rest_framework import serializers\nfrom rest_framework.serializers import ValidationError\n\nclass BookSerializer(serializers.Serializer):\n    ...\n    # \u5c40\u90e8\u94a9\u5b50\n    def validate_price(self, data):  # validate_\u5b57\u6bb5\u540d  \u63a5\u6536\u4e00\u4e2a\u53c2\u6570\n        # \u5982\u679c\u4ef7\u683c\u5c0f\u4e8e0\uff0c\u5c31\u6821\u9a8c\u4e0d\u901a\u8fc7\n        print(type(data))  # &lt;class 'str'&gt;\n        print(data)  # -200\n        if float(data) &gt; 0:\n            return data\n        else:\n            # \u6821\u9a8c\u5931\u8d25\uff0c\u629b\u5f02\u5e38\n            raise ValidationError('\u4ef7\u683c\u4e0d\u80fd\u4e3a\u8d1f\u6570')\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#232","title":"2.3.2 \u5168\u5c40\u94a9\u5b50","text":"<pre><code>from rest_framework import serializers\nfrom rest_framework.serializers import ValidationError\n\nclass BookSerializer(serializers.Serializer):\n    ...\n    # \u5168\u5c40\u94a9\u5b50\uff0c\u6821\u9a8c\u591a\u4e2a\u5b57\u6bb5\n    def validate(self, validate_data):\n        price = validate_data.get('price')\n        sales = validate_data.get('sales')\n        if price &lt; 0 or sales &lt; 0:\n            raise ValidationError('\u5b57\u6bb5\u4e0d\u80fd\u4e3a\u8d1f\u6570')\n        else:\n            return validate_data\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#3","title":"3. \u5220","text":"<pre><code># views.py\nfrom rest_framework.response import Response\n\nclass BookView(APIView):\n\n    ...\n    def delete(self,request,pk):\n        response_msg = {'status': 100, 'msg': '\u6210\u529f'}\n        ret = Book.objects.filter(pk=pk).delete()\n        return Response(response_msg)\n</code></pre> <p>\u4ee5\u4e0a\u7684\u4e09\u79cd\u65b9\u6cd5\u5728\u53d1\u9001\u8bf7\u6c42\u65f6\uff0c\u90fd\u9700\u8981\u5728<code>books/</code>\u540e\u52a0\u4e00\u4e2a\u4e3b\u952e\u503c\u3002\u6240\u4ee5\u4e0a\u8ff0\u7684\u4e09\u79cd\u65b9\u6cd5\u53ef\u4ee5\u516c\u7528\u540c\u4e00\u4e2a\u89c6\u56fe\u3002\u4f46\u662f\u5bf9\u4e8e\u67e5\u8be2\u6240\u6709\u6570\u636e\u548c\u65b0\u589e\u6570\u636e\uff0c<code>books/</code>\u540e\u4e0d\u9700\u8981\u52a0\u53c2\u6570\uff0c\u9700\u8981\u65b0\u5efa\u4e00\u4e2a\u89c6\u56fe\u7c7b\u548c<code>url</code>\u5339\u914d\u89c4\u5219\u6765\u5b9e\u73b0\u67e5\u8be2\u6240\u6709\u548c\u65b0\u589e\u6570\u636e\u7684\u65b9\u6cd5\u3002</p>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#4","title":"4. \u67e5\u8be2\u6240\u6709","text":"<p>\u65b0\u589e\u4e00\u4e2a\u89c6\u56fe\u7c7b</p> <pre><code>class BooksView(APIView):\n    def get(self, request):\n        response_msg = {'status': 100, 'msg': '\u6210\u529f'}\n        books = Book.objects.all()\n        book_ser_obj = BookSerializer(books, many=True)  # \u5e8f\u5217\u5316\u591a\u6761,\u5982\u679c\u5e8f\u5217\u5316\u4e00\u6761\uff0c\u4e0d\u9700\u8981\u5199\n        response_msg['data'] = book_ser_obj.data\n        return Response(response_msg)\n</code></pre> <p>\u6dfb\u52a0\u8def\u7531</p> <pre><code>from django.conf.urls import url\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    url(r'^admin/', admin.site.urls),\n    url(r'^books/(?P&lt;pk&gt;\\d)', views.BookView.as_view()),\n    url(r'^books/', views.BooksView.as_view()),\n]\n</code></pre> <p></p>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#5_1","title":"5. \u589e","text":"<pre><code>class BooksView(APIView):\n    # \u65b0\u589e\n    def post(self, request):\n        response_msg = {'status': 100, 'msg': '\u6210\u529f'}\n        # \u4fee\u6539\u624d\u6709instance\uff0c\u65b0\u589e\u6ca1\u6709instance\uff0c\u53ea\u6709data\n        book_ser_obj = BookSerializer(data=request.data)\n        # \u6821\u9a8c\u5b57\u6bb5\n        if book_ser_obj.is_valid():\n            book_ser_obj.save()  # \u9700\u8981\u4ece\u5199create()\n            response_msg['data'] = book_ser_obj.data\n        else:\n            response_msg['status'] = 102\n            response_msg['msg'] = '\u6570\u636e\u6821\u9a8c\u5931\u8d25'\n            response_msg['data'] = book_ser_obj.errors\n        return Response(response_msg)\n</code></pre> <p>\u76f4\u63a5\u8bbf\u95ee\u540c\u6837\u4f1a\u629b\u51fa\u5f02\u5e38\uff0c\u9700\u8981\u5728\u5e8f\u5217\u5316\u7c7b\u4e2d\u91cd\u5199<code>create()</code>\u65b9\u6cd5</p> <pre><code># serializers.py\nfrom app.views import Book\nclass BookSerializer(serializers.Serializer):\n    ...\n    def create(self, validated_data):\n        instance = Book.objects.create(**validated_data)\n        return instance\n</code></pre> <p></p>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#source","title":"\u4e09\u3001<code>source</code>\u7684\u4f7f\u7528","text":""},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#1_1","title":"1. \u4fee\u6539\u5e8f\u5217\u5316\u7c7b\u4e2d\u5b57\u6bb5\u7684\u540d\u5b57","text":"<p>\u5982\u679c\u4e0d\u60f3\u76f4\u63a5\u5c06model\u4e2d\u5b57\u6bb5\u7684\u540d\u5b57\u66b4\u9732\uff0c\u53ef\u4ee5\u901a\u8fc7source\u6765\u6307\u5b9amodel\u4e2d\u5b57\u6bb5\u7684\u540d\u5b57\uff0c\u5e8f\u5217\u5316\u7c7b\u4e2d\u7684\u952e\u53ef\u4ee5\u7528\u522b\u7684\u540d\u5b57\u6765\u4ee3\u66ff\u3002</p> <pre><code>class BookSerializer(serializers.Serializer):\n    id = serializers.IntegerField()\n    # title = serializers.CharField()\n    name = serializers.CharField(source='title')\n    ...\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#2_2","title":"2. \u8de8\u8868","text":"<pre><code>class BookSerializer(serializers.Serializer):\n    ...\n    publish = serializers.CharField(source='publish.name')  # \u67e5\u8be2\u51fa\u51fa\u7248\u793e\u7684\u540d\u79f0\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#3-model","title":"3. \u6267\u884cmodel\u8868\u4e2d\u7684\u65b9\u6cd5","text":"<p>source \u5982\u679c\u662f\u5b57\u6bb5\uff0c\u4f1a\u663e\u793a\u5b57\u6bb5\uff0c\u5982\u679c\u662f\u65b9\u6cd5\uff0c\u4f1a\u6267\u884c\u65b9\u6cd5\uff0c\u4e0d\u7528\u52a0\u62ec\u53f7\u3002 \u5982\u5728\u6a21\u578b\u4e2d\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5\uff0c\u76f4\u63a5\u53ef\u4ee5\u5728\u5728source\u6307\u5b9a\u6267\u884c \u3002</p> <pre><code># \u5728\u6a21\u578b\u4e2d\u52a0\u4e00\u4e2achoices\u5b57\u6bb5\nclass Book(models.Model):\n    ...\n\n    stock_status = models.IntegerField(choices=((0, '\u5145\u8db3'), (1, \"\u7d27\u5f20\"), (2, \"\u65e0\u8d27\")), verbose_name='\u5e93\u5b58\u72b6\u6001', default=0)\n\n    # \u6a21\u578b\u8868\u4e2d\u81ea\u5df1\u5b9a\u4e49\u7684\u65b9\u6cd5\n    def access_time(self):\n        import datetime\n        return datetime.datetime.now()\n</code></pre> <p>\u5982\u679c\u60f3\u5728\u54cd\u5e94\u4e2d\u663e\u793a\u8fd9\u4e2a\u5b57\u6bb5\u5bf9\u5e94\u7684\u6c49\u5b57\uff0c\u5c31\u53ef\u4ee5\u4f7f\u7528source\u3002</p> <pre><code>class BookSerializer(serializers.Serializer):\n    ...\n    stock_status = serializers.CharField(source='get_stock_status_display')\n    time = serializers.CharField(source='access_time')\n</code></pre> <p></p>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#response","title":"\u56db\u3001\u5c01\u88c5Response\u5bf9\u8c61","text":"<p>\u4e0a\u9762\u7684\u6bcf\u4e00\u4e2a\u65b9\u6cd5\u4e2d\u90fd\u5199\u4e86\u4e00\u4e2a<code>response_msg</code>\u3002\u53ef\u4ee5\u5229\u7528\u7684\u9762\u5411\u5bf9\u8c61\u7684\u5c01\u88c5\u7279\u6027\uff0c\u628a\u54cd\u5e94\u7684\u6d88\u606f\u5c01\u88c5\u5230\u4e00\u4e2a\u7c7b\u4e2d\u3002</p> <pre><code># 1. \u81ea\u5b9a\u4e49MyResponse\u7c7b\nclass MyResponse:\n    def __init__(self):\n        self.status = 100\n        self.msg = '\u6210\u529f'\n\n    @property\n    def get_dict(self):\n        return self.__dict__\n\n\nclass BooksView(APIView):\n\n    def get(self, request):\n        response = MyResponse()\n        books = Book.objects.all()\n        book_ser_obj = BookSerializer(books, many=True)  # \u5e8f\u5217\u5316\u591a\u6761,\u5982\u679c\u5e8f\u5217\u5316\u4e00\u6761\uff0c\u4e0d\u9700\u8981\u5199\n        response.data = book_ser_obj.data\n        return Response(response.get_dict)\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#serializermethodfield","title":"\u4e94\u3001<code>SerializerMethodField</code>","text":"<p>\u5982\u679c\u60f3\u8981\u5728\u5e8f\u5217\u5316\u7684\u5b57\u6bb5\u4e2d\u52a0\u5165<code>authors</code>\uff0c\u76f4\u63a5\u52a0<code>authors = serializers.CharField()</code>\u8fd4\u56de\u7684\u662f<code>\"authors\": \"app.Author.None\"</code>\u3002\u9700\u8981\u501f\u52a9<code>SerializerMethodField</code>\u6765\u8fd4\u56de\u5176\u4ed6\u5b57\u6bb5\u3002</p> <pre><code>class BookSerializer(serializers.Serializer):\n    ...\n    # \u9700\u8981\u6709\u4e2a\u914d\u5957\u65b9\u6cd5\uff0c\u65b9\u6cd5\u540d\u53ebget_\u5b57\u6bb5\u540d\uff0c\u8fd4\u56de\u503c\u5c31\u662f\u8981\u663e\u793a\u7684\u4e1c\u897f\n    authors = serializers.SerializerMethodField()\n\n    def get_authors(self, instance):\n        # book\u5bf9\u8c61\n        authors = instance.authors.all()  # \u53d6\u51fa\u6240\u6709\u4f5c\u8005\n        res = []\n        for author in authors:\n            res.append({'name': author.name, 'age': author.age})\n        return res\n</code></pre> <p></p>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#modelserializer","title":"\u516d\u3001 \u6a21\u578b\u7c7b\u5e8f\u5217\u5316\u5668<code>ModelSerializer</code>","text":"<ol> <li> <p>\u4e0d\u9700\u8981\u91cd\u5199<code>create()</code>\u548c<code>update()</code>\u65b9\u6cd5\u4e86\uff0c\u5176\u4ed6\u4f7f\u7528\u548c\u4e0a\u8ff0\u4e00\u6837\u3002</p> </li> <li> <p>\u5e8f\u5217\u5316\u6570\u636e\u5e93\u65f6\u4f7f\u7528</p> </li> </ol>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#1_2","title":"1. \u5b9a\u4e49","text":"<pre><code>class BookModelSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Book  # \u6307\u660e\u53c2\u7167\u54ea\u4e2a\u6a21\u578b\u7c7b\uff0c\u5bf9\u5e94\u4e0amodels.py\u4e2d\u7684\u6a21\u578b\n        fields = '__all__' # \u6307\u660e\u4e3a\u6a21\u578b\u7c7b\u7684\u54ea\u4e9b\u5b57\u6bb5\u751f\u6210\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#2_3","title":"2.   \u6307\u5b9a\u5e8f\u5217\u5316\u5b57\u6bb5","text":""},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#21-fields__all__","title":"2.1  \u4f7f\u7528fields\u6765\u660e\u786e\u5b57\u6bb5\uff0c<code>__all__</code>\u8868\u540d\u5305\u542b\u6240\u6709\u5b57\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u5199\u660e\u5177\u4f53\u54ea\u4e9b\u5b57\u6bb5\uff0c\u5982","text":"<pre><code>class BookModelSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Book\n        fields = ('id', 'title','price')  # \u53ea\u5e8f\u5217\u5316\u6307\u5b9a\u7684\u5b57\u6bb5\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#22-exclude","title":"2.2  \u4f7f\u7528exclude\u6392\u9664\u5b57\u6bb5","text":"<pre><code>class BookModelSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Book\n        exclude = ('name',) # fields\u548cexclude\u53ea\u80fd\u5199\u5176\u4e2d\u4e00\u4e2a\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#23_1","title":"2.3  \u6307\u660e\u53ea\u8bfb\u5b57\u6bb5","text":"<pre><code>class BookModelSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Book\n        fields = '__all__'\n        read_only_fields=('name',)\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#24","title":"2.4 \u989d\u5916\u53c2\u6570","text":"<pre><code>class BookModelSerializer(serializers.ModelSerializer):\n    class Meta:\n        model=Book \n        fields='__all__'\n        extra_kwargs = {  # \u7c7b\u4f3c\u4e8e\u8fd9\u79cd\u5f62\u5f0fname=serializers.CharField(max_length=16,min_length=4)\n            'price': {'write_only': True},\n        }\n</code></pre>"},{"location":"programming/python/DRF/%E5%BA%8F%E5%88%97%E5%8C%96/#25depth","title":"2.5<code>depth</code>","text":"<p>\u8fde\u8868\u6309\u5c42\u6b21\u6df1\u5ea6\u8fd4\u56de\u6bcf\u4e00\u5c42\u7684\u6240\u6709 \u5b57\u6bb5</p> <p>\u8fd4\u56de\u7684\u5b57\u6bb5\u8fc7\u591a</p>"},{"location":"programming/python/DRF/%E8%87%AA%E5%AE%9A%E4%B9%89response/","title":"\u81ea\u5b9a\u4e49response","text":""},{"location":"programming/python/DRF/%E8%87%AA%E5%AE%9A%E4%B9%89response/#_1","title":"\u4e00\u3001\u81ea\u5b9a\u4e49\u5f02\u5e38\u5904\u7406","text":"<pre><code>from rest_framework.response import Response\n\n\nclass APIResponse(Response):\n    def __init__(self,code=100,msg='\u6210\u529f',data=None,status=None,headers=None,**kwargs):\n        dic = {'code': code, 'msg': msg}\n        if  data:\n            dic = {'code': code, 'msg': msg,'data':data}\n        dic.update(kwargs)\n        super().__init__(data=dic, status=status,headers=headers)\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/","title":"\u89c6\u56fe","text":"<p><code>rest framework</code>\u4e2d\u7684\u4e24\u4e2a\u89c6\u56fe\u57fa\u7c7b</p> <ol> <li><code>APIView</code></li> <li><code>GenericAPIView</code></li> </ol>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#apiview","title":"\u4e00\u3001\u57fa\u4e8eAPIView\u5199\u63a5\u53e3","text":"<p><code>APIView</code>\u7ee7\u627f\u81ea<code>View</code>\u3002</p> <pre><code>class Book(models.Model):\n    title = models.CharField(max_length=32, verbose_name=\"\u4e66\u540d\")\n    price = models.DecimalField(max_digits=8, decimal_places=2, verbose_name=\"\u4ef7\u683c\")\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#1","title":"1. \u5e8f\u5217\u5316\u7c7b","text":"<pre><code>from rest_framework import serializers\nfrom app.views import Book\n\n\nclass BookSerializer(serializers.ModelSerializer):\n    class Meta:\n        model = Book\n        fields = '__all__'\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#2","title":"2. \u89c6\u56fe","text":"<pre><code>from django.shortcuts import render\n\n# Create your views here.\nfrom rest_framework.views import APIView\nfrom app.models import Book\nfrom app.serializers import BookSerializer\nfrom rest_framework.response import Response\n\n\nclass BookView(APIView):\n\n    def get(self, request, pk):\n        book = Book.objects.filter(id=pk).first()\n        book_ser_obj = BookSerializer(book)\n\n        return Response(book_ser_obj.data)\n\n    def put(self, request, pk):\n        book = Book.objects.filter(id=pk).first()\n        book_ser_obj = BookSerializer(instance=book, data=request.data)\n\n        if book_ser_obj.is_valid():  # \u8fd4\u56deTrue\u8868\u793a\u9a8c\u8bc1\u901a\u8fc7\n            book_ser_obj.save()\n            return Response(book_ser_obj.data)\n        else:\n            return Response({'status': 100, 'msg': '\u6210\u529f'})\n\n    def delete(self, request, pk):\n        ret = Book.objects.filter(pk=pk).delete()\n        return Response({'status': 100, 'msg': '\u6210\u529f'})\n\n\nclass BooksView(APIView):\n\n    def get(self, request):\n        books = Book.objects.all()\n        book_ser_obj = BookSerializer(books, many=True)  # \u5e8f\u5217\u5316\u591a\u6761,\u5982\u679c\u5e8f\u5217\u5316\u4e00\u6761\uff0c\u4e0d\u9700\u8981\u5199\n        return Response(book_ser_obj.data)\n\n    def post(self, request):\n\n        book_ser_obj = BookSerializer(data=request.data)\n        if book_ser_obj.is_valid():\n            book_ser_obj.save()  # \u9700\u8981\u4ece\u5199create()\n            return Response(book_ser_obj.data)\n        else:\n            return Response({'status': 100, 'msg': '\u6210\u529f'})\n    # \u589e\u591a\u6761\u6570\u636e\n        # if isinstance(request.data,list):\n        #     book_ser_obj = BookSerializer(data=request.data, many=True)\n        # \u5206\u6790\u6e90\u7801 \n\n    # \u6539\u591a\u6761\u6570\u636e\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#3","title":"3. \u8def\u7531","text":"<pre><code>from django.conf.urls import url\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    url(r'^admin/', admin.site.urls),\n    url(r'^books/(?P&lt;pk&gt;\\d)', views.BookView.as_view()),\n    url(r'^books/', views.BooksView.as_view()),\n]\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#genericapiview","title":"\u4e8c\u3001 \u57fa\u4e8e<code>GenericAPIView</code>\u5199\u63a5\u53e3","text":"<p>\u770b\u6e90\u7801\u53ef\u77e5<code>GenericAPIView</code>\u7ee7\u627f\u4e86<code>APIView</code>\uff1a</p> <pre><code>class GenericAPIView(views.APIView):\n    ...\n    queryset = None  # queryset\u8981\u4f20queryset\u5bf9\u8c61\n    serializer_class = None  # \u4f7f\u7528\u54ea\u4e2a\u5e8f\u5217\u5316\u7c7b\u6765\u5e8f\u5217\u5316\u6570\u636e\n    ...\n</code></pre> <p>\u7ee7\u627f<code>GenericAPIView</code>\u4fee\u6539\u89c6\u56fe</p> <pre><code>from django.shortcuts import render\n\n# Create your views here.\nfrom rest_framework.views import APIView\nfrom app.models import Book\nfrom app.serializers import BookSerializer\nfrom rest_framework.response import Response\n\nfrom rest_framework.generics import GenericAPIView\n\n\nclass BookView(GenericAPIView):\n    queryset = Book.objects\n    serializer_class = BookSerializer\n\n    def get(self, request, pk):\n        # book = Book.objects.filter(id=pk).first()\n        book = self.get_object()\n        book_ser_obj = self.get_serializer(book)\n\n        return Response(book_ser_obj.data)\n\n    def put(self, request, pk):\n        book = self.get_object()\n        book_ser_obj = self.get_serializer(instance=book, data=request.data)\n\n        if book_ser_obj.is_valid():  # \u8fd4\u56deTrue\u8868\u793a\u9a8c\u8bc1\u901a\u8fc7\n            book_ser_obj.save()\n            return Response(book_ser_obj.data)\n        else:\n            return Response({'status': 100, 'msg': '\u6210\u529f'})\n\n    def delete(self, request, pk):\n        ret = self.get_object().delete()\n        return Response({'status': 100, 'msg': '\u6210\u529f'})\n\n\nclass BooksView(GenericAPIView):\n    queryset = Book.objects\n    serializer_class = BookSerializer\n\n    def get(self, request):\n        # books = Book.objects.all()\n        books = self.get_queryset()  # \u770b\u6e90\u7801\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u5c31\u53ea\u6267\u884c\u7684 Book.objects.all()\n        # book_ser_obj = BookSerializer(books, many=True)  # \u5e8f\u5217\u5316\u591a\u6761,\u5982\u679c\u5e8f\u5217\u5316\u4e00\u6761\uff0c\u4e0d\u9700\u8981\u5199\n        book_ser_obj = self.get_serializer(books, many=True)\n        return Response(book_ser_obj.data)\n\n    def post(self, request):\n\n        # book_ser_obj = BookSerializer(data=request.data)\n        book_ser_obj = self.get_serializer(data=request.data)\n        if book_ser_obj.is_valid():\n            book_ser_obj.save()  # \u9700\u8981\u4ece\u5199create()\n            return Response(book_ser_obj.data)\n        else:\n            return Response({'status': 100, 'msg': '\u6210\u529f'})\n</code></pre> <p>\u7528\u4e86<code>GenericAPIView</code>\u4ee5\u540e\uff0c\u518d\u5199\u5176\u4ed6\u6a21\u578b\u7684\u5e8f\u5217\u5316\uff0c\u53ea\u9700\u8981\u4fee\u6539<code>queryset</code>\u548c<code>serializer_class</code>\u7684\u503c\u5c31\u53ef\u4ee5\u4e86\uff0c\u4e24\u4e2a\u89c6\u56fe\u4e2d\u7684\u65b9\u6cd5\uff08get,post,put,delete\uff09\uff0c\u4e0d\u9700\u8981\u6539\uff0c\u76f4\u63a5\u590d\u5236\u5c31\u53ef\u4ee5\u7528\u4e86\u3002\u4f46\u662f\u8fd9\u79cd\u5199\u6cd5\u5f88\u5197\u4f59\uff0c\u53ef\u4ee5\u628a\u8fd9\u4e94\u4e2a\u65b9\u6cd5\u5c01\u88c5\u8d77\u6765\uff0c\u4e8e\u662f<code>rest framework</code>\u5c31\u6709\u4e86\u4ee5\u4e0b\u7684\u4e94\u4e2a\u89c6\u56fe\u6269\u5c55\u7c7b\u3002</p>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#genericapiview5","title":"\u4e09\u3001\u57fa\u4e8eGenericAPIView\u548c5\u4e2a\u89c6\u56fe\u6269\u5c55\u7c7b\u5199\u63a5\u53e3","text":"<pre><code># views.py\nfrom app.models import Book\nfrom app.serializers import BookSerializer\nfrom rest_framework.generics import GenericAPIView\n\nfrom rest_framework.mixins import ListModelMixin, CreateModelMixin, UpdateModelMixin, DestroyModelMixin, \\\n    RetrieveModelMixin\n\n\nclass BookView(GenericAPIView, RetrieveModelMixin, DestroyModelMixin, UpdateModelMixin):\n    queryset = Book.objects\n    serializer_class = BookSerializer\n\n    def get(self, request, pk):\n        return self.retrieve(request, pk)\n\n    def put(self, request, pk):\n        return self.update(request, pk)\n\n    def delete(self, request, pk):\n        return self.destroy((request, pk))\n\n\nclass BooksView(GenericAPIView, ListModelMixin, CreateModelMixin):\n    queryset = Book.objects\n    serializer_class = BookSerializer\n\n    def get(self, request):\n        return self.list(request)\n\n    def post(self, request):\n        return self.create(request)\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#genericapiview9","title":"\u56db\u3001<code>GenericAPIView</code>\u76849\u4e2a\u89c6\u56fe\u5b50\u7c7b","text":"<pre><code># D:\\APP\\python36\\Lib\\site-packages\\rest_framework\\generics.py\n\n# \u57fa\u7840\u7684\u4e94\u4e2a\u5b50\u7c7b\nclass CreateAPIView(mixins.CreateModelMixin, \n                    GenericAPIView):\n    ...\n\nclass ListAPIView(mixins.ListModelMixin, \n                  GenericAPIView):\n    ...\n\n\nclass DestroyAPIView(mixins.DestroyModelMixin,\n                     GenericAPIView):\n    ...\n\n\nclass UpdateAPIView(mixins.UpdateModelMixin,\n                    GenericAPIView):\n    ...    \n\n\nclass RetrieveAPIView(mixins.RetrieveModelMixin, \n                      GenericAPIView):\n    ...\n\n\n# \u7ec4\u5408\u5230\u4e00\u8d77\u7684    \n# get\u548cpost\u7ec4\u5408\u4e3a\u4e00\u4e2a\nclass ListCreateAPIView(mixins.ListModelMixin, \n                        mixins.CreateModelMixin, \n                        GenericAPIView):\n    ...\n\n\n # get\u548cdelete\u7ec4\u5408\u4e3a\u4e00\u4e2a   \nclass RetrieveDestroyAPIView(mixins.RetrieveModelMixin, \n                             mixins.DestroyModelMixin, \n                             GenericAPIView):\n    ...\n\n # get\u548cput\u7ec4\u5408\u4e3a\u4e00\u4e2a  \nclass RetrieveUpdateAPIView(mixins.RetrieveModelMixin, \n                            mixins.UpdateModelMixin, \n                            GenericAPIView):   \n    ...\n # get\u3001put\u548cdelete\u7ec4\u5408\u4e3a\u4e00\u4e2a   \nclass RetrieveUpdateDestroyAPIView(mixins.RetrieveModelMixin,\n                                   mixins.UpdateModelMixin,\n                                   mixins.DestroyModelMixin,\n                                   GenericAPIView):\n    ...\n</code></pre> <p>\u4f7f\u7528\u89c6\u56fe\u5b50\u7c7b\u4ee5\u540e\u7684<code>views.py</code></p> <pre><code># views.py\nfrom app.models import Book\nfrom app.serializers import BookSerializer\nfrom rest_framework.generics import GenericAPIView, ListAPIView, CreateAPIView, UpdateAPIView, DestroyAPIView, \\\n    RetrieveAPIView\n\n\nclass BookView(UpdateAPIView, DestroyAPIView, RetrieveAPIView):\n    queryset = Book.objects\n    serializer_class = BookSerializer\n\n\nclass BooksView(ListAPIView, CreateAPIView):\n    queryset = Book.objects\n    serializer_class = BookSerializer\n</code></pre> <p>\u6e90\u7801\u9605\u8bfb</p> <pre><code>class GenericAPIView(views.APIView):\n    ...\n    def get_object(self):\n        queryset = self.filter_queryset(self.get_queryset())  # \u8fd4\u56de\u6240\u6709\u6570\u636equeryset\u5bf9\u8c61\n\n        # Perform the lookup filtering.\n        lookup_url_kwarg = self.lookup_url_kwarg or self.lookup_field  #  lookup_field = 'pk'  \u8def\u7531\u6709\u540d\u5206\u7ec4\u4e2d\u7684pk\n\n        assert lookup_url_kwarg in self.kwargs, (\n            'Expected view %s to be called with a URL keyword argument '\n            'named \"%s\". Fix your URL conf, or set the `.lookup_field` '\n            'attribute on the view correctly.' %\n            (self.__class__.__name__, lookup_url_kwarg)\n        )\n\n        filter_kwargs = {self.lookup_field: self.kwargs[lookup_url_kwarg]}\n        obj = get_object_or_404(queryset, **filter_kwargs)\n\n        # May raise a permission denied\n        self.check_object_permissions(self.request, obj)\n\n        return obj\n</code></pre> <p>\u4e0a\u8bc9\u7684\u4e24\u7ec4\u63a5\u53e3\uff0c\u53ef\u4ee5\u4f7f\u7528<code>ModelViewSet</code>\u6574\u5408\u4e3a\u4e00\u4e2a\u3002</p>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#modelviewset","title":"\u4e94\u3001<code>ModelViewSet</code>","text":""},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#1-modelviewset5","title":"1. \u4f7f\u7528<code>ModelViewSet</code>\u7f16\u51995\u4e2a\u63a5\u53e3","text":"<pre><code>from app.models import Book\nfrom app.serializers import BookSerializer\nfrom rest_framework.viewsets import ModelViewSet\n\n\nclass BooksView(ModelViewSet):  # 5\u4e2a\u63a5\u53e3\u90fd\u6709\uff0c\u4f46\u662f\u8def\u7531\u9700\u8981\u7279\u6b8a\u914d\u7f6e\n    queryset = Book.objects\n    serializer_class = BookSerializer\n</code></pre> <p>\u8def\u7531\u4e2d\u7684<code>as_view()</code>\u9700\u8981\u4f20\u5165\u53c2\u6570</p> <pre><code>from django.conf.urls import url\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    url(r'^admin/', admin.site.urls),\n    url(r'^books/(?P&lt;pk&gt;\\d)', views.BooksView.as_view(actions={'get': 'retrieve', 'put': 'update', 'delete': 'destroy'})),\n    # \u5f53\u8def\u5f84\u5339\u914d\uff0c\u53c8\u662fget\u8bf7\u6c42\uff0c\u4f1a\u6267\u884cBooksView\u7684list\u65b9\u6cd5\n    url(r'^books/', views.BooksView.as_view(actions={'get': 'list', 'post': 'create'})),\n]\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#2-viewsetmixin","title":"2. <code>ViewSetMixin</code>\u6e90\u7801\u5206\u6790","text":"<pre><code>class ViewSetMixin:\n\n    # \u91cd\u5199\u4e86as_views\u65b9\u6cd5\n    @classonlymethod\n    def as_view(cls, actions=None, **initkwargs):\n        def view(request, *args, **kwargs):\n            self = cls(**initkwargs)\n            self.action_map = actions\n            #  \u6838\u5fc3\u4ee3\u7801\uff08\u6240\u4ee5\u8def\u7531\u4e2d\u53ea\u8981\u914d\u7f6e\u4e86\u5bf9\u5e94\u5173\u7cfb\uff0c\u6bd4\u5982{'get':'list'}\uff09,\u5f53get\u8bf7\u6c42\u6765\uff0c\u5c31\u4f1a\u6267\u884clist\u65b9\u6cd5\n            for method, action in actions.items():\n                # get  list\n                handler = getattr(self, action)\n                # \u6267\u884c\u5b8c\u4e0a\u4e00\u53e5\uff0chandler\u5c31\u53d8\u6210\u4e86list\u7684\u5185\u5b58\u5730\u5740\n                setattr(self, method, handler)\n                # \u6267\u884c\u5b8c\u4e0a\u4e00\u53e5  \u5bf9\u8c61.get=list\n            ...\n</code></pre> <pre><code># \u91cd\u5199\u4e86as_view\n# \u6838\u5fc3\u4ee3\u7801\uff08\u6240\u4ee5\u8def\u7531\u4e2d\u53ea\u8981\u914d\u7f6e\u4e86\u5bf9\u5e94\u5173\u7cfb\uff0c\u6bd4\u5982{'get':'list'}\uff09,\u5f53get\u8bf7\u6c42\u6765\uff0c\u5c31\u4f1a\u6267\u884clist\u65b9\u6cd5\nfor method, action in actions.items():\n    #method\uff1aget\n    # action\uff1alist\n    handler = getattr(self, action)\n    #\u6267\u884c\u5b8c\u4e0a\u4e00\u53e5\uff0chandler\u5c31\u53d8\u6210\u4e86list\u7684\u5185\u5b58\u5730\u5740\n    setattr(self, method, handler)\n    #\u6267\u884c\u5b8c\u4e0a\u4e00\u53e5  \u5bf9\u8c61.get=list\n    #for\u5faa\u73af\u6267\u884c\u5b8c\u6bd5 \u5bf9\u8c61.get:\u5bf9\u7740list   \u5bf9\u8c61.post\uff1a\u5bf9\u7740create\n</code></pre>"},{"location":"programming/python/DRF/%E8%A7%86%E5%9B%BE/#3-viewsetmixin","title":"3 \u7ee7\u627f<code>ViewSetMixin</code>\u7684\u89c6\u56fe\u7c7b","text":"<pre><code># views.py\nfrom rest_framework.viewsets import ViewSetMixin\nclass BooksView(ViewSetMixin, APIView): #\u4e00\u5b9a\u8981\u653e\u5728APIVIew\u524d\n    def get_all_book(self,request):\n        print(\"xxxx\")\n        book_list = Book.objects.all()\n        book_ser = BookSerializer(book_list, many=True)\n        return Response(book_ser.data)\n</code></pre> <p>\u8def\u7531</p> <pre><code># urls.py\n    #\u7ee7\u627fViewSetMixin\u7684\u89c6\u56fe\u7c7b\uff0c\u8def\u7531\u53ef\u4ee5\u6539\u5199\u6210\u8fd9\u6837\n    url('books/', views.BooksView.as_view(actions={'get': 'get_all_book'})),\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/","title":"\u8ba4\u8bc1\u3001\u6743\u9650\u548c\u8bbf\u95ee\u63a7\u5236","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#_2","title":"\u4e00\u3001\u8ba4\u8bc1","text":"<p>\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <ol> <li>\u5199\u4e00\u4e2a\u7c7b\uff0c\u7ee7\u627f<code>BaseAuthentication</code>\uff0c\u91cd\u5199<code>authenticate()</code>\uff0c\u5728\u8fd9\u4e2a\u65b9\u6cd5\u91cc\u5199\u8ba4\u8bc1\u7684\u903b\u8f91\u3002</li> <li>\u8ba4\u8bc1\u901a\u8fc7\uff0c\u8fd4\u56de\u4e24\u4e2a\u503c\uff0c\u4e00\u4e2a\u503c\u6700\u7ec8\u7ed9\u4e86Requet\u5bf9\u8c61\u7684user\uff0c</li> <li> <p>\u8ba4\u8bc1\u5931\u8d25\uff0c\u629b\u5f02\u5e38\uff1a<code>APIException</code>\u6216\u8005<code>AuthenticationFailed</code></p> </li> <li> <p>\u4f7f\u7528</p> </li> <li>\u5168\u5c40\u4f7f\u7528</li> <li>\u5c40\u90e8\u4f7f\u7528</li> <li>\u8ba4\u8bc1\u53ef\u4ee5\u6709\u591a\u4e2a\uff0c\u4ece\u5de6\u5230\u53f3\u4f9d\u6b21\u6267\u884c</li> </ol>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1","title":"1. \u51c6\u5907","text":"<p>\u51c6\u5907\u7528\u6237\u6570\u636e</p> <pre><code># models.py\nfrom django.db import models\n\n\n# Create your models here.\n\n\nclass Book(models.Model):\n    title = models.CharField(max_length=32, verbose_name=\"\u4e66\u540d\")\n    price = models.DecimalField(max_digits=8, decimal_places=2, verbose_name=\"\u4ef7\u683c\")\n\n\nclass User(models.Model):\n    username = models.CharField(max_length=32)\n    password = models.CharField(max_length=32)\n    user_type = models.IntegerField(choices=((0, '\u8d85\u7ea7\u7528\u6237'), (1, '\u666e\u901a\u7528\u6237')))\n\n\nclass UserToken(models.Model):\n    token = models.CharField(max_length=64)\n    user = models.OneToOneField(to='User')\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#2","title":"2. \u81ea\u5b9a\u4e49\u8ba4\u8bc1\u7c7b","text":"<pre><code># auth.py\nfrom rest_framework.authentication import BaseAuthentication\nfrom rest_framework.exceptions import AuthenticationFailed\nfrom app.models import UserToken\n\n\nclass MyAuthentication(BaseAuthentication):\n    def authenticate(self, request):\n        # \u8ba4\u8bc1\u903b\u8f91\uff0c\u5982\u679c\u8ba4\u8bc1\u901a\u8fc7\uff0c\u8fd4\u56de\u4e24\u4e2a\u503c\n        # \u5982\u679c\u8ba4\u8bc1\u5931\u8d25\uff0c\u629b\u51faAuthenticationFailed\u5f02\u5e38\n        token = request.GET.get('token')\n        if token:\n            user_token = UserToken.objects.filter(token=token).first()\n            # \u8ba4\u8bc1\u901a\u8fc7\n            if user_token:\n                return user_token.user, token\n            else:\n                raise AuthenticationFailed('\u8ba4\u8bc1\u5931\u8d25')\n        else:\n            raise AuthenticationFailed('\u8bf7\u6c42\u5730\u5740\u4e2d\u9700\u8981\u643a\u5e26token')\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#3","title":"3. \u4f7f\u7528","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#31","title":"3.1 \u5c40\u90e8\u4f7f\u7528","text":"<p>\u5728\u89c6\u56fe\u7c7b\u4e2d\uff0c\u7ed9\u9700\u8981\u8ba4\u8bc1\u7684\u89c6\u56fe\u52a0\u4e0a<code>authentication_classes = [MyAuthentication]</code></p> <pre><code>from app import models\nfrom app.serializers import BookSerializer\nfrom rest_framework.viewsets import ModelViewSet\nfrom rest_framework.views import APIView\nfrom rest_framework.response import Response\nimport uuid\n\nfrom app.auth import MyAuthentication\n\n\nclass BooksView(ModelViewSet):\n    authentication_classes = [MyAuthentication]\n    queryset = models.Book.objects\n    serializer_class = BookSerializer\n\n\nclass TestView(APIView):\n    authentication_classes = [MyAuthentication]\n    def get(self, request):\n        return Response({'username': request.user.username})\n\n\nclass LoginView(APIView):\n\n    def post(self, request):\n        username = request.data.get('username')\n        password = request.data.get('password')\n        user = models.User.objects.filter(username=username, password=password).first()\n        if user:\n            # \u767b\u9646\u6210\u529f,\u751f\u6210\u4e00\u4e2a\u968f\u673a\u5b57\u7b26\u4e32\n            token = uuid.uuid4()\n            # \u5b58\u5230UserToken\u8868\u4e2d\n            # update_or_create\u6709\u5c31\u66f4\u65b0\uff0c\u6ca1\u6709\u5c31\u65b0\u589e\n            models.UserToken.objects.update_or_create(defaults={'token': token}, user=user)\n            return Response({'status': 100, 'msg': '\u767b\u9646\u6210\u529f', 'token': token})\n        else:\n            return Response({'status': 101, 'msg': '\u7528\u6237\u540d\u6216\u5bc6\u7801\u9519\u8bef'})\n</code></pre> <p></p>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#32","title":"3.2 \u5168\u5c40\u4f7f\u7528","text":"<pre><code>REST_FRAMEWORK = {\n    \"DEFAULT_AUTHENTICATION_CLASSES\": [\"app.auth.MyAuthentication\", ]\n}\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#33","title":"3.3 \u5c40\u90e8\u7981\u7528","text":"<p>\u5728\u89c6\u56fe\u7c7b\u4e2d\u52a0\u4e0a<code>authentication_classes=[]</code></p> <pre><code>class LoginView(APIView):\n    authentication_classes=[]\n    ...\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#4","title":"4. \u6e90\u7801\u5206\u6790","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#_3","title":"\u4e8c\u3001\u6743\u9650","text":"<p>\u4f7f\u7528\u65b9\u6cd5\uff1a</p> <ol> <li>\u5199\u4e00\u4e2a\u7c7b\uff0c\u7ee7\u627f<code>BasePermission</code>\uff0c\u91cd\u5199<code>has_permission</code></li> <li>\u5982\u679c\u6743\u9650\u901a\u8fc7\uff0c\u5c31\u8fd4\u56deTrue\uff0c\u4e0d\u901a\u8fc7\u5c31\u8fd4\u56deFalse</li> </ol>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1_1","title":"1. \u81ea\u5b9a\u4e49\u6743\u9650","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1_2","title":"1. \u5199\u4e00\u4e2a\u6743\u9650\u7684\u7c7b","text":"<pre><code># auth.py\nfrom rest_framework.permissions import BasePermission\n\n\nclass UserPermission(BasePermission):\n    def has_permission(self, request, view):\n        # \u4e0d\u662f\u8d85\u7ea7\u7528\u6237\uff0c\u4e0d\u80fd\u8bbf\u95ee\n        # \u7531\u4e8e\u8ba4\u8bc1\u5df2\u7ecf\u8fc7\u4e86\uff0crequest\u5185\u5c31\u6709user\u5bf9\u8c61\u4e86\uff0c\u5f53\u524d\u767b\u5f55\u7528\u6237\n        user = request.user  # \u5f53\u524d\u767b\u5f55\u7528\u6237\n        if user.user_type == 0:\n            return True\n        else:\n            return False\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#2_1","title":"2. \u4f7f\u7528","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1_3","title":"1. \u5c40\u90e8\u4f7f\u7528","text":"<p>\u5728\u89c6\u56fe\u6587\u4ef6\u4e2d\u5bfc\u5165\u81ea\u5b9a\u4e49\u7684\u8ba4\u8bc1\u7c7b\uff0c\u5728\u89c6\u56fe\u7c7b\u4e2d\u52a0\u4e0a<code>permission_classes = [\u81ea\u5b9a\u4e49\u8ba4\u8bc1\u7c7b\u540d]</code></p> <pre><code># view.py\nfrom app.auth import MyAuthentication, UserPermission\n\n\nclass BooksView(ModelViewSet):\n    authentication_classes = [MyAuthentication]\n    permission_classes = [UserPermission]\n    queryset = models.Book.objects\n    serializer_class = BookSerializer\n\nclass LoginView(APIView):\n    ...\n\nclass TestView(APIView):\n    ...\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#2_2","title":"2. \u5168\u5c40\u4f7f\u7528","text":"<pre><code># settings.py\nREST_FRAMEWORK = {\n    \"DEFAULT_AUTHENTICATION_CLASSES\": [\"app.auth.MyAuthentication\", ],\n    'DEFAULT_PERMISSION_CLASSES': [  # \u52a0\u4e0a\u81ea\u5b9a\u4e49\u7684\u8ba4\u8bc1\u7c7b\n        'app.auth.UserPermission',\n    ],\n}\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#3_1","title":"3. \u5c40\u90e8\u7981\u7528","text":"<pre><code>permission_classes = []\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#2_3","title":"2. \u5185\u7f6e\u6743\u9650","text":"<p>\u4f7f\u7528\u524d\u63d0\uff1a\u7528\u4e86Django\u81ea\u5e26\u7684<code>auth</code>\u6a21\u5757</p>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1_4","title":"1. \u4f7f\u7528\u6d41\u7a0b","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1_5","title":"1. \u521b\u5efa\u4e00\u4e2a\u8d85\u7ea7\u7ba1\u7406\u5458\u7528\u6237","text":"<pre><code>python manage.py createsuperuser\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#2_4","title":"2. \u5199\u89c6\u56fe\u7c7b","text":"<p>\u89c6\u56fe\u6587\u4ef6\u4e2d\u5bfc\u5165\u81ea\u5e26\u7684\u8ba4\u8bc1\u7c7b\u548c\u6743\u9650\u7c7b\uff0c\u5e76\u5728\u89c6\u56fe\u4e2d\u4f7f\u7528</p> <pre><code># views.py\nfrom rest_framework.authentication import SessionAuthentication\nfrom rest_framework.permissions import IsAdminUser\n\n\nclass SalaryView(APIView):\n    authentication_classes = [SessionAuthentication, ]\n    permission_classes = [IsAdminUser, ]  # \u6e90\u7801\uff1abool(request.user and request.user.is_staff)\n\n    def get(self, request, *args, **kwargs):\n        return Response('\u7ba1\u7406\u5458\u767b\u5f55\uff0c\u6709\u6743\u9650\u67e5\u770b')\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#3-adminsalaryview","title":"3. \u7ba1\u7406\u5458\u767b\u5f55\u5230admin\uff0c\u518d\u8bbf\u95eeSalaryView\u5c31\u6709\u6743\u9650\uff0c","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#4-is_staff0","title":"4. <code>is_staff</code>\u5b57\u6bb5\u503c\u4e3a0\u7684\u6ca1\u6709\u6743\u9650\u8bbf\u95ee","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#_4","title":"\u4e09\u3001\u8bbf\u95ee\u9891\u7387","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#1_6","title":"1. \u672a\u767b\u5f55\u7528\u6237\u9650\u5236","text":""},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#11","title":"1.1 \u5168\u5c40\u9650\u5236","text":"<pre><code># settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_THROTTLE_CLASSES': (\n        'rest_framework.throttling.AnonRateThrottle',\n    ),\n    'DEFAULT_THROTTLE_RATES': {\n        'anon': '3/m',\n    }\n}\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#12","title":"1.2 \u5c40\u90e8\u9650\u5236","text":"<pre><code>REST_FRAMEWORK = {\n    'DEFAULT_THROTTLE_RATES': {\n        'anon': '3/m',\n    }\n}\n</code></pre> <pre><code># views.py\nclass TestView(APIView):\n    authentication_classes=[]\n    permission_classes = []\n    throttle_classes = [AnonRateThrottle]   # \u5c40\u90e8\u4f7f\u7528\n    def get(self,request,*args,**kwargs):\n        return Response('OK')\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#2_5","title":"2. \u767b\u5f55\u7528\u6237\u9650\u5236","text":"<p>\u4f7f\u7528\u524d\u63d0\uff1a\u4f7f\u7528Django\u7684admin</p>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#21","title":"2.1 \u5168\u5c40\u9650\u5236","text":"<pre><code># settings.py\n  'DEFAULT_THROTTLE_CLASSES': (\n        'rest_framework.throttling.UserRateThrottle'\n    ),\n    'DEFAULT_THROTTLE_RATES': {\n        'user': '10/m',\n    }\n</code></pre>"},{"location":"programming/python/DRF/%E8%AE%A4%E8%AF%81%E3%80%81%E6%9D%83%E9%99%90%E5%92%8C%E9%A2%91%E7%8E%87/#22","title":"2.2 \u5c40\u90e8\u9650\u5236","text":"<pre><code># views.py\nclass TestView(APIView):\n    authentication_classes=[]\n    permission_classes = []\n    throttle_classes = [UserRateThrottle]   # \u5c40\u90e8\u4f7f\u7528\n    def get(self,request,*args,**kwargs):\n        return Response('OK')\n</code></pre>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/","title":"\u8bf7\u6c42\u548c\u54cd\u5e94","text":""},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#1-request","title":"1. Request","text":"<p>REST framework \u4f20\u5165\u89c6\u56fe\u7684request\u5bf9\u8c61\u4e0d\u518d\u662fDjango\u9ed8\u8ba4\u7684HttpRequest\u5bf9\u8c61\uff0c\u800c\u662fREST framework\u63d0\u4f9b\u7684\u6269\u5c55\u4e86HttpRequest\u7c7b\u7684Request\u7c7b\u7684\u5bf9\u8c61\u3002</p> <p>REST framework \u63d0\u4f9b\u4e86Parser\u89e3\u6790\u5668\uff0c\u5728\u63a5\u6536\u5230\u8bf7\u6c42\u540e\u4f1a\u81ea\u52a8\u6839\u636eContent-Type\u6307\u660e\u7684\u8bf7\u6c42\u6570\u636e\u7c7b\u578b\uff08\u5982JSON\u3001\u8868\u5355\u7b49\uff09\u5c06\u8bf7\u6c42\u6570\u636e\u8fdb\u884cparse\u89e3\u6790\uff0c\u89e3\u6790\u4e3a\u7c7b\u5b57\u5178[QueryDict]\u5bf9\u8c61\u4fdd\u5b58\u5230Request\u5bf9\u8c61\u4e2d\u3002</p> <p>Request\u5bf9\u8c61\u7684\u6570\u636e\u662f\u81ea\u52a8\u6839\u636e\u524d\u7aef\u53d1\u9001\u6570\u636e\u7684\u683c\u5f0f\u8fdb\u884c\u89e3\u6790\u4e4b\u540e\u7684\u7ed3\u679c\u3002</p> <p>\u65e0\u8bba\u524d\u7aef\u53d1\u9001\u7684\u54ea\u79cd\u683c\u5f0f\u7684\u6570\u636e\uff0c\u6211\u4eec\u90fd\u53ef\u4ee5\u4ee5\u7edf\u4e00\u7684\u65b9\u5f0f\u8bfb\u53d6\u6570\u636e\u3002</p>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#11","title":"1.1 \u5e38\u7528\u5c5e\u6027","text":""},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#1data","title":"1.<code>data</code>","text":"<p><code>request.data</code> \u8fd4\u56de\u89e3\u6790\u4e4b\u540e\u7684\u8bf7\u6c42\u4f53\u6570\u636e\u3002\u7c7b\u4f3c\u4e8eDjango\u4e2d\u6807\u51c6\u7684<code>request.POST</code>\u548c <code>request.FILES</code>\u5c5e\u6027\uff0c\u4f46\u63d0\u4f9b\u5982\u4e0b\u7279\u6027\uff1a</p> <ul> <li>\u5305\u542b\u4e86\u89e3\u6790\u4e4b\u540e\u7684\u6587\u4ef6\u548c\u975e\u6587\u4ef6\u6570\u636e</li> <li>\u5305\u542b\u4e86\u5bf9POST\u3001PUT\u3001PATCH\u8bf7\u6c42\u65b9\u5f0f\u89e3\u6790\u540e\u7684\u6570\u636e</li> <li>\u5229\u7528\u4e86REST framework\u7684parsers\u89e3\u6790\u5668\uff0c\u4e0d\u4ec5\u652f\u6301\u8868\u5355\u7c7b\u578b\u6570\u636e\uff0c\u4e5f\u652f\u6301JSON\u6570\u636e</li> </ul>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#2-query_params","title":"2. <code>query_params</code>","text":"<p><code>request.query_params</code>\u4e0eDjango\u6807\u51c6\u7684<code>request.GET</code>\u76f8\u540c\uff0c\u53ea\u662f\u66f4\u6362\u4e86\u66f4\u6b63\u786e\u7684\u540d\u79f0\u800c\u5df2\u3002</p>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#2-response","title":"2. Response","text":"<p>REST framework\u63d0\u4f9b\u4e86\u4e00\u4e2a\u54cd\u5e94\u7c7b<code>Response</code>\uff0c\u4f7f\u7528\u8be5\u7c7b\u6784\u9020\u54cd\u5e94\u5bf9\u8c61\u65f6\uff0c\u54cd\u5e94\u7684\u5177\u4f53\u6570\u636e\u5185\u5bb9\u4f1a\u88ab\u8f6c\u6362\uff08render\u6e32\u67d3\uff09\u6210\u7b26\u5408\u524d\u7aef\u9700\u6c42\u7684\u7c7b\u578b\u3002</p> <p>REST framework\u63d0\u4f9b\u4e86<code>Renderer</code> \u6e32\u67d3\u5668\uff0c\u7528\u6765\u6839\u636e\u8bf7\u6c42\u5934\u4e2d\u7684<code>Accept</code>\uff08\u63a5\u6536\u6570\u636e\u7c7b\u578b\u58f0\u660e\uff09\u6765\u81ea\u52a8\u8f6c\u6362\u54cd\u5e94\u6570\u636e\u5230\u5bf9\u5e94\u683c\u5f0f\u3002\u5982\u679c\u524d\u7aef\u8bf7\u6c42\u4e2d\u672a\u8fdb\u884cAccept\u58f0\u660e\uff0c\u5219\u4f1a\u91c7\u7528\u9ed8\u8ba4\u65b9\u5f0f\u5904\u7406\u54cd\u5e94\u6570\u636e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u914d\u7f6e\u6765\u4fee\u6539\u9ed8\u8ba4\u54cd\u5e94\u683c\u5f0f\u3002</p> <p>\u53ef\u4ee5\u5728rest_framework.settings\u67e5\u627e\u6240\u6709\u7684drf\u9ed8\u8ba4\u914d\u7f6e\u9879</p> <pre><code>REST_FRAMEWORK = {\n    'DEFAULT_RENDERER_CLASSES': (  # \u9ed8\u8ba4\u54cd\u5e94\u6e32\u67d3\u7c7b\n        'rest_framework.renderers.JSONRenderer',  # json\u6e32\u67d3\u5668\n        'rest_framework.renderers.BrowsableAPIRenderer',  # \u6d4f\u89c8API\u6e32\u67d3\u5668\n    )\n}\n</code></pre>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#21","title":"2.1 \u6784\u9020\u65b9\u5f0f","text":"<pre><code>Response(data, status=None, template_name=None, headers=None, content_type=None)\n</code></pre> <p><code>data</code>\u6570\u636e\u662frender\u5904\u7406\u4e4b\u540e\u7684\u6570\u636e\uff0c\u53ea\u9700\u4f20\u9012python\u7684\u5185\u5efa\u7c7b\u578b\u6570\u636e\u5373\u53ef\uff0cREST framework\u4f1a\u4f7f\u7528<code>renderer</code>\u6e32\u67d3\u5668\u5904\u7406<code>data</code>\u3002</p> <p><code>data</code>\u4e0d\u80fd\u662f\u590d\u6742\u7ed3\u6784\u7684\u6570\u636e\uff0c\u5982Django\u7684\u6a21\u578b\u7c7b\u5bf9\u8c61\uff0c\u5bf9\u4e8e\u8fd9\u6837\u7684\u6570\u636e\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528<code>Serializer</code>\u5e8f\u5217\u5316\u5668\u5e8f\u5217\u5316\u5904\u7406\u540e\uff08\u8f6c\u4e3a\u4e86Python\u5b57\u5178\u7c7b\u578b\uff09\u518d\u4f20\u9012\u7ed9<code>data</code>\u53c2\u6570\u3002</p> <p>\u53c2\u6570\u8bf4\u660e\uff1a</p> <ul> <li><code>data</code>: \u4e3a\u54cd\u5e94\u51c6\u5907\u7684\u5e8f\u5217\u5316\u5904\u7406\u540e\u7684\u6570\u636e\uff1b</li> <li><code>status</code>: \u72b6\u6001\u7801\uff0c\u9ed8\u8ba4200\uff1b</li> <li><code>template_name</code>: \u6a21\u677f\u540d\u79f0\uff0c\u5982\u679c\u4f7f\u7528<code>HTMLRenderer</code> \u65f6\u9700\u6307\u660e\uff1b</li> <li><code>headers</code>: \u7528\u4e8e\u5b58\u653e\u54cd\u5e94\u5934\u4fe1\u606f\u7684\u5b57\u5178\uff1b</li> <li><code>content_type</code>: \u54cd\u5e94\u6570\u636e\u7684Content-Type\uff0c\u901a\u5e38\u6b64\u53c2\u6570\u65e0\u9700\u4f20\u9012\uff0cREST framework\u4f1a\u6839\u636e\u524d\u7aef\u6240\u9700\u7c7b\u578b\u6570\u636e\u6765\u8bbe\u7f6e\u8be5\u53c2\u6570\u3002</li> </ul>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#22","title":"2.2 \u5e38\u7528\u5c5e\u6027","text":""},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#1-data","title":"1. data","text":"<p>\u4f20\u7ed9response\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u540e\uff0c\u4f46\u5c1a\u672arender\u5904\u7406\u7684\u6570\u636e</p>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#2-status_code","title":"2. status_code","text":"<p>\u72b6\u6001\u7801\u7684\u6570\u5b57</p>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#3-content","title":"3 .content","text":"<p>\u7ecf\u8fc7render\u5904\u7406\u540e\u7684\u54cd\u5e94\u6570\u636e</p>"},{"location":"programming/python/DRF/%E8%AF%B7%E6%B1%82%E5%92%8C%E5%93%8D%E5%BA%94/#23","title":"2.3 \u72b6\u6001\u7801","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u8bbe\u7f6e\u72b6\u6001\u7801\uff0cREST framewrok\u5728<code>rest_framework.status</code>\u6a21\u5757\u4e2d\u63d0\u4f9b\u4e86\u5e38\u7528\u72b6\u6001\u7801\u5e38\u91cf\u3002 </p>"},{"location":"programming/python/DRF/%E8%B7%AF%E7%94%B1/","title":"\u8def\u7531","text":""},{"location":"programming/python/DRF/%E8%B7%AF%E7%94%B1/#_2","title":"\u4e00\u3001\u81ea\u52a8\u751f\u6210\u8def\u7531","text":""},{"location":"programming/python/DRF/%E8%B7%AF%E7%94%B1/#1","title":"1. \u4f7f\u7528\u6b65\u9aa4","text":"<ol> <li>\u5728<code>view.py</code>\u4e2d\u5bfc\u5165<code>routers</code>\u6a21\u5757\uff0c\u8be5\u6a21\u5757\u4e2d\u6709\u4e24\u4e2a\u7c7b<code>DefaultRouter</code>\u548c<code>SimpleRouter</code></li> <li>\u5b9e\u4f8b\u5316\u5176\u4e2d\u4e00\u4e2a\u5f97\u5230\u4e00\u4e2a\u5bf9\u8c61</li> <li>\u6ce8\u518c\u89c6\u56fe</li> <li>\u5c06\u81ea\u52a8\u751f\u6210\u7684\u8def\u7531\uff0c\u52a0\u5165\u5230\u539f\u8def\u7531\u4e2d</li> </ol> <pre><code># urls.py\nfrom django.conf.urls import url\nfrom django.contrib import admin\nfrom app import views\n\nfrom rest_framework import routers\n\nrouter = routers.DefaultRouter()\n\n# router.register('\u524d\u7f00','\u7ee7\u627f\u81eaModelViewSet\u89c6\u56fe\u7c7b','\u522b\u540d')\nrouter.register('books', views.BooksView)\n\nurlpatterns = [\n    url(r'^admin/', admin.site.urls),\n]\n\nurlpatterns += router.urls\nprint(router.urls)\n</code></pre>"},{"location":"programming/python/DRF/%E8%B7%AF%E7%94%B1/#2-simplerouterdefaultrouter","title":"2. <code>SimpleRouter</code>\u548c<code>DefaultRouter</code>\u7684\u533a\u522b","text":"<pre><code># SimpleRouter\n[\n    &lt;RegexURLPattern book-list ^books/$&gt;\uff0c\n    &lt;RegexURLPattern book-detail ^books/(?P&lt;pk&gt;[^/.]+)/$&gt;\n]\n# DefaultRouter\n[\n    &lt;RegexURLPattern book-list ^books/$&gt;, \n    &lt;RegexURLPattern book-detail ^books/(?P&lt;pk&gt;[^/.]+)/$&gt;,\n    # \u6bd4SimpleRouter\u591a\u4e86\u56db\u4e2a\n    &lt;RegexURLPattern book-list ^books\\.(?P&lt;format&gt;[a-z0-9]+)/?$&gt;, \n    &lt;RegexURLPattern book-detail ^books/(?P&lt;pk&gt;[^/.]+)\\.(?P&lt;format&gt;[a-z0-9]+)/?$&gt;,\n    &lt;RegexURLPattern api-root ^$&gt;,   \n    &lt;RegexURLPattern api-root ^\\.(?P&lt;format&gt;[a-z0-9]+)/?$&gt;\n]\n</code></pre>"},{"location":"programming/python/DRF/%E8%B7%AF%E7%94%B1/#action","title":"\u4e8c\u3001<code>action</code>\u7684\u7528\u6cd5","text":"<p>\u4e3a\u4e86\u7ed9\u7ee7\u627f\u81ea<code>ModelViewSet</code>\u7684\u89c6\u56fe\u7c7b\u4e2d\u5b9a\u4e49\u7684\u51fd\u6570\u4e5f\u6dfb\u52a0\u8def\u7531\u3002</p> <p><code>action</code>\u662f\u4e2a\u88c5\u9970\u5668\uff0c\u653e\u5728\u88ab\u88c5\u9970\u7684\u51fd\u6570\u4e0a\u65b9\uff0c\u6709\u4e24\u4e2a\u53c2\u6570</p> <pre><code>1.  method\uff1a\u8bf7\u6c42\u65b9\u5f0f\n2.  detail\uff1a\u5e03\u5c14\u503c\uff0c\u662f\u5426\u5e26pk\n</code></pre> <pre><code>from rest_framework.decorators import action\n\nclass BooksView(ModelViewSet):\n    queryset =Book.objects.all()\n    serializer_class = BookSerializer\n\n    # methods\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4f20\u4e00\u4e2a\u5217\u8868\uff0c\u5217\u8868\u4e2d\u653e\u8bf7\u6c42\u65b9\u5f0f\uff0c\n    # ^books/get_1/$ [name='book-get-1'] \u5f53\u5411\u8fd9\u4e2a\u5730\u5740\u53d1\u9001get\u8bf7\u6c42\uff0c\u4f1a\u6267\u884c\u4e0b\u9762\u7684\u51fd\u6570\n    # detail\uff1a\u5e03\u5c14\u7c7b\u578b \u5982\u679c\u662fTrue\uff0c\u751f\u6210\u5e26pk\u7684\u5730\u5740\uff0c\u5426\u5219\u751f\u6210\u4e0d\u5e26pk\u7684\u5730\u5740\n    #\u751f\u6210\u8def\u7531\uff1a ^books/(?P&lt;pk&gt;[^/.]+)/get_1/$ [name='book-get-1']\n    @action(methods=['GET','POST'],detail=True)\n    def get_1(self,request,pk):\n        print(pk)\n        book=self.get_queryset()[:2]  # \u4ece0\u5f00\u59cb\u622a\u53d6\u4e00\u6761\n        ser=self.get_serializer(book,many=True)\n        return Response(ser.data)\n</code></pre>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/","title":"\u8fc7\u6ee4\u3001\u6392\u5e8f\u548c\u5f02\u5e38\u5904\u7406","text":""},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_2","title":"\u4e00\u3001\u8fc7\u6ee4","text":""},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#1","title":"1. \u57fa\u672c\u4f7f\u7528","text":""},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#11","title":"1.1 \u5b89\u88c5","text":"<pre><code>pip3 install django-filter\n</code></pre>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#12","title":"1.2 \u6ce8\u518c","text":"<pre><code># settings.py\nINSTALLED_APPS = [\n    ...\n    'django_filters'\n]\n</code></pre>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#13","title":"1.3 \u5168\u5c40\u914d\u7f6e","text":"<pre><code># settings.py\nREST_FRAMEWORK = {\n    'DEFAULT_FILTER_BACKENDS': ('django_filters.rest_framework.DjangoFilterBackend',)\n}\n</code></pre>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#14","title":"1.4 \u89c6\u56fe\u7c7b\u4e2d\u6dfb\u52a0\u8fc7\u6ee4\u5b57\u6bb5","text":"<pre><code>class BooksView(ListAPIView):\n    queryset = models.Book.objects.all()\n    serializer_class = BookSerializer\n    filter_fields = ('price',)  # \u914d\u7f6e\u53ef\u4ee5\u6309\u7167\u54ea\u4e2a\u5b57\u6bb5\u6765\u8fc7\u6ee4\n</code></pre>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_3","title":"\u4e8c\u3001\u6392\u5e8f","text":""},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#1_1","title":"1. \u57fa\u672c\u4f7f\u7528","text":"<p>\u5c40\u90e8\u4f7f\u7528\uff1a</p> <pre><code>from rest_framework.filters import OrderingFilter\nclass BooksView(ListAPIView):\n    queryset = models.Book.objects.all()\n    serializer_class = BookSerializer\n    filter_backends = [OrderingFilter]\n    ordering_fields = ('id', 'price')\n</code></pre> <p>\u8bbf\u95ee\uff1a<code>http://127.0.0.1:8000/books/?ordering=price</code></p>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#_4","title":"\u4e09\u3001\u5f02\u5e38\u5904\u7406","text":""},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#1_2","title":"1. \u57fa\u672c\u4f7f\u7528","text":""},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#1_3","title":"1. \u914d\u7f6e","text":"<pre><code># settings.py\nREST_FRAMEWORK = {\n    'EXCEPTION_HANDLER': 'app.utils.my_exception_handler',\n}\n</code></pre>"},{"location":"programming/python/DRF/%E8%BF%87%E6%BB%A4%E3%80%81%E6%8E%92%E5%BA%8F%E3%80%81%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/#2","title":"2. \u5b9a\u4e49\u5f02\u5e38\u5904\u7406","text":"<pre><code>from rest_framework.views import exception_handler\nfrom rest_framework.response import Response\nfrom rest_framework import status\ndef my_exception_handler(exc, context):\n    response=exception_handler(exc, context)\n    # \u4e24\u79cd\u60c5\u51b5:\n    # 1. drf\u6ca1\u6709\u5904\u7406,\u8fd4\u56deNone\n    # 2. response\u5bf9\u8c61\uff0cdjango\u5904\u7406\u4e86\uff0c\u4f46\u662f\u5904\u7406\u7684\u4e0d\u7b26\u5408\u9879\u76ee\u7684\u8981\u6c42\n    if not response:\n        if isinstance(exc, ZeroDivisionError):\n            return Response(data={'status': 70003, 'msg': \"\u9664\u4ee50\u7684\u9519\u8bef\" + str(exc)}, status=status.HTTP_400_BAD_REQUEST)\n        return Response(data={'status':30002,'msg':str(exc)},status=status.HTTP_400_BAD_REQUEST)\n    else:\n        # return response\n        return Response(data={'status':40012,'msg':response.data.get('detail')},status=status.HTTP_400_BAD_REQUEST)\n</code></pre>"},{"location":"programming/python/Django/admin/","title":"Admin\u540e\u53f0\u7ba1\u7406","text":"<pre><code>class User(models.Model):\n    ...\n    class Meta:\n        verbose_name_plural = '\u7528\u6237\u8868'  # \u4fee\u6539admin\u540e\u53f0\u7ba1\u7406\u9ed8\u8ba4\u7684\u8868\u540d\n        # verbose_name = '\u7528\u6237\u8868'  # \u672b\u5c3e\u8fd8\u662f\u4f1a\u81ea\u52a8\u52a0s\n</code></pre> <p>\u5728admin.py\u4e2d\u6ce8\u518c</p> <pre><code>from django.contrib import admin\nfrom app import models\n# Register your models here.\n\nadmin.site.register(models.User)\n</code></pre> <p>admin\u4f1a\u7ed9\u6bcf\u4e00\u4e2a\u6ce8\u518c\u4e86\u7684\u6a21\u578b\u8868\u81ea\u52a8\u751f\u6210\u589e\u5220\u6539\u67e5\u56db\u6761url</p> <pre><code>http://127.0.0.1:8000/admin/app/user/ \u67e5\nhttp://127.0.0.1:8000/admin/app/user/add/ \u589e\nhttp://127.0.0.1:8000/admin/app/user/1/change/ \u6539\nhttp://127.0.0.1:8000/admin/app/user/1/delete/ \u5220\n</code></pre>"},{"location":"programming/python/Django/auth/","title":"auth\u6a21\u5757","text":"<p>\u8ddf\u7528\u6237\u76f8\u5173\u7684\u767b\u9646\u3001\u6ce8\u518c\u3001\u6821\u9a8c\u3001\u4fee\u6539\u5bc6\u7801\u3001\u6ce8\u9500\u3001\u9a8c\u8bc1\u7528\u6237\u662f\u5426\u767b\u9646</p> <p>\u521b\u5efa\u8d85\u7ea7\u7528\u6237(\u7ba1\u7406\u5458)</p> <pre><code>$ python3 manage.py createsuperuser\n</code></pre>"},{"location":"programming/python/Django/auth/#_1","title":"\u4e00\u3001\u5e38\u7528\u65b9\u6cd5","text":"<p><code>from django.contrib import auth</code></p>"},{"location":"programming/python/Django/auth/#1","title":"1. \u6bd4\u5bf9\u7528\u6237\u540d\u548c\u5bc6\u7801\u662f\u5426\u6b63\u786e","text":"<pre><code>user_obj = auth.authenticate(request,username=username,password=password)\n# \u62ec\u53f7\u5185\u5fc5\u987b\u540c\u65f6\u4f20\u5165\u7528\u6237\u540d\u548c\u5bc6\u7801\nprint(user_obj)  # \u7528\u6237\u5bf9\u8c61  admin   \u6570\u636e\u4e0d\u7b26\u5408\u5219\u8fd4\u56deNone\nprint(user_obj.username)  # admin\nprint(user_obj.password)  # \u5bc6\u6587\n</code></pre>"},{"location":"programming/python/Django/auth/#2","title":"2. \u4fdd\u5b58\u7528\u6237\u72b6\u6001","text":"<pre><code>auth.login(request,user_obj)  # \u7c7b\u4f3c\u4e8erequest.session[key] = user_obj\n# \u53ea\u8981\u6267\u884c\u4e86\u8be5\u65b9\u6cd5\uff0c\u5c31\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u901a\u8fc7request.user\u83b7\u53d6\u5230\u5f53\u524d\u767b\u9646\u7684\u7528\u6237\u5bf9\u8c61\n</code></pre>"},{"location":"programming/python/Django/auth/#3","title":"3. \u5224\u65ad\u5f53\u524d\u7528\u6237\u662f\u5426\u767b\u9646","text":"<pre><code>request.user.is_authenticated()\n</code></pre>"},{"location":"programming/python/Django/auth/#4","title":"4. \u83b7\u53d6\u5f53\u524d\u767b\u9646\u7528\u6237","text":"<pre><code>request.user\n</code></pre>"},{"location":"programming/python/Django/auth/#5","title":"5. \u6821\u9a8c\u7528\u6237\u662f\u5426\u767b\u9646\u88c5\u9970\u5668","text":""},{"location":"programming/python/Django/auth/#51","title":"5.1 \u5c40\u90e8\u914d\u7f6e","text":"<pre><code>from django.contrib.auth.decorators import login_required\n# \u5c40\u90e8\u914d\u7f6e:\u7528\u6237\u6ca1\u6709\u767b\u9646\u8df3\u8f6c\u5230login_user\u540e\u9762\u6307\u5b9a\u7684\u7f51\u5740\n@login_required(login_url='/login/')\ndef home(request):\n    return HttpResponse('home')\n</code></pre>"},{"location":"programming/python/Django/auth/#52","title":"5.2 \u5168\u5c40\u914d\u7f6e","text":"<p>\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u5168\u5c40\u767b\u5f55\u5730\u5740</p> <pre><code>LOGIN_URL = '/login/'\n</code></pre> <pre><code>from django.contrib.auth.decorators import login_required\n# \u5168\u5c40\u914d\u7f6e\n@login_required\ndef home(request):\n    return HttpResponse('home')\n</code></pre>"},{"location":"programming/python/Django/auth/#6","title":"6. \u5bf9\u6bd4\u539f\u5bc6\u7801","text":"<pre><code># \u6821\u9a8c\u8001\u5bc6\u7801\u5bf9\u4e0d\u5bf9\nis_right = request.user.check_password(old_password)  # \u81ea\u52a8\u52a0\u5bc6\u6bd4\u5bf9\u5bc6\u7801\n</code></pre>"},{"location":"programming/python/Django/auth/#7","title":"7. \u4fee\u6539\u5bc6\u7801","text":"<pre><code>request.user.set_password(new_password) # \u4ec5\u4ec5\u662f\u5728\u4fee\u6539\u5bf9\u8c61\u7684\u5c5e\u6027\nrequest.user.save() # \u8fd9\u4e00\u6b65\u624d\u662f\u771f\u6b63\u7684\u64cd\u4f5c\u6570\u636e\u5e93\n</code></pre>"},{"location":"programming/python/Django/auth/#8","title":"8. \u6ce8\u9500","text":"<pre><code>auth.logout(request) \n</code></pre>"},{"location":"programming/python/Django/auth/#9","title":"9. \u6ce8\u518c","text":"<pre><code># \u64cd\u4f5cauth_user\u8868\u5199\u5165\u6570\u636e\nUser.objects.create(username=username,password=password)  # \u5199\u5165\u6570\u636e  \u4e0d\u80fd\u7528create \u5bc6\u7801\u6ca1\u6709\u52a0\u5bc6\u5904\u7406\n# \u521b\u5efa\u666e\u901a\u7528\u6237\nUser.objects.create_user(username=username,password=password)\n</code></pre>"},{"location":"programming/python/Django/auth/#auth_user","title":"\u4e8c\u3001\u6269\u5c55auth_user\u8868","text":"<pre><code>from django.db import models\nfrom django.contrib.auth.models import User,AbstractUser\n# Create your models here.\n\n# \u7b2c\u4e00\u79cd:\u4e00\u5bf9\u4e00\u5173\u7cfb  \u4e0d\u63a8\u8350\n# class UserDetail(models.Model):\n#     phone = models.BigIntegerField()\n#     user = models.OneToOneField(to='User')\n\n\n# \u7b2c\u4e8c\u79cd:\u9762\u5411\u5bf9\u8c61\u7684\u7ee7\u627f\nclass UserInfo(AbstractUser):\n    \"\"\"\n    \u5982\u679c\u7ee7\u627f\u4e86AbstractUser\n    \u90a3\u4e48\u5728\u6267\u884c\u6570\u636e\u5e93\u8fc1\u79fb\u547d\u4ee4\u7684\u65f6\u5019auth_user\u8868\u5c31\u4e0d\u4f1a\u518d\u521b\u5efa\u51fa\u6765\u4e86\n    \u800cUserInfo\u8868\u4e2d\u4f1a\u51fa\u73b0auth_user\u6240\u6709\u7684\u5b57\u6bb5\u5916\u52a0\u81ea\u5df1\u6269\u5c55\u7684\u5b57\u6bb5\n    \u8fd9\u4e48\u505a\u7684\u597d\u5904\u5728\u4e8e\u4f60\u80fd\u591f\u76f4\u63a5\u70b9\u51fb\u4f60\u81ea\u5df1\u7684\u8868\u66f4\u52a0\u5feb\u901f\u7684\u5b8c\u6210\u64cd\u4f5c\u53ca\u6269\u5c55\n\n    \u524d\u63d0:\n        1.\u5728\u7ee7\u627f\u4e4b\u524d\u6ca1\u6709\u6267\u884c\u8fc7\u6570\u636e\u5e93\u8fc1\u79fb\u547d\u4ee4\n            auth_user\u6ca1\u6709\u88ab\u521b\u5efa\uff0c\u5982\u679c\u5f53\u524d\u5e93\u5df2\u7ecf\u521b\u5efa\u4e86\u90a3\u4e48\u4f60\u5c31\u91cd\u65b0\u6362\u4e00\u4e2a\u5e93\n        2.\u7ee7\u627f\u7684\u7c7b\u91cc\u9762\u4e0d\u8981\u8986\u76d6AbstractUser\u91cc\u9762\u7684\u5b57\u6bb5\u540d\n            \u8868\u91cc\u9762\u6709\u7684\u5b57\u6bb5\u90fd\u4e0d\u8981\u52a8\uff0c\u53ea\u6269\u5c55\u989d\u5916\u5b57\u6bb5\u5373\u53ef\n        3.\u9700\u8981\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u544a\u8bc9django\u4f60\u8981\u7528UserInfo\u66ff\u4ee3auth_user(******)\n            AUTH_USER_MODEL = 'app.UserInfo'\n                                '\u5e94\u7528\u540d.\u8868\u540d'\n    \"\"\"\n    phone = models.BigIntegerField()\n\n\n\"\"\"\n\u4f60\u5982\u679c\u81ea\u5df1\u5199\u8868\u66ff\u4ee3\u4e86auth_user\u90a3\u4e48\nauth\u6a21\u5757\u7684\u529f\u80fd\u8fd8\u662f\u7167\u5e38\u4f7f\u7528\uff0c\u53c2\u8003\u7684\u8868\u9875\u7531\u539f\u6765\u7684auth_user\u53d8\u6210\u4e86UserInfo\n\"\"\"\n</code></pre>"},{"location":"programming/python/Django/cookie%26session/","title":"cookie\u4e0esession","text":""},{"location":"programming/python/Django/cookie%26session/#cookie","title":"\u4e00\u3001cookie","text":""},{"location":"programming/python/Django/cookie%26session/#1-cookie","title":"1. cookie\u5e38\u7528\u65b9\u6cd5","text":"<ol> <li>set_cookie(key,value)</li> <li>max_age\u53c2\u6570\uff1a\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d</li> <li>expires\u53c2\u6570\uff1a\u8bbe\u7f6e\u8d85\u65f6\u65f6\u95f4\uff0c\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff0c\u9488\u5bf9IE\u6d4f\u89c8\u5668</li> <li>request.COOKIES.get(key)</li> <li>delete_cookie(key)</li> </ol>"},{"location":"programming/python/Django/cookie%26session/#2-cookie","title":"2. \u57fa\u4e8ecookie\u7684\u767b\u5f55","text":"<pre><code>from django.shortcuts import render, HttpResponse, redirect\nfrom django import forms\n\n\ndef login_auth(func):\n    def inner(request, *args, **kwargs):\n        target_url = request.get_full_path()\n        if request.COOKIES.get('username'):\n            return func(request, *args, **kwargs)\n        else:\n            return redirect('/login/?redirect=%s' % target_url)\n\n    return inner\n\n\ndef login(request):\n    if request.method == 'POST':\n        username = request.POST.get('username')\n        password = request.POST.get('password')\n        if username == 'admin' and password == '123':\n            # \u83b7\u53d6\u7528\u6237\u4e0a\u4e00\u6b21\u60f3\u8981\u8bbf\u95ee\u7684url\n            target_url = request.GET.get('redirect')  # \u8fd9\u4e2a\u7ed3\u679c\u53ef\u80fd\u662fNone\n            if target_url:\n                obj = redirect(target_url)\n            else:\n                # \u4fdd\u5b58\u7528\u6237\u767b\u9646\u72b6\u6001\n                obj = redirect('/home/')\n            # \u8ba9\u6d4f\u89c8\u5668\u8bb0\u5f55cookie\u6570\u636e\n            obj.set_cookie('username', username)\n            \"\"\"\n            \u6d4f\u89c8\u5668\u4e0d\u5355\u5355\u4f1a\u5e2e\u4f60\u5b58\n            \u800c\u4e14\u540e\u9762\u6bcf\u6b21\u8bbf\u95ee\u4f60\u7684\u65f6\u5019\u8fd8\u4f1a\u5e26\u7740\u5b83\u8fc7\u6765\n            \"\"\"\n            # \u8df3\u8f6c\u5230\u4e00\u4e2a\u9700\u8981\u7528\u6237\u767b\u9646\u4e4b\u540e\u624d\u80fd\u770b\u7684\u9875\u9762\n            return obj\n    return render(request, 'login.html')\n\n\n@login_auth\ndef home(request):\n    return HttpResponse(\"\u6211\u662fhome\u9875\u9762\")\n\n\n@login_auth\ndef logout(request):\n    obj = redirect('/login/')\n    obj.delete_cookie('username')\n    return obj\n</code></pre>"},{"location":"programming/python/Django/cookie%26session/#session","title":"\u4e8c\u3001session","text":"<p>\u5728\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u64cd\u4f5csession\u7684\u65f6\u5019\u9700\u8981django\u9ed8\u8ba4\u7684\u4e00\u5f20django_session\u8868\u3002</p> <p>django\u9ed8\u8ba4session\u7684\u8fc7\u671f\u65f6\u95f4\u662f14\u5929</p> <p>django_session\u8868\u4e2d\u7684\u6570\u636e\u6761\u6570\u662f\u53d6\u51b3\u4e8e\u6d4f\u89c8\u5668\u7684\uff0c\u540c\u4e00\u4e2a\u8ba1\u7b97\u673a\u4e0a(IP\u5730\u5740)\u540c\u4e00\u4e2a\u6d4f\u89c8\u5668\u53ea\u4f1a\u6709\u4e00\u6761\u6570\u636e\u751f\u6548\u3002</p>"},{"location":"programming/python/Django/cookie%26session/#1-session","title":"1. session\u5e38\u7528\u65b9\u6cd5","text":"<ol> <li>request.session['key'] = value</li> <li>request.session.get('key')</li> <li>request.session.set_expiry() 4\u79cd\u7c7b\u578b\u7684\u53c2\u6570</li> <li>\u6574\u6570\uff1a\u79d2</li> <li>\u65e5\u671f\u5bf9\u8c61\uff1a\u5230\u6307\u5b9a\u65e5\u671f\u5c31\u5931\u6548</li> <li>0\uff1a \u4e00\u65e6\u5f53\u524d\u6d4f\u89c8\u5668\u7a97\u53e3\u5173\u95ed\u7acb\u523b\u5931\u6548</li> <li>\u4e0d\u5199\uff1a\u5931\u6548\u65f6\u95f4\u5c31\u53d6\u51b3\u4e8edjango\u5185\u90e8\u5168\u5c40session\u9ed8\u8ba4\u7684\u5931\u6548\u65f6\u95f4</li> <li>request.session.delete()  \u53ea\u5220\u670d\u52a1\u7aef\u7684\uff0c\u5ba2\u6237\u7aef\u7684\u4e0d\u5220</li> <li>request.session.flush()  \u6d4f\u89c8\u5668\u548c\u670d\u52a1\u7aef\u90fd\u6e05\u7a7a(\u63a8\u8350\u4f7f\u7528)</li> </ol>"},{"location":"programming/python/Django/cookie%26session/#2","title":"2. \u5185\u90e8\u539f\u7406","text":""},{"location":"programming/python/Django/cookie%26session/#21-session","title":"2.1 \u8bbe\u7f6esession\u65f6\u5019","text":"<ol> <li> <p>django\u5185\u90e8\u4f1a\u81ea\u52a8\u5e2e\u4f60\u751f\u6210\u4e00\u4e2a\u968f\u673a\u5b57\u7b26\u4e32</p> <ol> <li> <p>django\u5185\u90e8\u81ea\u52a8\u5c06\u968f\u673a\u5b57\u7b26\u4e32\u548c\u5bf9\u5e94\u7684\u6570\u636e\u5b58\u50a8\u5230django_session\u8868\u4e2d</p> <ul> <li>\u5148\u5728\u5185\u5b58\u4e2d\u4ea7\u751f\u64cd\u4f5c\u6570\u636e\u7684\u7f13\u5b58</li> <li>\u5728\u54cd\u5e94\u7ed3\u679cdjango\u4e2d\u95f4\u4ef6\u7684\u65f6\u5019\u624d\u771f\u6b63\u7684\u64cd\u4f5c\u6570\u636e\u5e93</li> </ul> </li> <li> <p>\u5c06\u4ea7\u751f\u7684\u968f\u673a\u5b57\u7b26\u4e32\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u4fdd\u5b58</p> </li> </ol> </li> </ol>"},{"location":"programming/python/Django/cookie%26session/#22","title":"2.2 \u53d6\u503c\u65f6","text":"<ol> <li>\u81ea\u52a8\u4ece\u6d4f\u89c8\u5668\u8bf7\u6c42\u4e2d\u83b7\u53d6sessionid\u5bf9\u5e94\u7684\u968f\u673a\u5b57\u7b26\u4e32</li> <li>\u62ff\u7740\u8be5\u968f\u673a\u5b57\u7b26\u4e32\u53bbdjango_session\u8868\u4e2d\u67e5\u627e\u5bf9\u5e94\u7684\u6570\u636e</li> <li>\u5982\u679c\u6bd4\u5bf9\u4e0a\u4e86 \u5219\u5c06\u5bf9\u5e94\u7684\u6570\u636e\u53d6\u51fa\u5e76\u4ee5\u5b57\u5178\u7684\u5f62\u5f0f\u5c01\u88c5\u5230request.session\u4e2d</li> <li>\u5982\u679c\u6bd4\u5bf9\u4e0d\u4e0a \u5219request.session.get()\u8fd4\u56de\u7684\u662fNone</li> </ol>"},{"location":"programming/python/Django/cookie%26session/#3-session","title":"3. session\u7684\u4fdd\u5b58","text":""},{"location":"programming/python/Django/forms/","title":"forms\u7ec4\u4ef6","text":"<p>\u529f\u80fd\uff1a</p> <ol> <li>\u6e32\u67d3HTML\u4ee3\u7801</li> <li>\u6821\u9a8c\u6570\u636e</li> <li>\u5c55\u793a\u63d0\u793a\u4fe1\u606f</li> </ol>"},{"location":"programming/python/Django/forms/#1","title":"1. \u57fa\u672c\u4f7f\u7528","text":"<pre><code># filename: views.py\nfrom django import forms\n\n\nclass MyForm(forms.Form):\n    username = forms.CharField(min_length=6, max_length=32)\n    password = forms.CharField(min_length=6,max_length=32)\n    email = forms.EmailField()\n</code></pre>"},{"location":"programming/python/Django/forms/#2","title":"2. \u6570\u636e\u6821\u9a8c","text":"<pre><code>from django.test import TestCase\n\n# Create your tests here.\n\nimport os\n\nif __name__ == \"__main__\":\n    os.environ.setdefault(\"DJANGO_SETTINGS_MODULE\", \"mysite.settings\")\n    import django\n\n    django.setup()\n    from django import forms\n\n\n    class MyForm(forms.Form):\n        username = forms.CharField(min_length=6, max_length=32)\n        password = forms.CharField(min_length=6, max_length=32)\n        email = forms.EmailField()\n\n\n    # \u5c06\u5e26\u6821\u9a8c\u7684\u6570\u636e\u7ec4\u7ec7\u6210\u5b57\u5178\u7684\u5f62\u5f0f\u4f20\u5165\n    # \u6821\u9a8c\u6570\u636e\u53ea\u6821\u9a8c\u7c7b\u4e2d\u51fa\u73b0\u7684\u5b57\u6bb5\uff0c\u591a\u4f20\u7684\u5b57\u6bb5\u76f4\u63a5\u5ffd\u7565\n    # \u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u7c7b\u4e2d\u7684\u6240\u6709\u5b57\u6bb5\u90fd\u5fc5\u987b\u4f20\u503c\n    form_obj = MyForm({'username': 'tom', 'password': '123456', 'email': 'tom@126.com'})\n\n    # \u5224\u65ad\u6570\u636e\u662f\u5426\u5408\u6cd5\uff0c\u53ea\u6709\u5728\u6240\u6709\u7684\u6570\u636e\u5168\u90e8\u5408\u6cd5\u7684\u60c5\u51b5\u4e0b\u624d\u4f1a\u8fd4\u56deTrue\n    print(form_obj.is_valid())  # False\n\n    # \u67e5\u770b\u6240\u6709\u4e0d\u7b26\u5408\u6821\u9a8c\u89c4\u5219\u4ee5\u53ca\u4e0d\u7b26\u5408\u7684\u539f\u56e0\n    print(form_obj.errors)  # &lt;ul class=\"errorlist\"&gt;&lt;li&gt;username&lt;ul class=\"errorlist\"&gt;&lt;li&gt;Ensure this value has at least 6 characters (it has 3).&lt;/li&gt;&lt;/ul&gt;&lt;/li&gt;&lt;/ul&gt;\n\n    # \u67e5\u770b\u6240\u6709\u6821\u9a8c\u901a\u8fc7\u7684\u6570\u636e\n    print(form_obj.cleaned_data)  # {'password': '123456', 'email': 'tom@126.com'}\n</code></pre>"},{"location":"programming/python/Django/forms/#3","title":"3. \u6e32\u67d3\u6807\u7b7e","text":"<p>forms\u7ec4\u4ef6\u53ea\u4f1a\u81ea\u52a8\u6e32\u67d3\u83b7\u53d6\u7528\u6237\u8f93\u5165\u7684\u6807\u7b7e(input select radio checkbox)\uff0c\u4e0d\u80fd\u6e32\u67d3\u63d0\u4ea4\u6309\u94ae\u3002</p> <p>\u89c6\u56fe\u5c42\uff1a</p> <pre><code>from django.shortcuts import render\nfrom django import forms\n\n\nclass MyForm(forms.Form):\n    username = forms.CharField(min_length=6, max_length=32)\n    password = forms.CharField(min_length=6, max_length=32)\n    email = forms.EmailField()\n\n\ndef index(request):\n    # \u7b2c\u4e00\u6b65\uff1a\u751f\u6210\u4e00\u4e2a\u7a7a\u5bf9\u8c61\n    form_obj = MyForm()\n    # \u76f4\u63a5\u5c06\u8be5\u7a7a\u5bf9\u8c61\u4f20\u9012\u7ed9html\u9875\u9762\n    return render(request, 'index.html', locals())\n</code></pre> <p>\u6a21\u677f\u5c42\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    {% load static %}\n    &lt;script src=\"{% static 'jquery.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"\" method=\"post\"&gt;\n    &lt;h3&gt;\u7b2c\u4e00\u79cd\u65b9\u5f0f\uff1a\u5c01\u88c5\u7a0b\u5ea6\u592a\u9ad8\uff0c\u4e0d\u4fbf\u4e8e\u540e\u7eed\u6269\u5c55\uff0c\u4e00\u822c\u53ea\u5728\u672c\u5730\u6d4b\u8bd5\u65f6\u4f7f\u7528&lt;/h3&gt;\n    &lt;h6&gt;1. \u5b57\u6bb5\u653e\u5728p\u6807\u7b7e\u4e2d&lt;/h6&gt;\n    {{ form_obj.as_p }}\n    &lt;h6&gt;2. \u5b57\u6bb5\u653e\u5728p\u6807\u7b7e\u4e2d&lt;/h6&gt;\n    {{ form_obj.as_ul }}\n    &lt;h6&gt;3. \u6ca1\u6709\u5176\u4ed6\u6807\u7b7e\u5305\u88f9&lt;/h6&gt;\n    {{ form_obj.as_table }}\n    &lt;h3&gt;\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a\u53ef\u6269\u5c55\u6027\u5f88\u5f3a\uff0c\u4f46\u662f\u9700\u8981\u4e66\u5199\u7684\u4ee3\u7801\u592a\u591a\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u7528&lt;/h3&gt;\n    {#\u5bf9\u8c61.\u5b57\u6bb5.\u5b57\u6bb5\u7684\u5c5e\u6027#}\n    &lt;p&gt;{{ form_obj.username.label }}:{{ form_obj.username }}&lt;/p&gt;\n    &lt;p&gt;{{ form_obj.password.label }}:{{ form_obj.password }}&lt;/p&gt;\n    &lt;p&gt;{{ form_obj.email.label }}:{{ form_obj.email }}&lt;/p&gt;\n    &lt;h3&gt;\u7b2c\u4e09\u79cd\u65b9\u5f0f\uff08\u63a8\u8350\u4f7f\u7528\uff09\uff1a\u7b49\u4ef7\u4e8e\u7b2c\u4e8c\u4e2d\u65b9\u5f0f\uff0c\u4ee3\u7801\u4e66\u5199\u7b80\u5355\uff0c\u5e76\u4e14\u6269\u5c55\u6027\u4e5f\u9ad8&lt;/h3&gt;\n    {% for form in form_obj %}\n        &lt;p&gt;{{ form.label }}:{{ form }}&lt;/p&gt;\n    {% endfor %}\n\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6e32\u67d3\u7ed3\u679c</p> <p></p>"},{"location":"programming/python/Django/forms/#4","title":"4. \u5c55\u793a\u9519\u8bef\u4fe1\u606f","text":""},{"location":"programming/python/Django/forms/#41","title":"4.1 \u57fa\u672c\u4f7f\u7528","text":"<p>\u89c6\u56fe\u5c42</p> <pre><code>from django.shortcuts import render, HttpResponse\nfrom django import forms\n\n\nclass MyForm(forms.Form):\n    username = forms.CharField(min_length=6, max_length=32, label='\u7528\u6237\u540d')\n    password = forms.CharField(min_length=6, max_length=32, label='\u5bc6\u7801')\n    email = forms.EmailField(label='\u90ae\u7bb1')\n\n\ndef index(request):\n    # 1. \u751f\u6210\u4e00\u4e2a\u7a7a\u5bf9\u8c61\n    form_obj = MyForm()\n    if request.method == 'POST':\n        # 3.\u6821\u9a8c\u6570\u636e\n        form_obj = MyForm(request.POST)  # request.POST\u53ef\u4ee5\u770b\u6210\u5c31\u662f\u4e00\u4e2a\u5b57\u5178\n        # 4. \u5224\u65ad\u6570\u636e\u662f\u5426\u5408\u6cd5\n        if form_obj.is_valid():\n            # \u5982\u679c\u5408\u6cd5\uff0c\u6267\u884c\u64cd\u4f5c\n            return HttpResponse('ok')\n        # 5.\u4e0d\u5408\u6cd5 \u6709\u9519\u8bef\n    # 2. \u76f4\u63a5\u5c06\u8be5\u7a7a\u5bf9\u8c61\u4f20\u9012\u7ed9html\u9875\u9762\n    return render(request, 'index.html', locals())\n\n\n# 1. get\u8bf7\u6c42\u548cpost\u4f20\u7ed9html\u9875\u9762\u5bf9\u8c61\u53d8\u91cf\u540d\u5fc5\u987b\u4e00\u6837\n# 2. forms\u7ec4\u4ef6\u5f53\u6570\u636e\u4e0d\u5408\u6cd5\u7684\u60c5\u51b5\u4e0b,\u4f1a\u4fdd\u5b58\u4e0a\u6b21\u7684\u6570\u636e\n</code></pre> <p>\u6a21\u677f\u5c42\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"\" method=\"post\" novalidate&gt; {# novalidate \u8ba9\u524d\u7aef\u4e0d\u6821\u9a8c\u6570\u636e #}\n    {% for form in form_obj %}\n        &lt;p&gt;\n            {{ form.label }}:{{ form }}\n            &lt;span style=\"color: red\"&gt;{{ form.errors.0 }}&lt;/span&gt;\n        &lt;/p&gt;\n    {% endfor %}\n&lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6e32\u67d3\u6548\u679c</p> <p></p>"},{"location":"programming/python/Django/forms/#42","title":"4.2 \u5b9a\u5236\u9519\u8bef\u4fe1\u606f","text":"<pre><code>class MyForm(forms.Form):\n    username = forms.CharField(min_length=6, max_length=12, label='\u7528\u6237\u540d',\n                               error_messages={\n                                   'min_length': '\u7528\u6237\u540d\u6700\u5c116\u4f4d',\n                                   'max_length': '\u7528\u6237\u540d\u6700\u592712\u4f4d',\n                                   'required': \"\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a\"\n                               }\n                               )\n    password = forms.CharField(min_length=6, max_length=32, label='\u5bc6\u7801',\n                               error_messages={\n                                   'min_length': '\u5bc6\u7801\u6700\u5c116\u4f4d',\n                                   'max_length': '\u5bc6\u7801\u6700\u592732\u4f4d',\n                                   'required': \"\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a\"\n                               })\n    email = forms.EmailField(label='\u90ae\u7bb1',\n                             error_messages={\n                                 'invalid': '\u90ae\u7bb1\u683c\u5f0f\u4e0d\u6b63\u786e',\n                                 'required': \"\u90ae\u7bb1\u4e0d\u80fd\u4e3a\u7a7a\"\n                             })\n</code></pre>"},{"location":"programming/python/Django/forms/#5","title":"5. \u94a9\u5b50\u51fd\u6570","text":"<pre><code>class MyForm(forms.Form):\n    username = forms.CharField(min_length=6, max_length=32, label='\u7528\u6237\u540d')\n    password = forms.CharField(min_length=6, max_length=32, label='\u5bc6\u7801')\n    confirm_password = forms.CharField(min_length=6, max_length=32, label='\u786e\u8ba4\u5bc6\u7801')\n    email = forms.EmailField(label='\u90ae\u7bb1')\n\n    # \u94a9\u5b50\u51fd\u6570  \u5728\u7c7b\u91cc\u9762\u4e66\u5199\u65b9\u6cd5\u5373\u53ef\n    # 1. \u5c40\u90e8\u94a9\u5b50 \u9700\u8981\u7ed9\u5355\u4e2a\u5b57\u6bb5\u589e\u52a0\u6821\u9a8c\u89c4\u5219\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\n    def clean_username(self):\n        # \u83b7\u53d6\u5230\u7528\u6237\u540d\n        username = self.cleaned_data.get('username')\n        if '666' in username:\n            # \u63d0\u793a\u524d\u7aef\u5c55\u793a\u9519\u8bef\u4fe1\u606f\n            self.add_error('username', '\u5149\u558a666\u662f\u4e0d\u884c\u6ef4\uff5e')\n        # \u5c06\u94a9\u5b50\u51fd\u6570\u94a9\u53bb\u51fa\u6765\u6570\u636e\u518d\u653e\u56de\u53bb\n        return username\n\n    # 2. \u5168\u5c40\u94a9\u5b50 \u9700\u8981\u7ed9\u591a\u4e2a\u5b57\u6bb5\u589e\u52a0\u6821\u9a8c\u89c4\u5219\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\n    def clean(self):\n        password = self.cleaned_data.get('password')\n        confirm_password = self.cleaned_data.get('confirm_password')\n        if not confirm_password == password:\n            self.add_error('confirm_password', '\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4')\n        # \u5c06\u94a9\u5b50\u51fd\u6570\u94a9\u51fa\u6765\u6570\u636e\u518d\u653e\u56de\u53bb\n        return self.cleaned_data\n</code></pre>"},{"location":"programming/python/Django/forms/#6-forms","title":"6. forms\u7ec4\u4ef6\u5e38\u7528\u53c2\u6570","text":"<pre><code>label # \u5b57\u6bb5\u540d\nerror_messages  # \u81ea\u5b9a\u4e49\u62a5\u9519\u4fe1\u606f\ninitial  # \u9ed8\u8ba4\u503c\nrequired  # \u63a7\u5236\u5b57\u6bb5\u662f\u5426\u5fc5\u586b\nvalidators=[\n            RegexValidator(r'^[0-9]+$', '\u8bf7\u8f93\u5165\u6570\u5b57'),\n            RegexValidator(r'^159[0-9]+$', '\u6570\u5b57\u5fc5\u987b\u4ee5159\u5f00\u5934')\n        ]  # \u6b63\u5219\u6821\u9a8c from django.core.validators import RegexValidator\nwidget=forms.widgets.PasswordInput(attrs={'class':'form-control c1 c2'})  # attrs \u8fd9\u662f\u5c5e\u6027\uff0c\u6bd4\u5982\u6dfb\u52a0bootstrap\u6837\u5f0f\n</code></pre> <p>\u4e0d\u540c\u7c7b\u578b\u7684<code>input</code>:</p> <pre><code># radio\ngender = forms.ChoiceField(\n    choices=((1, \"\u7537\"), (2, \"\u5973\"), (3, \"\u4fdd\u5bc6\")),\n    label=\"\u6027\u522b\",\n    initial=3,\n    widget=forms.widgets.RadioSelect()\n)\n# select\nhobby = forms.ChoiceField(\n    choices=((1, \"\u7bee\u7403\"), (2, \"\u8db3\u7403\"), (3, \"\u53cc\u8272\u7403\"),),\n    label=\"\u7231\u597d\",\n    initial=3,\n    widget=forms.widgets.Select()\n)\n# \u591a\u9009\nhobby1 = forms.MultipleChoiceField(\n    choices=((1, \"\u7bee\u7403\"), (2, \"\u8db3\u7403\"), (3, \"\u53cc\u8272\u7403\"),),\n    label=\"\u7231\u597d\",\n    initial=[1, 3],\n    widget=forms.widgets.SelectMultiple()\n)\n# \u5355\u9009checkbox\nkeep = forms.ChoiceField(\n    label=\"\u662f\u5426\u8bb0\u4f4f\u5bc6\u7801\",\n    initial=\"checked\",\n    widget=forms.widgets.CheckboxInput()\n)\n# \u591a\u9009checkbox\nhobby2 = forms.MultipleChoiceField(\n    choices=((1, \"\u7bee\u7403\"), (2, \"\u8db3\u7403\"), (3, \"\u53cc\u8272\u7403\"),),\n    label=\"\u7231\u597d\",\n    initial=[1, 3],\n    widget=forms.widgets.CheckboxSelectMultiple()\n)\n</code></pre>"},{"location":"programming/python/Django/forms/#7-form","title":"7. form\u8868\u5355\u4e0a\u4f20\u6587\u4ef6\u53ca\u540e\u7aef\u64cd\u4f5c","text":""},{"location":"programming/python/Django/forms/#1_1","title":"1. \u524d\u7aef","text":"<p>form\u8868\u5355\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u7684\u6570\u636e</p> <ol> <li> <p>method\u5fc5\u987b\u6307\u5b9a\u6210<code>post</code></p> </li> <li> <p>enctype\u5fc5\u987b\u6362\u6210<code>multipart/form-data</code></p> </li> </ol> <pre><code>&lt;form action=\"\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n    &lt;p&gt;file:&lt;input type=\"file\" name=\"file\"&gt;&lt;/p&gt;\n    &lt;input type=\"submit\"&gt;\n&lt;/form&gt;\n</code></pre>"},{"location":"programming/python/Django/forms/#2_1","title":"2. \u540e\u7aef","text":"<pre><code>def upload_file(request):\n    if request.method == 'POST':\n        print(request.body)  # \u539f\u751f\u7684\u6d4f\u89c8\u5668\u53d1\u8fc7\u6765\u7684\u4e8c\u8fdb\u5236\u6570\u636e\n        print(request.FILES)  # \u83b7\u53d6\u6587\u4ef6\u6570\u636e &lt;MultiValueDict: {'file': [&lt;InMemoryUploadedFile: ebc.jpg (image/jpeg)&gt;]}&gt;\n        file_obj = request.FILES.get('file')  # \u6587\u4ef6\u5bf9\u8c61\n        print(file_obj.name) # abc.jpg\n        with open(file_obj.name,'wb') as f:\n            for line in file_obj.chunks():  # \u63a8\u8350\u52a0\u4e0achunks\u65b9\u6cd5 \u5176\u5b9e\u8ddf\u4e0d\u52a0\u662f\u4e00\u6837\u7684\u90fd\u662f\u4e00\u884c\u884c\u7684\u8bfb\u53d6\n                f.write(line)\n    return render(request, 'upload_file.html')\n</code></pre>"},{"location":"programming/python/Django/install/","title":"\u5b89\u88c5","text":""},{"location":"programming/python/Django/install/#_1","title":"\u4e00\u3001\u5b89\u88c5","text":""},{"location":"programming/python/Django/install/#1","title":"1. \u521b\u5efa\u865a\u62df\u73af\u5883","text":"<pre><code>$ mkdir DjangoProject\n$ python3 -m venv DjangoProject/Djangovenv\n$ cd DjangoProject\n$ source Djangovenv/bin/activate # \u6fc0\u6d3b\u865a\u62df\u73af\u5883\n</code></pre>"},{"location":"programming/python/Django/install/#2-django","title":"2. \u5b89\u88c5\u6307\u5b9a\u7248\u672c\u7684<code>Django</code>","text":"<p>\u901a\u8fc7https://www.djangoproject.com/download/#supported-versions\u53ef\u4ee5\u67e5\u770b\u7248\u672c\u53d1\u5e03\u8ba1\u5212\uff0c\u9009\u62e9\u9700\u8981\u5b89\u88c5\u7684\u7248\u672c\u3002</p> <pre><code>$ pip3 install django==2.2.25\n</code></pre>"},{"location":"programming/python/Django/install/#_2","title":"\u4e8c\u3001\u521b\u5efa\u4e00\u4e2a\u9879\u76ee","text":""},{"location":"programming/python/Django/install/#1_1","title":"1. \u521b\u5efa\u9879\u76ee","text":"<p>\u521b\u5efa\u4e00\u4e2a\u540d\u4e3a<code>mysite</code>\u7684<code>Django</code>\u9879\u76ee</p> <pre><code>$ django-admin startproject mysite\n$ tree mysite/\nmysite/\n\u251c\u2500\u2500 manage.py\n\u2514\u2500\u2500 mysite\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 settings.py\n    \u251c\u2500\u2500 urls.py\n    \u2514\u2500\u2500 wsgi.py\n</code></pre>"},{"location":"programming/python/Django/install/#2-django_1","title":"2. \u542f\u52a8<code>Django</code>\u9879\u76ee","text":"<pre><code>$ cd mysite\n$ python3 manage.py runserver 127.0.0.1:8000\n$ tree\n.\n\u251c\u2500\u2500 db.sqlite3\n\u251c\u2500\u2500 manage.py\n\u2514\u2500\u2500 mysite\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 __pycache__\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.cpython-38.pyc\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 settings.cpython-38.pyc\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 urls.cpython-38.pyc\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 wsgi.cpython-38.pyc\n    \u251c\u2500\u2500 settings.py\n    \u251c\u2500\u2500 urls.py\n    \u2514\u2500\u2500 wsgi.py\n</code></pre> <p>\u7528\u6d4f\u89c8\u5668\u8bbf\u95eehttp://127.0.0.1:8000/</p> <p></p>"},{"location":"programming/python/Django/install/#3","title":"3. \u521b\u5efa\u5e94\u7528","text":"<pre><code>$ python3 manage.py startapp app\n$ tree .\n.\n\u251c\u2500\u2500 app  # \u65b0\u521b\u5efa\u7684\u6587\u4ef6\u5939\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 admin.py        # \u540e\u53f0\u7ba1\u7406\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 apps.py         # \u6ce8\u518c\u5e94\u7528\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 migrations      # \u6570\u636e\u5e93\u8fc1\u79fb\u8bb0\u5f55\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 models.py       # \u6570\u636e\u5e93\u6a21\u578b\u7c7b\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 tests.py        # \u6d4b\u8bd5\u6587\u4ef6\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 views.py        # \u89c6\u56fe\u51fd\u6570\n\u251c\u2500\u2500 db.sqlite3          # \u81ea\u5e26\u7684sqlite\u6570\u636e\u5e93\n\u251c\u2500\u2500 manage.py           \n\u2514\u2500\u2500 mysite\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 __pycache__\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.cpython-38.pyc\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 settings.cpython-38.pyc\n    \u2502\u00a0\u00a0 \u251c\u2500\u2500 urls.cpython-38.pyc\n    \u2502\u00a0\u00a0 \u2514\u2500\u2500 wsgi.cpython-38.pyc\n    \u251c\u2500\u2500 settings.py     # \u914d\u7f6e\u6587\u4ef6\n    \u251c\u2500\u2500 urls.py         # \u8def\u7531\u76f8\u5173\n    \u2514\u2500\u2500 wsgi.py         # wsgiref\n</code></pre>"},{"location":"programming/python/Django/install/#4","title":"4. \u6ce8\u518c\u5e94\u7528","text":"<p>\u6bcf\u521b\u5efa\u4e00\u4e2a\u5e94\u7528\u90fd\u9700\u8981\u6ce8\u518c\u5230\u9879\u76ee\u4e2d\u3002</p> <p>\u6ce8\u518c\u65b9\u6cd5\uff1a\u4fee\u6539<code>mysite/mysite/settings.py</code>\u6587\u4ef6</p> <pre><code># Django\u9879\u76ee\u9ed8\u8ba4\u81ea\u5e26\u4e86\u5982\u4e0b\u7684\u5e94\u7528\uff08\u529f\u80fd\u6a21\u5757\uff09\nINSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    'app.apps.AppConfig', # \u6dfb\u52a0\u6b64\u884c\n    # 'app'  # \u53ef\u4ee5\u7b80\u5199\n]\n</code></pre>"},{"location":"programming/python/Django/install/#_3","title":"\u4e09\u3001\u57fa\u672c\u4f7f\u7528","text":""},{"location":"programming/python/Django/install/#1_2","title":"1. \u521b\u5efa\u89c6\u56fe\u51fd\u6570","text":"<p>\u5728<code>mysite/app/views.py</code>\u4e2d\u7f16\u5199\u89c6\u56fe\u51fd\u6570</p> <pre><code>from django.http import HttpResponse\nfrom django.shortcuts import render\n\n# Create your views here.\ndef index(request):\n    return HttpResponse(\"Hello World\")\n</code></pre>"},{"location":"programming/python/Django/install/#2","title":"2. \u6ce8\u518c\u8def\u7531","text":"<p>\u5728<code>mysite/urls.py</code>\u4e2d\u6dfb\u52a0\u89c6\u56fe\u51fd\u6570\u548c\u8def\u7531\u7684\u6620\u5c04</p> <pre><code>from django.contrib import admin\nfrom django.urls import path\nfrom app import views  # 1. \u5bfc\u5165app\u4e0b\u7684views\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('index/', views.index),  # 2. \u8def\u7531\u548c\u89c6\u56fe\u51fd\u6570\u7684\u6620\u5c04\n]\n</code></pre>"},{"location":"programming/python/Django/install/#3-django","title":"3. \u91cd\u65b0\u542f\u52a8<code>Django</code>\u9879\u76ee","text":""},{"location":"programming/python/Django/install/#_4","title":"\u56db\u3001\u8bf7\u6c42\u751f\u547d\u5468\u671f","text":""},{"location":"programming/python/Django/install/#1_3","title":"1. \u6d4f\u89c8\u5668","text":"<p>\u200b   \u53d1\u9001HTTP\u8bf7\u6c42</p>"},{"location":"programming/python/Django/install/#2-web","title":"2. Web\u670d\u52a1\u7f51\u7ba1\u63a5\u53e3","text":""},{"location":"programming/python/Django/install/#21","title":"2.1 \u4f5c\u7528","text":"<p>\u5904\u7406\u8bf7\u6c42\u6d41\u7a0b\uff1a\u8bf7\u6c42\u6765\u7684\u65f6\u5019\u89e3\u6790\u5c01\u88c5\uff0c\u54cd\u5e94\u8d70\u7684\u65f6\u5019\u6253\u5305\u5904\u7406</p>"},{"location":"programming/python/Django/install/#22","title":"2.2 \u5b9e\u73b0","text":"<ol> <li>wsgiref\u6a21\u5757\uff0cdjango\u9ed8\u8ba4\u6a21\u5757\uff0c\u4e0d\u80fd\u627f\u53d7\u9ad8\u5e76\u53d1</li> <li>uwsgi\u6a21\u5757\uff0c\u53ef\u4ee5\u652f\u6301\u9ad8\u5e76\u53d1</li> <li>\u4e24\u4e2a\u6a21\u5757\u90fd\u662fWSGI\u534f\u8bae\u7684\u5b9e\u73b0</li> </ol>"},{"location":"programming/python/Django/install/#3-django_1","title":"3. Django\u540e\u7aef","text":""},{"location":"programming/python/Django/install/#31","title":"3.1 \u4e2d\u95f4\u4ef6","text":""},{"location":"programming/python/Django/install/#32","title":"3.2 \u8def\u7531\u5c42","text":"<p>\u8bc6\u522b\u8def\u7531\u5339\u914d\u5bf9\u5e94\u7684\u89c6\u56fe\u51fd\u6570</p>"},{"location":"programming/python/Django/install/#33","title":"3.3 \u89c6\u56fe\u5c42","text":"<p>\u7f51\u7ad9\u6574\u4f53\u7684\u4e1a\u52a1\u903b\u8f91</p>"},{"location":"programming/python/Django/install/#34","title":"3.4 \u6a21\u677f\u5c42","text":"<p>\u7f51\u7ad9\u6240\u6709\u7684html\u6587\u4ef6</p>"},{"location":"programming/python/Django/install/#35","title":"3.5 \u6a21\u578b\u5c42","text":"<p>\u6570\u636e\u5e93\u76f8\u5173</p>"},{"location":"programming/python/Django/install/#4_1","title":"4. \u6d41\u7a0b","text":"<ol> <li>Django\u4ece\u6536\u5230\u6d88\u606f\u4e2d\uff0c\u4ece\u8bf7\u6c42\u6d88\u606f\u4e2d\u5206\u89e3\u51fa\u7528\u6237\u8bbf\u95ee\u7684\u8def\u5f84</li> <li>\u62ff\u7740\u5f97\u5230\u7684\u8def\u5f84\u5728\u8def\u5f84\u548c\u51fd\u6570\u7684\u5bf9\u5e94\u5173\u7cfb\u5217\u8868\u4e2d\u8fdb\u884c\u5339\u914d\uff0c\u5339\u914d\u4e4b\u540e\u6267\u884c\u51fd\u6570</li> <li>\u6267\u884c\u51fd\u6570\uff0c\u628a\u6240\u6709\u548c\u8bf7\u6c42\u76f8\u5173\u7684\u6570\u636e\u5c01\u88c5\u5230\u4e00\u4e2arequest\u53c2\u6570\u4e2d</li> <li>render\u627e\u5230html\u6587\u4ef6\uff0c\u6253\u5f00\u5e76\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\uff0c\u6309\u7167http\u54cd\u5e94\u6d88\u606f\u7684\u683c\u5f0f\u5c01\u88c5\uff0c\u8fd4\u56de\u7ed9\u7528\u6237\u7684\u6d4f\u89c8\u5668</li> <li>\u6d4f\u89c8\u5668\u6536\u5230\u54cd\u5e94\u7684\u6d88\u606f\uff0c\u6309\u7167HTML\u7684\u683c\u5f0f\u5c55\u793a\u9875\u9762   </li> </ol>"},{"location":"programming/python/Django/middleware/","title":"\u4e2d\u95f4\u4ef6","text":""},{"location":"programming/python/Django/middleware/#_2","title":"\u4e00\u3001\u4ecb\u7ecd","text":"<p>django\u4e2d\u95f4\u4ef6\u662fdjango\u7684\u95e8\u6237</p> <ol> <li> <p>\u8bf7\u6c42\u6765\u7684\u65f6\u5019\u9700\u8981\u5148\u7ecf\u8fc7\u4e2d\u95f4\u4ef6\u624d\u80fd\u5230\u8fbe\u771f\u6b63\u7684django\u540e\u7aef</p> </li> <li> <p>\u54cd\u5e94\u8d70\u7684\u65f6\u5019\u6700\u540e\u4e5f\u9700\u8981\u7ecf\u8fc7\u4e2d\u95f4\u4ef6\u624d\u80fd\u53d1\u9001\u51fa\u53bb</p> </li> </ol> <p>django\u81ea\u5e26\u4e03\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u6bcf\u4e2a\u4e2d\u95f4\u4ef6\u90fd\u6709\u5404\u81ea\u5bf9\u5e94\u7684\u529f\u80fd</p> <pre><code>MIDDLEWARE = [\n    'django.middleware.security.SecurityMiddleware',\n    'django.contrib.sessions.middleware.SessionMiddleware',\n    'django.middleware.common.CommonMiddleware',\n    'django.middleware.csrf.CsrfViewMiddleware',\n    'django.contrib.auth.middleware.AuthenticationMiddleware',\n    'django.contrib.messages.middleware.MessageMiddleware',\n    'django.middleware.clickjacking.XFrameOptionsMiddleware',\n]\n</code></pre>"},{"location":"programming/python/Django/middleware/#_3","title":"\u4e8c\u3001\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6","text":"<p>django\u652f\u6301\u7a0b\u5e8f\u5458\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u5e76\u4e14\u66b4\u9732\u7ed9\u7a0b\u5e8f\u5458\u4e94\u4e2a\u53ef\u4ee5\u81ea\u5b9a\u4e49\u7684\u65b9\u6cd5\uff1a</p> <ol> <li>process_request</li> <li>process_response</li> <li>process_view</li> <li>process_template_response</li> <li>process_exception</li> </ol>"},{"location":"programming/python/Django/middleware/#1","title":"1. \u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684\u6d41\u7a0b","text":"<ol> <li> <p>\u5728\u9879\u76ee\u540d\u6216\u8005\u5e94\u7528\u540d\u4e0b\u521b\u5efa\u4e00\u4e2a\u4efb\u610f\u540d\u79f0\u7684\u6587\u4ef6\u5939</p> </li> <li> <p>\u5728\u8be5\u6587\u4ef6\u5939\u5185\u521b\u5efa\u4e00\u4e2a\u4efb\u610f\u540d\u79f0\u7684py\u6587\u4ef6</p> </li> <li> <p>\u5728\u8be5py\u6587\u4ef6\u5185\u9700\u8981\u4e66\u5199\u7c7b(\u8fd9\u4e2a\u7c7b\u5fc5\u987b\u7ee7\u627fMiddlewareMixin)\uff0c\u7136\u540e\u5728\u8fd9\u4e2a\u7c7b\u91cc\u9762\u5c31\u53ef\u4ee5\u81ea\u5b9a\u4e49\u4e94\u4e2a\u65b9\u6cd5\u4e86\uff08\u8fd9\u4e94\u4e2a\u65b9\u6cd5\u5e76\u4e0d\u662f\u5168\u90e8\u90fd\u9700\u8981\u4e66\u5199\uff0c\u7528\u51e0\u4e2a\u5199\u51e0\u4e2a)\u3002</p> </li> <li> <p>\u9700\u8981\u5c06\u7c7b\u7684\u8def\u5f84\u4ee5\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f\u6ce8\u518c\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u624d\u80fd\u751f\u6548</p> </li> </ol>"},{"location":"programming/python/Django/middleware/#2","title":"2. \u81ea\u5b9a\u4e49\u65b9\u6cd5","text":""},{"location":"programming/python/Django/middleware/#1-process_request","title":"1. process_request","text":"<pre><code>from django.utils.deprecation import MiddlewareMixin\n\n\nclass MyMiddleware1(MiddlewareMixin):\n    def process_request(self, request):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_request\u65b9\u6cd5\")\n\n\nclass MyMiddleware2(MiddlewareMixin):\n    def process_request(self, request):\n        print(\"\u6211\u662f\u7b2c\u4e8c\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_request\u65b9\u6cd5\")\n</code></pre> <p>\u89c6\u56fe\u5c42</p> <pre><code>from django.shortcuts import HttpResponse\n\n\ndef home(request):\n    print(\"\u6211\u662f\u4e3b\u9875\")\n    return HttpResponse('ok')\n</code></pre> <p></p> <p>\u603b\u7ed3\uff1a</p> <ol> <li> <p>\u8bf7\u6c42\u6765\u7684\u65f6\u5019\u9700\u8981\u7ecf\u8fc7\u6bcf\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u91cc\u9762\u7684process_request\u65b9\u6cd5\uff0c\u7ed3\u679c\u7684\u987a\u5e8f\u662f\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u518c\u7684\u4e2d\u95f4\u4ef6\u4ece\u4e0a\u5f80\u4e0b\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u3002</p> </li> <li> <p>\u5982\u679c\u4e2d\u95f4\u4ef6\u91cc\u9762\u6ca1\u6709\u5b9a\u4e49\u8be5\u65b9\u6cd5\uff0c\u90a3\u4e48\u76f4\u63a5\u8df3\u8fc7\u6267\u884c\u4e0b\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u3002</p> </li> <li> <p>\u5982\u679c\u8be5\u65b9\u6cd5\u8fd4\u56de\u4e86HttpResponse\u5bf9\u8c61\uff0c\u90a3\u4e48\u8bf7\u6c42\u5c06\u4e0d\u518d\u7ee7\u7eed\u5f80\u540e\u6267\u884c\uff0c\u800c\u662f\u76f4\u63a5\u539f\u8def\u8fd4\u56de(\u5e94\u7528\u573a\u666f\uff1a\u6821\u9a8c\u5931\u8d25\u4e0d\u5141\u8bb8\u8bbf\u95ee...)</p> </li> <li> <p>process_request\u65b9\u6cd5\u5c31\u662f\u7528\u6765\u505a\u5168\u5c40\u76f8\u5173\u7684\u6240\u6709\u9650\u5236\u529f\u80fd</p> </li> </ol>"},{"location":"programming/python/Django/middleware/#2-process_response","title":"2. process_response","text":"<pre><code>from django.utils.deprecation import MiddlewareMixin\n\n\nclass MyMiddleware1(MiddlewareMixin):\n    def process_request(self, request):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_request\u65b9\u6cd5\")\n\n    def process_response(self, request, response):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_response\u65b9\u6cd5\")\n        return response\n\n\nclass MyMiddleware2(MiddlewareMixin):\n    def process_request(self, request):\n        print(\"\u6211\u662f\u7b2c\u4e8c\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_request\u65b9\u6cd5\")\n\n    def process_response(self, request, response):\n        print(\"\u6211\u662f\u7b2c\u4e8c\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_response\u65b9\u6cd5\")\n        return response\n</code></pre> <p>\u603b\u7ed3\uff1a</p> <ol> <li> <p>\u54cd\u5e94\u8d70\u7684\u65f6\u5019\u9700\u8981\u7ed3\u679c\u6bcf\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u91cc\u9762\u7684process_response\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u6709\u4e24\u4e2a\u989d\u5916\u7684\u53c2\u6570request,response</p> </li> <li> <p>\u8be5\u65b9\u6cd5\u5fc5\u987b\u8fd4\u56de\u4e00\u4e2aHttpResponse\u5bf9\u8c61</p> </li> <li>1.\u9ed8\u8ba4\u8fd4\u56de\u7684\u5c31\u662f\u5f62\u53c2response</li> <li> <p>2.\u53ef\u4ee5\u81ea\u5df1\u8fd4\u56de\u81ea\u5df1\u5b9a\u4e49\u7684\uff0c\u6bd4\u5982HttpResponse('')</p> </li> <li> <p>\u987a\u5e8f\u662f\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u518c\u4e86\u7684\u4e2d\u95f4\u4ef6\u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u7ecf\u8fc7\uff0c\u5982\u679c\u6ca1\u6709\u5b9a\u4e49\u76f4\u63a5\u8df3\u8fc7\u6267\u884c\u4e0b\u4e00\u4e2a\u3002</p> </li> <li>\u5982\u679c\u5728\u7b2c\u4e00\u4e2aprocess_request\u65b9\u6cd5\u5c31\u5df2\u7ecf\u8fd4\u56de\u4e86HttpResponse\u5bf9\u8c61\uff0c\u90a3\u4e48\u54cd\u5e94\u8d70\u7684\u65f6\u5019\u4f1a\u76f4\u63a5\u8d70\u540c\u7ea7\u522b\u7684process_reponse\u8fd4\u56de\u3002</li> </ol>"},{"location":"programming/python/Django/middleware/#3-process_view","title":"3. process_view","text":"<pre><code>class MyMiddleware1(MiddlewareMixin):\n    def process_request(self, request):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_request\u65b9\u6cd5\")\n\n    def process_response(self, request, response):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_response\u65b9\u6cd5\")\n        return response\n\n    def process_view(self, request, view_name, *args, **kwargs):\n        print(view_name, args, kwargs)\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_view\u65b9\u6cd5\")\n</code></pre> <p>\u603b\u7ed3\uff1a</p> <ol> <li>\u8def\u7531\u5339\u914d\u6210\u529f\u4e4b\u540e\u6267\u884c\u89c6\u56fe\u51fd\u6570\u4e4b\u524d\uff0c\u4f1a\u81ea\u52a8\u6267\u884c\u4e2d\u95f4\u4ef6\u91cc\u9762\u7684\u65b9\u6cd5</li> <li>\u987a\u5e8f\u662f\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u518c\u7684\u4e2d\u95f4\u4ef6\u4ece\u4e0a\u5f80\u4e0b\u7684\u987a\u5e8f\u4f9d\u6b21\u6267\u884c</li> </ol>"},{"location":"programming/python/Django/middleware/#4-process_template_response","title":"4. process_template_response","text":"<pre><code>class MyMiddleware1(MiddlewareMixin):\n    def process_request(self, request):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_request\u65b9\u6cd5\")\n\n    def process_response(self, request, response):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_response\u65b9\u6cd5\")\n        return response\n\n    def process_view(self, request, view_name, *args, **kwargs):\n        print(view_name, args, kwargs)\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_view\u65b9\u6cd5\")\n\n    def process_template_response(self, request, response):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_template_response\u65b9\u6cd5\")\n        return response\n</code></pre> <p>\u89c6\u56fe\u5c42</p> <pre><code>from django.shortcuts import HttpResponse\n\n\ndef home(request):\n    print(\"\u6211\u662f\u4e3b\u9875\")\n    obj = HttpResponse('ok')\n\n    def render():\n        print('\u5185\u90e8render')\n        return HttpResponse('hello')\n    obj.render = render\n    return obj\n</code></pre> <p>\u603b\u7ed3\uff1a</p> <ol> <li>\u8fd4\u56de\u7684HttpResponse\u5bf9\u8c61\u6709render\u5c5e\u6027\u7684\u65f6\u5019\u624d\u4f1a\u89e6\u53d1</li> <li>\u987a\u5e8f\u662f\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u518c\u4e86\u7684\u4e2d\u95f4\u4ef6\u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u7ecf\u8fc7</li> </ol> <p></p>"},{"location":"programming/python/Django/middleware/#5-process_exception","title":"5. process_exception","text":"<pre><code>    def process_exception(self, request, exception):\n        print(\"\u6211\u662f\u7b2c\u4e00\u4e2a\u81ea\u5b9a\u4e49\u4e2d\u95f4\u4ef6\u7684process_exception\u65b9\u6cd5\")\n        return exception\n</code></pre> <p>\u603b\u7ed3\uff1a</p> <ol> <li>\u5f53\u89c6\u56fe\u51fd\u6570\u4e2d\u51fa\u73b0\u5f02\u5e38\u7684\u60c5\u51b5\u4e0b\u89e6\u53d1</li> <li>\u987a\u5e8f\u662f\u6309\u7167\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u518c\u4e86\u7684\u4e2d\u95f4\u4ef6\u4ece\u4e0b\u5f80\u4e0a\u4f9d\u6b21\u7ecf\u8fc7</li> </ol>"},{"location":"programming/python/Django/middleware/#csrf","title":"\u4e09\u3001CSRF","text":""},{"location":"programming/python/Django/middleware/#1-csrf","title":"1. csrf\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6821\u9a8c","text":"<p>\u7f51\u7ad9\u5728\u7ed9\u7528\u6237\u8fd4\u56de\u4e00\u4e2a\u5177\u6709\u63d0\u4ea4\u6570\u636e\u529f\u80fd\u9875\u9762\u7684\u65f6\u5019\u4f1a\u7ed9\u8fd9\u4e2a\u9875\u9762\u52a0\u4e00\u4e2a\u552f\u4e00\u6807\u8bc6\u3002\u5f53\u8fd9\u4e2a\u9875\u9762\u671d\u540e\u7aef\u53d1\u9001post\u8bf7\u6c42\u7684\u65f6\u5019 \u6211\u7684\u540e\u7aef\u4f1a\u5148\u6821\u9a8c\u552f\u4e00\u6807\u8bc6\uff0c\u5982\u679c\u552f\u4e00\u6807\u8bc6\u4e0d\u5bf9\u76f4\u63a5\u62d2\u7edd(403 forbbiden)\u5982\u679c\u6210\u529f\u5219\u6b63\u5e38\u6267\u884c \u3002</p>"},{"location":"programming/python/Django/middleware/#1_1","title":"1. \u89c6\u56fe\u51fd\u6570","text":"<pre><code>from django.shortcuts import HttpResponse, render\nfrom django.views import View\n\n\nclass Login(View):\n\n    def get(self, request):\n        return render(request, 'login.html')\n\n    def post(self, request):\n        return HttpResponse('login success')\n</code></pre>"},{"location":"programming/python/Django/middleware/#2_1","title":"2. \u8def\u7531","text":"<pre><code>from django.urls import path\n\nfrom app import views\n\napp_name = 'app'\nurlpatterns = [\n    path('login/', views.Login.as_view()),\n]\n</code></pre>"},{"location":"programming/python/Django/middleware/#3","title":"3. \u6a21\u677f\u6587\u4ef6","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767b\u5f55&lt;/title&gt;\n    {% load static %}  &lt;!--\u7c7b\u4f3c\u4e8e\u5bfc\u5165\u6a21\u5757\uff0c\u53ef\u4ee5\u52a8\u6001\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\u4e2dSTATIC_URL\u7684\u503c--&gt;\n    &lt;link rel=\"stylesheet\" href=\"{% static 'bootstrap-3.4.1-dist/css/bootstrap.min.css' %}\"&gt;\n    &lt;script src=\"{% static 'bootstrap-3.4.1-dist/js/bootstrap.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1 class=\"text-center\"&gt;\u767b\u9646&lt;/h1&gt;\n&lt;div class=\"container\"&gt;\n    &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-md-8 col-md-offset-2\"&gt;\n            &lt;form action=\"\" method=\"post\"&gt;\n                &lt;p&gt;username:&lt;input type=\"text\" name=\"username\" class=\"form-control\"&gt;&lt;/p&gt;\n                &lt;p&gt;password:&lt;input type=\"password\" name=\"password\" class=\"form-control\"&gt;&lt;/p&gt;\n                &lt;input type=\"submit\" class=\"btn btn-success btn-block\"&gt;\n            &lt;/form&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u5728\u767b\u5f55\u9875\u9762\u63d0\u4ea4<code>post</code>\u8bf7\u6c42\u65f6\u62a5\u9519</p> <p></p>"},{"location":"programming/python/Django/middleware/#4-csrf_token","title":"4. \u6dfb\u52a0<code>csrf_token</code>\u8ba4\u8bc1","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767b\u5f55&lt;/title&gt;\n    {% load static %}  &lt;!--\u7c7b\u4f3c\u4e8e\u5bfc\u5165\u6a21\u5757\uff0c\u53ef\u4ee5\u52a8\u6001\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\u4e2dSTATIC_URL\u7684\u503c--&gt;\n    &lt;link rel=\"stylesheet\" href=\"{% static 'bootstrap-3.4.1-dist/css/bootstrap.min.css' %}\"&gt;\n    &lt;script src=\"{% static 'bootstrap-3.4.1-dist/js/bootstrap.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1 class=\"text-center\"&gt;\u767b\u9646&lt;/h1&gt;\n&lt;div class=\"container\"&gt;\n    &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-md-8 col-md-offset-2\"&gt;\n            &lt;form action=\"\" method=\"post\"&gt; \n                {% csrf_token %}  &lt;!--\u6dfb\u52a0\u8ba4\u8bc1--&gt;\n                &lt;p&gt;username:&lt;input type=\"text\" name=\"username\" class=\"form-control\"&gt;&lt;/p&gt;\n                &lt;p&gt;password:&lt;input type=\"password\" name=\"password\" class=\"form-control\"&gt;&lt;/p&gt;\n                &lt;input type=\"submit\" class=\"btn btn-success btn-block\"&gt;\n            &lt;/form&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u9875\u9762\u4e0a\u4f1a\u6e32\u67d3\u9690\u85cf\u5143\u7d20</p> <pre><code>&lt;input type=\"hidden\" name=\"csrfmiddlewaretoken\" value=\"hYE9S3sc1Oxs0I2o2eTUJJylwd5WX9rEFXZT45aQ1kfhZ5G1BWkBsAOhHIISGza8\"&gt;\n</code></pre> <p></p>"},{"location":"programming/python/Django/middleware/#2_2","title":"2. \u6821\u9a8c\u65b9\u5f0f","text":""},{"location":"programming/python/Django/middleware/#21","title":"2.1 \u8868\u5355\u6821\u9a8c","text":"<pre><code>&lt;form action=\"\" method=\"post\"&gt; \n    {% csrf_token %}  &lt;!--\u6dfb\u52a0\u8ba4\u8bc1--&gt;\n    &lt;p&gt;username:&lt;input type=\"text\" name=\"username\" class=\"form-control\"&gt;&lt;/p&gt;\n    &lt;p&gt;password:&lt;input type=\"password\" name=\"password\" class=\"form-control\"&gt;&lt;/p&gt;\n    &lt;input type=\"submit\" class=\"btn btn-success btn-block\"&gt;\n&lt;/form&gt;\n</code></pre>"},{"location":"programming/python/Django/middleware/#22-ajax","title":"2.2 ajax\u6821\u9a8c","text":""},{"location":"programming/python/Django/middleware/#_4","title":"\u65b9\u5f0f\u4e00\uff1a\u5229\u7528\u6807\u7b7e\u67e5\u627e\u83b7\u53d6\u9875\u9762\u4e0a\u7684\u968f\u673a\u5b57\u7b26\u4e32","text":"<pre><code>&lt;script&gt;\n    $('#btn').click(function () {\n        $.ajax({\n            url:'',\n            type:'post',\n            // \u5229\u7528\u6807\u7b7e\u67e5\u627e\u83b7\u53d6\u9875\u9762\u4e0a\u7684\u968f\u673a\u5b57\u7b26\u4e32\n            data:{\"username\":'admin','csrfmiddlewaretoken':$('[name=csrfmiddlewaretoken]').val()},\n            success:function () {\n\n            }\n        })\n    })\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/python/Django/middleware/#_5","title":"\u65b9\u5f0f\u4e8c\uff1a\u5229\u7528\u6a21\u7248\u8bed\u6cd5\u63d0\u4f9b\u7684\u5feb\u6377\u4e66\u5199","text":"<pre><code>&lt;script&gt;\n    $('#btn').click(function () {\n        $.ajax({\n            url:'',\n            type:'post',\n            // \u5229\u7528\u6a21\u7248\u8bed\u6cd5\u63d0\u4f9b\u7684\u5feb\u6377\u4e66\u5199\n            data:{\"username\":'admin','csrfmiddlewaretoken':'{{ csrf_token }}'},\n            success:function () {\n\n            }\n        })\n    })\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/python/Django/middleware/#js","title":"\u65b9\u5f0f\u4e09\uff1a\u5bfc\u5165\u5b98\u65b9\u63d0\u4f9b\u7684js\u4ee3\u7801","text":"<p>\u4fdd\u5b58\u8de8\u57df\u6821\u9a8cjs\u4ee3\u7801\u5230js\u6587\u4ef6\u4e2d</p> <pre><code>function getCookie(name) {\n    var cookieValue = null;\n    if (document.cookie &amp;&amp; document.cookie !== '') {\n        var cookies = document.cookie.split(';');\n        for (var i = 0; i &lt; cookies.length; i++) {\n            var cookie = jQuery.trim(cookies[i]);\n            // Does this cookie string begin with the name we want?\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\n                break;\n            }\n        }\n    }\n    return cookieValue;\n}\nvar csrftoken = getCookie('csrftoken');\n\n\nfunction csrfSafeMethod(method) {\n  // these HTTP methods do not require CSRF protection\n  return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));\n}\n\n$.ajaxSetup({\n  beforeSend: function (xhr, settings) {\n    if (!csrfSafeMethod(settings.type) &amp;&amp; !this.crossDomain) {\n      xhr.setRequestHeader(\"X-CSRFToken\", csrftoken);\n    }\n  }\n});\n</code></pre> <p>\u5728HTML\u4e2d\u5bfc\u5165\u4e0a\u8ff0js\u6587\u4ef6</p> <pre><code>&lt;script src=\"{% static 'js/csrftoken.js'%}\"&gt;&lt;/script&gt;\n&lt;script&gt;\n    $('#btn').click(function () {\n        $.ajax({\n            url:'',\n            type:'post',\n            // \u76f4\u63a5\u62f7\u8d1djs\u4ee3\u7801\u5e76\u5e94\u7528\u5230\u81ea\u5df1\u7684html\u9875\u9762\u4e0a\u5373\u53ef\n            data:{\"username\":'admin'}, \n            success:function () {\n\n            }\n        })\n    })\n&lt;/script&gt;\n</code></pre>"},{"location":"programming/python/Django/middleware/#3-csrf","title":"3. csrf\u88c5\u9970\u5668","text":"<pre><code>from django.views.decorators.csrf import csrf_protect,csrf_exempt\n\n# csrf_protect  \u9700\u8981\u6821\u9a8c\n#    \u9488\u5bf9csrf_protect\u7b26\u5408\u6211\u4eec\u4e4b\u524d\u6240\u5b66\u7684\u88c5\u9970\u5668\u7684\u4e09\u79cd\u73a9\u6cd5\n# csrf_exempt   \u5ffd\u89c6\u6821\u9a8c\n#    \u9488\u5bf9csrf_exempt\u53ea\u80fd\u7ed9dispatch\u65b9\u6cd5\u52a0\u624d\u6709\u6548\n</code></pre>"},{"location":"programming/python/Django/middleware/#31-fbv","title":"3.1 FBV\u88c5\u9970","text":"<pre><code># @csrf_exempt\n# @csrf_protect\ndef transfer(request):\n    return render(request,'transfer.html')\n</code></pre>"},{"location":"programming/python/Django/middleware/#32-cbv","title":"3.2 CBV\u88c5\u9970","text":"<pre><code>from django.views import View\nfrom django.utils.decorators import method_decorator\n\n\n# @method_decorator(csrf_protect,name='post')  # csrf_protect \u5728\u6b64\u5904\u751f\u6548\n# @method_decorator(csrf_exempt,name='post')  # csrf_exempt \u5728\u6b64\u5904\u4e0d\u751f\u6548\n@method_decorator(csrf_exempt,name='dispatch')\nclass MyCsrfToken(View):\n    # @method_decorator(csrf_protect)  # csrf_protect \u5728\u6b64\u5904\u751f\u6548\n    # @method_decorator(csrf_exempt)  # csrf_exempt \u5728\u6b64\u5904\u751f\u6548\n    def dispatch(self, request, *args, **kwargs):\n        return super(MyCsrfToken, self).dispatch(request,*args,**kwargs)\n\n    def get(self,request):\n        return HttpResponse('get')\n\n    # @method_decorator(csrf_protect)  # csrf_protect \u5728\u6b64\u5904\u751f\u6548\n    # @method_decorator(csrf_exempt)  # csrf_exempt \u5728\u6b64\u5904\u4e0d\u751f\u6548\n    def post(self,request):\n        return HttpResponse('post')\n</code></pre>"},{"location":"programming/python/Django/model/","title":"\u6a21\u578b\u5c42","text":""},{"location":"programming/python/Django/model/#_2","title":"\u4e00\u3001\u8fde\u63a5\u6570\u636e\u5e93","text":""},{"location":"programming/python/Django/model/#1","title":"1. \u521b\u5efa\u6570\u636e\u5e93","text":"<pre><code>CREATE DATABASE test CHARSET utf8;\n# \u6388\u6743\nGRANT ALL ON test.* TO 'admin'@'10.0.0.%' IDENTIFIED BY 'admin@123';\n</code></pre>"},{"location":"programming/python/Django/model/#2","title":"2. \u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":""},{"location":"programming/python/Django/model/#1-mysitesettingpymysql","title":"1. \u5728<code>mysite/setting.py</code>\u6587\u4ef6\u4e2d\u6307\u5b9a<code>mysql</code>\u6570\u636e\u5e93\u7684\u76f8\u5173\u4fe1\u606f","text":"<pre><code>DATABASES = {\n    'default': {\n        'ENGINE': 'django.db.backends.mysql',\n        'NAME': 'test',\n        'USER': 'admin',\n        'PASSWORD': 'admin@123',\n        'HOST': '10.0.0.128',\n        'PORT': 3306,\n        'CHARSET': 'utf8'\n    }\n}\n\nLOGGING = {\n    'version': 1,\n    'disable_existing_loggers': False,\n    'handlers': {\n        'console':{\n            'level':'DEBUG',\n            'class':'logging.StreamHandler',\n        },\n    },\n    # \u5728\u63a7\u5236\u53f0\u6253\u5370ORM\u6267\u884c\u7684SQL\u8bed\u53e5\n    'loggers': {\n        'django.db.backends': {\n            'handlers': ['console'],\n            'propagate': True,\n            'level':'DEBUG',\n        },\n    }\n}\n</code></pre>"},{"location":"programming/python/Django/model/#2-mysql","title":"2. \u4fee\u6539\u9ed8\u8ba4\u7684<code>mysql</code>\u6a21\u5757","text":"<p>\u5728<code>mysite/__init__.py</code>\u4e2d\u4fee\u6539\u8fde\u63a5<code>mysql</code>\u7684\u6a21\u5757</p> <pre><code>import pymysql\n\npymysql.install_as_MySQLdb()\n</code></pre>"},{"location":"programming/python/Django/model/#3-pymysql","title":"3. \u5b89\u88c5<code>pymysql</code>\u6a21\u5757","text":"<pre><code>pip3 install pymysql\n</code></pre>"},{"location":"programming/python/Django/model/#3","title":"3. \u521b\u5efa\u8868","text":"<pre><code>#filename: models.py\nfrom django.db import models\n\n\n# Create your models here.\nclass User(models.Model):\n    id = models.AutoField(primary_key=True)\n    username = models.CharField(max_length=32)\n    age = models.IntegerField()\n</code></pre>"},{"location":"programming/python/Django/model/#4","title":"4.  \u8fc1\u79fb\u6570\u636e\u5e93","text":"<pre><code># \u4e8e\u5728\u8be5app\u4e0b\u5efa\u7acbmigrations\u76ee\u5f55\uff0c\u5e76\u8bb0\u5f55\u6240\u6709\u7684\u5173\u4e8emodes.py\u7684\u6539\u52a8\n# \u6bd4\u59820001_initial.py\uff0c \u4f46\u662f\u8fd9\u4e2a\u6539\u52a8\u8fd8\u6ca1\u6709\u4f5c\u7528\u5230\u6570\u636e\u5e93\u6587\u4ef6\npython manage.py makemigrations\n# \u5c06\u5bf9\u6570\u636e\u5e93\u7684\u66f4\u6539\u5728\u6570\u636e\u5e93\u4e2d\u771f\u5b9e\u6267\u884c\u3002\npython manage.py migrate\n</code></pre>"},{"location":"programming/python/Django/model/#_3","title":"\u4e8c\u3001\u521b\u5efa\u8868","text":"<p><code>ORM</code>\u521b\u5efa\u7684\u8868\u81ea\u52a8\u52a0\u4e86\u524d\u7f00\uff0c\u524d\u7f00\u662f\u5e94\u7528\u7684\u540d\u79f0\uff0c\u9632\u6b62\u591a\u4e2a\u5e94\u7528\u8868\u540d\u51b2\u7a81\u3002</p>"},{"location":"programming/python/Django/model/#1_1","title":"1. \u72ec\u7acb\u8868","text":"<pre><code>#filename: models.py\nfrom django.db import models\n\n\n# Create your models here.\nclass User(models.Model):\n    id = models.AutoField(primary_key=True)\n    username = models.CharField(max_length=32)\n    age = models.IntegerField()\n</code></pre>"},{"location":"programming/python/Django/model/#2_1","title":"2. \u5173\u7cfb\u8868","text":"<p>\u8868\u4e0e\u8868\u4e4b\u95f4\u7684\u5173\u7cfb\uff1a</p> <ol> <li>\u4e00\u5bf9\u4e00\uff1a<code>models.OneToOneField()</code></li> <li>\u4e00\u5bf9\u591a\uff1a<code>models.ForeignKey()</code></li> <li>\u591a\u5bf9\u591a\uff1a<code>models.ManyToManyField()</code></li> <li>\u6ca1\u6709\u5173\u7cfb</li> </ol> <p>\u521b\u5efa\u8868\u5173\u7cfb\u5148\u5c06\u57fa\u8868\u521b\u5efa\u51fa\u6765\uff0c\u7136\u540e\u518d\u6dfb\u52a0\u5916\u952e\u5b57\u6bb5\u3002</p> <p></p> <pre><code>#filename: models.py\nclass Book(models.Model):\n    title = models.CharField(max_length=32, verbose_name=\"\u4e66\u540d\")\n    price = models.DecimalField(max_digits=8, decimal_places=2, verbose_name=\"\u4ef7\u683c\")\n    # \u56fe\u4e66\u548c\u51fa\u7248\u793e\u662f\u4e00\u5bf9\u591a\uff0c\u5e76\u4e14\u4e66\u662f\u591a\u7684\u4e00\u65b9\uff0c\u6240\u4ee5\u5916\u952e\u5b57\u6bb5\u653e\u5728Book\u8868\u91cc\u9762\n    # \u9ed8\u8ba4\u5c31\u662f\u4e0e\u51fa\u7248\u793e\u8868\u7684\u4e3b\u952e\u5b57\u6bb5\u505a\u5916\u952e\u5173\u8054\n    # \u5982\u679c\u5b57\u6bb5\u5bf9\u5e94\u7684\u662fForeignKey \u90a3\u4e48\u4f1aorm\u4f1a\u81ea\u52a8\u5728\u5b57\u6bb5\u7684\u540e\u9762\u52a0_id\uff0c\u5982\u679c\u81ea\u5df1\u52a0\u4e86_id\u90a3\u4e48orm\u8fd8\u662f\u4f1a\u5728\u540e\u9762\u7ee7\u7eed\u52a0_id\n    publish = models.ForeignKey(to='Publish')\n\n    # \u56fe\u4e66\u548c\u4f5c\u8005\u662f\u591a\u5bf9\u591a\u7684\u5173\u7cfb\uff0c\u5916\u952e\u5b57\u6bb5\u5efa\u5728\u4efb\u610f\u4e00\u65b9\u5747\u53ef\uff0c\u4f46\u662f\u63a8\u8350\u5efa\u5728\u67e5\u8be2\u9891\u7387\u8f83\u9ad8\u7684\u4e00\u65b9\n    # authors\u662f\u4e00\u4e2a\u865a\u62df\u5b57\u6bb5\uff0c\u5e76\u4e0d\u4f1a\u5728\u6570\u636e\u5e93\u4e2d\u521b\u5efa\u8fd9\u4e2a\u5b57\u6bb5\uff0c\u4e3b\u8981\u662f\u7528\u6765\u544a\u8bc9orm\u4e66\u7c4d\u8868\u548c\u4f5c\u8005\u8868\u662f\u591a\u5bf9\u591a\u5173\u7cfb\uff0c\u8ba9orm\u81ea\u52a8\u5e2e\u4f60\u521b\u5efa\u7b2c\u4e09\u5f20\u5173\u7cfb\u8868\n    authors = models.ManyToManyField(to='Author')\n\n\nclass Publish(models.Model):\n    name = models.CharField(max_length=32, verbose_name=\"\u51fa\u7248\u793e\u540d\u79f0\")\n    addr = models.CharField(max_length=64, verbose_name=\"\u901a\u8baf\u5730\u5740\")\n\n\nclass Author(models.Model):\n    name = models.CharField(max_length=32, verbose_name=\"\u4f5c\u8005\u59d3\u540d\")\n    age = models.IntegerField(verbose_name=\"\u5e74\u9f84\")\n    # \u4f5c\u8005\u4e0e\u4f5c\u8005\u8be6\u60c5\u662f\u4e00\u5bf9\u4e00\u7684\u5173\u7cfb,\u5916\u952e\u5b57\u6bb5\u5efa\u5728\u4efb\u610f\u4e00\u65b9\u90fd\u53ef\u4ee5,\u4f46\u662f\u63a8\u8350\u5efa\u5728\u67e5\u8be2\u9891\u7387\u8f83\u9ad8\u7684\u8868\u4e2d\n    # OneToOneField\u4e5f\u4f1a\u81ea\u52a8\u7ed9\u5b57\u6bb5\u52a0_id\u540e\u7f00\n    author_detail = models.OneToOneField(to='AuthorDetail')\n\n\nclass AuthorDetail(models.Model):\n    email = models.EmailField(verbose_name=\"\u90ae\u7bb1\")\n    addr = models.CharField(max_length=32, verbose_name=\"\u901a\u8baf\u5730\u5740\")\n</code></pre> <p>\u5728<code>django1.X</code>\u7248\u672c\u4e2d\u5916\u952e\u9ed8\u8ba4\u90fd\u662f\u7ea7\u8054\u66f4\u65b0\u5220\u9664\u7684</p>"},{"location":"programming/python/Django/model/#3_1","title":"3. \u591a\u5bf9\u591a\u4e09\u79cd\u521b\u5efa\u65b9\u5f0f","text":""},{"location":"programming/python/Django/model/#1_2","title":"1. \u5168\u81ea\u52a8","text":"<p>\u81ea\u52a8\u521b\u5efa\u7b2c\u4e09\u5f20\u5173\u7cfb\u8868\uff0c\u4f46\u662f\u6269\u5c55\u6027\u5dee\uff0c\u6ca1\u6709\u529e\u6cd5\u6dfb\u52a0\u989d\u5916\u5b57\u6bb5\u3002\u53ef\u4ee5\u7528<code>ORM</code>\u63d0\u4f9b\u7684\u7b2c\u4e09\u5f20\u5173\u7cfb\u8868\u7684\u65b9\u6cd5\uff0c\u5982add,remove,clear,set\u7b49\u65b9\u6cd5\u3002</p>"},{"location":"programming/python/Django/model/#2_2","title":"2. \u5168\u624b\u52a8","text":"<p>\u81ea\u5df1\u521b\u5efa\u7b2c\u4e09\u5f20\u8868\uff0c\u81ea\u5df1\u5efa\u5916\u952e\u3002\u6269\u5c55\u6027\u9ad8\uff0c\u4f46\u662f\u65e0\u6cd5\u5229\u7528<code>ORM</code>\u63d0\u4f9b\u7684\u7b80\u4fbf\u7684\u67e5\u8be2\u65b9\u6cd5\u3002</p> <pre><code>class Book(models.Model):\n    name = models.CharField(max_length=32)\n\nclass Author(models.Model):\n    name = models.CharField(max_length=32)\n\nclass Book2Author(models.Model):\n    book_id = models.ForeignKey(to='Book')\n    author_id = models.ForeignKey(to='Author')\n</code></pre>"},{"location":"programming/python/Django/model/#3_2","title":"3. \u534a\u81ea\u52a8","text":"<p>\u5b9e\u9645\u9879\u76ee\u7528\u6b64\u65b9\u6cd5\uff0c\u6269\u5c55\u6027\u597d\u3002\u53ef\u4ee5\u4f7f\u7528<code>ORM</code>\u7684\u6b63\u53cd\u5411\u67e5\u8be2\uff0c\u4f46\u662f\u6ca1\u6cd5\u4f7f\u7528add,set,remove,clear\u8fd9\u56db\u4e2a\u65b9\u6cd5</p> <pre><code>class Book(models.Model):\n    name = models.CharField(max_length=32)\n    authors = models.ManyToManyField(to='Author',\n                                     through='Book2Author', # \u544a\u8bc9ORM\u901a\u8fc7Book2Author\u6765\u5173\u8054\u5173\u7cfb\n                                     through_fields=('book','author') # \u544a\u8bc9ORM\u54ea\u4e24\u4e2a\u5b57\u6bb5\u6765\u786e\u5b9a\u5173\u8054\u5173\u7cfb\uff08\u901a\u8fc7\u7b2c\u4e09\u5f20\u8868\u67e5\u8be2\u5f53\u524dBOOK\u8868\u662f\u901a\u8fc7book\u5b57\u6bb5\uff0c\u6240\u4ee5book\u5b57\u6bb5\u5728\u524d\uff0cauthor\u5728\u540e\uff09\n                                     )\nclass Author(models.Model):\n    name = models.CharField(max_length=32)\n\n\nclass Book2Author(models.Model):\n    book = models.ForeignKey(to='Book')\n    author = models.ForeignKey(to='Author')\n</code></pre>"},{"location":"programming/python/Django/model/#orm","title":"\u4e09\u3001<code>ORM</code>\u64cd\u4f5c","text":""},{"location":"programming/python/Django/model/#1_3","title":"1. \u589e","text":""},{"location":"programming/python/Django/model/#11","title":"1.1 \u5355\u8868","text":""},{"location":"programming/python/Django/model/#111-create","title":"1.1.1 \u65b9\u6cd5\u4e00\uff1a<code>create()</code>","text":"<pre><code># \u65b9\u5f0f1\uff1a\u76f4\u63a5\u4f20\u503c\n    models.User.objects.create(username='Eric', age=16)\n# \u65b9\u5f0f2\uff1a\u4f20\u5165\u4e00\u4e2a\u5b57\u5178\n    user = {\n        'username': 'Ron',\n        'age': 18,\n    }\n    models.User.objects.create(**user)\n</code></pre>"},{"location":"programming/python/Django/model/#112-save","title":"1.1.2 \u65b9\u6cd5\u4e8c\uff1a<code>save()</code>","text":"<pre><code># \u65b9\u5f0f1\uff1a\u521b\u5efa\u5bf9\u8c61\u65f6\u8d4b\u503c\n    user_obj = models.User(username='Jack', age=16)\n    user_obj.save()\n# \u65b9\u5f0f2\uff1a\u5148\u521b\u5efa\u5bf9\u8c61\uff0c\u7136\u540e\u8d4b\u503c\u4fdd\u5b58\n    user_obj = models.User()\n    user_obj.username = 'John'\n    user_obj.age = 17\n    user_obj.save()\n</code></pre>"},{"location":"programming/python/Django/model/#12","title":"1.2 \u591a\u8868","text":""},{"location":"programming/python/Django/model/#121","title":"1.2.1 \u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a","text":"<p>\u65b9\u5f0f\u4e00\uff1a\u76f4\u63a5\u5199\u5916\u952e\u5b57\u6bb5id</p> <pre><code>models.Book.objects.create(title='\u6570\u636e\u7ed3\u6784C\u8bed\u8a00\u7248', price=35.00, publish_id=1)\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7\u5bf9\u8c61\u521b\u5efa</p> <pre><code>publish_obj = models.Publish.objects.filter(pk=1).first()  # Publish object\nmodels.Book.objects.create(title='\u6570\u636e\u7ed3\u6784\u9898\u96c6C\u8bed\u8a00\u7248', price=29.0, publish=publish_obj)\n</code></pre>"},{"location":"programming/python/Django/model/#122","title":"1.2.2 \u591a\u5bf9\u591a","text":"<p>\u65b9\u5f0f\u4e00\uff1a\u901a\u8fc7\u4e3b\u952e\u503c\u6dfb\u52a0</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nbook_obj.authors.add(2, 3)   # book_obj.authors\u76f8\u5f53\u4e8e\u5df2\u7ecf\u5b9a\u4f4d\u5230\u7b2c\u4e09\u5f20\u5173\u7cfb\u8868\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7\u5bf9\u8c61\u6dfb\u52a0</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nauthor_obj1 = models.Author.objects.filter(pk=2).first()\nauthor_obj2 = models.Author.objects.filter(pk=3).first()\nbook_obj.authors.add(author_obj1, author_obj2)\n</code></pre>"},{"location":"programming/python/Django/model/#13-bulk_create","title":"1.3 \u6279\u91cf\u63d2\u5165<code>bulk_create()</code>","text":"<pre><code>book_list = []\nfor i in range(5):\n    book_obj = models.Book(title='\u7b2c%s\u672c\u4e66' % i, price=20, publish_id=1)\n    book_list.append(book_obj)\nmodels.Book.objects.bulk_create(book_list)\n# \u6267\u884c\u7684SQL:INSERT INTO `app_book` (`title`, `price`, `publish_id`) VALUES ('\u7b2c0\u672c\u4e66', '20.00', 1), ('\u7b2c1\u672c\u4e66', '20.00', 1), ('\u7b2c2\u672c\u4e66', '20.00', 1), ('\u7b2c3\u672c\u4e66', '20.00', 1), ('\u7b2c4\u672c\u4e66', '20.00', 1);\n</code></pre>"},{"location":"programming/python/Django/model/#2_3","title":"2. \u67e5","text":"<p>\u8fd4\u56de\u7684\u7ed3\u679c\u662f\u4e00\u4e2a<code>QuerySet</code>\u5bf9\u8c61\uff0c\u53ef\u4ee5\u628a\u5b83\u770b\u6210\u662f\u4e00\u4e2a\u5217\u8868\u5957\u6570\u636e\u5bf9\u8c61\u3002\u652f\u6301\u7d22\u5f15\u548c\u5207\u7247\u64cd\u4f5c\uff0c\u4f46\u662f\u4e0d\u652f\u6301\u8d1f\u6570\uff0c\u5e76\u4e14\u4e0d\u63a8\u8350\u4f7f\u7528\u7d22\u5f15\u3002</p> <p>\u6b63\u53cd\u5411\u67e5\u8be2\uff1a</p> <ol> <li>\u6b63\u5411\u67e5\u8be2\uff1a\u4ece\u6709\u5916\u952e\u5b57\u6bb5\u7684\u8868\u5411\u6ca1\u6709\u5916\u952e\u5b57\u6bb5\u7684\u8868\u67e5</li> <li>\u53cd\u5411\u67e5\u8be2\uff1a\u4ece\u6ca1\u6709\u5916\u952e\u5b57\u6bb5\u7684\u8868\u5411\u6709\u5916\u952e\u5b57\u6bb5\u7684\u8868\u67e5\u8be2</li> </ol> <p>\u6b63\u5411\u67e5\u8be2\u6309\u5b57\u6bb5\uff0c\u53cd\u5411\u67e5\u8be2\u6309\u8868\u540d\u5c0f\u5199</p>"},{"location":"programming/python/Django/model/#21","title":"2.1 \u5355\u8868\u67e5\u8be2","text":""},{"location":"programming/python/Django/model/#211","title":"2.1.1 \u67e5\u8be2\u6240\u6709\u6570\u636e","text":"<pre><code># \u65b9\u5f0f1\uff1a    \n    user_obj = models.User.objects.filter()\n    print(user_obj)\n# \u65b9\u5f0f2\uff1a    \n    user_obj = models.User.objects.all()\n    print(user_obj)\n</code></pre>"},{"location":"programming/python/Django/model/#212","title":"2.1.2 \u6309\u6761\u4ef6\u7b5b\u9009","text":"<p><code>filter</code>\u62ec\u53f7\u5185\u53ef\u4ee5\u5199\u591a\u4e2a\u53c2\u6570\uff0c\u67e5\u8be2\u7684\u65f6\u5019\u9ed8\u8ba4\u662fand\u5173\u7cfb</p> <pre><code>    user_obj = models.User.objects.filter(age=16)\n    print(user_obj) # &lt;QuerySet [&lt;User: User object&gt;]&gt;\n    user_obj = models.User.objects.get(age=16)\n    print(user_obj) # User object\n    # get\u65b9\u6cd5\u8fd4\u56de\u7684\u76f4\u63a5\u5c31\u662f\u5f53\u524d\u6570\u636e\u5bf9\u8c61\uff0c\u4f46\u662f\u5982\u679c\u6570\u636e\u4e0d\u5b58\u5728\u8be5\u65b9\u6cd5\u4f1a\u76f4\u63a5\u62a5\u9519\u3002\u800cfilter\u5219\u4e0d\u4f1a\uff0c\u6240\u4ee5\u5efa\u8bae\u4f7f\u7528filter\n</code></pre> <pre><code>user_obj = models.User.objects.filter(pk=2)\npk\u4f1a\u81ea\u52a8\u67e5\u627e\u5230\u5f53\u524d\u8868\u7684\u4e3b\u952e\u5b57\u6bb5,\u6307\u4ee3\u7684\u5c31\u662f\u5f53\u524d\u8868\u7684\u4e3b\u952e\u5b57\u6bb5.\u7528\u4e86pk\u4e4b\u540e\u5c31\u4e0d\u9700\u8981\u77e5\u9053\u5f53\u524d\u8868\u7684\u4e3b\u952e\u5b57\u6bb5\u5177\u4f53\u7684\u540d\u5b57\u53ef\u3002\n</code></pre>"},{"location":"programming/python/Django/model/#213","title":"2.1.3 \u67e5\u8be2\u7ed3\u679c\u518d\u5904\u7406","text":"<pre><code>order_by()        \u3000# \u5bf9\u7ed3\u679c\u6392\u5e8f\nreverse()        \u3000 # \u5bf9\u67e5\u8be2\u7ed3\u679c\u53cd\u5411\u6392\u5e8f,\u524d\u63d0\u662f\u6570\u636e\u5df2\u7ecf\u6392\u8fc7\u5e8f\nexists()        \u3000\u3000# \u5982\u679cQuerySet\u5305\u542b\u6570\u636e\uff0c\u5c31\u8fd4\u56deTrue\uff0c\u5426\u5219\u8fd4\u56deFalse\ndistinct()      \u3000\u3000# \u4ece\u8fd4\u56de\u7ed3\u679c\u4e2d\u5254\u9664\u91cd\u590d\u7eaa\u5f55\nvalues()        \u3000\u3000# \u8fd4\u56de\u5b57\u5178\u5e8f\u5217\uff0c\u6bcf\u4e00\u884c\u7684\u6570\u636e\u4ee5\u5b57\u5178\u7684\u5f62\u5f0f\u8fd4\u56de\nvalues_list()   \u3000\u3000# \u8fd4\u56de\u5143\u7ec4\u5e8f\u5217\uff0c\u6bcf\u4e00\u884c\u7684\u6570\u636e\u4ee5\u5143\u7ec4\u7684\u5f62\u5f0f\u8fd4\u56de\ncount()             # \u8fd4\u56de\u6570\u636e\u5e93\u4e2d\u5339\u914d\u67e5\u8be2(QuerySet)\u7684\u5bf9\u8c61\u6570\u91cf\u3002\nfirst()            # \u8fd4\u56de\u7b2c\u4e00\u6761\u8bb0\u5f55\nlast()             # \u8fd4\u56de\u6700\u540e\u4e00\u6761\u8bb0\u5f55\n</code></pre>"},{"location":"programming/python/Django/model/#214","title":"2.1.4 \u6761\u4ef6\u8fc7\u6ee4","text":"<pre><code>    res = models.User.objects.filter(age__gt=16)\n    print(res) # &lt;QuerySet [&lt;User: User object&gt;, &lt;User: User object&gt;]&gt;\n</code></pre> <p>\u5e38\u7528\u6761\u4ef6</p> <pre><code>__gt    # \u5927\u4e8e\n__lt    # \u5c0f\u4e8e\n__gte   # \u5927\u4e8e\u6216\u5c0f\u4e8e\n__lte   # \u5c0f\u4e8e\u6216\u7b49\u4e8e\n__contains # \u5305\u542b\uff0c\u5bf9\u5927\u5c0f\u5199\u654f\u611f\n__icontains # \u5305\u542b\uff0c\u5bf9\u5927\u5c0f\u5199\u4e0d\u654f\u611f\n__startwith \n__endwith\n__istartwith \n__iendwith\n__in=[] \n__range[start,end]  # \u5728start\u548cend\u4e4b\u95f4\uff0c\u5305\u542bstart\u548cend\n__isnull\n</code></pre>"},{"location":"programming/python/Django/model/#22","title":"2.2 \u591a\u8868\u67e5\u8be2","text":""},{"location":"programming/python/Django/model/#221","title":"2.2.1 \u57fa\u4e8e\u5bf9\u8c61\u7684\u8de8\u8868\u67e5\u8be2","text":""},{"location":"programming/python/Django/model/#1_4","title":"1. \u6b63\u5411\u67e5\u8be2","text":"<pre><code># \u67e5\u8be2\u4e66\u7c4d\u4e3b\u952e\u4e3a1\u7684\u51fa\u7248\u793e\nbook_obj = models.Book.objects.filter(pk=1).first()\nres = book_obj.publish\nprint(res) # Publish object\nprint(res.name) # \u6e05\u534e\u5927\u5b66\u51fa\u7248\u793e\n# \u67e5\u8be2\u4e66\u7c4d\u4e3b\u952e\u4e3a2\u7684\u4f5c\u8005\nbook_obj = models.Book.objects.filter(pk=1).first()\nres = book_obj.authors.all()\nprint(res) # &lt;QuerySet [&lt;Author: Author object&gt;, &lt;Author: Author object&gt;]&gt;\n</code></pre>"},{"location":"programming/python/Django/model/#2_4","title":"2. \u53cd\u5411\u67e5\u8be2","text":"<pre><code># \u67e5\u8be2\u4e3b\u952e\u4e3a1\u7684\u51fa\u7248\u793e\u51fa\u7248\u7684\u4e66\npublish_obj = models.Publish.objects.filter(pk=1).first()\nres = publish_obj.book_set.all()\nprint(res) # &lt;QuerySet [&lt;Book: Book object&gt;, &lt;Book: Book object&gt;]&gt;\n\nauthor_detail_obj = models.AuthorDetail.objects.filter(addr__contains='\u6e05\u534e\u5927\u5b66').first()\nres = author_detail_obj.author\nprint(res.name)\n</code></pre> <p>\u57fa\u4e8e\u5bf9\u8c61\u53cd\u5411\u67e5\u8be2\u7684\u65f6\u5019\uff1a\u5f53\u67e5\u8be2\u7ed3\u679c\u53ef\u4ee5\u6709\u591a\u4e2a\u7684\u65f6\u5019\u5c31\u5fc5\u987b\u52a0<code>_set.all()</code>\uff1b\u5f53\u7684\u7ed3\u679c\u53ea\u6709\u4e00\u4e2a\u7684\u65f6\u5019\u4e0d\u9700\u8981\u52a0<code>_set.all()</code></p>"},{"location":"programming/python/Django/model/#222","title":"2.2.2 \u57fa\u4e8e\u53cc\u4e0b\u5212\u7ebf\u7684\u8de8\u8868\u67e5\u8be2","text":""},{"location":"programming/python/Django/model/#1_5","title":"1. \u6b63\u5411\u67e5\u8be2","text":"<pre><code># \u67e5\u4f5c\u8005\u8be6\u60c5\nres = models.Author.objects.filter(name='\u4e25\u851a\u654f').values('author_detail__email ', 'name') # \u5c0f\u5199\u7b2c\u4e09\u5f20\u8868\u540d__\u5b57\u6bb5\u540d\nprint(res) # &lt;QuerySet [{'author_detail__email': 'yanweimin@126.com', 'name': '\u4e25\u851a\u654f'}]&gt;\n\n# \u8fde\u7eed\u8de8\u8868\u67e5\u4e66\u7c4d\u4e3b\u952e\u662f1\u7684\u4f5c\u8005\u7684\u90ae\u7bb1\n# book--&gt;\u4e2d\u95f4\u8868--&gt;author_detail\nres = models.Book.objects.filter(pk=1).values('authors__author_detail__email')\nprint(res) # &lt;QuerySet [{'authors__author_detail__email': 'yanweimin@126.com'}, {'authors__author_detail__email': 'wuweimin@163.com'}]&gt;\n</code></pre>"},{"location":"programming/python/Django/model/#2_5","title":"2. \u53cd\u5411\u67e5\u8be2","text":"<pre><code># \u67e5\u4f5c\u8005\u8be6\u60c5\nres = models.AuthorDetail.objects.filter(author__name='\u4e25\u851a\u654f').values('email', 'author__name')\nprint(res) # &lt;QuerySet [{'email': 'yanweimin@126.com', 'author__name': '\u4e25\u851a\u654f'}]&gt;\n</code></pre>"},{"location":"programming/python/Django/model/#23-aggregateannotate","title":"2.3 \u805a\u5408\u67e5\u8be2\uff08<code>aggregate</code>\uff09\u548c\u5206\u7ec4\u67e5\u8be2\uff08<code>annotate</code>\uff09","text":"<p>\u805a\u5408\u67e5\u8be2\u901a\u5e38\u60c5\u51b5\u4e0b\u90fd\u662f\u914d\u5408\u5206\u7ec4\u4e00\u8d77\u4f7f\u7528\u7684</p> <pre><code>from django.db.models import Max, Min, Sum, Count, Avg\n\nres = models.Book.objects.annotate(author_num=Count('authors')).values('title', 'author_num')  # author_num\u76f8\u5f53\u4e8e\u5b57\u6bb5\u7684\u522b\u540d\nprint(res)\nres = models.Book.objects.aggregate(Max('price'), Min('price'), Sum('price'), Count('pk'), Avg('price'))\nprint(res) # {'price__max': Decimal('35.00'), 'price__min': Decimal('29.00'), 'price__sum': Decimal('64.00'), 'pk__count': 2, 'price__avg': 32.0}\n</code></pre>"},{"location":"programming/python/Django/model/#25-f","title":"2.5 F\u67e5\u8be2","text":"<p>\u80fd\u591f\u76f4\u63a5\u83b7\u53d6\u5230\u8868\u4e2d\u67d0\u4e2a\u5b57\u6bb5\u5bf9\u5e94\u7684\u6570\u636e</p>"},{"location":"programming/python/Django/model/#1_6","title":"1.  \u52a0\u3001\u51cf\u3001\u4e58\u3001\u9664\u3001\u53d6\u6a21\u4ee5\u53ca\u5e42\u8fd0\u7b97\u7b49\u7b97\u672f\u64cd\u4f5c","text":"<pre><code>from django.db.models import F\n\nres = models.Book.objects.update(price=F('price') - 5)\nprint(res) # \u6267\u884c\u7684SQL\uff1aUPDATE `app_book` SET `price` = (`app_book`.`price` - 5);\n</code></pre>"},{"location":"programming/python/Django/model/#2_6","title":"2.  \u62fc\u63a5\u5b57\u7b26\u4e32","text":"<pre><code>from django.db.models import F\nfrom django.db.models.functions import Concat\nfrom django.db.models import Value\n\nmodels.Book.objects.update(title=Concat(F('title'), Value('(\u70ed\u9500)')))\n# \u5982\u679c\u4e0d\u7528concat\uff0c\u5b57\u6bb5\u4e0b\u6240\u6709\u503c\u90fd\u4f1a\u53d8\u4e3a\u7a7a\n</code></pre>"},{"location":"programming/python/Django/model/#26-q","title":"2.6 Q\u67e5\u8be2","text":"<p>\u5b9e\u73b0\u590d\u6742\u7684\u6761\u4ef6\u67e5\u8be2</p> <pre><code>from django.db.models import Q\n\nres = models.Book.objects.filter(Q(price__gt=20), Q(price__lt=30))  # Q\u5305\u88f9\u9017\u53f7\u5206\u5272 \u8fd8\u662fand\u5173\u7cfb\nprint(res)  # &lt;QuerySet [&lt;Book: Book object&gt;]&gt;\nres = models.Book.objects.filter(Q(price__gt=30) | Q(price__lt=20))  # | or\u5173\u7cfb\nprint(res)  # &lt;QuerySet [&lt;Book: Book object&gt;]&gt;\nres = models.Book.objects.filter(~Q(price__gt=30))  # ~ not\u5173\u7cfb\nprint(res)  # # &lt;QuerySet [&lt;Book: Book object&gt;]&gt;\n# \u5bf9\u5e94\u7684SQL\n# SELECT `app_book`.`id`, `app_book`.`title`, `app_book`.`price`, `app_book`.`publish_id` FROM `app_book` WHERE (`app_book`.`price` &gt; 20 AND `app_book`.`price` &lt; 30) LIMIT 21;\n# SELECT `app_book`.`id`, `app_book`.`title`, `app_book`.`price`, `app_book`.`publish_id` FROM `app_book` WHERE (`app_book`.`price` &gt; 30 OR `app_book`.`price` &lt; 20) LIMIT 21;\n# SELECT `app_book`.`id`, `app_book`.`title`, `app_book`.`price`, `app_book`.`publish_id` FROM `app_book` WHERE NOT (`app_book`.`price` &gt; 30) LIMIT 21;\n</code></pre> <p>Q\u7684\u9ad8\u9636\u7528\u6cd5\uff1a\u80fd\u591f\u5c06\u67e5\u8be2\u6761\u4ef6\u7684\u5de6\u8fb9\u4e5f\u53d8\u6210\u5b57\u7b26\u4e32\u7684\u5f62\u5f0f</p> <pre><code>from django.db.models import Q\n\nq = Q()\nq.connector = 'and' # \u5982\u679c\u4e0d\u6307\u5b9a\u8fde\u63a5\u7236\uff0c\u9ed8\u8ba4\u662fand\u5173\u7cfb\nq.children.append(('price__gt', 20))\nq.children.append(('price__lt', 30))\nres = models.Book.objects.filter(q)  \nprint(res) # &lt;QuerySet [&lt;Book: Book object&gt;]&gt;\n# SELECT `app_book`.`id`, `app_book`.`title`, `app_book`.`price`, `app_book`.`publish_id` FROM `app_book` WHERE (`app_book`.`price` &gt; 20 and `app_book`.`price` &lt; 30) LIMIT 21;\n</code></pre>"},{"location":"programming/python/Django/model/#3_3","title":"3. \u6539","text":""},{"location":"programming/python/Django/model/#31","title":"3.1 \u5355\u8868","text":""},{"location":"programming/python/Django/model/#31-update","title":"3.1 \u65b9\u6cd5\u4e00\uff1a<code>update()</code>","text":"<pre><code>    # user_obj \u662f &lt;class 'django.db.models.query.QuerySet'&gt;\n    user_obj = models.User.objects.filter(username='John')\n    user_obj.update(age=20)\n</code></pre>"},{"location":"programming/python/Django/model/#32-save","title":"3.2 \u65b9\u6cd5\u4e8c\uff1a<code>save()</code>","text":"<pre><code>    # user_obj \u662f &lt;class 'app.models.User'&gt;\n    user_obj = models.User.objects.filter(username='John').first()\n    user_obj.age = 21\n    user_obj.save()\n</code></pre>"},{"location":"programming/python/Django/model/#32","title":"3.2 \u591a\u8868","text":""},{"location":"programming/python/Django/model/#321","title":"3.2.1 \u4e00\u5bf9\u4e00\u3001\u4e00\u5bf9\u591a","text":"<p>\u65b9\u5f0f\u4e00\uff1a\u76f4\u63a5\u5199\u5916\u952e\u5b57\u6bb5id</p> <pre><code>models.Book.objects.filter(pk=1).update(publish_id=2)\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7\u5bf9\u8c61\u4fee\u6539</p> <pre><code>publish_obj = models.Publish.objects.filter(pk=1).first()\nmodels.Book.objects.filter(pk=1).update(publish=publish_obj)\n</code></pre>"},{"location":"programming/python/Django/model/#322","title":"3.2.2 \u591a\u8868","text":"<p>\u65b9\u5f0f\u4e00\uff1a</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nbook_obj.authors.set([2]) # \u62ec\u53f7\u5185\u5fc5\u987b\u7ed9\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nauthor_obj1 = models.Author.objects.filter(pk=2).first()\nauthor_obj2 = models.Author.objects.filter(pk=3).first()\nbook_obj.authors.set([author_obj1, author_obj2]) # \u62ec\u53f7\u5185\u5fc5\u987b\u7ed9\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\n</code></pre> <p>\u6e05\u7a7a\u7b2c\u4e09\u5f20\u5173\u7cfb\u8868</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nbook_obj.authors.clear() # \u62ec\u53f7\u5185\u4e0d\u8981\u52a0\u4efb\u4f55\u53c2\u6570\n</code></pre>"},{"location":"programming/python/Django/model/#4_1","title":"4. \u5220","text":""},{"location":"programming/python/Django/model/#41","title":"4.1 \u5355\u8868","text":"<pre><code>    user_obj = models.User.objects.filter(username='Jack')\n    user_obj.delete()\n</code></pre>"},{"location":"programming/python/Django/model/#42","title":"4.2 \u591a\u8868","text":""},{"location":"programming/python/Django/model/#421","title":"4.2.1 \u4e00\u5bf9\u4e00\uff0c\u4e00\u5bf9\u591a","text":"<p>\u65b9\u6cd5\u540c\u5355\u8868\uff0c\u5220\u9664\u662f\u7ea7\u8054\u5220\u9664</p>"},{"location":"programming/python/Django/model/#422","title":"4.2.2 \u591a\u5bf9\u591a","text":"<p>\u65b9\u5f0f\u4e00\uff1a\u6839\u636e\u5916\u952e\u503c\u5220\u9664</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nbook_obj.authors.remove(2, 3)\n# DELETE FROM `app_book_authors` WHERE (`app_book_authors`.`book_id` = 1 AND `app_book_authors`.`author_id` IN (2, 3));\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a\u901a\u8fc7\u5bf9\u8c61\u5220\u9664</p> <pre><code>book_obj = models.Book.objects.filter(pk=1).first()\nauthor_obj1 = models.Author.objects.filter(pk=2).first()\nauthor_obj2 = models.Author.objects.filter(pk=3).first()\nbook_obj.authors.remove(author_obj1, author_obj2)\n#  remove\u62ec\u53f7\u5185\u65e2\u53ef\u4ee5\u4f20\u6570\u5b57\u4e5f\u53ef\u4ee5\u4f20\u5bf9\u8c61 \u5e76\u4e14\u90fd\u652f\u6301\u591a\u4e2a\n</code></pre>"},{"location":"programming/python/Django/model/#5","title":"5. \u4e8b\u52a1","text":"<pre><code>from django.db import transaction\ntry:\n    with transaction.atomic():\n        # sql1\n        # sql2\n        ...\n        # \u5728with\u4ee3\u7801\u5feb\u5185\u4e66\u5199\u7684\u6240\u6709orm\u64cd\u4f5c\u90fd\u662f\u5c5e\u4e8e\u540c\u4e00\u4e2a\u4e8b\u52a1\nexcept Exception as e:\n    print(e)\n</code></pre>"},{"location":"programming/python/Django/model/#_4","title":"\u56db\u3001\u5e38\u7528\u5b57\u6bb5\u548c\u53c2\u6570","text":"<p>https://www.cnblogs.com/Dominic-Ji/p/9203990.html</p>"},{"location":"programming/python/Django/model/#_5","title":"\u4e94\u3001\u6570\u636e\u5e93\u67e5\u8be2\u4f18\u5316","text":""},{"location":"programming/python/Django/model/#1-onlydefer","title":"1. only\u4e0edefer","text":"<p><code>only()</code>\u7ed3\u679c\u662f\u4e00\u4e2a\u5217\u8868\u5957\u591a\u4e2a\u5bf9\u8c61\uff0c\u8fd9\u4e9b\u5bf9\u8c61\u9ed8\u8ba4\u53ea\u6709only\u62ec\u53f7\u5185\u7684\u5c5e\u6027\uff0c\u4f46\u662f\u4e5f\u53ef\u4ee5\u70b9\u51fb\u62ec\u53f7\u5185\u6ca1\u6709\u7684\u5c5e\u6027\uff0c\u53ea\u662f\u9700\u8981\u989d\u5916\u7684\u8d70\u6570\u636e\u5e93\u64cd\u4f5c\u3002</p> <p><code>defer()</code>\u8ddfonly\u521a\u597d\u76f8\u53cd\uff0c\u5bf9\u8c61\u91cc\u9762\u552f\u72ec\u6ca1\u6709\u62ec\u53f7\u5185\u6307\u5b9a\u7684\u5c5e\u6027\u3002</p>"},{"location":"programming/python/Django/model/#2-select_relatedprefetch_related","title":"2. <code>select_related</code>\u4e0e<code>prefetch_related</code>","text":"<p><code>select_related(</code>\u5185\u90e8\u7684\u672c\u8d28\u662f\u8054\u8868\u64cd\u4f5c\uff08<code>inner join</code>\uff09\uff0c\u62ec\u53f7\u5185\u53ea\u80fd\u653e\u5916\u952e\u5b57\u6bb5\u5e76\u4e14\u591a\u5bf9\u591a\u4e0d\u884c\u3002\u62ec\u53f7\u5185\u53ef\u4ee5\u653e\u591a\u4e2a\u5916\u952e\u5b57\u6bb5\uff08<code>select_related(\u5916\u952e\u5b57\u6bb51__\u5916\u952e\u5b57\u6bb52__\u5916\u952e\u5b57\u6bb53__...</code>)\uff0c\u5c06\u8054\u8868\u4e4b\u540e\u7684\u7ed3\u679c\u5168\u90e8\u67e5\u8be2\u51fa\u6765\u5c01\u88c5\u5230\u5bf9\u8c61\u91cc\u9762\uff0c\u4e4b\u540e\u5bf9\u8c61\u5728\u70b9\u51fb\u8868\u7684\u5b57\u6bb5\u7684\u65f6\u5019\u90fd\u65e0\u9700\u518d\u8d70\u6570\u636e\u5e93\u3002</p> <p><code>prefetch_related()</code>\u5185\u90e8\u672c\u8d28\u662f\u5b50\u67e5\u8be2\uff0c\u5185\u90e8\u901a\u8fc7\u5b50\u67e5\u8be2\u7684\u65b9\u5f0f\u5c06\u591a\u5f20\u7684\u8868\u6570\u636e\u4e5f\u5c01\u88c5\u5230\u5bf9\u8c61\u4e2d\uff0c\u8fd9\u6837\u7528\u6237\u5728\u4f7f\u7528\u7684\u65f6\u5019\u4e5f\u662f\u611f\u89c9\u4e0d\u51fa\u6765\u7684\u3002</p> <p>\u4e0a\u8ff0\u4e24\u79cd\u65b9\u5f0f\uff0c\u5728\u4e0d\u540c\u7684\u573a\u666f\u4e0b\u6548\u7387\u5404\u6709\u5343\u79cb</p>"},{"location":"programming/python/Django/request/","title":"\u8bf7\u6c42","text":""},{"location":"programming/python/Django/request/#request","title":"\u4e00\u3001<code>request</code>","text":"<ol> <li><code>request.method</code>\uff1a\u4ee5\u5168\u5927\u5199\u7684\u5b57\u7b26\u4e32\u8fd4\u56de\u8bf7\u6c42\u65b9\u5f0f\u3002</li> <li><code>request.GET</code>\uff1a\u8fd4\u56de\u7528\u6237\u63d0\u4ea4\u7684GET\u8bf7\u6c42\u6570\u636e <code>&lt;QueryDict: {'username': ['admin'], 'password': ['123456']}&gt;</code></li> <li><code>request.GET.get('key')</code>\uff1a \u8fd4\u56de\u5217\u8868\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5143\u7d20</li> <li><code>request.GET.getlist('key')</code>\uff1a\u8fd4\u56de\u5217\u8868</li> <li><code>request.POST</code>\uff1a\u8fd4\u56de\u7528\u6237\u63d0\u4ea4\u7684POST\u8bf7\u6c42\u6570\u636e</li> <li><code>request.POST.get('key')</code></li> <li><code>request.POST.getlist('key')</code></li> <li><code>request.body</code></li> <li><code>request.path</code></li> <li><code>request.path_info</code></li> <li><code>request.get_full_path()</code>\uff1a\u80fd\u8fc7\u83b7\u53d6\u5b8c\u6574\u7684url\u53ca\u95ee\u53f7\u540e\u9762\u7684\u53c2\u6570\uff0c\u5982/login/?username=admin&amp;password=123456</li> <li><code>request.FILES</code>\uff1a\u83b7\u53d6\u6587\u4ef6\u6570\u636e</li> <li><code>request.is_ajax()</code>\uff1a\u5224\u65ad\u5f53\u524d\u8bf7\u6c42\u662f\u5426\u662fajax\u8bf7\u6c42 \u8fd4\u56de\u5e03\u5c14\u503c</li> </ol>"},{"location":"programming/python/Django/response/","title":"\u54cd\u5e94\u4e09\u677f\u65a7","text":""},{"location":"programming/python/Django/response/#1-httpresponse","title":"1. <code>HttpResponse</code>","text":"<p>\u8fd4\u56de\u5b57\u7b26\u4e32\u7c7b\u578b\u7684\u6570\u636e\u3002</p> <pre><code>from django.shortcuts import HttpResponse\n\n\ndef index(request):\n    return HttpResponse(\"Hello World\")\n</code></pre>"},{"location":"programming/python/Django/response/#2-render","title":"2. <code>render</code>","text":"<p>\u8fd4\u56de\u6e32\u67d3\u8fc7\u7684\u6a21\u677f\u6587\u4ef6</p>"},{"location":"programming/python/Django/response/#1","title":"1. \u521b\u5efa\u6a21\u677f\u6587\u4ef6","text":"<p>\u5728<code>mysite/app/templates</code>\u4e0b\u521b\u5efa\u540d\u4e3a<code>index.html</code>\u7684\u6a21\u677f\u6587\u4ef6</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;index&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;p&gt;Hello Index&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Django/response/#2","title":"2. \u5728\u89c6\u56fe\u51fd\u6570\u4e2d\u6307\u660e\u6a21\u677f\u6587\u4ef6\u7684\u540d\u79f0","text":"<p>\u7531\u4e8e\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5df2\u7ecf\u6307\u660e\u4e86\u6a21\u677f\u6587\u4ef6\u7684\u8def\u5f84\uff0c\u6240\u6709\u6b64\u5904\u53ea\u9700\u8981\u4e9b\u6a21\u677f\u6587\u4ef6\u540d\u5373\u53ef</p> <pre><code>from django.shortcuts import render\n\n\ndef index(request):\n    return render(request, 'index.html')\n</code></pre>"},{"location":"programming/python/Django/response/#3","title":"3. \u4f20\u503c","text":"<p>\u5728\u6a21\u677f\u6587\u4ef6\u4e2d\u63a5\u6536\u503c\uff1a</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    Hello Index\n    {{ info }}\n    {{ data }}\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Django/response/#31","title":"3.1 \u65b9\u5f0f\u4e00","text":"<pre><code>from django.shortcuts import render\n\n\n# Create your views here.\ndef index(request):\n    user_info = {\"name\": \"admin\", \"password\": \"123456\"}\n    data = {\"data\": [1, 2, 3]}\n    # \u66f4\u52a0\u7cbe\u786e\uff0c\u8282\u7701\u8d44\u6e90\n    return render(request, 'index.html', {\"info\": user_info, \"data\": data})\n</code></pre>"},{"location":"programming/python/Django/response/#32","title":"3.2 \u65b9\u5f0f\u4e8c","text":"<pre><code># \nfrom django.shortcuts import render\n\n\n# Create your views here.\ndef index(request):\n    user_info = {\"name\": \"admin\", \"password\": \"123456\"}\n    data = {\"data\": [1, 2, 3]}\n    # locals\u4f1a\u5c06\u6240\u5728\u7684\u540d\u79f0\u7a7a\u95f4\u4e2d\u519c\u6240\u6709\u7684\u540d\u79f0\u5168\u90e8\u4f20\u9012\n    # \u6ce8\u610f\uff1a\u4f7f\u7528\u6b64\u65b9\u6cd5\u65f6\uff0c\u89c6\u56fe\u4e2d\u7684\u53d8\u91cf\u540d\u6709\u6a21\u677f\u6587\u4ef6\u4e2d\u7684\u53d8\u91cf\u540d\u8981\u4e00\u81f4\n    return render(request, 'index.html', locals())\n</code></pre>"},{"location":"programming/python/Django/response/#3-redirect","title":"3. <code>redirect</code>","text":"<p>\u91cd\u5b9a\u5411\u5230\u6307\u5b9a\u7684URL</p> <pre><code>from django.shortcuts import redirect\n\n\ndef index(request):\n    return redirect('http://www.baidu.com')  # \u8df3\u8f6c\u5230\u5916\u90e8URL\n    # return redirect(\"/admin\")  # \u8df3\u8f6c\u5230\u5185\u90e8URL\n</code></pre>"},{"location":"programming/python/Django/response/#4jsonresponse","title":"4.<code>JsonResponse</code>","text":"<pre><code>from django.http import JsonResponse\n\n\ndef index(request):\n    data = {\"name\": \"admin\", \"msg\": \"\u4f60\u597d\"}\n    return JsonResponse(data, json_dumps_params={\"ensure_ascii\": False})\n</code></pre>"},{"location":"programming/python/Django/template/","title":"\u6a21\u677f\u5c42","text":""},{"location":"programming/python/Django/template/#_1","title":"\u4e00\u3001\u6a21\u677f\u6587\u4ef6\u914d\u7f6e","text":""},{"location":"programming/python/Django/template/#1-templates","title":"1. \u5728\u5e94\u7528\u4e0b\u521b\u5efa<code>templates</code>\u76ee\u5f55","text":"<pre><code>cd mysite/\nmkdir app/templates\n</code></pre>"},{"location":"programming/python/Django/template/#2-templates","title":"2. \u5728\u9879\u76ee\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0<code>templates</code>\u8def\u5f84","text":"<pre><code>TEMPLATES = [\n    {\n        'BACKEND': 'django.template.backends.django.DjangoTemplates',\n        'DIRS': [os.path.join(BASE_DIR, 'templates')],  # \u6dfb\u52a0\u6b64\u884c\n        'APP_DIRS': True,\n        'OPTIONS': {\n            'context_processors': [\n                'django.template.context_processors.debug',\n                'django.template.context_processors.request',\n                'django.contrib.auth.context_processors.auth',\n                'django.contrib.messages.context_processors.messages',\n            ],\n        },\n    },\n]\n</code></pre>"},{"location":"programming/python/Django/template/#_2","title":"\u4e8c\u3001\u9759\u6001\u6587\u4ef6\u914d\u7f6e","text":""},{"location":"programming/python/Django/template/#1","title":"1. \u521b\u5efa\u9759\u6001\u6587\u4ef6\u76ee\u5f55","text":"<pre><code>$ mkdir mysite/app/static\n# \u7f51\u7ad9\u4f7f\u7528\u7684\u9759\u6001\u6587\u4ef6(css,js,img)\u4e00\u822c\u90fd\u653e\u5728static\u76ee\u5f55\u4e0b\n</code></pre> <p>\u4e00\u822c\u60c5\u51b5\u4e0b\u90fd\u4f1a\u5bf9static\u4e0b\u7684\u8d44\u6e90\u8be6\u7ec6\u5212\u5206</p> <pre><code>$ mkdir mysite/app/static/{js,css,images}\ntree mysite/app/static/\nmysite/app/static/\n\u251c\u2500\u2500 css\n\u251c\u2500\u2500 images\n\u251c\u2500\u2500 js\n\u2514\u2500\u2500 bootstrap # (\u5176\u4ed6\u4e09\u65b9\u5e93\uff0c\u6bd4\u5982bootstrap)\n</code></pre>"},{"location":"programming/python/Django/template/#2","title":"2. \u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<pre><code># \u5982\u679c\u60f3\u8bbf\u95ee\u9759\u6001\u6587\u4ef6\uff0c\u6a21\u677f\u6587\u4ef6\u4e2d\u7684\u9759\u6001\u6587\u4ef6\u8def\u5f84\u5c31\u5fc5\u987b\u4ee5static\u5f00\u5934\uff0c\n# \u7136\u540e\u4eceSTATICFILES_DIRS\u4e2d\u7ed9\u7684\u8def\u5f84\u4ece\u4e0a\u5230\u4e0b\u4f9d\u6b21\u67e5\u627e\u6307\u5b9a\u7684\u9759\u6001\u6587\u4ef6\uff0c\u5982\u679c\u6ca1\u627e\u5230\u5c31\u62a5\u9519\nSTATIC_URL = '/static/'\n\n# \u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\nSTATICFILES_DIRS = [\n    os.path.join(BASE_DIR, 'static'),\n    os.path.join(BASE_DIR, 'static1'),\n    os.path.join(BASE_DIR, 'static2'),\n]\n</code></pre>"},{"location":"programming/python/Django/template/#3","title":"3. \u9759\u6001\u6587\u4ef6\u52a8\u6001\u89e3\u6790","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767b\u5f55&lt;/title&gt;\n    {% load static %}  &lt;!--\u7c7b\u4f3c\u4e8e\u5bfc\u5165\u6a21\u5757\uff0c\u53ef\u4ee5\u52a8\u6001\u89e3\u6790\u914d\u7f6e\u6587\u4ef6\u4e2dSTATIC_URL\u7684\u503c--&gt;\n    &lt;link rel=\"stylesheet\" href=\"{% static 'bootstrap-3.4.1-dist/css/bootstrap.min.css' %}\"&gt;\n    &lt;script src=\"{% static 'bootstrap-3.4.1-dist/js/bootstrap.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;h1 class=\"text-center\"&gt;\u767b\u9646&lt;/h1&gt;\n&lt;div class=\"container\"&gt;\n    &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-md-8 col-md-offset-2\"&gt;\n            &lt;form action=\"/index/\" method=\"post\"&gt;&gt;{% csrf_token %}\n                &lt;p&gt;username:&lt;input type=\"text\" name=\"username\" class=\"form-control\"&gt;&lt;/p&gt;\n                &lt;p&gt;password:&lt;input type=\"password\" name=\"password\" class=\"form-control\"&gt;&lt;/p&gt;\n                &lt;input type=\"submit\" class=\"btn btn-success btn-block\"&gt;\n            &lt;/form&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Django/template/#_3","title":"\u4e8c\u3001\u6a21\u677f\u8bed\u6cd5","text":""},{"location":"programming/python/Django/template/#1_1","title":"1. \u8bed\u6cd5","text":"<pre><code>{{ }}:\u53d8\u91cf\u76f8\u5173\n{% %}:\u903b\u8f91\u76f8\u5173\n</code></pre>"},{"location":"programming/python/Django/template/#2_1","title":"2. \u503c\u4f20\u9012","text":"<p>\u6a21\u7248\u8bed\u6cd5\u53ef\u4ee5\u4f20\u9012\u7684\u540e\u7aefpython\u6570\u636e\u7c7b\u578b</p> <p>\u89c6\u56fe\u51fd\u6570</p> <pre><code>from django.shortcuts import render\n\n\ndef home(request):\n    n = 18\n    f = 9.99\n    s = 'Hello World!'\n    b = True\n    l = ['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de']\n    t = ('\u5434', '\u8700', '\u9b4f')\n    d = {'username': 'Tom', 'age': '17'}\n    st = {'a', 'b', 'c'}\n\n    def foo():\n        return 'func:foo'\n\n    class Bar:\n        def func(self):\n            return 'Bar--&gt;func'\n\n        @staticmethod\n        def static_func():\n            return 'Bar--&gt;static_func'\n\n        @classmethod\n        def class_func(cls):\n            return 'Bar--&gt;class_func'\n\n        def __str__(self):\n            return 'Class Bar'\n\n    obj = Bar()\n    return render(request, 'home.html', locals())\n</code></pre> <p>\u6a21\u677f</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;title&gt;home&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;p&gt;{{ n }}&lt;/p&gt;\n        &lt;p&gt;{{ f }}&lt;/p&gt;\n        &lt;p&gt;{{ s }}&lt;/p&gt;\n        &lt;p&gt;{{ b }}&lt;/p&gt;\n        &lt;p&gt;{{ l }}&lt;/p&gt;\n        &lt;p&gt;{{ d }}&lt;/p&gt;\n        &lt;p&gt;{{ t }}&lt;/p&gt;\n        &lt;p&gt;{{ st }}&lt;/p&gt;\n        &lt;p&gt;{{ foo }}&lt;/p&gt;\n        &lt;p&gt;{{ Bar }}&lt;/p&gt;\n        &lt;p&gt;{{ obj }}&lt;/p&gt;\n        &lt;p&gt;{{ obj.func }}&lt;/p&gt;\n        &lt;p&gt;{{ obj.static_func }}&lt;/p&gt;\n        &lt;p&gt;{{ obj.class_func }}&lt;/p&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <ol> <li>\u4f20\u9012\u51fd\u6570\u540d\u4f1a\u81ea\u52a8\u52a0\u62ec\u53f7\u8c03\u7528\uff0c\u4f46\u662f\u6a21\u7248\u8bed\u6cd5\u4e0d\u652f\u6301\u7ed9\u51fd\u6570\u4f20\u989d\u5916\u7684\u53c2\u6570</li> <li>\u4f20\u7c7b\u540d\u7684\u65f6\u5019\u4e5f\u4f1a\u81ea\u52a8\u52a0\u62ec\u53f7\u8c03\u7528(\u5b9e\u4f8b\u5316)</li> <li>\u5185\u90e8\u80fd\u591f\u81ea\u52a8\u5224\u65ad\u51fa\u5f53\u524d\u7684\u53d8\u91cf\u540d\u662f\u5426\u53ef\u4ee5\u52a0\u62ec\u53f7\u8c03\u7528\uff0c\u5982\u679c\u53ef\u4ee5\u5c31\u4f1a\u81ea\u52a8\u6267\u884c\uff08\u9488\u5bf9\u7684\u662f\u51fd\u6570\u540d\u548c\u7c7b\u540d\uff09</li> </ol> <p>\u6e32\u67d3\u540e\u7684\u9875\u9762</p> <p></p>"},{"location":"programming/python/Django/template/#3_1","title":"3. \u53d6\u503c","text":"<p>django\u6a21\u7248\u8bed\u6cd5\u7684\u53d6\u503c\u662f\u56fa\u5b9a\u7684\u683c\u5f0f\uff0c\u53ea\u80fd\u91c7\u7528\u53e5\u70b9\u7b26(<code>.</code>)</p> <ol> <li><code>.\u952e</code>\uff1a<code>{{ d.username }}</code></li> <li><code>.\u7d22\u5f15</code>\uff1a<code>{{ d.hobby.3.info }}</code></li> </ol>"},{"location":"programming/python/Django/template/#4","title":"4. \u8fc7\u6ee4\u5668","text":"<p>\u8bed\u6cd5\uff1a<code>{{\u6570\u636e|\u8fc7\u6ee4\u5668:\u53c2\u6570}}</code></p>"},{"location":"programming/python/Django/template/#41","title":"4.1 \u5185\u7f6e\u8fc7\u6ee4\u5668","text":"<p>\u89c6\u56fe\u5c42</p> <pre><code>#filename: urls.py\nfrom django.shortcuts import render\nimport datetime\n\n\ndef home(request):\n    n = 88\n    s = 'Hello World! I love you.'\n    msg = \"\u4f60\u597d\u4e16\u754c\uff01\u6211\u7231\u4f60\u3002\"\n    l = ['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de']\n    file_size = 12321483\n    current_time = datetime.datetime.now()\n    h = '&lt;h2&gt;hello&lt;/h2&gt;'\n    return render(request, 'home.html', locals())\n</code></pre> <p>\u6a21\u677f\u5c42</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;home&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;\u7edf\u8ba1\u957f\u5ea6:{{ s|length }}&lt;/p&gt;\n&lt;p&gt;\u9ed8\u8ba4\u503c\uff08\u5982\u679cd\u7684\u5e03\u5c14\u503c\u662fTrue\u5c31\u5c55\u793ad,\u5426\u5219\u5c55\u793a\u5192\u53f7\u540e\u9762\u7684\u503c\uff09\uff1a{{ d|default:\"haha\" }}&lt;/p&gt;\n&lt;p&gt;\u6587\u4ef6\u5927\u5c0f(\u628aKB\u8f6c\u6210\u53ef\u8bfb\u5927\u5c0f):{{ file_size|filesizeformat }}&lt;/p&gt;\n&lt;p&gt;\u65e5\u671f\u683c\u5f0f\u5316:{{ current_time|date:'Y-m-d H:i:s' }}&lt;/p&gt;\n&lt;p&gt;\u5207\u7247\u64cd\u4f5c(\u652f\u6301\u6b65\u957f):{{ l|slice:'0:2:2' }}&lt;/p&gt;\n&lt;p&gt;\u5207\u53d6\u5b57\u7b26(\u5305\u542b\u4e09\u4e2a\u70b9):{{ s|truncatechars:7 }}&lt;/p&gt;\n&lt;p&gt;\u5207\u53d6\u5355\u8bcd(\u4e0d\u5305\u542b\u4e09\u4e2a\u70b9 \u6309\u7167\u7a7a\u683c\u5207):{{ s|truncatewords:3 }}&lt;/p&gt;\n&lt;p&gt;\u5207\u53d6\u5355\u8bcd(\u4e0d\u5305\u542b\u4e09\u4e2a\u70b9 \u6309\u7167\u7a7a\u683c\u5207):{{ msg|truncatewords:3 }}&lt;/p&gt;\n&lt;p&gt;\u79fb\u9664\u7279\u5b9a\u7684\u5b57\u7b26:{{ s|cut:' ' }}&lt;/p&gt;\n&lt;p&gt;\u62fc\u63a5\u64cd\u4f5c:{{ l|join:'-' }}&lt;/p&gt;\n&lt;p&gt;\u62fc\u63a5\u64cd\u4f5c(\u52a0\u6cd5):{{ n|add:10 }}&lt;/p&gt;\n&lt;p&gt;\u62fc\u63a5\u64cd\u4f5c(\u52a0\u6cd5):{{ s|add:msg }}&lt;/p&gt;\n&lt;p&gt;\u8f6c\u4e49:{{ h|safe }}&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6e32\u67d3\u7ed3\u679c</p> <p></p> <p>\u540e\u7aef\u8f6c\u4e49</p> <pre><code>from django.shortcuts import render\nfrom django.utils.safestring import mark_safe\n\n\ndef home(request):\n    res = mark_safe('&lt;h1&gt;Hello&lt;/h1&gt;')\n    return render(request, 'home.html', locals())\n</code></pre> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;home&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;\u540e\u7aef\u8f6c\u4e49:{{ res }}&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Django/template/#42","title":"4.2 \u81ea\u5b9a\u4e49\u8fc7\u6ee4\u5668","text":"<p>\u6b65\u9aa4\uff1a</p> <ol> <li> <p>\u5728\u5e94\u7528\u4e0b\u521b\u5efa\u4e00\u4e2a\u540d\u5b57\u201d\u5fc5\u987b\u201c\u53eb<code>templatetags</code>\u7684\u6587\u4ef6\u5939</p> </li> <li> <p>\u5728\u8be5\u6587\u4ef6\u5939\u5185\u521b\u5efa\u201c\u4efb\u610f\u201d\u540d\u79f0\u7684<code>py</code>\u6587\u4ef6eg:<code>mytag.py</code></p> </li> <li> <p>\u5728\u8be5<code>py</code>\u6587\u4ef6\u5185\"\u5fc5\u987b\"\u5148\u4e66\u5199\u4e0b\u9762\u4e24\u53e5\u8bdd(\u5355\u8bcd\u4e00\u4e2a\u90fd\u4e0d\u80fd\u9519)</p> </li> </ol> <pre><code>from django import template\nregister = template.Library()\n</code></pre> <p>\u5b9a\u4e49\u8fc7\u6ee4\u5668</p> <pre><code>#filename: templatetags/mytag.py\nfrom django import template\n\nregister = template.Library()\n\n\n@register.filter(name='my_add')  # name=\"\u8fc7\u6ee4\u5668\u7684\u540d\u79f0\"\ndef my_sum(v1, v2):\n    return v1 + v2\n</code></pre> <p>\u4f7f\u7528</p> <pre><code>{% load mytag %}\n&lt;p&gt;{{ n|my_add:66 }}&lt;/p&gt;\n</code></pre>"},{"location":"programming/python/Django/template/#5","title":"5. \u6807\u7b7e","text":""},{"location":"programming/python/Django/template/#51-for","title":"5.1 <code>for</code>","text":"<pre><code>{% for foo in l %}\n    &lt;p&gt;{{ foo }}&lt;/p&gt;\n{% endfor %}\n</code></pre> <p>for\u5faa\u73af\u5185\u7f6e\u53d8\u91cf</p> <pre><code>{% for foo in l %}\n    &lt;p&gt;{{ forloop }}&lt;/p&gt;\n{% endfor %}\n</code></pre> <pre><code>{'parentloop': {}, 'counter0': 0, 'counter': 1, 'revcounter': 3, 'revcounter0': 2, 'first': True, 'last': False}\n{'parentloop': {}, 'counter0': 1, 'counter': 2, 'revcounter': 2, 'revcounter0': 1, 'first': False, 'last': False}\n{'parentloop': {}, 'counter0': 2, 'counter': 3, 'revcounter': 1, 'revcounter0': 0, 'first': False, 'last': True}\n</code></pre> <p>\u5904\u7406\u5b57\u5178</p> <pre><code>{% for foo in d.keys %}\n    &lt;p&gt;{{ foo }}&lt;/p&gt;\n{% endfor %}\n{% for foo in d.values %}\n    &lt;p&gt;{{ foo }}&lt;/p&gt;\n{% endfor %}\n{% for k,v in d.items %}\n    &lt;p&gt;{{ k }}--&gt;{{ v }}&lt;/p&gt;\n{% endfor %}\n</code></pre> <p>empty</p> <pre><code>{% for foo in ll %}\n    &lt;p&gt;{{ forloop }}&lt;/p&gt;\n{% empty %}\n    &lt;p&gt;\u5faa\u73af\u5bf9\u8c61\u6ca1\u6709\u5185\u5bb9\uff0c\u5c31\u663e\u793a\u8fd9\u884c&lt;/p&gt;\n{% endfor %}\n</code></pre>"},{"location":"programming/python/Django/template/#52-if","title":"5.2 <code>if</code>","text":"<pre><code>{% if n &gt; 80 %}\n    &lt;p&gt;\u771f\u68d2&lt;/p&gt;\n{% elif n &gt; 60 %}\n    &lt;p&gt;\u8fd8\u884c&lt;/p&gt;\n{% else %}\n    &lt;p&gt;\u52aa\u529b\u5427\uff0c\u5c11\u5e74!&lt;/p&gt;\n{% endif %}\n</code></pre> <p>\u652f\u6301\u7684\u8fd0\u7b97\u7b26</p> <pre><code>in\nor and not\n==, !=, &lt;, &gt;, &lt;=, &gt;=\n</code></pre>"},{"location":"programming/python/Django/template/#53-with","title":"5.3 <code>with</code>\u8d77\u522b\u540d","text":"<p>\u5728with\u8bed\u6cd5\u5185\u5c31\u53ef\u4ee5\u901a\u8fc7as\u540e\u9762\u7684\u522b\u540d\u5feb\u901f\u7684\u4f7f\u7528\u5230\u524d\u9762\u975e\u5e38\u590d\u6742\u83b7\u53d6\u6570\u636e\u7684\u65b9\u5f0f</p> <pre><code>{% with l|length as count %}\n    &lt;p&gt;\u5217\u8868\u957f\u5ea6:{{ count }}&lt;/p&gt;\n{% endwith %}\n</code></pre>"},{"location":"programming/python/Django/template/#54","title":"5.4 \u81ea\u5b9a\u4e49\u6807\u7b7e","text":"<p>\u81ea\u5b9a\u4e49\u6807\u7b7e\u7684\u53c2\u6570\u53ef\u4ee5\u6709\u591a\u4e2a</p> <pre><code># filename: templatetags/mytag.py\nfrom django import template\n\nregister = template.Library()\n\n\n@register.simple_tag(name='my_plus') # name=\"\u6807\u7b7e\u7684\u540d\u79f0\"\ndef plus_plus(a, b, c, d):\n    return '%s-%s-%s-%s' % (a, b, c, d)\n</code></pre> <p>\u4f7f\u7528</p> <pre><code>{% load mytag %}\n&lt;p&gt;{% my_plus 'my' 'age' 'is' 18 %}&lt;/p&gt;\n</code></pre>"},{"location":"programming/python/Django/template/#55-inclusion_tag","title":"5.5 \u81ea\u5b9a\u4e49<code>inclusion_tag</code>","text":"<p>\u5f53html\u9875\u9762\u67d0\u4e00\u4e2a\u5730\u65b9\u7684\u9875\u9762\u9700\u8981\u4f20\u53c2\u6570\u624d\u80fd\u591f\u52a8\u6001\u7684\u6e32\u67d3\u51fa\u6765\uff0c\u5e76\u4e14\u5728\u591a\u4e2a\u9875\u9762\u4e0a\u90fd\u9700\u8981\u4f7f\u7528\u5230\u8be5\u5c40\u90e8 \u90a3\u4e48\u5c31\u8003\u8651\u5c06\u8be5\u5c40\u90e8\u9875\u9762\u505a\u6210<code>inclusion_tag</code>\u5f62\u5f0f</p> <p>\u5185\u90e8\u539f\u7406\uff1a</p> <ol> <li>\u5148\u5b9a\u4e49\u4e00\u4e2a\u65b9\u6cd5</li> <li>\u5728\u9875\u9762\u4e0a\u8c03\u7528\u8be5\u65b9\u6cd5\u5e76\u4e14\u53ef\u4ee5\u4f20\u503c</li> <li>\u8be5\u65b9\u6cd5\u4f1a\u751f\u6210\u4e00\u4e9b\u6570\u636e\u7136\u540e\u4f20\u9012\u7ed9\u4e00\u4e2ahtml\u9875\u9762</li> <li>\u4e4b\u540e\u5c06\u6e32\u67d3\u597d\u7684\u7ed3\u679c\u653e\u5230\u8c03\u7528\u7684\u4f4d\u7f6e</li> </ol> <p>\u5b9a\u4e49inclusion_tag</p> <pre><code>from django import template\n\nregister = template.Library()\n\n\n@register.inclusion_tag('menu_list.html')   # \u6570\u636e\u8fd4\u56de\u7ed9\u54ea\u4e2a\u9875\u9762\u53bb\u5904\u7406\ndef show(n):\n    data = ['\u7b2c{}\u9879'.format(i) for i in range(n)]\n    return locals() # \u5c06data\u4f20\u9012\u7ed9home.html\n</code></pre> <p>show\u51fd\u6570\u5904\u7406\u7684\u7ed3\u679c\u5728<code>menu_list.html</code>\u4e2d\u5904\u7406</p> <pre><code>    {% for foo in data %}\n        &lt;li&gt;{{ foo }}&lt;/li&gt;\n    {% endfor %}\n</code></pre> <p>\u6e32\u67d3\u540e\u7684\u9875\u9762\u5728\u5176\u4ed6\u9875\u9762\u4e2d\u4f7f\u7528</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u4e3b\u9875&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    {% load mytag %}\n    {% show 5 %}\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u8bbf\u95ee\u7ed3\u679c</p> <p></p>"},{"location":"programming/python/Django/template/#_4","title":"\u4e09\u3001\u6a21\u677f\u7ee7\u627f","text":"<p>\u5f53\u7f51\u7ad9\u9875\u9762\u6574\u4f53\u90fd\u5dee\u4e0d\u591a\uff0c\u53ea\u662f\u67d0\u4e00\u4e9b\u5c40\u90e8\u5728\u505a\u53d8\u5316 \uff0c\u5c31\u53ef\u4ee5\u7528\u5230\u6a21\u677f\u7ee7\u627f\u3002</p> <ol> <li>\u5148\u5b9a\u4e49\u4e00\u4e2a\u6a21\u677f\u9875\u9762\uff0c\u5728\u6a21\u7248\u9875\u9762\u4e0a\u63d0\u524d\u5212\u5b9a\u53ef\u4ee5\u88ab\u4fee\u6539\u7684\u533a\u57df</li> <li>\u5b50\u9875\u9762\u7ee7\u627f\u6a21\u677f\uff0c\u5728\u5212\u5b9a\u7684\u533a\u57df\u5b9a\u5236\u4fee\u6539\u5b50\u9875\u9762\u7684\u5185\u5bb9</li> <li>\u4e00\u822c\u60c5\u51b5\u4e0b\u6a21\u7248\u9875\u9762\u4e0a\u5e94\u8be5\u81f3\u5c11\u6709\u4e09\u5757\u53ef\u4ee5\u88ab\u4fee\u6539\u7684\u533a\u57df\uff08css\uff0cjs\uff0chtml\uff09</li> </ol>"},{"location":"programming/python/Django/template/#1_2","title":"1. \u6a21\u677f\u9875\u9762\u7684\u5b9a\u4e49","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    {% block css %}\n\n    {% endblock %}\n&lt;/head&gt;\n&lt;body&gt;\n    {% block content %}\n    &lt;p&gt;\u6a21\u677f\u9875\u9762\u5185\u5bb9&lt;/p&gt;\n    {% endblock %}\n    {% block js %}\n\n    {% endblock %}\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Django/template/#2_2","title":"2. \u5b50\u9875\u9762\u7ee7\u627f","text":"<pre><code>{% extends 'base.html' %}\n{% block content %}\n    &lt;p&gt;\u5b50\u9875\u9762\u5185\u5bb9&lt;/p&gt;\n{% endblock %}\n</code></pre> <p>\u5b50\u9875\u9762\u4e2d\u7ee7\u7eed\u5f15\u7528\u6a21\u677f\u7684\u5185\u5bb9</p> <pre><code>{% extends 'base.html' %}\n{% block content %}\n    \u5b50\u9875\u9762\u5185\u5bb9\n    {{ block.super }}\n    \u5b50\u9875\u9762\u5185\u5bb9\n{% endblock %}\n</code></pre>"},{"location":"programming/python/Django/template/#_5","title":"\u56db\u3001\u6a21\u677f\u5bfc\u5165","text":"<p>\u5c06\u9875\u9762\u7684\u67d0\u4e00\u4e2a\u5c40\u90e8\u5f53\u6210\u6a21\u5757\u7684\u5f62\u5f0f\uff0c\u54ea\u4e2a\u5730\u65b9\u9700\u8981\u5c31\u53ef\u4ee5\u76f4\u63a5\u5bfc\u5165\u4f7f\u7528\u5373\u53ef</p> <pre><code>{% include 'menu.html' %}\n</code></pre>"},{"location":"programming/python/Django/urls/","title":"\u8def\u7531","text":""},{"location":"programming/python/Django/urls/#_2","title":"\u4e00\u3001\u8def\u7531\u5339\u914d","text":""},{"location":"programming/python/Django/urls/#1-mysitemysiteurlspy","title":"1. \u5728<code>mysite/mysite/urls.py</code>\u4e2d\u4e66\u5199\u8def\u7531","text":"<pre><code>from django.contrib import admin\nfrom django.urls import path\nfrom app import views\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('index/', views.index),\n]\n</code></pre> <p>\u5728\u6d4f\u89c8\u5668\u8f93\u5165http://127.0.0.1:8000/index\u65f6\uff0c<code>Django</code>\u4f1a\u505a\u4e00\u6b21301\u91cd\u5b9a\u5411\uff08\u81ea\u52a8\u5728URL\u540e\u9762\u52a0<code>/</code>\uff0c\u91cd\u65b0\u8bf7\u6c42\u4e00\u6b21\uff09\u3002</p> <p>\u53ef\u4ee5\u518d\u914d\u7f6e\u6587\u4ef6\u4e2d\u6dfb\u52a0<code>APPEND_SLASH = False</code>\u6765\u53d6\u6d88\u81ea\u52a8\u52a0<code>/</code>\u91cd\u5b9a\u5411</p>"},{"location":"programming/python/Django/urls/#2","title":"2. \u8def\u7531\u8f6c\u6362","text":""},{"location":"programming/python/Django/urls/#21","title":"2.1. \u9ed8\u8ba4\u8f6c\u6362\u5668","text":"<p><code>Django</code>\u9ed8\u8ba4\u63d0\u4f9b\u4e865\u79cd\u8f6c\u6362\u5668</p> \u8f6c\u6362\u5668 \u4f5c\u7528 \u793a\u4f8b <code>str</code> \u5339\u914d\u9664\u4e86<code>/</code>\u4e4b\u5916\u7684\u975e\u7a7a\u5b57\u7b26\u4e32 <code>Tom</code> <code>int</code> \u5339\u914d0\u6216\u8005\u4efb\u4f55\u6b63\u6574\u6570\uff0c\u8fd4\u56de\u4e00\u4e2aint <code>18</code> <code>path</code> \u5339\u914d\u4efb\u610f\u7531ASCII\u5b57\u6bcd\u6216\u6570\u5b57\u4ee5\u53ca\u8fde\u5b57\u7b26\u548c\u4e0b\u5212\u7ebf\u7ec4\u6210\u7684\u77ed\u6807\u7b7e <code>01_abc</code> <code>slug</code> \u5339\u914d\u975e\u7a7a\u5b57\u6bb5\uff0c\u5305\u62ec\u8def\u5f84\u5206\u9694\u7b26<code>/</code> <code>/stc/passwd</code> <code>uuid</code> \u5339\u914d\u4e00\u4e2a<code>UUID</code> <code>b6619e8f-7f66-4c08-88e2-740c3da369da</code> <p>\u5728<code>mysite/urls.py</code>\u7f16\u5199\u8def\u7531</p> <pre><code>from django.contrib import admin\nfrom django.urls import path\nfrom app import views\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('hello/&lt;str:username&gt;/', views.hello),\n    path('hello/&lt;int:age&gt;', views.hello),\n    path('hello/&lt;uuid:blkid&gt;', views.hello),\n    path('hello/&lt;slug:filename&gt;', views.hello),\n    path('hello/&lt;path:path&gt;', views.hello),\n]\n</code></pre> <p>\u5728<code>mysite/app/views.py</code>\u4e2d\u6253\u5370\u5339\u914d\u5230\u7684\u503c</p> <pre><code>def hello(request, *args, **kwargs):\n    print(\"URL: %s, args: %s, kwargs: %s\" % (request.build_absolute_uri(), args, kwargs))\n    return HttpResponse(\"Hello World\")\n</code></pre> <p>\u5728\u6d4f\u89c8\u5668\u4e2d\u53d1\u8d77\u8bf7\u6c42\uff0c\u6d4b\u8bd5\u63a5\u6536\u5230\u7684\u503c</p> <pre><code>URL: http://127.0.0.1:8000/hello/Tom/, args: (), kwargs: {'username': 'Tom'}\nURL: http://127.0.0.1:8000/hello/18, args: (), kwargs: {'age': 18}\nURL: http://127.0.0.1:8000/hello/b6619e8f-7f66-4c08-88e2-740c3da369da, args: (), kwargs: {'blkid': UUID('b6619e8f-7f66-4c08-88e2-740c3da369da')}\nURL: http://127.0.0.1:8000/hello//etc/passwd, args: (), kwargs: {'path': '/etc/passwd'}\nURL: http://127.0.0.1:8000/hello/01_abc, args: (), kwargs: {'filename': '01_abc'}\n</code></pre>"},{"location":"programming/python/Django/urls/#22","title":"2.2 \u81ea\u5b9a\u4e49\u8f6c\u6362\u5668","text":"<pre><code>from django.contrib import admin\nfrom django.urls import path, register_converter\nfrom app import views\n\n\nclass PhoneConverter:\n    regex = \"(13[0-9]|14[01456879]|15[0-35-9]|16[2567]|17[0-8]|18[0-9]|19[0-35-9])[0-9]{8}\"\n\n    def to_python(self, value):\n        return str(value)\n\n    def to_url(self, value):\n        return str(value)\n\n\nregister_converter(PhoneConverter, 'phone')\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('hello/&lt;phone:phone_number&gt;/', views.hello)\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#_3","title":"\u8def\u7531\u5c42","text":"<p><code>re_path()</code>\u65b9\u6cd5\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u53ea\u8981\u7b2c\u4e00\u4e2a\u53c2\u6570\u6b63\u5219\u8868\u8fbe\u5f0f\u80fd\u591f\u5339\u914d\u5230\u5185\u5bb9 \u90a3\u4e48\u5c31\u4f1a\u7acb\u523b\u505c\u6b62\u5f80\u4e0b\u5339\u914d\uff0c\u76f4\u63a5\u6267\u884c\u5bf9\u5e94\u7684\u89c6\u56fe\u51fd\u6570\u3002</p>"},{"location":"programming/python/Django/urls/#_4","title":"\u4e8c. \u5206\u7ec4","text":"<p>\u5206\u7ec4\uff1a\u5c06\u67d0\u4e00\u6bb5\u6b63\u5219\u8868\u8fbe\u5f0f\u7528\u5c0f\u62ec\u53f7\u6269\u8d77\u6765</p>"},{"location":"programming/python/Django/urls/#1","title":"1. \u65e0\u540d\u5206\u7ec4","text":"<p>\u65e0\u540d\u5206\u7ec4\u5c31\u662f\u5c06\u62ec\u53f7\u5185\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u5230\u7684\u5185\u5bb9\u5f53\u4f5c\u4f4d\u7f6e\u53c2\u6570\u4f20\u9012\u7ed9\u540e\u9762\u7684\u89c6\u56fe\u51fd\u6570\u3002</p> <pre><code>from django.contrib import admin\nfrom django.urls import path, re_path\nfrom app import views\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    re_path('article/(\\d{4})', views.article)  # \u65e0\u540d\u5206\u7ec4\n] \n</code></pre> <p>\u89c6\u56fe\u51fd\u6570\u4e2d\u5f62\u53c2\u7684\u540d\u5b57\u53ef\u4ee5\u662f\u4efb\u610f\u7684\u5b57\u7b26\u4e32</p> <pre><code>from django.shortcuts import HttpResponse\n\n# \u5f62\u53c2\u7684\u540d\u5b57\u53ef\u4ee5\u662f\u4efb\u610f\u7684\u5b57\u7b26\u4e32\ndef article(request, arg):\n    return HttpResponse(\"%s\u5e74\u7684\u6587\u7ae0\" % arg)\n</code></pre>"},{"location":"programming/python/Django/urls/#2_1","title":"2. \u6709\u540d\u5206\u7ec4","text":"<p>\u6709\u540d\u5206\u7ec4\u5c31\u662f\u5c06\u62ec\u53f7\u5185\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d\u5230\u7684\u5185\u5bb9\u5f53\u4f5c\u5173\u952e\u5b57\u53c2\u6570\u4f20\u9012\u7ed9\u540e\u9762\u7684\u89c6\u56fe\u51fd\u6570\u3002</p> <pre><code>from django.urls import path, re_path\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    path(r'^admin/', admin.site.urls),\n    re_path(r'^article/(?P&lt;year&gt;\\d{4})', views.article)  # \u7ed9\u6b63\u5219\u8868\u8fbe\u5f0f\u8d77\u4e00\u4e2a\u522b\u540d\n]\n</code></pre> <p>\u89c6\u56fe\u51fd\u6570\u4e2d\u5f62\u53c2\u7684\u540d\u5b57\u5fc5\u987b\u662f\u8def\u7531\u4e2d\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u522b\u540d</p> <pre><code>from django.shortcuts import HttpResponse\n\n# \u5f62\u53c2\u7684\u540d\u5b57\u662f\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u522b\u540d\ndef article(request, year):\n    return HttpResponse(\"%s\u5e74\u7684\u6587\u7ae0\" % year)\n</code></pre> <p>\u65e0\u540d\u5206\u7ec4\u548c\u6709\u540d\u5206\u7ec4\u4e0d\u53ef\u4ee5\u6df7\u5408\u4f7f\u7528\uff0c\u4f46\u662f\u540c\u4e00\u4e2a\u5206\u7ec4\u53ef\u4ee5\u91cd\u590d\u4f7f\u7528\u591a\u6b21</p> <pre><code>urlpatterns = [\n    re_path(r'^article/([0-9]{4})/([0-9]{2})/([0-9]+)/$', views.article),\n    re_path(r'^article/(?P&lt;year&gt;[0-9]{4})/(?P&lt;month&gt;[0-9]{2})/(?P&lt;day&gt;[0-9]{2})/$', views.article),\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#_5","title":"\u4e09\u3001\u53cd\u5411\u89e3\u6790","text":""},{"location":"programming/python/Django/urls/#1_1","title":"1. \u666e\u901a\u89e3\u6790","text":"<p>\u901a\u8fc7\u4e00\u4e9b\u65b9\u6cd5\u5f97\u5230\u4e00\u4e2a\u7ed3\u679c\uff0c\u8be5\u7ed3\u679c\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u5bf9\u5e94\u7684<code>url</code>\u89e6\u53d1\u89c6\u56fe\u51fd\u6570</p> <p>\u7b2c\u4e00\u6b65\uff1a\u7ed9\u8def\u7531\u4e0e\u89c6\u56fe\u51fd\u6570\u8d77\u522b\u540d</p> <pre><code>from django.urls import path, re_path\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    path(r'^admin/', admin.site.urls),\n    path(r'^login/', views.login),\n    # \u7ed9\u8def\u7531\u548c\u89c6\u56fe\u51fd\u6570\u8d77\u4e00\u4e2a\u522b\u540d\n    re_path(r'register/', views.reg_func, name=\"reg\")\n]\n</code></pre> <p>\u7b2c\u4e8c\u6b65\uff1a\u540e\u7aef\u53cd\u5411\u89e3\u6790</p> <pre><code>from django.shortcuts import render, reverse\n\n\ndef login(request):\n    return render(request, 'login.html')\n\n\ndef reg_func(request):\n    print(reverse('reg'))  # /register/\n    return render(request, 'register.html')\n</code></pre> <p>\u7b2c\u4e09\u6b65\uff1a\u524d\u7aef\u53cd\u5411\u89e3\u6790</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;\u767b\u5f55&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;ul&gt;\n    &lt;li&gt;&lt;a href=\"#\"&gt;\u767b\u5f55&lt;/a&gt;&lt;/li&gt;\n    &lt;!--\u8df3\u8f6c\u5230http://127.0.0.1:8000/register/--&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'reg' %}\"&gt;\u6ce8\u518c&lt;/a&gt;&lt;/li&gt; \n&lt;/ul&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p></p>"},{"location":"programming/python/Django/urls/#2_2","title":"2. \u65e0\u540d\u6709\u540d\u5206\u7ec4\u53cd\u5411\u89e3\u6790","text":""},{"location":"programming/python/Django/urls/#21_1","title":"2.1 \u65e0\u540d\u5206\u7ec4\u53cd\u5411\u89e3\u6790","text":"<p>\u7b2c\u4e00\u6b65\uff1a\u8def\u7531</p> <pre><code>from django.urls import path, re_path\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('home/', views.home),\n    re_path('article/(\\d{4})/', views.article, name='new_article')\n]\n</code></pre> <p>\u7b2c\u4e8c\u6b65\uff1a\u540e\u7aef\u53cd\u5411\u89e3\u6790</p> <pre><code>from django.shortcuts import HttpResponse, reverse, render\n\n\ndef home(request):\n    return render(request, 'home.html')\n\n\ndef article(request, arg):\n    year = arg\n    url = reverse('new_article', args=(arg,))  # \u89e3\u91ca\u7684\u65f6\u5019\u9700\u8981\u52a0\u4e00\u4e2a\u53c2\u6570\n    return HttpResponse('url\u7684\u503c\u662f%s,arg\u7684\u662f\u503c\u662f%s' % (url, year))  # url\u7684\u503c\u662f/article/1999/,arg\u7684\u662f\u503c\u662f1999\n</code></pre> <p>\u7b2c\u4e09\u6b65\uff1a\u524d\u7aef\u53cd\u5411\u89e3\u6790</p> <pre><code>&lt;!--filename:home.html--&gt;\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;home&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;ul&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'new_article' 2020 %}\"&gt;2020&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'new_article' 2021 %}\"&gt;2021&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Django/urls/#22_1","title":"2.2 \u6709\u540d\u5206\u7ec4\u53cd\u5411\u89e3\u6790","text":"<p>\u7b2c\u4e00\u6b65\uff1a\u8def\u7531</p> <pre><code>from django.urls import path, re_path\nfrom django.contrib import admin\nfrom app import views\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('home/', views.home),\n    re_path('article/(?P&lt;year&gt;\\d{4})/', views.article, name='new_article')\n]\n</code></pre> <p>\u7b2c\u4e8c\u6b65\uff1a\u540e\u7aef\u89e3\u6790</p> <pre><code>from django.shortcuts import render, HttpResponse, reverse\n\n\ndef home(request):\n    return render(request, 'home.html')\n\n\ndef article(request, year):\n    print(reverse('new_article', kwargs={'year': year}))  # \u53e6\u4e00\u79cd\u5199\u6cd5\n    url = reverse('new_article', args=(year,))\n    return HttpResponse('url\u7684\u503c\u662f%s,arg\u7684\u662f\u503c\u662f%s' % (url, year))\n</code></pre> <p>\u7b2c\u4e09\u6b65\uff1a\u524d\u7aef\u89e3\u6790</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;home&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;ul&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'new_article' year=2020 %}\"&gt;2020&lt;/a&gt;&lt;/li&gt; &lt;!--\u53e6\u4e00\u79cd\u5199\u6cd5\uff0c\u4e0d\u91cd\u8981--&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'new_article' 2021 %}\"&gt;2021&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p></p>"},{"location":"programming/python/Django/urls/#_6","title":"\u56db\u3001\u8def\u7531\u5206\u53d1","text":"<p><code>django</code>\u7684\u6bcf\u4e00\u4e2a\u5e94\u7528\u90fd\u53ef\u4ee5\u6709\u81ea\u5df1\u7684<code>templates</code>\u76ee\u5f55\u3001<code>urls.py</code>\u3001<code>static</code>\u76ee\u5f55\uff0c\u57fa\u4e8e\u4e0a\u8ff0\u7684\u7279\u70b9\uff0c<code>django</code>\u80fd\u591f\u975e\u5e38\u597d\u7684\u505a\u5230\u6309\u6a21\u5757\u5f00\u53d1\uff0c\u6bcf\u4e00\u4e2a\u529f\u80fd\u6a21\u5757\u5bf9\u5e94\u4e00\u4e2a<code>app</code>\uff0c\u6700\u540e\u5728\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\u6ce8\u518c\u6240\u6709\u7684<code>app</code>\u518d\u5229\u7528\u8def\u7531\u5206\u53d1\u7684\u7279\u70b9\u5c06\u6240\u6709\u7684<code>app</code>\u6574\u5408\u6210\u4e00\u4e2a\u5b8c\u6574\u7684\u9879\u76ee\u3002</p> <p>\u5f53\u4e00\u4e2a<code>django</code>\u9879\u76ee\u4e2d\u7684<code>url</code>\u7279\u522b\u591a\u7684\u65f6\u5019\uff0c\u603b\u8def\u7531<code>urls.py</code>\u4ee3\u7801\u975e\u5e38\u5197\u4f59\u4e0d\u597d\u7ef4\u62a4\uff0c\u8fd9\u4e2a\u65f6\u5019\u4e5f\u53ef\u4ee5\u5229\u7528\u8def\u7531\u5206\u53d1\u6765\u51cf\u8f7b\u603b\u8def\u7531\u7684\u538b\u529b\u3002</p> <p>\u5229\u7528\u8def\u7531\u5206\u53d1\u4e4b\u540e\uff0c\u603b\u8def\u7531\u4e0d\u518d\u5904\u7406\u8def\u7531\u4e0e\u89c6\u56fe\u51fd\u6570\u7684\u76f4\u63a5\u5bf9\u5e94\u5173\u7cfb\uff0c\u800c\u662f\u505a\u4e00\u4e2a\u5206\u53d1\u5904\u7406\uff0c \u8bc6\u522b\u5f53\u524d<code>url</code>\u662f\u5c5e\u4e8e\u54ea\u4e2a\u5e94\u7528\u4e0b\uff0c\u7136\u540e\u76f4\u63a5\u5206\u53d1\u7ed9\u5bf9\u5e94\u7684\u5e94\u7528\u53bb\u5904\u7406\u3002</p>"},{"location":"programming/python/Django/urls/#1_2","title":"1 . \u5b50\u8def\u7531\u914d\u7f6e","text":"<p>\u5728\u5404\u81ea\u7684<code>app</code>\u4e0b\u521b\u5efa<code>urls.py</code></p> <p>\u5728\u540d\u4e3a<code>app</code>\u7684\u5e94\u7528\u4e0b\u521b\u5efa<code>urls.py</code></p> <pre><code>from django.urls import path\n\nfrom app import views\n\nurlpatterns = [\n    path('index/', views.index)\n]\n</code></pre> <p>\u5728\u540d\u4e3a<code>api</code>\u7684\u5e94\u7528\u4e0b\u521b\u5efa<code>urls.py</code></p> <pre><code>from django.urls import path\n\nfrom api import views\n\nurlpatterns = [\n    path('index/', views.index)\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#2_3","title":"2. \u603b\u8def\u7531\u914d\u7f6e","text":""},{"location":"programming/python/Django/urls/#21_2","title":"2.1 \u65b9\u5f0f\u4e00","text":"<pre><code>from django.urls import path, include\nfrom django.contrib import admin\nfrom app import urls as app_urls\nfrom api import urls as api_urls\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('app/', include(app_urls)),\n    path('api/', include(api_urls)),\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#22_2","title":"2.2 \u65b9\u5f0f\u4e8c\uff08\u63a8\u8350\u5199\u6cd5\uff09","text":"<pre><code>from django.urls import path, include\nfrom django.contrib import admin\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('app/', include('app.urls')),\n    path('api/', include('api.urls')),\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#_7","title":"\u4e94\u3001\u540d\u79f0\u7a7a\u95f4","text":"<p>\u5f53\u591a\u4e2a\u5e94\u7528\u51fa\u73b0\u4e86\u76f8\u540c\u7684\u522b\u540d\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u7684\u53cd\u5411\u89e3\u6790\u662f\u6ca1\u6709\u529e\u6cd5\u81ea\u52a8\u8bc6\u522b\u524d\u7f00\u7684\u3002</p>"},{"location":"programming/python/Django/urls/#1_3","title":"1. \u5b50\u8def\u7531","text":"<p><code>app/urls.py</code></p> <pre><code>from django.urls import path\n\nfrom app import views\n\napp_name = 'app'\nurlpatterns = [\n    path('index/', views.index, name='index'),\n    path('home/', views.home),\n]\n</code></pre> <p><code>api2/urls.py</code></p> <pre><code>from django.urls import path\n\nfrom api import views\n\napp_name = 'api'\nurlpatterns = [\n    path('index/', views.index, name='index')\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#2_4","title":"2. \u603b\u8def\u7531","text":"<pre><code>from django.urls import path, include\nfrom django.contrib import admin\n\nurlpatterns = [\n    path('admin/', admin.site.urls),\n    path('app/', include('app.urls', namespace='app')),\n    path('api/', include('api.urls', namespace='api')),\n]\n</code></pre>"},{"location":"programming/python/Django/urls/#_8","title":"\u8def\u7531\u5c42","text":""},{"location":"programming/python/Django/urls/#3","title":"3. \u6a21\u677f\u5c42","text":"<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;home&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;ul&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'app:index' %}\"&gt;app&lt;/a&gt;&lt;/li&gt;\n    &lt;li&gt;&lt;a href=\"{% url 'api:index' %}\"&gt;api&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u5176\u5b9e\u53ea\u8981\u4fdd\u8bc1\u540d\u5b57\u4e0d\u51b2\u7a81\u5c31\u6ca1\u6709\u5fc5\u8981\u4f7f\u7528\u540d\u79f0\u7a7a\u95f4\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u6709\u591a\u4e2a<code>app</code>\u7684\u65f6\u5019\u65f6\uff0c\u5728\u8d77\u522b\u540d\u7684\u65f6\u5019\u52a0<code>app</code>\u7684\u524d\u7f00\u5c31\u80fd\u591f\u786e\u4fdd\u591a\u4e2a<code>app</code>\u4e4b\u95f4\u540d\u5b57\u4e0d\u51b2\u7a81\u3002</p> <p><code>path('index/', views.index, name='api_index')</code></p>"},{"location":"programming/python/Django/view/","title":"\u89c6\u56fe\u5c42","text":""},{"location":"programming/python/Django/view/#1-fbvcbv","title":"1. FBV\u4e0eCBV","text":""},{"location":"programming/python/Django/view/#11-function-based-views","title":"1.1 Function-based views","text":"<pre><code>from django.shortcuts import HttpResponse\n\n\ndef index(request):\n    return HttpResponse('app Index')\n</code></pre>"},{"location":"programming/python/Django/view/#12-class-based-views","title":"1.2 Class-based views","text":"<p>\u7f16\u5199\u89c6\u56fe\u7c7b<code>app/views.py</code></p> <pre><code>from django.views import View\n\n\n\nclass Login(View):\n\n    def get(self, request):\n        return HttpResponse('get\u8bf7\u6c42')\n\n    def post(self, request):\n        return HttpResponse('post\u8bf7\u6c42')\n</code></pre> <p>\u8def\u7531\u5c42<code>app/urls.py</code></p> <pre><code>from django.urls import path\n\nfrom app import views\n\napp_name = 'app'\nurlpatterns = [\n    path('index/', views.index),\n    path('login/', views.Login.as_view()),\n]\n</code></pre>"},{"location":"programming/python/Django/view/#1","title":"1 \u6dfb\u52a0\u88c5\u9970\u5668","text":""},{"location":"programming/python/Django/view/#_2","title":"\u65b9\u5f0f\u4e00\uff1a","text":"<pre><code>from django.shortcuts import render, HttpResponse, redirect\nfrom django.views import View\n\n\ndef login_auth(func):\n    def inner(request, *args, **kwargs):\n        target_url = request.get_full_path()\n        if request.COOKIES.get('username'):\n            return func(request, *args, **kwargs)\n        else:\n            return redirect('/login/?redirect=%s' % target_url)\n\n    return inner\n\n\nclass MyLogin(View):\n    @method_decorator(login_auth)  # \u65b9\u5f0f1:\u76f4\u63a5\u52a0\u5728\u65b9\u6cd5\u4e0a\n    def get(self, request):\n        return HttpResponse(\"get\u8bf7\u6c42\")\n\n    def post(self, request):\n        return HttpResponse('post\u8bf7\u6c42')\n</code></pre>"},{"location":"programming/python/Django/view/#_3","title":"\u65b9\u5f0f\u4e8c\uff1a","text":"<pre><code># \u53ef\u4ee5\u6dfb\u52a0\u591a\u4e2a\u9488\u5bf9\u4e0d\u540c\u7684\u65b9\u6cd5\u52a0\u4e0d\u540c\u7684\u88c5\u9970\u5668\n@method_decorator(login_auth,name='post')\n@method_decorator(login_auth,name='get')\nclass MyLogin(View):\n    def get(self,request):\n        return HttpResponse()\n\n    def post(self,request):\n        return HttpResponse()\n</code></pre>"},{"location":"programming/python/Django/view/#_4","title":"\u65b9\u5f0f\u4e09\uff1a","text":"<pre><code>class MyLogin(View):\n    # \u5b83\u4f1a\u76f4\u63a5\u4f5c\u7528\u4e8e\u5f53\u524d\u7c7b\u91cc\u9762\u7684\u6240\u6709\u7684\u65b9\u6cd5\n    @method_decorator(login_auth)\n    def dispatch(self, request, *args, **kwargs):\n        \"\"\"\n        \u770bCBV\u6e90\u7801\u53ef\u4ee5\u5f97\u51fa CBV\u91cc\u9762\u6240\u6709\u7684\u65b9\u6cd5\u5728\u6267\u884c\u4e4b\u524d\u90fd\u9700\u8981\u5148\u7ecf\u8fc7\n        dispatch\u65b9\u6cd5(\u8be5\u65b9\u6cd5\u4f60\u53ef\u4ee5\u770b\u6210\u662f\u4e00\u4e2a\u5206\u53d1\u65b9\u6cd5)\n        \"\"\"\n        super().dispatch(request, *args, **kwargs)\n\n    def get(self, request):\n        return HttpResponse()\n\n    def post(self, request):\n        return HttpResponse()\n</code></pre>"},{"location":"programming/python/Django/view/#2-ajax","title":"2. Ajax","text":"<p><code>ajax</code>\u5728\u4e0d\u91cd\u65b0\u52a0\u8f7d\u6574\u4e2a\u9875\u9762\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u4e0e\u670d\u52a1\u5668\u4ea4\u6362\u6570\u636e\u5e76\u66f4\u65b0\u90e8\u5206\u7f51\u9875\u5185\u5bb9\u3002\u524d\u540e\u7aef\u4f20\u8f93\u6570\u636e\u7684\u65f6\u5019\u4e00\u5b9a\u8981\u786e\u4fdd\u7f16\u7801\u683c\u5f0f\u8ddf\u6570\u636e\u771f\u6b63\u7684\u683c\u5f0f\u4e00\u81f4\u3002</p> <p>ajax\u7279\u70b9\uff1a</p> <ol> <li>\u5f02\u6b65\u63d0\u4ea4</li> <li>\u5c40\u90e8\u5237\u65b0</li> </ol> <p>\u524d\u540e\u7aef\u4f20\u8f93\u6570\u636e\u7684\u5e38\u89c1\u7f16\u7801\u683c\u5f0f:</p> <ol> <li><code>x-www-form-urlencoded</code></li> <li><code>form-data</code></li> <li><code>json</code></li> </ol> <p>\u524d\u540e\u7aef\u4f20\u8f93\u6570\u636e\u65f6POST\u8bf7\u6c42\u7684\u65b9\u5f0f\uff1a</p> <ol> <li> <p>form\u8868\u5355</p> <ul> <li><code>x-www-form-urlencoded</code>\uff1a\u524d\u7aef\u6570\u636e\u683c\u5f0f\uff1a<code>username=Tom&amp;age=18</code>\uff0cdjango\u540e\u7aef\u9488\u5bf9\u7b26\u5408urlencoded\u7f16\u7801\u683c\u5f0f\u7684\u6570\u636e\u90fd\u4f1a\u89e3\u6790\u5c01\u88c5\u5230request.POST\u4e2d\u3002</li> <li><code>form-data</code>\uff1a\u666e\u901a\u7684\u952e\u503c\u89e3\u6790\u5230request.POST\u4e2d\uff0c\u6587\u4ef6\u89e3\u6790\u5230request.FILES\u4e2d\u3002</li> <li><code>json</code>\uff1aform\u8868\u5355\u662f\u6ca1\u6709\u529e\u6cd5\u53d1\u9001json\u683c\u5f0f\u6570\u636e\u7684\u3002</li> </ul> </li> <li> <p>ajax\u8bf7\u6c42</p> </li> <li>\u9ed8\u8ba4\u7684\u7f16\u7801\u683c\u5f0f\u4e5f\u662f<code>x-www-form-urlencoded</code></li> </ol>"},{"location":"programming/python/Django/view/#51","title":"5.1 \u57fa\u672c\u4f7f\u7528","text":"<p>\u6a21\u677f\u5c42</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    {% load static %}\n    &lt;script src=\"{% static 'jquery.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;input type=\"text\" id=\"d1\"&gt; +\n&lt;input type=\"text\" id=\"d2\"&gt; =\n&lt;input type=\"text\" id=\"d3\"&gt;\n&lt;button id=\"btn\"&gt;\u6c42\u548c&lt;/button&gt;\n&lt;script&gt;\n    // \u5148\u7ed9\u6309\u94ae\u7ed1\u5b9a\u4e00\u4e2a\u70b9\u51fb\u4e8b\u4ef6\n    $('#btn').click(function () {\n        // \u671d\u540e\u7aef\u53d1\u9001ajax\u8bf7\u6c42\n        $.ajax({\n            url: '', // 1.\u6307\u5b9a\u671d\u54ea\u4e2a\u540e\u7aef\u53d1\u9001ajax\u8bf7\u6c42\uff0c\u4e0d\u5199\u5c31\u662f\u671d\u5f53\u524d\u5730\u5740\u63d0\u4ea4\n            type: 'post', // 2.\u8bf7\u6c42\u65b9\u5f0f\uff0c\u4e0d\u6307\u5b9a\u9ed8\u8ba4\u5c31\u662fget\n            data: { // 3.\u6570\u636e\n                'v1': $('#d1').val(),\n                'v2': $('#d2').val()\n            },\n            success: function (args) { // 4.\u56de\u8c03\u51fd\u6570:\u5f53\u540e\u7aef\u7ed9\u4f60\u8fd4\u56de\u7ed3\u679c\u7684\u65f6\u5019\u4f1a\u81ea\u52a8\u89e6\u53d1 args\u63a5\u53d7\u540e\u7aef\u7684\u8fd4\u56de\u7ed3\u679c\n                $('#d3').val(args) // \u901a\u8fc7DOM\u64cd\u4f5c\u52a8\u6001\u6e32\u67d3\u5230\u7b2c\u4e09\u4e2ainput\u91cc\u9762#}\n\n            }\n        })\n    })\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u89c6\u56fe\u5c42</p> <pre><code>from django.shortcuts import render, HttpResponse\n\n\ndef index(request):\n    if request.method == 'POST':\n        v1 = request.POST.get('v1')\n        v2 = request.POST.get('v2')\n        return HttpResponse(int(v1) + int(v2))  # \u8981\u5148\u8f6cint\u884c\n    return render(request, 'index.html')\n</code></pre> <p>\u6548\u679c</p> <p></p>"},{"location":"programming/python/Django/view/#52-ajaxjson","title":"5.2 ajax\u53d1\u9001json\u683c\u5f0f\u6570\u636e","text":"<p>\u6a21\u677f\u5c42</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    {% load static %}\n    &lt;script src=\"{% static 'jquery.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\nname:&lt;input type=\"text\" id=\"name\"&gt;\n&lt;br&gt;\nage:&lt;input type=\"text\" id=\"age\"&gt;\n&lt;br&gt;\n&lt;button id=\"btn\"&gt;\u53d1\u9001&lt;/button&gt;\n&lt;script&gt;\n    // \u5148\u7ed9\u6309\u94ae\u7ed1\u5b9a\u4e00\u4e2a\u70b9\u51fb\u4e8b\u4ef6\n    $('#btn').click(function () {\n        // \u671d\u540e\u7aef\u53d1\u9001ajax\u8bf7\u6c42\n        $.ajax({\n            url: '',\n            type: 'post',\n            data: JSON.stringify({\n                'name': $('#name').val(),\n                'age': $('#age').val()\n            }),\n            contentType:'application/json',  // \u6307\u5b9a\u7f16\u7801\u683c\u5f0f\n            success: function () {\n\n            }\n        })\n    })\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u89c6\u56fe\u5c42</p> <pre><code>from django.shortcuts import render, HttpResponse\nimport json\n\n\ndef index(request):\n    if request.method == 'POST':\n        print(request.is_ajax())  # True\n        print(request.body)  # \u6536\u5230\u4e8c\u8fdb\u5236\u7684\u6570\u636e\uff1ab'{\"name\":\"Tom\",\"age\":\"18\"}'\n        # json.loads\u62ec\u53f7\u5185\u5982\u679c\u4f20\u5165\u4e86\u4e00\u4e2a\u4e8c\u8fdb\u5236\u683c\u5f0f\u7684\u6570\u636e\u90a3\u4e48\u5185\u90e8\u81ea\u52a8\u89e3\u7801\u518d\u53cd\u5e8f\u5217\u5316\n        print(json.loads(request.body))  # {'name': 'Tom', 'age': '18'}\n    return render(request, 'index.html')\n</code></pre> <p>ajax\u53d1\u9001json\u683c\u5f0f\u6570\u636e\u9700\u8981\u6ce8\u610f\u70b9:</p> <ol> <li> <p>contentType\u53c2\u6570\u6307\u5b9a\u6210:application/json</p> </li> <li> <p>\u6570\u636e\u662f\u771f\u6b63\u7684json\u683c\u5f0f\u6570\u636e</p> </li> <li> <p>django\u540e\u7aef\u4e0d\u4f1a\u5e2e\u4f60\u5904\u7406json\u683c\u5f0f\u6570\u636e\u9700\u8981\u4f60\u81ea\u5df1\u53bbrequest.body\u83b7\u53d6\u5e76\u5904\u7406</p> </li> </ol>"},{"location":"programming/python/Django/view/#53-ajax","title":"5.3 ajax\u53d1\u9001\u6587\u4ef6","text":"<p>ajax\u53d1\u9001\u6587\u4ef6\u9700\u8981\u501f\u52a9\u4e8ejs\u5185\u7f6e\u5bf9\u8c61FormData\u3002</p> <p>django\u540e\u7aef\u80fd\u591f\u76f4\u63a5\u8bc6\u522b\u5230formdata\u5bf9\u8c61\u5e76\u4e14\u80fd\u591f\u5c06\u5185\u90e8\u7684\u666e\u901a\u952e\u503c\u81ea\u52a8\u89e3\u6790\u5e76\u5c01\u88c5\u5230request.POST\u4e2d\uff0c\u6587\u4ef6\u6570\u636e\u81ea\u52a8\u89e3\u6790\u5e76\u5c01\u88c5\u5230request.FILES\u4e2d\u3002</p> <p>\u6a21\u677f\u5c42</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Title&lt;/title&gt;\n    {% load static %}\n    &lt;script src=\"{% static 'jquery.min.js' %}\"&gt;&lt;/script&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;name:&lt;input type=\"text\" id=\"name\"&gt;&lt;/p&gt;\n&lt;p&gt;age:&lt;input type=\"text\" id=\"age\"&gt;&lt;/p&gt;\n&lt;p&gt;&lt;input type=\"file\" id=\"myfile\"&gt;&lt;/p&gt;\n&lt;button id=\"btn\"&gt;\u53d1\u9001&lt;/button&gt;\n&lt;script&gt;\n    // \u70b9\u51fb\u6309\u94ae\u671d\u540e\u7aef\u53d1\u9001\u666e\u901a\u952e\u503c\u5bf9\u548c\u6587\u4ef6\u6570\u636e\n    $('#btn').on('click', function () {\n        // 1 \u9700\u8981\u5148\u5229\u7528FormData\u5185\u7f6e\u5bf9\u8c61\n        let formDateObj = new FormData();  // \u53ef\u4ee5\u6dfb\u52a0\u666e\u901a\u952e\u503c\u5bf9\uff0c\u4e5f\u53ef\u4ee5\u6dfb\u52a0\u6587\u4ef6\u5bf9\u8c61\n        // 2 \u6dfb\u52a0\u666e\u901a\u7684\u952e\u503c\u5bf9\n        formDateObj.append('name', $('#name').val());\n        formDateObj.append('age', $('#age').val());\n        // 3 \u6dfb\u52a0\u6587\u4ef6\u5bf9\u8c61\n        formDateObj.append('myfile', $('#myfile')[0].files[0])\n        // 4 \u5c06\u5bf9\u8c61\u57fa\u4e8eajax\u53d1\u9001\u7ed9\u540e\u7aef\n        $.ajax({\n            url: '',\n            type: 'post',\n            data: formDateObj,  // \u76f4\u63a5\u5c06\u5bf9\u8c61\u653e\u5728data\u540e\u9762\u5373\u53ef\n\n            // ajax\u53d1\u9001\u6587\u4ef6\u5fc5\u987b\u8981\u6307\u5b9a\u7684\u4e24\u4e2a\u53c2\u6570\n            contentType: false,  // \u4e0d\u9700\u4f7f\u7528\u4efb\u4f55\u7f16\u7801\uff0cdjango\u540e\u7aef\u80fd\u591f\u81ea\u52a8\u8bc6\u522bformdata\u5bf9\u8c61\n            processData: false,  // \u544a\u8bc9\u4f60\u7684\u6d4f\u89c8\u5668\u4e0d\u8981\u5bf9\u4f60\u7684\u6570\u636e\u8fdb\u884c\u4efb\u4f55\u5904\u7406\n\n            success: function (args) {\n            }\n        })\n    })\n&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u89c6\u56fe\u5c42</p> <pre><code>from django.shortcuts import render\n\n\ndef index(request):\n    if request.is_ajax():\n        if request.method == 'POST':\n            print(request.POST)  # &lt;QueryDict: {'name': ['Tom'], 'age': ['age']}&gt;\n            print(request.FILES)  # &lt;MultiValueDict: {'myfile': [&lt;InMemoryUploadedFile: abc.jpg (image/jpeg)&gt;]}&gt;\n    return render(request, 'index.html')\n</code></pre>"},{"location":"programming/python/Flask/blueprint/","title":"\u84dd\u56fe","text":"<p>\u4f5c\u7528\uff1a\u5bf9flask\u7a0b\u5e8f\u8fdb\u884c\u76ee\u5f55\u7ed3\u6784\u7684\u5212\u5206</p>"},{"location":"programming/python/Flask/blueprint/#1","title":"1. \u57fa\u672c\u4f7f\u7528","text":"<pre><code>from flask import Flask, Blueprint\n\nadmin = Blueprint('admin', __name__)\n\n\n@admin.route('/')\ndef index():\n    return \"Admin Index\"\n\n\napp = Flask(__name__)\n# \u6ce8\u518c\u84dd\u56fe\napp.register_blueprint(admin)\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#2","title":"2. \u7ed9\u8def\u7531\u52a0\u524d\u7f00","text":"<pre><code>from flask import Flask, Blueprint\n\nadmin = Blueprint('admin', __name__)\n\n\n@admin.route('/')\ndef index():\n    return \"Admin Index\"\n\n\napp = Flask(__name__)\napp.register_blueprint(admin, url_prefix='/admin')\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#3","title":"3. \u6307\u5b9a\u84dd\u56fe\u7684\u9759\u6001\u6587\u4ef6\u548c\u6a21\u677f\u6587\u4ef6\u4f4d\u7f6e","text":"<pre><code>from flask import Flask, Blueprint\n\nadmin = Blueprint('admin', __name__, static_folder='static', template_folder='templates')\n\n\n@admin.route('/')\ndef index():\n    return \"Admin Index\"\n\n\napp = Flask(__name__)\napp.register_blueprint(admin, url_prefix='/admin')\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#4app","title":"4.\u4f7f\u7528\u84dd\u56fe\u62c6\u5206app","text":"<p>\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b</p> <pre><code>$ tree flaskproject -L 3\nflaskproject\n\u251c\u2500\u2500 admin\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 login.html\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 views.py\n\u251c\u2500\u2500 app.py\n\u251c\u2500\u2500 hello.py\n\u251c\u2500\u2500 templates\n \u00a0\u00a0 \u2514\u2500\u2500 index.html\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#41-app","title":"4.1 \u521b\u5efa\u5355\u72ec\u7684<code>app</code>\u76ee\u5f55\u4ee5\u53ca\u89c6\u56fe\u51fd\u6570\u6587\u4ef6","text":"<p>\u521b\u5efa<code>admin</code>\u76ee\u5f55</p> <pre><code>mkdir flaskproject/admin\n</code></pre> <p>\u521b\u5efa\u89c6\u56fe\u51fd\u6570\u6587\u4ef6<code>views.py</code></p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _8_\n# filename: views.py\n\nfrom flask import Blueprint, render_template\n\n# \u4e0d\u80fd\u88abrun\u7684Flask\u5b9e\u4f8b\uff0c\u84dd\u56fe\u540d\u79f0\u4e0d\u80fd\u91cd\u590d\uff0c\u4fdd\u8bc1\u5728app\u4e2d\u65f6\u552f\u4e00\u7684\nadmin = Blueprint(\"admin\", __name__, url_prefix='/admin', template_folder=\"templates\")\n\n\n# url_prefix URL\u524d\u7f00\uff0c\u7528\u4e8e\u9694\u79bb\u76f8\u540cURL\n@admin.route(\"/login\")\ndef login():\n    return render_template('login.html')\n</code></pre> <p>\u521b\u5efa\u7ed9<code>admin</code>\u4f7f\u7528\u7684templates\u76ee\u5f55\u53ca\u6587\u4ef6<code>templates/login.html</code></p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Admin Login&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;Admin Login&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#42-apppy","title":"4.2 \u5728\u4e3b<code>app.py</code>\u4e2d\u6ce8\u518c\u84dd\u56fe","text":"<pre><code>from flask import Flask, render_template\nfrom admin.views import admin\n\napp = Flask(__name__)\n\napp.register_blueprint(admin)\n\n\n@app.route('/')\ndef index():\n    return render_template(\"index.html\")\n</code></pre> <pre><code>$ curl -s  http://10.0.0.128:5000/admin/login\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;Admin Login&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;p&gt;Admin Login&lt;/p&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#5","title":"5.\u9879\u76ee\u76ee\u5f55\u7ed3\u6784","text":""},{"location":"programming/python/Flask/blueprint/#51","title":"5.1 \u7b80\u5355\u9879\u76ee\u7684\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>flaskproject/\n\u251c\u2500\u2500 blog\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 static\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 views\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 admin.py\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 user.py\n\u2514\u2500\u2500 manage.py\n</code></pre> <p>\u5728<code>admin.py</code>\u4e2d\u5199\u84dd\u56fe</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: admin.py\n\nfrom flask import Blueprint\n\nadmin = Blueprint(\"admin\", __name__, url_prefix='/admin')\n\n\n@admin.route(\"/login\")\ndef login():\n    return \"Login\"\n</code></pre> <p>\u5728<code>blog/__init__.py</code>\u4e2d\u521b\u5efa<code>Flask app</code>\u5e76\u5bfc\u5165\u84dd\u56fe</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: __init__.py\nfrom flask import Flask\nfrom .views.admin import admin\nfrom .views.user import user\n\napp = Flask(__name__)\napp.register_blueprint(admin)\napp.register_blueprint(user)\n</code></pre> <p>\u5728<code>manage.py</code>\u4e2d\u542f\u52a8Flask\u7a0b\u5e8f</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: manage.py\nfrom blog import app\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0')\n</code></pre>"},{"location":"programming/python/Flask/blueprint/#52","title":"5.2 \u5927\u578b\u9879\u76ee\u7684\u76ee\u5f55\u7ed3\u6784","text":"<pre><code>flaskproject\n\u251c\u2500\u2500 blog\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 admin\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 static\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 views.py\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 user\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 __init__.py\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 static\n\u2502\u00a0\u00a0     \u251c\u2500\u2500 templates\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 views.py\n\u2514\u2500\u2500 manage.py\n</code></pre> <p>\u521b\u5efa\u5b50\u5e94\u7528\u76ee\u5f55\uff0c\u5728\u5b50\u5e94\u7528\u7684<code>__init__.py</code>\u6587\u4ef6\u4e2d\u521b\u5efa\u84dd\u56fe</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: __init__.py\n#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: __init__.py\nfrom flask import Blueprint\n\nadmin = Blueprint('admin',\n                  __name__,\n                  url_prefix=\"/admin\",\n                  template_folder=\"templates\",\n                  static_folder=\"static\")\n# \u5fc5\u987b\u7b49\u84dd\u56fe\u521b\u5efa\u4ee5\u540e\u518d\u5bfc\u5165\u89c6\u56fe\u51fd\u6570\nfrom . import views  \n</code></pre> <p>\u521b\u5efa\u5b50\u5e94\u7528\u7684\u89c6\u56fe\u51fd\u6570<code>blog/views.py</code></p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: views.py\n\nfrom . import user\n\n\n@user.route('/')\ndef index():\n    return \"user index\"\n</code></pre> <p>\u5728<code>blog/__init__.py</code>\u5b9e\u4f8b\u5316Flask\u5e76\u6ce8\u518c\u84dd\u56fe</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: __init__.py\n\nfrom flask import Flask\n\nfrom .admin import admin\nfrom .user import user\n\napp = Flask(__name__)\napp.register_blueprint(admin)\napp.register_blueprint(user)\n</code></pre> <p>\u5728<code>manage.py</code>\u4e2d\u542f\u52a8Flask\u7a0b\u5e8f</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: manage.py\nfrom blog import app\n\nif __name__ == '__main__':\n    app.run(host='0.0.0.0')\n</code></pre>"},{"location":"programming/python/Flask/configure/","title":"\u914d\u7f6e","text":""},{"location":"programming/python/Flask/configure/#_2","title":"\u4e00\u3001\u5b9e\u4f8b\u5316\u914d\u7f6e","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__, template_folder='templates', static_folder='static', static_url_path='/static')\n\n# template_folder \u6a21\u677f\u6587\u4ef6\u8def\u5f84\n# static_folder \u9759\u6001\u6587\u4ef6\u8def\u5f84\n# static_url_path \u8bbf\u95ee\u9759\u6001\u6587\u4ef6\u65f6\u4f7f\u7528\u7684\u8def\u5f84\n# static_host  \u9759\u6001\u6587\u4ef6\u8bbf\u95ee\u670d\u52a1HOST\uff0c\u6307\u5411\u5230\u53e6\u4e00\u53f0\u670d\u52a1\u5668\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre>"},{"location":"programming/python/Flask/configure/#_3","title":"\u4e8c\u3001\u5bf9\u8c61\u914d\u7f6e","text":"<p>\u914d\u7f6e\u672c\u8d28\u662f\u901a\u8fc7<code>Flask</code>\u5bf9\u8c61\u7684<code>config</code>\u5c5e\u6027\u6765\u914d\u7f6e\u7684\u3002</p>"},{"location":"programming/python/Flask/configure/#1","title":"1. \u901a\u8fc7\u5b57\u5178\u7684\u65b9\u5f0f\u914d\u7f6e","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\napp['DEBUG'] = True\n\n\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre> <p>\u4f7f\u7528<code>update()</code>\u65b9\u6cd5\u53ef\u4ee5\u540c\u65f6\u914d\u7f6e\u591a\u4e2a\u503c</p> <pre><code>from flask import Flask\n\napp = Flask(__name__)\napp.config.update(\n    DEBUG=True,\n    SECRET_KEY='_5#y2L\"F4Q8z\\n\\xec]/',\n)\n\n\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre>"},{"location":"programming/python/Flask/configure/#2-flask","title":"2. \u901a\u8fc7Flask\u5bf9\u8c61\u5c5e\u6027\u7684\u65b9\u5f0f\u914d\u7f6e","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\napp.debug = True\n\n\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre>"},{"location":"programming/python/Flask/configure/#3","title":"3. \u901a\u8fc7\u914d\u7f6e\u6587\u4ef6","text":"<p>\u901a\u8fc7\u7c7b\u7684\u65b9\u5f0f\u5c06\u6240\u6709\u7684\u914d\u7f6e\u5199\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d,\u6bd4\u5982<code>settings.py</code>\u3002</p> <pre><code>class Config(object):\n    \"\"\"Base config, uses staging database server.\"\"\"\n    DEBUG = False\n    TESTING = False\n    DB_SERVER = '192.168.1.56'\n\n    @property\n    def DATABASE_URI(self):  # Note: all caps\n        return 'mysql://user@{}/foo'.format(self.DB_SERVER)\n\n\nclass ProductionConfig(Config):\n    \"\"\"Uses production database server.\"\"\"\n    DB_SERVER = '192.168.19.32'\n\n\nclass DevelopmentConfig(Config):\n    DB_SERVER = 'localhost'\n    DEBUG = True\n\n\nclass TestingConfig(Config):\n    DB_SERVER = 'localhost'\n    DEBUG = True\n    DATABASE_URI = 'sqlite:///:memory:'\n</code></pre> <p>\u7136\u540e\u5728<code>app.py</code>\u6587\u4ef6\u4e2d\u5bfc\u5165\u914d\u7f6e</p> <pre><code>from flask import Flask\n\napp = Flask(__name__)\napp.config.from_object('settings.DevelopmentConfig')\n\n\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre>"},{"location":"programming/python/Flask/context/","title":"\u4e0a\u4e0b\u6587","text":"<p>\u7a0b\u5e8f\u4e0a\u4e0b\u6587</p> <p>\u8bf7\u6c42\u4e0a\u4e0b\u6587</p> <p>\u4e0a\u4e0b\u6587\u6e90\u7801\u5206\u6790</p> <p>\u7b2c\u4e00\u9636\u6bb5 \u5c06ctx\u653e\u5230Local</p> <p>\u7b2c\u4e8c\u9636\u6bb5 \u89c6\u56fe\u51fd\u6570\u5bfc\u5165</p> <p>\u7b2c\u4e09\u9636\u6bb5 \u8bf7\u6c42\u5904\u7406\u5b8c\u6bd5\uff0c\u5c06session\u4fdd\u5b58\u5230cookie\uff0c\u5c06ctx\u5220\u9664</p> <p>g\u5bf9\u8c61\uff0c\u53ea\u5728\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\u4e2d\u5b58\u5728\u3002</p> <pre><code>from flask import Flask, g\n\napp = Flask(__name__)\n\n\n@app.before_request\ndef before():\n    g.x = 5\n\n\n@app.route('/')\ndef index():\n    print(g.x)  # 5\n    return \"Hello World\"\n</code></pre>"},{"location":"programming/python/Flask/cookie%26session/","title":"Cookie&amp;Session","text":""},{"location":"programming/python/Flask/cookie%26session/#cookie","title":"\u4e00\u3001Cookie","text":"<pre><code>from flask import Flask, make_response, request\n\napp = Flask(__name__)\n\n\n@app.route('/login')\ndef login():\n    response = make_response(\"Hello World!\")\n    response.set_cookie(\"user\", \"admin\")\n    return \"ok\"\n\n\n@app.route('/index')\ndef index():\n    return request.cookies.get('user')\n</code></pre>"},{"location":"programming/python/Flask/cookie%26session/#session","title":"\u4e8c\u3001Session","text":"<pre><code>from flask import Flask, session\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'UxlucZVeYToAjpMULTNOEw=='\n\n\n@app.route('/login')\ndef login():\n    session['user'] = 'root'\n    return \"Login\"\n\n\n@app.route('/')\ndef index():\n    return session['user']\n</code></pre> <p>\u5bf9\u5b57\u5178\u4e2d\u7684\u4e8c\u7ea7\u952e\u4fee\u6539\uff0c\u4e0d\u4f1a\u4fdd\u5b58session</p> <pre><code>SESSION_REFRESH_EACH_REQUEST = True\n</code></pre> <p>\u8bf7\u6c42\u5230\u6765\u4e4b\u540e\uff0c\u4f1a\u5c06request\u548csession\u5c01\u88c5\u6210RequestContext\u5bf9\u8c61\uff0c\u901a\u8fc7LocalStack\u5b58\u653e\u5230Local\u5bf9\u8c61\u4e2d\uff0c\u8c03\u7528open_session\u65b9\u6cd5\uff0c\u5c06\u8bf7\u6c42cookie\u4e2d\u7684session\u8d4b\u503c\u7ed9ctx\uff0c\u8fd4\u56de\u7684\u65f6\u5019\u8c03\u7528save_session\u65b9\u6cd5\uff0c\u8bfb\u53d6ctx\u4e2dsession\u5e76\u5e8f\u5217\u5316\u5199\u5165cookie\u8fd4\u56de\uff0c\u6700\u540e\u4ecectx\u4e2d\u5220\u9664\u3002</p>"},{"location":"programming/python/Flask/flashing/","title":"\u95ea\u73b0","text":"<p>\u5de5\u4f5c\u65b9\u5f0f\uff1a\u5728\u4e14\u53ea\u5728\u4e0b\u4e00\u4e2a\u8bf7\u6c42\u4e2d\u8bbf\u95ee\u4e0a\u4e00\u4e2a\u8bf7\u6c42\u7ed3\u675f\u65f6\u8bb0\u5f55\u7684\u6d88\u606f\u3002</p> <pre><code>from flask import Flask, flash, get_flashed_messages\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'UxlucZVeYToAjpMULTNOEw=='\n\n\n@app.route('/login')\ndef login():\n    # \u6d88\u606f\u53ef\u4ee5\u5b58\u5165\u591a\u6b21\n    flash(\"\u767b\u5f55\u6210\u529f\", 'info')\n    flash(\"\u767b\u5f55\u5931\u8d25\", 'error')\n    return \"Login\"\n\n\n@app.route('/')\ndef index():\n    # \u8fc7\u6ee4\u95ea\u73b0\u6d88\u606f\n    messages = get_flashed_messages(category_filter=['info'])\n    data = \";\".join(messages)\n    return data\n\n# \u767b\u5f55\u6210\u529f;\u767b\u5f55\u6210\u529f;\u767b\u5f55\u6210\u529f\n</code></pre> <p>\u5728\u6a21\u677f\u6587\u4ef6\u4e2d\u4f7f\u7528</p> <pre><code>{% with errors = get_flashed_messages(category_filter=[\"error\"]) %}\n    {% if errors %}\n        &lt;div class=\"alert-message block-message error\"&gt;\n            &lt;a class=\"close\" href=\"#\"&gt;\u00d7&lt;/a&gt;\n            &lt;ul&gt;\n                {%- for msg in errors %}\n                    &lt;li&gt;{{ msg }}&lt;/li&gt;\n                {% endfor -%}\n            &lt;/ul&gt;\n        &lt;/div&gt;\n    {% endif %}\n{% endwith %}\n</code></pre> <p>\u8fd4\u56de\u6d88\u606f\u7c7b\u522b</p> <pre><code>@app.route('/')\ndef index():\n    print(get_flashed_messages(with_categories=True)) # [('info', '\u767b\u5f55\u6210\u529f'), ('error', '\u767b\u5f55\u5931\u8d25')]\n    return \"xx\"\n</code></pre>"},{"location":"programming/python/Flask/install/","title":"\u7b80\u4ecb\u4e0e\u5b89\u88c5","text":""},{"location":"programming/python/Flask/install/#_2","title":"\u4e00\u3001\u7b80\u4ecb","text":"<p>\u5b98\u65b9\u6587\u6863\uff1ahttps://flask.palletsprojects.com/</p> <pre><code>$ pip install flask==1.1.2\n$ pipdeptree -p flask\nFlask==1.1.2\n  - click [required: &gt;=5.1, installed: 7.0]\n  - itsdangerous [required: &gt;=0.24, installed: 1.1.0]\n  - Jinja2 [required: &gt;=2.10.1, installed: 2.10.3]\n    - MarkupSafe [required: &gt;=0.23, installed: 1.1.1]\n  - Werkzeug [required: &gt;=0.15, installed: 1.0.1]\n</code></pre> <p>\u5404\u7ec4\u4ef6\u7684\u4f5c\u7528\uff1a</p> <ul> <li>Werkzeug \uff08\u5fb7\u8bed\uff1a\u5de5\u5177\uff09\u7528\u4e8e\u5b9e\u73b0 WSGI \uff0c\u5e94\u7528\u548c\u670d\u52a1\u4e4b\u95f4\u7684\u6807\u51c6 Python \u63a5\u53e3\u3002 </li> <li>Jinja \u7528\u4e8e\u6e32\u67d3\u9875\u9762\u7684\u6a21\u677f\u8bed\u8a00\u3002 </li> <li>MarkupSafe \u4e0e Jinja \u5171\u7528\uff0c\u5728\u6e32\u67d3\u9875\u9762\u65f6\u7528\u4e8e\u907f\u514d\u4e0d\u53ef\u4fe1\u7684\u8f93\u5165\uff0c\u9632\u6b62\u6ce8\u5165\u653b\u51fb\u3002 </li> <li>ItsDangerous \u4fdd\u8bc1\u6570\u636e\u5b8c\u6574\u6027\u7684\u5b89\u5168\u6807\u5fd7\u6570\u636e\uff0c\u7528\u4e8e\u4fdd\u62a4 Flask \u7684 session cookie. </li> <li>Click \u662f\u4e00\u4e2a\u547d\u4ee4\u884c\u5e94\u7528\u7684\u6846\u67b6\u3002\u7528\u4e8e\u63d0\u4f9b flask \u547d\u4ee4\uff0c\u5e76\u5141\u8bb8\u6dfb\u52a0\u81ea\u5b9a\u4e49\u7ba1\u7406\u547d\u4ee4\u3002 </li> </ul> <p>\u901a\u8fc7werkzeug\u542f\u52a8\u4e00\u4e2ahttp\u670d\u52a1\uff1a</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: test.py\nfrom werkzeug.serving import run_simple\nfrom werkzeug.wrappers import Response, Request\n\n\n@Request.application\ndef app(request):\n    print(request)  # &lt;Request 'http://localhost:8000/' [GET]&gt;\n    print(type(request))  # &lt;class 'werkzeug.wrappers.request.Request'&gt;\n    return Response(\"Hello World!\")\n\n\nif __name__ == '__main__':\n    run_simple('localhost', 8000, app)\n</code></pre>"},{"location":"programming/python/Flask/install/#flask","title":"\u4e8c\u3001\u7b2c\u4e00\u4e2aFlask\u7a0b\u5e8f","text":""},{"location":"programming/python/Flask/install/#1","title":"1. \u521b\u5efa\u865a\u62df\u73af\u5883","text":""},{"location":"programming/python/Flask/install/#11","title":"1.1 \u64cd\u4f5c\u7cfb\u7edf","text":"<pre><code>$ lsb_release  -a\nNo LSB modules are available.\nDistributor ID: Ubuntu\nDescription:    Ubuntu 18.04.5 LTS\nRelease:    18.04\nCodename:   bionic\n</code></pre>"},{"location":"programming/python/Flask/install/#12-python3-venv","title":"1.2 \u5b89\u88c5<code>python3-venv</code>","text":"<pre><code>sudo apt-get install python3-venv -y\n</code></pre>"},{"location":"programming/python/Flask/install/#13","title":"1.3 \u521b\u5efa\u9879\u76ee\u6587\u4ef6\u5939\u548c\u865a\u62df\u73af\u5883","text":"<pre><code>$ mkdir flaskproject\n$ cd flaskproject/\n$ python3 -m venv venv\n</code></pre>"},{"location":"programming/python/Flask/install/#14","title":"1.4 \u6fc0\u6d3b\u865a\u62df\u73af\u5883","text":"<pre><code>$ . venv/bin/activate\n(venv) gp@ubuntu:~/flaskproject$\n</code></pre>"},{"location":"programming/python/Flask/install/#2-flask","title":"2. \u5b89\u88c5Flask","text":"<pre><code>(venv) gp@ubuntu:~/flaskproject$ pip3 install Flask==1.1.2\n</code></pre>"},{"location":"programming/python/Flask/install/#3-flask","title":"3. \u521b\u5efaflask\u5e94\u7528","text":"<pre><code>#!/usr/bin/env python3\n# filename: hello.py\nfrom flask import Flask\n\napp = Flask(__name__)  # __name__\u7684\u503c\u662fhello,\u5f53\u524d\u6587\u4ef6\u7684\u6587\u4ef6\u540d\u3002 \n# __name__\u662f\u4e3b\u6a21\u5757\u6216\u5305\u7684\u540d\u79f0\u3002\u7528\u6765\u786e\u5b9a\u7a0b\u5e8f\u7684\u4f4d\u7f6e\uff0c\u4ece\u800c\u627e\u5230\u6a21\u677f\u6587\u4ef6\u548c\u9759\u6001\u6587\u4ef6\u7684\u4f4d\u7f6e\u3002\n\n@app.route('/')  # \u8def\u7531\ndef hello_world():  # \u4e0e\u8def\u7531\u7ed1\u5b9a\u7684\u89c6\u56fe\u51fd\u6570\uff0c\u8bd5\u56fe\u51fd\u6570\u540d\u5c3d\u53ef\u80fd\u552f\u4e00\n    return 'Hello, World!'\n</code></pre> <p>Flask\u5e94\u7528\u5fc5\u987b\u521b\u5efa\u4e00\u4e2a\u5e94\u7528\u5b9e\u4f8b\uff0c\u8fd9\u4e2a\u5b9e\u4f8b\u5c31\u662fFlask\u7c7b\u7684\u5bf9\u8c61\u3002\u5c31\u662f\u8fd9\u91cc\u7684<code>app</code>\u3002Web\u670d\u52a1\u5668\u901a\u8fc7WSGI\u534f\u8bae\uff0c\u628a\u63a5\u6536\u81ea\u5ba2\u6237\u7aef\u7684\u6240\u6709\u8bf7\u6c42\u90fd\u4ea4\u7ed9\u8fd9\u4e2a\u5bf9\u8c61\u5904\u7406\u3002</p>"},{"location":"programming/python/Flask/install/#4-flask","title":"4. \u542f\u52a8Flask\u5e94\u7528","text":"<pre><code>(venv) gp@ubuntu:~/flaskproject$ export FLASK_APP=hello.py\n(venv) gp@ubuntu:~/flaskproject$ export FLASK_ENV=development  # \u6253\u5f00\u6240\u6709\u5f00\u53d1\u529f\u80fd\uff0c\u5305\u62ec\u8c03\u8bd5\u6a21\u5f0f\n(venv) gp@ubuntu:~/flaskproject$ flask run --host=0.0.0.0  # \u76d1\u542c\u6240\u6709\u64cd\u4f5c\u7cfb\u7edf\u516c\u5f00\u7684IP\n * Serving Flask app \"hello.py\" (lazy loading)\n * Environment: development\n * Debug mode: on\n * Running on all addresses.\n   WARNING: This is a development server. Do not use it in a production deployment.\n * Running on http://10.0.0.128:5000/ (Press CTRL+C to quit)\n * Restarting with stat\n * Debugger is active!\n * Debugger PIN: 380-155-360\n</code></pre>"},{"location":"programming/python/Flask/install/#5-flask","title":"5. \u8bbf\u95eeFlask\u5e94\u7528","text":"<pre><code>$ curl -s http://10.0.0.128:5000/\nHello, World!\n</code></pre>"},{"location":"programming/python/Flask/middleware/","title":"\u4e2d\u95f4\u4ef6","text":"<pre><code>from flask import Flask\n\n\nclass MyMiddleWare(object):\n    def __init__(self, old_wsgi_app):\n        # \u670d\u52a1\u542f\u52a8\u65f6\u81ea\u52a8\u6267\u884c\n        self.old_wsgi_app = old_wsgi_app\n\n    def __call__(self, environ, start_response):\n        # \u6bcf\u6b21\u6709\u7528\u6237\u8bf7\u6c42\u5230\u6765\u65f6\u6267\u884c\n        print(\"before\")\n        obj = self.old_wsgi_app(environ, start_response)\n        print(\"after\")\n        return obj\n\n\napp = Flask(__name__)\napp.wsgi_app = MyMiddleWare(app.wsgi_app)\napp.config['SECRET_KEY'] = 'UxlucZVeYToAjpMULTNOEw=='\n\n\n@app.route('/')\ndef index():\n    print(\"\u89c6\u56fe\u51fd\u6570\")\n    return \"Hello World\"\n</code></pre>"},{"location":"programming/python/Flask/request%26response/","title":"\u8bf7\u6c42\u548c\u54cd\u5e94","text":""},{"location":"programming/python/Flask/request%26response/#_2","title":"\u4e00\u3001\u8bf7\u6c42","text":""},{"location":"programming/python/Flask/request%26response/#1","title":"1.\u8bf7\u6c42\u65b9\u6cd5","text":""},{"location":"programming/python/Flask/request%26response/#11-formdata","title":"1.1 \u83b7\u53d6<code>formdata</code>\u4e2d\u7684\u6570\u636e","text":"<pre><code>from flask import Flask, render_template, request\n\napp = Flask(__name__)\n\n\n@app.route('/login', methods=[\"GET\", \"POST\"])\ndef login():\n    if request.method == \"GET\":\n        return render_template('login.html')\n    if request.method == \"POST\":\n        print(request.form)  # ImmutableMultiDict([('username', 'admin'), ('password', '123456')])\n        print(request.form.to_dict())  # {'username': 'admin', 'password': '123456'}\n        print(request.form.get('username'))  # admin\n        return \"ok\"\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#12","title":"1.2 \u83b7\u53d6\u8bf7\u6c42\u65b9\u6cd5","text":"<pre><code>request.method\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#13-url","title":"1.3 \u83b7\u53d6<code>URL</code>\u4e2d\u7684\u53c2\u6570","text":"<pre><code>request.args  # ImmutableMultiDict([('page', '1')])\nrequest.args.get('page')  # 1\nrequest.args.to_dict()  # {'page': '1'}\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#14","title":"1.4 \u63a5\u6536\u6587\u4ef6","text":"<p>\u521b\u5efa\u6a21\u677f\u6587\u4ef6\u63a5\u6536\u6587\u4ef6</p> <pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n&lt;head&gt;\n    &lt;meta charset=\"UTF-8\"&gt;\n    &lt;title&gt;File&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n&lt;form action=\"\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n    &lt;p&gt;&lt;input type=\"file\" name=\"myfile\"&gt;&lt;/p&gt;\n    &lt;input type=\"submit\" value=\"\u4e0a\u4f20\"&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u4fdd\u5b58\u6587\u4ef6</p> <pre><code>from flask import Flask, render_template, request\n\napp = Flask(__name__)\n\n\n@app.route('/file', methods=[\"GET\", \"POST\"])\ndef user():\n    if request.method == \"GET\":\n        return render_template('file.html')\n    if request.method == \"POST\":\n        print(request.files)  # ImmutableMultiDict([('myfile', &lt;FileStorage: 'George.jpg' ('image/jpeg')&gt;)])\n        print(request.files.get('myfile'))  # &lt;FileStorage: 'George.jpg' ('image/jpeg')&gt;\n        my_file = request.files.get('myfile')\n        my_file.save(my_file.filename)\n        return \"ok\"\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#15-url","title":"1.5 URL\u76f8\u5173","text":"<pre><code>request.url           # http://10.0.0.128:5000/user?page=1\nrequest.url_root      # http://10.0.0.128:5000/\nrequest.base_url      # http://10.0.0.128:5000/user\nrequest.host_url      # http://10.0.0.128:5000/\nrequest.url_charset   # utf-8   url\u7f16\u7801\u65b9\u5f0f\nrequest.full_path     # /user?page=1\nrequest.host          # 10.0.0.128:5000\nrequest.path          # /user\nrequest.url_rule      # /user\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#16","title":"1.6  \u5176\u4ed6\u6570\u636e","text":"<pre><code>request.cookies       # ImmutableMultiDict([('user', 'admin')])\nrequest.headers \nrequest.data          # b'{\"name\":\"admin\"}' Content-Type\u65e0\u6cd5\u88ab\u8bc6\u522b\u6216\u4e0d\u5305\u542bform\u5b57\u6bb5\u65f6\uff0c\u83b7\u53d6\u8bf7\u6c42\u4f53\u4e2d\u7684\u6570\u636e\nrequest.json          # {'name': 'admin'} \u83b7\u53d6Content-Type:application/json\u65f6\u63d0\u53ca\u7684\u6570\u636e\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#2","title":"2. \u8bf7\u6c42\u94a9\u5b50","text":""},{"location":"programming/python/Flask/request%26response/#1-before_request","title":"1. <code>before_request</code>","text":"<p>\u6bcf\u6b21\u8bf7\u6c42\u4e4b\u524d\u8fd0\u884c\uff0c\u8fd0\u884c\u987a\u5e8f\u6309\u4ee3\u7801\u7684\u987a\u5e8f\u6267\u884c\u3002</p> <pre><code>from flask import Flask\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'UxlucZVeYToAjpMULTNOEw=='\n\n\n@app.before_request\ndef before_part1():\n    print(\"\u8bf7\u6c42\u4e4b\u524d part1\")\n\n\n@app.before_request\ndef before_part2():\n    print(\"\u8bf7\u6c42\u4e4b\u524d part2\")\n\n\n@app.route('/')\ndef index():\n    print(\"\u89c6\u56fe\u51fd\u6570\")\n    return \"Hello World\"\n\n# \u8bf7\u6c42\u4e4b\u524d part1\n# \u8bf7\u6c42\u4e4b\u524d part2\n# \u89c6\u56fe\u51fd\u6570\n</code></pre> <p>\u5982\u679c<code>before_request</code>\u88c5\u9970\u7684\u51fd\u6570\u4e2d\u6709<code>return</code>\uff0c\u8df3\u8fc7\u540e\u7eed\u7684<code>before_request</code>\u548c\u89c6\u56fe\u51fd\u6570\uff0c\u76f4\u63a5\u6267\u884c<code>after_request</code></p>"},{"location":"programming/python/Flask/request%26response/#2-before_first_request","title":"2. <code>before_first_request</code>","text":"<p>\u7a0b\u5e8f\u542f\u52a8\u540e\uff0c\u53ea\u6709\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u4f1a\u6267\u884c\u3002</p>"},{"location":"programming/python/Flask/request%26response/#3-after_request","title":"3. <code>after_request</code>","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'UxlucZVeYToAjpMULTNOEw=='\n\n\n@app.before_request\ndef before_part1():\n    print(\"\u8bf7\u6c42\u4e4b\u524d part1\")\n    # \u5728\u6b64\u5904\u6709return \uff0c\u4f1a\u8df3\u8fc7\u89c6\u56fe\u51fd\u6570\uff0c\u76f4\u63a5\u6267\u884cafter_request\n    return \"\u8bf7\u6c42\u4e4b\u524d part1\"\n\n\n@app.after_request\ndef after_part1(response):\n    print(\"\u8bf7\u6c42\u4e4b\u540e part1\")\n    return response\n\n\n@app.after_request\ndef after_part1(response):\n    print(\"\u8bf7\u6c42\u4e4b\u540e part2\")\n    return response\n\n\n@app.route('/')\ndef index():\n    print(\"\u89c6\u56fe\u51fd\u6570\")\n    return \"Hello World\"\n\n# \u8bf7\u6c42\u4e4b\u524d part1\n# \u8bf7\u6c42\u4e4b\u540e part2\n# \u8bf7\u6c42\u4e4b\u540e part1\n</code></pre> <p><code>after_request</code>\u53ef\u4ee5\u53e0\u52a0\u591a\u4e2a\uff0c\u6267\u884c\u987a\u5e8f\u6309\u4ee3\u7801\u987a\u5e8f\u5012\u5e8f\u6267\u884c\u3002</p>"},{"location":"programming/python/Flask/request%26response/#4-teardown_request","title":"4. <code>teardown_request</code>","text":""},{"location":"programming/python/Flask/request%26response/#_3","title":"\u4e8c\u3001\u54cd\u5e94","text":""},{"location":"programming/python/Flask/request%26response/#1_1","title":"1. \u8fd4\u56de\u5b57\u7b26\u4e32","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\n\n\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#2_1","title":"2. \u8fd4\u56de\u6a21\u677f\u6587\u4ef6","text":"<p>\u521b\u5efa\u6a21\u677f\u6587\u4ef6</p> <pre><code>$ mkdir templates\n$ cd templates/\n$ cat index.html\n&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n    &lt;head&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;title&gt;Title&lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        Hello World!\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u6b64\u65f6\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>$ tree -L 2\n.\n\u251c\u2500\u2500 hello.py\n\u251c\u2500\u2500 templates\n \u00a0\u00a0 \u2514\u2500\u2500 index.html\n</code></pre> <p>\u4f7f\u7528<code>render_template</code>\u8fd4\u56de\u6a21\u677f\u6587\u4ef6</p> <pre><code>from flask import Flask, render_template\n\napp = Flask(__name__)\n\n\n@app.route('/')\ndef index():\n    return render_template('index.html')\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#3-response","title":"3. \u8fd4\u56deresponse\u5bf9\u8c61","text":"<p>\u5982\u679c\u9700\u8981\u8fd4\u56decookie\u548c\u8bf7\u6c42\u5934\u7b49\uff0c\u9700\u8981\u901a\u8fc7<code>make_response()</code></p> <pre><code>from flask import Flask, make_response\n\napp = Flask(__name__)\n\n\n@app.route('/')\ndef index():\n    response = make_response(\"Hello World!\")\n    response.set_cookie('user', 'admin')\n    return response\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#4-json","title":"4. \u8fd4\u56de<code>json</code>","text":"<pre><code>from flask import Flask, jsonify\n\napp = Flask(__name__)\n\ndata = {\n    'user': 'root',\n    'group': 'root',\n}\n\n\n@app.route('/')\ndef index():\n    return jsonify(data)\n</code></pre> <p>\u4f7f\u7528<code>curl</code>\u547d\u4ee4\u8bbf\u95ee</p> <pre><code>$ curl -s  http://127.0.0.1:5000/\n{\"group\":\"root\",\"user\":\"root\"}\n</code></pre> <p>\u8fd4\u56de\u7684\u662f\u6807\u51c6\u683c\u5f0f\u7684<code>json</code>:<code>Content-Type: application/json</code></p> <pre><code>$ curl -I  http://10.0.0.128:5000/\nHTTP/1.0 200 OK\nContent-Type: application/json\nContent-Length: 31\nServer: Werkzeug/1.0.1 Python/3.6.9\nDate: Sun, 20 Jun 2021 12:33:56 GMT\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#5","title":"5. \u91cd\u5b9a\u5411","text":"<pre><code>from flask import Flask, redirect\n\napp = Flask(__name__)\n\n\n@app.route('/login')\ndef login():\n    return redirect('/')\n\n\n@app.route('/')\ndef index():\n    return 'Hello World!'\n</code></pre> <pre><code>$ curl -s -i -L  http://10.0.0.128:5000/login\nHTTP/1.0 302 FOUND   # 302\u91cd\u5b9a\u5411\nContent-Type: text/html; charset=utf-8\nContent-Length: 208\nLocation: http://10.0.0.128:5000/  # \u91cd\u5b9a\u5411\u5230/\nServer: Werkzeug/2.0.1 Python/3.6.9\nDate: Sun, 20 Jun 2021 03:33:27 GMT\n\nHTTP/1.0 200 OK\nContent-Type: text/html; charset=utf-8\nContent-Length: 12\nServer: Werkzeug/2.0.1 Python/3.6.9\nDate: Sun, 20 Jun 2021 03:33:27 GMT\n\nHello World!\n</code></pre>"},{"location":"programming/python/Flask/request%26response/#6","title":"6. \u8fd4\u56de\u6587\u4ef6","text":"<pre><code>from flask import Flask, send_file\n\napp = Flask(__name__)\n\n\n@app.route('/peppa')\ndef index():\n    return send_file('Peppa.jpg')\n</code></pre> <p><code>send_file</code>\uff1a\u6253\u5f00\u5e76\u8fd4\u56de\u6587\u4ef6\u5185\u5bb9\u3002\u53ef\u4ee5\u81ea\u52a8\u8bc6\u522b\u6587\u4ef6\u7c7b\u578b\uff0c\u5728\u54cd\u5e94\u5934\u4e2d\u52a0\u5165 Content-Type: \u6587\u4ef6\u7c7b\u578b \u3002\u6587\u4ef6\u7c7b\u578b\u662f\u53ef\u4ee5\u88ab\u6d4f\u89c8\u5668\u8bc6\u522b\u7684\uff0c\u5982\u679c\u5185\u5bb9\u4e0d\u80fd\u88ab\u5ba2\u6237\u7aef\u8bc6\u522b\uff0c\u5ba2\u6237\u7aef\u4f1a\u6267\u884c\u4e0b\u8f7d\u5904\u7406\u3002</p>"},{"location":"programming/python/Flask/request%26response/#_4","title":"\u4e09\u3001\u81ea\u5b9a\u4e49\u9519\u8bef\u9875\u9762","text":"<p>\u901a\u8fc7<code>app.errorhandler</code>\u88c5\u9970\u5668\u81ea\u5b9a\u4e49\u9519\u8bef\u9875\u9762\u3002</p> <pre><code>from flask import Flask, render_template\n\napp = Flask(__name__)\n\n\n@app.route('/')\ndef index():\n    return \"Hello World\"\n\n\n@app.errorhandler(404)\ndef page_not_found(e):\n    return render_template('404.html'), 404\n\n\n@app.errorhandler(500)\ndef page_not_found(e):\n    return render_template('500.html'), 500\n</code></pre>"},{"location":"programming/python/Flask/route/","title":"\u8def\u7531","text":""},{"location":"programming/python/Flask/route/#_2","title":"\u4e00\u3001\u8def\u7531\u7684\u4f5c\u7528","text":"<p>\u7528\u6765\u5904\u7406URL\u548c\u51fd\u6570\u4e4b\u95f4\u7684\u5173\u7cfb\u3002</p>"},{"location":"programming/python/Flask/route/#_3","title":"\u4e8c\u3001\u8def\u7531\u7684\u521b\u5efa","text":""},{"location":"programming/python/Flask/route/#1","title":"1. \u901a\u8fc7\u88c5\u9970\u5668\u521b\u5efa","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\n\n\n@app.route('/')\ndef index():\n    return \"Hello World!\"\n</code></pre> <p><code>app.route()</code>\u6e90\u7801\u5206\u6790</p> <pre><code>class Flask(_PackageBoundObject):\n\n    def route(self, rule, **options):\n        def decorator(f):\n            # \u901a\u8fc7route\u65b9\u6cd5\uff0c\u628arule\u548coptions\u53c2\u6570\u4f20\u9012\u8fdb\u6765\uff0c\u8fdb\u884c\u4e00\u4e9b\u5904\u7406\uff08\u7ed1\u5b9a\u8def\u7531\u5173\u7cfb\uff09\n            endpoint = options.pop(\"endpoint\", None)\n            self.add_url_rule(rule, endpoint, f, **options)\n            return f # \u5c06\u88ab\u88c5\u9970\u7684\u89c6\u56fe\u51fd\u6570\u539f\u5c01\u4e0d\u52a8\u7684\u8fd4\u56de\n\n        return decorator\n</code></pre> <pre><code>@app.route('/', methods=['GET', 'POST'], endpoint='index')\ndef index():\n    return \"Hello World!\"\n\n# ==&gt; index=app.route('/', methods=['GET', 'POST'], endpoint='index')(index)\n# ==&gt; index=decorator(index)\n</code></pre>"},{"location":"programming/python/Flask/route/#2-add_url_rule","title":"2. \u901a\u8fc7<code>add_url_rule()</code>\u65b9\u6cd5\u521b\u5efa","text":"<p>\u901a\u8fc7\u5206\u6790<code>route()</code>\u88c5\u9970\u5668\u7684\u6e90\u7801\u53ef\u77e5\uff0c\u8def\u7531\u5173\u7cfb\u5176\u5b9e\u662f\u901a\u8fc7<code>add_url_rule()</code>\u65b9\u6cd5\u6765\u521b\u5efa\u7684\u3002</p> <pre><code>from flask import Flask\n\napp = Flask(__name__)\n\n\ndef index():\n    return \"Hello World!\"\n\n\napp.add_url_rule('/', 'index', index, methods=['GET', 'POST'])\n</code></pre>"},{"location":"programming/python/Flask/route/#url_for","title":"\u4e09\u3001<code>url_for()</code>","text":"<p>\u7528\u9014\uff1a\u53cd\u5411\u751f\u6210URL</p> <pre><code>from flask import Flask, url_for\n\napp = Flask(__name__)\n\n\n@app.route('/', methods=['GET', 'POST'], endpoint='root')\ndef index():\n    return \"Hello World!\"\n\n\n@app.route('/page')\ndef page():\n    print(\"root path: %s\" % format(url_for('root')))\n    return \"page\"\n</code></pre>"},{"location":"programming/python/Flask/route/#route","title":"\u56db\u3001<code>route()</code>\u53c2\u6570","text":"<ol> <li><code>endpoint</code>\uff1a\u5bf9\u5e94\u89c6\u56fe\u51fd\u6570\uff0c\u9ed8\u8ba4\u662f\u89c6\u56fe\u51fd\u6570\u540d</li> <li> <p><code>methods</code>\uff1a\u5141\u8bb8\u8bf7\u6c42\u7684\u65b9\u5f0f\u3002<code>methods = [\"GET\",\"POST\"]</code></p> </li> <li> <p><code>defaults</code>\uff1a\u7ed9\u89c6\u56fe\u51fd\u6570\u63d0\u4f9b\u9ed8\u8ba4\u53c2\u6570\u3002<code>defaults={'page':1}</code></p> </li> <li><code>strict_slashes</code>\uff1a\u5bf9URL\u540e\u7684<code>/</code>\u662f\u5426\u4e25\u683c\u8981\u6c42\u3002strict_slashes=False`</li> <li><code>redirect_to</code>\uff1a308\u6c38\u4e45\u91cd\u5b9a\u5411\uff0c\u6ca1\u6709\u8fdb\u5165\u89c6\u56fe\uff0c\u76f4\u63a5\u8df3\u8f6c\u3002<code>redirect_to='http://www.baidu.com'</code></li> <li><code>subdomain</code>\uff1a\u83b7\u53d6\u88ab\u8bbf\u95eeURL\u7684\u5b50\u57df\u540d\u3002<code>subdomain='&lt;subdomain_name&gt;'</code></li> </ol> <p>\u5b8c\u6574\u53c2\u6570\u5728werkzeug.routing.Rule</p>"},{"location":"programming/python/Flask/route/#_4","title":"\u4e94\u3001\u52a8\u6001\u8def\u7531","text":""},{"location":"programming/python/Flask/route/#1_1","title":"1. \u5185\u7f6e\u8f6c\u6362\u5668","text":"\u7c7b\u578b \u4f5c\u7528 string \u7f3a\u7701\u503c\uff0c\u63a5\u6536\u4efb\u4f55\u4e0d\u5305\u542b\u659c\u6760\u7684\u6587\u672c int \u63a5\u6536\u6b63\u6574\u6570 float \u63a5\u53d7\u6b63\u6d6e\u70b9\u6570 path \u7c7b\u4f3cstring\uff0c\u4f46\u53ef\u4ee5\u5305\u542b\u659c\u6760 uuid \u63a5\u53d7UUID\u5b57\u7b26\u4e32 <pre><code>from flask import Flask, url_for\n\napp = Flask(__name__)\n\n\n@app.route('/', methods=['GET', 'POST'], endpoint='root')\ndef index():\n    return \"Hello World!\"\n\n\n@app.route('/user/&lt;int:id&gt;')\ndef user(id):\n    user_id = str(id)\n    print(type(id)) # &lt;class 'int'&gt;\n    return str(user_id)\n</code></pre>"},{"location":"programming/python/Flask/route/#2","title":"2. \u81ea\u5b9a\u4e49\u8f6c\u6362\u5668","text":"<pre><code>from flask import Flask, views\nfrom werkzeug.routing import BaseConverter\n\napp = Flask(__name__)\n\n\n# 1.\u81ea\u5b9a\u4e49\u7c7b,\u7ee7\u627f\u81eaBaseConverter\nclass RegexConverter(BaseConverter):\n\n    def __init__(self, map, regex):\n        super(RegexConverter, self).__init__(map)\n        self.regex = regex\n\n    def to_python(self, value):\n        \"\"\"\n        \u8def\u7531\u5339\u914d\u6210\u529f\u540e\u4f20\u9012\u7ed9\u89c6\u56fe\u51fd\u6570\u4e2d\u53c2\u6570\u7684\u503c\n        :param value:\n        :return:\n        \"\"\"\n        return int(value)\n\n    def to_url(self, value):\n        \"\"\"\n        \u4f7f\u7528url_for\u53cd\u5411\u751f\u6210URL\u65f6\uff0c\u4f20\u9012\u7684\u53c2\u6570\u7ecf\u8fc7\u8be5\u65b9\u6cd5\u5904\u7406\uff0c\u8fd4\u56de\u7684\u503c\u7528\u4e8e\u751f\u6210URL\u4e2d\u7684\u53c2\u6570\n        :param value:\n        :return:\n        \"\"\"\n        val = super(RegexConverter, self).to_url(value)\n        return val\n\n\n# 2.\u5c06\u81ea\u5b9a\u4e49\u8f6c\u6362\u5668\u7c7b,\u6dfb\u52a0\u5230\u9ed8\u8ba4\u7684\u8f6c\u6362\u5217\u8868\u4e2d\napp.url_map.converters['regex'] = RegexConverter\n\n\n@app.route('/index/&lt;regex(\"\\d+\"):uid&gt;')\ndef index(uid):\n    return \"Hello World! %s\" % uid\n\n\nif __name__ == '__main__':\n    app.run()\n</code></pre>"},{"location":"programming/python/Flask/template/","title":"\u6a21\u677f","text":"<p>\u6a21\u677f\u4e2d\u4f7f\u7528\u51fd\u6570</p> <pre><code>from flask import Flask, render_template_string\n\napp = Flask(__name__)\n\n\ndef say_hello(name):\n    return \"Hello %s\" % name\n\n\n@app.route('/')\ndef index():\n    return render_template_string(\"&lt;h1&gt; {{ func('\u5f20\u4e09') }} &lt;/h1&gt;\", func=say_hello)\n\n\nif __name__ == '__main__':\n    app.run()\n</code></pre> <pre><code># \u6a21\u677f\u4e2d\u5b9a\u5236\u65b9\u6cd5\n@app.template_global()\n\n@app.template_filter()\n</code></pre>"},{"location":"programming/python/Flask/view/","title":"\u89c6\u56fe","text":""},{"location":"programming/python/Flask/view/#fbv","title":"\u4e00\u3001FBV","text":"<pre><code>from flask import Flask\n\napp = Flask(__name__)\n\n\n@app.route('/', methods=['GET', 'POST'], endpoint='root')\ndef index():\n    return \"Hello World!\"\n</code></pre>"},{"location":"programming/python/Flask/view/#cbv","title":"\u4e8c\u3001CBV","text":"<pre><code>from flask import Flask, views\nfrom functools import wraps\napp = Flask(__name__)\n\n\ndef auth(func):\n    @wraps(func)\n    def inner(*args, **kwargs):\n        result = func(*args, **kwargs)\n        return result\n    return inner\n\n\nclass IndexView(views.MethodView):\n    methods = ['GET', 'POST']\n    decorators = [auth, ]\n\n    def get(self):\n        return 'Index GET'\n\n    def post(self):\n        return 'Index POST'\n\n\napp.add_url_rule('/', view_func=IndexView.as_view(name='index'))\n\nif __name__ == '__main__':\n    app.run()\n</code></pre>"},{"location":"programming/python/Flask/extention/flask-session/","title":"Flask-Session","text":"<pre><code>import os\nfrom flask import Flask, session, request\nfrom flask_session import Session\nfrom redis import StrictRedis\n\nclass Config():\n    #session\u5b58\u50a8\u683c\u5f0f\u4e3aredis\n\u00a0   SESSION_TYPE=\"redis\"\n\u00a0   # \u8bbe\u7f6eredis\u7684ip,port,\u6709\u6548\u65f6\u95f4\n\u00a0   REDIS_HOST = \"127.0.0.1\"\n\u00a0   REDIS_PORT = \"6379\"\n\u00a0   REDIS_DB= 0\n\u00a0   #session\u957f\u671f\u6709\u6548\uff0c\u5219\u8bbe\u5b9asession\u751f\u547d\u5468\u671f\uff0c\u6574\u6570\u79d2\n\u00a0   ERMANENT_SESSION_LIFETIME = 24*60*60\n    #\u662f\u5426\u5f3a\u5236\u52a0\u76d0\uff0c\u6df7\u6dc6session\n    SESSION_USE_SIGNER = True\n    #\u5982\u679c\u52a0\u76d0\uff0c\u90a3\u4e48\u5fc5\u987b\u8bbe\u7f6e\u7684\u5b89\u5168\u7801\uff0c\u76d0\n\u00a0   SECRET_KEY = \"123456\"\n\u00a0   #sessons\u662f\u5426\u957f\u671f\u6709\u6548\uff0cfalse\uff0c\u5219\u5173\u95ed\u6d4f\u89c8\u5668\uff0csession\u5931\u6548\n\u00a0   SESSION_PERMANENT = False\n\u00a0   SESSION_REDIS = StrictRedis(host=REDIS_HOST, port=REDIS_PORT)\n\u00a0   \ndef create_app():\n    app = Flask(__name__)\n\u00a0   app.config.from_object(Config)\n    Session(app)\n</code></pre>"},{"location":"programming/python/Flask/sourcecode/Local/","title":"Local","text":"<p>\u4e0d\u4f7f\u7528local</p> <pre><code>from threading import Thread\nimport time\n\nx = 1\n\n\ndef task(arg):\n    global x\n    x = arg\n    time.sleep(2)\n    print(x)\n\n\nfor i in range(10):\n    t = Thread(target=task, args=(i,))\n    t.start()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>9\n9\n9\n9\n9\n9\n9\n9\n9\n9\n</code></pre> <p>\u4f7f\u7528local \uff1a\u4e3a\u6bcf\u4e2a\u7ebf\u7a0b\u5f00\u8f9f\u4e00\u4e2a\u7a7a\u95f4\u8fdb\u884c\u6570\u636e\u5b58\u50a8</p> <pre><code>from threading import Thread, local\nimport time\n\nx = local()\n\n\ndef task(arg):\n    # \u7ed9\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u90fd\u5f00\u8f9f\u4e00\u4e2a\u7a7a\u95f4\u5199\u5165\u503c\n    x.value = arg\n    time.sleep(2)\n    print(x.value)\n\n\nfor i in range(10):\n    t = Thread(target=task, args=(i,))\n    t.start()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>2\n0\n1\n5\n6\n4\n3\n9\n7\n8\n</code></pre> <p>\u81ea\u5b9a\u4e49Local</p> <p>\u57fa\u4e8e\u51fd\u6570</p> <pre><code>from threading import get_ident, Thread\nimport time\n\n# \u521b\u5efa\u4e00\u4e2a\u5b57\u5178\uff0c\u7528\u6765\u5b58\u50a8\u6bcf\u4e00\u4e2a\u7ebf\u7a0b\u5bf9\u5e94\u7684\u6570\u636e\nstorage = {}\n\n\ndef _set(k, v):\n    # \u83b7\u53d6\u7ebf\u7a0b\u7684\u552f\u4e00\u8868\u793a\n    ident = get_ident()\n    if ident in storage:\n        storage[ident][k] = v\n    else:\n        storage[ident] = {k: v}\n\n\ndef _get(k):\n    ident = get_ident()\n    return storage[ident][k]\n\n\ndef task(arg):\n    _set('value', arg)\n    time.sleep(1)\n    v = _get('value')\n    print(v)\n\n\nfor i in range(10):\n    t = Thread(target=task, args=(i,))\n    t.start()\nprint(storage)\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>{27168: {'value': 0}, 25784: {'value': 1}, 28264: {'value': 2}, 14952: {'value': 3}, 25952: {'value': 4}, 25012: {'value': 5}, 27860: {'value': 6}, 7112: {'value': 7}, 27020: {'value': 8}, 11648: {'value': 9}}\n3\n4\n1\n0\n2\n5\n7\n6\n8\n9\n</code></pre> <p>\u57fa\u4e8e\u9762\u5411\u5bf9\u8c61</p> <p>\u7248\u672c\u4e00</p> <pre><code>from threading import get_ident, Thread\nimport time\n\nclass Local(object):\n    storage = {}\n\n    def __setattr__(self, key, value):\n        ident = get_ident()\n        if ident in Local.storage:\n            Local.storage[ident][key] = value\n        else:\n            Local.storage[ident] = {key: value}\n\n    def __getattr__(self, item):\n        ident = get_ident()\n        time.sleep(2)\n        return Local.storage[ident][item]\n\n\nlocal = Local()\n\n\ndef task(arg):\n    local.value = arg\n    print(local.value)\n\n\nfor i in range(10):\n    t = Thread(target=task, args=(i,))\n    t.start()\n</code></pre> <p>\u7248\u672c\u4e8c\uff1a</p> <pre><code>from threading import get_ident, Thread\nimport time\n\n\nclass Local(object):\n\n    def __init__(self):\n        object.__setattr__(self, 'storage', {})\n\n    def __setattr__(self, key, value):\n        ident = get_ident()\n        if ident in self.storage:\n            self.storage[ident][key] = value\n        else:\n            self.storage[ident] = {key: value}\n\n    def __getattr__(self, item):\n        ident = get_ident()\n        time.sleep(2)\n        return self.storage[ident][item]\n\n\nlocal = Local()\n\n\ndef task(arg):\n    local.value = arg\n    print(local.value)\n\n\nfor i in range(10):\n    t = Thread(target=task, args=(i,))\n    t.start()\n</code></pre> <p>\u534f\u7a0b</p> <pre><code>from threading import Thread\nimport time\n\ntry:\n    # \u57fa\u4e8e\u534f\u7a0b\n    from greenlet import getcurrent as get_ident\nexcept Exception as exc:\n    from threading import get_ident\n\n\nclass Local(object):\n\n    def __init__(self):\n        object.__setattr__(self, 'storage', {})\n\n    def __setattr__(self, key, value):\n        ident = get_ident()\n        if ident in self.storage:\n            self.storage[ident][key] = value\n        else:\n            self.storage[ident] = {key: value}\n\n    def __getattr__(self, item):\n        ident = get_ident()\n        time.sleep(2)\n        return self.storage[ident][item]\n\n\nlocal = Local()\n\n\ndef task(arg):\n    local.value = arg\n    print(local.value)\n\n\nfor i in range(10):\n    t = Thread(target=task, args=(i,))\n    t.start()\n</code></pre> <p>Flask \u7684Local()</p> <pre><code>class Local(object):\n    __slots__ = (\"__storage__\", \"__ident_func__\")\n\n    def __init__(self):\n        object.__setattr__(self, \"__storage__\", {})\n        object.__setattr__(self, \"__ident_func__\", get_ident)\n\n    def __iter__(self):\n        return iter(self.__storage__.items())\n\n    def __call__(self, proxy):\n        \"\"\"Create a proxy for a name.\"\"\"\n        return LocalProxy(self, proxy)\n\n    def __release_local__(self):\n        self.__storage__.pop(self.__ident_func__(), None)\n\n    def __getattr__(self, name):\n        try:\n            return self.__storage__[self.__ident_func__()][name]\n        except KeyError:\n            raise AttributeError(name)\n\n    def __setattr__(self, name, value):\n        ident = self.__ident_func__()\n        storage = self.__storage__\n        try:\n            storage[ident][name] = value\n        except KeyError:\n            storage[ident] = {name: value}\n\n    def __delattr__(self, name):\n        try:\n            del self.__storage__[self.__ident_func__()][name]\n        except KeyError:\n            raise AttributeError(name)\n</code></pre>"},{"location":"programming/python/Flask/sourcecode/context/","title":"Context","text":""},{"location":"programming/python/Flask/sourcecode/context/#_1","title":"\u4e0a\u4e0b\u6587","text":""},{"location":"programming/python/Flask/sourcecode/session/","title":"Session","text":""},{"location":"programming/python/Flask/sourcecode/session/#session","title":"Session\u6e90\u7801\u5206\u6790","text":"<p>Flask\u7a0b\u5e8f\u542f\u52a8\u4e4b\u540e\uff0c\u5982\u679c\u6709\u8bf7\u6c42\u5230\u6765\uff0c\u5c31\u662f\u6267\u884capp\u4e2d\u7684<code>__call__()</code>\u65b9\u6cd5\u3002</p> <pre><code>class Flask(_PackageBoundObject):\n    def __call__(self, environ, start_response):\n        return self.wsgi_app(environ, start_response)\n</code></pre> <ol> <li>\u8bf7\u6c42\u5230\u6765\u4e4b\u540e\uff0c\u6267\u884capp\u5bf9\u8c61\u7684<code>__call__()</code>\u65b9\u6cd5</li> </ol> <pre><code>class Flask(_PackageBoundObject):\n    def __call__(self, environ, start_response):\n        # \u8bf7\u6c42\u5230\u6765\u4e4b\u540e\u8c03\u7528wsgi_app\n        return self.wsgi_app(environ, start_response)\n</code></pre> <ol> <li>\u8c03\u7528<code>request_context(environ)</code> \u5904\u7406\u8bf7\u6c42\u6570\u636e</li> </ol> <pre><code>class Flask(_PackageBoundObject):\n    def wsgi_app(self, environ, start_response):\n        ctx = self.request_context(environ)  # \u5bf9\u63a5\u6536\u5230\u7684\u8bf7\u6c42\u8fdb\u884c\u5904\u7406\n        error = None\n        ...\n</code></pre> <ol> <li>\u8fd4\u56de<code>RequestContext</code>\u7c7b\u7684\u5b9e\u4f8b</li> </ol> <pre><code>    def request_context(self, environ):\n     # self\u5c31\u662f\u521b\u5efa\u7684app\u5b9e\u4f8b\n        return RequestContext(self, environ)\n</code></pre> <ol> <li>\u5728<code>RequestContext</code>\u7c7b\u4e2d\uff0c\u8c03\u7528<code>Request</code>\u5b9e\u4f8b\u5316</li> </ol> <pre><code>class RequestContext(object):\n    def __init__(self, app, environ, request=None, session=None):\n        self.app = app\n        if request is None:  \n            # \u5b9e\u4f8b\u5316\u65f6request\u5e76\u6ca1\u6709\u4f20\u5165\uff0c\u6240\u6709\u8d70\u8fd9\u4e00\u6b65\n            # \u5728\n            # class Flask(_PackageBoundObject):\n            #     request_class = Request\n            # \u7531\u6b64\u5f97\u51fa\uff1a\n            # request = Request(environ)\n            request = app.request_class(environ)\n         ...\n</code></pre> <ol> <li>\u8bf7\u6c42\u5904\u7406\u5b8c\u4e4b\u540e\u6267\u884c<code>ctx.push()</code></li> </ol> <pre><code>class Flask(_PackageBoundObject):\n    def wsgi_app(self, environ, start_response):\n        ctx = self.request_context(environ)\n        # \u8bf7\u6c42\u5185\u5bb9\u88ab\u5c01\u88c5\n        error = None\n        try:\n            try:\n                ctx.push()\n                response = self.full_dispatch_request()\n            except Exception as e:\n                error = e\n                response = self.handle_exception(e)\n            except:  # noqa: B001\n                error = sys.exc_info()[1]\n                raise\n            return response(environ, start_response)\n        finally:\n            if self.should_ignore_error(error):\n                error = None\n            ctx.auto_pop(error)\n</code></pre> <ol> <li>\u6267\u884c<code>SecureCookieSessionInterface</code>\u4e2d\u7684<code>open_session()</code>\u65b9\u6cd5</li> </ol> <pre><code>class RequestContext(object):\n def push(self):\n        ...\n        if self.session is None:\n            # session_interface = SecureCookieSessionInterface()\n            session_interface = self.app.session_interface\n            self.session = session_interface.open_session(self.app, self.request)\n\n            if self.session is None:\n                self.session = session_interface.make_null_session(self.app)\n\n        if self.url_adapter is not None:\n            self.match_request()\n</code></pre> <ol> <li>\u7b2c\u4e00\u6b21\u8bf7\u6c42\u65f6cookie\u4e2d\u6ca1\u6709session\uff0c\u8fd4\u56de\u4e00\u4e2asession\u7c7b\u3002</li> </ol> <pre><code>class SecureCookieSessionInterface(SessionInterface):\n    def open_session(self, app, request):\n        s = self.get_signing_serializer(app)\n        if s is None:\n            return None\n        val = request.cookies.get(app.session_cookie_name)\n        # \u7b2c\u4e00\u6b21\u8bf7\u6c42\u4e2d\uff0ccookie\u4e2d\u6ca1\u6709session\uff0c\u6240\u4ee5val\u662f\u7a7a\n        if not val:\n            return self.session_class() \n        # session_class = SecureCookieSession\n        # SecureCookieSession(CallbackDict, SessionMixin) ,\u8fd9\u4e2a\u7c7b\u7ee7\u627f\u4e86dict\uff0c\u6240\u4ee5\u8fd9\u4e2a\u7c7b\u6784\u9020\u4e86\u4e00\u4e2a\u7279\u6b8a\u7684\u5b57\u5178\n        max_age = total_seconds(app.permanent_session_lifetime)\n        try:\n            data = s.loads(val, max_age=max_age)\n            return self.session_class(data)\n        except BadSignature:\n            return self.session_class()\n</code></pre> <ol> <li>\u89c6\u56fe\u51fd\u6570\u4e2d\uff0c\u901a\u8fc7\u5728ctx\u4e2d\u83b7\u53d6\u6784\u9020\u7684session\u5b57\u5178</li> </ol> <pre><code>from flask import Flask, session\n\napp = Flask(__name__)\napp.config['SECRET_KEY'] = 'UxlucZVeYToAjpMULTNOEw=='\n\n\n@app.route('/login')\ndef login():\n    # \u4ecectx\u4e2d\u83b7\u53d6session\n    session['user'] = 'root'\n    return \"Login\"\n\n\n@app.route('/')\ndef index():\n    return session['user']\n</code></pre> <p>9.<code>save_session</code></p> <pre><code>    def full_dispatch_request(self):\n        return self.finalize_request(rv)\n</code></pre> <pre><code>    def finalize_request(self, rv, from_error_handler=False):\n        response = self.make_response(rv)\n        try:\n            response = self.process_response(response) # \u8c03\u7528process_response\n            request_finished.send(self, response=response)\n        except Exception:\n            if not from_error_handler:\n                raise\n            self.logger.exception(\n                \"Request finalizing failed with an error while handling an error\"\n            )\n        return response\n</code></pre> <pre><code>    def process_response(self, response):\n        ctx = _request_ctx_stack.top\n        bp = ctx.request.blueprint\n        funcs = ctx._after_request_functions\n        if bp is not None and bp in self.after_request_funcs:\n            funcs = chain(funcs, reversed(self.after_request_funcs[bp]))\n        if None in self.after_request_funcs:\n            funcs = chain(funcs, reversed(self.after_request_funcs[None]))\n        for handler in funcs:\n            response = handler(response)\n        if not self.session_interface.is_null_session(ctx.session):\n            self.session_interface.save_session(self, ctx.session, response) # \u6267\u884csave_session\n        return response\n</code></pre> <pre><code>    def save_session(self, app, session, response):\n        val = self.get_signing_serializer(app).dumps(dict(session))  # \u628asession\u8f6c\u4e3a\u5b57\u5178\n        # \u901a\u8fc7set_cookie\u65b9\u6cd5\uff0c\u628asession\u653e\u5728cookie\u4e2d\n        response.set_cookie(\n            app.session_cookie_name,\n            val,\n            expires=expires,\n            httponly=httponly,\n            domain=domain,\n            path=path,\n            secure=secure,\n            samesite=samesite,\n        )\n</code></pre> <p></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/","title":"Python\u7b80\u4ecb","text":"<p>Python \u662f\u8457\u540d\u7684\u201c\u9f9f\u53d4\u201dGuido van Rossum\u5728 1989 \u5e74\u5723\u8bde\u8282\u671f\u95f4\uff0c\u4e3a\u4e86\u6253\u53d1\u65e0\u804a\u7684\u5723\u8bde\u8282\u800c\u7f16\u5199\u7684\u4e00\u4e2a\u7f16\u7a0b\u8bed\u8a00\u3002</p> <p>Python\u662f\u4e00\u79cd\u52a8\u6001\u7c7b\u578b\uff08\u81ea\u52a8\u8ddf\u8e2a\u7c7b\u578b\u800c\u4e0d\u9700\u8981\u58f0\u660e\uff09\u7684\uff0c\u5f3a\u7c7b\u578b\uff08\u53ea\u80fd\u5bf9\u4e00\u4e2a\u5bf9\u8c61\u8fdb\u884c\u9002\u5408\u8be5\u5bf9\u8c61\u7684\u6709\u6548\u64cd\u4f5c\uff09\u8bed\u8a00\u3002python\u4e2d\u4e00\u5207\u7686\u5bf9\u8c61\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#python_1","title":"\u4e00\u3001Python\u7b80\u4ecb","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#1-python","title":"1. Python\u89e3\u91ca\u5668","text":"<p>\u5728windows\u5b89\u88c5\u7684Python\u8f6f\u4ef6\u5305\u5c31\u662f\u4e00\u4e2a\u89e3\u91ca\u5668\uff0c\u89e3\u91ca\u5668\u662f\u4ee3\u7801\u4e0e\u8ba1\u7b97\u673a\u4e4b\u95f4\u7684\u8f6f\u4ef6\u903b\u8f91\u5c42\u3002\u5f53\u6211\u4eec\u5199\u4e86\u4e00\u6bb5python\u7a0b\u5e8f\uff0cPython\u89e3\u91ca\u5668\u4f1a\u8bfb\u53d6\u7a0b\u5e8f\uff0c\u5e76\u6309\u7167\u5176\u4e2d\u7684\u547d\u4ee4\u6267\u884c\u3002Python\u5b89\u88c5\u540e\u4f1a\u751f\u6210\u4e00\u4e9b\u7ec4\u4ef6\uff0c\u81f3\u5c11\u5305\u62ec\u4e00\u4e2a\u89e3\u91ca\u5668\u548c\u4e00\u5957\u652f\u6301\u5e93\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#2-python","title":"2. Python\u7684\u4e3b\u6d41\u5b9e\u73b0","text":"<ol> <li>CPython\uff1a\u6807\u51c6Python\uff0c\u7531ANSI  C\u8bed\u8a00\u7f16\u5199</li> <li>JPython\uff1a\u57fa\u4e8eJava\u7684Python</li> <li>IronPython\uff1a\u57fa\u4e8e.NET\u7684Python</li> <li>Stackless\uff1a\u6ce8\u91cd\u5e76\u53d1\u7684Python</li> <li>PyPy\uff1a\u6ce8\u91cd\u901f\u5ea6\u7684Python\uff0cCPython\u6807\u51c6\u7684\u53e6\u4e00\u4e2a\u5b9e\u73b0</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#3","title":"3. \u51bb\u7ed3\u4e8c\u8fdb\u5236\u6587\u4ef6","text":"<p>\u51bb\u7ed3\u4e8c\u8fdb\u5236\u6587\u4ef6\u53ef\u4ee5\u5c06\u7a0b\u5e8f\u6587\u4ef6\u7684\u5b57\u8282\u7801\u3001PVM\uff08\u89e3\u91ca\u5668\uff09\u4ee5\u53ca\u4efb\u4f55\u7a0b\u5e8f\u6240\u9700\u8981\u7684Python\u652f\u6301\u6587\u4ef6\u6346\u7ed1\u5728\u4e00\u8d77\u5f62\u6210\u4e00\u4e2a\u5355\u72ec\u7684\u53ef\u6267\u884c\u7684\u4e8c\u8fdb\u5236\u7a0b\u5e8f\uff08\u5982windows\u4e0b\u7684exe\uff09\u3002</p> <ol> <li>py2exe \u5728Windows\u4f7f\u7528</li> <li>PyInstaller \u5728Linux\u548cMac OS X\u4f7f\u7528</li> <li>py2app \u5728Mac OS X\u4f7f\u7528 </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#4python","title":"4.python\u7a0b\u5e8f\u7684\u6267\u884c","text":"<p>\u7b2c\u4e00\u6b65\uff1apython\u5185\u90e8\u4f1a\u5c06\u6e90\u4ee3\u7801\u7f16\u8bd1\u6210\u5b57\u8282\u7801\uff0c\u8fd9\u4e9b\u5b57\u8282\u7801\u88ab\u4fdd\u5b58<code>__pycache__</code>\u7684\u76ee\u5f55\u4e0b\u4ee5<code>.pyc</code>\u7ed3\u5c3e\u7684\u6587\u4ef6\u4e2d\uff08\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u5b57\u8282\u7801\u53ea\u9488\u5bf9\u88ab\u5bfc\u5165\u7684\u6587\u4ef6\u800c\u751f\u6210\uff09\uff0c\u6587\u4ef6\u540d\u8fd8\u5305\u542b\u4e86python\u89e3\u91ca\u5668\u7684\u7248\u672c\u4fe1\u606f\uff0c\u6bd4\u5982:<code>hello.cpython-36.pyc</code>\u3002\u8fd9\u6837\u7684\u5904\u7406\u662f\u5bf9\u542f\u52a8\u901f\u5ea6\uff08\u4e25\u683c\u6765\u8bf4\u662f\u5bf9\u5bfc\u5165\uff09\u7684\u4e00\u79cd\u4f18\u5316\uff0c\u5982\u679c\u4e0b\u4e00\u6b21\u8fd0\u884c\u7a0b\u5e8f\u65f6\uff0c\u6e90\u6587\u4ef6\u548cpython\u89e3\u91ca\u5668\u7684\u7248\u672c\u90fd\u6ca1\u6709\u53d8\u5316\uff0cpython\u5c31\u662f\u8df3\u8fc7\u7f16\u8bd1\u8fd9\u4e2a\u6b65\u9aa4\uff0c\u76f4\u63a5\u52a0\u8f7d.pyc\u6587\u4ef6\u3002</p> <p>\u7b2c\u4e8c\u6b65\uff1a\u4e00\u65e6\u7a0b\u5e8f\u7f16\u8bd1\u6210\u5b57\u8282\u7801\uff08\u6216\u5b57\u8282\u7801\u4ece\u5df2\u7ecf\u5b58\u5728\u7684.pyc\u6587\u4ef6\u4e2d\u8f7d\u5165\uff09\uff0c\u4e4b\u540e\u7684\u5b57\u8282\u7801\u53d1\u9001\u5230Python\u865a\u62df\u673a\uff08Python Virtual Machine\uff09\u4e2d\u6765\u6267\u884c</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#5-python","title":"5. Python\u7684\u4f18\u7f3a\u70b9","text":"<p>Python\u4f18\u70b9\uff1a</p> <ol> <li>\u4e30\u5bcc\u7684\u5185\u7f6e\u5e93\u548c\u7b2c\u4e09\u65b9\u5e93</li> <li>\u5b66\u4e60\u66f2\u7ebf\u4f4e\uff0c\u5bb9\u6613\u4e0a\u624b</li> <li>\u652f\u6301\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u548c\u51fd\u6570\u5f0f\u7f16\u7a0b</li> </ol> <p>Python\u7684\u7f3a\u70b9\uff1a</p> <ol> <li>\u4ee3\u7801\u4e0d\u80fd\u52a0\u5bc6</li> <li>\u5728\u73b0\u6709\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e0b\uff0c\u4e0eC\u548cC++\u8fd9\u7c7b\u5b8c\u5168\u7f16\u8bd1\u5e76\u4e14\u8f83\u5e95\u5c42\u7684\u8bed\u8a00\u76f8\u6bd4\uff0cPython\u7684\u6267\u884c\u901f\u5ea6\u8fd8\u4e0d\u591f\u5feb\u3002</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#python_2","title":"\u4e8c\u3001 Python\u57fa\u7840\u77e5\u8bc6\u70b9","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#1-python_1","title":"1. Python\u7684\u7f16\u7801\u65b9\u5f0f","text":"<p>python3\u9ed8\u8ba4\u4f7f\u7528<code>utf-8</code></p> <p>python2\u9ed8\u8ba4\u4f7f\u7528ASCII\uff0c\u53ef\u4ee5\u5728\u9996\u884c\u58f0\u660e\u7f16\u7801\u65b9\u5f0f</p> <pre><code># -*- encoding:utf-8 -*-\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#2","title":"2. \u53d8\u91cf","text":"<p>python\u53d8\u91cf\u4e0d\u9700\u8981\u63d0\u524d\u58f0\u660e\uff0c\u5f53\u7ed9\u4e00\u4e2a\u53d8\u91cf\u8d4b\u503c\u7684\u65f6\u5019\u5c31\u521b\u5efa\u4e86\u5b83\uff0c\u53ef\u80fd\u8d4b\u7684\u662f\u4efb\u4f55\u7c7b\u578b\u7684\u5bf9\u8c61\uff0c\u5728\u4f7f\u7528\u53d8\u91cf\u7684\u503c\u524d\u5fc5\u987b\u5bf9\u5176\u8fdb\u884c\u8d4b\u503c\u3002</p> <p>\u53d8\u91cf\u5c31\u662f\u7528\u6765\u4ee3\u6307\u67d0\u4e2a\u4e1c\u897f\u7684\u540d\u5b57\u3002</p> <pre><code>x = 100\n</code></pre> <p>\u5728\u64cd\u4f5c\u7b26\u4e24\u8fb9\u52a0\u4e0a\u7a7a\u683c\u4f1a\u8ba9\u4ee3\u7801\u66f4\u5bb9\u6613\u9605\u8bfb</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#1","title":"1. \u53d8\u91cf\u7684\u547d\u540d\u89c4\u5219","text":"<ol> <li>\u53d8\u91cf\u540d\u53ea\u80fd\u5305\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u548c\u4e0b\u5212\u7ebf\uff0c\u4e0d\u80fd\u4ee5\u6570\u5b57\u5f00\u5934</li> <li>\u53d8\u91cf\u540d\u4e0d\u80fd\u5305\u542b\u7a7a\u683c</li> <li>\u4e0d\u8981\u5c06python\u5173\u952e\u5b57\u548c\u51fd\u6570\u540d\u4f5c\u4e3a\u53d8\u91cf\u540d</li> <li>\u53d8\u91cf\u540d\u5e94\u8be5\u7b80\u77ed\u4e14\u5177\u6709\u63cf\u8ff0\u6027</li> <li>\u614e\u7528\u5c0f\u5199\u5b57\u6bcd<code>l</code>\u548c\u5927\u5199\u5b57\u6bcd<code>O</code></li> </ol> <pre><code># python \u4fdd\u7559\u5b57\n&gt;&gt;&gt; import keyword\n&gt;&gt;&gt; keyword.kwlist\n['False', 'None', 'True', 'and', 'as', 'assert', 'break', 'class', 'continue', 'def', 'del', 'elif', 'else', 'except', 'finally', 'for', 'from', 'global', 'if', 'import', 'in', 'is', 'lambda', 'nonlocal', 'not', 'or', 'pass', 'raise', 'return', 'try', 'while', 'with', 'yield']\n&gt;&gt;&gt; import sys\n&gt;&gt;&gt; sys.version\n'3.6.8 (tags/v3.6.8:3c6b436a57, Dec 24 2018, 00:16:47) [MSC v.1916 64 bit (AMD64)]'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#2_1","title":"2. \u5f15\u7528","text":"<p>\u5728Python\u4e2d\uff0c\u4ece\u53d8\u91cf\u5230\u5bf9\u8c61\u7684\u8fde\u63a5\u79f0\u4f5c\u5f15\u7528\u3002</p> <ol> <li>\u53d8\u91cf\u662f\u4e00\u4e2a\u7cfb\u7edf\u8868\u7684\u5165\u53e3\uff0c\u5305\u542b\u4e86\u6307\u5411\u5bf9\u8c61\u7684\u8fde\u63a5</li> <li>\u5bf9\u8c61\u662f\u88ab\u5206\u914d\u5230\u7684\u4e00\u5757\u5185\u5b58\uff0c\u6709\u8db3\u591f\u7684\u7a7a\u95f4\u53bb\u8868\u793a\u5b83\u4eec\u6240\u4ee3\u8868\u7684\u503c</li> <li>\u5f15\u7528\u662f\u81ea\u52a8\u5f62\u6210\u7684\u4ece\u53d8\u91cf\u5230\u5bf9\u8c61\u7684\u6307\u9488</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#3_1","title":"3. \u53d8\u91cf\u7684\u547d\u540d\u98ce\u683c","text":"<ol> <li>\u9a7c\u5cf0\u547d\u540d\u6cd5\uff1a \u7c7b\u540d\u3001Type \u53d8\u91cf\u3001\u5f02\u5e38 exception \u540d\u63a8\u8350\u4f7f\u7528</li> <li>\u86c7\u5f62\u547d\u540d\u6cd5\uff1a \u5305\u540d\u3001\u6a21\u5757\u540d\u3001\u65b9\u6cd5\u540d\u548c\u666e\u901a\u53d8\u91cf\u540d\u63a8\u8350\u4f7f\u7528 <code>snake_case</code></li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#3_2","title":"3. \u6ce8\u91ca","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#31","title":"3.1 \u5355\u884c\u6ce8\u91ca","text":"<pre><code># \u8fd9\u662f\u4e00\u4e2a\u6ce8\u91ca\u884c\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#32","title":"3.2 \u591a\u884c\u6ce8\u91ca","text":"<p>python\u4e2d\u6ca1\u6709\u591a\u884c\u6ce8\u91ca\u7684\u8bed\u6cd5\uff0c\u591a\u884c\u6ce8\u91ca\u5c31\u662f\u5728\u6bcf\u4e00\u884c\u524d\u9762\u52a0<code>#</code>\uff0c\u4f46\u662f\u53ef\u4ee5\u4e09\u5f15\u53f7\u7684\u65b9\u5f0f\u6ce8\u91ca(\u8fd9\u5e76\u4e0d\u662f\u771f\u6b63\u610f\u4e49\u4e0a\u7684\u6ce8\u91ca\uff0cpython\u89e3\u91ca\u5668\u8fd8\u662f\u4f1a\u8bfb\u53d6\u91cc\u9762\u7684\u5185\u5bb9)\u3002</p> <pre><code>'''\n\u6ce8\u91ca\u5185\u5bb9\n'''\n# \u6216\n\"\"\"\n\u6ce8\u91ca\u5185\u5bb9\n\"\"\"\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#4","title":"4. \u6838\u5fc3\u6570\u636e\u7c7b\u578b","text":"\u5bf9\u8c61\u7c7b\u578b \u5b57\u9762\u91cf/\u6784\u9020\u793a\u4f8b \u6570\u5b57 123,3.14,3+4j,0b111,Decimal(),Fraction() \u5b57\u7b26\u4e32 'spam',\"Bob's\",b'a\\x01c' \u5217\u8868 [1,[2,3],4],list(range(10)) \u5b57\u5178 {'name':'Kobe','age':41},dict(hours=10) \u5143\u7ec4 (1,'B'),tuple('span'),namedtuple \u6587\u4ef6 open('file','wb') \u96c6\u5408 set('abc'),{'a', 'b', ''c'} \u5176\u4ed6\u6838\u5fc3\u7c7b\u578b \u7c7b\u578b\u3001None\u3001\u5e03\u5c14\u578b \u7a0b\u5e8f\u5355\u5143\u7c7b\u578b \u51fd\u6570\u3001\u6a21\u5757\u3001\u7c7b Python\u5b9e\u73b0\u76f8\u5173\u7c7b\u578b \u5df2\u7f16\u8bd1\u4ee3\u7801\u3001\u8c03\u7528\u6808\u8ddf\u8e2a"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#5","title":"5. \u8f93\u5165\u4e0e\u8f93\u51fa","text":"<pre><code># \u8f93\u5165\nname = input(\"please input your name: \")\n# \u8f93\u51fa\nprint(name)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#6","title":"6. \u8fd0\u7b97\u7b26","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#61","title":"6.1 \u7b97\u6570\u8fd0\u7b97\u7b26","text":"\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>+</code> \u52a0 <code>-</code> \u51cf <code>*</code> \u4e58 <code>/</code> \u9664 <code>//</code> \u53d6\u6574\u9664 <code>%</code> \u53d6\u4f59 <code>**</code> \u5e42"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#62","title":"6.2 \u6bd4\u8f83\u8fd0\u7b97\u7b26","text":"\u6bd4\u8f83\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>==</code> \u7b49\u4e8e <code>!=</code> \u4e0d\u7b49\u4e8e <code>&gt;</code> \u5927\u4e8e <code>&gt;=</code> \u5927\u4e8e\u7b49\u4e8e <code>&lt;</code> \u5c0f\u4e8e <code>&lt;=</code> \u5c0f\u4e8e\u7b49\u4e8e"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#63","title":"6.3 \u8d4b\u503c\u8fd0\u7b97\u7b26","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#631","title":"6.3.1 \u589e\u91cf\u8d4b\u503c","text":"\u8d4b\u503c\u8fd0\u7b97\u7b26 \u63cf\u8ff0 = \u7b80\u5355\u8d4b\u503c += \u52a0\u6cd5\u8d4b\u503c -= \u51cf\u6cd5\u8d4b\u503c *= \u4e58\u6cd5\u8d4b\u503c /= \u9664\u6cd5\u8d4b\u503c //= \u53d6\u6574\u9664\u8d4b\u503c %= \u53d6\u4f59\u8d4b\u503c **= \u5e42\u8d4b\u503c"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#632","title":"6.3.2 \u94fe\u5f0f\u8d4b\u503c","text":"<pre><code>&gt;&gt;&gt; x=y=z=100\n&gt;&gt;&gt; x,y,z\n(100, 100, 100)\n# \u4e09\u4e2a\u53d8\u91cf\u6307\u5411\u5185\u5b58\u4e2d\u7684\u540c\u4e00\u4e2a\u5bf9\u8c61\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#633","title":"6.3.3 \u4ea4\u53c9\u8d4b\u503c","text":"<pre><code>&gt;&gt;&gt; n = 2\n&gt;&gt;&gt; m = 3\n&gt;&gt;&gt; n,m = m,n\n&gt;&gt;&gt; n, m\n(3, 2)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#634","title":"6.3.4 \u89e3\u538b\u8d4b\u503c\uff08\u89e3\u5305\uff09","text":"<pre><code>&gt;&gt;&gt; p = ['Tom', 18]\n&gt;&gt;&gt; name, age = p\n&gt;&gt;&gt; name, age\n('Tom', 18)\n&gt;&gt;&gt; name\n'Tom'\n&gt;&gt;&gt; age\n18\n</code></pre> <p>\u661f\u53f7\u8868\u8fbe\u5f0f</p> <pre><code>&gt;&gt;&gt; record = ('Dave', 'dave@example.com', '773-555-1212', '847-555-1212')\n&gt;&gt;&gt; name, email, *phone_numbers = record\n&gt;&gt;&gt; name\n'Dave'\n&gt;&gt;&gt; email\n'dave@example.com'\n&gt;&gt;&gt; phone_numbers\n['773-555-1212', '847-555-1212']\n</code></pre> <p>\u89e3\u538b\u8d4b\u503c\u53ef\u4ee5\u7528\u5728\u4efb\u4f55\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4e0a\u9762\uff08\u5217\u8868\uff0c\u5143\u7ec4\uff0c\u5b57\u7b26\u4e32\uff0c\u6587\u4ef6\u5bf9\u8c61\uff0c\u8fed\u4ee3\u5668\u548c\u751f\u6210\u5668\uff09\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#64","title":"6.4 \u903b\u8f91\u8fd0\u7b97\u7b26","text":"\u903b\u8f91\u7b97\u6cd5 \u63cf\u8ff0 <code>and</code> \u903b\u8f91\u4e0e <code>or</code> \u903b\u8f91\u6216 <code>not</code> \u53d6\u53cd <p>\u4f18\u5148\u7ea7not&gt;and&gt;or</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#65","title":"6.5 \u6210\u5458\u8fd0\u7b97\u7b26","text":"\u6210\u5458\u8fd0\u7b97\u7b26 \u63cf\u8ff0 <code>in</code> \u5305\u542b <code>not in</code> \u4e0d\u5305\u542b <pre><code>&gt;&gt;&gt; not 1 in [2, 3, 4]\nTrue\n&gt;&gt;&gt; 1 not in [2, 3, 4]  # \u63a8\u8350\u4f7f\u7528not in\nTrue\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#66","title":"6.6 \u8eab\u4efd\u8fd0\u7b97\u7b26","text":"\u8eab\u4efd\u8fd0\u7b97\u7b26 \u63cf\u8ff0 is \u4e24\u4e2a\u5bf9\u8c61id\u76f8\u540c\u8fd4\u56deTrue is not \u4e24\u4e2a\u5bf9\u8c61id\u4e0d\u76f8\u540c\u8fd4\u56deTrue <p><code>==</code>\u53cc\u7b49\u53f7\u6bd4\u8f83\u7684\u662f\u503c\u662f\u5426\u76f8\u7b49\uff0c\u800c<code>is</code>\u6bd4\u8f83\u7684\u662fid\u662f\u5426\u76f8\u7b49\u3002id\u4e0d\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u503c\u6709\u53ef\u80fd\u76f8\u540c\uff08\u5373\u4e24\u5757\u4e0d\u540c\u7684\u5185\u5b58\u7a7a\u95f4\u91cc\u53ef\u4ee5\u5b58\u76f8\u540c\u7684\u503c\uff09\uff0cid\u76f8\u540c\u7684\u60c5\u51b5\u4e0b\uff0c\u503c\u4e00\u5b9a\u76f8\u540c \u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#7","title":"7. \u4ee3\u7801\u5757\u5206\u9694\u7b26","text":"<p>python\u4ee5\u884c\u7f29\u8fdb\u68c0\u6d4b\u5757\u7684\u8fb9\u754c\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#_1","title":"\u4e09\u3001\u5783\u573e\u56de\u6536\u673a\u5236","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#1_1","title":"1. \u5f15\u7528\u8ba1\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#2-","title":"2. \u6807\u8bb0-\u6e05\u9664","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-python%E7%AE%80%E4%BB%8B/#3_3","title":"3. \u5206\u4ee3\u56de\u6536","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/","title":"Python\u5e38\u7528\u57fa\u7840\u6a21\u5757","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#os","title":"\u4e00\u3001os\u6a21\u5757","text":"<p>os\u6a21\u5757\u662f\u4e0e\u64cd\u4f5c\u7cfb\u7edf\u4ea4\u4e92\u7684\u4e00\u4e2a\u63a5\u53e3</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1","title":"1. \u6587\u4ef6\u4e0e\u76ee\u5f55","text":"<pre><code>os.makedirs('dirname1/dirname2')    #\u53ef\u751f\u6210\u591a\u5c42\u9012\u5f52\u76ee\u5f55\nos.removedirs('dirname1')    #\u82e5\u76ee\u5f55\u4e3a\u7a7a\uff0c\u5219\u5220\u9664\uff0c\u5e76\u9012\u5f52\u5230\u4e0a\u4e00\u7ea7\u76ee\u5f55\uff0c\u5982\u82e5\u4e5f\u4e3a\u7a7a\uff0c\u5219\u5220\u9664\uff0c\u4f9d\u6b64\u7c7b\u63a8\nos.mkdir('dirname')    #\u751f\u6210\u5355\u7ea7\u76ee\u5f55\uff1b\u76f8\u5f53\u4e8eshell\u4e2dmkdir dirname\nos.rmdir('dirname')    #\u5220\u9664\u5355\u7ea7\u7a7a\u76ee\u5f55\uff0c\u82e5\u76ee\u5f55\u4e0d\u4e3a\u7a7a\u5219\u65e0\u6cd5\u5220\u9664\uff0c\u62a5\u9519\uff1b\u76f8\u5f53\u4e8eshell\u4e2drmdir dirname\nos.listdir('dirname')    #\u5217\u51fa\u6307\u5b9a\u76ee\u5f55\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u5b50\u76ee\u5f55\uff0c\u5305\u62ec\u9690\u85cf\u6587\u4ef6\uff0c\u5e76\u4ee5\u5217\u8868\u65b9\u5f0f\u6253\u5370\nos.remove()  #\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\nos.rename(\"oldname\",\"newname\")  #\u91cd\u547d\u540d\u6587\u4ef6/\u76ee\u5f55\n\nos.system(\"bash command\")  #\u8fd0\u884cshell\u547d\u4ee4\uff0c\u76f4\u63a5\u663e\u793a\nos.popen(\"bash command\").read()  #\u8fd0\u884cshell\u547d\u4ee4\uff0c\u83b7\u53d6\u6267\u884c\u7ed3\u679c\nos.getcwd() #\u83b7\u53d6\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\uff0c\u5373\u5f53\u524dpython\u811a\u672c\u5de5\u4f5c\u7684\u76ee\u5f55\u8def\u5f84\nos.chdir(\"dirname\")  #\u6539\u53d8\u5f53\u524d\u811a\u672c\u5de5\u4f5c\u76ee\u5f55\uff1b\u76f8\u5f53\u4e8eshell\u4e0bcd\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-ospath","title":"2. os.path","text":"<pre><code>os.path.abspath(path) #\u8fd4\u56depath\u89c4\u8303\u5316\u7684\u7edd\u5bf9\u8def\u5f84\nos.path.split(path) #\u5c06path\u5206\u5272\u6210\u76ee\u5f55\u548c\u6587\u4ef6\u540d\u4e8c\u5143\u7ec4\u8fd4\u56de \nos.path.dirname(path) #\u8fd4\u56depath\u7684\u76ee\u5f55\u3002\u5176\u5b9e\u5c31\u662fos.path.split(path)\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20 \nos.path.basename(path) #\u8fd4\u56depath\u6700\u540e\u7684\u6587\u4ef6\u540d\u3002\u5982\u4f55path\u4ee5\uff0f\u6216\\\u7ed3\u5c3e\uff0c\u90a3\u4e48\u5c31\u4f1a\u8fd4\u56de\u7a7a\u503c\u3002\u5373os.path.split(path)\u7684\u7b2c\u4e8c\u4e2a\u5143\u7d20\nos.path.exists(path)  #\u5982\u679cpath\u5b58\u5728\uff0c\u8fd4\u56deTrue\uff1b\u5982\u679cpath\u4e0d\u5b58\u5728\uff0c\u8fd4\u56deFalse\nos.path.isabs(path)  #\u5982\u679cpath\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u8fd4\u56deTrue\nos.path.isfile(path)  #\u5982\u679cpath\u662f\u4e00\u4e2a\u5b58\u5728\u7684\u6587\u4ef6\uff0c\u8fd4\u56deTrue\u3002\u5426\u5219\u8fd4\u56deFalse\nos.path.isdir(path)  #\u5982\u679cpath\u662f\u4e00\u4e2a\u5b58\u5728\u7684\u76ee\u5f55\uff0c\u5219\u8fd4\u56deTrue\u3002\u5426\u5219\u8fd4\u56deFalse\nos.path.join(path1[, path2[, ...]])  #\u5c06\u591a\u4e2a\u8def\u5f84\u7ec4\u5408\u540e\u8fd4\u56de\uff0c\u7b2c\u4e00\u4e2a\u7edd\u5bf9\u8def\u5f84\u4e4b\u524d\u7684\u53c2\u6570\u5c06\u88ab\u5ffd\u7565\nos.path.getatime(path)  #\u8fd4\u56depath\u6240\u6307\u5411\u7684\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u7684\u6700\u540e\u8bbf\u95ee\u65f6\u95f4\nos.path.getmtime(path)  #\u8fd4\u56depath\u6240\u6307\u5411\u7684\u6587\u4ef6\u6216\u8005\u76ee\u5f55\u7684\u6700\u540e\u4fee\u6539\u65f6\u95f4\nos.path.getsize(path) #\u8fd4\u56depath\u7684\u5927\u5c0f\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3-osstatpathfilename","title":"3. os.stat('path/filename')","text":"<p>\u83b7\u53d6\u6587\u4ef6/\u76ee\u5f55\u4fe1\u606f \u7684\u7ed3\u6784\u8bf4\u660e</p> <pre><code>stat \u7ed3\u6784:\n\nst_mode: inode \u4fdd\u62a4\u6a21\u5f0f\nst_ino: inode \u8282\u70b9\u53f7\u3002\nst_dev: inode \u9a7b\u7559\u7684\u8bbe\u5907\u3002\nst_nlink: inode \u7684\u94fe\u63a5\u6570\u3002\nst_uid: \u6240\u6709\u8005\u7684\u7528\u6237ID\u3002\nst_gid: \u6240\u6709\u8005\u7684\u7ec4ID\u3002\nst_size: \u666e\u901a\u6587\u4ef6\u4ee5\u5b57\u8282\u4e3a\u5355\u4f4d\u7684\u5927\u5c0f\uff1b\u5305\u542b\u7b49\u5f85\u67d0\u4e9b\u7279\u6b8a\u6587\u4ef6\u7684\u6570\u636e\u3002\nst_atime: \u4e0a\u6b21\u8bbf\u95ee\u7684\u65f6\u95f4\u3002\nst_mtime: \u6700\u540e\u4e00\u6b21\u4fee\u6539\u7684\u65f6\u95f4\u3002\nst_ctime: \u7531\u64cd\u4f5c\u7cfb\u7edf\u62a5\u544a\u7684\"ctime\"\u3002\u5728\u67d0\u4e9b\u7cfb\u7edf\u4e0a\uff08\u5982Unix\uff09\u662f\u6700\u65b0\u7684\u5143\u6570\u636e\u66f4\u6539\u7684\u65f6\u95f4\uff0c\u5728\u5176\u5b83\u7cfb\u7edf\u4e0a\uff08\u5982Windows\uff09\u662f\u521b\u5efa\u65f6\u95f4\uff08\u8be6\u7ec6\u4fe1\u606f\u53c2\u89c1\u5e73\u53f0\u7684\u6587\u6863\uff09\u3002\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#4-os","title":"4. os\u6a21\u5757\u7684\u5c5e\u6027","text":"<pre><code>os.sep    #\u8f93\u51fa\u64cd\u4f5c\u7cfb\u7edf\u7279\u5b9a\u7684\u8def\u5f84\u5206\u9694\u7b26\uff0cwin\u4e0b\u4e3a\"\\\\\",Linux\u4e0b\u4e3a\"/\"\nos.linesep    #\u8f93\u51fa\u5f53\u524d\u5e73\u53f0\u4f7f\u7528\u7684\u884c\u7ec8\u6b62\u7b26\uff0cwin\u4e0b\u4e3a\"\\r\\n\",Linux\u4e0b\u4e3a\"\\n\"\nos.pathsep    #\u8f93\u51fa\u7528\u4e8e\u5206\u5272\u6587\u4ef6\u8def\u5f84\u7684\u5b57\u7b26\u4e32 win\u4e0b\u4e3a;,Linux\u4e0b\u4e3a:\nos.name    #\u8f93\u51fa\u5b57\u7b26\u4e32\u6307\u793a\u5f53\u524d\u4f7f\u7528\u5e73\u53f0\u3002win-&gt;'nt'; Linux-&gt;'posix'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#sys","title":"\u4e8c\u3001sys\u6a21\u5757","text":"<p>sys\u6a21\u5757\u662f\u4e0epython\u89e3\u91ca\u5668\u4ea4\u4e92\u7684\u4e00\u4e2a\u63a5\u53e3</p> <pre><code>sys.argv           #\u547d\u4ee4\u884c\u53c2\u6570List\uff0c\u7b2c\u4e00\u4e2a\u5143\u7d20\u662f\u7a0b\u5e8f\u672c\u8eab\u8def\u5f84\nsys.exit(n)        #\u9000\u51fa\u7a0b\u5e8f\uff0c\u6b63\u5e38\u9000\u51fa\u65f6exit(0),\u9519\u8bef\u9000\u51fasys.exit(1)\nsys.version        #\u83b7\u53d6Python\u89e3\u91ca\u7a0b\u5e8f\u7684\u7248\u672c\u4fe1\u606f\nsys.path           #\u8fd4\u56de\u6a21\u5757\u7684\u641c\u7d22\u8def\u5f84\uff0c\u521d\u59cb\u5316\u65f6\u4f7f\u7528PYTHONPATH\u73af\u5883\u53d8\u91cf\u7684\u503c\nsys.platform       #\u8fd4\u56de\u64cd\u4f5c\u7cfb\u7edf\u5e73\u53f0\u540d\u79f0\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#_1","title":"\u4e09\u3001\u65f6\u95f4\u6a21\u5757","text":"<p>\u8868\u793a\u65f6\u95f4\u7684\u4e09\u79cd\u65b9\u5f0f:\u65f6\u95f4\u6233\u3001\u5143\u7ec4(struct_time)\u3001\u683c\u5f0f\u5316\u7684\u65f6\u95f4\u5b57\u7b26\u4e32</p> <p>1 \u65f6\u95f4\u6233(timestamp) \uff1a\u901a\u5e38\u6765\u8bf4\uff0c\u65f6\u95f4\u6233\u8868\u793a\u7684\u662f\u4ece1970\u5e741\u67081\u65e500:00:00\u5f00\u59cb\u6309\u79d2\u8ba1\u7b97\u7684\u504f\u79fb\u91cf\u3002</p> <p>2 \u683c\u5f0f\u5316\u7684\u65f6\u95f4\u5b57\u7b26\u4e32(Format String)\uff1a \u20181999-12-06\u2019</p> \u683c\u5f0f \u8bf4\u660e %m \u6708\u4efd\uff0801-12\uff09 %d \u6708\u5185\u4e2d\u7684\u4e00\u5929\uff080-31\uff09 %H 24\u5c0f\u65f6\u5236\u5c0f\u65f6\u6570\uff080-23\uff09 %I 12\u5c0f\u65f6\u5236\u5c0f\u65f6\u6570\uff0801-12\uff09 %M \u5206\u949f\u6570\uff0800=59\uff09 %S \u79d2\uff0800-59\uff09 %a \u672c\u5730\u7b80\u5316\u661f\u671f\u540d\u79f0 %A \u672c\u5730\u5b8c\u6574\u661f\u671f\u540d\u79f0 %b \u672c\u5730\u7b80\u5316\u7684\u6708\u4efd\u540d\u79f0 %B \u672c\u5730\u5b8c\u6574\u7684\u6708\u4efd\u540d\u79f0 %c \u672c\u5730\u76f8\u5e94\u7684\u65e5\u671f\u8868\u793a\u548c\u65f6\u95f4\u8868\u793a %j \u5e74\u5185\u7684\u4e00\u5929\uff08001-366\uff09 %p \u672c\u5730A.M.\u6216P.M.\u7684\u7b49\u4ef7\u7b26 %U \u4e00\u5e74\u4e2d\u7684\u661f\u671f\u6570\uff0800-53\uff09\u661f\u671f\u5929\u4e3a\u661f\u671f\u7684\u5f00\u59cb %w \u661f\u671f\uff080-6\uff09\uff0c\u661f\u671f\u5929\u4e3a\u661f\u671f\u7684\u5f00\u59cb %W \u4e00\u5e74\u4e2d\u7684\u661f\u671f\u6570\uff0800-53\uff09\u661f\u671f\u4e00\u4e3a\u661f\u671f\u7684\u5f00\u59cb %x \u672c\u5730\u76f8\u5e94\u7684\u65e5\u671f\u8868\u793a %X \u672c\u5730\u76f8\u5e94\u7684\u65f6\u95f4\u8868\u793a %Z \u5f53\u524d\u65f6\u533a\u7684\u540d\u79f0 %% %\u53f7\u672c\u8eab <p>3 \u5143\u7ec4(struct_time) \uff1astruct_time\u5143\u7ec4\u5171\u67099\u4e2a\u5143\u7d20\u5171\u4e5d\u4e2a\u5143\u7d20:(\u5e74\uff0c\u6708\uff0c\u65e5\uff0c\u65f6\uff0c\u5206\uff0c\u79d2\uff0c\u4e00\u5e74\u4e2d\u7b2c\u51e0\u5468\uff0c\u4e00\u5e74\u4e2d\u7b2c\u51e0\u5929\u7b49\uff09</p> \u7d22\u5f15\uff08Index\uff09 \u5c5e\u6027\uff08Attribute\uff09 \u503c\uff08Values\uff09 0 tm_year\uff08\u5e74\uff09 \u6bd4\u59822011 1 tm_mon\uff08\u6708\uff09 1 - 12 2 tm_mday\uff08\u65e5\uff09 1 - 31 3 tm_hour\uff08\u65f6\uff09 0 - 23 4 tm_min\uff08\u5206\uff09 0 - 59 5 tm_sec\uff08\u79d2\uff09 0 - 60 6 tm_wday\uff08weekday\uff09 0 - 6\uff080\u8868\u793a\u5468\u4e00\uff09 7 tm_yday\uff08\u4e00\u5e74\u4e2d\u7684\u7b2c\u51e0\u5929\uff09 1 - 366 8 tm_isdst\uff08\u662f\u5426\u662f\u590f\u4ee4\u65f6\uff09 \u9ed8\u8ba4\u4e3a0"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1time","title":"1.time","text":"<pre><code>&gt;&gt;&gt; import time\n# 1.\u65f6\u95f4\u6233\n&gt;&gt;&gt; time.time()\n1580712170.377099\n# 2.\u65f6\u95f4\u5b57\u7b26\u4e32\n&gt;&gt;&gt; time.strftime(\"%Y-%m-%d %H:%M:%S\")\n'2020-02-03 14:43:38'\n# 3.\u65f6\u95f4\u5143\u7ec4\n&gt;&gt;&gt; time.localtime()\ntime.struct_time(tm_year=2020, tm_mon=2, tm_mday=3, tm_hour=14, tm_min=43, tm_sec=52, tm_wday=0, tm_yday=34, tm_isdst=0)\n</code></pre> <p>\u65f6\u95f4\u683c\u5f0f\u8f6c\u6362</p> <p></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1_1","title":"1. \u65f6\u95f4\u6233\u4e0e\u7ed3\u6784\u5316\u65f6\u95f4","text":"<pre><code># UTC\u65f6\u95f4\uff0c\u4e0e\u82f1\u56fd\u4f26\u6566\u5f53\u5730\u65f6\u95f4\u4e00\u81f4\n&gt;&gt;&gt; time.gmtime()\ntime.struct_time(tm_year=2020, tm_mon=2, tm_mday=3, tm_hour=7, tm_min=6, tm_sec=4, tm_wday=0, tm_yday=34, tm_isdst=0)\n# \u5f53\u5730\u65f6\u95f4\n&gt;&gt;&gt; time.localtime()\ntime.struct_time(tm_year=2020, tm_mon=2, tm_mday=3, tm_hour=15, tm_min=6, tm_sec=25, tm_wday=0, tm_yday=34, tm_isdst=0)\n</code></pre> <p>1.1 \u65f6\u95f4\u6233--&gt;\u7ed3\u6784\u5316\u65f6\u95f4</p> <pre><code>&gt;&gt;&gt; import time\n&gt;&gt;&gt; time.localtime(1580713662)\ntime.struct_time(tm_year=2020, tm_mon=2, tm_mday=3, tm_hour=15, tm_min=7, tm_sec=42, tm_wday=0, tm_yday=34, tm_isdst=0)\n</code></pre> <p>1.2 \u7ed3\u6784\u5316\u65f6\u95f4--&gt;\u65f6\u95f4\u6233</p> <pre><code>&gt;&gt;&gt; import time\n&gt;&gt;&gt; time_tuple = time.localtime(1500000000)\n&gt;&gt;&gt; time.mktime(time_tuple)\n1500000000.0\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2","title":"2. \u7ed3\u6784\u5316\u65f6\u95f4\u4e0e\u5b57\u7b26\u4e32\u65f6\u95f4","text":"<p>2.1 \u7ed3\u6784\u5316\u65f6\u95f4--&gt;\u5b57\u7b26\u4e32\u65f6\u95f4</p> <pre><code># 1.time.strftime(\"\u683c\u5f0f\u5b9a\u4e49\",\"\u7ed3\u6784\u5316\u65f6\u95f4\")  \u7ed3\u6784\u5316\u65f6\u95f4\u53c2\u6570\u82e5\u4e0d\u4f20\uff0c\u5219\u663e\u793a\u5f53\u524d\u65f6\u95f4\n&gt;&gt;&gt;time.strftime(\"%Y-%m-%d %X\")\n'2017-07-24 14:55:36'\n&gt;&gt;&gt;time.strftime(\"%Y-%m-%d\",time.localtime(1500000000))\n'2017-07-14'\n# 2.time.asctime(\u7ed3\u6784\u5316\u65f6\u95f4) \u5982\u679c\u4e0d\u4f20\u53c2\u6570\uff0c\u76f4\u63a5\u8fd4\u56de\u5f53\u524d\u65f6\u95f4\u7684\u683c\u5f0f\u5316\u4e32\n&gt;&gt;&gt;time.asctime(time.localtime(1500000000))\n'Fri Jul 14 10:40:00 2017'\n&gt;&gt;&gt; time.asctime()\n'Mon Feb  3 15:46:50 2020'\n</code></pre> <p>2.2 \u5b57\u7b26\u4e32\u65f6\u95f4--&gt;\u7ed3\u6784\u5316\u65f6\u95f4</p> <pre><code>#time.strptime(\u65f6\u95f4\u5b57\u7b26\u4e32,\u5b57\u7b26\u4e32\u5bf9\u5e94\u683c\u5f0f)\n&gt;&gt;&gt;time.strptime(\"2017-03-16\",\"%Y-%m-%d\")\ntime.struct_time(tm_year=2017, tm_mon=3, tm_mday=16, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=3, tm_yday=75, tm_isdst=-1)\n&gt;&gt;&gt;time.strptime(\"07/24/2017\",\"%m/%d/%Y\")\ntime.struct_time(tm_year=2017, tm_mon=7, tm_mday=24, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=0, tm_yday=205, tm_isdst=-1)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3","title":"3. \u65f6\u95f4\u6233\u4e0e\u5b57\u7b26\u4e32\u65f6\u95f4","text":"<pre><code># time.ctime(\u65f6\u95f4\u6233)  \u5982\u679c\u4e0d\u4f20\u53c2\u6570\uff0c\u76f4\u63a5\u8fd4\u56de\u5f53\u524d\u65f6\u95f4\u7684\u683c\u5f0f\u5316\u4e32\n&gt;&gt;&gt; time.ctime()\n'Mon Feb  3 15:48:36 2020'\n&gt;&gt;&gt; time.ctime(1500000000)\n'Fri Jul 14 10:40:00 2017'\n</code></pre> <p>\u8ba1\u7b97\u65f6\u95f4\u5dee</p> <pre><code>&gt;&gt;&gt; import time\n&gt;&gt;&gt; true_time=time.mktime(time.strptime('2017-09-11 08:30:00','%Y-%m-%d %H:%M:%S'))\n&gt;&gt;&gt; time_now=time.mktime(time.strptime('2017-09-12 11:00:00','%Y-%m-%d %H:%M:%S'))\n&gt;&gt;&gt; dif_time=time_now-true_time\n&gt;&gt;&gt; struct_time=time.gmtime(dif_time)\n&gt;&gt;&gt; print('\u8fc7\u53bb\u4e86%d\u5e74%d\u6708%d\u5929%d\u5c0f\u65f6%d\u5206\u949f%d\u79d2'%(struct_time.tm_year-1970,struct_time.tm_mon-1,\n...                                        struct_time.tm_mday-1,struct_time.tm_hour,\n...                                        struct_time.tm_min,struct_time.tm_sec))\n\u8fc7\u53bb\u4e860\u5e740\u67081\u59292\u5c0f\u65f630\u5206\u949f0\u79d2\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-datetime","title":"2. datetime","text":"<p>datatime\u6a21\u5757\u91cd\u65b0\u5c01\u88c5\u4e86time\u6a21\u5757\uff0c\u63d0\u4f9b\u4e86date,time,datetime,timedelta,tzinfo\u4e94\u4e2a\u7c7b</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1-date","title":"1. date\u7c7b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1_2","title":"1. \u9759\u6001\u65b9\u6cd5\u548c\u5b57\u6bb5","text":"<pre><code># date\u5bf9\u8c61\u591a\u80fd\u8868\u793a\u7684\u6700\u5927\u65e5\u671f\nprint(datetime.date.max)    # 9999-12-31\n# date\u5bf9\u8c61\u591a\u80fd\u8868\u793a\u7684\u6700\u5c0f\u65e5\u671f\nprint(datetime.date.min)    # 0001-01-01\n# date\u5bf9\u8c61\u8868\u793a\u65e5\u671f\u7684\u6700\u5c0f\u5355\u4f4d\nprint(datetime.date.resolution) # 1 day, 0:00:00\n# \u8fd4\u56de\u4e00\u4e2a\u8868\u793a\u5f53\u524d\u672c\u5730\u65e5\u671f\u7684date\u5bf9\u8c61\uff1b\nprint(datetime.date.today())    # 2020-03-12\n# \u6839\u636e\u7ed9\u5b9a\u7684\u65f6\u95f4\u622e\uff0c\u8fd4\u56de\u4e00\u4e2adate\u5bf9\u8c61\nprint(datetime.date.fromtimestamp(time.time())) # 2020-03-12\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2_1","title":"2. \u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u65b9\u6cd5","text":"<p>1\u3001 date\u5bf9\u8c61\u7684\u5c5e\u6027</p> <pre><code>d = datetime.date(2020,3,13)\n\nprint(d.year)   # 2020\nprint(d.month)  # 3\nprint(d.day)    # 13\n</code></pre> <p>2\u3001 date\u5bf9\u8c61\u7684\u65b9\u6cd5</p> <pre><code>d = datetime.date(2020,3,13)\n# \u751f\u6210\u4e00\u4e2a\u65b0\u7684\u65e5\u671f\u5bf9\u8c61\uff0c\u7528\u53c2\u6570\u6307\u5b9a\u7684\u5e74\uff0c\u6708\uff0c\u65e5\u4ee3\u66ff\u539f\u6709\u5bf9\u8c61\u4e2d\u7684\u5c5e\u6027\u3002\uff08\u539f\u6709\u5bf9\u8c61\u4ecd\u4fdd\u6301\u4e0d\u53d8\uff09\nd2=d.replace(2020,3,12)\nprint(d2.day)   # 12\n# \u8fd4\u56de\u65e5\u671f\u5bf9\u5e94\u7684time.struct_time\u5bf9\u8c61\nprint(d.timetuple()) # time.struct_time(tm_year=2020, tm_mon=3, tm_mday=13, tm_hour=0, tm_min=0, tm_sec=0, tm_wday=4, tm_yday=73, tm_isdst=-1)\n# \u8fd4\u56de\u4e00\u5468\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c\u5982\u679c\u662f\u661f\u671f\u4e00\uff0c\u8fd4\u56de0\nprint(d.weekday())  # 4\n# \u8fd4\u56de\u4e00\u5468\u4e2d\u7684\u7b2c\u51e0\u5929\uff0c\u5982\u679c\u662f\u661f\u671f\u4e00\uff0c\u8fd4\u56de1\nprint(d.isoweekday())   # 5\n# \u8fd4\u56de\u4e00\u4e2a\u5143\u7ec4,\u683c\u5f0f\u5982(year\uff0cmonth\uff0cday)\nprint(d.isocalendar())  # (2020, 11, 5)\n# \u8fd4\u56de\u683c\u5f0f\u5982'YYYY-MM-DD\u2019\u7684\u5b57\u7b26\u4e32\nprint(d.isoformat())    # 2020-03-13\n# \u683c\u5f0f\u5316\u8f93\u51fa\u65f6\u95f4\nprint(d.strftime('%Y-%m-%d'))\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-time","title":"2. time\u7c7b\u7684\u5c5e\u6027","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1-time","title":"1. time\u7c7b\u5c5e\u6027","text":"<pre><code>t = datetime.time(10,30,25)\n# time\u7c7b\u80fd\u8868\u793a\u7684\u6700\u5c0f\u65f6\u95f4\nprint(datetime.time.min)    # 00:00:00\n# time\u7c7b\u80fd\u8868\u793a\u7684\u6700\u5927\u65f6\u95f4\nprint(datetime.time.max)    # 23:59:59.999999\n# \u65f6\u95f4\u7684\u6700\u5c0f\u5355\u4f4d\nprint(datetime.time.resolution) # 0:00:00.000001\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-time_1","title":"2. time\u5bf9\u8c61\u7684\u5c5e\u6027\u548c\u65b9\u6cd5","text":"<pre><code>t = datetime.time(10,30,25)\n# time\u5bf9\u8c61\u7684\u5c5e\u6027\nprint(t.hour)   # 10\nprint(t.minute) # 30\nprint(t.second) # 25\nprint(t.microsecond) # 0\n\nt = datetime.time(10,30,25)\n# \u8fd4\u56de\u578b\u5982\"HH:MM:SS\"\u683c\u5f0f\u7684\u5b57\u7b26\u4e32\nprint(t.isoformat())    # 10:30:25\n# \u683c\u5f0f\u5316\u65f6\u95f4\nprint(t.strftime(\"%H:%M:%S\"))   # 10:30:25\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3-datetime","title":"3. datetime\u7c7b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1-datetime","title":"1. datetime \u65b9\u6cd5\u548c\u5c5e\u6027","text":"<pre><code># \u8fd4\u56de\u8868\u793a\u5f53\u524d\u65f6\u95f4\u7684datetime\u5bf9\u8c61\nnow = datetime.datetime.today()  \nprint(now)    # 2020-03-13 23:00:09.199437\nprint(type(now))    # &lt;class 'datetime.datetime'&gt;\n\n# \u83b7\u53d6\u5f53\u524d\u4e16\u754c\u65f6\u95f4\nprint(datetime.datetime.utcnow())   # 2020-03-13 15:59:36.123860\n\n# \u5f53\u524d\u672c\u5730\u65f6\u95f4\u7684datetime\u5bf9\u8c61\nnow = datetime.datetime.now()  \nprint(now)  # 2020-03-13 23:02:27.245569\n# \u8fd4\u56de\u7ed3\u6784\u5316\u65f6\u95f4\nprint(now.timetuple()) # time.struct_time(tm_year=2020, tm_mon=3, tm_mday=13, tm_hour=23, tm_min=38, tm_sec=3, tm_wday=4, tm_yday=73, tm_isdst=-1)\n# \u8fd4\u56de\u661f\u671f\u51e0\nprint(now.weekday())    # 4\n# \u8fd4\u56de\u65f6\u95f4\u5143\u7ec4\nprint(now.isocalendar())    # (2020, 11, 5)\n# \u8fd4\u56de'YYYY-MM-DD HH:MM:SS.mmmmmm'\u683c\u5f0f\u7684\u65f6\u95f4\nprint(now.isoformat())  # 2020-03-13T23:45:03.656919\n# \u683c\u5f0f\u5316\u65f6\u95f4\nprint(now.strftime(\"%Y-%m-%d %H:%M:%S\"))    # 2020-03-13 23:50:55\n\nprint(now.ctime())  # Fri Mar 13 23:51:20 2020\n</code></pre> <ol> <li>datetime.now()</li> </ol> <pre><code># \u83b7\u53d6\u5f53\u524d\u672c\u5730\u65f6\u95f4\n&gt;&gt;&gt; datetime.now()\ndatetime.datetime(2020, 2, 3, 16, 11, 20, 441441)\n# \u83b7\u53d6\u5f53\u524d\u4e16\u754c\u65f6\u95f4\n&gt;&gt;&gt; datetime.utcnow()\ndatetime.datetime(2020, 2, 3, 8, 11, 32, 641304)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#re","title":"\u56db\u3001re\u6a21\u5757","text":"<p>\u6b63\u5219\u8868\u8fbe\u5f0f\u662f\u5305\u542b\u6587\u672c\u548c\u7279\u6b8a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\uff0c\u8be5\u5b57\u7b26\u4e32\u63cf\u8ff0\u4e00\u4e2a\u53ef\u4ee5\u8bc6\u522b\u5404\u79cd\u5b57\u7b26\u4e32\u7684\u6a21\u5f0f\u3002Python \u901a\u8fc7\u6807\u51c6\u5e93\u4e2d\u7684<code>re</code>\u6a21\u5757\u6765\u652f\u6301\u6b63\u5219\u8868\u8fbe\u5f0f\u3002</p> <p>\u6a21\u5f0f\u5339\u914d\uff1a</p> <ol> <li>\u641c\u7d22\uff08search\uff09\uff1a\u5728\u5b57\u7b26\u4e32\u4efb\u610f\u90e8\u5206\u4e2d\u641c\u7d22\u5339\u914d\u7684\u6a21\u5f0f</li> <li>\u5339\u914d\uff08match\uff09\uff1a\u5224\u65ad\u4e00\u4e2a\u5b57\u7b26\u4e32\u80fd\u5426\u4ece\u8d77\u59cb\u5904\u5168\u90e8\u6216\u90e8\u5206\u5730\u5339\u914d\u67d0\u4e2a\u6a21\u5f0f</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1_3","title":"1. \u6b63\u5219\u57fa\u7840","text":"<p>\u6b63\u5219\u8868\u8fbe\u5f0f\u7684\u5355\u5b57\u7b26\u5339\u914d\uff08\u7279\u6b8a\u5b57\u7b26\uff09</p> \u5b57\u7b26 \u63cf\u8ff0 <code>.</code> \u5339\u914d\u4efb\u610f\u4e00\u4e2a\u5b57\u7b26\uff08\u9664\u4e86\\n\uff09 <code>[]</code> \u5339\u914d[]\u5217\u4e3e\u7684\u5b57\u7b26 <code>\\d</code> \u5339\u914d\u6570\u5b57\uff0c\u5373[0-9] <code>\\D</code> \u5339\u914d\u975e\u6570\u5b57\uff0c\u5373[^0-9] <code>\\s</code> \u5339\u914d\u7a7a\u767d\u3001\u5373\u7a7a\u683c\u3001tab <code>\\S</code> \u5339\u914d\u975e\u7a7a\u767d <code>\\w</code> \u5339\u914d\u5355\u8bcd\u5b57\u7b26\uff0c\u5373a-z\u3001A-Z\u30010-9\u3001_ <code>\\W</code> \u5339\u914d\u975e\u5355\u8bcd\u5b57\u7b26 <p>\u8868\u793a\u6570\u91cf</p> \u5b57\u7b26 \u529f\u80fd <code>*</code> \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u51fa\u73b00\u6b21\u6216\u8005\u65e0\u9650\u6b21\uff0c\u5373\u53ef\u6709\u53ef\u65e0 <code>+</code> \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u51fa\u73b01\u6b21\u6216\u8005\u65e0\u9650\u6b21\uff0c\u5373\u81f3\u5c11\u67091\u6b21 <code>?</code> \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u51fa\u73b01\u6b21\u6216\u80050\u6b21\uff0c\u5373\u8981\u4e48\u67091\u6b21\uff0c\u8981\u4e48\u6ca1\u6709 <code>{m}</code> \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u51fa\u73b0m\u6b21 <code>{m,}</code> \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u81f3\u5c11\u51fa\u73b0m\u6b21 <code>{m,n}</code> \u5339\u914d\u524d\u4e00\u4e2a\u5b57\u7b26\u51fa\u73b0m\u6b21\u5230n\u6b21 <p>\u5339\u914d\u8fb9\u754c</p> \u5b57\u7b26 \u529f\u80fd <code>^</code> \u5339\u914d\u5b57\u7b26\u4e32\u5f00\u5934 <code>$</code> \u5339\u914d\u5b57\u7b26\u4e32\u7ed3\u5c3e <code>\\b</code> \u5339\u914d\u4e00\u4e2a\u5355\u8bcd\u7684\u8fb9\u754c <code>\\a</code> \u5339\u914d\u975e\u5355\u8bcd\u7684\u8fb9\u754c <p>\u5339\u914d\u5206\u7ec4</p> \u5b57\u7b26 \u529f\u80fd <code>|</code> \u5339\u914d\u5de6\u53f3\u4efb\u610f\u4e00\u4e2a\u8868\u8fbe\u5f0f <code>(ab)</code> \u5c06\u62ec\u53f7\u4e2d\u5b57\u7b26\u4f5c\u4e3a\u4e00\u4e2a\u5206\u7ec4 <code>\\num</code> \u5f15\u7528\u5206\u7ec4num\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32 <code>(?P&lt;name&gt;)</code> \u5206\u7ec4\u8d77\u522b\u540d <code>(?P=name)</code> \u5f15\u7528\u522b\u540d\u4e3aname\u5206\u7ec4\u5339\u914d\u5230\u7684\u5b57\u7b26\u4e32"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-python","title":"2. python\u4e2d\u6b63\u5219\u4f7f\u7528","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1-match","title":"1. match","text":"<p>\u4ece\u5b57\u7b26\u4e32\u7684\u8d77\u59cb\u90e8\u5206\u5bf9\u6a21\u5f0f\u8fdb\u884c\u5339\u914d\u3002\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5c31\u8fd4\u56de\u4e00\u4e2a\u5339\u914d\u5bf9\u8c61\uff1b\u5982\u679c\u5339\u914d\u5931\u8d25\uff0c\u5c31\u8fd4\u56de None.</p> <pre><code># 1. \u5206\u7ec4\n&gt;&gt;&gt; import re\n&gt;&gt;&gt; re.match(r\"&lt;h1&gt;(.*)&lt;/h1&gt;\", \"&lt;h1&gt;\u5185\u5bb9&lt;/h1&gt;\")\n&lt;_sre.SRE_Match object; span=(0, 11), match='&lt;h1&gt;\u5185\u5bb9&lt;/h1&gt;'&gt;\n&gt;&gt;&gt; res = re.match(r\"&lt;h1&gt;(.*)&lt;/h1&gt;\", \"&lt;h1&gt;\u5185\u5bb9&lt;/h1&gt;\")\n&gt;&gt;&gt; res.group(1)\n'\u5185\u5bb9'\n# 2. \u5f15\u7528\u5206\u7ec4\n&gt;&gt;&gt; res = re.match(r\"&lt;(.+)&gt;&lt;(.+)&gt;.+&lt;/\\2&gt;&lt;/\\1&gt;\", \"&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;/html&gt;\")\n&gt;&gt;&gt; res\n&lt;_sre.SRE_Match object; span=(0, 27), match='&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;/html&gt;'&gt;\u3001\n# 3. \u5206\u7ec4\u8d77\u522b\u540d\n&gt;&gt;&gt; res = re.match(r\"&lt;(?P&lt;html&gt;.+)&gt;&lt;(?P&lt;head&gt;.+)&gt;.+&lt;/(?P=head)&gt;&lt;/(?P=html)&gt;\", \"&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;/html&gt;\")\n&gt;&gt;&gt; res\n&lt;_sre.SRE_Match object; span=(0, 27), match='&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;/html&gt;'&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-search","title":"2. search","text":"<p>\u5728\u4efb\u610f\u4f4d\u7f6e\u5bf9\u7ed9\u5b9a\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u641c\u7d22\u7b2c\u4e00\u6b21\u51fa\u73b0\u7684\u5339\u914d\u60c5\u51b5\u3002\u5982\u679c\u641c\u7d22\u5230\u6210\u529f\u7684\u5339\u914d\uff0c\u5c31\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5339\u914d\u5bf9\u8c61\uff1b\u5426\u5219\uff0c\u8fd4\u56de None\u3002\uff08\u5982\u679c\u627e\u52301\u4e2a\u5c31\u4e0d\u518d\u5411\u540e\u5339\u914d\uff09</p> <pre><code>&gt;&gt;&gt; res = re.search(r\"hello\", \"&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;/html&gt;\")\n&gt;&gt;&gt; res\n&lt;_sre.SRE_Match object; span=(10, 15), match='hello'&gt;\n&gt;&gt;&gt; res = re.match(r\"hello\", \"&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;/html&gt;\")\n&gt;&gt;&gt; res\n&gt;&gt;&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3-findall","title":"3. findall","text":"<p>\u67e5\u8be2\u5b57\u7b26\u4e32\u4e2d\u67d0\u4e2a\u6b63\u5219\u8868\u8fbe\u5f0f\u6a21\u5f0f\u5168\u90e8\u7684\u975e\u91cd\u590d\u51fa\u73b0\u60c5\u51b5\u3002\u679c findall()\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u90e8\u5206\uff0c\u5c31\u8fd4\u56de\u4e00\u4e2a\u7a7a\u5217\u8868\uff0c\u4f46\u5982\u679c\u5339\u914d\u6210\u529f\uff0c\u5217\u8868\u5c06\u5305\u542b\u6240\u6709\u6210\u529f\u7684\u5339\u914d\u90e8\u5206\u3002\uff08\u4ece\u5de6\u5411\u53f3\u6309\u51fa\u73b0\u987a\u5e8f\u6392\u5217\uff09</p> <pre><code>&gt;&gt;&gt; res = re.findall(r\"hello\", \"&lt;html&gt;&lt;h1&gt;hello&lt;/h1&gt;&lt;h2&gt;hello world&lt;/h2&gt;&lt;/html&gt;\")\n&gt;&gt;&gt; res\n['hello', 'hello']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#4-sub","title":"4. sub","text":"<p>\u5c06\u5339\u914d\u5230\u7684\u6570\u636e\u8fdb\u884c\u66ff\u6362</p> <p>1 \u66ff\u6362\u7684\u90e8\u5206\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32</p> <pre><code># \u66ff\u6362\u7684\u90e8\u5206\u662f\u4e00\u4e2a\u5b57\u7b26\u4e32\n&gt;&gt;&gt; re.sub(r\"java\", \"python\", \"I love java\")\n'I love python'\n</code></pre> <p>2 \u66ff\u6362\u7684\u90e8\u5206\u662f\u4e00\u4e2a\u51fd\u6570</p> <pre><code># \u66ff\u6362\u7684\u90e8\u5206\u662f\u4e00\u4e2a\u51fd\u6570\n&gt;&gt;&gt; def replace(result):\n...     res = int(result.group())+1\n...     return str(res)\n...\n&gt;&gt;&gt; re.sub(r\"\\d+\", replace, \"cnt=5\")\n'cnt=6'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#5-split","title":"5. split","text":"<p>\u6839\u636e\u5339\u914d\u8fdb\u884c\u5206\u5272\u5b57\u7b26\u4e32\uff0c\u5e76\u8fd4\u56de\u4e00\u4e2a\u5217\u8868</p> <pre><code>&gt;&gt;&gt; re.split(r\",\", \"python,java,php\")\n['python', 'java', 'php']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3_1","title":"3. \u8d2a\u5a6a\u6a21\u5f0f\u4e0e\u975e\u8d2a\u5a6a\u6a21\u5f0f","text":"<p>\u8d2a\u5a6a\u5339\u914d\uff1a\u5728\u6ee1\u8db3\u5339\u914d\u65f6\uff0c\u5339\u914d\u5c3d\u53ef\u80fd\u957f\u7684\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u91c7\u7528\u8d2a\u5a6a\u5339\u914d</p> <pre><code>&gt;&gt;&gt; s = \"this is a number 123-456-789\"\n&gt;&gt;&gt; r.group()\n'this is a number 123-456-789'\n# \u8d2a\u5a6a\u6a21\u5f0f\n&gt;&gt;&gt; r.groups()\n('this is a number 12', '3-456-789')\n# \u52a0?\u5173\u95ed\u8d2a\u5a6a\u6a21\u5f0f\n&gt;&gt;&gt; r = re.match(r\"(.+?)(\\d+-\\d+-\\d+)\", s)\n&gt;&gt;&gt; r.groups()\n('this is a number ', '123-456-789')\n</code></pre> <p>\u51e0\u4e2a\u5e38\u7528\u7684\u975e\u8d2a\u5a6a\u5339\u914dPattern</p> <ol> <li> <p><code>*?</code>  \u91cd\u590d\u4efb\u610f\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u91cd\u590d</p> </li> <li> <p><code>+?</code>  \u91cd\u590d1\u6b21\u6216\u66f4\u591a\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u91cd\u590d</p> </li> <li> <p><code>??</code>  \u91cd\u590d0\u6b21\u62161\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u91cd\u590d</p> </li> <li> <p><code>{n,m}?</code>  \u91cd\u590dn\u5230m\u6b21\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u91cd\u590d</p> </li> <li> <p><code>{n,}?</code>  \u91cd\u590dn\u6b21\u4ee5\u4e0a\uff0c\u4f46\u5c3d\u53ef\u80fd\u5c11\u91cd\u590d</p> </li> <li> <p><code>.*?x</code>  \u53d6\u524d\u9762\u4efb\u610f\u957f\u5ea6\u7684\u5b57\u7b26\uff0c\u76f4\u5230\u4e00\u4e2ax\u51fa\u73b0</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#collection","title":"\u4e94\u3001collection\u6a21\u5757","text":"<p>\u5728\u5185\u7f6e\u6570\u636e\u7c7b\u578b\uff08dict\u3001list\u3001set\u3001tuple\uff09\u7684\u57fa\u7840\u4e0a\uff0ccollections\u6a21\u5757\u8fd8\u63d0\u4f9b\u4e86\u51e0\u4e2a\u989d\u5916\u7684\u6570\u636e\u7c7b\u578b\uff1aCounter\u3001deque\u3001defaultdict\u3001namedtuple\u548cOrderedDict\u7b49\u3002</p> <ol> <li> <p>namedtuple: \u751f\u6210\u53ef\u4ee5\u4f7f\u7528\u540d\u5b57\u6765\u8bbf\u95ee\u5143\u7d20\u5185\u5bb9\u7684tuple</p> </li> <li> <p>deque: \u53cc\u7aef\u961f\u5217\uff0c\u53ef\u4ee5\u5feb\u901f\u7684\u4ece\u53e6\u5916\u4e00\u4fa7\u8ffd\u52a0\u548c\u63a8\u51fa\u5bf9\u8c61</p> </li> <li> <p>Counter: \u8ba1\u6570\u5668\uff0c\u4e3b\u8981\u7528\u6765\u8ba1\u6570</p> </li> <li> <p>OrderedDict: \u6709\u5e8f\u5b57\u5178\uff0cpython3.6\u540e\u81ea\u52a8\u6709\u5e8f</p> </li> <li> <p>defaultdict: \u5e26\u6709\u9ed8\u8ba4\u503c\u7684\u5b57\u5178</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1-namedtuple","title":"1. namedtuple","text":"<pre><code>&gt;&gt;&gt; from collections import namedtuple\n&gt;&gt;&gt; Point = namedtuple('Point', ['x', 'y'])\n&gt;&gt;&gt; p = Point(1, 2)\n&gt;&gt;&gt; p.x\n&gt;&gt;&gt; p.y\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-deque","title":"2. deque","text":"<p>\u4f7f\u7528list\u5b58\u50a8\u6570\u636e\u65f6\uff0c\u6309\u7d22\u5f15\u8bbf\u95ee\u5143\u7d20\u5f88\u5feb\uff0c\u4f46\u662f\u63d2\u5165\u548c\u5220\u9664\u5143\u7d20\u5c31\u5f88\u6162\u4e86\uff0c\u56e0\u4e3alist\u662f\u7ebf\u6027\u5b58\u50a8\uff0c\u6570\u636e\u91cf\u5927\u7684\u65f6\u5019\uff0c\u63d2\u5165\u548c\u5220\u9664\u6548\u7387\u5f88\u4f4e\u3002</p> <p>deque\u662f\u4e3a\u4e86\u9ad8\u6548\u5b9e\u73b0\u63d2\u5165\u548c\u5220\u9664\u64cd\u4f5c\u7684\u53cc\u5411\u5217\u8868\uff0c\u9002\u5408\u7528\u4e8e\u961f\u5217\u548c\u6808\uff1a</p> <pre><code>&gt;&gt;&gt; from collections import deque\n&gt;&gt;&gt; q = deque(['a', 'b', 'c'])\n&gt;&gt;&gt; q.append('x')\n&gt;&gt;&gt; q.appendleft('y')\n&gt;&gt;&gt; q\ndeque(['y', 'a', 'b', 'c', 'x'])\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3-ordereddict","title":"3. OrderedDict","text":"<p>\u4f7f\u7528dict\u65f6\uff0cKey\u662f\u65e0\u5e8f\u7684\u3002\u5728\u5bf9dict\u505a\u8fed\u4ee3\u65f6\uff0c\u6211\u4eec\u65e0\u6cd5\u786e\u5b9aKey\u7684\u987a\u5e8f\u3002</p> <p>\u5982\u679c\u8981\u4fdd\u6301Key\u7684\u987a\u5e8f\uff0c\u53ef\u4ee5\u7528<code>OrderedDict</code>\uff1a</p> <pre><code>&gt;&gt;&gt; from collections import OrderedDict\n&gt;&gt;&gt; d = dict([('a', 1), ('b', 2), ('c', 3)])\n&gt;&gt;&gt; d # dict\u7684Key\u662f\u65e0\u5e8f\u7684\n{'a': 1, 'c': 3, 'b': 2}\n&gt;&gt;&gt; od = OrderedDict([('a', 1), ('b', 2), ('c', 3)])\n&gt;&gt;&gt; od # OrderedDict\u7684Key\u662f\u6709\u5e8f\u7684\nOrderedDict([('a', 1), ('b', 2), ('c', 3)])\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#random","title":"\u516d\u3001random\u6a21\u5757","text":"\u65b9\u6cd5 \u529f\u80fd random.random() \u83b7\u53d6[0.0,1.0)]\u8303\u56f4\u5185\u7684\u6d6e\u70b9\u6570 random.ranint(a,b) \u83b7\u53d6[a,b)\u8303\u56f4\u5185\u7684\u4e00\u4e2a\u6574\u6570 random.uniform(a,b) \u83b7\u53d6[a,b)\u8303\u56f4\u5185\u7684\u4e00\u4e2a\u6d6e\u70b9\u6570 random.shuffle(x) \u628a\u53c2\u6570\u6307\u5b9a\u7684\u6570\u636e\u4e2d\u7684\u5143\u7d20\u6253\u4e71\uff0c\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u53ef\u53d8\u7684\u6570\u636e\u7c7b\u578b random.sample(x,k) \u4ecex\u4e2d\u968f\u673a\u62bd\u53d6k\u4e2a\u6570\u636e"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#shutil","title":"\u4e03\u3001shutil\u6a21\u5757","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1_4","title":"1. \u62f7\u8d1d\u6587\u4ef6","text":"<pre><code>shutil.copy2('src', 'dest')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2_2","title":"2. \u62f7\u8d1d\u76ee\u5f55","text":"<pre><code>shutil.copytree(\"\u539f\u76ee\u5f55\", \"\u65b0\u76ee\u5f55\", ignore=shutil.ignore_patterns(\"*.pyc\"))\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#3_2","title":"3. \u5220\u9664\u76ee\u5f55","text":"<pre><code>shutil.rmtree(\"temp\", ignore_errors=True)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#4","title":"4. \u79fb\u52a8\u6587\u4ef6/\u76ee\u5f55","text":"<pre><code>shutil.move(\"src\", \"dest\", copy_function=shutil.copy2)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#5","title":"5. \u83b7\u53d6\u78c1\u76d8\u4f7f\u7528\u7a7a\u95f4","text":"<pre><code>total, used, free = shutil.disk_usage(\".\")\nprint(\"\u5f53\u524d\u78c1\u76d8\u5171: %iGB, \u5df2\u4f7f\u7528: %iGB, \u5269\u4f59: %iGB\"%(total / 1073741824, used / 1073741824, free / 1073741824))\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#6","title":"6. \u538b\u7f29\u6587\u4ef6","text":"<pre><code>shutil.make_archive('\u538b\u7f29\u6587\u4ef6\u5939\u7684\u540d\u5b57', 'zip','\u5f85\u538b\u7f29\u7684\u6587\u4ef6\u5939\u8def\u5f84')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#7","title":"7. \u89e3\u538b\u6587\u4ef6","text":"<pre><code>shutil.unpack_archive('zip\u6587\u4ef6\u7684\u8def\u5f84.zip'\uff0c'\u89e3\u538b\u5230\u76ee\u7684\u6587\u4ef6\u5939\u8def\u5f84')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#argparse","title":"\u516b\u3001argparse\u6a21\u5757","text":"<pre><code>import argparse\nparser = argparse.ArgumentParser()\nparser.parse_args()\n</code></pre> <p>\u8fd0\u884c\u7ed3\u679c</p> <pre><code>$ python3 test.py --help\nusage: test.py [-h]\n\noptional arguments:\n  -h, --help  show this help message and exit\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1_5","title":"1. \u4f4d\u7f6e\u53c2\u6570","text":"<pre><code>import argparse\nparser = argparse.ArgumentParser()\nparser.add_argument(\"address\", help=\"host ip  address\")   # address \u5c31\u662f\u4f4d\u7f6e\u53c2\u6570\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u53d8\u91cf\uff0c\u5728\u547d\u4ee4\u4e2d\u5c5e\u4e8e\u7684\u53c2\u6570\u4f1a\u4fdd\u5b58\u5728\u8fd9\u4e2a\"\u53d8\u91cf\u4e2d\"\nargs = parser.parse_args()\nprint(args.address)  # \u6253\u5370\u53c2\u6570\n</code></pre> <pre><code>$ python3 test.py --help\nusage: test.py [-h] address\n\npositional arguments:   # \u4f4d\u7f6e\u53c2\u6570\n  address     host ip address\n\noptional arguments:\n  -h, --help  show this help message and exit\n\n$ python3 test.py  127.0.0.1\n127.0.0.1\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2_3","title":"2. \u53ef\u9009\u53c2\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#21","title":"2.1 \u957f\u9009\u9879","text":"<pre><code>import argparse\nparser = argparse.ArgumentParser()\nparser.add_argument(\"--install\", help=\"install service\")\nargs = parser.parse_args()\nprint(args.install) # \u6253\u5370\u53c2\u6570\u7684\u503c\uff0c \u53c2\u6570\u540e\u9762\u5fc5\u987b\u6709\u4e00\u4e2a\u503c\n# \u5982\u679c\u4e0d\u9700\u8981\u503c\n# parser.add_argument(\"--install\", help=\"install service\", action=\"store_true\")\n</code></pre> <pre><code>$ python3 test.py --help\nusage: test.py [-h] [--install INSTALL]\n\noptional arguments:\n  -h, --help         show this help message and exit\n  --install INSTALL  install service\n\n$ python3 test.py --install http\nhttp\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#22","title":"2.2 \u77ed\u9009\u9879","text":"<pre><code>import argparse\nparser = argparse.ArgumentParser()\nparser.add_argument(\"-i\", \"--install\", help=\"install service\")\nargs = parser.parse_args()\nprint(args.install)\n</code></pre> <pre><code>$ python3 test.py --help\nusage: test.py [-h] [-i INSTALL]\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -i INSTALL, --install INSTALL\n                        install service\n$ python3 test.py -i http\nhttp\n$ python3 test.py --install  http\nhttp\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#23","title":"2.3 \u51b2\u7a81\u9009\u9879","text":"<pre><code>import argparse\n\nparser = argparse.ArgumentParser(description=\"upgrade or rollback service\")\ngroup = parser.add_mutually_exclusive_group()\ngroup.add_argument(\"-u\", \"--upgrade\", help=\"upgrade service\",\n                   metavar=\"service\")\ngroup.add_argument(\"-r\", \"--rollback\", help=\"rollback service\",\n                   metavar=\"service\")\nargs = parser.parse_args()\n\n\ndef upgrade(service):\n    print(\"upgrade {0}\".format(service))\n\n\ndef rollback(service):\n    print(\"rollback {0}\".format(service))\n\n\nif args.upgrade:\n    upgrade(args.upgrade)\n\nif args.rollback:\n    rollback(args.rollback)\n</code></pre> <pre><code>$ python3 test.py  --help\nusage: test.py [-h] [-u service | -r service]\n\nupgrade or rollback service\n\noptional arguments:\n  -h, --help            show this help message and exit\n  -u service, --upgrade service\n                        upgrade service\n  -r service, --rollback service\n                        rollback service\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#_2","title":"\u4e5d\u3001\u5e8f\u5217\u5316","text":"<p>\u628a\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u8f6c\u6362\u6210\u5b57\u7b26\u4e32\u3001bytes\u7c7b\u578b\u7684\u8fc7\u7a0b\u3002</p> <p>\u5e94\u7528\u573a\u666f\uff1a</p> <ol> <li>\u628a\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u5b58\u50a8\u5230\u6587\u4ef6\u4e2d\u7684\u65f6\u5019</li> <li>\u628a\u4e00\u4e2a\u6570\u636e\u7c7b\u578b\u901a\u8fc7\u7f51\u7edc\u4f20\u8f93\u7684\u65f6\u5019</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#1-json","title":"1. json\u6a21\u5757","text":"<p>JSON(JavaScript Object Notation)</p> <p>json\u7684\u4f18\u70b9\uff1a</p> <ol> <li>\u6240\u6709\u7684\u8bed\u8a00\u90fd\u901a\u7528</li> </ol> <p>json\u7684\u7f3a\u70b9\uff1a</p> <ol> <li>\u53ea\u652f\u6301\u975e\u5e38\u5c11\u7684\u6570\u636e\u7c7b\u578b</li> <li>\u5bf9\u6570\u636e\u7c7b\u578b\u7684\u7ea6\u675f\u5f88\u82db\u523b</li> <li>\u5b57\u5178\u7684key\u5fc5\u987b\u662f\u5b57\u7b26\u4e32</li> <li>\u53ea\u652f\u6301\u6570\u5b57\u3001\u5b57\u7b26\u4e32\u3001\u5217\u8868\u3001\u5b57\u5178</li> </ol> <p>json\u51fd\u6570</p> \u51fd\u6570 \u63cf\u8ff0 json.dumps \u5c06 Python \u5bf9\u8c61\u7f16\u7801\u6210 JSON \u5b57\u7b26\u4e32 json.loads \u5c06\u5df2\u7f16\u7801\u7684 JSON \u5b57\u7b26\u4e32\u89e3\u7801\u4e3a Python \u5bf9\u8c61 json.dump \u5c06 Python \u5bf9\u8c61\u7f16\u7801\u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d json.load \u4ece\u6587\u4ef6\u4e2d\u5c06\u5df2\u7f16\u7801\u7684 JSON \u5b57\u7b26\u4e32\u89e3\u7801\u4e3a Python \u5bf9\u8c61\uff0c\u53ea\u80fdload\u4e00\u6b21 <p>\u5e38\u7528\u7684\u53c2\u6570</p> <pre><code>sort_keys=True  \u6309ASCII\u6392\u5e8f\nindent=4            \u7f29\u8fdb\nseparators=(',', ':')\nensure_ascii=False\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#11-dumpsloads","title":"1.1 dumps\u548cloads","text":"<pre><code>import json\n\nusers = {\"username\":'\u5f20\u4e09', \"password\":'123456'}\nres = json.dumps(users, ensure_ascii=False)\nprint(res,type(res))\nuser1 = json.loads(res)\nprint(user1, type(user1))\n# \u6267\u884c\u7ed3\u679c\n{\"username\": \"\u5f20\u4e09\", \"password\": \"123456\"} &lt;class 'str'&gt;\n{'username': '\u5f20\u4e09', 'password': '123456'} &lt;class 'dict'&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#12-dumpload","title":"1.2 dump\u548cload","text":"<pre><code>import json\n\nusers = {\"username\":'\u5f20\u4e09', \"password\":'123456'}\nwith open('user.txt', 'w') as f:\n    json.dump(users, f, ensure_ascii=False)\n\nwith open('user.txt', 'r') as f:\n    user = json.load(f)\nprint(user)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/01-%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/#2-pickle","title":"2. pickle","text":"<p>\u53ef\u4ee5\u5b58\u50a8\u7684\u6570\u636e\u7c7b\u578b</p> <ol> <li>\u6240\u6709python\u652f\u6301\u7684\u539f\u751f\u7c7b\u578b\uff1a\u5e03\u5c14\u503c\uff0c\u6574\u6570\uff0c\u6d6e\u70b9\u6570\uff0c\u590d\u6570\uff0c\u5b57\u7b26\u4e32\uff0c\u5b57\u8282\uff0cNone\u3002</li> <li>\u7531\u4efb\u4f55\u539f\u751f\u7c7b\u578b\u7ec4\u6210\u7684\u5217\u8868\uff0c\u5143\u7ec4\uff0c\u5b57\u5178\u548c\u96c6\u5408\u3002</li> <li>\u51fd\u6570\uff0c\u7c7b\uff0c\u7c7b\u7684\u5b9e\u4f8b</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/","title":"\u57fa\u672c\u6570\u636e\u7c7b\u578b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_2","title":"\u4e00\u3001\u6570\u503c","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#1","title":"1. \u6570\u503c\u7c7b\u578b","text":"<p>python\u6570\u503c\u7c7b\u578b</p> <ol> <li>\u6574\u6570</li> <li>\u6d6e\u70b9\u6570</li> <li>\u590d\u6570</li> <li>\u5c0f\u6570</li> <li>\u5206\u6570</li> <li>\u96c6\u5408</li> <li>\u5e03\u5c14\u503c <code>True</code> \u548c<code>False</code></li> <li>\u5185\u7f6e\u51fd\u6570\u548c\u6a21\u5757\uff1around\u3001math\u3001random</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#2","title":"2. \u6570\u503c\u8fd0\u7b97","text":"<pre><code>&gt;&gt;&gt; print(2+3)  # \u52a0\u6cd5\n5\n&gt;&gt;&gt; print(8-3)  # \u51cf\u6cd5\n5\n&gt;&gt;&gt; print(2*3)  # \u4e58\u6cd5\n6\n&gt;&gt;&gt; print(5/3)  # \u771f\u9664\n1.6666666666666667\n&gt;&gt;&gt; print(5//3)  # \u5411\u4e0b\u53d6\u6574\u9664\u6cd5\uff0c\u622a\u9664\u6389\u4f59\u6570\n1\n&gt;&gt;&gt; print(5**2)  # \u5e42\u8fd0\u7b97\n25\n&gt;&gt;&gt; print(5%2)  # \u53d6\u4f59\n1\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#3","title":"3. \u8fdb\u5236","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#31","title":"3.1 \u8fdb\u5236\u8868\u793a","text":"<pre><code>&gt;&gt;&gt; 0b11111111  # \u4e8c\u8fdb\u5236\n255\n&gt;&gt;&gt; 0o377       # \u516b\u8fdb\u5236\n255\n&gt;&gt;&gt; 0xFF        # \u5341\u516d\u8fdb\u5236\n255\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#32","title":"3.2 \u8fdb\u5236\u8f6c\u6362","text":"<pre><code>&gt;&gt;&gt; bin(255)    # \u5341\u8fdb\u5236\u8f6c\u4e8c\u8fdb\u5236\n'0b11111111'\n&gt;&gt;&gt; oct(255)    # \u5341\u8fdb\u5236\u8f6c\u516b\u8fdb\u5236\n'0o377'\n&gt;&gt;&gt; hex(255)    # \u5341\u8fdb\u5236\u8f6c\u5341\u516d\u8fdb\u5236\n'0xff'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#4","title":"4. \u5c0f\u6570","text":"<pre><code># \u5728Windows\u5e73\u53f0Python 3.6.8\u4e2d\u8ba1\u7b97\u7684\u7ed3\u679c\uff0c\u6d6e\u70b9\u6570\u7684\u7ed3\u679c\u5e76\u4e0d\u7cbe\u786e\n&gt;&gt;&gt; print(0.1+0.1+0.1-0,3)\n0.30000000000000004 3\n</code></pre> <p>\u5982\u679c\u8981\u7cbe\u786e\u8ba1\u7b97\u5c0f\u6570\uff0c\u9700\u8981\u4f7f\u7528\u5c0f\u6570\u5bf9\u8c61</p> <pre><code>&gt;&gt;&gt; from decimal import Decimal\n&gt;&gt;&gt; print(Decimal('0.1') + Decimal('0.1') + Decimal('0.1') - Decimal('0.3'))\n0.0\n# \u6ce8\u610f*:\u8981\u5728\u5c0f\u6570\u4e0a\u52a0\u5f15\u53f7\uff0c\u5426\u5219\u8f93\u51fa\u7684\u7ed3\u679c\u662f\u4e0b\u9762\u7684\u503c\n# &gt;&gt;&gt; print(Decimal(0.1) + Decimal(0.1) + Decimal(0.1) - Decimal(0.3))\n# 2.775557561565156540423631668E-17\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#5","title":"5. \u5206\u6570","text":"<pre><code>&gt;&gt;&gt; from fractions import Fraction\n&gt;&gt;&gt; x = Fraction(6,8)\n&gt;&gt;&gt; print(x)\n3/4\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#6","title":"6. \u6574\u6570\u6d6e\u70b9\u6570\u88c5\u6362","text":"<pre><code>&gt;&gt;&gt; int(3.14)\n3\n&gt;&gt;&gt; float(3)\n3.0\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#python","title":"\u4e8c\u3001Python\u5b57\u7b26\u4e32","text":"<p>\u5b57\u7b26\u4e32\u5c31\u662f\u4e00\u7cfb\u5217\u5b57\u7b26\uff0c\u5728Python\u4e2d\uff0c\u7528\u5f15\u53f7\u62ec\u8d77\u6765\u7684\u90fd\u662f\u5b57\u7b26\u4e32\uff0c\u5f15\u53f7\u53ef\u4ee5\u662f\u5355\u5f15\u53f7('string')\u4e5f\u53ef\u4ee5\u662f\u53cc\u5f15\u53f7(\"string\")</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#1_1","title":"1. \u5b57\u7b26\u4e32\u7684\u7279\u70b9","text":"<ol> <li>\u5b57\u7b26\u4e32\u662f\u5355\u4e2a\u5b57\u7b26\u7684\u5b57\u7b26\u4e32\u5e8f\u5217\uff0c\u662f\u6709\u5e8f\u7684</li> <li>\u4e0d\u53ef\u53d8\u6027\uff0c\u4e0d\u53ef\u4ee5\u5bf9\u539f\u59cb\u7684\u5b57\u7b26\u4e32\u8fdb\u884c\u6539\u53d8\u3002</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#2_1","title":"2. \u5b57\u7b26\u4e32\u64cd\u4f5c","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#21","title":"2.1 \u7d22\u5f15","text":"<p>\u5b57\u7b26\u4e32\u7684\u7b2c\u4e00\u4e2a\u5b57\u7b26\u4e0b\u6807\u4e3a0\u3002</p> <pre><code>string = \"Life is short, You need Python\"\n</code></pre> <ul> <li>\u6b63\u7d22\u5f15</li> </ul> <pre><code>In [1]: string = \"Life is short, You need Python\"\nIn [2]: string[2]\nOut[2]: 'f'\n</code></pre> <ul> <li>\u8d1f\u7d22\u5f15</li> </ul> <pre><code>In [1]: string = \"Life is short, You need Python\"\nIn [2]: string[-6]\nOut[2]: 'P'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#22","title":"2.2 \u5207\u7247","text":"<p>\u5207\u7247\u7684\u683c\u5f0f: <code>string[start,end]</code></p> <pre><code>In [1]: string = \"Life is short, You need Python\"\n# \u8303\u56f4\u662f[5,7)\u4e0d\u5305\u542b\u7d22\u5f15\u4e3a7\u7684\u5b57\u7b26\nIn [2]: string[5:7]\nOut[3]: 'is'\n</code></pre> <p>\u5f53\u7b2c\u4e00\u4e2a\u7d22\u5f15\u503c\u7f3a\u7701\u65f6\uff0c\u4ece0\u5f00\u59cb\u3002</p> <pre><code>In [1]: string = \"Life is short, You need Python\"\n\nIn [6]: string[:7]\nOut[6]: 'Life is'\n</code></pre> <p>\u5207\u7247\u52a0\u6b65\u957f</p> <pre><code>In [1]: s = '1234567890'\n\nIn [2]: s[2:8:2]\nOut[2]: '357'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#23","title":"2.3 \u62fc\u63a5","text":"<pre><code>&gt;&gt;&gt; s1 = 'hello '\n&gt;&gt;&gt; s2 = 'world'\n&gt;&gt;&gt; s1 + s2\n'hello world'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#24","title":"2.4 \u91cd\u590d","text":"<pre><code>&gt;&gt;&gt; print(\"hello\"*5)\nhellohellohellohellohello\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#25","title":"2.5 \u957f\u5ea6","text":"<pre><code>&gt;&gt;&gt; len('hello')\n5\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#3_1","title":"3. \u5b57\u7b26\u4e32\u65b9\u6cd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#31_1","title":"3.1 \u5b57\u7b26\u4e32\u5927\u5c0f\u5199\u8f6c\u6362","text":"<pre><code>&gt;&gt;&gt; # \u5b57\u7b26\u4e32\u9996\u5b57\u7b26\u5927\u5199\n... print(\"hello world\".capitalize())\nHello world\n&gt;&gt;&gt; # \u5927\u5c0f\u5199\u7ffb\u8f6c\n... print(\"hello WORLD\".swapcase())\nHELLO world\n&gt;&gt;&gt; # \u5c06\u5b57\u7b26\u4e32\u53d8\u4e3a\u6807\u9898\n... print(\"hello WORLD\".title())\nHello World\n&gt;&gt;&gt; # \u5c06\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5927\u5199\n... print(\"hello world\".upper())\nHELLO WORLD\n&gt;&gt;&gt; # \u628a\u5b57\u7b26\u4e32\u8f6c\u4e3a\u5c0f\u5199\n... print(\"HELLO WORLD\".lower())\nhello world\n&gt;&gt;&gt; # \u7ffb\u8f6c\u5b57\u7b26\u4e32\u4e2d\u7684\u5927\u5c0f\u5199\n... print(\"hello WORLD\".swapcase())\nHELLO world\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#32_1","title":"3.2 \u5b57\u7b26\u4e32\u5206\u5272","text":"<pre><code>&gt;&gt;&gt; # \u4ee5\u67d0\u4e2a\u5143\u7d20\u4e3a\u5206\u5272\u70b9\uff0c\u5c06\u5b57\u7b26\u4e32\u5206\u4e3a3\u90e8\u5206,\u4ece\u5de6\u5f80\u53f3\u627e\u5230\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e3a\u5206\u5272\u70b9\n... print('helloworld'.partition('o'))\n('hell', 'o', 'world')\n&gt;&gt;&gt; # \u4ee5\u67d0\u4e2a\u5143\u7d20\u4e3a\u5206\u5272\u70b9\uff0c\u5c06\u5b57\u7b26\u4e32\u5206\u4e3a3\u90e8\u5206\uff0c\u4ece\u53f3\u5f80\u5de6\u627e\u5230\u7684\u7b2c\u4e00\u4e2a\u5143\u7d20\u4e3a\u5206\u5272\u70b9\n... print('helloworld'.rpartition('o'))\n('hellow', 'o', 'rld')\n&gt;&gt;&gt; # \u66ff\u6362\u539f\u5b57\u7b26\u4e32\u4e2d\u7684\u5143\u7d20,\u9ed8\u8ba4\u5168\u90e8\u66ff\u6362\uff0c\u53ef\u4ee5\u6307\u5b9a\u66ff\u6362\u51e0\u4e2a\uff08\u4ece\u5de6\u5f80\u53f3\u6570\uff09\n... print(\"hello world\".replace('o', 'a', 1))\nhella world\n&gt;&gt;&gt; # \u4ee5\u67d0\u4e2a\u5143\u7d20\u4e3a\u5206\u5272\u70b9\uff0c\u5c06\u5b57\u7b26\u4e32\u5206\u5272,\u4ece\u5de6\u5f80\u53f3\u5206\u5272n\u6b21\n... print(\"hello world\".split('o', 1))\n['hell', ' world']\n&gt;&gt;&gt; # \u4ee5\u67d0\u4e2a\u5143\u7d20\u4e3a\u5206\u5272\u70b9\uff0c\u5c06\u5b57\u7b26\u4e32\u5206\u5272,\u4ece\u53f3\u5f80\u5de6\u5206\u5272n\u6b21\n... print(\"hello world\".rsplit('o', 1))\n['hello w', 'rld']\n&gt;&gt;&gt; # \u6309\u7167\u884c('\\r', '\\r\\n', \\n')\u5206\u9694\uff0c\u8fd4\u56de\u4e00\u4e2a\u5305\u542b\u5404\u884c\u4f5c\u4e3a\u5143\u7d20\u7684\u5217\u8868\uff0c\u5982\u679c\u53c2\u6570 keepends \u4e3a False\uff0c\u4e0d\u5305\u542b\u6362\u884c\u7b26\uff0c\u5982\u679c\u4e3a True\uff0c\u5219\u4fdd\u7559\u6362\u884c\u7b26\u3002\n... print('hello\\nworld'.splitlines(True))\n['hello\\n', 'world']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#33","title":"3.3 \u5b57\u7b26\u4e32\u67e5\u627e","text":"<pre><code>&gt;&gt;&gt; # \u7edf\u8ba1\u67d0\u4e2a\u5b57\u7b26\u4e32\u4ece\u7d22\u5f15n\u5230y\u51fa\u73b0\u7684\u6b21\u6570\uff0c\u7f3a\u7701\u4e3a\u5728\u6574\u4e2a\u5b57\u7b26\u4e32\u4e2d\u67e5\u627e\n... print(\"hello world\".count('o', 7, 10))\n&gt;&gt;&gt; # \u5728\u7d22\u5f15[n , y)\u4e4b\u95f4\u67e5\u627e\u5143\u7d20\uff0c\u7f3a\u7701\u4e3a[:]\u8fd4\u56de\u5143\u7d20\u7684\u7d22\u5f15\uff0c\u5982\u679c\u6ca1\u627e\u5230\u8fd4\u56de-1\n... print(\"hello world\".find('e'))\n&gt;&gt;&gt; print(\"hello world\".find('o', 0, 2))\n-1\n&gt;&gt;&gt; # \u5728[n, y)\u4e4b\u95f4\u627e\u5143\u7d20\u7684\u7d22\u5f15\u503c\uff0c\u6ca1\u627e\u5230\u4f1a\u62a5\u9519\n... print(\"hello world\".index('o'))\n&gt;&gt;&gt; print(\"hello world\".index('e', 0, 5))\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#34","title":"3.4 \u5b57\u7b26\u4e32\u5224\u65ad","text":"<pre><code>&gt;&gt;&gt; # \u5224\u65ad\u5b57\u7b26\u4e32\u662f\u5426\u4ee5\u67d0\u4e2a\u5143\u7d20\u5f00\u59cb\n... print('helloworld'.startswith('h'))\nTrue\n&gt;&gt;&gt; # \u5224\u65ad\u5b57\u7b26\u4e32\u7684\u7684\u4ece[n\uff0cy)\u7684\u7d22\u5f15\u4e4b\u95f4\u662f\u5426\u4ee5\u67d0\u4e2a\u5b57\u7b26\u7ed3\u5c3e,\u8fd4\u56de\u503c\u4e3a\u5e03\u5c14\u503c\n... print(\"hello world\".endswith('e', 0, 2))\nTrue\n&gt;&gt;&gt; # \u5224\u65ad\u662f\u5426\u662f\u53ea\u6709\u6570\u5b57\u6216\u5b57\u6bcd\n... print('abc123'.isalnum())\nTrue\n&gt;&gt;&gt; # \u5224\u65ad\u662f\u5426\u53ea\u542b\u6709\u5b57\u6bcd\n... print('abc'.isalpha())\nTrue\n&gt;&gt;&gt; # \u5224\u65ad\u5b57\u6bcd\u662f\u5426\u90fd\u662f\u5c0f\u5199\n... print(\"Hello\".islower())\nFalse\n&gt;&gt;&gt; # \u5224\u65ad\u5b57\u7b26\u662f\u4e0d\u662f\u7a7a\u683c\n... print(\" \".isspace())\nTrue\n&gt;&gt;&gt; # \u5224\u65ad\u662f\u4e0d\u662f\u5b57\u7b26\u4e32\u662f\u4e0d\u662f\u6807\u9898(\u5355\u8bcd\u9996\u5b57\u6bcd\u662f\u4e0d\u662f\u5927\u5199)\n... print(\"Hello World\".istitle())\nTrue\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#35","title":"3.5 \u5b57\u7b26\u4e32\u683c\u5f0f\u5316","text":"<pre><code>&gt;&gt;&gt; # \u5b57\u7b26\u4e32\u5c45\u4e2d\uff0c\u89c4\u5b9a\u5b57\u7b26\u4e32\u7684\u603b\u957f\u5ea6\uff0c\u4e0d\u591f\u7528\u5176\u4ed6\u5b57\u7b26\u8865\u9f50\uff0c\u9ed8\u8ba4\u662f\u7a7a\u683c\n... print(\"hello world\".center(20, \"#\"))\n####hello world#####\n&gt;&gt;&gt; # \u628a\u5b57\u7b26\u4e32\u4e2d\u7684\\t\u66ff\u6362\u4e3an\u4e2a\u7a7a\u683c\n... print(\"hello\\tworld\".expandtabs(tabsize=20))\nhello               world\n&gt;&gt;&gt; print('#'.join(\"hello world\"))\nh#e#l#l#o# #w#o#r#l#d\n&gt;&gt;&gt; # \u89c4\u5b9a\u8f93\u51fa\u5b57\u7b26\u7684\u957f\u5ea6\uff0c\u5e76\u4e14\u5de6\u5bf9\u9f50,\u4e0d\u8db3\u90e8\u5206\u7528\u6307\u5b9a\u5b57\u7b26\u8865\u9f50\n... print(\"hello world\".ljust(20, \"#\"))\nhello world#########\n&gt;&gt;&gt; # \u89c4\u5b9a\u8f93\u51fa\u5b57\u7b26\u7684\u957f\u5ea6\uff0c\u5e76\u4e14\u53f3\u5bf9\u9f50,\u4e0d\u8db3\u90e8\u5206\u7528\u6307\u5b9a\u5b57\u7b26\u8865\u9f50\n... print(\"hello world\".rjust(20, \"#\"))\n#########hello world\n&gt;&gt;&gt; # \u53bb\u9664\u5b57\u7b26\u4e32\u5de6\u8fb9\u7684\u7684\u7a7a\u683c\n... print(' hello'.lstrip())\nhello\n&gt;&gt;&gt; # \u53bb\u9664\u5b57\u7b26\u4e32\u53f3\u8fb9\u7684\u7684\u7a7a\u683c\n... print('hello '.rstrip())\nhello\n&gt;&gt;&gt; # \u53bb\u9664\u5b57\u7b26\u4e32\u4e24\u8fb9\u7684\u7684\u7a7a\u683c\n... print(' hello '.strip())\nhello\n&gt;&gt;&gt; # \u6307\u5b9a\u5b57\u7b26\u4e32\u7684\u957f\u5ea6\uff0c\u4e0d\u591f\u5728\u524d\u9762\u88650\n... print(\"123\".zfill(5))\n&gt;&gt;&gt; # \u5b57\u7b26\u4e32\u7684\u62fc\u63a5\n... print('hello ' + 'world')\nhello world\n&gt;&gt;&gt; # \u5b57\u7b26\u4e32\u91cd\u590d\n... print('hello ' * 3)\nhello hello hello\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#36","title":"3.6 \u5b57\u7b26\u4e32\u7684\u8d4b\u503c","text":"<pre><code>&gt;&gt;&gt; s = 'hello world'   # \u5355\u5f15\u53f7\n&gt;&gt;&gt; print(s)\nhello world\n&gt;&gt;&gt; s = \"hello world\"   # \u53cc\u5f15\u53f7\n&gt;&gt;&gt; print(s)\nhello world\n&gt;&gt;&gt; s = \"\"\"hello    # \u4e09\u5f15\u53f7\n... world\n... !!!\"\"\"\n&gt;&gt;&gt; print(s)\nhello\nworld\n!!!\n&gt;&gt;&gt; s = 'hello\\tworld' # \u8f6c\u4e49\u5e8f\u5217\n&gt;&gt;&gt; print(s)\nhello   world\n&gt;&gt;&gt; s = r'hello\\tworld'  # \u539f\u59cb\u5b57\u7b26\u4e32\uff0c\u4e0d\u8fdb\u884c\u8f6c\u4e49\n&gt;&gt;&gt; print(s)\nhello\\tworld\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#37","title":"3.7 \u5b57\u7b26\u4e32\u8f6c\u6362","text":"<pre><code>&gt;&gt;&gt; x = 123\n&gt;&gt;&gt; x = str(x) # \u628a\u4e00\u4e32\u5b57\u7b26\u8f6c\u4e3a\u5b57\u7b26\u4e32\n&gt;&gt;&gt; print(x)\n123\n&gt;&gt;&gt; print(type(x))\n&lt;class 'str'&gt;\n&gt;&gt;&gt; print(chr(65))  # ASCII\u503c\u8f6c\u5b57\u7b26\nA\n&gt;&gt;&gt; print(ord('B')) # \u5b57\u7b26\u8f6cASCII\u503c\n66\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#4_1","title":"4. \u5b57\u7b26\u4e32\u683c\u5f0f\u5316","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#41","title":"4.1 \u683c\u5f0f\u5316\u8868\u8fbe\u5f0f","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#411-cprintf","title":"4.1.1 \u57fa\u4e8eC\u8bed\u8a00\u7684<code>printf</code>\u6a21\u578b","text":"<pre><code>&gt;&gt;&gt; name = \"Kobe\"\n&gt;&gt;&gt; print('%s is %d years old.' % (name, 41))\nKobe is 41 years old.\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#412","title":"4.1.2 \u57fa\u4e8e\u5b57\u5178\u7684\u683c\u5f0f\u5316\u8868\u8fbe\u5f0f","text":"<pre><code>&gt;&gt;&gt; print('%(name)s is %(age)d years old.' % {'name':'Kobe', 'age':41})\nKobe is 41 years old.\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#42","title":"4.2 \u683c\u5f0f\u5316\u65b9\u6cd5\u8c03\u7528","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#421","title":"4.2.1 \u901a\u8fc7\u76f8\u5bf9\u4f4d\u7f6e\u66ff\u6362\u76ee\u6807","text":"<pre><code>&gt;&gt;&gt; print('{} is {} years old.'.format('Kobe',41))\nKobe is 41 years old.\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#422","title":"4.2.2 \u901a\u8fc7\u4f4d\u7f6e\u66ff\u6362\u76ee\u6807","text":"<pre><code>&gt;&gt;&gt; print('{0} is {1} years old.'.format('Kobe',41))\nKobe is 41 years old.\n&gt;&gt;&gt; print('{1} is {0} years old.'.format(41, 'Kobe'))\nKobe is 41 years old.\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#423","title":"4.2.3 \u901a\u8fc7\u5173\u952e\u5b57\u66ff\u6362\u76ee\u6807","text":"<pre><code>&gt;&gt;&gt; print('{name} is {age} years old.'.format(name='Kobe',age=41))\nKobe is 41 years old.\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_3","title":"\u4e09\u3001\u5217\u8868","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#1_2","title":"1. \u5217\u8868\u7684\u7279\u70b9","text":"<ol> <li>\u4efb\u610f\u7c7b\u578b\u7684\u5bf9\u8c61\u7684\u4f4d\u7f6e\u76f8\u5173\u7684\u6709\u5e8f\u96c6\u5408</li> <li>\u5927\u5c0f\u53ef\u53d8\uff0c\u53ef\u4ee5\u4fee\u6539</li> <li>\u652f\u6301\u4efb\u610f\u5d4c\u5957</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#2_2","title":"2. \u5217\u8868\u64cd\u4f5c","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#21_1","title":"2.1 \u8ba1\u7b97\u5217\u8868\u957f\u5ea6","text":"<pre><code>&gt;&gt;&gt; l = ['Tom','Bob',123,['boy','girl']]\n&gt;&gt;&gt; len(l)\n4\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#22_1","title":"2.2 \u5217\u8868\u62fc\u63a5","text":"<pre><code>&gt;&gt;&gt; [1,2,3] + [4,5,6]\n[1, 2, 3, 4, 5, 6]\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#23_1","title":"2.3 \u5217\u8868\u91cd\u590d","text":"<pre><code>&gt;&gt;&gt; ['hello'] * 3\n['hello', 'hello', 'hello']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#3_2","title":"3. \u5217\u8868\u7d22\u5f15","text":"<pre><code>&gt;&gt;&gt; l[-1] # \u8d1f\u7d22\u5f15\n['boy', 'girl']\n&gt;&gt;&gt; l[2]  # \u6b63\u7d22\u5f15\n123\n&gt;&gt;&gt; l[3][1] # \u4e24\u6b21\u7d22\u5f15\n'girl'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#4_2","title":"4. \u5217\u8868\u5207\u7247","text":"<pre><code>&gt;&gt;&gt; l[:]\n['Tom', 'Bob', 123, ['boy', 'girl']]\n&gt;&gt;&gt; l[1:3]\n['Bob', 123]\n&gt;&gt;&gt; l[-2:-1]\n[123]\n&gt;&gt;&gt; l[-2:]\n[123, ['boy', 'girl']]\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#5_1","title":"5. \u5217\u8868\u65b9\u6cd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#51","title":"5.1 \u6dfb\u52a0","text":"<pre><code># \u5728\u5c3e\u90e8\u63d2\u5165\u4e00\u9879\n&gt;&gt;&gt; l = ['\u5218\u5907','\u5173\u7fbd','\u5f20\u98de']\n&gt;&gt;&gt; l.append('\u8bf8\u845b\u4eae')\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de', '\u8bf8\u845b\u4eae']\n# \u628a\u4e00\u4e2a\u5217\u8868\u6dfb\u52a0\u5230\u53e6\u4e00\u4e2a\u5217\u8868\u672b\u5c3e\n&gt;&gt;&gt; L1 = ['\u5218\u5907','\u5173\u7fbd','\u5f20\u98de']\n&gt;&gt;&gt; L2 = ['\u59dc\u7ef4','\u8bf8\u845b\u4eae']\n&gt;&gt;&gt; L1.extend(L2)\n&gt;&gt;&gt; L1\n['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de', '\u59dc\u7ef4', '\u8bf8\u845b\u4eae']\n# \u5728\u6307\u5b9a\u7d22\u5f15\u4f4d\u7f6e\u63d2\u5165\u5143\u7d20\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de']\n&gt;&gt;&gt; l.insert(1,'\u9a6c\u8d85')\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u9a6c\u8d85', '\u5173\u7fbd', '\u5f20\u98de']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#52","title":"5.2 \u5220\u9664","text":"<pre><code># \u5220\u9664\u6240\u6709\u5143\u7d20\n&gt;&gt;&gt; l.clear()\n&gt;&gt;&gt; l\n[]\n# \u6839\u636e\u7d22\u5f15\u5220\u9664\u5143\u7d20\u5e76\u6253\u5370\u5220\u9664\u7684\u5143\u7d20\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u9a6c\u8d85', '\u5173\u7fbd', '\u5f20\u98de']\n&gt;&gt;&gt; l.pop()    # \u65e0\u53c2\u6570\u5220\u9664\u6700\u540e\u4e00\u4e2a\n'\u5f20\u98de'\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u9a6c\u8d85', '\u5173\u7fbd']\n&gt;&gt;&gt; l.pop(1)  # \u6307\u5b9a\u7d22\u5f15\u5220\u9664\n'\u9a6c\u8d85'\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u5173\u7fbd']\n# \u5220\u9664\u6307\u5b9a\u5143\u7d20\n&gt;&gt;&gt; l = ['\u5218\u5907','\u5173\u7fbd','\u5f20\u98de']\n&gt;&gt;&gt; l.remove(\"\u5173\u7fbd\")\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u5f20\u98de']\n# \u4f7f\u7528del\u8bed\u53e5\u5220\u9664\u6307\u5b9a\u5143\u7d20\n&gt;&gt;&gt; l = ['\u5218\u5907','\u5173\u7fbd','\u5f20\u98de']\n&gt;&gt;&gt; del l[1]\n&gt;&gt;&gt; l\n['\u5218\u5907', '\u5f20\u98de']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#53","title":"5.3.\u62f7\u8d1d","text":"<pre><code>&gt;&gt;&gt; l1 = l.copy()\n&gt;&gt;&gt; l1\n['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#54","title":"5.4 \u67e5\u627e","text":"<pre><code># \u7edf\u8ba1\u67d0\u4e2a\u5143\u7d20\u51fa\u73b0\u7684\u6b21\u6570\n&gt;&gt;&gt; l.count('\u5173\u7fbd')\n# \u67e5\u627e[a,b)\u4e4b\u95f4\u67d0\u5143\u7d20\u7684\u7d22\u5f15\u503c\n&gt;&gt;&gt; L1\n['\u5218\u5907', '\u5173\u7fbd', '\u5f20\u98de', '\u59dc\u7ef4', '\u8bf8\u845b\u4eae']\n&gt;&gt;&gt; L1.index('\u5173\u7fbd')\n&gt;&gt;&gt; L1.index('\u5173\u7fbd',2,4)\nTraceback (most recent call last):\nFile \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nValueError: '\u5173\u7fbd' is not in list\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#54_1","title":"5.4 \u6392\u5e8f","text":"<pre><code># \u5012\u5e8f\n&gt;&gt;&gt; l = ['b','B','a','h']\n&gt;&gt;&gt; l.reverse()\n&gt;&gt;&gt; l\n['h', 'a', 'B', 'b']\n# \u5347\u5e8f\n&gt;&gt;&gt; l.sort()\n&gt;&gt;&gt; l\n['B', 'a', 'b', 'h']\n# \u964d\u5e8f\n&gt;&gt;&gt; l.sort(reverse=True)\n&gt;&gt;&gt; l\n['h', 'b', 'a', 'B']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_4","title":"\u56db\u3001\u5143\u7ec4","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#1_3","title":"1. \u5143\u7ec4\u7684\u7279\u70b9","text":"<ol> <li>\u4e0d\u53ef\u53d8\u6027</li> <li>\u652f\u6301\u5d4c\u5957</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#2_3","title":"2. \u5143\u7ec4\u64cd\u4f5c","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#21_2","title":"2.1 \u8ba1\u7b97\u5143\u7ec4\u957f\u5ea6","text":"<pre><code>&gt;&gt;&gt; t = (1,2)\n&gt;&gt;&gt; len(t)\n2\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#22_2","title":"2.2 \u5217\u8868\u62fc\u63a5","text":"<pre><code>&gt;&gt;&gt; (1,2)+(3,4)\n(1, 2, 3, 4)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#23_2","title":"2.3 \u5217\u8868\u91cd\u590d","text":"<pre><code>&gt;&gt;&gt; (1,2)*3\n(1, 2, 1, 2, 1, 2)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#3_3","title":"3. \u5143\u7ec4\u7684\u65b9\u6cd5","text":"<pre><code>&gt;&gt;&gt; t.count(1)\n1\n&gt;&gt;&gt; t.index(1)\n0\n</code></pre> <p>\u5143\u7ec4\u7684\u7279\u6b8a\u8bed\u6cd5</p> <p>\u5b9a\u4e49\u53ea\u6709\u4e00\u4e2a\u5143\u7d20\u7684\u5143\u7ec4</p> <pre><code>x = (40,)\n</code></pre> <p>\u521b\u5efa\u5143\u7d20\u5143\u7d20\u7684\u5706\u62ec\u53f7\u53ef\u4ee5\u7701\u7565</p> <pre><code>&gt;&gt;&gt; T = 'name', 'age'\n&gt;&gt;&gt; T\n('name', 'age')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_5","title":"\u4e94\u3001\u5b57\u5178","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#1_4","title":"1. \u5b57\u5178\u7684\u7279\u70b9","text":"<ol> <li>\u901a\u8fc7\u952e\u6765\u5b58\u50a8\u5bf9\u8c61</li> <li>\u65e0\u5e8f\u7684\u96c6\u5408</li> <li>\u53ef\u53d8\u6027</li> <li>\u901a\u8fc7\u6563\u5217\u8868\u5b9e\u73b0</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#2_4","title":"2. \u5b57\u5178\u7684\u521b\u5efa","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#21_3","title":"2.1 \u65b9\u6cd5\u4e00\uff1a\u5148\u521b\u5efa\u518d\u8d4b\u503c","text":"<pre><code>&gt;&gt;&gt; person = {}\n&gt;&gt;&gt; person['name'] = 'Bob'\n&gt;&gt;&gt; person['job'] = 'dev'\n&gt;&gt;&gt; person\n{'name': 'Bob', 'job': 'dev'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#22_3","title":"2.2 \u65b9\u6cd5\u4e8c\uff1a\u521b\u5efa\u65f6\u540c\u65f6\u8d4b\u503c","text":"<pre><code>&gt;&gt;&gt; d = {'name':'Tom','job':'IT'}\n&gt;&gt;&gt; d\n{'job': 'IT', 'name': 'Tom'}\n&gt;&gt;&gt; d['age'] = 18\n&gt;&gt;&gt; d['sex'] = 'boy'\n&gt;&gt;&gt; d\n{'job': 'IT', 'sex': 'boy', 'name': 'Tom', 'age': 18}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#23-dict","title":"2.3 \u65b9\u6cd5\u4e09\uff1a\u901a\u8fc7<code>dict</code>\u51fd\u6570\u521b\u5efa","text":"<pre><code># \u4f20\u9012\u952e\u503c\n&gt;&gt;&gt; D = dict(name='Bob', job='dev')\n&gt;&gt;&gt; D\n{'name': 'Bob', 'job': 'dev'}\n# \u4f7f\u7528zip\n&gt;&gt;&gt; D = dict(zip([\"name\", \"job\"], [\"Bob\", \"dev\"]))\n&gt;&gt;&gt; D\n{'name': 'Bob', 'job': 'dev'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#3_4","title":"3. \u5b57\u5178\u7d22\u5f15","text":"<pre><code>&gt;&gt;&gt; d = {'name':'Tom','job':'IT'}\n&gt;&gt;&gt; d\n{'name': 'Tom', 'job': 'IT'}\n&gt;&gt;&gt; d['name']\n'Tom'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#4_3","title":"4. \u952e\u7684\u6392\u5e8f","text":"<pre><code>&gt;&gt;&gt; d.keys()\ndict_keys(['name', 'job'])\n&gt;&gt;&gt; list(d.keys())\n['name', 'job']\n&gt;&gt;&gt; Ks = list(d.keys())\n&gt;&gt;&gt; Ks.sort()\n&gt;&gt;&gt; for k in Ks:\n... print(k,'--&gt;',d[k])\n...\njob --&gt; IT\nname --&gt; Tom\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#5_2","title":"5. \u5224\u65ad\u4e00\u4e2a\u952e\u662f\u5426\u5b58\u5728","text":"<pre><code>&gt;&gt;&gt; d\n{'name': 'Tom', 'job': 'IT'}\n# \u5224\u65ad\u4e00\u4e2a\u952e\u662f\u5426\u5b58\u5728\n&gt;&gt;&gt; 'name' in d\nTrue\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#6_1","title":"6. \u5b57\u5178\u7684\u65b9\u6cd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#61","title":"6.1 \u5220\u9664","text":"<pre><code># \u6e05\u7a7a\u5b57\u5178 clear\n&gt;&gt;&gt; d = {'name': 'Tom', 'job': 'IT'}\n&gt;&gt;&gt; d.clear()\n&gt;&gt;&gt; d\n{}\n# \u5220\u9664\u6307\u5b9a\u952e pop\n&gt;&gt;&gt; d.pop('sex','not find')\n'not find'\n&gt;&gt;&gt; d.pop('name')\n'Tom'\n# \u968f\u673a\u5220\u9664\u952e\u503c\u5bf9\uff0c\u5b57\u5178\u4e3a\u7a7a\u65f6\u62a5\u9519\n&gt;&gt;&gt; d.popitem()\n('job', 'IT')\n&gt;&gt;&gt; d.popitem()\n('name', 'Tom')\n&gt;&gt;&gt;\n&gt;&gt;&gt; d.popitem()\nTraceback (most recent call last):\nFile \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nKeyError: 'popitem(): dictionary is empty'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#62","title":"6.2 \u62f7\u8d1d","text":"<pre><code>&gt;&gt;&gt; d = {'name': 'Tom', 'job': 'IT'}\n&gt;&gt;&gt; D = d.copy()\n&gt;&gt;&gt; D\n{'name': 'Tom', 'job': 'IT'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#63","title":"6.3 \u521b\u5efa","text":"<pre><code>&gt;&gt;&gt; l = ['name', 'age']\n&gt;&gt;&gt; d = {}\n&gt;&gt;&gt; d.fromkeys(l,'abc')\n{'age': 'abc', 'name': 'abc'}\n# \u5982\u679c\u952e\u4e0d\u5b58\u5728\u6dfb\u52a0\u4e00\u4e2a\uff0c\u5982\u679c\u5b58\u5728\u4e0d\u505a\u66f4\u6539\n&gt;&gt;&gt; d.setdefault('sex','boy') \n'boy'\n&gt;&gt;&gt; d\n{'job': 'IT', 'sex': 'boy', 'name': 'Tom'}\n&gt;&gt;&gt; d.setdefault('sex','girl')\n'boy'\n&gt;&gt;&gt; d\n{'job': 'IT', 'sex': 'boy', 'name': 'Tom'}\n# \u5408\u5e76\u5b57\u5178\uff0c\u628a\u4e00\u4e2a\u5b57\u5178\u52a0\u5230\u53e6\u4e00\u4e2a\u5b57\u5178\n&gt;&gt;&gt; d1 = {'name': 'Tom', 'job': 'IT'}\n&gt;&gt;&gt; d2 = {'sex':'boy'}\n&gt;&gt;&gt; d1.update(d2)\n&gt;&gt;&gt; d1\n{'job': 'IT', 'sex': 'boy', 'name': 'Tom'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#64","title":"6.4 \u67e5\u627e","text":"<pre><code># \u6839\u636e\u952e\u67e5\u627e\u503c\n&gt;&gt;&gt; d = {'name': 'Tom', 'job': 'IT'}\n&gt;&gt;&gt; d.get('name')\n'Tom'\n&gt;&gt;&gt; d.get('sex','not find')\n'not find'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#65","title":"6.5 \u904d\u5386\u5b57\u5178","text":"<pre><code>&gt;&gt;&gt; d.items()\ndict_items([('job', 'IT'), ('name', 'Tom')])\n&gt;&gt;&gt; for k,v in d.items():\n... print(k,v)\n...\njob IT\nname Tom\n&gt;&gt;&gt; for k in d.items():\n... print(k)\n...\n('job', 'IT')\n('name', 'Tom')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#_6","title":"\u516d\u3001\u96c6\u5408","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#1_5","title":"1. \u96c6\u5408\u7684\u7279\u70b9","text":"<ol> <li>\u65e0\u5e8f</li> <li>\u552f\u4e00</li> <li>\u4e0d\u53ef\u53d8 \u96c6\u5408\u4e2d\u7684\u5143\u7d20\u4e0d\u53ef\u53d8</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#2_5","title":"2. \u96c6\u5408\u7684\u4f5c\u7528","text":"<ol> <li>\u5217\u8868\u53bb\u91cd</li> <li>\u5173\u7cfb\u6d4b\u8bd5\uff1a\u4ea4\u96c6\u3001\u5e76\u96c6\u3001\u5dee\u96c6</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#3_5","title":"3. \u96c6\u5408\u521b\u5efa","text":"<pre><code>set1 = set({1,3,5}) # \u7b2c\u4e00\u79cd\u65b9\u6cd5\nset2 = {1,3,5}  # \u7b2c\u4e8c\u79cd\u65b9\u6cd5\nset3 = set() # \u7a7a\u96c6\u5408\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#4_4","title":"4. \u96c6\u5408\u64cd\u4f5c","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#41_1","title":"4.1 \u589e","text":"<pre><code>&gt;&gt;&gt; set1 = set({1,3,5})\n&gt;&gt;&gt; set1.add(7)\n&gt;&gt;&gt; set1\n{1, 3, 5, 7}\n# \u8fed\u4ee3\u589e\u52a0\n&gt;&gt;&gt; set1.update('abc')\n&gt;&gt;&gt; set1\n{1, 3, 5, 7, 'a', 'b', 'c'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#41_2","title":"4.1 \u5220\u9664","text":"<pre><code># \u6309\u7167\u5143\u7d20\u5220\u9664\n&gt;&gt;&gt; set1.remove('c')\n&gt;&gt;&gt; set1\n{1, 3, 5, 7, 'a', 'b'}\n# \u968f\u673a\u5220\u9664\n&gt;&gt;&gt; set1.pop()\n1\n# \u60c5\u51b5\u5217\u8868\n&gt;&gt;&gt; set1.clear()\n&gt;&gt;&gt; set1\nset()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#5_3","title":"5. \u5173\u7cfb\u6d4b\u8bd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#51_1","title":"5.1 \u4ea4\u96c6","text":"<pre><code>&gt;&gt;&gt; set1 = {1,3,5,7,8}\n&gt;&gt;&gt; set2 = {2,3,6,7,8}\n&gt;&gt;&gt; set1 &amp; set2\n{8, 3, 7}\n&gt;&gt;&gt; set1.intersection(set2)\n{8, 3, 7}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#52_1","title":"5.2 \u5e76\u96c6","text":"<pre><code>&gt;&gt;&gt; set1 = {1,3,5,7,8}\n&gt;&gt;&gt; set2 = {2,3,6,7,8}\n&gt;&gt;&gt; set1 | set2\n{1, 2, 3, 5, 6, 7, 8}\n&gt;&gt;&gt; set1.union(set2)\n{1, 2, 3, 5, 6, 7, 8}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#53_1","title":"5.3 \u5dee\u96c6","text":"<pre><code>&gt;&gt;&gt; set1 = {1,3,5,7,8}\n&gt;&gt;&gt; set2 = {2,3,6,7,8}\n&gt;&gt;&gt; set1 - set2\n{1, 5}\n&gt;&gt;&gt; set1.difference(set2)\n{1, 5}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#54_2","title":"5.4 \u53cd\u4ea4\u96c6","text":"<pre><code>&gt;&gt;&gt; set1 ^ set2\n{1, 2, 5, 6}\n&gt;&gt;&gt; set1.symmetric_difference(set2)\n{1, 2, 5, 6}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/#55","title":"5.5 \u5b50\u96c6\u4e0e\u8d85\u96c6","text":"<pre><code>&gt;&gt;&gt; set1 = {1,2}\n&gt;&gt;&gt; set2 = {1,2,3}\n&gt;&gt;&gt; set1 &lt; set2\nTrue\n&gt;&gt;&gt; set1 &gt; set2\nFalse\n&gt;&gt;&gt; set1.issubset(set2)\nTrue\n&gt;&gt;&gt; set1.issuperset(set2)\nFalse\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/","title":"\u8fdb\u7a0b\u3001\u7ebf\u7a0b\u4e0e\u534f\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_2","title":"\u4e00\u3001\u57fa\u672c\u6982\u5ff5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#1","title":"1.\u8fdb\u7a0b\u548c\u7ebf\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#11","title":"1.1 \u8fdb\u7a0b","text":"<ol> <li> <p>\u8fdb\u7a0b\uff1a\u8fd0\u884c\u4e2d\u7684\u7a0b\u5e8f\u3002\u6bcf\u4e2a\u8fdb\u884c\u62e5\u6709\u81ea\u5df1\u7684\u5730\u5740\u7a7a\u95f4\u3001\u5185\u5b58\u3001\u6570\u636e\u6808\u7b49\u3002\u591a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u6570\u636e\u4e0d\u5171\u4eab\u3002\u8fdb\u7a0b\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6d3e\u751f\uff08fork \u6216 spawn\uff09\u65b0\u7684\u8fdb\u7a0b\u6765\u6267\u884c\u5176\u4ed6\u4efb\u52a1\uff0c\u8fdb\u7a0b\u95f4\u91c7\u7528\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff0cInter Process communication\uff09\u7684\u65b9\u5f0f\u5171\u4eab\u4fe1\u606f\u3002</p> </li> <li> <p>\u50f5\u5c38\u8fdb\u7a0b</p> </li> <li> <p>\u5b64\u513f\u8fdb\u7a0b</p> </li> <li>\u5b88\u62a4\u8fdb\u7a0b</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#12","title":"1.2 \u7ebf\u7a0b","text":"<p>\u5728\u4e00\u4e2a\u4e3b\u8fdb\u7a0b\u6216\u201c\u4e3b\u7ebf\u7a0b\u201d\u4e2d\u5e76\u884c\u8fd0\u884c\u7684\u4e00\u4e9b\u201c\u8ff7\u4f60\u8fdb\u7a0b\u201d\u3002\u80fd\u88ab\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u7684\u6700\u5c0f\u5355\u4f4d\u3002\u7ebf\u7a0b\u4e4b\u95f4\u6570\u636e\u5171\u4eab\uff0c</p> <ul> <li> <p>\u5168\u5c40\u89e3\u91ca\u5668\u9501\uff1a\u5bf9 Python \u865a\u62df\u673a\u7684\u8bbf\u95ee\u662f\u7531\u5168\u5c40\u89e3\u91ca\u5668\u9501\uff08GIL\uff0cglobal interpreter lock\uff09\u63a7\u5236\u7684\u3002\u8fd9\u4e2a\u9501\u5c31\u662f\u7528\u6765\u4fdd\u8bc1\u540c\u65f6\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u8fd0\u884c\u7684\u3002\u4f5c\u7528\u662f\u4e3a\u4e86\u5b8c\u6210gc\u7684\u56de\u6536\u673a\u5236\uff0c\u5bf9\u4e0d\u540c\u7ebf\u7a0b\u7684\u5f15\u7528\u8ba1\u6570\u7684\u53d8\u5316\u8bb0\u5f55\u66f4\u52a0\u7cbe\u51c6\u3002\u5bfc\u81f4\u4e86\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u591a\u4e2a\u8fdb\u7a0b\u53ea\u80fd\u6709\u4e00\u4e2a\u7ebf\u7a0b\u771f\u6b63\u88abCPU\u6267\u884c\u3002</p> </li> <li> <p>\u5b88\u62a4\u7ebf\u7a0b\uff1a</p> </li> <li> <p>\u6c60\uff1a\u5728\u7a0b\u5e8f\u5f00\u59cb\u4e4b\u524d\u5148\u521b\u5efa\u51e0\u4e2a\u7ebf\u7a0b\u6216\u8fdb\u7a0b\u653e\u5728\u4e00\u4e2a\u6c60\u4e2d\uff0c\u5f00\u597d\u7684\u8fdb\u7a0b\u548c\u7ebf\u7a0b\u4f1a\u4e00\u76f4\u5b58\u5728\u5728\u6c60\u4e2d\uff0c\u53ef\u4ee5\u88ab\u591a\u4e2a\u4efb\u52a1\u53cd\u590d\u5229\u7528\uff0c\u53ef\u4ee5\u51cf\u5c11\u8c03\u5ea6\u5f00\u9500\uff0c\u51cf\u8f7b\u64cd\u4f5c\u7cfb\u7edf\u7684\u8d1f\u62c5\u3002</p> </li> </ul>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#2","title":"2. \u540c\u6b65\u548c\u5f02\u6b65","text":"<p>\u63cf\u8ff0\u7684\u4efb\u52a1\u7684\u63d0\u4ea4\u65b9\u6cd5</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#21","title":"2.1 \u540c\u6b65","text":"<p>\u4efb\u52a1\u63d0\u4ea4\u4ee5\u540e\uff0c\u539f\u5730\u7b49\u5f85\u4efb\u52a1\u7684\u8fd4\u56de\u7ed3\u679c</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#22","title":"2.2 \u5f02\u6b65","text":"<p>\u4efb\u52a1\u63d0\u4ea4\u4ee5\u540e\uff0c\u4e0d\u539f\u5730\u7b49\u5f85\u4efb\u52a1\u7684\u8fd4\u56de\u7ed3\u679c</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#3","title":"3. \u963b\u585e\u548c\u975e\u963b\u585e","text":"<p>\u63cf\u8ff0\u7684\u4efb\u52a1\u7684\u8fd0\u884c\u72b6\u6001</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#33","title":"3.3 \u963b\u585e","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#34","title":"3.4 \u975e\u963b\u585e","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_3","title":"\u4e8c\u3001\u591a\u8fdb\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#1_1","title":"1. \u5f00\u542f\u5b50\u8fdb\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#11_1","title":"1.1 \u65b9\u6cd5\u4e00","text":"<pre><code>from multiprocessing import Process\nimport os\n\n\ndef func():  # \u5b50\u8fdb\u7a0b\n    print(__name__, 'func: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n\n\nprint(__name__, 'main: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\np = Process(target=func)  # \u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\np.start()  # \u542f\u52a8\u4e00\u4e2a\u5b50\u8fdb\u7a0b\n\n# \u8f93\u51fa\u7ed3\u679c\uff1a\n# __main__ main: ppid: 72950, pid: 83952\n# __main__ func: ppid: 83952, pid: 83953\n</code></pre> <p>\u5982\u679c\u5728Windows\u4e0b\u6267\u884c\u4f1a\u62a5\u9519\uff1a</p> <pre><code>__main__ main: ppid: 10740, pid: 22656\n__mp_main__ main: ppid: 22656, pid: 24816\nRuntimeError: \n        An attempt has been made to start a new process before the\n        current process has finished its bootstrapping phase.\n\n        This probably means that you are not using fork to start your\n        child processes and you have forgotten to use the proper idiom\n        in the main module:\n\n            if __name__ == '__main__':\n                freeze_support()\n                ...\n\n        The \"freeze_support()\" line can be omitted if the program\n        is not going to be frozen to produce an executable.\n</code></pre> <p>\u51fa\u9519\u539f\u56e0\uff1aWindows\u542f\u52a8\u5b50\u8fdb\u7a0b\u65f6\u4f1a\u81ea\u52a8<code>import</code>\u542f\u52a8\u5b83\u7684\u8fd9\u4e2a\u6587\u4ef6\uff0c\u800c\u5728<code>import</code>\u7684\u65f6\u5019\u4f1a\u6267\u884c\u8fd9\u4e9b\u8bed\u53e5\u3002\u65e0\u9650\u9012\u5f52\u521b\u5efa\u5b50\u8fdb\u7a0b\u62a5\u9519\u3002\u4f46\u662f\u5728multiprocessing.Process\u7684\u6e90\u7801\u4e2d\u662f\u5bf9\u5b50\u8fdb\u7a0b\u518d\u6b21\u4ea7\u751f\u5b50\u8fdb\u7a0b\u662f\u505a\u4e86\u9650\u5236\u7684\uff0c\u662f\u4e0d\u5141\u8bb8\u7684\uff0c\u4e8e\u662f\u51fa\u73b0\u5982\u4e0a\u7684\u9519\u8bef\u63d0\u793a \u3002Linux\u4e0b\u5f00\u542f\u5b50\u8fdb\u7a0b\u4f1acopy\u4e3b\u8fdb\u7a0b\u7684\u5185\u5b58\u7a7a\u95f4\u5230\u5b50\u8fdb\u7a0b\uff0c\u7236\u5b50\u8fdb\u7a0b\u4e4b\u95f4\u9694\u79bb\u3002</p> <p>\u89e3\u51b3\u65b9\u6cd5\uff1a</p> <pre><code>from multiprocessing import Process\nimport os\n\n\ndef func():  # \u5b50\u8fdb\u7a0b\n    print(__name__, 'func: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n\n\nif __name__ == '__main__':\n    print(__name__, 'main: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n    p = Process(target=func)  # \u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\n    p.start()  # \u542f\u52a8\u4e00\u4e2a\u5b50\u8fdb\u7a0b\n</code></pre> <p>\u7528\u591a\u8fdb\u7a0b\u5b9e\u73b0socket server\u8fde\u63a5\u591a\u4e2aclient</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socket\nfrom multiprocessing import Process\n\n\ndef talk(conn):\n    while True:\n        msg = conn.recv(1024).decode(\"utf-8\")\n        ret = msg.upper().encode(\"utf-8\")\n        conn.send(ret)\n    conn.close()\n\n\nif __name__ == '__main__':\n    sock = socket.socket()\n    sock.bind((\"127.0.0.1\", 8080))\n    sock.listen()\n    while True:\n        conn, addr = sock.accept()\n        Process(target=talk, args=(conn,)).start()\n    sock.close()\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\nimport time\n\nsock = socket.socket()\nsock.connect((\"127.0.0.1\", 8080))\nwhile True:\n    sock.send(b'hello')\n    content = sock.recv(1024).decode('utf-8')\n    print(content)\n    time.sleep(1)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#12_1","title":"1.2 \u65b9\u6cd5\u4e8c","text":"<pre><code>from multiprocessing import Process\nimport os\n\n\nclass MyProcess(Process):\n    def __init__(self, name, age):\n        super().__init__()\n        self.name = name\n        self.age = age\n\n    def run(self):\n        print('func: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n        print('func:', self.name, self.age)\n\n\nif __name__ == '__main__':\n    print('main: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n    p = MyProcess('Jerry', 18)\n    p.start()\n\n#main: ppid: 10740, pid: 22884\n#func: ppid: 22884, pid: 21232\n#func: Jerry 18\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#2-join","title":"2. <code>join</code>","text":"<p>\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7ed3\u675f\u540e\u7ee7\u7eed\u6267\u884c\u3002</p> <p>join():\u540c\u6b65\u963b\u585e--\u76f4\u81f3\u542f\u52a8\u7684\u7ebf\u7a0b\u7ec8\u6b62\u4e4b\u524d\u4e00\u76f4\u6302\u8d77\uff1b\u9664\u975e\u7ed9\u51fa\u4e86 timeout\uff08\u79d2\uff09\uff0c\u5426\u5219\u4f1a\u4e00\u76f4\u963b\u585e</p> <pre><code>from multiprocessing import  Process\nimport os\nimport time\n\n\ndef  func():\n    time.sleep(2)\n    print('%s func: ppid:%s, pid: %s' % (time.strftime(\"%Y-%m-%d %H:%M:%S\"), os.getppid(),os .getpid()))\n\nif __name__ == '__main__':\n    print('%s main: ppid:%s, pid: %s' % (time.strftime(\"%Y-%m-%d %H:%M:%S\"), os.getppid(),os .getpid()))\n    p = Process(target=func)\n    p.start() # \u5f02\u6b65\u975e\u963b\u585e\n    p.join() # \u540c\u6b65\u963b\u585e \u76f4\u81f3\u542f\u52a8\u7684\u7ebf\u7a0b\u7ec8\u6b62\u4e4b\u524d\u4e00\u76f4\u6302\u8d77\uff1b\u9664\u975e\u7ed9\u51fa\u4e86 timeout\uff08\u79d2\uff09\uff0c\u5426\u5219\u4f1a\u4e00\u76f4\u963b\u585e\n    print(time.strftime(\"%Y-%m-%d %H:%M:%S\"),'end')\n# \u8f93\u51fa\u7ed3\u679c\n# 2020-02-17 11:38:47 main: ppid:19674, pid: 20103\n# 2020-02-17 11:38:49 func: ppid:20103, pid: 20104\n# 2020-02-17 11:38:49 end\n#### \u5982\u679c\u6ca1\u6709join\u8f93\u51fa\u7ed3\u679c ####\n#2020-02-17 11:38:57 main: ppid:19674, pid: 20115\n#2020-02-17 11:38:57 end\n#2020-02-17 11:38:59 func: ppid:20115, pid: 20116\n</code></pre> <p>\u591a\u4e2a\u5b50\u8fdb\u7a0bjoin</p> <pre><code>from multiprocessing import  Process\nimport os\nimport time\n\n\ndef  func(n):\n    time.sleep(2)\n    print('%s func%d: ppid:%s, pid: %s' % (time.strftime(\"%Y-%m-%d %H:%M:%S\"), n,os.getppid(),os .getpid()))\n\nif __name__ == '__main__':\n    print('%s main: ppid:%s, pid: %s' % (time.strftime(\"%Y-%m-%d %H:%M:%S\"), os.getppid(),os .getpid()))\n    p_list = []\n    for arg in range(1,5):\n        p = Process(target=func,args=(arg,))\n        p.start()\n        p_list.append(p)\n    for p in p_list:\n        p.join()\n    time.sleep(1)\n    print(time.strftime(\"%Y-%m-%d %H:%M:%S\"),'end')\n# \u8f93\u51fa\u7ed3\u679c\n# 2020-02-17 12:15:53 main: ppid:83012, pid: 79880\n# 2020-02-17 12:15:56 func1: ppid:79880, pid: 76312\n# 2020-02-17 12:15:56 func2: ppid:79880, pid: 83728\n# 2020-02-17 12:15:56 func3: ppid:79880, pid: 72620\n# 2020-02-17 12:15:56 func4: ppid:79880, pid: 72696\n# 2020-02-17 12:15:57 end\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#3_1","title":"3.\u5c5e\u6027\u548c\u65b9\u6cd5","text":"<pre><code>from multiprocessing import Process\nimport os\nimport time\n\n\nclass MyProcess(Process):\n    def run(self):\n        print('func: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n\n\nif __name__ == '__main__':\n    print('main: ppid: %s, pid: %s' % (os.getppid(), os.getpid()))\n    p = MyProcess()\n    p.start()\n\n    print(p.ident, p.pid)  # 512 512\n    print(p.name)  # MyProcess-1  \n    print(p.is_alive())  # True\n    p.terminate()  # \u5f3a\u5236\u7ed3\u675f\u4e00\u4e2a\u5b50\u8fdb\u7a0b,\u5f02\u6b65\u975e\u963b\u585e\uff0c\u9700\u8981\u64cd\u4f5c\u7cfb\u7edf\u54cd\u5e94\u8bf7\u6c42\u540e\u6267\u884c\n    time.sleep(0.01)\n    print(p.is_alive())  # False\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#4","title":"4. \u5b88\u62a4\u8fdb\u7a0b","text":"<ol> <li>\u4e3b\u8fdb\u7a0b\u4e3a\u4e86\u56de\u6536\u5b50\u8fdb\u7a0b\u7684\u8d44\u6e90\uff0c\u4f1a\u7b49\u5f85\u6240\u6709\u5b50\u8fdb\u7a0b\u7ed3\u675f\u624d\u7ed3\u675f\u3002</li> <li>\u5b88\u62a4\u8fdb\u7a0b\u4f1a\u7b49\u5f85\u4e3b\u8fdb\u7a0b\u4ee3\u7801\u7ed3\u675f\u4e4b\u540e\u624d\u7ed3\u675f\u3002</li> <li>\u5982\u679c\u4e3b\u8fdb\u7a0b\u4ee3\u7801\u7ed3\u675f\u4e4b\u540e\u8fd8\u6709\u5176\u4ed6\u5b50\u8fdb\u7a0b\u5728\u8fd0\u884c\uff0c\u5b88\u62a4\u8fdb\u7a0b\u4e0d\u5b88\u62a4</li> </ol> <pre><code>from multiprocessing import Process\nimport time\n\ndef func1():\n    while True:\n        print('func1')\n        time.sleep(1)\n\ndef func2():\n    for i in range(5):\n        print('func2', i)\n        time.sleep(1)\n\nif __name__ == '__main__':\n    p1 = Process(target=func1)\n    p1.daemon = True  # p1\u8bbe\u7f6e\u4e3a\u5b88\u62a4\u8fdb\u7a0b\n    p1.start()        # p1\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\u5f00\u59cb\u6267\u884c\n    p2 = Process(target=func2)\n    p2.start()        # p2\u542f\u52a8\u65b0\u7684\u8fdb\u7a0b\u5f00\u59cb\u6267\u884c\n\n    time.sleep(3)     # \u4e3b\u8fdb\u7a0b\u7ee7\u7eed\u6267\u884c\uff0c3\u79d2\u4e4b\u540e\u4e3b\u8fdb\u7a0b\u7684\u4ee3\u7801\u6267\u884c\u5b8c\u6210\uff0cp1\u5b88\u62a4\u8fdb\u7a0b\u968f\u4e4b\u7ed3\u675f\uff0c\u4f46\u662fp2\u8fdb\u7a0b\u4f1a\u7ee7\u7eed\u6267\u884c\uff0c\u76f4\u5230p2\u7ed3\u675f\u4e4b\u540e\uff0c\u811a\u672c\u6267\u884c\u7ed3\u675f\u3002\n# \u8f93\u51fa\u7ed3\u679c\nfunc1\nfunc2 0\nfunc1\nfunc2 1\nfunc1\nfunc2 2\nfunc2 3\nfunc2 4\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#5","title":"5. \u9501","text":"<p>\u52a0\u9501\u964d\u4f4e\u4e86\u7a0b\u5e8f\u7684\u6267\u884c\u6548\u7387\uff0c\u4fdd\u8bc1\u4e86\u6570\u636e\u7684\u5b89\u5168</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#51","title":"5.1 \u4e0d\u4f7f\u7528\u9501\u7684\u60c5\u51b5","text":"<pre><code>#!/usr/bin/env python3\n# coding:utf-8\nfrom multiprocessing import Process\nimport time\nimport json\nimport random\n\n\ndef search_ticket(i):\n    # \u67e5\u8be2\u4f59\u7968\n    with open(\"ticket.db\", 'r', encoding='utf-8') as f:\n        ticket = json.load(f)\n    print('\u7528\u6237%s\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a%s\u5f20.' % (i, ticket.get('num')), end='')\n\n\ndef buy_ticket(i):\n    with open(\"ticket.db\", 'r', encoding='utf-8') as f:\n        ticket = json.load(f)\n    # \u6a21\u62df\u7f51\u7edc\u5ef6\u65f6\n    time.sleep(random.randint(1, 3))\n    # \u5224\u65ad\u5f53\u524d\u662f\u5426\u6709\u7968\n    if ticket.get('num') &gt; 0:\n        # \u4fee\u6539\u6570\u636e\u5e93\n        ticket['num'] -= 1\n        # \u5199\u5165\u6570\u636e\n        with open('ticket.db', mode='w', encoding='utf-8') as f:\n            json.dump(ticket, f)\n        print('user%s\u8d2d\u7968\u6210\u529f!' % i)\n    else:\n        print('\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!')\n\n\ndef get_ticket(i):\n    search_ticket(i)\n    buy_ticket(i)\n\n\ndef create_db():\n    ticket = {'num': 1}\n    with open('ticket.db', mode='w', encoding='utf-8') as f:\n        json.dump(ticket, f)\n\n\nif __name__ == '__main__':\n    create_db()\n    for i in range(1, 11):\n        p = Process(target=get_ticket, args=(i,))\n        p.start()\n\n######################################\n\u7528\u62373\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user3\u8d2d\u7968\u6210\u529f!\n\u7528\u62374\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user4\u8d2d\u7968\u6210\u529f!\n\u7528\u62376\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user6\u8d2d\u7968\u6210\u529f!\n\u7528\u623710\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user10\u8d2d\u7968\u6210\u529f!\n\u7528\u62375\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user5\u8d2d\u7968\u6210\u529f!\n\u7528\u62377\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user7\u8d2d\u7968\u6210\u529f!\n\u7528\u62371\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user1\u8d2d\u7968\u6210\u529f!\n\u7528\u62372\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user2\u8d2d\u7968\u6210\u529f!\n\u7528\u62379\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user9\u8d2d\u7968\u6210\u529f!\n\u7528\u62378\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a1\u5f20.user8\u8d2d\u7968\u6210\u529f!        \n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#52","title":"5.2 \u4e92\u65a5\u9501","text":"<pre><code>#!/usr/bin/env python3\n# coding:utf-8\nfrom multiprocessing import Process, Lock\nimport time\nimport json\nimport random\n\n\ndef search_ticket(i):\n    # \u67e5\u8be2\u4f59\u7968\n    with open(\"ticket.db\", 'r', encoding='utf-8') as f:\n        ticket = json.load(f)\n    print('\u7528\u6237%s\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a%s\u5f20.' % (i, ticket.get('num')), end='')\n\n\ndef buy_ticket(i):\n    with open(\"ticket.db\", 'r', encoding='utf-8') as f:\n        ticket = json.load(f)\n    # \u5224\u65ad\u5f53\u524d\u662f\u5426\u6709\u7968\n    if ticket.get('num') &gt; 0:\n        # \u4fee\u6539\u6570\u636e\u5e93\n        ticket['num'] -= 1\n        # \u6a21\u62df\u7f51\u7edc\u5ef6\u65f6\n        time.sleep(random.randint(1,3))\n        # \u5199\u5165\u6570\u636e\n        with open('ticket.db', mode='w', encoding='utf-8') as f:\n            json.dump(ticket, f)\n        print('user%s\u8d2d\u7968\u6210\u529f!' % i)\n    else:\n        print('\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!')\n\ndef get_ticket(i, lock):\n    search_ticket(i)\n    #lock.acquire() # \u52a0\u9501\n    #buy_ticket(i)\n    #lock.release() # \u91ca\u653e\u9501\n    with lock: # with \u5728\u6267\u884c\u51fd\u6570\u524d\u52a0\u9501\uff0c\u6267\u884c\u51fd\u6570\u540e\u91ca\u653e\u9501\uff0cwith \u53ef\u4ee5\u4fdd\u8bc1\u5728\u51fd\u6570\u6267\u884c\u5931\u8d25\u540e\u91ca\u653e\u9501\u3002\n        buy_ticket(i)\n\n\ndef create_db():\n    ticket={'num':3}\n    with open('ticket.db', mode='w', encoding='utf-8') as f:\n        json.dump(ticket, f)\n\nif __name__ == '__main__':\n    create_db()\n    lock = Lock()\n    for i in range(1,11):\n        p = Process(target=get_ticket, args=(i, lock))\n        p.start()        \n##################################\n# \u867d\u7136\u6bcf\u4e2a\u4eba\u90fd\u67e5\u5230\u4f59\u7968\u67093\u5f20\uff0c\u4f46\u53ea\u6709\u4e09\u4e2a\u4eba\u4e70\u7968\u6210\u529f\n\u7528\u62371\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.user1\u8d2d\u7968\u6210\u529f!\n\u7528\u62372\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.user2\u8d2d\u7968\u6210\u529f!\n\u7528\u62374\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.user4\u8d2d\u7968\u6210\u529f!\n\u7528\u62375\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n\u7528\u62377\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n\u7528\u62378\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n\u7528\u62379\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n\u7528\u62373\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n\u7528\u62376\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n\u7528\u623710\u67e5\u8be2\u4f59\u7968\uff0c\u5f53\u524d\u4f59\u7968\uff1a3\u5f20.\u4f59\u7968\u4e0d\u8db3\uff0c\u8d2d\u7968\u5931\u8d25!\n</code></pre> <p>\u4e92\u65a5\u9501\u4e0d\u80fdacquire\u591a\u6b21</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#6-ipc","title":"6. \u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08IPC\uff09","text":"<ul> <li>\u57fa\u4e8e\u6587\u4ef6 \u540c\u4e00\u673a\u5668\u7684\u591a\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u901a\u4fe1 (\u57fa\u4e8esocket)</li> <li>\u57fa\u4e8e\u7f51\u7edc \u540c\u4e00\u6216\u4e0d\u540c\u673a\u5668\u591a\u8fdb\u7a0b\u4e4b\u95f4\u901a\u4fe1 (memcheck, redis, rabbitmq,kafka)</li> </ul>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#61-queue","title":"6.1 \u961f\u5217Queue","text":"<pre><code>from multiprocessing import Queue, Process\n\n\ndef foo(q):\n    print(q.get())  # hello world!\n\n\ndef bar(q):\n    q.put('hello world!')\n\n\nif __name__ == '__main__':\n    q = Queue()\n    p1 = Process(target=bar, args=(q,))\n    p1.start()\n    p2 = Process(target=foo, args=(q,))\n    p2.start()\n</code></pre> <p>\u961f\u5217\u4e2dput\u4e00\u4e2a\uff0cget\u4e00\u4e2a\uff0c\u5982\u679cget\u6570\u91cf\u8d85\u8fc7put\uff0cget\u4f1a\u4e00\u76f4\u7b49\u5f85\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#62","title":"6.2 \u901a\u8fc7\u961f\u5217\u5b9e\u73b0\u751f\u4ea7\u8005\u6d88\u8d39\u8005\u6a21\u578b","text":"<pre><code>from multiprocessing import Process\nfrom multiprocessing import Queue\nimport time\nimport random\n\n\ndef consumer(q):\n    while True:\n        food = q.get()\n        if food:\n            print(\"-C\u6d88\u8d39\u4e86%s\" % food)\n        else:\n            break\n\n\ndef producer(q, name, food):\n    for i in range(10):\n        ifood = \"\u7b2c%s\u4e2a%s\" % (i, food)\n        print(\"+%s\u751f\u4ea7\u4e86%s\" % (name, ifood))\n        time.sleep(random.random())\n        q.put(ifood)\n\n\nif __name__ == '__main__':\n    q = Queue()\n\n    p1 = Process(target=producer, args=(q, \"A\", \"\u997a\u5b50\"))\n    p2 = Process(target=producer, args=(q, \"B\", \"\u5305\u5b50\"))\n    c = Process(target=consumer, args=(q,))\n    p1.start()\n    p2.start()\n    c.start()\n    p1.join()\n    p2.join()\n    q.put(None)\n</code></pre> <pre><code>from multiprocessing import Process\nfrom multiprocessing import Queue\nimport time\n\ndef comsumor(q):\n    print('-\u6d88\u8d39\u7b2c%s\u4e2a\u4ea7\u54c1' % q.get())\n\ndef productor(q,i):\n    print('+\u751f\u4ea7\u7b2c%s\u4e2a\u4ea7\u54c1' % (i,))\n    q.put((i))\n    time.sleep(0.5)\n\nif __name__ == '__main__':\n    q = Queue()\n    for i in range(10):\n        p = Process(target=productor,args=(q,i))\n        p.start()\n    for i in range(10):\n        c = Process(target=comsumor, args=(q,))\n        c.start() \n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#7","title":"7. \u8fdb\u7a0b\u95f4\u6570\u636e\u5171\u4eab","text":"<p>\u8fdb\u7a0b\u4e4b\u95f4\u662f\u6570\u636e\u9694\u79bb\u7684</p> <pre><code>from multiprocessing import Process\n\nnum = 0\n\n\ndef func():\n    global num\n    num += 1\n\n\nif __name__ == '__main__':\n    p_l = []\n    for i in range(100):  # \u5f00100\u4e2a\u8fdb\u7a0b\u7a7a\u95f4\n        p = Process(target=func)\n        p.start()\n        p_l.append(p)\n    for p in p_l:\n        p.join()\n    print(num)  # 0\n</code></pre> <p>python\u4e2d\u53ef\u4ee5\u901a\u8fc7<code>Manager</code>\u7c7b\u52a0\u9501\u7684\u65b9\u6cd5\u5b9e\u73b0\u8fdb\u7a0b\u95f4\u7684\u6570\u636e\u5171\u4eab\uff0c\u4f46\u662f\u5e26\u6765\u7684\u6027\u80fd\u4ee3\u4ef7\u5f88\u9ad8\uff0c\u9700\u8981\u5bf9\u5171\u4eab\u7684\u6570\u636e\u8fdb\u884c\u52a0\u9501\uff0c\u4e0d\u63a8\u8350\u4f7f\u7528\u8fd9\u79cd\u65b9\u6cd5\u3002</p> <pre><code>from multiprocessing import Process, Manager, Lock\n\n\ndef change_dic(dic, lock):\n    with lock:\n        dic['count'] -= 1\n\n\nif __name__ == '__main__':\n    m = Manager()\n    dic = m.dict({'count': 100})\n    lock = Lock()\n    p_l = []\n    for i in range(100):\n        p = Process(target=change_dic, args=(dic, lock))\n        p.start()\n        p_l.append(p)\n\n    for p in p_l:\n        p.join()\n    print(dic)  # {'count': 0}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#2_1","title":"2. \u8fdb\u7a0b\u6c60","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#21_1","title":"2.1.\u521b\u5efa\u7ebf\u7a0b\u6c60","text":"<pre><code>from concurrent.futures import ProcessPoolExecutor\nimport os\nimport time\nimport random\n\n\ndef func(i):\n    print('start: %s %s' % (i, os.getpid()))\n    time.sleep(random.randint(1, 3))\n    print('end: %s %s' % (i, os.getpid()))\n\n\nif __name__ == \"__main__\":\n    tp = ProcessPoolExecutor(4)  # \u5b9e\u4f8b\u8fdb\u7a0b\u6c60\uff0c\u4f20\u5165\u8fdb\u7a0b\u6c60\u4e2d\u7684\u8fdb\u7a0b\u6570\u91cf\n    for i in range(10):\n        tp.submit(func, i)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#22_1","title":"2.2 \u4ece\u8fdb\u7a0b\u6c60\u4e2d\u83b7\u53d6\u7ed3\u679c","text":"<pre><code>from concurrent.futures import ProcessPoolExecutor\nimport os\nimport time\nimport random\n\n\ndef func(i):\n    print('start: %s %s' % (i, os.getpid()))\n    time.sleep(random.randint(1, 3))\n    print('end: %s %s' % (i, os.getpid()))\n    return i ** 2\n\n\nif __name__ == \"__main__\":\n    tp = ProcessPoolExecutor(4)\n    future_l = {}\n    for i in range(20):  # \u5f02\u6b65\u975e\u963b\u585e\n        ret = tp.submit(func, i)  # ret --&gt; &lt;Future at 0x166e360f5c0 state=running&gt;\n        # print(ret.result())  # \u540c\u6b65\u6267\u884c\uff0c\u5982\u679c\u5728\u8fd9\u91cc\u83b7\u53d6\u7ed3\u679c\uff1a\u6267\u884c\u5b8c\u4e00\u4e2a\u8fdb\u7a0b\u7b49\u5f85\u6536\u5230\u7ed3\u679c\u4e4b\u540e\u7ee7\u7eed\u6267\u884c\n        future_l[i] = ret\n    for k, v in future_l.items():  # \u540c\u6b65\u83b7\u53d6\u7ed3\u679c\uff0c\u6309\u7167\u63d0\u4ea4\u987a\u5e8f\u83b7\u53d6\u7ed3\u679c\uff0c\u7b49\u5230\u83b7\u53d6\u5230\u7ed3\u679c\u4e4b\u540e\u624d\u80fd\u83b7\u53d6\u4e0b\u4e00\u4e2a\u4efb\u52a1\u7684\u7ed3\u679c\u3002\n        print(k, '--&gt;', v.result())\n</code></pre> <p>\u4f7f\u7528<code>map</code>\u65b9\u6cd5\uff0c\u9002\u7528\u4e8e\u4f20\u9012\u7b80\u5355\u7684\u53c2\u6570\uff0c\u4e14\u53c2\u6570\u65f6\u4e00\u4e2a\u53ef\u8fed\u4ee3\u7684\u7c7b\u578b\u3002</p> <pre><code>from concurrent.futures import ProcessPoolExecutor\nimport os\nimport time\nimport random\n\n\ndef func(i):\n    print('start: %s %s' % (i, os.getpid()))\n    time.sleep(random.randint(1, 3))\n    print('end: %s %s' % (i, os.getpid()))\n    return i ** 2\n\n\nif __name__ == \"__main__\":\n    tp = ProcessPoolExecutor(4)\n    ret = tp.map(func, range(10))  # map(\u51fd\u6570,\u53ef\u8fed\u4ee3\u5bf9\u8c61)\n    for k in ret:\n        print(k)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#23","title":"2.3  \u56de\u8c03\u51fd\u6570","text":"<pre><code>from concurrent.futures import ProcessPoolExecutor\nimport os\nimport time\nimport random\n\n\ndef func(i):\n    print('start: %s %s' % (i, os.getpid()))\n    time.sleep(random.randint(1, 3))\n    print('end: %s %s' % (i, os.getpid()))\n    return i ** 2\n\n\ndef get_ret(ret):  # \u5f02\u6b65\u963b\u585e\n    print(ret.result())  # \u5148\u6267\u884c\u5b8c\u7684\u5148\u6253\u5370\n\n\nif __name__ == \"__main__\":\n    tp = ProcessPoolExecutor(4)\n    future_l = {}\n    for i in range(20):  # \u5f02\u6b65\u975e\u963b\u585e\n        ret = tp.submit(func, i)\n        ret.add_done_callback(get_ret)  # \u5f02\u6b65\u963b\u585e\n        # \u56de\u8c03\u51fd\u6570\uff0c\u7ed9ret\u5bf9\u8c61\u7ed1\u5b9a\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\uff0c\n        # \u7b49\u5f85ret\u5bf9\u5e94\u7684\u4efb\u52a1\u6709\u4e86\u7ed3\u679c\u4e4b\u540e\u7acb\u5373\u8c03\u7528get_ret\u51fd\u6570\u5bf9\u7ed3\u679c\u7acb\u5373\u8fdb\u884c\u5904\u7406,\u800c\u4e0d\u7528\u6309\u7167\u987a\u5e8f\u63a5\u6536\u5904\u7406\u7ed3\u679c\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_4","title":"\u4e09\u3001\u591a\u7ebf\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#1_2","title":"1. \u591a\u7ebf\u7a0b","text":"<ol> <li>\u7ebf\u7a0b\u662f\u80fd\u88ab\u64cd\u4f5c\u7cfb\u7edf\u8c03\u5ea6\u7684\u6700\u5c0f\u5355\u4f4d</li> <li>\u540c\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u7ebf\u7a0b\u53ef\u4ee5\u540c\u65f6\u88abCPU\u6267\u884c</li> <li>\u7ebf\u7a0b\u4e4b\u95f4\u6570\u636e\u5171\u4eab</li> <li>\u7ebf\u7a0b\u7684\u5207\u6362\u5f00\u9500\u8f83\u5c0f</li> <li>\u7ebf\u7a0b\u53ea\u80fd\u81ea\u5df1\u6267\u884c\u5b8c\u4ee3\u7801\u540e\u5173\u95ed</li> </ol> <p>CPython\u4e2d\u7684\u7ebf\u7a0b\uff1a</p> <ol> <li>gc\u5783\u573e\u56de\u6536\uff1a\u5f15\u7528\u8ba1\u6570+\u5206\u4ee3\u56de\u6536</li> <li>\u5168\u5c40\u89e3\u91ca\u5668\u9501\uff1a\u4e3a\u4e86\u5b8c\u6210gc\u7684\u56de\u6536\u673a\u5236\u3002\u5bfc\u81f4\u4e00\u4e2a\u8fdb\u7a0b\u4e2d\u7684\u591a\u4e2a\u7ebf\u7a0b\u53ea\u6709\u4e00\u4e2a\u7ebf\u7a0b\u88ab\u6267\u884c\u3002</li> </ol> <p>pypy \u4e5f\u4f7f\u7528gc\u56de\u6536\uff0c\u540c\u6837\u4e0d\u80fd\u4f7f\u7528\u591a\u6838\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#2_2","title":"2.\u5f00\u542f\u7ebf\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#21_2","title":"2.1 \u65b9\u6cd5\u4e00 \u9762\u5411\u8fc7\u7a0b","text":"<pre><code>from threading import Thread\nimport time\n\n\ndef func(i):\n    print('start:%s' % i)\n    time.sleep(1)\n    print('end:%s' % i)\n\n\nif __name__ == '__main__':\n    for i in range(2):\n        t = Thread(target=func, args=(i,))\n        t.start()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#21_3","title":"2.1 \u65b9\u6cd5\u4e8c \u9762\u5411\u5bf9\u8c61","text":"<pre><code>from threading import Thread\nimport time\n\n\nclass MyThread(Thread):\n    def __init__(self, i):\n        self.i = i\n        super().__init__()\n\n    def run(self):\n        print('start:%s' % self.i)\n        time.sleep(1)\n        print('end:%s' % self.i)\n\n\nif __name__ == '__main__':\n    for i in range(2):\n        t = MyThread(i)\n        t.start()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#3-join","title":"3 <code>join</code>","text":"<pre><code>from threading import Thread\nimport time\n\n\ndef func(i):\n    print('start:%s' % i)\n    time.sleep(1)\n    print('end:%s' % i)\n\n\nif __name__ == '__main__':\n    t_l = []\n    for i in range(3):\n        t = Thread(target=func, args=(i,))\n        t.start()\n        t_l.append(t)\n    for t in t_l:\n        t.join()\n    print(\"\u6240\u6709\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\")\n\n# start:0\n# start:1\n# start:2\n# end:1\n# end:2\n# end:0\n# \u6240\u6709\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#4_1","title":"4. \u5c5e\u6027\u548c\u65b9\u6cd5","text":"<pre><code>from threading import Thread\nfrom threading import current_thread\nfrom threading import enumerate  \nfrom threading import active_count\nimport time\n\n\ndef func(i):\n    print('%s --&gt; %s \u7ebf\u7a0bid: %s' % (i, current_thread().name, current_thread().ident))  # # \u5728\u6267\u884c\u7684\u7ebf\u7a0b\u4e2d\u8fd4\u56de\u5f53\u524d\u7ebf\u7a0b\u7684id\n    time.sleep(1)\n\n\nif __name__ == '__main__':\n    t_l = []\n    for i in range(2):\n        t = Thread(target=func, args=(i,))\n        t.start()\n        t_l.append(t)\n    print('\u8fdb\u7a0b\u5217\u8868\uff1a',\n          enumerate())  # \u8fdb\u7a0b\u5217\u8868\uff1a [&lt;_MainThread(MainThread, started 30544)&gt;, &lt;Thread(Thread-1, started 23060)&gt;, &lt;Thread(Thread-2, started 28636)&gt;, &lt;Thread(Thread-3, started 28932)&gt;]\n\n    print('\u5f53\u524d\u5b58\u6d3b\u7684\u8fdb\u7a0b\u6570\uff1a', active_count())  # 4\n    for t in t_l:\n        t.join()\n\n    print(\"\u6240\u6709\u7ebf\u7a0b\u6267\u884c\u5b8c\u6210\")\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#5_1","title":"5,.\u7ebf\u7a0b\u4e4b\u95f4\u6570\u636e\u5171\u4eab","text":"<pre><code>from threading import Thread\n\nnum = 100\n\n\ndef func():\n    global num\n    num -= 1\n\n\nif __name__ == '__main__':\n    t_l = []\n    for i in range(100):\n        t = Thread(target=func)\n        t.start()\n        t_l.append(t)\n    for r in t_l:\n        t.join()\n    print(num)  # 0\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#3_2","title":"3. \u5b88\u62a4\u7ebf\u7a0b","text":"<p>\u4e3b\u7ebf\u7a0b\u4f1a\u7b49\u5f85\u5b50\u7ebf\u7a0b\u7ed3\u675f\u4e4b\u540e\u624d\u7ed3\u675f\u3002</p> <ol> <li>\u5b88\u62a4\u7ebf\u7a0b\u968f\u7740\u4e3b\u7ebf\u7a0b\u7684\u7ed3\u675f\u800c\u7ed3\u675f\u3002</li> <li>\u5b88\u62a4\u7ebf\u7a0b\u4f1a\u5728\u4e3b\u7ebf\u7a0b\u7684\u4ee3\u7801\u7ed3\u675f\u4e4b\u540e\u8fd8\u6709\u5176\u4ed6\u5b50\u7ebf\u7a0b\u5728\u8fd0\u884c\uff0c\u7ee7\u7eed\u5b88\u62a4\u5176\u4ed6\u5b50\u7ebf\u7a0b\u3002</li> <li>\u5176\u4ed6\u5b50\u7ebf\u7a0b\u7ed3\u675f--&gt;\u4e3b\u7ebf\u7a0b\u7ed3\u675f--&gt;\u6574\u4e2a\u8fdb\u7a0b\u4e2d\u6240\u6709\u8d44\u6e90\u56de\u6536--&gt;\u5b88\u62a4\u8fdb\u7a0b\u4e5f\u4f1a\u88ab\u56de\u6536</li> </ol> <pre><code>from threading import Thread\nimport time\n\n\ndef func1():\n    while True:\n        print('\u6267\u884c\u5b50\u7ebf\u7a0b1...')\n        time.sleep(1)\n\n\ndef func2():\n    for i in range(3):\n        print('\u6267\u884c\u5b50\u7ebf\u7a0b2...')\n        time.sleep(1)\n\n\nt1 = Thread(target=func1)\nt1.daemon = True\nt1.start()\nt2 = Thread(target=func2)\nt2.start()\n# \u8f93\u51fa\u7ed3\u679c\n\u6267\u884c\u5b50\u7ebf\u7a0b1...\n\u6267\u884c\u5b50\u7ebf\u7a0b2...\n\u6267\u884c\u5b50\u7ebf\u7a0b1...\n\u6267\u884c\u5b50\u7ebf\u7a0b2...\n\u6267\u884c\u5b50\u7ebf\u7a0b1...\n\u6267\u884c\u5b50\u7ebf\u7a0b2...\n\u6267\u884c\u5b50\u7ebf\u7a0b1...\n</code></pre> <p>\u5b50\u7ebf\u7a0bfunc2\u7ed3\u675f\u4e4b\u540e\uff0c\u4e0d\u7b49\u5f85\u7ebf\u7a0bfunc1\uff0c\u4e3b\u7ebf\u7a0b\u7ed3\u675f\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#4_2","title":"4. \u9501","text":"<p>\u7ebf\u7a0b\u4e4b\u95f4\u4e5f\u5b58\u5728\u6570\u636e\u4e0d\u5b89\u5168\u3002</p> <pre><code>from threading import Thread\n\nn = 0\n\n\ndef add():\n    for _ in range(100000):\n        global n\n        n += 1\n\n\ndef sub():\n    for _ in range(100000):\n        global n\n        n -= 1\n\n\nt_l = []\n\nfor i in range(2):\n    t1 = Thread(target=add)\n    t1.start()\n    t2 = Thread(target=sub)\n    t2.start()\n    t_l.append(t1)\n    t_l.append(t2)\n\nfor t in t_l:\n    t.join()\n\nprint(n) # -15778 \u53ef\u80fd\u51fa\u73b0\u6570\u636e\u4e0d\u5b89\u5168\n</code></pre> <p>\u5f15\u8d77\u6570\u636e\u4e0d\u5b89\u5168\u7684\u539f\u56e0\uff1a</p> <p>\u591a\u4e2a\u7ebf\u7a0b\u5728\u8fd0\u7b97\u548c\u8d4b\u503c\u4e4b\u95f4\u53d1\u751f\u7ebf\u7a0b\u7684\u5207\u6362</p> <pre><code>import dis\n\nn = 0\n\n\ndef add():\n    global n\n    n += 1\n\n\ndis.dis(add)\n#   8           0 LOAD_GLOBAL              0 (n)\n#               2 LOAD_CONST               1 (1)\n#               4 INPLACE_ADD\n#               6 STORE_GLOBAL             0 (n)\n#               8 LOAD_CONST               0 (None)\n#              10 RETURN_VALUE\n</code></pre> <p>\u5f15\u8d77\u6570\u636e\u4e0d\u5b89\u5168\u7684\u64cd\u4f5c\uff1a</p> <ol> <li>\u5728<code>+=</code>\u3001<code>-=</code>\u3001<code>*=</code>\u3001<code>/=</code>\u8fd0\u7b97\u4e2d\uff0c\u8ba1\u7b97\u548c\u8d4b\u503c\u662f\u4e24\u4e2a\u64cd\u4f5c\uff0c\u5176\u4ed6\u5148\u8ba1\u7b97\u540e\u8d4b\u503c\u7684\u8868\u8fbe\u5f0f\u90fd\u4f1a\u5f15\u8d77\u6570\u636e\u4e0d\u5b89\u5168</li> <li><code>if</code>\u3001<code>while</code> \u5224\u65ad\u540c\u6837\u4f1a\u5f15\u8d77\u6570\u636e\u4e0d\u5b89\u5168</li> <li>\u591a\u4e2a\u7ebf\u7a0b\u540c\u65f6\u64cd\u4f5c\u5168\u90e8\u53d8\u91cf\u3001\u9759\u6001\u53d8\u91cf\u4f1a\u5f15\u8d77\u6570\u636e\u4e0d\u5b89\u5168</li> </ol> <p>\u907f\u514d\u5f15\u8d77\u6570\u636e\u4e0d\u5b89\u5168\u7684\u65b9\u6cd5\uff1a</p> <ol> <li> <p>\u5c3d\u91cf\u907f\u514d\u64cd\u4f5c\u5168\u5c40\u53d8\u91cf</p> </li> <li> <p>\u4e0d\u8981\u5728\u7c7b\u91cc\u64cd\u4f5c\u9759\u6001\u53d8\u91cf</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#41","title":"4.1 \u4e92\u65a5\u9501","text":"<pre><code>from threading import Thread,Lock\n\nn = 0\n\ndef add(lock):\n    for i in range(30000):\n        global n\n        with lock:\n            n += 1\n\ndef sub(lock):\n    for i in range(30000):\n        global n \n        with lock:\n            n -= 1\n\nt_l = []\nlock = Lock()\n\nfor i in range(2):\n    t1 = Thread(target=add, args=(lock,))\n    t1.start()\n    t2 = Thread(target=sub, args=(lock,))\n    t2.start()\n    t_l.append(t1)\n    t_l.append(t2)\n\nfor t in t_l:\n    t.join()\n\nprint(n)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#42","title":"4.2 \u6b7b\u9501","text":"<p>\u4ea7\u751f\u7684\u539f\u56e0\uff1a\u591a\u628a\uff08\u4e92\u65a5/\u9012\u5f52\uff09\u9501\uff0c\u5728\u518d\u591a\u4e2a\u7ebf\u7a0b\u4e2d\u4ea4\u53c9\u4f7f\u7528</p> <p>\u89e3\u51b3\u6b7b\u9501\u7684\u65b9\u6cd5\uff1a\u5f53\u4f7f\u7528\u4e92\u65a5\u9501\u51fa\u73b0\u6b7b\u9501\u73b0\u8c61\u65f6\uff0c\u53ef\u4ee5\u628a\u6240\u6709\u7684\u4e92\u65a5\u9501\u90fd\u6539\u6210\u4e00\u628a\u9012\u5f52\u9501\uff0c\u4f46\u662f\u6267\u884c\u7684\u6548\u7387\u961f\u964d\u4f4e\u3002</p> <pre><code>from threading import Thread, Lock\nimport time\n\nmutexA = Lock()\nmutexB = Lock()\n\n\ndef func1():\n    mutexA.acquire()\n    print(\"func1 \u62a2\u5230A\u9501\")\n    time.sleep(2)\n    mutexB.acquire()\n    print(\"func1 \u62a2\u5230B\u9501\")\n    mutexB.release()\n    mutexA.release()\n\n\ndef func2():\n    mutexB.acquire()\n    print(\"func2 \u62a2\u5230B\u9501\")\n    time.sleep(2)\n    mutexA.acquire()\n    print(\"func2 \u62a2\u5230A\u9501\")\n    mutexA.release()\n    mutexB.release()\n\n\nt1 = Thread(target=func1)\nt2 = Thread(target=func2)\nt1.start()\nt2.start()\n\n\n\n# func1 \u62a2\u5230A\u9501\n# func2 \u62a2\u5230B\u9501\n# \u5230\u8fd9\u91cc\u963b\u585e\u4f4f\u4e86\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#43","title":"4.3 \u9012\u5f52\u9501","text":"<p>\u540c\u4e00\u4e2a\u7ebf\u7a0b\u4e2d\u53ef\u4ee5lock.acquire\u591a\u6b21\uff0c\u540c\u65f6\u9700\u8981lock.release\u591a\u6b21\u624d\u80fd\u91ca\u653e\u9501\u3002\u4f46\u662f\u53ea\u80fd\u88ab\u7b2c\u4e00\u4e2a\u62a2\u5230\u9501\u7684\u6267\u884c\u4e0a\u8ff0\u64cd\u4f5c\u3002</p> <pre><code>from threading import Thread, RLock\nimport time\n\nmutexA = mutexB = RLock()\n\n\ndef func1():\n    mutexA.acquire()\n    print(\"func1 \u62a2\u5230A\u9501\")\n    time.sleep(2)\n    mutexB.acquire()\n    print(\"func1 \u62a2\u5230B\u9501\")\n    mutexB.release()\n    mutexA.release()\n\n\ndef func2():\n    mutexB.acquire()\n    print(\"func2 \u62a2\u5230B\u9501\")\n    time.sleep(2)\n    mutexA.acquire()\n    print(\"func2 \u62a2\u5230A\u9501\")\n    mutexA.release()\n    mutexB.release()\n\n\nt1 = Thread(target=func1)\nt2 = Thread(target=func2)\nt1.start()\nt2.start()\n</code></pre> <p>\u9012\u5f52\u9501\u7684\u5c42\u7ea7\u8d8a\u591a\u6548\u7387\u8d8a\u4f4e\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_5","title":"\u4fe1\u53f7\u91cf","text":"<p>semaphore\u4fe1\u53f7\u91cf\u53ef\u4ee5\u901a\u8fc7\u5185\u7f6e\u8ba1\u6570\u5668\u6765\u63a7\u5236\u540c\u65f6\u8fd0\u884c\u7ebf\u7a0b\u7684\u6570\u91cf\uff0c\u542f\u52a8\u7ebf\u7a0b(\u6d88\u8017\u4fe1\u53f7\u91cf)\u5185\u7f6e\u8ba1\u6570\u5668\u4f1a\u81ea\u52a8\u51cf\u4e00\uff0c\u7ebf\u7a0b\u7ed3\u675f(\u91ca\u653e\u4fe1\u53f7\u91cf)\u5185\u7f6e\u8ba1\u6570\u5668\u4f1a\u81ea\u52a8\u52a0\u4e00\uff1b\u5185\u7f6e\u8ba1\u6570\u5668\u4e3a\u96f6\uff0c\u542f\u52a8\u7ebf\u7a0b\u4f1a\u963b\u585e\uff0c\u76f4\u5230\u6709\u672c\u7ebf\u7a0b\u7ed3\u675f\u6216\u8005\u5176\u4ed6\u7ebf\u7a0b\u7ed3\u675f\u4e3a\u6b62; </p> <pre><code>from threading import Thread, Semaphore\nimport time\nimport random\n\nsemaphore = Semaphore(5)  # # \u6dfb\u52a0\u4e00\u4e2a\u8ba1\u6570\u5668\uff0c\u6700\u5927\u5e76\u53d1\u7ebf\u7a0b\u6570\u91cf5(\u6700\u591a\u540c\u65f6\u8fd0\u884c5\u4e2a\u7ebf\u7a0b)\n\n\ndef task(name):\n    semaphore.acquire()\n    print(\"%s\u53f7\u6b63\u5728\u6267\u884c...\" % name)\n    time.sleep(random.randint(1, 5))\n    semaphore.release()\n\n\nif __name__ == '__main__':\n    for i in range(20):\n        t = Thread(target=task, args=(i,))\n        t.start()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#event","title":"Event\u4e8b\u4ef6","text":"<p>\u4e8b\u4ef6\u662f\u7528\u4e8e\u7ebf\u7a0b\u95f4\u901a\u4fe1\u7684\u5bf9\u8c61\u3002\u591a\u4e2a\u8fdb\u7a0b\u62e5\u6709\u540c\u4e00\u4e2aEvent\u5b9e\u4f8b\uff0c\u5f53\u8c03\u7528wait()\u65f6\u8fdb\u5165\u5230\u963b\u585e\u72b6\u6001\uff0c\u540c\u65f6\u4f1a\u8bbe\u7f6e\u963b\u585e\u6807\u8bb0\u4e3aFalse\uff08\u5f85\u963b\u585e\u6807\u8bb0\u4e3aTrue\u540e\u624d\u4f1a\u89e3\u9664\u963b\u585e\u72b6\u6001\uff09\uff0c\u6b64\u65f6\u53e6\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u7ee7\u7eed\u5de5\u4f5c\uff0c\u5e76\u4e14\u901a\u8fc7set()\u65b9\u6cd5\u5c06\u963b\u585e\u6807\u8bb0\u8bbe\u7f6e\u4e3aTrue\uff0c\u8fd9\u6837\u4e4b\u524d\u963b\u585e\u7684\u8fdb\u7a0b\u4f1a\u7ee7\u7eed\u6267\u884c\u3002</p> <pre><code>from threading import Thread, Event\nimport time\n\nevent = Event()\n\n\ndef light():\n    print('\u7ea2\u706f\u4eae')\n    time.sleep(3)\n    print('\u7eff\u706f\u4eae')\n    event.set()  # \u7eff\u706f\u4eae\n\n\ndef car(name):\n    print('\u8f66%s\u6b63\u5728\u7b49\u7eff\u706f' % name)\n    event.wait()  # \u7b49\u706f\u7eff \u6b64\u65f6event\u4e3aFalse,\u76f4\u5230event.set()\u5c06\u5176\u503c\u8bbe\u7f6e\u4e3aTrue,\u624d\u4f1a\u7ee7\u7eed\u8fd0\u884c.\n    print('\u8f66%s\u901a\u884c' % name)\n\n\nif __name__ == '__main__':\n    t1 = Thread(target=light)\n    t1.start()\n\n    for i in range(5):\n        t = Thread(target=car, args=(i,))\n        t.start()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_6","title":"\u5e76\u53d1\u7f16\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#5_2","title":"5. \u7ebf\u7a0b\u961f\u5217","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#51_1","title":"5.1 \u5148\u8fdb\u5148\u51fa\u961f\u5217","text":"<pre><code>import queue  # \u6570\u636e\u4e4b\u95f4\u7ebf\u7a0b\u5b89\u5168\u7684\u961f\u5217\u5bb9\u5668\n\nq = queue.Queue(3)  # FIFO \u5148\u8fdb\u5148\u51fa\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u961f\u5217\u5927\u5c0f\nq.put(1)\nq.put(2)\nq.put(3)\n\nprint(q.get())  # 1\nprint(q.get())  # 2\nprint(q.get())  # 3\ntry:\n    q.get_nowait()  # \u53d6\u4e0d\u5230\u6570\u636e\u65f6\u4e0d\u963b\u585e\uff0c\u629b\u51fa\u5f02\u5e38\nexcept queue.Empty:\n    pass\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#52_1","title":"5.2 \u540e\u8fdb\u5148\u51fa\u961f\u5217","text":"<pre><code>from queue import LifoQueue\n\nlq = LifoQueue()\nfor i in range(3):\n    lq.put(i)\n\nfor i in range(3):\n    print(lq.get())\n\n# \u8f93\u51fa\u7ed3\u679c\n# 2\n# 1\n# 0\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#53","title":"5.3 \u4f18\u5148\u7ea7\u961f\u5217","text":"<pre><code>from queue import PriorityQueue\n\npq = PriorityQueue()\n# (\u4f18\u5148\u7ea7,\u6570\u636e\u5185\u5bb9 )\npq.put((8,\"A\"))\npq.put((2,\"B\"))\n\nprint(pq.get())\nprint(pq.get())\n# \u8f93\u51fa\u7ed3\u679c\n# (2, 'B')\n# (8, 'A')\n</code></pre> <p>\u4f18\u5148\u7ea7\u6839\u636eASCII\u6392\u5e8f</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_7","title":"\u7ebf\u7a0b\u6c60","text":"<pre><code>from concurrent.futures import ThreadPoolExecutor\nfrom threading import current_thread\nimport time\nimport random\n\n\ndef func(i):\n    print(\"\u7b2c%s\u4e2a\u4efb\u52a1\uff0c\u8fdb\u7a0bID\u662f\uff1a%s\" % (i, current_thread().ident))\n    time.sleep(random.randint(1, 3))\n    return i * 2\n\n\ntp = ThreadPoolExecutor(4)  # \u5b9e\u4f8b\u5316\u7ebf\u7a0b\u6c60\uff0c\u4f20\u5165\u7ebf\u7a0b\u6c60\u4e2d\u7ebf\u7a0b\u6570\u91cf\n\nt_list = []\nfor i in range(10):\n    res = tp.submit(func, i)\n    # print(res.result())  # \u540c\u6b65\u63d0\u4ea4\n    t_list.append(res)\ntp.shutdown()  # \u5173\u95ed\u7ebf\u7a0b\u6c60\uff0c\u7b49\u5f85\u7ebf\u7a0b\u6c60\u4e2d\u6240\u6709\u7684\u4efb\u52a1\u8fd0\u884c\u5b8c\u6bd5\nfor t in t_list:\n    print('&gt;&gt;&gt;', t.result())\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#_8","title":"\u56db. \u534f\u7a0b","text":"<p>\u5355\u7ebf\u7a0b\u4e0b\u5b9e\u73b0\u5e76\u53d1\u3002\u51cf\u8f7b\u4e86\u64cd\u4f5c\u7cfb\u7edf\u7684\u8d1f\u62c5\uff0c\u53ef\u4ee5\u591a\u4e89\u53d6\u4e00\u4e9b\u65f6\u95f4\u7247\u6765\u88abCPU\u6267\u884c\uff0c\u63d0\u9ad8\u7a0b\u5e8f\u7684\u6548\u7387\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#1-gevent","title":"1. gevent","text":"<pre><code>from gevent import monkey\nmonkey.patch_all()\n# gevent\u6a21\u5757\u672c\u8eab\u65e0\u6cd5\u68c0\u6d4b\u5e38\u89c1\u7684IO\u64cd\u4f5c\uff0c\u9700\u8981\u5bfc\u5165monkey\nimport gevent\nimport time\n\n\ndef func():\n    print('start...')\n    time.sleep(1)\n    print('end...')\n\n\ng = gevent.spawn(func)\n# g.join()  # \u963b\u585e\u76f4\u5230\u534f\u7a0bg\u4efb\u52a1\u6267\u884c\u7ed3\u675f\ngevent.joinall([g, ])\n</code></pre> <p>\u57fa\u4e8egevent\u5b9e\u73b0socket\u5e76\u53d1</p> <p>server \u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\nfrom gevent import monkey\n\nmonkey.patch_all()\nimport socket\nimport gevent\n\n\ndef talk(conn):\n    while True:\n        try:\n            msg = conn.recv(1024).decode('utf-8')\n            conn.send(msg.upper().encode('utf-8'))\n        except ConnectionResetError:\n            break\n    conn.close()\n\n\ndef server():\n    sock = socket.socket()\n    sock.bind((\"127.0.0.1\", 8080))\n    sock.listen()\n    while True:\n        conn, addr = sock.accept()\n        gevent.spawn(talk, conn)\n    sock.close()\n\n\nif __name__ == '__main__':\n    gevent.spawn(server).join()\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\nimport time\n\nsock = socket.socket()\nsock.connect((\"127.0.0.1\", 8080))\nwhile True:\n    sock.send(b'hello')\n    content = sock.recv(1024).decode('utf-8')\n    print(content)\n    time.sleep(1)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#2-asyncio","title":"2. asyncio","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#21_4","title":"2.1 \u7528\u6cd5","text":"<pre><code>import asyncio\n\n# \u5b9a\u4e49\u534f\u7a0b\u51fd\u6570\nasync def func():\n    pass\n\n# \u521b\u5efa\u534f\u7a0b\u5bf9\u8c61\ntask = func()\n\n# \u5c06\u534f\u7a0b\u5bf9\u8c61\u4ea4\u7ed9\u4e8b\u4ef6\u5faa\u73af\nloop = asyncio.get_event_loop()\nloop.run_until_complete(task)\n\n# python3.7\u4ee5\u540e\n# asyncio.run(task)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#22-await","title":"2.2 await","text":"<p><code>await + \u53ef\u7b49\u5f85\u7684\u5bf9\u8c61\uff08\u534f\u7a0b\u5bf9\u8c61\u3001Future\u3001Task\u5bf9\u8c61\uff09</code></p> <pre><code>import asyncio\n\n\nasync def task():\n    print('start')\n    await asyncio.sleep(1)\n    print('end')\n\n\nasync def main():\n    result = await task()\n    print(result)\n\n\nasyncio.run(main())\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#23-task","title":"2.3 Task\u5bf9\u8c61","text":"<p>\u521b\u5efa\u591a\u4e2a\u4efb\u52a1</p> <pre><code>import asyncio\n\n\nasync def task():\n    print('task start')\n    await asyncio.sleep(2)  # await \u53ef\u80fd\u4f1a\u53d1\u751f\u963b\u585e\u7684\u65b9\u6cd5\n    print('task end')\n    return \"hello world\"\n\n\nasync def main():\n    print(\"main start\")\n    task_list = [\n        asyncio.create_task(task(), name=\"task-1\"),\n        asyncio.create_task(task(), name=\"task-2\")\n    ]\n    done, pending = await asyncio.wait(task_list)\n    print(\"main end\")\n    print(done)\n\n\nasyncio.run(main())\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>main start\ntask start\ntask start\ntask end\ntask end\nmain end\n{&lt;Task finished name='task-1' coro=&lt;task() done, defined at E:\\Project\\pythonProject\\main.py:4&gt; result='hello world'&gt;, &lt;Task finished name='task-2' coro=&lt;task() done, defined at E:\\Project\\pythonProject\\main.py:4&gt; result='hello world'&gt;}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/02-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/#24-future","title":"2.4 Future","text":"<p>Task\u7ee7\u627f\u4e86Future</p> <pre><code>import asyncio\n\n\nasync def task(fut):\n    print('task start')\n    await asyncio.sleep(2)\n    print('task end')\n    fut.set_result(123)\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n    fut = loop.create_future()\n    await loop.create_task(task(fut))\n    data = await fut\n    print(data)\nasyncio.run(main())\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>task start\ntask end\n123\n</code></pre> <p>\u5982\u679c\u4efb\u52a1\u4e0d\u652f\u6301\u5f02\u6b65</p> <pre><code>import time\nimport asyncio\n\n\ndef task(i):\n    time.sleep(2)\n    return i*i\n\n\nasync def main():\n    loop = asyncio.get_running_loop()\n    fut = loop.run_in_executor(None, task, 2)\n    data = await fut\n    print(data)\n\n\nasyncio.run(main())\n</code></pre> \u6570\u636e\u9694\u79bb \u5b89\u5168\u6027 \u5207\u6362\u65b9\u5f0f \u5f00\u9500 \u5229\u7528\u591a\u6838 \u7279\u70b9 \u8fdb\u7a0b \u9694\u79bb \u6570\u636e\u4e0d\u5b89\u5168 \u64cd\u4f5c\u7cfb\u7edf *** \u662f \u7ebf\u7a0b \u5171\u4eab \u6570\u636e\u4e0d\u5b89\u5168 \u64cd\u4f5c\u7cfb\u7edf ** \u5426 \u4e00\u4e9b\u548c\u6587\u4ef6\u64cd\u4f5c\u76f8\u5173\u7684IO\u53ea\u6709\u64cd\u4f5c\u7cfb\u7edf\u80fd\u591f\u611f\u77e5 \u534f\u7a0b \u5171\u4eab \u6570\u636e\u5b89\u5168 \u7528\u6237 * \u5426 \u53ea\u6709\u5728\u7528\u6237\u7ea7\u522b\u80fd\u591f\u611f\u77e5\u5230\u7684IO\u64cd\u4f5c\u624d\u4f1a\u7528\u534f\u7a0b\u6765\u505a\u5207\u6362\u6765\u89c4\u907f"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/","title":"\u7f51\u7edc\u7f16\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#socket","title":"\u4e00\u3001socket","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#1","title":"1. \u5957\u63a5\u5b57","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#11","title":"1.1 \u8d77\u6e90","text":"<p>\u5957\u63a5\u5b57\u7684\u8d77\u6e90\u53ef\u4ee5\u8ffd\u6eaf\u523020\u4e16\u7eaa70\u5e74\u4ee3\uff0c\u5b83\u662f\u52a0\u5229\u798f\u5c3c\u4e9a\u5927\u5b66\u7684\u4f2f\u514b\u5229\u7248\u672cUNIX\u7684\u4e00\u90e8\u5206\u3002\u5957\u63a5\u5b57\u6700\u521d\u662f\u4e3a\u540c\u4e00\u4e3b\u673a\u4e0a\u7684\u5e94\u7528\u7a0b\u5e8f\u6240\u521b\u5efa\uff0c\u4f7f\u5f97\u4e3b\u673a\u4e0a\u8fd0\u884c\u7684\u4e00\u4e2a\u7a0b\u5e8f\u4e0e\u53e6\u4e00\u4e2a\u8fd0\u884c\u7684\u7a0b\u5e8f\u8fdb\u884c\u901a\u4fe1\uff0c\u8fd9\u5c31\u662f\u6240\u8c13\u7684\u8fdb\u7a0b\u95f4\u901a\u4fe1\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#12","title":"1.2 \u5206\u7c7b","text":"<ul> <li>\u57fa\u4e8e\u6587\u4ef6\u7684\uff1aAF_UNIX\u5bb6\u65cf</li> <li>\u9762\u5411\u7f51\u7edc\u7684\uff1aAF_INET\u5bb6\u65cf\u3001AF_UNIX6(IPv6)</li> </ul>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#13","title":"1.3 \u5957\u63a5\u5b57\u7c7b\u578b","text":"<ol> <li> <p>\u9762\u5411\u8fde\u63a5\u7684\u5957\u63a5\u5b57\uff1a\u7528TCP\u534f\u8bae\u5b9e\u73b0\uff0cSOCK_STREAM\u4f5c\u4e3a\u5957\u63a5\u5b57\u7c7b\u578b</p> </li> <li> <p>\u65e0\u8fde\u63a5\u7684\u5957\u63a5\u5b57\uff1a\u7528UDP\u534f\u8bae\u5b9e\u73b0\uff0cSOCK_DGRAM\u4f5c\u4e3a\u5957\u63a5\u5b57\u7c7b\u578b</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#2-socket","title":"2. socket\u6a21\u5757","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#21","title":"2.1 \u4e00\u5bf9\u4e00\u7684\u8fde\u63a5","text":"<p>serser\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socket\n\nsock = socket.socket()\nsock.bind((\"127.0.0.1\", 8080))  # \u7533\u8bf7\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\nsock.listen()\n\nconn, addr = sock.accept()  # \nconn.send(b'hello')\nmsg = conn.recv(1024)\nprint(msg)  # b'Bye-Bye'\nconn.close()\n\nsock.close()  # \u5f52\u8fd8\u7533\u8bf7\u7684\u64cd\u4f5c\u7cfb\u7edf\u8d44\u6e90\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\n\nsock = socket.socket()\nsock.connect((\"127.0.0.1\", 8080))\n\nmsg = sock.recv(1024)\nprint(msg)  # b'hello'\nsock.send(b'Bye-Bye')\nsock.close()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#22","title":"2.2 \u4e00\u4e2a\u670d\u52a1\u7aef\u63a5\u6536\u591a\u4e2a\u5ba2\u6237\u7aef","text":"<p>server\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socket\n\nsock = socket.socket()\nsock.bind((\"127.0.0.1\", 8080))\nsock.listen()\n\nwhile True:  # \u548c\u591a\u4e2a\u5ba2\u6237\u7aef\u5efa\u7acb\u8fde\u63a5\n    conn, addr = sock.accept()\n    while True:\n        send_msg = input('&gt;&gt;&gt;')\n        conn.send(send_msg.encode('utf-8'))\n        if send_msg == \"q\":\n            break\n        msg = conn.recv(1024).decode('utf-8')\n        if msg == \"q\":\n            break\n        print(msg)\n\n    conn.close()  # \u65ad\u5f00\u548c\u5ba2\u6237\u7aef\u7684\u8fde\u63a5\n\n\n\nsock.close()\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\n\nsock = socket.socket()\nsock.connect((\"127.0.0.1\", 8080))\nwhile True:\n    msg = sock.recv(1024).decode('utf-8')\n    if msg == 'q':\n        break\n    print(msg)\n    send_msg = input('&gt;&gt;&gt;')\n    sock.send(send_msg.encode('utf-8'))\n    if send_msg == 'q':\n        break\nsock.close()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#udp","title":"UDP\u8fde\u63a5","text":"<p>server\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socket\n\nsock = socket.socket(type=socket.SOCK_DGRAM)\nsock.bind((\"127.0.0.1\", 8080))\nmsg, addr = sock.recvfrom(1024)\nprint(msg)\nsock.sendto(b'Bye', addr)\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\n\nsock = socket.socket(type=socket.SOCK_DGRAM)\nserver = (\"127.0.0.1\", 8080)\nsock.sendto(b'hello', server)\nmsg = sock.recv(1024)\nprint(msg)\n</code></pre> <p>\u4e00\u4e2a\u670d\u52a1\u7aef\u63a5\u6536\u591a\u4e2a\u5ba2\u6237\u7aef\u6d88\u606f</p> <p>server\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socket\n\nsock = socket.socket(type=socket.SOCK_DGRAM)\nsock.bind((\"127.0.0.1\", 8080))\nwhile True:\n    msg, addr = sock.recvfrom(1024)\n    print(msg.decode(\"utf-8\"))\n    send_msg = input(\"&gt;&gt;&gt;\")\n    sock.sendto(send_msg.encode(\"utf-8\"), addr)\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\n\nsock = socket.socket(type=socket.SOCK_DGRAM)\nserver = (\"127.0.0.1\", 8080)\nwhile True:\n    send_msg = input(\"&gt;&gt;&gt;\")\n    if send_msg == \"q\":\n        break\n    sock.sendto(send_msg.encode(\"utf-8\"), server)\n    msg = sock.recv(1024).decode(\"utf-8\")\n    if msg == \"q\":\n        break\n    print(msg)\n</code></pre> <p>\u7c98\u5305\u73b0\u8c61</p> <p>\u542b\u4e49\uff1a\u4e24\u6761\u8fde\u7eed\u53d1\u9001\u7684\u6570\u636e\u7c98\u8fde\u5728\u4e00\u8d77\u3002\u53ea\u4f1a\u51fa\u73b0\u5728TCP\u534f\u8bae\u4e2d\uff0c\u7531\u4e8eTCP\u7684\u4f20\u8f93\u662f\u6d41\u5f0f\u4f20\u8f93\uff0c\u6570\u636e\u548c\u6570\u636e\u4e4b\u95f4\u6ca1\u6709\u8fb9\u754c\u3002</p> <p>\u539f\u56e0\uff1a</p> <ol> <li>\u4e24\u6761\u6d88\u606f\u5f88\u77ed\uff0c\u5e76\u4e14\u53d1\u9001\u95f4\u9694\u5f88\u77ed</li> <li>\u63a5\u6536\u7aef\u63a5\u6536\u4e0d\u53ca\u65f6</li> </ol> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socket\n\nsock = socket.socket()\nsock.bind((\"127.0.0.1\", 8080))\nsock.listen()\n\nconn, addr = sock.accept()\nconn.send(b'hello')\nconn.send(b'world')\nconn.close()\n\nsock.close()\n</code></pre> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\nimport time\n\nsock = socket.socket()\nsock.connect((\"127.0.0.1\",8080))\ntime.sleep(0.1)\nmsg1 = sock.recv(1024)\nprint(msg1)  # b'helloworld'\nmsg2 = sock.recv(1024)\nprint(msg2)  # b''\n\nsock.close()\n</code></pre> <p>\u89e3\u51b3\uff1a</p> <ol> <li>\u8ba1\u7b97\u5373\u5c06\u8981\u53d1\u9001\u7684\u6570\u636e\u7684\u957f\u5ea6\uff0c\u901a\u8fc7struct\u6a21\u5757\u5c06\u957f\u5ea6\u8f6c\u6362\u6210\u56fa\u5b9a\u76844\u4e2a\u5b57\u8282\uff0c\u5c06\u8f6c\u6362\u540e\u7684\u5b57\u8282\u53d1\u9001\u7ed9\u5ba2\u6237\u7aef</li> <li>\u5ba2\u6237\u7aef\u63a5\u65364\u4e2a\u5b57\u8282\uff0c\u518d\u4f7f\u7528stract.unpack\u628a4\u4e2a\u5b57\u8282\u8f6c\u6362\u6210\u6570\u5b57\uff0c\u8fd9\u4e2a\u6570\u5b57\u5c31\u662f\u5373\u5c06\u8981\u63a5\u6536\u7684\u6570\u636e\u7684\u957f\u5ea6\u3002\u7136\u540e\u518d\u6839\u636e\u6570\u636e\u957f\u5ea6\u63a5\u6536\u6570\u636e</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#socketserver","title":"\u4e8c\u3001socketserver","text":"<p>socketserver\u57fa\u4e8esocket\u5b8c\u6210\u7684\uff0c\u7528\u5728TCP\u534f\u8bae\u4e0bserver\u7aef\u5904\u7406\u5e76\u53d1\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u3002</p> <p>server\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: server.py\n\nimport socketserver\nimport time\n\n\nclass MyServer(socketserver.BaseRequestHandler):\n    def handle(self):\n        conn = self.request  # &lt;socket.socket fd=496, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 8080), raddr=('127.0.0.1', 52789)&gt;\n        while True:\n            try:\n                content = conn.recv(1024).decode(\"utf-8\")\n                conn.send(content.upper().encode(\"utf-8\"))\n                time.sleep(1)\n            except ConnectionResetError:\n                break\n\n\nserver = socketserver.ThreadingTCPServer((\"127.0.0.1\", 8080), MyServer)\nserver.serve_forever()\n</code></pre> <p>client\u7aef</p> <pre><code>#!/usr/bin/env python3\n# _*_ coding:utf-8 _*_\n# filename: client.py\n\nimport socket\n\nsock = socket.socket()\nsock.connect((\"127.0.0.1\", 8080))\nwhile True:\n    sock.send(b'hello')\n    content = sock.recv(1024).decode('utf-8')\n    print(content)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#http","title":"\u4e09\u3001HTTP","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#1-urllib","title":"1. urllib","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#get","title":"get\u8bf7\u6c42","text":"<pre><code>import urllib.request\n\nurl = 'http://www.baidu.com/'\nresponse = urllib.request.urlopen(url)\nprint(response) # &lt;http.client.HTTPResponse object at 0x000002D28D124F60&gt;\ndata = response.read().decode('utf-8')\nwith open('baidu.html', 'w', encoding='utf-8') as f:\n    f.write(data)\n</code></pre> <pre><code>import urllib.request\n\nurl = 'https://www.baidu.com/'\n# \u6dfb\u52a0\u8bf7\u6c42\u5934\u4fe1\u606f\uff0c\u6a21\u62df\u771f\u5b9e\u6d4f\u89c8\u5668\u8bbf\u95ee\nheader = {\n    # \u6d4f\u89c8\u5668\u7248\u672c\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\",\n}\n\n# \u521b\u5efa\u4e00\u4e2a\u8bf7\u6c42\u5bf9\u8c61\nr = urllib.request.Request(url, headers=header)\n# \u83b7\u53d6\u6240\u6709\u8bf7\u6c42\u5934\u4fe1\u606f\nprint(r.headers)\n# \u83b7\u53d6\u6307\u5b9a\u8bf7\u6c42\u5934\u4fe1\u606f(\u952e\u7684\u9996\u5b57\u6bcd\u8981\u5927\u5199\uff0c\u5176\u4ed6\u5c0f\u5199)\nprint(r.get_header(\"User-agent\"))\n# \u83b7\u53d6\u8bf7\u6c42\u7684url\nprint(r.get_full_url())\n\n# \u8bf7\u6c42\u6570\u636e\nresponse =urllib.request.urlopen(r)\ndata = response.read().decode('utf-8')\nwith open('baidu.html', 'w', encoding='utf-8') as f:\n    f.write(data)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#ip","title":"IP\u4ee3\u7406","text":"<p>urlopen()\u4e0d\u652f\u6301\u6dfb\u52a0\u4ee3\u7406\uff0c\u9700\u8981\u81ea\u5df1\u5b9a\u4e49</p> <pre><code>import urllib.request\n\nurl = 'https://www.cnblogs.com/gaoyuanzhi'\n\n# \u6dfb\u52a0\u4ee3\u7406\nproxy = {\n    \"http\":\"http://117.88.5.142:3000\"\n}\nproxy_handler = urllib.request.ProxyHandler(proxy)\n# \u521b\u5efa\u81ea\u5df1\u7684opener\nopener = urllib.request.build_opener(proxy_handler)\n# \u62ff\u7740\u4ee3\u7406IP\u53bb\u53d1\u9001\u8bf7\u6c42\nresponse = opener.open(url)\ndata = response.read().decode('utf-8')\nprint(data)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#cookies","title":"Cookies","text":"<pre><code>import urllib.request\nimport urllib.parse\nfrom http import cookiejar\n\n# \u5148\u767b\u5f55\uff0c\u518d\u5e26\u7740Cookie\u8bbf\u95ee\n\n# \u767b\u5f55\u7f51\u5740\nlogin_url = \"https://www.yaozh.com/login/\"\n# \u767b\u5f55\u53c2\u6570\nlogin_data = {\n    'username': 'gaoyuanzhi',\n    'pwd': '',\n    'formhash': '5798AB70BB',\n    'backurl': 'https%3A%2F%2Fwww.yaozh.com%2F'\n}\n# \u53c2\u6570\u9700\u8981\u8f6c\u7801,POST\u8bf7\u6c42\u9700\u8981\u4f7f\u7528byte\u7c7b\u578b\ndata = urllib.parse.urlencode(login_data).encode('utf-8')\n\nheader = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\",\n}\n\n# \u4fdd\u5b58cookie\ncookie_jar = cookiejar.CookieJar()\n# \u5b9a\u4e49\u6709\u6dfb\u52a0cookie\u529f\u80fd\u7684\u5904\u7406\u5668\ncookie_handler = urllib.request.HTTPCookieProcessor(cookie_jar)\n# \u6839\u636e\u5904\u7406\u5668\u751f\u6210opener\nopener = urllib.request.build_opener(cookie_handler)\n\nlogin_request = urllib.request.Request(login_url, headers=header, data=data)\n# \u53d1\u8d77\u767b\u5f55\u8bf7\u6c42\nopener.open(login_request)\n\ncenter = 'https://www.yaozh.com/member/'\ncenter_request = urllib.request.Request(center, headers=header)\n# \u767b\u5f55\u5230\u4e2a\u4eba\u4e2d\u5fc3\nresponse = opener.open(center_request)\ndata = response.read().decode('utf-8')\nwith open('yaozhi.html', 'w', encoding='utf-8') as f:\n    f.write(data)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#2-requests","title":"2. requests","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#get_1","title":"get","text":"<pre><code>import requests\nurl = 'http://www.baidu.com'\n\nresponse = requests.get(url)\nprint(response) # &lt;Response [200]&gt;\ndata = response.content.decode('utf-8')\nprint(type(data)) # &lt;class 'str'&gt;\nprint(response.status_code) # 200\n</code></pre> <pre><code>import requests\nurl = 'http://www.baidu.com'\nheader = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\",\n}\nresponse = requests.get(url, headers=header)\nprint('\u54cd\u5e94\u72b6\u6001\u7801:',response.status_code)\nprint('\u8bf7\u6c42\u5934:',response.request.headers)\nprint('\u54cd\u5e94\u5934:',response.headers)\nprint('cookie:',response.cookies)\nprint('\u5b9e\u9645\u8bf7\u6c42\u7684url',response.url)\n</code></pre> <p>get\u8bf7\u6c42\u5e26\u53c2\u6570</p> <pre><code>import requests\npayload = {'key1': 'value1', 'key2': 'value2'}\nr = requests.get(\"http://httpbin.org/get\", params=payload)\nprint(r.url)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#_2","title":"\u4ee3\u7406","text":"<pre><code>import requests\n\nurl = 'https://www.cnblogs.com/gaoyuanzhi' # \u8bbf\u95ee\u767e\u5ea6\u8fd4\u56de500\nheader = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\",\n}\nfree_proxy = {\n    'http':'101.231.104.82:80'\n}\n\nresponse = requests.get(url=url, headers=header, proxies=free_proxy)\nprint(response.status_code) # 200\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#ssl","title":"\u5ffd\u7565SSL\u8ba4\u8bc1","text":"<pre><code>import requests\n\nurl = 'https://www.12306.cn' # 2020-3-2\u8bbf\u95ee\u65f6\uff0cCA\u5df2\u7ecf\u4fe1\u4efb\u4e86\nheader = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\",\n}\n# \u5ffd\u7565CA\u8bc1\u4e66\u8ba4\u8bc1\nresponse = requests.get(url=url, headers=header, verify=False)\ndata = response.content.decode()\nwith open('12306.html', 'w', encoding='utf-8') as f:\n    f.write(data)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/#cookies_1","title":"cookies","text":"<pre><code>import requests\n\nmember_url = 'https://www.yaozh.com/member/'\nlogin_url = \"https://www.yaozh.com/login/\"\nheader = {\n    \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\",\n}\n\nlogin_data = {\n    'username': 'xxxxxx',\n    'pwd': 'xxxxxxx',\n    'formhash': 'xxxxxxx',\n    'backurl': 'https%3A%2F%2Fwww.yaozh.com%2F'\n}\n\n# \u53ef\u4ee5\u81ea\u52a8\u4fdd\u5b58cookie\ns = requests.Session()\nlogin_response = s.post(login_url, data=login_data, headers=header)\n\ndata = s.get(member_url, headers=header).content.decode()\nwith open('yaozhi.html', 'w', encoding='utf-8') as f:\n    f.write(data)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/","title":"\u6d41\u7a0b\u63a7\u5236","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#if","title":"\u4e00\u3001if\u8bed\u53e5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#1","title":"1. \u8bed\u6cd5\u683c\u5f0f","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#11","title":"1.1 \u683c\u5f0f\u4e00","text":"<pre><code>if \u6761\u4ef6:\n    statements\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#12","title":"1.2 \u683c\u5f0f\u4e8c","text":"<pre><code>if \u6761\u4ef6:\n    statements1\nelse:\n    statements2\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#13","title":"1.3 \u683c\u5f0f\u4e09","text":"<pre><code>if \u6761\u4ef61:\n    statements1\nelif \u6761\u4ef62:\n    statements2\nelse:\n    statements3\n</code></pre> <p>\u793a\u4f8b\uff1a</p> <pre><code>score = float(input('\u8bf7\u8f93\u5165\u6210\u7ee9: '))\nif score &gt;= 90:\n    grade = 'A'\nelif score &gt;= 80:\n    grade = 'B'\nelif score &gt;= 70:\n    grade = 'C'\nelif score &gt;= 60:\n    grade = 'D'\nelse:\n    grade = 'E'\nprint('\u5bf9\u5e94\u7684\u7b49\u7ea7\u662f:', grade)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#2","title":"2. \u4e09\u5143\u8868\u8fbe\u5f0f","text":"<pre><code># \u77ed\u8def\u8fd0\u7b97\nA = Y if X else Z\n\n# \u7b49\u4ef7\u4e8e\nif X:\n    A = Y\nelse:\n    A = Z\n</code></pre> <p>\u6761\u4ef6\u53ef\u4ee5\u662f\u4efb\u610f\u8868\u8fbe\u5f0f\uff0c\u4f46\u6267\u884c\u7ed3\u679c\u5fc5\u987b\u4e3a\u5e03\u5c14\u7c7b\u578b\uff08\u5728if\u5224\u65ad\u4e2d\u6240\u6709\u7684\u6570\u636e\u7c7b\u578b\u4e5f\u90fd\u4f1a\u81ea\u52a8\u8f6c\u6362\u6210\u5e03\u5c14\u7c7b\u578b\uff0cNone\uff0c0\uff0c\u7a7a\uff08\u7a7a\u5b57\u7b26\u4e32\u3001\u7a7a\u5217\u8868\u3001\u7a7a\u5b57\u5178\u7b49\uff09\u4e09\u79cd\u60c5\u51b5\u4e0b\u8f6c\u6362\u6210\u7684\u5e03\u5c14\u503c\u4e3aFalse\uff0c\u5176\u4f59\u5747\u4e3aTrue\uff09</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#while","title":"\u4e8c\u3001while\u5faa\u73af","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#1_1","title":"1. \u8bed\u6cd5\u683c\u5f0f","text":"<pre><code>while \u6761\u4ef6:\n    statements\nelse\n    statements\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#2_1","title":"2. \u7528\u6cd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#21","title":"2.1 \u4e00\u822c\u7528\u6cd5","text":"<pre><code>num = 0\nwhile num &lt; 10:\n    if num % 2 == 0:\n        print(num)\n    num += 1\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#22-break","title":"2.2 break","text":"<pre><code>count = 0\nwhile count &lt; 3:\n    inp_name = input(\"username:\")\n    inp_passwd = input(\"password:\")\n    if inp_name == 'Tom' and inp_passwd == '123':\n        print(\"\u767b\u5f55\u6210\u529f\uff01\")\n        break\n    else:\n        print(\"\u767b\u5f55\u5931\u8d25\uff01\")\n        count += 1\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#23-continue","title":"2.3 continue","text":"<p>\u7528\u4e8e\u7ed3\u675f\u672c\u6b21\u5faa\u73af\uff0c\u76f4\u63a5\u8fdb\u5165\u4e0b\u4e00\u6b21\u5faa\u73af</p> <pre><code># \u6253\u53701\u523010\u4e4b\u95f4\uff0c\u96647\u4ee5\u5916\u7684\u6240\u6709\u6570\u5b57\nnumber = 11\nwhile number &gt; 1:\n    number -= 1\n    if number == 7:\n        continue  # \u7ed3\u675f\u6389\u672c\u6b21\u5faa\u73af\uff0c\u5373\u672c\u6b21\u5faa\u73afcontinue\u4e4b\u540e\u7684\u4ee3\u7801\u90fd\u4e0d\u4f1a\u8fd0\u884c\u4e86\uff0c\u800c\u662f\u76f4\u63a5\u8fdb\u5165\u4e0b\u4e00\u6b21\u5faa\u73af\n    print(number)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#24-else","title":"2.4 else","text":"<p>\u5f53\u4e14\u4ec5\u5f53\u5faa\u73af\u6b63\u5e38\u79bb\u5f00\u65f6\u624d\u4f1a\u6267\u884c</p> <pre><code>#!/usr/bin/env python3\ncnt = 0\nwhile cnt &lt; 3:\n    username = input(\"user: \")\n    password = input(\"password: \")\n    if username == 'admin' and password == 'admin':\n        print('\u767b\u9646\u6210\u529f')\n        break\n    else:\n        print('\u767b\u9646\u5931\u8d25\uff0c\u8fd8\u6709{}\u6b21\u673a\u4f1a\u3002'.format(2-cnt))\n    cnt+=1\nelse:\n    print('\u8d85\u8fc7\u91cd\u8bd5\u6b21\u6570\uff01')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#for","title":"\u4e09\u3001for\u5faa\u73af","text":"<p>for\u5faa\u73af\u5728python\u4e2d\u662f\u4e00\u4e2a\u901a\u7528\u8fed\u4ee3\u5668\uff0c\u53ef\u4ee5\u904d\u5386\u4efb\u4f55\u6709\u5e8f\u5e8f\u5217\u6216\u5176\u4ed6\u53ef\u8fed\u4ee3\u5bf9\u8c61\u5185\u7684\u5143\u7d20\u3002for\u5faa\u73af\u5728\u5faa\u73af\u53d6\u503c\uff08\u904d\u5386\u53d6\u503c\uff09\u6bd4while\u5faa\u73af\u66f4\u7b80\u6d01\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#1_2","title":"1. \u8bed\u6cd5\u683c\u5f0f","text":"<pre><code>for \u53d8\u91cf\u540d in \u53ef\u8fed\u4ee3\u5bf9\u8c61:\n    statements\nelse:\n    statements\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#2_2","title":"2. \u7528\u6cd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#21_1","title":"2.1 \u4e00\u822c\u7528\u6cd5","text":"<pre><code># \u4e5d\u4e5d\u4e58\u6cd5\u8868\nfor i in range(1, 10):\n    for j in range(1, i + 1):\n        print('%s*%s=%s' % (i, j, i * j), end=' ')\n    print()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#22-break_1","title":"2.2 break","text":"<p>\u540c<code>while</code>\uff0c\u7ec8\u6b62for\u5faa\u73af\u53ea\u80fd\u4f7f\u7528break\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#23-continue_1","title":"2.3 continue","text":"<p>\u540c<code>while</code></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/03-%E9%80%BB%E8%BE%91%E6%8E%A7%E5%88%B6/#24-else_1","title":"2.4 else","text":"<p>\u540c<code>while</code></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/","title":"\u51fd\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#1","title":"1. \u51fd\u6570\u7684\u4f5c\u7528","text":"<ol> <li>\u4ee3\u7801\u91cd\u7528\uff0c\u51cf\u5c11\u4ee3\u7801\u5197\u4f59</li> <li>\u6d41\u7a0b\u5206\u89e3</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#2","title":"2. \u51fd\u6570\u5206\u7c7b","text":"<ol> <li>\u5185\u7f6e\u51fd\u6570</li> <li>\u81ea\u5b9a\u4e49\u51fd\u6570</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#3","title":"3. \u51fd\u6570\u7684\u5b9a\u4e49","text":"<pre><code>def \u51fd\u6570\u540d(arg1, arg2, ...):\n    \"\"\"\u63cf\u8ff0\"\"\"\n    \u51fd\u6570\u4f53\n    return value\n</code></pre> <p>\u7a0b\u5e8f\u8fd0\u884c\u65f6\u4f1a\u521b\u5efa\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61\u5e76\u5c06\u5176\u8d4b\u503c\u7ed9\u4e00\u4e2a\u53d8\u91cf\u540d\uff0c\u901a\u8fc7\u5728\u51fd\u6570\u540d\u540e\u52a0\u62ec\u53f7\u8c03\u7528\u8fd9\u4e2a\u51fd\u6570\u3002</p> <pre><code>&gt;&gt;&gt; def bar():\n...     print(\"bar\")\n...\n&gt;&gt;&gt; print(bar)\n&lt;function bar at 0x000002AEFFF01EA0&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#4","title":"4. \u51fd\u6570\u7684\u53c2\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#41","title":"4.1 \u65e0\u53c2\u6570","text":"<pre><code>def bar():\n    print(\"bar\")\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#42","title":"4.2 \u4f4d\u7f6e\u53c2\u6570","text":"<pre><code>def add(x,y):\n    print (x+y)\nadd(3,5)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#43","title":"4.3 \u9ed8\u8ba4\u53c2\u6570","text":"<pre><code>def student(name, age=21):\n    print('Name:',name)\n    print('Age:',age)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#44","title":"4.4 \u53ef\u53d8\u53c2\u6570","text":"<pre><code># \u4f20\u5165\u7684\u53c2\u6570\u4e2a\u6570\u662f\u53ef\u53d8\u7684\uff0c\u53ef\u4ee5\u662f 1 \u4e2a\u30012 \u4e2a\u5230\u4efb\u610f\u4e2a\uff0c\u8fd8\u53ef\u4ee5\u662f 0 \u4e2a\ndef calc(*numbers):\n    sum = 0\n    for n in numbers:\n        sum = sum + n * n\n    return sum\nprint(calc(1, 2, 3))\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#45","title":"4.5 \u5173\u952e\u5b57\u53c2\u6570","text":"<pre><code># \u5173\u952e\u5b57\u53c2\u6570\u5728\u51fd\u6570\u5185\u90e8\u81ea\u52a8\u7ec4\u88c5\u4e3a\u4e00\u4e2a dict\ndef student(name, age, **kwargs):\n    print('Name:', name)\n    print('Age:', age)\n    print('other:', kwargs)\n\nstudent('\u5f20\u4e09', 13, sex='boy')\n###\u8fd0\u884c\u7ed3\u679c###\nName: \u5f20\u4e09\nAge: 13\nother: {'sex': 'boy'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#46","title":"4.6 \u547d\u540d\u5173\u952e\u5b57\u53c2\u6570","text":"<pre><code># *\u540e\u9762\u7684\u53c2\u6570\u88ab\u89c6\u4e3a\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570,\u53ea\u63a5\u6536 city \u548c job \u4f5c\u4e3a\u5173\u952e\u5b57\u53c2\u6570\ndef person(name, age, *, city, job):\n    print(name, age, city, job)\n\nperson('\u5f20\u4e09', 18, city=\"xi'an\", job='IT')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#47","title":"4.7 \u7ec4\u5408\u53c2\u6570","text":"<p>\u53c2\u6570\u987a\u5e8f\uff1a\u5fc5\u9009\u53c2\u6570\u3001\u9ed8\u8ba4\u53c2\u6570\u3001\u53ef\u53d8\u53c2\u6570/\u547d\u540d\u5173\u952e\u5b57\u53c2\u6570\u548c\u5173\u952e\u5b57\u53c2\u6570</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#5-legb","title":"5. \u4f5c\u7528\u57df\u6cd5\u5219LEGB","text":"<ol> <li>L-Local(function)\uff1b\u51fd\u6570\u5185\u7684\u540d\u5b57\u7a7a\u95f4</li> <li>E-Enclosing function locals\uff1b\u5916\u90e8\u5d4c\u5957\u51fd\u6570\u7684\u540d\u5b57\u7a7a\u95f4(\u4f8b\u5982closure)</li> <li>G-Global(module)\uff1b\u51fd\u6570\u5b9a\u4e49\u6240\u5728\u6a21\u5757\uff08\u6587\u4ef6\uff09\u7684\u540d\u5b57\u7a7a\u95f4</li> <li>B-Builtin(Python)\uff1bPython\u5185\u7f6e\u6a21\u5757\u7684\u540d\u5b57\u7a7a\u95f4</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#6","title":"6. \u51fd\u6570\u7684\u8fd4\u56de\u503c","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#61-none","title":"6.1 \u9ed8\u8ba4\u8fd4\u56deNone","text":"<pre><code>&gt;&gt;&gt; def bar():\n...     print (\"hello\")\n...\n&gt;&gt;&gt; f = bar()\nhello\n&gt;&gt;&gt; print(f)\nNone\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#62","title":"6.2  \u6307\u5b9a\u8fd4\u56de\u503c","text":"<pre><code>&gt;&gt;&gt; def bar():\n...     print(\"hello\")\n...     return 1\n...\n&gt;&gt;&gt; f = bar()\nhello\n&gt;&gt;&gt; print(f)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#63","title":"6.3  \u8fd4\u56de\u8ba1\u7b97\u7ed3\u679c","text":"<pre><code>&gt;&gt;&gt; def bar(x,y):\n...     return x + y\n...\n&gt;&gt;&gt; f = bar(1,2)\n&gt;&gt;&gt; print(f)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#64","title":"6.4  \u7ed3\u675f\u51fd\u6570","text":"<pre><code>&gt;&gt;&gt; def bar():\n...     print(\"hello\")\n...     return 1\n...     print(\"world\")\n&gt;&gt;&gt; bar()\nhello\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#65","title":"6.5 \u8fd4\u56de\u5143\u7ec4","text":"<pre><code># \u7528\u9017\u53f7\u5206\u9694\u5f00\u591a\u4e2a\u503c\uff0c\u4f1a\u88abreturn\u8fd4\u56de\u6210\u5143\u7ec4\n&gt;&gt;&gt; def bar(x,y):\n...     return x,y\n...\n&gt;&gt;&gt; bar(1,2)\n(1, 2)\n</code></pre> <p>return\u7684\u4f5c\u7528</p> <ol> <li>\u7ed3\u675f\u51fd\u6570</li> <li>\u5c06\u4e00\u4e2a\u7ed3\u679c\u5bf9\u8c61\u4f20\u56de\u7ed9\u8c03\u7528\u8005</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#7-closure","title":"7. \u95ed\u5305(closure)","text":"<p>\u5728\u4e00\u4e2a\u5185\u90e8\u51fd\u6570\u5bf9\u5728\u5916\u90e8\u7684\u4f5c\u7528\u7684\u4f5c\u7528\u57df\u8fdb\u884c\u4e00\u4e2a\u5f15\u7528\uff0c\u90a3\u4e48\u5185\u90e8\u51fd\u6570\u5c31\u662f\u4e00\u4e2a\u95ed\u5305</p> <pre><code>&gt;&gt;&gt; def maker(N):\n...     def action(X):    #\u4e00\u4e2a\u5185\u90e8\u51fd\u6570\n...         return X ** N  #N\u4e3a\u4e0a\u7ea7\u51fd\u6570\u7684\u4e00\u4e2a\u53d8\u91cf\n...     return action\n...\n&gt;&gt;&gt; f = maker(2)\n&gt;&gt;&gt; f\n&lt;function maker.&lt;locals&gt;.action at 0x000002C47A1E2A60&gt;\n&gt;&gt;&gt; f(3)\n</code></pre> <p>\u95ed\u5305\u7684\u4e09\u4e2a\u7279\u70b9\uff1a</p> <ol> <li>\u95ed\u5305\u51fd\u6570\u5fc5\u987b\u6709\u5185\u5d4c\u51fd\u6570</li> <li>\u5185\u5d4c\u51fd\u6570\u9700\u8981\u5f15\u7528\u8be5\u5d4c\u5957\u51fd\u6570\u4e0a\u4e00\u7ea7<code>namespace</code>\u4e2d\u7684\u53d8\u91cf</li> <li>\u95ed\u5305\u51fd\u6570\u5fc5\u987b\u8fd4\u56de\u5185\u5d4c\u51fd\u6570</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#8","title":"8. \u9ad8\u9636\u51fd\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#81","title":"8.1 \u53d8\u91cf\u540d\u53ef\u4ee5\u6307\u5411\u51fd\u6570","text":"<pre><code>&gt;&gt;&gt; abs(-10)\n&gt;&gt;&gt; f = abs\n&gt;&gt;&gt; f(-10)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#82","title":"8.2 \u51fd\u6570\u540d\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u51fd\u6570\u7684\u53c2\u6570","text":"<pre><code>&gt;&gt;&gt; def bar(x,y,f):\n...     return f(x)+f(y)\n...\n&gt;&gt;&gt; bar(-5,-3,abs)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#83","title":"8.3 \u51fd\u6570\u540d\u53ef\u4ee5\u4f5c\u4e3a\u8fd4\u56de\u503c","text":"<pre><code>&gt;&gt;&gt; def bar():\n...     def foo():\n...         return \"hello\"\n...     return foo\n...\n&gt;&gt;&gt; bar()\n&lt;function bar.&lt;locals&gt;.foo at 0x00000194EED32A60&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#9-decorator","title":"9. \u88c5\u9970\u5668\uff08Decorator\uff09","text":"<p>\u5f00\u653e\u5c01\u95ed\u539f\u5219\uff1a</p> <p>\u5f00\u653e\uff1a\u5bf9\u4ee3\u7801\u7684\u6269\u5c55\u5f00\u653e \u200b\u5c01\u95ed\uff1a\u5bf9\u4ee3\u7801\u7684\u4fee\u6539\u5c01\u95ed</p> <p>\u88c5\u9970\u5668\u5b8c\u5168\u9075\u5faa\u5f00\u653e\u5c01\u95ed\u539f\u5219\u3002\u5728\u4e0d\u6539\u53d8\u539f\u51fd\u6570\u7684\u4ee3\u7801\u4ee5\u53ca\u8c03\u7528\u65b9\u5f0f\u7684\u524d\u63d0\u4e0b\uff0c\u4e3a\u5176\u589e\u52a0\u4ee3\u7801\u529f\u80fd\u3002</p> <p>\u88c5\u9970\u5668\u4e09\u8981\u7d20\uff1aLEGB\u3001\u9ad8\u9636\u51fd\u6570\u3001\u95ed\u5305</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#91","title":"9.1 \u65e0\u53c2\u88c5\u9970\u5668","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#911","title":"9.1.1 \u88c5\u9970\u5668\u5b9e\u73b0\u601d\u8def","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#hello","title":"\u7b2c\u4e00\u6b65\uff1a\u7edf\u8ba1hello\u51fd\u6570\u6267\u884c\u7684\u65f6\u95f4","text":"<pre><code>def hello():\n    print(\"hello\")\n# \u51fd\u6570\u540d\u53ef\u4ee5\u4f5c\u4e3a\u5176\u4ed6\u51fd\u6570\u7684\u53c2\u6570\ndef show_time(func):\n    print(\"------------\")\n    func()\n    print(\"------------\")\n\nshow_time(hello)\n# \u6216\u8005\u5982\u4e0b\n# hello = show_time(hello)\n# hello\n# \u4f46\u8c03\u7528\u65b9\u5f0f\u8fd8\u662f\u53d1\u751f\u4e86\u6539\u53d8\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#_2","title":"\u7b2c\u4e8c\u6b65\uff1a\u4fdd\u7559\u51fd\u6570\u8c03\u7528\u65b9\u5f0f","text":"<p>\u5982\u679c\u628a\u4e00\u4e2a\u51fd\u6570\u540d\u8d4b\u503c\u7ed9hello\uff0chello()\u5c31\u53ef\u4ee5\u6267\u884c\u51fd\u6570\u4e86\uff0c\u5173\u952e\u95ee\u9898\u662f\u5982\u4f55\u8ba9show_time(hello)\u4f5c\u4e3a\u51fd\u6570\u540d\u8d4b\u503c\u7ed9hello</p> <p>\u60f3\u60f3\u9ad8\u9636\u51fd\u6570\u4e2d\u51fd\u6570\u540d\u53ef\u4ee5\u4f5c\u4e3a\u8fd4\u56de\u503c\u8fd4\u56de\u7684\u7279\u6027 \u53ef\u4ee5\u628a\u4e0a\u8ff0\u7684\u51fd\u6570\u6539\u4e3a\u5982\u4e0b</p> <pre><code>def hello():\n    print(\"hello\")\n\ndef show_time(func):\n    def inner():\n        print(\"------------\")\n        func()\n        print(\"------------\")\n    return inner    #\u6b64\u65f6\u5982\u679c\u8c03\u7528show_time\uff0c\u8fd4\u56de\u7684\u5c31\u662finner\u51fd\u6570\u7684\u51fd\u6570\u540d\n\nhello=show_time(hello) #\u5c06inner\u51fd\u6570\u8d4b\u503c\u7ed9hello\nhello()  #\u5b9e\u9645\u6267\u884c\u7684\u662finner\u51fd\u6570\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#func","title":"\u7b2c\u4e09\u6b65\uff1a \u8bed\u6cd5\u7cd6<code>@func</code>","text":"<p>\u5728python\u4e2dhello=show_time(hello)\u53ef\u4ee5\u5199\u4e3a@show_time\uff0c\u5982\u4e0b</p> <pre><code>def show_time(func):\n    def inner():\n        print(\"------------\")\n        func()\n        print(\"------------\")\n    return inner\n\n@show_time # hello=show_time(hello)\ndef hello():\n    print(\"hello\")\nhello()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#92","title":"9.2 \u88ab\u88c5\u9970\u51fd\u6570\u7684\u53c2\u6570","text":"<pre><code>def show_time(func):\n    def inner(name):\n        print(\"------------\")\n        func(name)\n        print(\"------------\")\n    return inner\n\n@show_time\ndef hello(name):\n    print(\"hello\",name)\n\nhello('Bob')\n</code></pre> <p>\u4f7f\u7528<code>*args,**kwargs</code>\u7ec4\u5408\u6765\u6ee1\u8db3\u88ab\u88c5\u9970\u51fd\u6570\u53c2\u6570\u7684\u6240\u6709\u60c5\u51b5 </p> <pre><code>def wrapper(func):\n    def inner(*args, **kwargs):\n        res = func(*args, **kwargs)\n        return res\n    return inner\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#92_1","title":"9.2 \u6709\u53c2\u88c5\u9970\u5668","text":"<p>\u7ed9\u88c5\u9970\u5668\u52a0\u53c2\u6570\u6765\u5b9e\u73b0\u4e0d\u540c\u7684\u529f\u80fd\u3002</p> <pre><code>import time\ndef logger(flag=''):\n    def show_time(func):\n        def inner(*args,**kwargs):\n            start = time.time()\n            time.sleep(1)\n            func(*args,**kwargs)\n            end = time.time()\n            print('running time:',end - start)\n            if flag == 'true':\n                print('this is loggger')\n        return inner\n    return show_time\n\n@logger('true')\ndef foo(*args,**kwargs):\n    sums = 0\n    for i in args:\n        sums += i\n    print(sums)\n\n@logger()\ndef bar():\n    print('bar..')\n\nfoo(1,2,3)\nbar()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#93","title":"9.3  \u4fdd\u7559\u539f\u51fd\u6570\u7684\u6587\u6863\u548c\u51fd\u6570\u540d\u5c5e\u6027","text":"<p><code>functools.wraps</code>\u7684\u4f5c\u7528</p> <pre><code>def show_time(func):\n    def inner(name):\n        print(\"------------\")\n        func(name)\n        print(\"------------\")\n\n    return inner\n\n\n@show_time\ndef hello(name):\n    '''\n    say hello\n    :param name:\n    :return:\n    '''\n    print(\"hello\", name)\n\n\nprint(hello.__name__)\nprint('----------')\nprint(help(hello)) # \u4f7f\u7528help(\u51fd\u6570\u540d)\u6765\u67e5\u770b\u51fd\u6570\u7684\u6587\u6863\u6ce8\u91ca,\u539f\u51fd\u6570\u7684\u540d\u79f0\u53d8\u6210\u4e86inner\uff0c\u4e0d\u662f\u539f\u6765\u7684hello\n####\u8fd0\u884c\u7ed3\u679c####\ninner\n----------\nHelp on function inner in module __main__:\n\ninner(name)\n\nNone\n</code></pre> <p>\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u65b9\u5f0f\u6765\u4fee\u6b63\u88c5\u9970\u5668\uff1a</p> <pre><code>def show_time(func):\n    def inner(name):\n        print(\"------------\")\n        func(name)\n        print(\"------------\")\n\n    inner.__doc__ = func.__doc__\n    inner.__name__ = func.__name__\n    return inner\n</code></pre> <p>\u6309\u7167\u4e0a\u8ff0\u65b9\u5f0f\u6765\u5b9e\u73b0\u4fdd\u7559\u539f\u51fd\u6570\u5c5e\u6027\u8fc7\u4e8e\u9ebb\u70e6\uff0c<code>functools</code>\u6a21\u5757\u4e0b\u63d0\u4f9b\u4e00\u4e2a\u88c5\u9970\u5668wraps\u4e13\u95e8\u7528\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898\u3002</p> <pre><code>from functools import wraps\n\ndef show_time(func):\n    @wraps(func)\n    def inner(name):\n        print(\"------------\")\n        func(name)\n        print(\"------------\")\n    return inner\n\n@show_time\ndef hello(name):\n    print(\"hello\",name)\n\nprint(hello.__name__)\n####\u8fd0\u884c\u7ed3\u679c####\n&gt;&gt;hello\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#93_1","title":"9.3 \u591a\u4e2a\u88c5\u9970\u5668\u53e0\u52a0","text":"<pre><code>def deco1(func1):  # func1 = wrapper2\u7684\u5185\u5b58\u5730\u5740\n    def wrapper1(*args, **kwargs):\n        print(\"deco1.wrapper1\u5f00\u59cb\u6267\u884c\uff0cfunc1\uff1a\", func1)  # &lt;function deco2.&lt;locals&gt;.wrapper2 at 0x0000021CB8462EA0&gt;\n        res = func1(*args, **kwargs)\n        print(\"deco1.wrapper1\u6267\u884c\u7ed3\u675f\")\n        return res\n\n    return wrapper1\n\n\ndef deco2(func2):  # func2 = wrapper3\u7684\u5185\u5b58\u5730\u5740\n    def wrapper2(*args, **kwargs):\n        print(\"deco1.wrapper2\u5f00\u59cb\u6267\u884c\uff0cfunc2\uff1a\", func2)  # &lt;function deco3.&lt;locals&gt;.wrapper3 at 0x0000021CB8462D90&gt;\n        res = func2(*args, **kwargs)\n        print(\"deco1.wrapper2\u6267\u884c\u7ed3\u675f\")\n        return res\n\n    return wrapper2\n\n\ndef deco3(func3):  # func3 = \u88ab\u88c5\u9970\u5bf9\u8c61foo\u7684\u5185\u5b58\u5730\u5740\n    def wrapper3(*args, **kwargs):\n        print(\"deco1.wrapper3\u5f00\u59cb\u6267\u884c\uff0cfunc3\uff1a\", func3)  # &lt;function foo at 0x0000022282592E18&gt;\n        res = func3(*args, **kwargs)\n        print(\"deco1.wrapper3\u6267\u884c\u7ed3\u675f\")\n        return res\n\n    return wrapper3\n\n\n@deco1  # foo = deco2(wrapper2\u7684\u5185\u5b58\u5730\u5740)\n@deco2  # foo = deco2(wrapper3\u7684\u5185\u5b58\u5730\u5740)\n@deco3  # foo = deco3(foo) ==&gt; foo = deco3(\u88ab\u88c5\u9970\u5bf9\u8c61foo\u7684\u5185\u5b58\u5730\u5740)\ndef foo():\n    print(\"hello world!\")\n\n\nprint('foo:', foo)\n\nfoo()\n\n# \u52a0\u8f7d\u987a\u5e8f\u81ea\u4e0b\u800c\u4e0a\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>foo: &lt;function deco1.&lt;locals&gt;.wrapper1 at 0x00000176D6512F28&gt;\ndeco1.wrapper1\u5f00\u59cb\u6267\u884c\uff0cfunc1\uff1a &lt;function deco2.&lt;locals&gt;.wrapper2 at 0x00000176D6512EA0&gt;\ndeco1.wrapper2\u5f00\u59cb\u6267\u884c\uff0cfunc2\uff1a &lt;function deco3.&lt;locals&gt;.wrapper3 at 0x00000176D6512D90&gt;\ndeco1.wrapper3\u5f00\u59cb\u6267\u884c\uff0cfunc3\uff1a &lt;function foo at 0x00000176D6512E18&gt;\nhello world!\ndeco1.wrapper3\u6267\u884c\u7ed3\u675f\ndeco1.wrapper2\u6267\u884c\u7ed3\u675f\ndeco1.wrapper1\u6267\u884c\u7ed3\u675f\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#10-global-nonlocal","title":"10 <code>global</code> \u548c <code>nonlocal</code>","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#101-global","title":"10.1 global","text":"<pre><code>x = 88\ndef bar():\n    global x\n    x = 99\nbar()\nprint (x)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#102-nonlocal","title":"10.2 nonlocal","text":"<p>\u7528\u4e8e\u5d4c\u5957\u51fd\u6570\u4e2d\uff0c\u53ea\u4f5c\u7528\u4e8e\u5916\u5c42\u51fd\u6570\u7684\u4f5c\u7528\u57df\u4e2d\uff0c\u800c\u4e0d\u662f\u5168\u5c40</p> <pre><code>def bar():\n    x = 1\n    def foo():\n        nonlocal x\n        x += 1\n    foo()\n    print(x)\n\nbar()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#11","title":"11 \u533f\u540d\u51fd\u6570","text":"<p><code>lambda \u5f62\u53c2:\u8fd4\u56de\u503c</code></p> <pre><code>&gt;&gt;&gt; f = lambda a,b:a+b\n&gt;&gt;&gt; f(1,2)\n3\n</code></pre> <p>\u533f\u540d\u7528\u4e8e\u4e34\u65f6\u8c03\u7528\u4e00\u6b21\u7684\u573a\u666f\uff1a\u66f4\u591a\u7684\u662f\u5c06\u533f\u540d\u4e0e\u5176\u4ed6\u51fd\u6570\u914d\u5408\u4f7f\u7528</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#12","title":"12 \u51fd\u6570\u5f0f\u7f16\u7a0b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#121-map","title":"12.1 <code>map</code>","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#122-filter","title":"12.2 <code>filter</code>","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#123-reduce","title":"12.3 <code>reduce</code>","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/04-%E5%87%BD%E6%95%B0/#13","title":"13 \u51fd\u6570\u7684\u591a\u6001","text":"<p>\u51fd\u6570\u4e2dx,y\u7684\u610f\u4e49\u5b8c\u5168\u53d6\u51b3\u4e8ex\u548cy\u7684\u5bf9\u8c61\u7c7b\u578b</p> <pre><code>def add(x,y):\n    print (x+y)\n\nadd(3,5)  # \u52a0\u6cd5\nadd('hello','world') # \u5b57\u7b26\u4e32\u62fc\u63a5\n</code></pre> <p>\u7ed9\u51fd\u6570\u9644\u52a0\u5c5e\u6027</p> <pre><code>foo():\n    pass\n\nfoo.name = 'root'\n\nprint(foo.name)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/","title":"\u9762\u5411\u5bf9\u8c61","text":"<p>\u9762\u5411\u5bf9\u8c61\uff08OOP, Object-Oriented Programing\uff09\uff0c\u662f\u4e00\u79cd\u7f16\u7a0b\u65b9\u5f0f\uff08\u51fd\u6570\u5f0f\u7f16\u7a0b\u548c\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\uff09\u4e2d\u7684\u4e00\u79cd\uff0c\u53ef\u4ee5\u964d\u4f4e\u4ee3\u7801\u5197\u4f59\u7a0b\u5ea6\u3002python\u4e2d\u7684\u7c7b\u662f\u9762\u5411\u5bf9\u8c61\u7f16\u7a0b\u7684\u4e00\u79cd\u5de5\u5177\uff0c\u662f\u9664\u51fd\u6570\u548c\u6a21\u5757\u4e4b\u5916\u7684\u53e6\u4e00\u79cd\u5c01\u88c5\u903b\u8f91\u548c\u6570\u636e\u7684\u65b9\u5f0f\u3002</p> <p>\u7c7b\u548c\u5b9e\u4f8b\u7684\u533a\u522b\uff1a</p> <ol> <li>python\u4e2d\u7c7b\u548c\u5b9e\u4f8b\u662f\u4e24\u79cd\u4e0d\u540c\u7684\u5bf9\u8c61</li> <li>\u7c7b\u662f\u62bd\u8c61\u7684\u6a21\u677f\uff0c\u5b9e\u4f8b\u662f\u6839\u636e\u7c7b\u521b\u5efa\u51fa\u6765\u7684\u4e00\u4e2a\u4e2a\u5177\u4f53\u7684\u201c\u5bf9\u8c61\u201d</li> <li>\u7c7b\u548c\u5b9e\u4f8b\u90fd\u6709\u72ec\u7acb\u7684\u547d\u540d\u7a7a\u95f4</li> </ol> <p>\u9762\u5411\u5bf9\u8c61\u7684\u4e09\u5927\u601d\u60f3</p> <ol> <li>\u7ee7\u627f</li> <li>\u591a\u6001 \u57fa\u4e8e\u5bf9\u8c61\u63a5\u53e3\u800c\u4e0d\u662f\u7c7b\u578b</li> <li>\u5c01\u88c5</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#1","title":"1. \u7c7b\u7684\u5b9a\u4e49\u4e0e\u5b9e\u4f8b\u5316","text":"<p>python\u4e2d\u4f7f\u7528<code>class</code>\u5173\u952e\u5b57\u6765\u5b9a\u4e49\u4e00\u4e2a\u7c7b\u3002</p> <pre><code>class \u7c7b\u540d:\n    pass\n</code></pre> <p>\u7c7b\u540d\u7684\u547d\u540d\u89c4\u5219\uff1a\u4ee5\u5927\u5199\u5b57\u6bcd\u5f00\u5934</p> <p>\u5b9e\u4f8b\u5316\u4e00\u4e2a\u7c7b:<code>\u5b9e\u4f8b\u540d = \u7c7b\u540d(\u53c2\u6570)</code></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#2","title":"2. \u7c7b\u7684\u6210\u5458","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#1_1","title":"1. \u5c5e\u6027","text":"<p>\u5c5e\u6027\u7684\u65b9\u6cd5\u65b9\u6cd5\uff1a<code>\u5b9e\u4f8b\u540d.\u5c5e\u6027\u540d</code></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#11","title":"1.1 \u5b9e\u4f8b\u5c5e\u6027","text":"<p>\u7531\u65b9\u6cd5\u5185\u90e8\u7684self\u5c5e\u6027\u8fdb\u884c\u8d4b\u503c\u8fd0\u7b97\u4ea7\u751f\uff0c\u4fdd\u5b58\u5728\u5bf9\u8c61\uff08\u5b9e\u4f8b\uff09\u4e2d\uff0c\u6267\u884c\u53ea\u80fd\u901a\u8fc7\u5bf9\u8c61\u8bbf\u95ee\u3002</p> <pre><code>class Person:\n\n    def __init__(self, name):\n        # 1. \u5728\u7c7b\u7684\u5185\u90e8\u5b9a\u4e49\u5c5e\u6027\n        self.name = name\n\ntom = Person('Tom')\nprint(tom.name) # Tom\n# 2. \u5728\u7c7b\u7684\u5916\u90e8\u5b9a\u4e49\u5c5e\u6027\ntom.age = '18'\nprint(tom.age) # 18\n\nJerry = Person('Jerry')\nprint(Jerry.name) # Jerry\nprint(Jerry.age) # AttributeError: 'Person' object has no attribute 'age'\n</code></pre> <p>tom \u548c Jerry\u4e24\u4e2a\u5bf9\u8c61\u5c5e\u4e8e\u4e24\u4e2a\u4e0d\u540c\u7684\u547d\u540d\u7a7a\u95f4\uff0c\u7ed9Tom\u6dfb\u52a0\u7684age\u5c5e\u6027\u5728Jerry\u5bf9\u8c61\u4e2d\u5e76\u4e0d\u80fd\u8bbf\u95ee\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#12","title":"1.2 \u7c7b\u5c5e\u6027","text":"<p>\u901a\u8fc7class\u8bed\u53e5\u5185\u7684\u8d4b\u503c\u8bed\u53e5\u521b\u5efa\uff0c\u4fdd\u5b58\u5728\u7c7b\u4e2d\uff0c\u6267\u884c\u65f6\u53ef\u4ee5\u901a\u8fc7\u5bf9\u8c61\u8bbf\u95ee\uff0c\u4e5f\u53ef\u4ee5\u901a\u8fc7\u7c7b\u8bbf\u95ee</p> <pre><code>class Person:\n    country = 'America'\n\n    def __init__(self, name):\n        self.name = name\n\nTom = Person('Tom')\n\n# \u901a\u8fc7\u5b9e\u4f8b\u8bbf\u95ee\u7c7b\u5c5e\u6027\nprint(Tom.country)  # America\n\n# \u901a\u8fc7\u7c7b\u8bbf\u95ee\u7c7b\u5c5e\u6027\nprint(Person.country) # America\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#13","title":"1.3 \u79c1\u6709\u5c5e\u6027","text":"<p>\u5728Python\u4e2d\uff0c\u5b9e\u4f8b\u7684\u53d8\u91cf\u540d\u5982\u679c\u4ee5<code>__</code>\u5f00\u5934\uff0c\u5c31\u53d8\u6210\u4e86\u4e00\u4e2a\u79c1\u6709\u53d8\u91cf\uff08private\uff09\uff0c\u53ea\u6709\u5185\u90e8\u53ef\u4ee5\u8bbf\u95ee\uff0c\u5916\u90e8\u4e0d\u80fd\u8bbf\u95ee\uff0c\u786e\u4fdd\u4e86\u5916\u90e8\u4ee3\u7801\u4e0d\u80fd\u968f\u610f\u4fee\u6539\u5bf9\u8c61\u5185\u90e8\u7684\u72b6\u6001\uff0c\u4f46\u662f\u53ef\u4ee5\u95f4\u63a5\u8bbf\u95ee\u3002</p> <pre><code>class Person:\n\n    def __init__(self, name):\n        self.__name = name\n    def get_name(self):\n        return self.__name\nTom = Person('Tom')\n# \u76f4\u63a5\u8bbf\u95ee\u62a5\u9519\n# print(Tom.name)  # AttributeError: 'Person' object has no attribute 'name'\n\nprint(Tom.get_name()) # Tom\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#2_1","title":"2. \u65b9\u6cd5","text":"<p>\u4f4d\u4e8e\u7c7b\u4e2d\u7684\u51fd\u6570\u79f0\u4e3a\u65b9\u6cd5\u3002\u00b7</p> <p>\u7c7b\u65b9\u6cd5\u8c03\u7528\u7684\u7b2c\u4e8c\u79cd\u65b9\u5f0f\uff1a<code>class.method(instance, args,...)</code>\uff0c\u4e8b\u5b9e\u4e0a\uff0c<code>instance.method(args...)</code>\u8fd8\u662f\u4f1a\u7ffb\u8bd1\u6210\u8fd9\u79cd\u65b9\u5f0f\u6765\u8c03\u7528</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#1_2","title":"1. \u6784\u9020\u65b9\u6cd5","text":"<p>\u4f5c\u7528\uff1a</p> <ol> <li>\u521d\u59cb\u5316\u5b9e\u4f8b\u5c5e\u6027</li> <li>\u6267\u884c\u5176\u4ed6\u521d\u59cb\u5316\u4efb\u52a1</li> <li>\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u65f6\u81ea\u52a8\u8fd0\u884c</li> </ol> <pre><code>class Bar:\n    def __init__(self,name,age):\n        self.n = name\n        self.a = age\n        print('\u521b\u5efa\u5bf9\u8c61\u65f6\u81ea\u52a8\u6267\u884c\u6784\u9020\u65b9\u6cd5')\n    def foo(self):\n        print(self.n,self.a)\n\nobj = Bar(\"Tom\",10) # \u521b\u5efa\u5bf9\u8c61\u65f6\u81ea\u52a8\u6267\u884c\u6784\u9020\u65b9\u6cd5\nobj.foo() # Tom 10\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#2_2","title":"2. \u666e\u901a\u65b9\u6cd5","text":"<p>\u4fdd\u5b58\u5728\u7c7b\u4e2d\uff0c\u7531\u5bf9\u8c61\u8c03\u7528</p> <pre><code>class Bar:\n    def __init__(self):\n        pass\n    def hello(self):\n        print('hello world!')\n\nobj = Bar()\nobj.hello() # hello world!\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#3","title":"3. \u79c1\u6709\u65b9\u6cd5","text":"<pre><code>class Bar:\n    def __init__(self):\n        pass\n    def __hello(self):\n        print('hello world!')\n    def foo(self):\n        self.__hello()\nobj = Bar()\nobj.foo()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#4-self","title":"4. self\u53c2\u6570","text":"<p>\u7c7b\u5728\u521b\u5efa\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u5728\u5185\u5b58\u4e2d\u5f00\u8f9f\u4e00\u4e2a\u5c5e\u4e8e\u7c7b\u7684\u7a7a\u95f4\uff0c\u5f53\u521b\u5efa\u4e00\u4e2a\u5b9e\u4f8b\u7684\u65f6\u5019\u4e5f\u4f1a\u521b\u5efa\u5c5e\u4e8e\u5b9e\u4f8b\u7684\u7a7a\u95f4\uff0c\u5f53\u5b9e\u4f8b\u9700\u8981\u6267\u884c\u7c7b\u4e2d\u7684\u65b9\u6cd5\uff0c\u56de\u53bb\u627e\u7c7b\u7a7a\u95f4\u76f8\u5e94\u7684\u65b9\u6cd5\uff0c\u65b9\u6cd5\u4e2d\u7684self\u53c2\u6570\uff0c\u63a5\u6536\u7684\u5c31\u662f\u5b9e\u4f8b\u672c\u8eab\u3002\u6240\u4ee5self\u4ee3\u6307\u8c03\u7528\u65b9\u6cd5\u7684\u5b9e\u4f8b\u5bf9\u8c61</p> <p>\u5b9e\u4f8b\u65f6\u65b9\u6cd5\u8c03\u7528\u7684\u4e3b\u4f53\uff0c\u5e76\u4e14\u4f1a\u81ea\u52a8\u4f20\u5165\u7ed9\u65b9\u6cd5\u7684self\u53c2\u6570\uff0c\u628a\u5b9e\u4f8b\u4f20\u5165\u7ed9\u7b2c\u4e00\u4e2a\u53c2\u6570\u4ece\u800c\u544a\u8bc9\u65b9\u6cd5\u5e94\u8be5\u5904\u7406\u54ea\u4e00\u4e2a\u5b9e\u4f8b\u3002</p> <pre><code>class Bar:\n    def foo(self):\n        print(\"self id:\",id(self))\n\nobj = Bar()\nprint(\"obj  id:\",id(obj)) # obj  id: 2018867963888\nobj.foo()        # self id: 2018867963888\n\n# self \u548c obj \u662f\u540c\u4e00\u4e2a\u4e1c\u897f\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#3_1","title":"3. \u7ee7\u627f","text":"<p>\u4e00\u4e2a\u7c7b\u7ee7\u627f\u53e6\u4e00\u4e2a\u7c7b\u65f6\uff0c\u5b83\u5c06\u81ea\u52a8\u83b7\u5f97\u53e6\u4e00\u4e2a\u7c7b\u7684\u6240\u6709\u5c5e\u6027\u548c\u65b9\u6cd5\uff1b\u539f\u6709\u7684\u7c7b\u79f0\u4e3a\u7236\u7c7b\uff08\u57fa\u7c7b\uff09\uff0c\u65b0\u7c7b\u79f0\u4e3a\u5b50\u7c7b\uff08\u6d3e\u751f\u7c7b\uff09\u3002\u5b50\u7c7b\u8fd8\u53ef\u4ee5\u81ea\u5b9a\u4e49\u81ea\u5df1\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#31","title":"3.1 \u7ee7\u627f","text":"<pre><code>class Animal:\n    def run(self):\n        print(\"Animal is running...\")\nclass Cat(Animal):\n    pass\n\nTom = Cat()\nTom.run() # Animal is running...\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#32","title":"3.2 \u6269\u5c55","text":"<p>\u5728\u7236\u7c7b\u7684\u65b9\u6cd5\u4e0a\u6dfb\u52a0\u65b0\u7684\u529f\u80fd\u3002</p> <pre><code>class Person:\n    def __init__(self,name,age):\n        self.name = name\n        self.age = age\n    def pay(self, base):\n        print(\"\u5e94\u53d1\u5de5\u8d44\uff1a%s\" % money)\n\nclass Manager(Person):\n    def pay(self, base, commission):\n        Person.pay(self, base+commission)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#33","title":"3.3 \u91cd\u5199","text":"<pre><code>class Animal:\n    def run(self):\n        print(\"Animal is running...\")\n\nclass Cat(Animal):\n    def run(self):\n        print('Cat is running...')\n\nTom = Cat()\nTom.run() # Cat is running...\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#34","title":"3.4 \u7ec4\u5408","text":"<p>\u4e00\u4e2a\u7c7bA\u4e2d\uff0c\u4f7f\u7528\u53e6\u4e00\u4e2a\u7c7bB\u7684\u5b9e\u4f8b\u5bf9\u8c61\u4f5c\u4e3a\u7c7bA\u7684\u5c5e\u6027\u3002</p> <pre><code>class Date():\n    '''date'''\n    def __init__(self, year, month, day):\n        self.year = year\n        self.month = month\n        self.day = day\n\nclass Person:\n    def __init__(self, name, date):\n        self.name = name\n        self.birthday = date\n    def show_birthday(self):\n        print(\"%s:%s-%s-%s\" %(self.name, self.birthday.year, self.birthday.month, self.birthday.day))\n\nJerry = Person('Jerry',Date('1999','2','14'))\nJerry.show_birthday() # Jerry:1999-2-14\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#35-super","title":"3.5 <code>super()</code>","text":"<pre><code>class A:\n    def func(self):\n        print(\"This is A\")\n\nclass B(A):\n    def func(self):\n        super().func()\n        # A.func(self) # \u53e6\u4e00\u79cd\u7684\u5199\u6cd5\n        print(\"This is B\")\n\nb = B()\nb.func()  \n# \u8f93\u51fa\u7ed3\u679c\n# This is A\n# This is B\n</code></pre> <p>super\u5b89\u88c5MRO\u987a\u5e8f\u6765\u5bfb\u627e\u5f53\u524d\u7c7b\u7684\u4e0b\u4e00\u4e2a\u7c7b</p> <p>python2\u65b0\u5f0f\u7c7b:super(\u5b50\u7c7b\u540d,self).\u51fd\u6570\u540d()</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#36","title":"3.6 \u62bd\u8c61\u7c7b","text":"<pre><code>from abc import ABCMeta, abstractclassmethod\n\nclass Super(metaclass=ABCMeta):\n    def __init__(self):\n        pass\n\n    @abstractclassmethod\n    def action(self):\n        pass\n\nclass Sub(Super):\n    def action(self):\n        print(\"hello\")\n\nx = Sub()\nx.action() # hello\n</code></pre> <p>action\u51fd\u6570\u5fc5\u987b\u5728\u5b50\u7c7b\u4e2d\u5b9a\u4e49\uff0c\u5426\u5219\u4f1a\u62a5\u9519 TypeError: Can't instantiate abstract class Sub with abstract methods action</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#37","title":"3.7 \u591a\u7ee7\u627f","text":"<ol> <li>\u4ece\u5de6\u5230\u53f3</li> <li>\u4ece\u4e0b\u5230\u4e0a</li> <li>\u5e7f\u5ea6\u4f18\u5148</li> </ol> <p>\u4f8b1\uff1a</p> <pre><code>class F:\n    def bar(self):\n        print('F.bar')\n\nclass F1(F):\n    def boo(self):\n        print('F1.bar')\n\nclass F2:\n    def bar(self):\n        print('F2.bar')\n\nclass S(F1,F2):            #\u4ece\u4e0b\u5f80\u4e0a\u627e\n    pass\n\nobj = S()\nobj.bar()\n#############\nF.bar\n</code></pre> <p>\u4f8b2\uff1a</p> <pre><code>class F1:\n    def bar(self):\n        print('F1.bar')\n\nclass F2:\n    def bar(self):\n        print('F2.bar')\n\nclass S(F2,F1):         #\u4ece\u5de6\u5f80\u53f3\u627e\n    pass\n\nobj = S()\nobj.bar()\n###########\nF2.bar\n</code></pre> <p>\u4f8b3\uff1a</p> <pre><code>class Base:\n    def bar(self):\n        print('Base.bar')\n\nclass F(Base):\n    def foo(self):\n        print('F.bar')\n\nclass F1(F):\n    def foo(self):\n        print('F1.bar')\n\nclass F2(Base):\n    def bar(self):\n        print('F2.bar')\n\nclass S(F1,F2):\n    pass\n\nobj = S()\nobj.bar()   #\u6709\u5171\u540c\u7684\u7236\u7c7b\uff0c\u6700\u540e\u5728\u7236\u7c7b\u4e2d\u627e\n############\nF2.bar\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#37_1","title":"3.7   \u7ecf\u5178\u7c7b\u548c\u65b0\u5f0f\u7c7b","text":"<p>python2.x\uff1a\u9ed8\u8ba4\u662f\u7ecf\u5178\u7c7b\uff0c\u641c\u7d22\u7b97\u6cd5\u4e3aDFLR(Depth First,Left to Right)\uff0c\u6df1\u5ea6\u4f18\u5148\u3002\u7ee7\u627f<code>object</code>\u540e\u662f\u65b0\u5f0f\u7c7b</p> <p>python3.x\uff1a\u6ca1\u6709\u7ecf\u5178\u7c7b\uff0c\u90fd\u662f\u65b0\u5f0f\u7c7b\uff0c\u9690\u5f0f\u7ee7\u627f<code>object</code>\u7c7b\uff0c\u641c\u7d22\u7b97\u6cd5\u4e3a MRO(method resolution order)\uff0c\u5e7f\u5ea6\u4f18\u70b9\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#4","title":"4. \u591a\u6001\u548c\u591a\u6001\u6027","text":"<p>Python3.7\u4e4b\u591a\u6001\u4e0e\u591a\u6001\u6027 - \u5f69\u8679\u7136 - \u535a\u5ba2\u56ed (cnblogs.com) </p> <p>\u591a\u6001\uff1a\u591a\u6001\u662f\u6307\u8fd0\u7b97\u7684\u610f\u4e49\u53d6\u51b3\u4e8e\u8fd0\u7b97\u7684\u5bf9\u8c61\u3002\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u4ee3\u7801\u4e0d\u5e94\u8be5\u5173\u5fc3\u5b83\u5904\u7406\u7684\u5bf9\u8c61\u662f\u4ec0\u4e48\uff0c\u800c\u5e94\u8be5\u5173\u6ce8\u8fd9\u4e2a\u5bf9\u8c61\u505a\u4ec0\u4e48\uff09\u3002\u591a\u6001\u53ef\u4ee5\u7528\u6765\u9690\u85cf\u63a5\u53e3\u5dee\u5f02\u6027\u3002</p> <pre><code>class Animals:\n    def talk(self):\n        pass\n\n\nclass Cat(Animals):\n    def talk(self):\n        print(\"Meow...\")\n\n\nclass Dog(Animals):\n    def talk(self):\n        print(\"Woof!...\")\n\n\nclass Person(Animals):\n    def talk(self):\n        print(\"Ying...\")\n\n\ndef func(animal):\n    # \u4e0d\u7528\u5173\u5fc3\u662f\u4ec0\u4e48\u52a8\u7269\uff0c\u53ea\u8981\u662f\u4e2a\u52a8\u7269\u5c31\u5e94\u8be5\u53eb\u3002\n    animal.talk()\n\n\nxiaoming = Person()\nxiaohei = Cat()\nxiaohuang = Dog()\n\nfor i in [xiaoming, xiaohei, xiaohuang]:\n    func(i)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#6","title":"6. \u88c5\u9970\u5668","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#61-property","title":"6.1 <code>@property</code>","text":"<p>\u628a\u65b9\u6cd5\u53d8\u6210\u5c5e\u6027\u3002</p> <pre><code>class Bar:\n    def __init__(self):\n        pass\n    # \u5c5e\u6027\n    @property\n    def foo(self):\n        return 1\n\n    @foo.setter\n    def foo(self,val):\n        print(val,\"setter\")\n\n    @foo.deleter\n    def foo(self):\n        print(\"delete\")\n\nobj = Bar()\nobj.foo=123  #\u6267\u884c\u8d4b\u503c\u8bed\u53e5\u5c06\u6267\u884c@foo.setter\u4e0b\u5bf9\u5e94\u7684\u65b9\u6cd5\ndel obj.foo #\u6267\u884c@foo.deleter\u4e0b\u5bf9\u5e94\u7684\u65b9\u6cd5\n\n############\nsetter\ndelete\n</code></pre> <p>\u4f8b1:</p> <pre><code>class Page:\n    def __init__(self,page):\n        try:\n            p = int(page)\n        except Exception as e:\n            p = 1\n        self.page = p\n    @property\n    def start(self):\n        val = (self.page-1) * 10\n        return val\n    @property\n    def end(self):\n        val = self.page * 10\n        return val\n\nli = []\nfor i in range(1000):\n    li.append(i)\nwhile True:\n    p = input(\"\u8bf7\u8f93\u5165\u9875\u7801\uff1a\")\n    if p == \"q\":\n        break\n    obj = Page(p)\n    print(li[obj.start:obj.end])\n</code></pre> <p>\u4f8b2\uff1a\u5c5e\u6027\u7684\u53e6\u4e00\u79cd\u8868\u793a\u65b9\u6cd5</p> <pre><code>class Bar:\n\n    def f1(self):\n        return 1\n    def f2(self,val):\n        print('f2:',val)\n    def f3(self):\n        print(\"f3:del\")\n    per = property(fget=f1,fset=f2,fdel=f3,doc=\"\u6ce8\u91ca\")\n\nobj = Bar()\nprint(obj.per)\nobj.per = 123\ndel obj.per\n###########\nf2: 123\nf3:del\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#62-staticmethod","title":"6.2 <code>@staticmethod</code>","text":"<p>\u9759\u6001\u65b9\u6cd5\uff0c\u4e0d\u9700\u8981\u521b\u5efa\u5bf9\u8c61\uff0c\u4e0d\u4f1a\u9690\u5f0f\u4f20\u9012self\u3002\u5b9e\u4f8b\u5bf9\u8c61\u548c\u7c7b\u5bf9\u8c61\u90fd\u53ef\u4ee5\u8c03\u7528\u3002\u5f53\u65b9\u6cd5\u548c\u5b9e\u4f8b\u65e0\u76f8\u5173\u6027\u65f6\u4f7f\u7528\u3002</p> <pre><code>import time\nclass Person:\n    country = 'China'\n\n    def __init__(self,name,age):\n        self.name = name\n        self.age = age\n    @staticmethod\n    def show_time():\n        print(time.strftime(\"%Y-%m-%d %H:%M:%S\" ))\n\nPerson.show_time() # 2020-02-15 19:17:53\nTom = Person('Tom', 18)\nTom.show_time() # 2020-02-15 19:17:53\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#63-classmethod","title":"6.3 <code>@classmethod</code>","text":"<p>\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u662f\u5f53\u524d\u7c7b\u5bf9\u8c61\uff0c\u8be5\u53c2\u6570\u540d\u4e00\u822c\u7ea6\u5b9a\u4e3a<code>cls</code>\uff0c\u901a\u8fc7\u5b83\u6765\u4f20\u9012\u7c7b\u7684\u5c5e\u6027\u548c\u65b9\u6cd5\u3002\u5b9e\u4f8b\u5bf9\u8c61\u548c\u7c7b\u5bf9\u8c61\u90fd\u53ef\u4ee5\u8c03\u7528\u3002\u5728\u5b9e\u4f8b\u5316\u4e4b\u524d\u4fee\u6539\u7c7b\u5c5e\u6027\u7684\u65f6\u5019\u4f7f\u7528\u3002</p> <pre><code>import time\nclass Date:\n    def __init__(self, year, month, day):\n        self.year = year\n        self.month = month\n        self.day = day\n\n    @classmethod\n    def today(cls):\n        struct_time = time.localtime()\n        date = cls(struct_time.tm_year, struct_time.tm_mon, struct_time.tm_mday) # \u81ea\u5df1\u7c7b\u7684\u5b9e\u4f8b\u5316\n        return date\n\ntoday = Date.today()\nprint(today.year,today.month,today.day) # 2020 2 15\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#7","title":"7. \u53cd\u5c04","text":"<p>\u7528\u5b57\u7b26\u4e32\u6570\u636e\u7c7b\u578b\u7684\u540d\u5b57\uff0c\u6765\u64cd\u4f5c\u8fd9\u4e2a\u540d\u5b57\u5bf9\u5e94\u7684\u51fd\u6570\uff0c\u793a\u4f8b\u53d8\u91cf\uff0c\u7ed1\u5b9a\u65b9\u6cd5\u7b49\u3002</p> <p>\u53cd\u5c04\u7684\u4f7f\u7528\u573a\u666f\uff1a</p> <ol> <li>\u53cd\u5c04\u5bf9\u8c61\u7684\u5b9e\u4f8b\u53d8\u91cf\u3001\u7ed1\u5b9a\u65b9\u6cd5</li> <li>\u53cd\u5c04\u7c7b\u4e2d\u7684\u9759\u6001\u53d8\u91cf\u3001\u7ed1\u5b9a\u65b9\u6cd5\u3001\u5176\u4ed6\u65b9\u6cd5</li> <li>\u53cd\u5c04\u6a21\u5757\u4e2d\u7684\u6240\u6709\u53d8\u91cf</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#71","title":"7.1 \u53cd\u5c04\u5bf9\u8c61\u7684\u5b9e\u4f8b\u53d8\u91cf\u3001\u7ed1\u5b9a\u65b9\u6cd5","text":"<pre><code>class Person:\n    def __init__(self,name,age):\n        self.name = name\n        self.age = age\n    def foo(self):\n        return 'hello world!'\n\nzhangsan = Person('\u5f20\u4e09', 18)\n\n# 1.\u53cd\u5c04\u5bf9\u8c61\u7684\u5b9e\u4f8b\u53d8\u91cf\nprint(getattr(zhangsan, 'name'))\n\n# 2.\u53cd\u5c04\u5bf9\u8c61\u7684\u7ed1\u5b9a\u65b9\u6cd5\nprint(getattr(zhangsan, 'foo')())\n\n# \u8f93\u51fa\u7ed3\u679c\n# \u5f20\u4e09\n# hello world!\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#72","title":"7.2 \u53cd\u5c04\u7c7b\u4e2d\u7684\u9759\u6001\u53d8\u91cf","text":"<pre><code>class Person:\n    country = 'China'\n    def __init__(self):\n        pass\n    def foo(self):\n        pass\n\nprint(getattr(Person, 'country'))\n# \u8f93\u51fa\u7ed3\u679c\n# China\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#73","title":"7.3 \u53cd\u5c04\u6a21\u5757\u4e2d\u7684\u53d8\u91cf","text":"<p>1.\u53cd\u5c04\u6a21\u5757\u4e2d\u7684\u53d8\u91cf</p> <pre><code>import module\ngetattr(module,'func')\ngetattr(module,'Bar')\n</code></pre> <p>2.\u53cd\u5c04\u811a\u672c\uff08\u672c\u6587\u4ef6\uff09\u4e2d\u7684\u53d8\u91cf</p> <pre><code>import sys\ngetattr(sys.modules['__main__'],func)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#74-hasattrsetattrdelattr","title":"7.4 <code>hasattr</code>\u3001<code>setattr</code>\u548c<code>delattr</code>","text":"<pre><code>class Person:\n    country = 'China'\n    def __init__(self):\n        pass\n    def foo(self):\n        pass\n\nBob = Person()\n# hasattr \u5224\u65ad\u662f\u5426\u6709\u67d0\u4e2a\u6210\u5458\nprint(hasattr(Bob, 'name')) # False\n# setattr \u8bbe\u7f6e\u5c5e\u6027\nsetattr(Bob, 'name', 'Bob')\nprint(hasattr(Bob, 'name')) # True\n# delattr \u5220\u9664\u5c5e\u6027\ndelattr(Bob, 'name')\nprint(hasattr(Bob, 'name')) # False\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#75","title":"7.5  \u53cd\u5c04\u7684\u4f8b\u5b50","text":"<pre><code>#!/usr/bin/env python\n# -*- coding: utf-8  -*-\nwhile True:\n    inp = input(\"\u8bf7\u8f93\u5165\u8981\u8bbf\u95ee\u7684URL\uff1a\")\n    if inp == \"q\":\n        break\n    class Bar:\n\n        def f1(self):\n            return \"\u9996\u9875\"\n\n        def f2(self):\n            return \"\u65b0\u95fb\"\n\n        def f3(self):\n            return \"\u535a\u5ba2\"\n\n    obj = Bar()\n    if hasattr(obj,inp):\n        f = getattr(obj,inp)\n        print(f())\n    else:\n        print(\"404\")\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#8","title":"8. \u5143\u7c7b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#9","title":"9. \u91cd\u88c5\u8fd0\u7b97\u7b26","text":"<p>9.1<code>__new__</code></p> <p>\u662f\u4e00\u4e2a\u6784\u9020\u65b9\u6cd5\uff0c\u7528\u6765\u521b\u5efa\u4e00\u4e2a\u5bf9\u8c61\u9700\u8981\u7684\u7a7a\u95f4\u3002</p> <p>\u4f7f\u7528\u573a\u666f\uff1a\u521b\u5efa\u5355\u4f8b\u6a21\u5f0f\uff08\u4e00\u4e2a\u7c7b\u53ea\u4f1a\u521b\u5efa\u4e00\u6b21self\u7684\u7a7a\u95f4\uff09</p> <pre><code>class Bar:\n    __instance = None\n    def __new__(cls, *args, **kwargs):\n        if not cls.__instance:\n            cls.__instance = super().__new__(cls)\n        return cls.__instance\n</code></pre> <p>9.1  __call__\u65b9\u6cd5</p> <pre><code>class Bar:\n\n    def __init__(self):\n        print(\"init\")\n\n    def __call__(self):\n        print(\"call\")\nobj = Bar()\nobj() #\u5bf9\u8c61\u52a0\u62ec\u53f7\u81ea\u52a8\u6267\u884c__call__\u65b9\u6cd5\n</code></pre> <p>9.2 str \u4e0e int</p> <pre><code>class Bar:\n\n    def __init__(self):\n        pass\n    def __int__(self):\n        return 111\n    def __str__(self):\n        return \"str\"\nobj = Bar()\nprint(obj,type(obj))\nr = int(obj)   #int \u52a0\u5bf9\u8c61\uff0c\u81ea\u52a8\u6267\u884c\u5bf9\u8c61\u7684int\u65b9\u6cd5\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u8d4b\u503c\u7ed9int\u5bf9\u8c61\nprint(r)\nr = str(obj)\nprint(r)    #str \u52a0\u5bf9\u8c61\uff0c\u81ea\u52a8\u6267\u884c\u5bf9\u8c61\u7684str\u65b9\u6cd5\uff0c\u5e76\u5c06\u8fd4\u56de\u503c\u8d4b\u503c\u7ed9str\u5bf9\u8c61\n------------\nstr &lt;class '__main__.Bar'&gt;\nstr\n</code></pre> <p>9.3 \u4f8b\uff1a__str_</p> <pre><code>class Bar:\n    def __init__(self,name,age):\n        self.name = name\n        self.age = age\n    def __str__(self):\n        return \"%s:%s\" %(self.name,self.age)\n\nobj = Bar(\"Tom\",18)\nprint(obj)\n-----------\nTom:18\n</code></pre> <p>9.4 del \u6790\u6784\u65b9\u6cd5\uff1a\u5bf9\u8c61\u9500\u6bc1\u7684\u65f6\u5019\u6267\u884c</p> <pre><code>class Bar:\n\n    def __init__(self):\n        pass\n    def  __del__(self):\n        print(\"\u6790\u6784\u65b9\u6cd5\")\nobj = Bar()\n</code></pre> <p>9.5 dict \u5c06\u5b57\u6bb5\u4e2d\u7684\u6210\u5458\u4ee5\u5b57\u6bb5\u7684\u5f62\u5f0f\u8fd4\u56de</p> <pre><code>class Bar:\n    \"\"\"\u6ce8\u91ca\"\"\"\n    def __init__(self,name,age):\n        self.name = name\n        self.age = age\n\nobj = Bar('Tom',18)\n#\u5c06\u5b57\u6bb5\u4e2d\u7684\u6210\u5458\u4ee5\u5b57\u6bb5\u7684\u5f62\u5f0f\u8fd4\u56de\nprint(Bar.__dict__)\nprint(obj.__dict__)\n---------\n{'__module__': '__main__', '__init__': &lt;function Bar.__init__ at 0x0000013DAD733AE8&gt;, '__weakref__': &lt;attribute '__weakref__' of 'Bar' objects&gt;, '__doc__': '\u6ce8\u91ca', '__dict__': &lt;attribute '__dict__' of 'Bar' objects&gt;}\n{'name': 'Tom', 'age': 18}\n</code></pre> <p>9.6 getitem \u3001 setitem  \u548c delitem</p> <pre><code>class Bar:\n    \"\"\"\u6ce8\u91ca\"\"\"\n    def __init__(self):\n        pass\n    def __getitem__(self,item):\n        return item + 10\n    def __setitem__(self,k,v):\n        print(k,v) \n    def __delitem__(self,val):\n        print('delete:',val)\nobj = Bar()\nprint(obj[2])\nobj['name']='Tom'\ndel obj['del']\n----------------\nname Tom\ndelete: del\n</code></pre> <p>9.7  iter \u5982\u679c\u7c7b\u4e2d\u6709__iter__\u65b9\u6cd5\uff0c\u5176\u5bf9\u8c61\u5c31\u662f\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff1b \u5bf9\u8c61\u540d.iter()\u7684\u8fd4\u56de\u503c\u662f\u8fed\u4ee3\u5668</p> <pre><code>class Bar:\n\n    def __iter__(self):\n        return iter([11,22,33])\n\nobj = Bar()\nfor i in obj:\n    print(i)\n  #for\u5faa\u73af\u6267\u884cobj\u5bf9\u8c61\u7684\u7c7b\u4e2d\u7684__iter__\u65b9\u6cd5\uff0c\u5e76\u83b7\u53d6\u5176\u8fed\u4ee3\u5668\uff1b\u5faa\u73af\u4e0a\u4e00\u6b65\u4e2d\u8fd4\u56de\u7684\u5bf9\u8c61\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/05-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/#10","title":"10. \u5355\u4f8b\u6a21\u5f0f","text":"<p>\u5e94\u7528\u573a\u666f\uff1a\u6570\u636e\u5e93\u8fde\u63a5\u6c60</p> <pre><code>class Bar:\n    __v = None\n    @classmethod\n    def get_instance(cls):\n        if cls.__v:\n            return cls.__v\n        else:\n            cls.__v = Bar()\n            return cls.__v\n# \u4e0d\u7528\u518d\u4f7f\u7528Bar()\u521b\u5efa\u5b9e\u4f8b\nobj1 = Bar.get_instance()\nprint(obj1)\nobj2 = Bar.get_instance()\nprint(obj2)\nobj3 = Bar.get_instance()\nprint(obj3)\n###########\n&lt;__main__.Bar object at 0x0000026D865B4A20&gt;\n&lt;__main__.Bar object at 0x0000026D865B4A20&gt;\n&lt;__main__.Bar object at 0x0000026D865B4A20&gt;\n</code></pre> <p>\u7ebf\u7a0b\u5b89\u5168\u5355\u4f8b\u6a21\u5f0f</p> <pre><code>class Bar:\n    from threading import Lock\n    __instance = None\n    lock = Lock()\n\n    def __new__(cls, *args, **kwargs):\n        with cls.lock:\n            if not cls.__instance:\n                cls.__instance = super().__new__(cls)\n        return cls.__instance\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/","title":"\u6a21\u5757\u548c\u5305","text":"<p>\u6a21\u5757\u548c\u5305\u7684\u547d\u4ee4\u90fd\u5e94\u9075\u5faapython\u53d8\u91cf\u7684\u547d\u540d\u89c4\u5219\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#_2","title":"\u4e00\u3001\u6a21\u5757","text":"<p>\u672c\u8d28\u5c31\u662f\u4e00\u4e2a.py\u6587\u4ef6\uff0c\u5c01\u88c5\u8bed\u53e5\u7684\u6700\u5c0f\u5355\u4f4d\uff0c\u662f\u4e00\u7cfb\u5217\u529f\u80fd\u7684\u96c6\u5408\u4f53\u3002\u4f7f\u7528\u6a21\u5757\u53ef\u4ee5\u63d0\u9ad8\u5f00\u53d1\u6548\u7387\uff0c\u4fbf\u4e8e\u7ef4\u62a4\u548c\u7ba1\u7406\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#1","title":"1. \u6a21\u5757\u7684\u5206\u7c7b","text":"<ol> <li> <p>\u5185\u7f6e\u6a21\u5757</p> </li> <li> <p>\u7b2c\u4e09\u65b9\u6a21\u5757\u3001\u6269\u5c55\u6a21\u5757</p> </li> <li> <p>\u81ea\u5b9a\u4e49\u6a21\u5757</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#2","title":"2. \u6a21\u5757\u7684\u5f62\u5f0f","text":"<ol> <li>\u4f7f\u7528python\u7f16\u5199\u7684\u6e90\u4ee3\u7801\u6587\u4ef6\uff08.py\u6587\u4ef6\uff09</li> <li>\u5b57\u8282\u7801\u6587\u4ef6\uff08.pyc\uff09</li> <li>\u7528C\u6216C++\u7f16\u5199\u7684\u7f16\u8bd1\u6269\u5c55\u6a21\u5757\uff0c\u5bfc\u5165\u65f6\u4f7f\u7528\u52a8\u6001\u94fe\u63a5\uff08linux\u7684.so\u3001Cygwin\u6216Windows\u7684.dll\uff09</li> <li>\u628a\u4e00\u7cfb\u5217\u6a21\u5757\u7ec4\u7ec7\u5230\u4e00\u8d77\u7684\u6587\u4ef6\u5939\uff08\u5305\uff09</li> <li>\u4f7f\u7528C\u7f16\u5199\u5e76\u94fe\u63a5\u5230python\u89e3\u91ca\u5668\u7684\u5185\u7f6e\u6a21\u5757</li> <li>zip\u6587\u4ef6\uff0c\u5bfc\u5165\u65f6\u81ea\u52a8\u89e3\u538b\u7f29</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#3","title":"3. \u6a21\u5757\u7684\u641c\u7d22\u8def\u5f84","text":"<ol> <li>\u7a0b\u5e8f\u4e3b\u76ee\u5f55</li> <li>PYTHONPATH\u76ee\u5f55</li> <li>\u6807\u51c6\u5e93\u76ee\u5f55</li> <li><code>.pth</code>\u6587\u4ef6\u4e2d\u7684\u5185\u5bb9\uff08\u4e0d\u5e38\u7528\uff09</li> <li>\u7b2c\u4e09\u65b9\u6269\u5c55\u5e94\u7528\u7684<code>site-packages</code>\u4e3b\u76ee\u5f55</li> </ol> <pre><code>$ python3\nPython 3.6.9 (default, Oct  8 2020, 12:12:24) \n[GCC 8.4.0] on linux\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n&gt;&gt;&gt; import sys\n&gt;&gt;&gt; sys.path\n['', '/usr/lib/python36.zip', '/usr/lib/python3.6', '/usr/lib/python3.6/lib-dynload', '/home/gp/.local/lib/python3.6/site-packages', '/usr/local/lib/python3.6/dist-packages', '/usr/lib/python3/dist-packages']\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#4","title":"4. \u6a21\u5757\u7684\u8fd0\u884c\u65b9\u5f0f","text":"<ol> <li>\u811a\u672c\u65b9\u5f0f\uff1a\u76f4\u63a5\u7528\u89e3\u91ca\u5668\u6267\u884c</li> <li>\u6a21\u5757\u65b9\u5f0f\uff1a\u88ab\u5176\u4ed6\u7684\u6a21\u5757\u5bfc\u5165\u6267\u884c\uff0c\u4e3a\u5bfc\u5165\u5b83\u7684\u6a21\u5757\u63d0\u4f9b\u8d44\u6e90\uff08\u53d8\u91cf\u3001\u51fd\u6570\u5b9a\u4e49\u3001\u7c7b\u5b9a\u4e49\u7b49\uff09\u3002</li> </ol> <p>\u81ea\u5b9a\u4e49\u6a21\u5757\u88ab\u5176\u4ed6\u6a21\u5757\u5bfc\u5165\u65f6\uff0c\u5176\u4e2d\u7684\u53ef\u6267\u884c\u8bed\u53e5\u4f1a\u7acb\u5373\u6267\u884c\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#5","title":"5. \u6a21\u5757\u7684\u5bfc\u5165","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#51","title":"5.1  \u5bfc\u5165\u6a21\u5757\u7684\u89c4\u8303","text":"<pre><code>#/usr/bin/env python3\nimport python\u5185\u7f6e\u6a21\u5757\nimport \u7b2c\u4e09\u65b9\u6a21\u5757\nimport \u81ea\u5b9a\u4e49\u6a21\u5757\n...\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#52","title":"5.2 \u5bfc\u5165\u6a21\u5757\u65f6\u53d1\u751f\u4e86\u4ec0\u4e48","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#521","title":"5.2.1 \u5bfc\u5165\u7684\u4e09\u4e2a\u6b65\u9aa4","text":"<p>\u7a0b\u5e8f\u7b2c\u4e00\u6b21\u5bfc\u5165\u6307\u5b9a\u6587\u4ef6\u65f6\uff0c\u4f1a\u6267\u884c\u4e09\u4e2a\u6b65\u9aa4\uff1a</p> <ol> <li>\u627e\u5230\u6a21\u5757\u6587\u4ef6</li> <li>\u7f16\u8bd1\u6210\u5b57\u8282\u7801</li> <li>\u6267\u884c\u6a21\u5757\u7684\u4ee3\u7801\u6765\u521b\u5efa\u5176\u6240\u5b9a\u4e49\u7684\u5bf9\u8c61</li> </ol> <p>\u4e4b\u540e\u518d\u5bfc\u5165\u76f8\u540c\u7684\u6a21\u5757\u65f6\u4f1a\u8df3\u8fc7\u8fd9\u4e09\u4e2a\u6b65\u9aa4\uff0c\u800c\u53ea\u662f\u63d0\u53d6\u5185\u5b58\u4e2d\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\u5bf9\u8c61\uff0cpython\u4f1a\u628a\u5df2\u52a0\u8f7d\u7684\u6a21\u5757\u5b58\u50a8\u5230<code>sys.modules</code>\u5b57\u5178\u4e2d\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#522","title":"5.2.2 \u5bfc\u5165\u6a21\u5757\u65f6\u6267\u884c\u7684\u4e09\u4ef6\u4e8b","text":"<ol> <li>\u5728\u5185\u5b58\u4e2d\u521b\u5efa\u4ee5\u6a21\u5757\u540d\u79f0\u547d\u540d\u7684\u540d\u79f0\u7a7a\u95f4</li> <li>\u4ece\u5934\u5230\u5c3e\u4f9d\u6b21\u6267\u884c\u8be5\u6a21\u5757\u6587\u4ef6\u5185\u7684\u8bed\u53e5\uff0c\u6587\u4ef6\u9876\u5c42\u7684\uff08\u4e0d\u5728def\u6216class\u4e4b\u5185\uff09\u8d4b\u503c\u540d\u79f0\u7684\u8bed\u53e5\uff08=\u6216def\uff09\u4f1a\u521b\u5efa\u6a21\u5757\u5bf9\u8c61\u7684\u5c5e\u6027\uff0c\u8d4b\u503c\u7684\u540d\u79f0\u4f1a\u5b58\u50a8\u5728\u6a21\u5757\u7684\u547d\u540d\u7a7a\u95f4\u5185\u3002</li> <li>\u901a\u8fc7<code>\u6a21\u5757.</code>\u7684\u65b9\u5f0f\u8c03\u7528\u6b64\u6a21\u5757\u4e2d\u7684\u5185\u5bb9</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#53","title":"5.3 \u5bfc\u5165\u6a21\u5757\u7684\u65b9\u5f0f","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#531-import","title":"5.3.1 <code>import</code>","text":"<p>\u8bed\u6cd5\u683c\u5f0f</p> <pre><code>import module # \u5bfc\u5165\u4e00\u4e2a\u6a21\u5757\u7684\u6240\u6709\u6210\u5458\nimport module1, module2 # \u4e00\u6b21\u6027\u5bfc\u5165\u591a\u4e2a\u6a21\u5757\uff0c\u4e0d\u63a8\u8350\u8fd9\u79cd\u5199\u6cd5\n</code></pre> <p><code>import</code>\u4f1a\u6574\u4f53\u8bfb\u53d6\u4e00\u4e2a\u6a21\u5757\uff0c\u4f7f\u7528\u540d\u79f0\u65f6\u9700\u8981\u52a0\u4e0a\u6a21\u5757\u540d\u3002</p> <pre><code>&gt;&gt;&gt; import time\n&gt;&gt;&gt; time.sleep(1)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#532-from","title":"5.3.2 <code>from</code>","text":"<p>\u8bed\u6cd5\u683c\u5f0f</p> <pre><code>from module import name\nfrom module import name1, name2 # \u67d0\u4e2a\u6a21\u5757\u4e2d\u5bfc\u5165\u591a\u4e2a\u6210\u5458\nfrom module import * # \u5bfc\u5165\u4e00\u4e2a\u6a21\u5757\u7684\u6240\u6709\u6210\u5458\uff0c\u5728python3\u4e2d\u53ea\u80fd\u7528\u5728\u4e00\u4e2a\u6a21\u5757\u6587\u4ef6\u7684\u9876\u90e8\uff0c\u4e0d\u80fd\u7528\u5728\u51fd\u6570\u4e2d\n</code></pre> <p><code>from</code>\u4ece\u6a21\u5757\u4e2d\u8bfb\u53d6\u7279\u5b9a\u7684\u540d\u79f0\uff0c\u4f7f\u7528\u65f6\u4e0d\u9700\u8981\u52a0\u6a21\u5757\u540d\u3002</p> <pre><code>&gt;&gt;&gt; from time import sleep\n&gt;&gt;&gt; sleep(1)\n</code></pre> <p>\u4f7f\u7528\u522b\u540d<code>alias</code></p> <ul> <li>\u7ed9\u6210\u5458\u53d6\u522b\u540d\uff0c\u907f\u514d\u540d\u79f0\u51b2\u7a81<code>from xxx import zzz as y</code> </li> <li>\u7ed9\u6a21\u5757\u53d6\u522b\u540d\uff0c\u7b80\u5316\u719f\u6089<code>import xxx as y</code></li> </ul>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#__all__","title":"\u4f7f\u7528<code>__all__</code>\u63a7\u5236\u88ab\u5bfc\u5165\u7684\u6210\u5458","text":"<p><code>from xxx import *</code>\u63a7\u5236\u6210\u5458\u88ab\u5bfc\u5165\uff0c<code>__all__</code>\u662f\u4e00\u4e2a\u5217\u8868\uff0c\u7528\u4e8e\u8868\u793a\u672c\u6a21\u5757\u53ef\u4ee5\u88ab\u5916\u754c\u4f7f\u7528\u7684\u6210\u5458\uff0c\u5143\u7d20\u662f\u6210\u5458\u7684\u5b57\u7b26\u4e32\u3002</p> <pre><code># \u53ea\u6709\u4f7f\u7528`from xxx import *`\u5bfc\u5165\u624d\u6709\u6548\n__all__ = [\"\u6210\u54581\", \"\u6210\u54582\"]\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#6-__name__","title":"6. <code>__name__</code>\u5c5e\u6027","text":"<p>\u6bcf\u4e2a\u6a21\u5757\u5185\u6709\u4e00\u4e2a\u540d\u4e3a<code>__name__</code>\u7684\u5185\u7f6e\u5c5e\u6027\u3002</p> <ol> <li> <p>\u5982\u679c\u6587\u4ef6\u4f5c\u4e3a\u9876\u5c42\u7a0b\u5e8f\u6587\u4ef6\uff08\u811a\u672c\u65b9\u5f0f\uff09\u6267\u884c\u65f6\uff0c<code>__name__</code> \u503c\u4e3a\u5b57\u7b26\u4e32<code>__main__</code>\uff0c</p> </li> <li> <p>\u5982\u679c\u6587\u4ef6\u88ab\u5f53\u505a\u6a21\u5757\u5bfc\u5165\u65f6\uff0c<code>__name__</code>\u7684\u503c\u4e3a\u5c31\u662f\u672c\u6a21\u5757\u7684\u540d\u5b57\u3002</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#_3","title":"\u4e8c\u3001\u6a21\u5757\u5305","text":"<p>\u5305\u5c31\u662f\u4e00\u4e2a\u5305\u542b\u6709<code>__init__.py</code>\u6587\u4ef6\u7684\u6587\u4ef6\u5939</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/06-%E5%8C%85%E5%92%8C%E6%A8%A1%E5%9D%97/#1_1","title":"1. \u5bfc\u5165\u5305\u7684\u65b9\u5f0f","text":"<pre><code>import\nfrom ... import ...\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/","title":"\u8fed\u4ee3\u548c\u63a8\u5bfc","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#_1","title":"\u4e00\u3001\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4e0e\u8fed\u4ee3\u5668","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#1","title":"1. \u53ef\u8fed\u4ee3\u5bf9\u8c61","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8e for \u5faa\u73af\u7684\u5bf9\u8c61\u7edf\u79f0\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08Iterable\uff09\u3002\u5185\u90e8\u542b\u6709<code>__iter__</code>\u65b9\u6cd5\u3002\u5982\u5b57\u7b26\u4e32\u3001\u5217\u8868\u3001\u5143\u7ec4\u3001\u5b57\u5178\u3001\u96c6\u5408\u3001\u6587\u4ef6\u53e5\u67c4\u7b49\u3002<code>\u53ef\u8fed\u4ee3\u5bf9\u8c61.__iter__()</code>:\u53ef\u5f97\u5230\u8fed\u4ee3\u5668\u5bf9\u8c61\u3002</p> <pre><code>&gt;&gt;&gt; l = []\n&gt;&gt;&gt; l.__iter__()\n&lt;list_iterator object at 0x000001931878FBE0&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#11","title":"1.1 \u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61","text":"<pre><code>&gt;&gt;&gt; '__iter__' in dir('hello')\nTrue\n# \u6216\u8005\n&gt;&gt;&gt; from collections import Iterable\n&gt;&gt;&gt; isinstance([], Iterable)\nTrue\n</code></pre> <p>\u51e1\u662f\u53ef\u4f5c\u7528\u4e8e for \u5faa\u73af\u7684\u5bf9\u8c61\u90fd\u662f Iterable \u7c7b\u578b</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#12","title":"1.2. \u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u7279\u70b9","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#121","title":"1.2.1 \u4f18\u70b9","text":"<ol> <li>\u5b58\u50a8\u7684\u6570\u636e\u80fd\u76f4\u63a5\u663e\u793a\uff0c\u6bd4\u8f83\u76f4\u89c2</li> <li>\u62e5\u6709\u7684\u65b9\u6cd5\u6bd4\u8f83\u591a\uff0c\u64cd\u4f5c\u65b9\u4fbf</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#122","title":"1.2.2 \u7f3a\u70b9","text":"<ol> <li>\u5360\u7528\u5185\u5b58</li> <li>\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7for\u5faa\u73af\u53d6\u503c</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#2","title":"2. \u8fed\u4ee3\u5668","text":"<p>\u53ef\u4ee5\u88abnext()\u51fd\u6570\u8c03\u7528\u5e76\u4e0d\u65ad\u8fd4\u56de\u4e0b\u4e00\u4e2a\u503c\u7684\u5bf9\u8c61\u79f0\u4e3a\u8fed\u4ee3\u5668\uff08Iterator\uff09\uff0c\u5185\u90e8\u542b\u6709<code>__iter__</code>\u65b9\u6cd5\u548c<code>__next__</code>\u65b9\u6cd5\u7684\u5bf9\u8c61\u3002\u8fed\u4ee3\u5668\u6307\u7684\u662f\u8fed\u4ee3\u53d6\u503c\u7684\u5de5\u5177\uff0c\u8fed\u4ee3\u662f\u4e00\u4e2a\u91cd\u590d\u7684\u8fc7\u7a0b\uff0c\u6bcf\u6b21\u91cd\u590d\uff0c\u90fd\u662f\u57fa\u4e8e\u4e0a\u4e00\u6b21\u7684\u7ed3\u679c\u800c\u7ee7\u7eed\u7684\uff0c\u5355\u7eaf\u7684\u91cd\u590d\u5e76\u4e0d\u662f\u8fed\u4ee3\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#21","title":"2.1 \u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u4e0d\u662f\u8fed\u4ee3\u5668","text":"<pre><code>&gt;&gt;&gt; from collections import Iterator\n&gt;&gt;&gt; isinstance((x for x in range(10)), Iterator)\nTrue\n&gt;&gt;&gt; isinstance([], Iterator)\nFalse\n</code></pre> <p>\u51e1\u662f\u53ef\u4f5c\u7528\u4e8e next()\u51fd\u6570\u7684\u5bf9\u8c61\u90fd\u662f Iterator \u7c7b\u578b,\u662f\u4e00\u4e2a\u60f0\u6027</p> <p>\u8ba1\u7b97\u7684\u5e8f\u5217\uff1b</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#22","title":"2.2 \u53ef\u8fed\u4ee3\u5bf9\u8c61\u8f6c\u6362\u4e3a\u8fed\u4ee3\u5668","text":"<p>\u65b9\u5f0f\u4e00\uff1a</p> <pre><code>&gt;&gt;&gt; d = {'a': 1, 'b': 2, 'c': 3}\n&gt;&gt;&gt; d_iterator = d.__iter__()\n&gt;&gt;&gt; print(d_iterator)\n&lt;dict_keyiterator object at 0x0000019318519598&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; print(d_iterator.__next__())\na\n&gt;&gt;&gt; print(d_iterator.__next__())\nb\n&gt;&gt;&gt; print(d_iterator.__next__())\nc\n&gt;&gt;&gt; print(d_iterator.__next__())\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>\u65b9\u5f0f\u4e8c\uff1a</p> <pre><code>&gt;&gt;&gt; s = 'hello'\n&gt;&gt;&gt; iter(s)\n&lt;str_iterator object at 0x000002157774D898&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#23-for","title":"2.3 for\u5faa\u73af\u7684\u5de5\u4f5c\u539f\u7406","text":"<pre><code>d = {'a': 1, 'b': 2, 'c': 3}\n# 1\u3001d.__iter__()\u5f97\u5230\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\n# 2\u3001\u8fed\u4ee3\u5668\u5bf9\u8c61.__next__()\u62ff\u5230\u4e00\u4e2a\u8fd4\u56de\u503c\uff0c\u7136\u540e\u5c06\u8be5\u8fd4\u56de\u503c\u8d4b\u503c\u7ed9k\n# 3\u3001\u5faa\u73af\u5f80\u590d\u6b65\u9aa42\uff0c\u76f4\u5230\u629b\u51faStopIteration\u5f02\u5e38for\u5faa\u73af\u4f1a\u6355\u6349\u5f02\u5e38\u7136\u540e\u7ed3\u675f\u5faa\u73af\nfor k in d:\n    print(k)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#24","title":"2.4 \u8fed\u4ee3\u5668\u7684\u4f18\u7f3a\u70b9","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#241","title":"2.4.1.\u4f18\u70b9","text":"<ol> <li>\u4e3a\u5e8f\u5217\u548c\u975e\u5e8f\u5217\u7c7b\u578b\u63d0\u4f9b\u4e86\u4e00\u79cd\u7edf\u4e00\u7684\u8fed\u4ee3\u53d6\u503c\u65b9\u5f0f\u3002</li> <li>\u60f0\u6027\u8ba1\u7b97\uff1a\u8fed\u4ee3\u5668\u5bf9\u8c61\u8868\u793a\u7684\u662f\u4e00\u4e2a\u6570\u636e\u6d41\uff0c\u53ef\u4ee5\u53ea\u5728\u9700\u8981\u65f6\u624d\u53bb\u8c03\u7528next\u6765\u8ba1\u7b97\u51fa\u4e00\u4e2a\u503c\uff0c\u5c31\u8fed\u4ee3\u5668\u672c\u8eab\u6765\u8bf4\uff0c\u540c\u4e00\u65f6\u523b\u5728\u5185\u5b58\u4e2d\u53ea\u6709\u4e00\u4e2a\u503c\uff0c\u56e0\u800c\u53ef\u4ee5\u5b58\u653e\u65e0\u9650\u5927\u7684\u6570\u636e\u6d41\uff0c\u800c\u5bf9\u4e8e\u5176\u4ed6\u5bb9\u5668\u7c7b\u578b\uff0c\u5982\u5217\u8868\uff0c\u9700\u8981\u628a\u6240\u6709\u7684\u5143\u7d20\u90fd\u5b58\u653e\u4e8e\u5185\u5b58\u4e2d\uff0c\u53d7\u5185\u5b58\u5927\u5c0f\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u5b58\u653e\u7684\u503c\u7684\u4e2a\u6570\u662f\u6709\u9650\u7684\u3002</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#242","title":"2.4.2 \u7f3a\u70b9","text":"<ol> <li>\u9664\u975e\u53d6\u5c3d\uff0c\u5426\u5219\u65e0\u6cd5\u83b7\u53d6\u8fed\u4ee3\u5668\u7684\u957f\u5ea6</li> <li>\u53ea\u80fd\u53d6\u4e0b\u4e00\u4e2a\u503c\uff0c\u4e0d\u80fd\u56de\u5230\u5f00\u59cb\uff0c\u66f4\u50cf\u662f\u2018\u4e00\u6b21\u6027\u7684\u2019\uff0c\u8fed\u4ee3\u5668\u4ea7\u751f\u540e\u7684\u552f\u4e00\u76ee\u6807\u5c31\u662f\u91cd\u590d\u6267\u884c<code>next</code>\u65b9\u6cd5\u76f4\u5230\u503c\u53d6\u5c3d\uff0c\u5426\u5219\u5c31\u4f1a\u505c\u7559\u5728\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u7b49\u5f85\u4e0b\u4e00\u6b21\u8c03\u7528<code>next</code>\uff1b\u82e5\u662f\u8981\u518d\u6b21\u8fed\u4ee3\u540c\u4e2a\u5bf9\u8c61\uff0c\u4f60\u53ea\u80fd\u91cd\u65b0\u8c03\u7528<code>iter</code>\u65b9\u6cd5\u53bb\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u5faa\u73af\u4f7f\u7528\u540c\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u5fc5\u7136\u53ea\u4f1a\u6709\u4e00\u4e2a\u5faa\u73af\u80fd\u53d6\u5230\u503c\u3002</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#_2","title":"\u4e8c\u3001\u751f\u6210\u5668","text":"<p>\u751f\u6210\u5668\u7684\u672c\u8d28\u662f\u8fed\u4ee3\u5668\uff0c</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#1_1","title":"1. \u751f\u6210\u5668\u7684\u83b7\u53d6\u65b9\u5f0f","text":"<ol> <li>\u751f\u6210\u5668\u51fd\u6570</li> <li>\u751f\u6210\u5668\u8868\u8fbe\u5f0f</li> <li>python\u5185\u90e8\u63d0\u4f9b</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#2_1","title":"2. \u751f\u6210\u5668\u51fd\u6570","text":"<p>\u5982\u679c<code>def</code>\u5b9a\u4e49\u7684\u51fd\u6570\u4e2d\u6709<code>yield</code>\uff0c\u8fd9\u4e2a\u51fd\u6570\u5c31\u662f\u751f\u6210\u5668\u51fd\u6570\uff0c\u4e0d\u518d\u662f\u666e\u901a\u51fd\u6570\u3002\u751f\u6210\u5668\u51fd\u6570\u4e2d\u53ef\u4ee5\u6709\u591a\u4e2a<code>yield</code>\uff0c\u4e00\u4e2a<code>yield</code>\u5bf9\u5e94\u4e00\u4e2a<code>next</code></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#21-yield","title":"2.1 <code>yield</code>","text":"<pre><code>&gt;&gt;&gt; def func():\n...     print('\u7b2c\u4e00\u6b21')\n...     yield 1\n...     print('\u7b2c\u4e8c\u6b21')\n...     yield 2\n...     print('\u7b2c\u4e09\u6b21')\n...     yield 3\n...     print('\u7b2c\u56db\u6b21')\n...\n&gt;&gt;&gt; g=func()\n&gt;&gt;&gt; print(g)\n&lt;generator object func at 0x0000019318767A98&gt;\n&gt;&gt;&gt; next(g)\n\u7b2c\u4e00\u6b21\n1\n&gt;&gt;&gt; next(g)\n\u7b2c\u4e8c\u6b21\n2\n&gt;&gt;&gt; next(g)\n\u7b2c\u4e09\u6b21\n3\n&gt;&gt;&gt; next(g)\n\u7b2c\u56db\u6b21\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n&gt;&gt;&gt; #next() \u4f1a\u89e6\u53d1\u51fd\u6570\u4f53\u4ee3\u7801\u7684\u8fd0\u884c\uff0c\u7136\u540e\u9047\u5230yield\u505c\u4e0b\u6765\uff0c\u5c06yield\u540e\u7684\u503c\n... # \u5f53\u505a\u672c\u6b21\u8c03\u7528\u7684\u7ed3\u679c\u8fd4\u56de\n...\n</code></pre> <p>\u6709\u4e86yield\u5173\u952e\u5b57\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u79cd\u81ea\u5b9a\u4e49\u8fed\u4ee3\u5668\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002yield\u53ef\u4ee5\u7528\u4e8e\u8fd4\u56de\u503c\uff0c\u4f46\u4e0d\u540c\u4e8ereturn\uff0c\u51fd\u6570\u4e00\u65e6\u9047\u5230return\u5c31\u7ed3\u675f\u4e86\uff0c\u800cyield\u53ef\u4ee5\u4fdd\u5b58\u51fd\u6570\u7684\u8fd0\u884c\u72b6\u6001\u6302\u8d77\u51fd\u6570\uff0c\u7528\u6765\u8fd4\u56de\u591a\u6b21\u503c</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#21-yield-from","title":"2.1 <code>yield from</code>","text":"<pre><code>&gt;&gt;&gt; def func():\n...     l = [1,2,3]\n...     yield l\n...\n&gt;&gt;&gt; next(func())\n[1, 2, 3]\n# yield from \u628a\u5217\u8868\u53d8\u6210\u8fed\u4ee3\u5668\n&gt;&gt;&gt; def func():\n...     l = [1,2,3]\n...     yield from l\n...\n&gt;&gt;&gt; next(func())\n1\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#3","title":"3. \u751f\u6210\u5668\u8868\u8fbe\u5f0f","text":"<p>\u628a\u5217\u8868\u751f\u6210\u5f0f\u7684[]\u6539\u6210()</p> <pre><code>&gt;&gt;&gt; g = (x * x for x in range(10) if x % 3 == 0)\n&gt;&gt;&gt; print(next(g))\n0\n&gt;&gt;&gt; print(next(g))\n9\n&gt;&gt;&gt; print(next(g))\n36\n&gt;&gt;&gt; print(next(g))\n81\n&gt;&gt;&gt; print(next(g))\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n&gt;&gt;&gt; g\n&lt;generator object &lt;genexpr&gt; at 0x0000019318767A98&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#_3","title":"\u4e09\u3001\u751f\u6210\u5f0f","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#1_2","title":"1. \u5217\u8868\u751f\u6210\u5f0f","text":"<p>\u5217\u8868\u63a8\u5bfc\u662f\u901a\u8fc7\u5bf9\u5e8f\u5217\u4e2d\u7684\u6bcf\u4e00\u9879\u8fd0\u884c\u4e00\u4e2a\u8868\u8fbe\u5f0f\u6765\u521b\u5efa\u4e00\u4e2a\u65b0\u5217\u8868\u7684\u65b9\u6cd5\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#11_1","title":"1.1  \u5faa\u73af\u6a21\u5f0f","text":"<pre><code>&gt;&gt;&gt; [ x**2 for x in range(1,11) ]\n[1, 4, 9, 16, 25, 36, 49, 64, 81, 100]\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#22_1","title":"2.2. \u7b5b\u9009\u6a21\u5f0f","text":"<pre><code>&gt;&gt;&gt; [ x for x in range(1,11) if x % 2 == 0 ]\n[2, 4, 6, 8, 10]\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#2_2","title":"2. \u5b57\u5178\u751f\u6210\u5f0f","text":"<p>\u573a\u666f\u4e00</p> <pre><code>&gt;&gt;&gt; keys = ['name', 'age', 'gender']\n&gt;&gt;&gt; dic = {key: None for key in keys}\n&gt;&gt;&gt; print(dic)\n{'name': None, 'age': None, 'gender': None}\n</code></pre> <p>\u573a\u666f\u4e8c</p> <pre><code>&gt;&gt;&gt; items = [('name', 'egon'), ('age', 18), ('gender', 'male')]\n&gt;&gt;&gt; res = {k: v for k, v in items}\n&gt;&gt;&gt; print(res)\n{'name': 'egon', 'age': 18, 'gender': 'male'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/07-%E8%BF%AD%E4%BB%A3%E5%92%8C%E6%8E%A8%E5%AF%BC/#3_1","title":"3. \u96c6\u5408\u751f\u6210\u5f0f","text":"<pre><code>&gt;&gt;&gt; keys = ['name', 'age', 'gender']\n&gt;&gt;&gt; set1 = {key for key in keys}\n&gt;&gt;&gt; print(set1, type(set1))\n{'name', 'age', 'gender'} &lt;class 'set'&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/","title":"\u5e38\u7528\u6587\u4ef6\u5904\u7406\u51fd\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#open","title":"\u4e00\u3001open\u51fd\u6570","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1","title":"1. \u6253\u5f00\u6587\u4ef6","text":"<pre><code>f = open(filename, mode)\n</code></pre> <p>filename: \u8def\u5f84\u53ef\u4ee5\u662f\u89c9\u5f97\u8def\u5f84\u6216\u76f8\u5bf9\u8def\u5f84</p> mode \u8bf4\u660e r \u4ee5\u8f93\u5165\u6a21\u5f0f\u6253\u5f00\uff08\u9ed8\u8ba4\u503c\uff09 w \u4ee5\u8f93\u51fa\u6a21\u5f0f\u751f\u6210\u5e76\u6253\u5f00\u6587\u4ef6 a \u5728\u6587\u4ef6\u5c3e\u90e8\u8ffd\u52a0\u5e76\u6253\u5f00\u6587\u4ef6 b \u4e8c\u8fdb\u5236\u6570\u636e\u5904\u7406 + \u540c\u65f6\u652f\u6301\u8f93\u5165\u8f93\u51fa"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2","title":"2. \u8bfb\u53d6\u6587\u4ef6","text":"\u65b9\u6cd5 \u63cf\u8ff0 f.read() \u628a\u6574\u4e2a\u6587\u4ef6\u8bfb\u8fdb\u4e00\u4e2a\u5b57\u7b26\u4e32 f.read(N) \u8bfb\u53d6\u63a5\u4e0b\u6765\u7684N\u4e2a\u5b57\u7b26\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32 f.readline() \u8bfb\u53d6\u4e0b\u4e00\u884c\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32 f.readlines() \u8bfb\u53d6\u6574\u4e2a\u6587\u4ef6\u5230\u4e00\u4e2a\u5b57\u7b26\u4e32\u5217\u8868 <pre><code>&gt;&gt;&gt; f = open('hello.txt')\n&gt;&gt;&gt; f.read()\n'hello world!\\nlife is short,\\nI love Python.\\n'\n&gt;&gt;&gt; f = open('hello.txt')\n&gt;&gt;&gt; help(f)\n&gt;&gt;&gt; f.read(3)\n'hel'\n&gt;&gt;&gt; f.readline()\n'lo world!\\n'\n&gt;&gt;&gt; f.readlines()\n['life is short,\\n', 'I love Python.\\n']\n</code></pre> <pre><code># \u6587\u4ef6\u8fed\u4ee3\u5668\u8bfb\u53d6\u6587\u4ef6\n&gt;&gt;&gt; f = open('hello.txt')\n&gt;&gt;&gt; for line in f.readlines():\n...     print(line)\n... \nI love China.\n\nhello world!\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#3","title":"3. \u5199\u5165\u6587\u4ef6","text":"\u65b9\u6cd5 \u63cf\u8ff0 f.write(String) \u628a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6 f.writelines(List) \u628a\u5217\u8868\u5185\u7684\u6240\u6709\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6 <pre><code># \u5199\u5165\u6587\u4ef6\n&gt;&gt;&gt; f = open('hello.txt', 'w')\n&gt;&gt;&gt; L = ['I love China.']\n&gt;&gt;&gt; f.writelines(L)\n# \u8bfb\u53d6\u6587\u4ef6\n&gt;&gt;&gt; f = open('hello.txt')\n&gt;&gt;&gt; f.read()\n'I love China.'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#4","title":"4. \u5173\u95ed\u6587\u4ef6","text":"<pre><code>f.close()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#xml","title":"\u4e09\u3001xml","text":"<p>XML \u6307\u53ef\u6269\u5c55\u6807\u8bb0\u8bed\u8a00\uff08EXtensible Markup Language\uff09\uff0cXML \u88ab\u8bbe\u8ba1\u7528\u6765\u4f20\u8f93\u548c\u5b58\u50a8\u6570\u636e\u3002</p> <pre><code>&lt;bookstore&gt;\n&lt;book category=\"COOKING\"&gt;\n  &lt;title lang=\"en\"&gt;Everyday Italian&lt;/title&gt; \n  &lt;author&gt;Giada De Laurentiis&lt;/author&gt; \n  &lt;year&gt;2005&lt;/year&gt; \n  &lt;price&gt;30.00&lt;/price&gt; \n&lt;/book&gt;\n&lt;book category=\"WEB\"&gt;\n  &lt;title lang=\"en\"&gt;Learning XML&lt;/title&gt; \n  &lt;author&gt;Erik T. Ray&lt;/author&gt; \n  &lt;year&gt;2003&lt;/year&gt; \n  &lt;price&gt;39.95&lt;/price&gt; \n&lt;/book&gt;\n&lt;/bookstore&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1-xml","title":"1. xml\u57fa\u7840","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1_1","title":"1. \u5143\u7d20","text":"<p>\u6839\u5143\u7d20\u662f <code>&lt;bookstore&gt;</code></p> <p><code>&lt;book&gt;</code> \u5143\u7d20\u6709 4 \u4e2a\u5b50\u5143\u7d20\uff1a<code>&lt;title&gt;</code>\u3001<code>&lt; author&gt;</code>\u3001<code>&lt;year&gt;</code>\u3001<code>&lt;price&gt;</code>\u3002</p> <p>\u5143\u7d20\u7684\u547d\u540d\u89c4\u5219</p> <ul> <li>\u540d\u79f0\u53ef\u4ee5\u542b\u5b57\u6bcd\u3001\u6570\u5b57\u4ee5\u53ca\u5176\u4ed6\u7684\u5b57\u7b26</li> <li>\u540d\u79f0\u4e0d\u80fd\u4ee5\u6570\u5b57\u6216\u8005\u6807\u70b9\u7b26\u53f7\u5f00\u59cb</li> <li>\u540d\u79f0\u4e0d\u80fd\u4ee5\u5b57\u7b26 \u201cxml\u201d\uff08\u6216\u8005 XML\u3001Xml\uff09\u5f00\u59cb</li> <li>\u540d\u79f0\u4e0d\u80fd\u5305\u542b\u7a7a\u683c</li> </ul>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2_1","title":"2. \u5c5e\u6027","text":"<p><code>lang=\"en\"</code>\u53eb\u5c5e\u6027\uff0cXML \u7684\u5c5e\u6027\u503c\u987b\u52a0\u5f15\u53f7</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#3_1","title":"3. \u6ce8\u91ca","text":"<pre><code>&lt;!-- This is a comment --&gt; \n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#4_1","title":"4. \u5b9e\u4f53\u5f15\u7528","text":"\u5b9e\u4f53\u5f15\u7528 \u542b\u4e49 <code>&amp;lt;</code> &lt; <code>&amp;gt;</code> &gt; <code>&amp;amp;</code> &amp; <code>&amp;apos;</code> ' <code>&amp;quot;</code> \""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2-the-elementtree-xml-api","title":"2. The ElementTree XML API","text":"<p>python\u6709\u4e09\u79cd\u65b9\u6cd5\u89e3\u6790XML\uff1aSAX\uff0cDOM\uff0c\u4ee5\u53caElementTree\u3002ElementTree\u5c31\u50cf\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684DOM\uff0c\u5177\u6709\u65b9\u4fbf\u53cb\u597d\u7684API\u3002\u4ee3\u7801\u53ef\u7528\u6027\u597d\uff0c\u901f\u5ea6\u5feb\uff0c\u6d88\u8017\u5185\u5b58\u5c11\u3002</p> <p>country_data.xml\u6587\u4ef6\u5185\u5bb9\u5982\u4e0b</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;data&gt;\n    &lt;country name=\"Liechtenstein\"&gt;\n        &lt;rank&gt;1&lt;/rank&gt;\n        &lt;year&gt;2008&lt;/year&gt;\n        &lt;gdppc&gt;141100&lt;/gdppc&gt;\n        &lt;neighbor name=\"Austria\" direction=\"E\"/&gt;\n        &lt;neighbor name=\"Switzerland\" direction=\"W\"/&gt;\n    &lt;/country&gt;\n    &lt;country name=\"Singapore\"&gt;\n        &lt;rank&gt;4&lt;/rank&gt;\n        &lt;year&gt;2011&lt;/year&gt;\n        &lt;gdppc&gt;59900&lt;/gdppc&gt;\n        &lt;neighbor name=\"Malaysia\" direction=\"N\"/&gt;\n    &lt;/country&gt;\n    &lt;country name=\"Panama\"&gt;\n        &lt;rank&gt;68&lt;/rank&gt;\n        &lt;year&gt;2011&lt;/year&gt;\n        &lt;gdppc&gt;13600&lt;/gdppc&gt;\n        &lt;neighbor name=\"Costa Rica\" direction=\"W\"/&gt;\n        &lt;neighbor name=\"Colombia\" direction=\"E\"/&gt;\n    &lt;/country&gt;\n&lt;/data&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1_2","title":"1. \u83b7\u53d6\u5185\u5bb9","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1-xml_1","title":"1. \u8bfb\u53d6xml","text":"<p>\u65b9\u6cd5\u4e00\uff1a\u4ece\u6587\u4ef6\u4e2d\u8bfb\u53d6</p> <pre><code>import xml.etree.ElementTree as ET\ntree = ET.parse('country_data.xml')\nroot = tree.getroot()\n</code></pre> <p>\u65b9\u6cd5\u4e8c\uff1a\u4ece\u5b57\u7b26\u4e32\u8bfb\u53d6</p> <pre><code>import xml.etree.ElementTree as ET\ncountry_data_as_string='\u6587\u4ef6\u5185\u5bb9'\nroot = ET.fromstring(country_data_as_string)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2-tag","title":"2. \u83b7\u53d6\u5143\u7d20\u7684\u6807\u7b7e\u540d\u79f0 <code>.tag</code>","text":"<pre><code>&gt;&gt;&gt; root.tag \n'data'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#3-attrib","title":"3. \u83b7\u53d6\u5143\u7d20\u7684\u5c5e\u6027 <code>.attrib</code>","text":"<pre><code>&gt;&gt;&gt; root.attrib\n{}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#4-text","title":"4.\u83b7\u53d6\u5143\u7d20\u7684\u5185\u5bb9 <code>.text</code>","text":"<pre><code>&gt;&gt;&gt; root[0][1].text\n'2008'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#5get","title":"5.\u83b7\u53d6\u5c5e\u6027\u7684\u503c<code>.get</code>","text":"<pre><code>&gt;&gt;&gt; root[0].get(\"name\") \n'Liechtenstein'\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#6","title":"6. \u904d\u5386\u5b50\u5143\u7d20","text":"<pre><code>&gt;&gt;&gt; for child in root:\n...     print(child)\n... \n&lt;Element 'country' at 0x0000012451A447C8&gt;\n&lt;Element 'country' at 0x0000012451D31408&gt;\n&lt;Element 'country' at 0x0000012451D31598&gt;\n&gt;&gt;&gt; for child in root:\n...     print(\"\u5b50\u5143\u7d20\u6807\u7b7e\uff1a\",child.tag,\"\u5c5e\u6027\uff1a\",child.attrib)\n... \n\u5b50\u5143\u7d20\u6807\u7b7e\uff1a country \u5c5e\u6027\uff1a {'name': 'Liechtenstein'}\n\u5b50\u5143\u7d20\u6807\u7b7e\uff1a country \u5c5e\u6027\uff1a {'name': 'Singapore'}\n\u5b50\u5143\u7d20\u6807\u7b7e\uff1a country \u5c5e\u6027\uff1a {'name': 'Panama'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#7-iter","title":"7. \u904d\u5386\u6307\u5b9a\u5143\u7d20<code>.iter()</code>","text":"<pre><code>&gt;&gt;&gt; for neighbor in root.iter(\"neighbor\"):\n...     print(neighbor.attrib) \n... \n{'name': 'Austria', 'direction': 'E'}\n{'name': 'Switzerland', 'direction': 'W'}\n{'name': 'Malaysia', 'direction': 'N'}\n{'name': 'Costa Rica', 'direction': 'W'}\n{'name': 'Colombia', 'direction': 'E'}\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#8findallfind","title":"8.\u67e5\u627e\u5143\u7d20<code>findall</code>\u548c<code>find</code>","text":"<pre><code># findall \u67e5\u627e\u6307\u5b9a\u6807\u7b7e\u7684\u5143\u7d20\n&gt;&gt;&gt; for child in root.findall(\"country\"):\n...     print(child)\n... \n&lt;Element 'country' at 0x0000012451A447C8&gt;\n&lt;Element 'country' at 0x0000012451D31408&gt;\n&lt;Element 'country' at 0x0000012451D31598&gt;\n# find \u67e5\u627e\u6307\u5b9a\u6807\u7b7e\u4e0b\u7684\u7684\u5b50\u5143\u7d20\n&gt;&gt;&gt; for child in root.find(\"country\"):\n...     print(child)\n... \n&lt;Element 'rank' at 0x0000012451B42728&gt;\n&lt;Element 'year' at 0x0000012451D17B38&gt;\n&lt;Element 'gdppc' at 0x0000012451D17B88&gt;\n&lt;Element 'neighbor' at 0x0000012451D2C278&gt;\n&lt;Element 'neighbor' at 0x0000012451D313B8&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2_2","title":"2. \u4fee\u6539\u5185\u5bb9","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1-set","title":"1. \u4fee\u6539<code>.set</code>","text":"<pre><code>&gt;&gt;&gt; root[0][1].text \n'2008'\n# \u91cd\u65b0\u526f\u804c\n&gt;&gt;&gt; root[0][1].text = '2018'      \n&gt;&gt;&gt; root[0][1].set('updated', 'yes')       \nKeyboardInterrupt\n&gt;&gt;&gt; tree.write('output.xml')\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2-remove","title":"2. \u5220\u9664<code>.remove</code>","text":"<pre><code>&gt;&gt;&gt; for child in root.findall(\"country\"):\n...     if child.attrib['name'] == 'Liechtenstein':\n...             root.remove(child) \n... \n&gt;&gt;&gt; tree.write('output.xml') \n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#3xpath","title":"3.\u901a\u8fc7XPath\u5b9a\u4f4d\u5143\u7d20","text":"\u8bed\u6cd5 \u542b\u4e49 <code>tag</code> \u9009\u62e9\u5177\u6709\u7ed9\u5b9a\u6807\u7b7e\u7684\u6240\u6709\u5b50\u5143\u7d20 <code>*</code> \u9009\u62e9\u6240\u6709\u5b50\u5143\u7d20 <code>.</code> \u9009\u62e9\u5f53\u524d\u5143\u7d20\u3002\u5728xpath\u8868\u8fbe\u5f0f\u5f00\u5934\u4f7f\u7528\uff0c\u8868\u793a\u76f8\u5bf9\u8def\u5f84\u3002 <code>//</code> \u9009\u62e9\u5f53\u524d\u5143\u7d20\u4e0b\u6240\u6709\u7ea7\u522b\u7684\u6240\u6709\u5b50\u5143\u7d20 <code>..</code> \u9009\u62e9\u7236\u5143\u7d20 <code>[@attrib]</code> \u9009\u62e9\u5177\u6709\u7ed9\u5b9a\u5c5e\u6027\u7684\u6240\u6709\u5143\u7d20,\u5728\u540c\u7ea7\u4e0b\u9009\u53d6\uff0c\u5e76\u4e14\u4e0d\u5411\u5b50\u4ee3\u67e5\u627e <code>[@attrib='value']</code> \u9009\u62e9\u6307\u5b9a\u5c5e\u6027attrib\u5177\u6709\u6307\u5b9a\u503cvalue\u7684\u5143\u7d20 <code>[tag]</code> \u9009\u62e9\u6240\u6709\u5177\u6709\u540d\u4e3atag\u7684\u5b50\u5143\u7d20\u7684\u5143\u7d20 <code>[tag='text']</code> \u9009\u62e9\u5143\u7d20\uff08\u6216\u5176\u5b50\u5143\u7d20\uff09\u540d\u4e3atag\uff0c\u5b8c\u6574\u6587\u672c\u5185\u5bb9\u4e3a\u6307\u5b9a\u7684\u503ctext\u7684\u5143\u7d20\u3002 <code>[position]</code> \u9009\u62e9\u4f4d\u4e8e\u7ed9\u5b9a\u4f4d\u7f6e\u7684\u6240\u6709\u5143\u7d20\u3002\u8be5\u4f4d\u7f6e\u53ef\u4ee5\u662f\u6574\u6570\uff081\u662f\u7b2c\u4e00\u4e2a\u4f4d\u7f6e\uff09\uff0c\u8868\u8fbe\u5f0flast()\u7528\u4e8e\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\uff0c\u4e5f\u53ef\u4ee5\u662f\u76f8\u5bf9\u4e8e\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e\u7684\u4f4d\u7f6e\uff08\u4f8b\u5982last()-1\uff09 <pre><code>&gt;&gt;&gt; root.findall('./country/year') \n[&lt;Element 'year' at 0x0000012451D17B38&gt;, &lt;Element 'year' at 0x0000012451D31C28&gt;, &lt;Element 'year' at 0x0000012451D31DB8&gt;]\n# \u5728\u6240\u6709\u5b50\u5143\u7d20\u4e2d\u9009\u62e9\n&gt;&gt;&gt; for year in root.findall('*/year'):\n...     print(year.text) \n... \n2008\n2011\n2011\n# .. \u8868\u793a\u9009\u62e9\u7236\u5143\u7d20\uff08\u4e0a\u4e00\u7ea7\uff09\n&gt;&gt;&gt; root.findall('./country/..')[0].tag\n'data'\n# \u9009\u62e9\u5177\u6709\u7ed9\u5b9a\u5c5e\u6027\u7684\u6240\u6709\u5143\u7d20\n&gt;&gt;&gt; root.findall('./country/[@name]') \n[&lt;Element 'country' at 0x0000012451D2C278&gt;, &lt;Element 'country' at 0x0000012451D317C8&gt;, &lt;Element 'country' at 0x0000012451D31D18&gt;]\n# \u9009\u62e9\u6307\u5b9a\u5c5e\u6027attrib\u5177\u6709\u6307\u5b9a\u503cvalue\u7684\u5143\u7d20\n&gt;&gt;&gt; root.findall('./country/[@name=\"Panama\"]')\n[&lt;Element 'country' at 0x0000012451D31D18&gt;]\n# \u9009\u62e9\u6240\u6709\u5177\u6709\u540d\u4e3atag\u7684\u5b50\u5143\u7d20\u7684\u5143\u7d20\n&gt;&gt;&gt; root.findall('./country/[year]')  \n[&lt;Element 'country' at 0x0000012451D2C278&gt;, &lt;Element 'country' at 0x0000012451D317C8&gt;, &lt;Element 'country' at 0x0000012451D31D18&gt;]\n# \u9009\u62e9\u5143\u7d20\uff08\u6216\u5176\u5b50\u5143\u7d20\uff09\u540d\u4e3atag\uff0c\u5b8c\u6574\u6587\u672c\u5185\u5bb9\u4e3a\u6307\u5b9a\u7684\u503ctext\u7684\u5143\u7d20\u3002\n&gt;&gt;&gt; root.findall(\"./country/[year='2008']\")  \n[&lt;Element 'country' at 0x0000012451D2C278&gt;]\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#configparser","title":"\u56db\u3001configparser\u6a21\u5757","text":"<p>\u914d\u7f6e\u6587\u4ef6\u89e3\u6790\u5668</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#1_3","title":"1. \u521b\u5efa\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>import configparser\n\nconfig = configparser.ConfigParser()\n\nconfig[\"DEFAULT\"] = {'user': 'ubuntu',\n                     'port': '22'}\n\nconfig['web'] = {}\nconfig['web']['manage'] = 'manageweb'\n\nconfig['api'] = {}\napi = config['api']\napi['manage'] = 'manage.war'\n\nwith open('test.conf', 'w') as configfile:\n    config.write(configfile)\n</code></pre> <p>\u521b\u5efa\u597d\u7684\u914d\u7f6e\u6587\u4ef6</p> <pre><code>$ cat test.conf \n[DEFAULT]\nuser = ubuntu\nport = 22\n\n[web]\nmanage = manageweb\n\n[api]\nmanage = manage.war\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#2_3","title":"2. \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>import configparser\n\nconfig = configparser.ConfigParser()\n# \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\nconfig.read('test.conf')\n# \u67e5\u770b\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u7ae0\u8282\uff0c\u4e0d\u5305\u542bDEFAULT\nprint(config.sections())\n# \u67e5\u770b\u67d0\u4e00\u4e2a\u914d\u7f6e\u7684\u503c\nprint(config['api']['manage'])\n# \u5224\u65ad\u7ae0\u8282\u662f\u5426\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u5b58\u5728\nprint('db' in config)\n# \u7528get\u8bfb\u53d6\u503c\nprint(config['DEFAULT'].get('port'))\n# \u6216\nprint(config.get('api', 'manage'))\n# \u5982\u679c\u6ca1\u6709get\u5230\uff0c\u8fd4\u56de\u4e00\u4e2a\u6307\u5b9a\u7684\u503c\nprint(config.get('test', 'test', fallback='not find'))\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>$ python3 test.py \n['web', 'api']\nmanage.war\nFalse\n22\nmanage.war\nnot find\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#3_2","title":"3. \u4fee\u6539\u914d\u7f6e\u6587\u4ef6","text":"<pre><code>import configparser\n\nimport configparser\n\nconfig = configparser.ConfigParser()\n# \u8bfb\u53d6\u914d\u7f6e\u6587\u4ef6\nconfig.read('test.conf')\n# \u6dfb\u52a0\u4e00\u4e2a\u7ae0\u8282\nconfig.add_section('mysql')\n# \u6dfb\u52a0\u4e00\u4e2a\u952e\u503c\u5bf9\nconfig.set('mysql', 'host', '127.0.0.1')\n# \u4fdd\u5b58\u5230\u6587\u4ef6\u4e2d\nconfig.write(open('test.conf', 'w'))\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/08-%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/#cvs","title":"\u4e94\u3001cvs","text":"<pre><code>import csv\n# \u5199\u5165\n# \u4e3a\u4e86\u4fdd\u8bc1WindowLinux\u548c\u884c\u5c3e\u7684\u7b26\u53f7\u4e00\u81f4\uff0c\u6700\u597d\u7684\u52a0\u4e0anewline=''\nwith open('hosts.csv', 'w', newline='') as hostsfile:\n    # \u5b9a\u4e49\u5b57\u7b26\u76f4\u63a5\u7684\u5206\u5272\u7b26\u4e3a\u7a7a\u683c\uff08delimiter=' '\uff09\n    # writer = csv.writer(hostsfile, delimiter=' ')\n    writer = csv.writer(hostsfile,)\n    # \u5199\u5165\u4e00\u884c\n    writer.writerow(['IP', 'username', 'password'])\n    writer.writerow(['192.168.1.10', 'root', '123456'])\n    # \u5199\u5165\u591a\u884c\uff0c\u4f20\u5165\u53c2\u6570\u4e3a\u4e00\u4e2a\u5d4c\u5957\u5143\u7ec4\uff0c\u6bcf\u4e00\u884c\u90fd\u5b58\u5728\u5728\u4e00\u4e2a\u5143\u7ec4\u4e2d\n    writer.writerows([['192.168.1.11', 'admin', '123456'], ['192.168.1.12', 'admin', '123456']])\n# \u8bfb\nwith open('hosts.csv', newline='') as hostsfile:\n    reader = csv.reader(hostsfile, delimiter=' ')\n    for row in reader:\n        print(row)\n</code></pre> <pre><code>import csv\n\n# \u4f7f\u7528\u7c7b\u65b9\u6cd5\u64cd\u4f5c\n# \u5199\u5165\nwith open('hosts.csv', 'w', newline='') as hostsfile:\n    fieldnames = ['IP', 'username', 'password', 'port']\n    # \u8bbe\u7f6e\u201c\u6807\u9898\u201d\n    writer = csv.DictWriter(hostsfile, fieldnames=fieldnames)\n    # \u5199\u5165\u6807\u9898\n    writer.writeheader()\n    # \u53c2\u6570\u683c\u5f0f\u5fc5\u987b\u662f\u4e00\u4e2a\u5b57\u5178,\n    # \u5199\u5165\u5355\u884c\n    writer.writerow({'IP': '192.168.1.10', 'username': 'root', 'password': '123456', 'port': '22'})\n\n    # \u5199\u5165\u591a\u884c,\u4f20\u5165\u7684\u53c2\u6570\u5fc5\u987b\u662f\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u91cc\u9762\u7684\u5143\u7d20\u662f\u5b57\u5178\u683c\u5f0f\u7684\uff0c\u8fd9\u91cc\u7528\u5143\u7ec4\n    writer.writerows([{'IP': '192.168.1.11', 'username': 'root', 'password': '123456', 'port': '22'},\n                     {'IP': '192.168.1.12', 'username': 'root', 'password': '123456', 'port': '22'}])\n\n\n\n\n# \u8bfb\u53d6\n#\nwith open('hosts.csv', newline='') as hostsfile:\n     reader = csv.DictReader(hostsfile)\n     for row in reader:\n         # \u8fd4\u56de\u7ed3\u679c\u4e3a\u5b57\u5178\u683c\u5f0f\n         print(row)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/","title":"Python\u5f02\u5e38\u5904\u7406","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_1","title":"\u4e00\u3001 \u5f02\u5e38\u5904\u7406","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_2","title":"\u7528\u6cd5\u4e00","text":"<pre><code>#!/usr/bin/env python3\ntry:\n    action()\nexcept NameError as e:\n    print(\"\u9519\u8bef\u4fe1\u606f\uff1a\",e)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_3","title":"\u7528\u6cd5\u4e8c","text":"<pre><code>#!/usr/bin/env python3\ntry:\n    action()\nexcept NameError as e:\n    print(\"\u9519\u8bef\u4fe1\u606f\uff1a\",e)\nexcept IndexError as e:\n    print(\"\u9519\u8bef\u4fe1\u606f\uff1a\",e) \n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_4","title":"\u7528\u6cd5\u4e09","text":"<pre><code>#!/usr/bin/env python3\ntry:\n    action()\nexcept NameError as e:\n    print(\"\u9519\u8bef\u4fe1\u606f\uff1a\",e)\nexcept (IndexError, KeyError) as e:\n    print(\"\u9519\u8bef\u4fe1\u606f\uff1a\",e) \n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_5","title":"\u7528\u6cd5\u56db","text":"<pre><code>try:\n    action()\nexcept Exception as e:\n    print(\"\u9519\u8bef\u4fe1\u606f\uff1a\",e)\nelse: # \u5982\u679c\u4e3b\u8981\u6267\u884c\u7684\u4ee3\u7801\u6ca1\u6709\u9519\u8bef\uff0c\u5c31\u6267\u884celse\u4e2d\u7684\u5185\u5bb9\n    print(\"===\")\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_6","title":"\u7528\u6cd5\u4e94","text":"<pre><code>try:\n    action()\nfinally: # \u4e0d\u5904\u7406\u5f02\u5e38\uff0c\u65e0\u8bba\u662f\u5426\u53d1\u751f\u5f02\u5e38\u90fd\u4f1a\u6267\u884cfinally\u7684\u5b50\u4ee3\u7801\n    print(\"===\")\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_7","title":"\u4e8c\u3001 \u4e3b\u52a8\u629b\u51fa\u5f02\u5e38","text":"<pre><code>try:\n  raise Exception('\u4e3b\u52a8\u629b\u51fa\u7684\u5f02\u5e38')\nexcept Exception as e:\n  print(e)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#_8","title":"\u4e09\u3001\u81ea\u5b9a\u4e49\u5f02\u5e38","text":"<pre><code>class myError(Exception):\n  \"\"\" \u81ea\u5b9a\u4e49\u5f02\u5e38\"\"\"\n  def __init__(self,msg):\n    self.message = msg\n  def __str__(self):\n    return self.message\n\ntry:\n  raise myError('\u81ea\u5b9a\u4e49\u7684\u5f02\u5e38')\nexcept Exception as e:\n  print(e)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/09-%E5%BC%82%E5%B8%B8%E4%B8%8E%E6%B5%8B%E8%AF%95/#assert","title":"\u56db\u3001\u65ad\u8a00 assert","text":"<p>\u4f7f\u7528\u683c\u5f0f\uff1a<code>assert \u6761\u4ef6</code>   \u6761\u4ef6\u6210\u7acb\u7ee7\u7eed\u6267\u884c   \u7528\u4e8e\u5f3a\u5236\u7528\u6237\u670d\u4ece\u6761\u4ef6\uff0c\u5426\u5219\u62a5\u9519\uff0c\u53ef\u4ee5\u6355\u83b7\uff0c\u4f46\u4e00\u822c\u4e0d\u6355\u83b7</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/","title":"\u534f\u7a0b","text":"<p>\u51fd\u6570\u5bf9\u8c61\u548c\u4ee3\u7801\u5bf9\u8c61</p> <p>\u6bcf\u5f53\u5b9a\u4e49\u4e86\u4e00\u4e2a\u51fd\u6570\u4e4b\u540e\uff0c\u5c31\u5f97\u5230\u4e00\u4e2a\u51fd\u6570\u5bf9\u8c61</p> <pre><code>&gt;&gt;&gt; def func():\n...     x = 1\n...     return x\n...\n&gt;&gt;&gt; func\n&lt;function func at 0x7fd462070510&gt;\n</code></pre> <p>\u51fd\u6570\u4e2d\u7684\u4ee3\u7801\u662f\u4fdd\u5b58\u5728\u4ee3\u7801\u5bf9\u8c61\u4e2d\u7684</p> <pre><code>&gt;&gt;&gt; func.__code__\n&lt;code object func at 0x7fd4620e0780, file \"&lt;stdin&gt;\", line 1&gt;\n</code></pre> <p>\u4ee3\u7801\u5bf9\u8c61\u968f\u7740\u51fd\u6570\u4e00\u8d77\u521b\u5efa\uff0c\u662f\u51fd\u6570\u5bf9\u8c61\u7684\u4e00\u4e2a\u91cd\u8981\u5c5e\u6027\u3002</p> <p>\u4ee3\u7801\u5bf9\u8c61\u4e2d\u7684\u91cd\u8981\u7684\u5c5e\u6027\u4ee5<code>co__</code>\u5f00\u5934</p> <pre><code>&gt;&gt;&gt; func_code = func.__code__\n&gt;&gt;&gt; for attr in dir(func_code):\n...     if attr.startswith('co_'):\n...         print(f'{attr}\\t: {getattr(func_code, attr)}')\n...\nco_argcount     : 0\nco_cellvars     : ()\nco_code : b'd\\x01}\\x00|\\x00S\\x00'\nco_consts       : (None, 1)\nco_filename     : &lt;stdin&gt;\nco_firstlineno  : 1\nco_flags        : 67\nco_freevars     : ()\nco_kwonlyargcount       : 0\nco_lnotab       : b'\\x00\\x01\\x04\\x01'\nco_name : func\nco_names        : ()\nco_nlocals      : 1\nco_stacksize    : 1\nco_varnames     : ('x',)\n</code></pre> <p>\u51fd\u6570\u8fd0\u884c\u5e27</p> <p>\u51fd\u6570\u5bf9\u8c61\u548c\u4ee3\u7801\u5bf9\u8c61\u4fdd\u5b58\u4e86\u51fd\u6570\u7684\u57fa\u672c\u4fe1\u606f\uff0c\u5f53\u51fd\u6570\u8fd0\u884c\u7684\u65f6\u5019\uff0c\u8fd8\u9700\u8981\u4e00\u4e2a\u5bf9\u8c61\u6765\u4fdd\u5b58\u8fd0\u884c\u65f6\u7684\u72b6\u6001\u3002\u8fd9\u4e2a\u5bf9\u8c61\u5c31\u662f\u5e27\u5bf9\u8c61(Frame object)\u3002</p> <p>\u6bcf\u4e00\u6b21\u8c03\u7528\u51fd\u6570\uff0c\u90fd\u4f1a\u81ea\u52a8\u521b\u5efa\u4e00\u4e2a\u5e27\u5bf9\u8c61\uff0c\u8bb0\u5f55\u5f53\u6b21\u8fd0\u884c\u7684\u72b6\u6001\u3002</p> <pre><code>&gt;&gt;&gt; import inspect\n&gt;&gt;&gt; def foo():\n...     return inspect.currentframe()  # \u83b7\u53d6\u5230\u51fd\u6570\u7684\u8fd0\u884c\u5e27\u5e76\u8fd4\u56de\n...\n&gt;&gt;&gt;\n&gt;&gt;&gt; f1 = foo()  # \u7531\u4e8e\u53d8\u91cf\u88ab\u5f15\u7528\uff0c\u6240\u4ee5\u5e27\u4e0d\u4f1a\u88ab\u5783\u573e\u56de\u6536\n&gt;&gt;&gt; f1\n&lt;frame object at 0x7f3f80ed6868&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; f2 = foo()  # \u518d\u8c03\u7528\u4e00\u6b21\uff0c\u5f97\u5230\u53e6\u4e00\u4e2a\u5e27\n&gt;&gt;&gt; f2\n&lt;frame object at 0x7f3f80ed6ba8&gt;\n</code></pre> <p>\u51fd\u6570\u8fd0\u884c\u6808 \u5f53\u4e00\u4e2a\u51fd\u6570\u4e2d\u8c03\u7528\u4e86\u53e6\u4e00\u4e2a\u51fd\u6570\uff0c\u6b64\u65f6\u524d\u4e00\u4e2a\u51fd\u6570\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u6240\u4ee5\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u5bf9\u8c61\u662f\u540c\u65f6\u5b58\u5728\u7684\u3002 \u6bd4\u5982\u6211\u4eec\u7684\u7a0b\u5e8f\u4e00\u822c\u90fd\u59cb\u4e8emain\u51fd\u6570\uff0c \u7136\u540e\u53c8\u8c03\u7528\u5176\u5b83\u51fd\u6570\uff0c\u4ee5\u6b64\u7c7b\u63a8 \u56e0\u6b64\uff0c\u4e00\u4e2a\u7a0b\u5e8f\u7684\u8fd0\u884c\u671f\uff0c\u540c\u65f6\u5b58\u5728\u5f88\u591a\u4e2a\u5e27\u5bf9\u8c61\u3002 \u51fd\u6570\u4e4b\u95f4\u7684\u8c03\u7528\u5173\u7cfb\u662f\u5148\u6267\u884c\u7684\u540e\u9000\u51fa\uff0c\u6240\u4ee5\u5e27\u5bf9\u8c61\u4e4b\u95f4\u7684\u5173\u7cfb\u4e5f\u662f\u5148\u5165\u540e\u51fa\uff0c\u6b63\u597d\u4ee5\u6808\u7684\u5f62\u5f0f\u4fdd\u5b58\u3002\u56e0\u6b64\uff0c\u51fd\u6570\u7684\u8fd0\u884c\u771f\u53c8\u79f0\u4e3a\u6808\u5e27\u3002 \u6ce8\u610f\uff1a\u4e00\u4e2a\u7ebf\u7a0b\u53ea\u6709\u4e00\u4e2a\u51fd\u6570\u8fd0\u6808\u5e27\u3002</p> <p>\u751f\u6210\u5668\u51fd\u6570\u4ecd\u7136\u662f\u51fd\u6570\u5bf9\u8c61\uff0c\u5f53\u7136\u4e5f\u5305\u62ec\u4e86\u4ee3\u7801\u5bf9\u8c61\u3002</p> <p>\u8c03\u7528\u751f\u6210\u5668\u51fd\u6570\u4e0d\u4f1a\u76f4\u63a5\u8fd0\u884c\uff08\u4e5f\u5c31\u662f\u8bf4\uff0c\u4e0d\u50cf\u666e\u901a\u51fd\u6570\u90a3\u6837\u521b\u5efa\u987f\u5bf9\u8c61\u5e76\u4e14\u538b\u5165\u51fd\u6570\u6808\uff09\uff0c\u800c\u662f\u5f97\u5230\u4e00\u4e2a\u751f\u6210\u5668\u5bf9\u8c61\u3002</p> <p>\u5f53\u6bcf\u6b21\u4f7f\u7528next()\u5bf9\u751f\u6210\u5668\u8fdb\u884c\u8fed\u4ee3\u662f\uff0c\u90fd\u7528\u8fd9\u4e2a\u5e27(fi_frame)\u5bf9\u8c61\u6765\u4fdd\u5b58\u72b6\u6001\u3002</p> <p><pre><code>&gt;&gt;&gt; import inspect\n&gt;&gt;&gt; def gen_foo():\n...     for _ in range(10):\n...         yield inspect.currentframe()\n...\n&gt;&gt;&gt; gf = gen_foo()\n&gt;&gt;&gt; gi_frame = gf.gi_frame  # \u5b58\u4e3a\u53d8\u91cf\uff0c\u4e0d\u7136\u8fed\u4ee3\u7ed3\u675f\u540e\u8be5\u5c5e\u6027\u4f1a\u6e05\u7a7a\n&gt;&gt;&gt; frames = list(gf)  # \u4fdd\u5b58\u6240\u6709\u8fed\u4ee3\u7684\u7ed3\u679c\n&gt;&gt;&gt; print(gf.gi_frame)\nNone\n&gt;&gt;&gt; for f in frames:\n...     print(f is gi_frame)\n...\nTrue\nTrue\nTrue\nTrue\nTrue\nTrue\nTrue\nTrue\nTrue\nTrue\n</code></pre> \u7ed3\u8bba\uff1a 1. \u751f\u6210\u5668\u51fd\u6570\u5e76\u4e0d\u76f4\u63a5\u8fd0\u884c\uff0c\u800c\u662f\u501f\u52a9\u4e8e\u751f\u6210\u5668\u5bf9\u8c61\u6765\u95f4\u63a5\u8fd0\u884c 2. \u521b\u5efa\u751f\u6210\u5668\u5bf9\u8c61\u7684\u540c\u65f6\u521b\u5efa\u4e86\u5e27\u5bf9\u8c61\uff0c\u5e76\u7531\u751f\u6210\u5668\u5bf9\u8c61\u4fdd\u6301\u5f15\u7528 3. \u6bcf\u6b21\u4f7f\u7528<code>next()</code>\u8c03\u7528\u751f\u6210\u5668\u65f6\uff0c\u5c31\u662f\u5c06\u751f\u6210\u5668\u5f15\u7528\u7684\u5bf9\u8c61\u5165\u6808 4. \u5f53<code>next()</code>\u8fd4\u56de\u65f6\uff0c\u4e5f\u5c31\u662f\u4ee3\u7801\u9047\u5230yield\u6682\u505c\u7684\u65f6\u5019\uff0c\u5c31\u662f\u5c06\u51fa\u6808\u76f4\u5230\u8fed\u4ee3\u7ed3\u675f\uff0c\u6700\u540e\u4e00\u6b21\u51fa\u6808\uff0c\u5e76\u4e14\u88ab\u9500\u6bc1</p> <p>\u540c\u6b65\u548c\u5f02\u6b65</p> <p>\u666e\u901a\u51fd\u6570</p> <ul> <li>\u8c03\u7528\u51fd\u6570\uff1a\u6784\u5efa\u5e27\u5bf9\u8c61\u5e76\u5165\u6808</li> <li>\u51fd\u6570\u7ed3\u675f\uff1a\u5e27\u51fa\u6808\u5e76\u9500\u6bc1</li> </ul> <p>\u751f\u6210\u5668\u51fd\u6570</p> <ul> <li>\u521b\u5efa\u751f\u6210\u5668\uff1a\u6784\u5efa\u5e27\u5bf9\u8c61 -\uff08\u591a\u6b21\uff09\u901a\u8fc7next\u89e6\u53d1\u6267\u884c\uff1a\u5e27\u5165\u6808 -\uff08\u591a\u6b21\uff09\u9047\u5230yield\uff1a\u5e27\u51fa\u6808\uff08\u4fdd\u7559</li> <li>\u9009\u4ee3\u7ed3\u675f\uff1a\u987f\u51fa\u6808\u5e76\u9500\u6bc1</li> </ul> <pre><code>In [2]: def async_task():\n   ...:     print(\"step1\")\n   ...:     yield\n   ...:     print(\"step2\")\n   ...:     yield\n   ...:     print(\"step3\")\n   ...:     yield\n   ...:\n   ...: # \u4efb\u52a1\u961f\u5217\n   ...: all_tasks = []\n   ...:\n   ...: # \u521b\u5efa2\u4e2a\u4efb\u52a1\n   ...: async_task_a = async_task()\n   ...: async_task_b = async_task()\n   ...:\n   ...: # \u52a0\u5165\u5230\u4efb\u52a1\u961f\u5217\n   ...: all_tasks.append(async_task_a)\n   ...: all_tasks.append(async_task_b)\n   ...:\n   ...: def async_task_run():\n   ...:     \"\"\"\u4e00\u4e2a\u7b80\u964b\u7684\u4e00\u90e8\u4efb\u52a1\u8c03\u5ea6\u5668\"\"\"\n   ...:     for task in all_tasks:\n   ...:         next(task)\n   ...:\n   ...: async_task_run()\n   ...: async_task_run()\n   ...: async_task_run()\nstep1\nstep1\nstep2\nstep2\nstep3\nstep3\n</code></pre> <p>\u751f\u6210\u5668\u5bf9\u8c61\u662f\u4e00\u4e2a\u7528\u6765\u9009\u4ee3\u6267\u884c\u751f\u6210\u5668\u51fd\u6570\u7684\u9009\u4ee3\u5668\u3002 \u6570\u636e\u7684\u9009\u4ee3\u5668\uff1a\u9488\u5bf9\u4e00\u4e2a\u5305\u542b\u5f88\u591a\u5143\u7d20\u7684\u6570\u636e\u96c6\uff0c\u9010\u4e2a\u8fd4\u56de\u5176\u4e2d\u7684\u5143\u7d20 \u751f\u6210\u5668\u9009\u4ee3\u5668\uff1a\u9488\u5bf9\u4e00\u4e2a\u5305\u542b\u5f88\u591a\u4ee3\u7801\u7684\u51fd\u6570\uff0c\u5206\u6bb5\u6267\u884c\u5176\u4e2d\u4ee3\u7801 \u8ba9\u4e00\u4e2a\u51fd\u6570\u53ef\u4ee5\u591a\u6b21\u9009\u4ee3\u8fd0\u884c\u5176\u4e2d\u7684\u4ee3\u7801\u624d\u662f\u751f\u6210\u5668\u5bf9\u8c61\u6700\u6700\u6839\u672c\u7684\u4f5c\u7528\uff0c\u800c\u4e0d\u4ec5\u662f\u5b57\u9762\u610f\u601d\u4e0a\u7684\u751f\u6210\u6570\u636e\u7684\u4e1c\u897f\u3002 \u9001\u4ee3\u4ea7\u51fa\u6570\u636e\u53ea\u662f\u9009\u4ee3\u6267\u884c\u4ee3\u7801\u7684\u81ea\u7136\u7ed3\u679c\u800c\u5df2 \u5f53\u7528\u751f\u6210\u5668\u6765\u5b9e\u73b0\u4ee3\u5668\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5173\u6ce8\u7684\u662f\u91cd\u70b9\u662f\uff1a<code>yield &lt;value&gt;</code>\u8fd4\u56de\u51fa\u6765\u7684\u6570\u636e \u5982\u679c\u628a\u7126\u70b9\u96c6\u4e2d\u5230\u88ab\u9009\u4ee3\u6267\u884c\u7684\u4ee3\u7801\u4e86\u4e0a\uff0c\u5c31\u80fd\u5bf9\u751f\u6210\u5668\u6709\u4e2a\u5168\u65b0\u7684\u89c6\u89d2\uff0c\u90a3\u5c31\u662f\u534f\u7a0b\u3002</p> <p>\u57fa\u4e8e\u751f\u6210\u5668\u7684\u534f\u7a0b\uff1a \u5728python3.8\u5f03\u7528\uff0c\u57283.11\u7248\u672c\u79fb\u9664\uff0c\u4f7f\u7528<code>sync def</code>\u4ee3\u66ff\u3002</p> <p>\u534f\u7a0b\uff08yiled\u7248\uff09 yield\u8868\u8fbe\u5f0f</p> <p>\u4e3a\u751f\u6210\u5668\u589e\u52a0\u4e00\u4e2a<code>send()</code>\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u53ef\u4ee5\u63a5\u53d7\u4e00\u4e2a\u5165\u53c2\u3002 send\u65b9\u6cd5\u987e\u540d\u601d\u4e49\uff0c\u5c06\u8be5\u53c2\u6570\u53d1\u9001\u7ed9\u751f\u6210\u5668\uff0c\u4f7f\u751f\u6210\u5668\u6062\u590d\u8fd0\u884c\u7684\u540c\u65f6\uff0c\u5c06\u8be5\u5165\u53c2\u4f5c\u4e3ayield\u8868\u8fbe\u5f0f\u7684\u503c\u3002</p> <pre><code>&gt;&gt;&gt; def show_yield_value():\n...     print(\"\u5f00\u59cb\")\n...     x = yield\n...     print('x is ', x)\n...\n&gt;&gt;&gt; g = show_yield_value()\n&gt;&gt;&gt; g.send(None)  # \u7b2c\u4e00\u6b21\u53ea\u80fd\u4f20None\n\u5f00\u59cb\n&gt;&gt;&gt; g.send('hello')\nx is  hello\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>\u5bf9\u4e8e\u521a\u521b\u5efa\u597d\u7684\u751f\u6210\u5668\uff0c\u603b\u662f\u9700\u8981\u5728\u7b2c\u4e00\u6b21\u7684\u65f6\u5019send(None)\u503c\uff0c\u4f7f\u5176\u8fd0\u884c\u5230yied\u7684\u5730\u65b9\u6682\u505c\uff0c\u8fd9\u4e2a\u6b65\u9aa4\u672f\u8bed\u79f0\u4e3aprime(\u6fc0\u6d3b)\u3002</p> <p>yield\u8868\u8fbe\u5f0f\u7684\u4f18\u5148\u7ea7</p> <pre><code>&gt;&gt;&gt; def add_yield_value():\n...     x = yield + 1\n...     print('x is ', x)\n...\n&gt;&gt;&gt; g = add_yield_value()\n&gt;&gt;&gt; g.send(None)\n1\n&gt;&gt;&gt; g.send(1)\nx is  1  # \u4e0d\u590d\u5408\u9884\u671f\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>yield\u4f18\u5148\u7ea7\u6bd4\u8f83\u4f4e\uff0c\u9700\u8981\u7ed9yield\u52a0\u62ec\u53f7</p> <pre><code>&gt;&gt;&gt; def add_yield_value():\n...     x = (yield) + 1\n...     print('x is ', x)\n...\n&gt;&gt;&gt; g = add_yield_value()\n&gt;&gt;&gt; g.send(None)\n&gt;&gt;&gt; g.send(1)\nx is  2\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>send()\u7528\u6cd5\u603b\u7ed3</p> <ol> <li>send\u662f\u751f\u6210\u5668\u5bf9\u8c61\u7684\u65b9\u6cd5</li> <li>\u5bf9\u4e8e\u751f\u6210\u5668\u5bf9\u8c61<code>g.next(g)</code>\u7b49\u4ef7\u4e8e<code>g.send(None)</code></li> <li>\u53ea\u6709\u5f53\u751f\u6210\u5668\u5904\u5728\u6682\u505c\u72b6\u6001\u65f6\uff0c\u624d\u80fd\u4f20\u5165\u975eNone\u7684\u503c</li> <li>send\u65b9\u6cd5\u662f\u4e3a\u4e86\u534f\u7a0b\u800c\u589e\u52a0\u7684API\uff0c\u6240\u4ee5\uff1a</li> <li>\u5982\u679c\u5c06\u751f\u6210\u5668\u89c6\u4f5c\u534f\u7a0b\uff0c\u5c31\u5e94\u8be5\u53ea\u7528send\u65b9\u6cd5</li> <li>\u5982\u679c\u89c6\u4f5c\u9001\u4ee3\u5668\uff0c\u5c31\u4ecd\u7528next</li> </ol> <p>\u4f7f\u7528<code>close()</code>\u7ed3\u675f\u751f\u6210\u5668</p> <p><pre><code>&gt;&gt;&gt; def gen_echo():\n...     while True:\n...         print((yield))\n...\n&gt;&gt;&gt; echo = gen_echo()\n&gt;&gt;&gt; echo.send(None)\n&gt;&gt;&gt; for i in range(3):\n...    echo.send(i)\n...\n0\n1\n2\n&gt;&gt;&gt; echo.send(StopIteration('stop'))\nstop\n</code></pre> \u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\u65e0\u6cd5\u4f7f\u7528StopIteration\u7ed3\u675f\u3002</p> <p>\u5f53\u751f\u6210\u5668\u4f5c\u4e3a\u4ee3\u5668\u6765\u7528\u7684\u65f6\u5019\uff0c\u5b83\u7684\u751f\u547d\u5468\u671f\u53d6\u51b3\u4e8e\u6709\u591a\u5c11\u5143\u7d20\u53ef\u4ee5\u9009\u4ee3\u3002 \u800c\u5f53\u4f5c\u534f\u7a0b\u6765\u7528\u7684\u65f6\u5019\uff0c\u901a\u5e38\u53ef\u4ee5\u89c6\u4f5c\u662f\u5728\u6267\u884c\u4e00\u4e2a\u4efb\u52a1\uff0c\u6211\u4eec\u5e0c\u671b\u4efb\u52a1\u7684\u7ec8\u6b62\u80fd\u591f\u53d8\u5f97\u53ef\u63a7\u3002close()\u65b9\u6cd5\u5c31\u662f\u7528\u6765\u7ed3\u675f\u4e00\u4e2a\u534f\u7a0b\u3002</p> <pre><code>&gt;&gt;&gt; def gen_echo():\n...     while True:\n...         print((yield))\n...\n&gt;&gt;&gt; echo = gen_echo()\n&gt;&gt;&gt; echo.send(None)\n&gt;&gt;&gt; for i in range(3):\n...    echo.send(i)\n...\n0\n1\n2\n&gt;&gt;&gt; echo.send(StopIteration('stop'))\nstop\n&gt;&gt;&gt; echo.close()\n&gt;&gt;&gt; echo.send(4)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre> <p>\u7531\u4e8eecho\u534f\u7a0b\u7684\u5185\u5bb9\u975e\u5e38\u7b80\u5355\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u7ed3\u675f \u5982\u679c\u534f\u7a0b\u7684\u4ee3\u7801\u6bd4\u8f83\u590d\u6742\uff0c\u5b83\u53ef\u80fd\u9700\u8981\u5728\u7ed3\u675f\u7684\u65f6\u5019\u505a\u4e00\u4e9b\u5584\u540e\u5904\u7406\uff0c\u6bd4\u5982\u91ca\u653e\u8d44\u6e90\u7b49\u7c7b\u4f3c\u4e8eStopiteration\u7684\u5b9e\u73b0\u673a\u5236\uff0c\u7ed3\u675f\u534f\u7a0b\u4e5f\u662f\u9760\u5f02\u5e38\u6765\u5b9e\u73b0\u7684\u3002</p> <pre><code>&gt;&gt;&gt; def gen_echo():\n...     while True:\n...         try:\n...             x = yield\n...         except GeneratorExit:\n...             print('exit. bye')\n...             return\n...         else:\n...             print('x')\n...\n&gt;&gt;&gt; echo = gen_echo()\n&gt;&gt;&gt; echo.send(None)\n&gt;&gt;&gt; echo.close()\nexit. bye\n&gt;&gt;&gt;\n&gt;&gt;&gt; echo = gen_echo()\n&gt;&gt;&gt; echo.send(None)\n&gt;&gt;&gt; # \u9664\u4e86\u663e\u5f0f\u5730\u8c03\u7528close\u65b9\u6cd5\uff0c\u5982\u679c\u751f\u6210\u5668\u5bf9\u8c61\u88ab\u5783\u573e\u56de\u6536\uff0c\u4e5f\u4f1a\u81ea\u52a8\u8c03\u7528c1ose\n...\n&gt;&gt;&gt; del echo\nexit. bye\n</code></pre> <p>\u4f7f\u7528throw()\u5c06\u5f02\u5e38\u629b\u7ed9yield</p> <pre><code>&gt;&gt;&gt; def gen_echo():\n...     while True:\n...         try:\n...             x = yield\n...         except GeneratorExit:\n...             print('exit. bye')\n...             return\n...         except KeyboardInterrupt:\n...             print('\u6309\u4e0b\u4e86 Ctrl-C')\n...         else:\n...             print('x')\n...\n&gt;&gt;&gt; echo = gen_echo()\n&gt;&gt;&gt; echo.send(None)\n&gt;&gt;&gt; echo.throw(KeyboardInterrupt)\n\u6309\u4e0b\u4e86 Ctrl-C\n</code></pre> <p>yield\u4f5c\u7528 1.\u5728yield\u7684\u4f4d\u7f6e\u4ea7\u51fa\u6570\u636e 2.\u5728yield\u7684\u4f4d\u7f6e\u6682\u505c 3.\u5728yield\u7684\u4f4d\u7f6e\u6062\u590d\uff0c\u5e76\u63a5\u53d7\u65b0\u7684\u53c2\u6570 4.\u5728yield\u7684\u4f4d\u7f6e\u4f20\u5165\u7ed3\u675f\u4fe1\u53f7 5.\u5728yield\u7684\u4f4d\u7f6e\u4f20\u5165\u5176\u5b83\u5f02\u5e38 </p> <p>\u751f\u6210\u5668\u7684\u4e09\u79cd\u7528\u6cd5</p> <p>\u751f\u6210\u5668\u4e09\u79cd\u7528\u6cd5\uff1a 1. <code>yield x</code> 2. <code>x = yield y</code> 3. <code>field from sleep(1)</code></p> <p>\u751f\u6210\u5668\u67093\u79cd\u6a21\u5f0f 1. pull\uff1a\u7279\u70b9\u5728\u4e8e\u80fd\u4e0d\u65ad\u5411\u5916\u4ea7\u51fa\u6570\u636e\uff0c\u4e5f\u5c31\u662f\u9009\u4ee3\u5668 2. push\uff1a\u7279\u70b9\u5728\u4e8e\u80fd\u4e0d\u65ad\u5411\u5185\u53d1\u9001\u6570\u636e\uff0c\u662f\u975e\u5e38\u65e9\u671f\u7684\u534f\u7a0b\u6982\u5ff5 3. task\uff1a\u4efb\u52a1\u5f0f\uff08\u662fasyncio\u91cc\u7684\u534f\u7a0b\uff09</p> <p>pull\u548cpush\u662f\u53d7\u6570\u636e\u9a71\u52a8\u7684 task\u662f\u53d7\u4efb\u52a1\u9a71\u52a8\u7684</p> <p>event</p> <p>\u4e8b\u4ef6\uff08event\uff09\u662f\u4e00\u4e2a\u62bd\u8c61\u7684\u6982\u5ff5\uff0c\u5c31\u662f\u6307\u4e00\u4ef6\u4e8b\u60c5\u53d1\u751f\u4e86 \u4f8b\u5982\uff1a\u8981\u4f11\u606f3\u79d2\u949f\u540e\u7ee7\u7eed\u6267\u884c\u6ef4\u7b54\uff0c\u6ef4\u7b54\uff0c\u6ef4\u7b543\u79d2\u65f6\u95f4\u5230\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u4e8b\u4ef6\u3002 \u518d\u4f8b\u5982\uff1a\u8981\u8bfb\u53d6\u7f51\u7edc\u6570\u636e<code>socket.recv(1024)</code>;\u5982\u679csocket\u8fd8\u6ca1\u63a5\u53d7\u5230\u6570\u636e\uff0c\u6b64\u65f6\u8fd9\u4e2a\u8c03\u7528\u5c31\u4f1a\u963b\u585e\u5728\u8fd9\u91cc\uff0c\u76f4\u5230\u6709\u6570\u636e\u53ef\u8bfb\u3002socket\u53d8\u5f97\u53ef\u8bfb\uff0c\u8fd9\u5c31\u662f\u4e00\u4e2a\u4e8b\u4ef6\u3002</p> <p>\u4e8b\u4ef6\u901a\u5e38\u90fd\u662f\u901a\u8fc7\u56de\u8c03\u51fd\u6570\uff08callback\uff09\u6765\u5904\u7406\u7684</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#yield-from","title":"\u534f\u7a0b(yield from\u7248)","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#yield-from_1","title":"<code>yield from</code>\u8bed\u6cd5\u7684\u5b9e\u73b0","text":"<pre><code># https://peps.python.org/pep-0380/\n# RESULT = yield from EXPR \u7b49\u4ef7\u5199\u6cd5\u7b80\u5316\u7248\n_i = iter(EXPR)  # __iter__  \u540e\u9762\u7684\u7248\u672c\u8f6c\u4e3aawait __await__\ntry:\n    _y = _i.send(None)\nexcept StopIteration as _e:  # \u76f4\u63a5\u7ed3\u675f\uff0c\u4e00\u6b21yield\u90fd\u6ca1\u9047\u4e0a\n    _r = _e.value\nelse:\n    while 1:  # \u4e0d\u9047\u5230StopIteration\u4e0d\u7b97\u5b8c\n        try:\n            _s = yield _y  # \u7167\u539f\u6837yield\u51fa\u53bb\uff0c\u5e76\u63a5\u6536send\u4f20\u5165\u7684\u503c\n        except GeneratorExit as _e:  # \u5904\u7406close\n            _i.close\n            raise _e\n        except BaseException as _e:  # \u5904\u7406\u5176\u4ed6\u5f02\u5e38\n            sys.exc_info()\n            try:\n                _y = _i.throw(*_x)\n            except StopIteration as _e:\n                _r = _e.value\n                break\n        else:\n            try:\n                _y = _i.send(_s)  # \u63a5\u6536\u5230\u7684\u503c\u539f\u6837\u518dsend\u4e0b\u53bb\n            except StopIteration as _e:\n                _r = _e.value\n                break\nRESULT = _r  # StopIteration\u5e26\u51fa\u6765\u7684\u503c\u5c31\u662f\u7ed3\u679c\n</code></pre> <p>\u4e8b\u5b9e\u4e0a\u603b\u4f1asend<code>(None)</code>\uff0c\u518d\u6b21\u7b80\u5316\u5f97\u5230</p> <pre><code>_i = iter(EXPR)  # __iter__  \nwhile 1:  # \u4e0d\u9047\u5230StopIteration\u4e0d\u7b97\u5b8c\n    try:\n        _y = _i.send(None)  # \u603b\u662fNone \n    except StopIteration as _e:\n        _r = _e.value\n        break\n    else:\n        yield _y  # \u539f\u6837\u518dsend\u4e0b\u53bb\uff0c\u4e0d\u518d\u63a5\u6536send\u4f20\u5165\u7684\u503c\uff0c\u56e0\u4e3a\u603b\u662fNone\nRESULT = _r  # StopIteration\u5e26\u51fa\u6765\u7684\u503c\u5c31\u662f\u7ed3\u679c\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#_1","title":"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u4efb\u52a1","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#1","title":"1. \u4e00\u4e2a\u540c\u6b65\u963b\u585e\u7684\u7b80\u5355\u4efb\u52a1","text":"<pre><code>import time\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\nmain_task()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>begin task 1730016851.280093\n - begin big task 1730016851.280093\n   - begin small task 1730016851.280093\n     - \u5de5\u4f5c\u4e2d...\n   - end small task 1730016851.280093\n - end big task 1730016851.280093\nend task 1730016851.280093\nbig_result is  2\n</code></pre> <p>\u5728\u4efb\u52a1\u91cd\u5f15\u5165\u4e00\u4e2a\u963b\u585e</p> <pre><code>import time\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    time.sleep(3)  # \u5f15\u5165\u4e00\u4e2a\u963b\u585e\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\nmain_task()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>begin task 1730016988.833141\n - begin big task 1730016988.833141\n   - begin small task 1730016988.834105\n     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\n     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\n   - end small task 1730016991.8345354\n - end big task 1730016991.8345354\nend task 1730016991.8345354\nbig_result is  2\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#2-yield","title":"2. \u4f7f\u7528yield\u53d8\u534f\u7a0b\uff0c\u8ba9\u4efb\u52a1\u4e0d\u963b\u585e\u3002","text":"<p>\u7ed9\u963b\u585e\u7684\u4ee3\u7801\u52a0\u4e00\u4e2ayield</p> <pre><code>def small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    yield time.sleep(3)\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n</code></pre> <p>\u5982\u679c\u53ea\u662f\u7ed9\u963b\u585e\u7684\u4ee3\u7801\u7b80\u5355\u52a0\u4e00\u4e2ayield\u662f\u4e0d\u53ef\u884c\u7684\uff0c\u8fd0\u884c\u62a5\u9519</p> <pre><code>TypeError: unsupported operand type(s) for +: 'generator' and 'int'\n</code></pre> <p>\u4e00\u65e6\u7528\u4e86yield\uff0c\u8c03\u7528\u65b9\u4e5f\u9700\u8981\u505a\u76f8\u5e94\u7684\u6539\u53d8</p> <pre><code>import time\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_coro = small_step()    # \u6539\u53d8\u8c03\u7528\u65b9\u5f0f\n    while True:\n        try:\n            x = small_coro.send(None)\n        except StopIteration as e:\n            small_result = e.value\n            break\n        else:\n            pass\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    yield time.sleep(3)\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\nmain_task()\n</code></pre> <p>\u6b64\u65f6\u7684\u4efb\u52a1\u4ecd\u7136\u5b58\u5728\u963b\u585e</p> <pre><code>begin task 1730017666.1158626\n - begin big task 1730017666.1158626\n   - begin small task 1730017666.1158626\n     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\n     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\n   - end small task 1730017669.1298668\n - end big task 1730017669.1308722\nend task 1730017669.1308722\nbig_result is  2\n</code></pre> <p>\u5c06\u963b\u585e\u4ece\u4e0b\u6e38\u4f20\u5230\u4e0a\u6e38</p> <pre><code>def small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    start_time = time.time()   \n    yield time.sleep, 3  # \u628a\u8fd9\u4e2a\u884c\u4e3a\u4f20\u9012\u51fa\u53bb\n    assert time.time() - start_time &gt; 3, '\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3'  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\nmain_task()\n</code></pre> <p>\u4f46\u662f\u5e76\u6ca1\u6709\u771f\u6b63\u7684\u6d88\u9664\u963b\u585e</p> <pre><code>    assert time.time() - start_time &gt; 3, '\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3'\nAssertionError: \u4f11\u606f\u65f6\u95f4\u4e0d\u8db3\n</code></pre> <p>\u5c06yield\u4f20\u9012\u5230\u9876\u5c42</p> <pre><code>import time\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_coro = big_step()\n    while True:\n        try:\n            x = big_coro.send(None)\n        except StopIteration as e:\n            big_result = e.value\n            break\n        else:\n           func, arg = x  # func, arg = (time.sleep, 3)\n           func(arg)  # time.sleep(3)\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_coro = small_step()\n    while True:\n        try:\n            x = small_coro.send(None)\n        except StopIteration as e:\n            small_result = e.value\n            break\n        else:\n            yield x\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    start_time = time.time()   \n    yield time.sleep, 3  # \u628a\u8fd9\u4e2a\u884c\u4e3a\u4f20\u9012\u51fa\u53bb\n    assert time.time() - start_time &gt; 3, '\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3'  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\nmain_task()\n</code></pre> <p>\u6b64\u65f6\u4efb\u52a1\u963b\u585e\u88ab\u4f20\u9012\u5230\u4e86\u4e0a\u6e38main_task\u4e2d</p> <pre><code>begin task 1730018313.6238086\n - begin big task 1730018313.6238086\n   - begin small task 1730018313.6238086\n     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\n     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\n   - end small task 1730018316.6327195\n - end big task 1730018316.6346214\nend task 1730018316.6346214\nbig_result is  2\n</code></pre> <p>\u7531\u6b64\u53ef\u77e5\uff1a  - \u534f\u7a0b\u81ea\u5df1\u5e76\u4e0d\u80fd\u6d88\u9664\u963b\u585e  - \u534f\u7a0b\u5177\u6709\u4f20\u67d3\u6027  - \u534f\u7a0b\u901a\u8fc7yield\u628a\u963b\u585e\u6362\u4e2a\u65b9\u5f0f\u4f20\u9012\u7ed9\u4e86\u4e0a\u6e38  - \u6700\u7ec8\u7684\u963b\u585e\u4eba\u4eba\u9700\u8981\u88ab\u89e3\u51b3</p> <p>#### 3. \u4f7f\u7528<code>yield from</code></p> <ol> <li>\u5728big_step\u4e2d\u4f7f\u7528<code>yield from</code></li> </ol> <pre><code>def big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = yield from small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n</code></pre> <ol> <li>\u5728small_step\u4f7f\u7528<code>yield from</code></li> </ol> <pre><code>import time\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_coro = big_step()\n    while True:\n        try:\n            x = big_coro.send(None)\n        except StopIteration as e:\n            big_result = e.value\n            break\n        else:\n            func, arg = x  # func, arg = (time.sleep, 3)\n            func(arg)  # time.sleep(3)\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = yield from small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    start_time = time.time()\n    yield from YieldFromAble((time.sleep, 3))  # \u628a\u8fd9\u4e2a\u884c\u4e3a\u4f20\u9012\u51fa\u53bb\n    assert (\n        time.time() - start_time &gt; 3\n    ), \"\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3\"  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\n\nclass YieldFromAble:\n    def __init__(self, value):\n        self.value = value\n\n    def __iter__(self):\n        yield self.value\n\n\nmain_task()\n</code></pre> <ol> <li>\u5728main_step\u4f7f\u7528<code>yield from</code></li> </ol> <pre><code>import time\n\n\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = yield from big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = yield from small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    start_time = time.time()\n    yield from YieldFromAble((time.sleep, 3))  # \u628a\u8fd9\u4e2a\u884c\u4e3a\u4f20\u9012\u51fa\u53bb\n    assert (\n        time.time() - start_time &gt; 3\n    ), \"\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3\"  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\n\nclass YieldFromAble:\n    def __init__(self, value):\n        self.value = value\n\n    def __iter__(self):\n        yield self.value\n\n\nclass Task:\n    def __init__(self, coro):\n        self.coro = coro\n\n    def run(self):\n        print(\"---------------\")\n        while True:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                result = e.value\n                break\n            else:\n                func, arg = x  # func, arg = (time.sleep, 3)\n                func(arg)  # time.sleep(3)\n        print(\"---------------\")\n\n\nt = Task(main_task())  # \u6539\u53d8\u8c03\u7528\u65b9\u5f0f\nt.run()\n</code></pre> <p>\u8fd0\u884c\u6b63\u5e38</p> <pre><code>---------------\nbegin task 1730019257.0435085\n - begin big task 1730019257.0435085\n   - begin small task 1730019257.0435085\n     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\n     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\n   - end small task 1730019260.0521905\n - end big task 1730019260.0521905\nend task 1730019260.0521905\nbig_result is  2\n---------------\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#_2","title":"\u8fdb\u4e00\u6b65\u4f18\u5316","text":"<pre><code>import time\n\n\ndef main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = yield from big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\ndef big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = yield from small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\n\ndef small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    start_time = time.time()\n    yield from YieldFromAble((time.sleep, 3))  # \u628a\u8fd9\u4e2a\u884c\u4e3a\u4f20\u9012\u51fa\u53bb\n    assert (\n        time.time() - start_time &gt; 3\n    ), \"\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3\"  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\n\nclass YieldFromAble:\n    def __init__(self, value):\n        self.value = value\n\n    def __iter__(self):\n        # yield self.value\n        yield self  # \u4e0d\u518d\u4f20\u503c\uff0c\u76f4\u63a5\u4f20\u81ea\u8eab\n\n\nclass Task:\n    \"\"\"\u4e00\u4e2a\u901a\u7528\u7684\u4efb\u52a1\u5904\u7406\"\"\"\n    def __init__(self, coro):\n        self.coro = coro\n\n    def run(self):\n        print(\"---------------\")\n        while True:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                result = e.value\n                break\n            else:\n                assert isinstance(x, YieldFromAble)\n                func, arg = x.value  # func, arg = (time.sleep, 3)\n                func(arg)  # time.sleep(3)\n        print(\"---------------\")\n\n\nt = Task(main_task())  # \u6539\u53d8\u8c03\u7528\u65b9\u5f0f\nt.run()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#awiatasync","title":"awiat/async","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#yield-fromawait","title":"\u4ece<code>yield from</code>\u8fc7\u5ea6\u5230<code>await</code>","text":"<p>\u4e09\u6b65\uff1a 1. <code>yield from</code>\u66ff\u6362\u4e3a<code>await</code> 2. <code>__iter__</code>\u66ff\u6362\u4e3a<code>__await__</code> 3. \u51fd\u6570\u524d\u9762\u52a0<code>async</code></p> <pre><code>import time\n\n\nasync def main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = await big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\nasync def big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = await small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\n\nasync def small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    print(\"     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\")\n    start_time = time.time()\n    await Awaitable((time.sleep, 3))  # \u628a\u8fd9\u4e2a\u884c\u4e3a\u4f20\u9012\u51fa\u53bb\n    assert (\n        time.time() - start_time &gt; 3\n    ), \"\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3\"  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\")\n    print(\"   - end small task\", time.time())\n    return 1\n\n\nclass Awaitable:  # \n    def __init__(self, value):\n        self.value = value\n\n    def __await__(self):\n        # yield self.value\n        yield self  # \u4e0d\u518d\u4f20\u503c\uff0c\u76f4\u63a5\u4f20\u81ea\u8eab\n\n\nclass Task:\n    \"\"\"\u4e00\u4e2a\u901a\u7528\u7684\u4efb\u52a1\u5904\u7406\"\"\"\n    def __init__(self, coro):\n        self.coro = coro\n\n    def run(self):\n        print(\"---------------\")\n        while True:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                result = e.value\n                break\n            else:\n                assert isinstance(x, Awaitable)\n                func, arg = x.value  # func, arg = (time.sleep, 3)\n                func(arg)  # time.sleep(3)\n        print(\"---------------\")\n\n\nt = Task(main_task())  # \u6539\u53d8\u8c03\u7528\u65b9\u5f0f\nt.run()\n</code></pre> <p>\u4ec0\u4e48\u662fawaitable\uff1f 1. \u5982\u679c\u4e00\u4e2a\u7c7b\u5b9e\u73b0\u4e86<code>__await__</code>\u90a3\u4e48\u8fd9\u4e2a\u7c7b\u5c31\u662fawaitable 2. <code>small_result = await small_step()</code> small_step()\u5c31\u662fawaitable</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#_3","title":"\u534f\u4f5c\u5f0f\u7684\u591a\u4efb\u52a1","text":"<p>\u5f53\u524dTask.run\u662f\u4e00\u4e2a\u666e\u901a\u51fd\u6570\uff0c\u5bf9\u5176\u8fdb\u884c\u6539\u9020</p> <pre><code>class Task:\n    \"\"\"\u4e00\u4e2a\u901a\u7528\u7684\u4efb\u52a1\u5904\u7406\"\"\"\n    def __init__(self, coro):\n        self.coro = coro\n        self._done = False\n        self._result = None\n    def run(self):\n        print(\"---------------\")\n        if not self._done:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                self._result = e.value\n                self._done = True\n            else:\n                assert isinstance(x, Awaitable)\n                func, arg = x.value  # func, arg = (time.sleep, 3)\n                func(arg)  # time.sleep(3)\n        print(\"---------------\")\n</code></pre> <p>\u6b64\u65f6\u4efb\u52a1\u5728sleep3s\u4e4b\u540e\u76f4\u63a5\u9000\u51fa\u4e86</p> <pre><code>---------------\nbegin task 1730023922.2244272\n - begin big task 1730023922.2244272\n   - begin small task 1730023922.2244272\n     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\n---------------\n</code></pre> <p>\u5728sleep3s\u7684\u8fc7\u7a0b\u4e2d\u505a\u5176\u4ed6\u4e8b\u60c5\u3002</p> <pre><code>class Task:\n    \"\"\"\u4e00\u4e2a\u901a\u7528\u7684\u4efb\u52a1\u5904\u7406\"\"\"\n\n    def __init__(self, coro):\n        self.coro = coro\n        self._done = False\n        self._result = None\n\n    def run(self):\n        print(\"---------------\")\n        if not self._done:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                self._result = e.value\n                self._done = True\n            else:\n                assert isinstance(x, Awaitable)\n        print(\"---------------\")\n\n\nt = Task(main_task())  # \u6539\u53d8\u8c03\u7528\u65b9\u5f0f\nt.run()\n# \u7b49\u5f853s\nfor _ in range(10):\n    print(\"doing something...\")\n    time.sleep(0.5)\nt.run()\n</code></pre> <p>\u5728\u7b49\u5f85\u7684\u95f4\u9699\u505a\u5176\u4ed6\u4e8b\u60c5\u3002</p> <pre><code>---------------\nbegin task 1730024119.5251992\n - begin big task 1730024119.5251992\n   - begin small task 1730024119.5251992\n     - \u4f11\u606f\u4e00\u4e0b\uff0c\u9a6c\u4e0a\u56de\u6765\n---------------\ndoing something...\ndoing something...\ndoing something...\ndoing something...\ndoing something...\ndoing something...\ndoing something...\ndoing something...\ndoing something...\ndoing something...\n---------------\n     - \u52aa\u529b\u5de5\u4f5c\u4e2d...\n   - end small task 1730024124.6075497\n - end big task 1730024124.6075497\nend task 1730024124.6075497\nbig_result is  2\n---------------\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#eventloop","title":"\u81ea\u5b9a\u4e49EventLoop","text":"<pre><code>class EventLoop:\n    \"\"\"\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4efb\u52a1\u8c03\u5ea6\u5668\"\"\"\n\n    def __init__(self):\n        self._ready = collections.deque()  # \u4e00\u4e2a\u53cc\u5411\u4efb\u52a1\u961f\u5217\uff0c\u5148\u5165\u5148\u51fa\n        self._scheduled = []  # \u5b9a\u65f6\u4efb\u52a1\uff0c\u9700\u8981\u4fdd\u6301\u4e00\u4e2a\u987a\u5e8f\uff0c\n        self._stopping = False  # \u63d0\u4f9b\u4e00\u4e2a\u6807\u5fd7\u4f4d\uff0c\u7528\u6765\u7ed3\u675frun_once\u4e2d\u7684\u5faa\u73af\n\n    def call_soon(self, callback, *args):\n        \"\"\"\u628a\u4efb\u52a1\u52a0\u5165\u4efb\u52a1\u961f\u5217\"\"\"\n        self._ready.append((callback, args))\n\n    def call_later(self, delay, callback, *args):\n        \"\"\"\u5229\u7528\u5806\u6765\u5b58\u50a8\u5b9a\u65f6\u4efb\u52a1\"\"\"\n        t = time.time() + delay\n        heapq.heappush(self._scheduled, (t, callback, args))  ## \u8ba9\u65f6\u95f4\u6700\u5c0f\u7684\u6392\u5728\u5806\u9876\u7684\u4f4d\u7f6e\n\n    def stop(self):\n        self._stopping = True\n\n    def run_forever(self):\n        while True:\n            self.run_once()  # \u4fdd\u8bc1\u5faa\u73af\u81f3\u5c11\u6267\u884c\u4e00\u8f6e\n            if self._stopping:\n                break\n\n    def run_once(self):\n        # \u5904\u7406\u5b9a\u65f6\u4efb\u52a1\n        now = time.time()\n        if self._scheduled:\n            if self._scheduled[0][0] &lt; now:\n                _, cb, args = heapq.heappop(self._scheduled)\n                self._ready.append((cb, args))  # \u7b26\u5408\u8981\u6c42\u7684\u5b9a\u65f6\u4efb\u52a1\u52a0\u5165\u5c31\u7eea\u961f\u5217\n\n        # \u628a\u5c31\u7eea\u7684\u4efb\u52a1\u62ff\u51fa\u6765\u6267\u884c\n        num = len(self._ready)\n        for i in range(num):\n            cb, args = self._ready.popleft()\n            cb(*args)\n\n\nif __name__ == \"__main__\":\n\n    loop = EventLoop()\n    t = Task(main_task())\n    loop.call_soon(t.run)\n    loop.call_later(3, t.run)\n    loop.call_later(4, loop.stop)\n    loop.run_forever()\n</code></pre> <p>\u6539\u9020\u4e00\u4e0bTask</p> <pre><code>import collections\nimport heapq\nimport itertools\nimport random\nimport time\n\n\nasync def main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = await big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\nasync def big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = await small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\n\nasync def small_step():\n    \"\"\"\u4e00\u4e2a\u5c0f\u4efb\u52a1\"\"\"\n    print(\"   - begin small task\", time.time())\n    t1 = time.time()\n    sleep_time = random.random()\n    await Awaitable(sleep_time)  # sleep_time\u6700\u7ec8\u4f20\u9012\u7ed9Task\n    assert (time.time() - t1 &gt; sleep_time), \"\u4f11\u606f\u65f6\u95f4\u4e0d\u8db3\"  # \u901a\u8fc7\u8ba1\u7b97\u4f11\u606f\u65f6\u95f4\u5224\u65ad\u662f\u4e0d\u662f\u771f\u7684sleep\u4e863\u79d2\n    print(\"   - end small task\", time.time())\n    return sleep_time\n\n\nclass Awaitable:  # YieldFromAble \u66ff\u6362\u4e3aAwaitable\n    \"\"\"\u5982\u679c\u4e00\u4e2a\u7c7b\u4e2d\u5b9e\u73b0\u4e86__await__\u5c31\u662fAwaitable\"\"\"\n\n    def __init__(self, value):\n        self.value = value\n\n    def __await__(self):\n        yield self  # \u4e0d\u518d\u4f20\u503c\uff0c\u76f4\u63a5\u4f20\u81ea\u8eab\ntask_id_counter = itertools.count(1)\n\nclass Task:\n    \"\"\"\u4e00\u4e2a\u901a\u7528\u7684\u4efb\u52a1\u5904\u7406\"\"\"\n\n    def __init__(self, coro):\n        self.coro = coro\n        self._done = False\n        self._result = None\n        self._id = \"Task-{}\".format(next(task_id_counter))\n\n    def run(self):\n        print(\"--------Task {}-------\".format(self._id))\n        if not self._done:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                self._result = e.value\n                self._done = True\n            else:\n                assert isinstance(x, Awaitable)\n                loop.call_later(x.value, self.run)\n        print(\"---------------\")\n\n\nclass EventLoop:\n    \"\"\"\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4efb\u52a1\u8c03\u5ea6\u5668\"\"\"\n\n    def __init__(self):\n        self._ready = collections.deque()  # \u4e00\u4e2a\u53cc\u5411\u4efb\u52a1\u961f\u5217\uff0c\u5148\u5165\u5148\u51fa\n        self._scheduled = []  # \u5b9a\u65f6\u4efb\u52a1\uff0c\u9700\u8981\u4fdd\u6301\u4e00\u4e2a\u987a\u5e8f\uff0c\n        self._stopping = False  # \u63d0\u4f9b\u4e00\u4e2a\u6807\u5fd7\u4f4d\uff0c\u7528\u6765\u7ed3\u675frun_once\u4e2d\u7684\u5faa\u73af\n\n    def call_soon(self, callback, *args):\n        \"\"\"\u628a\u4efb\u52a1\u52a0\u5165\u4efb\u52a1\u961f\u5217\"\"\"\n        self._ready.append((callback, args))\n\n    def call_later(self, delay, callback, *args):\n        \"\"\"\u5229\u7528\u5806\u6765\u5b58\u50a8\u5b9a\u65f6\u4efb\u52a1\"\"\"\n        t = time.time() + delay\n        heapq.heappush(self._scheduled, (t, callback, args))  ## \u8ba9\u65f6\u95f4\u6700\u5c0f\u7684\u6392\u5728\u5806\u9876\u7684\u4f4d\u7f6e\n\n    def stop(self):\n        self._stopping = True\n\n    def run_forever(self):\n        while True:\n            self.run_once()  # \u4fdd\u8bc1\u5faa\u73af\u81f3\u5c11\u6267\u884c\u4e00\u8f6e\n            if self._stopping:\n                break\n\n    def run_once(self):\n        # \u5904\u7406\u5b9a\u65f6\u4efb\u52a1\n        now = time.time()\n        if self._scheduled:\n            if self._scheduled[0][0] &lt; now:\n                _, cb, args = heapq.heappop(self._scheduled)\n                self._ready.append((cb, args))  # \u7b26\u5408\u8981\u6c42\u7684\u5b9a\u65f6\u4efb\u52a1\u52a0\u5165\u5c31\u7eea\u961f\u5217\n\n        # \u628a\u5c31\u7eea\u7684\u4efb\u52a1\u62ff\u51fa\u6765\u6267\u884c\n        num = len(self._ready)\n        for i in range(num):\n            cb, args = self._ready.popleft()\n            cb(*args)\n\n\nif __name__ == \"__main__\":\n\n    loop = EventLoop()\n    for i in range(3): \n        t = Task(main_task())\n        loop.call_soon(t.run)\n    loop.call_later(4, loop.stop)\n    loop.run_forever()\n</code></pre> <p>\u5148\u5b8c\u6210\u7684\u4efb\u52a1\u5148\u7ed3\u675f</p> <pre><code>--------Task Task-1-------\nbegin task 1730035454.8707514       \n - begin big task 1730035454.8707514\n   - begin small task 1730035454.8707514\n---------------\n--------Task Task-2-------\nbegin task 1730035454.8707514\n - begin big task 1730035454.8707514\n   - begin small task 1730035454.8707514\n---------------\n--------Task Task-3-------\nbegin task 1730035454.8707514\n - begin big task 1730035454.8707514\n   - begin small task 1730035454.8707514\n---------------\n--------Task Task-3-------\n   - end small task 1730035454.983271\n - end big task 1730035454.983271\nend task 1730035454.983271\nbig_result is  1.112460818788886\n---------------\n--------Task Task-1-------\n   - end small task 1730035454.9969466\n - end big task 1730035454.9978602\nend task 1730035454.9978602\nbig_result is  1.1256256122808315\n---------------\n--------Task Task-2-------\n   - end small task 1730035455.7463698\n - end big task 1730035455.7463698\nend task 1730035455.7473648\nbig_result is  1.873241963935576\n---------------\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E5%8D%8F%E7%A8%8B/#future","title":"Future","text":"<pre><code>import collections\nimport heapq\nimport itertools\nimport random\nimport time\nimport threading\n\n\ndef fake_io_read(future):\n    def read():\n        time.sleep(random.random())\n        future.set_result(random.randint(1, 100))\n\n    threading.Thread(target=read).start()\n\n\nasync def main_task():\n    \"\"\"\u4e00\u4e2a\u4e3b\u4efb\u52a1\"\"\"\n    print(\"begin task\", time.time())\n    big_result = await big_step()\n    print(\"end task\", time.time())\n    print(\"big_result is \", big_result)\n\n\nasync def big_step():\n    \"\"\"\u4e00\u4e2a\u5927\u4efb\u52a1\"\"\"\n    print(\" - begin big task\", time.time())\n    small_result = await small_step()\n    print(\" - end big task\", time.time())\n    return small_result + 1\n\n\nasync def small_step():\n    global loop\n    fut = Future()\n\n    # \u6307\u6d3e\u4e00\u4e2a\u76ee\u6807\u6267\u884cset_result\n    fake_io_read(fut)  # \u6a21\u62df\u4e00\u4e2aIO\u64cd\u4f5c  \u628aFuture\u548cIO\u64cd\u4f5c\u7ed1\u5b9a\u5230\u4e00\u8d77\n    result = await fut\n    return result\n\n\nclass Future:\n\n    def __init__(self):\n        global loop\n        self._loop = loop\n        self._result = None\n        self._done = None\n        self._callbacks = []\n\n    def set_result(self, result):\n        if self._done:\n            raise RuntimeError(\"future already done.\")\n        self._result = result\n        self._done = True\n\n        for cb in self._callbacks:\n            self._loop.call_soon(cb)\n\n    def result(self):\n        if self._done:\n            return self._result\n        else:\n            raise RuntimeError(\"future is not done\")\n\n    def add_done_callback(self, callback):\n        self._callbacks.append(callback)\n\n    def __await__(self):\n        yield self\n        return self.result()\n\n\ntask_id_counter = itertools.count(1)\n\n\nclass Task(Future):\n    \"\"\"\u4e00\u4e2a\u901a\u7528\u7684\u4efb\u52a1\u5904\u7406\"\"\"\n\n    def __init__(self, coro):\n        super().__init__()\n        # self._result = None\n        # self._done = None\n        self.coro = coro\n        self._id = \"Task-{}\".format(next(task_id_counter))\n        self._loop.call_soon(self.run)\n\n    def run(self):\n        print(\"--------Task {}-------\".format(self._id))\n        if not self._done:\n            try:\n                x = self.coro.send(None)\n            except StopIteration as e:\n                # self._result = e.value\n                # self._done = True\n                self.set_result(e.value)\n            else:\n                assert isinstance(x, Future)\n                x.add_done_callback(self.run)  # \u91cd\u65b0\u6fc0\u6d3btask\n        print(\"---------------\")\n\n\nclass EventLoop:\n    \"\"\"\u76f8\u5f53\u4e8e\u4e00\u4e2a\u4efb\u52a1\u8c03\u5ea6\u5668\"\"\"\n\n    def __init__(self):\n        self._ready = collections.deque()  # \u4e00\u4e2a\u53cc\u5411\u4efb\u52a1\u961f\u5217\uff0c\u5148\u5165\u5148\u51fa\n        self._scheduled = []  # \u5b9a\u65f6\u4efb\u52a1\uff0c\u9700\u8981\u4fdd\u6301\u4e00\u4e2a\u987a\u5e8f\uff0c\n        self._stopping = False  # \u63d0\u4f9b\u4e00\u4e2a\u6807\u5fd7\u4f4d\uff0c\u7528\u6765\u7ed3\u675frun_once\u4e2d\u7684\u5faa\u73af\n\n    def call_soon(self, callback, *args):\n        \"\"\"\u628a\u4efb\u52a1\u52a0\u5165\u4efb\u52a1\u961f\u5217\"\"\"\n        self._ready.append((callback, args))\n\n    def call_later(self, delay, callback, *args):\n        \"\"\"\u5229\u7528\u5806\u6765\u5b58\u50a8\u5b9a\u65f6\u4efb\u52a1\"\"\"\n        t = time.time() + delay\n        heapq.heappush(\n            self._scheduled, (t, callback, args)\n        )  ## \u8ba9\u65f6\u95f4\u6700\u5c0f\u7684\u6392\u5728\u5806\u9876\u7684\u4f4d\u7f6e\n\n    def stop(self):\n        self._stopping = True\n\n    def run_forever(self):\n        while True:\n            self.run_once()  # \u4fdd\u8bc1\u5faa\u73af\u81f3\u5c11\u6267\u884c\u4e00\u8f6e\n            if self._stopping:\n                break\n\n    def run_once(self):\n        # \u5904\u7406\u5b9a\u65f6\u4efb\u52a1\n        now = time.time()\n        if self._scheduled:\n            if self._scheduled[0][0] &lt; now:\n                _, cb, args = heapq.heappop(self._scheduled)\n                self._ready.append((cb, args))  # \u7b26\u5408\u8981\u6c42\u7684\u5b9a\u65f6\u4efb\u52a1\u52a0\u5165\u5c31\u7eea\u961f\u5217\n\n        # \u628a\u5c31\u7eea\u7684\u4efb\u52a1\u62ff\u51fa\u6765\u6267\u884c\n        num = len(self._ready)\n        for i in range(num):\n            cb, args = self._ready.popleft()\n            cb(*args)\n\n\nif __name__ == \"__main__\":\n\n    loop = EventLoop()\n    for i in range(3):\n        t = Task(main_task())\n\n    loop.call_later(1, loop.stop)\n    loop.run_forever()\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/","title":"\u4e00\u3001\u8fed\u4ee3\u5668","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_2","title":"\u8fed\u4ee3\u5668\u5f15\u5165","text":"<pre><code>class StudentSystem:\n    def __init__(self):\n        self.stus = []\n\n    def add(self, name, age, tel):\n        new_stu = dict()\n        new_stu[\"name\"] = name\n        new_stu[\"age\"] = age\n        new_stu[\"tel\"] = tel\n        self.stus.append(new_stu)\n\n\nstu_sys = StudentSystem()\nstu_sys.add(\"\u5f20\u4e09\", 18, \"18888888888\")\nstu_sys.add(\"\u674e\u56db\", 19, \"18811112222\")\nstu_sys.add(\"\u738b\u4e94\", 20, \"18833334444\")\n</code></pre> <p>\u4e0a\u9762\u7684\u4ee3\u7801\u4e2d\uff0c\u5982\u4f55\u4f7f\u7528for\u5faa\u73af\u904d\u5386\u6240\u6709\u7684\u5b66\u751f\u4fe1\u606f\uff1f\u5982\u679c\u7b80\u5355\u7684\u904d\u5386stu_sys\uff0c\u4f1a\u629b\u51fa\u5f02\u5e38</p> <pre><code>for item in stu_sys:\n    print(item) \n</code></pre> <p>\u629b\u51fa\u5f02\u5e38</p> <pre><code>     for item in stu_sys:\nTypeError: 'StudentSystem' object is not iterable\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_3","title":"\u4ec0\u4e48\u662f\u8fed\u4ee3","text":"<p>\u8fed\u4ee3\u662f\u8bbf\u95ee\u96c6\u5408\u5143\u7d20\u7684\u4e00\u79cd\u65b9\u5f0f</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_4","title":"\u53ef\u8fed\u4ee3\u5bf9\u8c61","text":"<p>\u53ef\u4ee5\u76f4\u63a5\u4f5c\u7528\u4e8e<code>for</code>\u5faa\u73af\u7684\u5bf9\u8c61\u7edf\u79f0\u4e3a\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff08Iterable\uff09\u3002\u5185\u90e8\u542b\u6709<code>__iter__</code>\u65b9\u6cd5\u3002\u5982\u5b57\u7b26\u4e32\u3001\u5217\u8868\u3001\u5143\u7ec4\u3001\u5b57\u5178\u3001\u96c6\u5408\u3001\u6587\u4ef6\u53e5\u67c4\u7b49\u3002 <code>\u53ef\u8fed\u4ee3\u5bf9\u8c61.__iter__()</code>:\u53ef\u5f97\u5230\u8fed\u4ee3\u5668\u5bf9\u8c61\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_5","title":"\u5224\u65ad\u4e00\u4e2a\u5bf9\u8c61\u662f\u5426\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61","text":"<pre><code>&gt;&gt;&gt; '__iter__' in dir('hello')\nTrue\n# \u6216\u8005\n&gt;&gt;&gt; from collections import Iterable\n&gt;&gt;&gt; isinstance([], Iterable)\nTrue\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_6","title":"\u8fed\u4ee3\u5668","text":"<p>\u8fed\u4ee3\u5668\u662f\u4e00\u4e2a\u53ef\u4ee5\u8bb0\u4f4f\u904d\u5386\u4f4d\u7f6e\u7684\u5bf9\u8c61\uff0c\u8fed\u4ee3\u5668\u5bf9\u8c61\u4ece\u7b2c\u4e00\u4e2a\u5143\u7d20\u5f00\u59cb\u8bbf\u95ee\uff0c\u76f4\u5230\u6240\u6709\u7684\u5143\u7d20\u88ab\u8bbf\u95ee\u7ed3\u675f\uff0c\u8fed\u4ee3\u5668\u53ea\u80fd\u5f80\u524d\u4e0d\u4f1a\u540e\u9000\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_7","title":"\u8fed\u4ee3\u5668\u7684\u672c\u8d28","text":"<p>\u8fed\u4ee3\u5668\u6307\u7684\u662f\u8fed\u4ee3\u53d6\u503c\u7684\u5de5\u5177\uff0c\u53ef\u4ee5\u901a\u8fc7iter()\u51fd\u6570\u83b7\u53d6\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u8fed\u4ee3\u5668\uff0c\u7136\u540e\u5bf9\u83b7\u53d6\u5230\u7684\u8fed\u4ee3\u5668\u4e0d\u65ad\u8c03\u7528next()\u51fd\u6570\u6765\u83b7\u53d6\u4e0b\u4e00\u6761\u6570\u636e\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_8","title":"\u83b7\u53d6\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u8fed\u4ee3\u5668","text":"<p>\u901a\u8fc7<code>iter()</code>\u80fd\u591f\u5f97\u5230\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u8fed\u4ee3\u5668\uff0c\u53ef\u4ee5\u901a\u8fc7<code>next()</code>\u51fd\u6570\u83b7\u53d6\u4e0b\u4e00\u6761\u6570\u636e</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_9","title":"\u65b9\u5f0f\u4e00","text":"<pre><code>&gt;&gt;&gt; d = {'a': 1, 'b': 2, 'c': 3}\n&gt;&gt;&gt; d_iterator = d.__iter__()\n&gt;&gt;&gt; print(d_iterator)\n&lt;dict_keyiterator object at 0x0000019318519598&gt;\n&gt;&gt;&gt;\n&gt;&gt;&gt; print(d_iterator.__next__())\na\n&gt;&gt;&gt; print(d_iterator.__next__())\nb\n&gt;&gt;&gt; print(d_iterator.__next__())\nc\n&gt;&gt;&gt; print(d_iterator.__next__())\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_10","title":"\u65b9\u5f0f\u4e8c","text":"<pre><code>&gt;&gt;&gt; d = {'a': 1, 'b': 2, 'c': 3}\n&gt;&gt;&gt; d_iter = iter(d)\n&gt;&gt;&gt; next(d_iter)\n'a'\n&gt;&gt;&gt; next(d_iter)\n'b'\n&gt;&gt;&gt; next(d_iter)\n'c'\n&gt;&gt;&gt; next(d_iter)\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#for","title":"for\u5faa\u73af\u7684\u5de5\u4f5c\u539f\u7406","text":"<pre><code>d = {'a': 1, 'b': 2, 'c': 3}\n# 1\u3001d.__iter__()\u5f97\u5230\u4e00\u4e2a\u8fed\u4ee3\u5668\u5bf9\u8c61\n# 2\u3001\u8fed\u4ee3\u5668\u5bf9\u8c61.__next__()\u62ff\u5230\u4e00\u4e2a\u8fd4\u56de\u503c\uff0c\u7136\u540e\u5c06\u8be5\u8fd4\u56de\u503c\u8d4b\u503c\u7ed9k\n# 3\u3001\u5faa\u73af\u5f80\u590d\u6b65\u9aa42\uff0c\u76f4\u5230\u629b\u51faStopIteration\u5f02\u5e38for\u5faa\u73af\u4f1a\u6355\u6349\u5f02\u5e38\u7136\u540e\u7ed3\u675f\u5faa\u73af\nfor k in d:\n    print(k)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_11","title":"\u81ea\u5b9a\u4e49\u8fed\u4ee3\u5668","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#__iter__","title":"<code>__iter__</code>\u65b9\u6cd5","text":"<p>\u4e0a\u9762\u63d0\u5230\u7684iter()\u65b9\u6cd5\u5fc5\u987b\u662f\u5bf9\u53ef\u8fed\u4ee3\u5bf9\u8c61\u624d\u80fd\u53d6\u5230\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u5bf9\u4e8e\u81ea\u5b9a\u4e49\u7c7b\uff0c\u53ea\u8981\u5728\u7c7b\u4e2d\u5b9a\u4e49<code>__iter__</code>\u65b9\u6cd5\uff0c\u90a3\u4e48\u8fd9\u4e2a\u7c7b\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\u4e00\u5b9a\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\u3002\u5373\u4e00\u4e2a\u5177\u5907\u4e86<code>__iter__</code>\u65b9\u6cd5\u7684\u5bf9\u8c61\u5c31\u662f\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61.</p> <pre><code>from collections.abc import Iterable\n\nclass StudentSystem:\n    def __init__(self):\n        self.stus = []\n\n    def add(self, name, age, tel):\n        new_stu = dict()\n        new_stu[\"name\"] = name\n        new_stu[\"age\"] = age\n        new_stu[\"tel\"] = tel\n        self.stus.append(new_stu)\n\n    def __iter__(self):\n        pass\n\nstu_sys = StudentSystem()\nstu_sys.add(\"\u5f20\u4e09\", 18, \"18888888888\")\nstu_sys.add(\"\u674e\u56db\", 19, \"18811112222\")\nstu_sys.add(\"\u738b\u4e94\", 20, \"18833334444\")\n\nprint(isinstance(stu_sys, Iterable))  # True\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#__next__","title":"<code>__next__</code>\u65b9\u6cd5","text":"<p>\u8fed\u4ee3\u5668\u662f\u7528\u6765\u8bb0\u5f55\u6bcf\u6b21\u8fed\u4ee3\u8bbf\u95ee\u5230\u7684\u4f4d\u7f6e\uff0c\u5f53\u5bf9\u8fed\u4ee3\u5668\u4f7f\u7528<code>next()</code>\u51fd\u6570\u7684\u65f6\u5019\uff0c\u8fed\u4ee3\u5668\u4f1a\u8fd4\u56de\u5b83\u6240\u8bb0\u5f55\u4f4d\u7f6e\u7684\u4e0b\u4e00\u4e2a\u4f4d\u7f6e\u7684\u5143\u7d20\u3002 \u5b9e\u9645\u4e0a\u5728\u4f7f\u7528<code>next()</code>\u51fd\u6570\u7684\u65f6\u5019\uff0c\u8c03\u7528\u7684\u5c31\u662f\u8fed\u4ee3\u5668\u5bf9\u8c61\u7684<code>__next__</code>\u65b9\u6cd5\uff0c\u6240\u4ee5\u60f3\u8981\u6784\u9020\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u5c31\u662f\u8981\u5b9e\u73b0\u5b83\u7684<code>__next__</code>\u65b9\u6cd5\u3002 \u4f46\u662f\u8fd9\u8fd8\u4e0d\u591f\uff0cpython\u8981\u6c42\u8fed\u4ee3\u5668\u672c\u8eab\u4e5f\u662f\u53ef\u8fed\u4ee3\u7684\uff0c\u6240\u4ee5\u8fd8\u8981\u4e3a\u8fed\u4ee3\u5668\u5b9e\u73b0<code>__iter__</code>\u65b9\u6cd5\uff0c\u800c<code>__iter__</code>\u65b9\u6cd5\u8981\u8fd4\u56de\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u8fed\u4ee3\u5668\u81ea\u8eab\u6b63\u662f\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u6240\u4ee5\u8fed\u4ee3\u5668\u7684<code>__iter__</code>\u65b9\u6cd5\u8fd4\u56de\u81ea\u8eab\u5373\u53ef\u3002 \u4e00\u4e2a\u5b9e\u73b0\u4e86<code>__iter__</code>\u65b9\u6cd5\u548c<code>__next__</code>\u65b9\u6cd5\u7684\u5bf9\u8c61\uff0c\u5c31\u662f\u8fed\u4ee3\u5668\u3002</p> <pre><code>from collections.abc import Iterable\nfrom collections.abc import Iterator\n\n\nclass StudentSystem:\n    \"\"\"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\"\"\"\n\n    def __init__(self):\n        self.stus = []\n\n    def add(self, name, age, tel):\n        new_stu = dict()\n        new_stu[\"name\"] = name\n        new_stu[\"age\"] = age\n        new_stu[\"tel\"] = tel\n        self.stus.append(new_stu)\n\n    def __iter__(self):\n        # 1. \u6807\u8bb0\u5f53\u524d\u7c7b\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\n        # 2. \u5f53\u8c03\u7528iter()\u51fd\u6570\u65f6\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\u5b83\u8fd4\u56de\u81ea\u5df1\u6307\u5b9a\u7684\u90a3\u4e2a\u8fed\u4ee3\u5668\n        return MyIterator()\n\n\nclass MyIterator:\n    \"\"\"\u81ea\u5b9a\u4e49\u4f9b\u4e0a\u9762\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4f7f\u7528\u7684\u4e00\u4e2a\u8fed\u4ee3\u5668\"\"\"\n    def __init__(self):\n        pass\n\n    def __next__(self):\n        # 1. \u6807\u8bb0\u5f53\u524d\u7c7b\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\u4e00\u5b9a\u662f\u8fed\u4ee3\u5668\n        # 2. \u5f53\u8c03\u7528next()\u51fd\u6570\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a\u6570\u636e\n        pass\n\n    def __iter__(self):\n        pass\n\n\nstu_sys = StudentSystem()  # \u53ef\u8fed\u4ee3\u5bf9\u8c61\nstu_sys_iter = iter(stu_sys)  # \u7528iter(stu_sys)\u5c31\u662f\u83b7\u53d6stu_sys\u8fd9\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\u7684\u8fed\u4ee3\u5668\uff0c\n                              # \u5b83\u4f1a\u81ea\u52a8\u8c03\u7528stu_sys\u8fd9\u4e2a\u5bf9\u8c61\u7684__iter__\u65b9\u6cd5\uff0c\n                              # \u8fd9\u4e2a\u65b9\u6cd5\u8fd4\u56de\u7684\u503c\u5c31\u5f53\u505aiter()\u51fd\u6570\u7684\u8fd4\u56de\u503c\n\nprint(isinstance(stu_sys, Iterable))  # True\nprint(isinstance(stu_sys, Iterator))  # False\n\nprint(isinstance(stu_sys_iter, Iterable))  # True\nprint(isinstance(stu_sys_iter, Iterator))  # True\n</code></pre> <p>\u8fed\u4ee3\u5668\u5bf9\u8c61\u4e00\u5b9a\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\uff0c\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4e0d\u4e00\u5b9a\u662f\u8fed\u4ee3\u5668\u3002</p> <pre><code>class StudentSystem:\n    \"\"\"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\"\"\"\n\n    def __init__(self):\n        self.stus = []\n\n    def add(self, name, age, tel):\n        new_stu = dict()\n        new_stu[\"name\"] = name\n        new_stu[\"age\"] = age\n        new_stu[\"tel\"] = tel\n        self.stus.append(new_stu)\n\n    def __iter__(self):\n        # 1. \u6807\u8bb0\u5f53\u524d\u7c7b\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\u662f\u53ef\u8fed\u4ee3\u5bf9\u8c61\n        # 2. \u5f53\u8c03\u7528iter()\u51fd\u6570\u65f6\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\u5b83\u8fd4\u56de\u81ea\u5df1\u6307\u5b9a\u7684\u90a3\u4e2a\u8fed\u4ee3\u5668\n        return MyIterator(self)\n\n\nclass MyIterator:\n    \"\"\"\u81ea\u5b9a\u4e49\u4f9b\u4e0a\u9762\u53ef\u8fed\u4ee3\u5bf9\u8c61\u4f7f\u7528\u7684\u4e00\u4e2a\u8fed\u4ee3\u5668\"\"\"\n\n    def __init__(self, stu_obj):\n        self.stu_obj = stu_obj\n        self.current = 0\n        pass\n\n    def __next__(self):\n        # 1. \u6807\u8bb0\u5f53\u524d\u7c7b\u521b\u5efa\u51fa\u6765\u7684\u5bf9\u8c61\u4e00\u5b9a\u662f\u8fed\u4ee3\u5668\n        # 2. \u5f53\u8c03\u7528next()\u51fd\u6570\u7684\u65f6\u5019\uff0c\u8fd9\u4e2a\u65b9\u6cd5\u4f1a\u88ab\u81ea\u52a8\u8c03\u7528\uff0c\u5b83\u8fd4\u56de\u4e00\u4e2a\u6570\u636e\n        if self.current &lt; len(self.stu_obj.stus):\n            item = self.stu_obj.stus[self.current]\n            self.current += 1\n            return item\n        else:\n            raise StopIteration\n\n    def __iter__(self):\n        pass\n\n\nstu_sys = StudentSystem()\nstu_sys.add(\"\u5f20\u4e09\", 18, \"18888888888\")\nstu_sys.add(\"\u674e\u56db\", 19, \"18811112222\")\nstu_sys.add(\"\u738b\u4e94\", 20, \"18833334444\")\nfor stu in stu_sys:\n    print(stu)\n</code></pre> <p>\u4f18\u5316\u4e0a\u9762\u7684\u4ee3\u7801</p> <pre><code>class StudentSystem:\n    \"\"\"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\"\"\"\n\n    def __init__(self):\n        self.stus = []\n        self.current = 0\n\n    def add(self, name, age, tel):\n        new_stu = dict()\n        new_stu[\"name\"] = name\n        new_stu[\"age\"] = age\n        new_stu[\"tel\"] = tel\n        self.stus.append(new_stu)\n\n    def __iter__(self):\n        return self\n\n    def __next__(self):\n        if self.current &lt; len(self.stus):\n            item = self.stus[self.current]\n            self.current += 1\n            return item\n        else:\n            self.current = 0  # \u89e3\u51b3\u7b2c\u4e8c\u6b21for\u5faa\u73af\u6ca1\u6709\u503c\u7684\u95ee\u9898\n            raise StopIteration\n\n\nstu_sys = StudentSystem()\nstu_sys.add(\"\u5f20\u4e09\", 18, \"18888888888\")\nstu_sys.add(\"\u674e\u56db\", 19, \"18811112222\")\nstu_sys.add(\"\u738b\u4e94\", 20, \"18833334444\")\nfor stu in stu_sys:\n    print(stu)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#for_1","title":"\u901a\u8fc7for\u5faa\u73af\u4e4b\u5916\u7684\u65b9\u6cd5\u4f7f\u7528\u8fed\u4ee3\u5668","text":"<pre><code>class StudentSystem:\n    \"\"\"\u81ea\u5b9a\u4e49\u4e00\u4e2a\u53ef\u8fed\u4ee3\u5bf9\u8c61\"\"\"\n\n    def __init__(self):\n        self.stus = []\n        self.current = 0\n\n    def add(self, name, age, tel):\n        new_stu = dict()\n        new_stu[\"name\"] = name\n        new_stu[\"age\"] = age\n        new_stu[\"tel\"] = tel\n        self.stus.append(new_stu)\n\n    def __iter__(self):\n        return self\n\n    def __next__(self):\n        if self.current &lt; len(self.stus):\n            item = self.stus[self.current]\n            self.current += 1\n            return item\n        else:\n            self.current = 0\n            raise StopIteration\n\n\nstu_sys = StudentSystem()\nstu_sys.add(\"\u5f20\u4e09\", 18, \"18888888888\")\nstu_sys.add(\"\u674e\u56db\", 19, \"18811112222\")\nstu_sys.add(\"\u738b\u4e94\", 20, \"18833334444\")\nfor stu in stu_sys:\n    print(stu)\nprint(list(stu_sys))  # [{'name': '\u5f20\u4e09', 'age': 18, 'tel': '18888888888'}, {'name': '\u674e\u56db', 'age': 19, 'tel': '18811112222'}, {'name': '\u738b\u4e94', 'age': 20, 'tel': '18833334444'}]\nprint(tuple(stu_sys)) # ({'name': '\u5f20\u4e09', 'age': 18, 'tel': '18888888888'}, {'name': '\u674e\u56db', 'age': 19, 'tel': '18811112222'}, {'name': '\u738b\u4e94', 'age': 20, 'tel': '18833334444'})\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_12","title":"\u8fed\u4ee3\u5668\u6848\u4f8b","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#y2x1","title":"\u4f7f\u7528\u8fed\u4ee3\u5668\u5b9e\u73b0\u4e00\u4e2a\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff1a<code>y=2x+1</code>","text":"<pre><code>class PointXY:\n    \"\"\"\u901a\u8fc7\u8fed\u4ee3\u5668\uff0c\u751f\u6210\u4e0d\u786e\u5b9a\u4e2a\u6570\u70b9\u7684\u5750\u6807\"\"\"\n    def __init__(self):\n        self.x  = 0\n\n    def __iter__(self):\n        return self\n\n    def __next__(self):\n      y = 2 * self.x + 1\n      point_x_y = (self.x, y)\n      self.x = y\n      return point_x_y\n\npoint = PointXY()\nprint(next(point))  # (0, 1)\nprint(next(point))  # (1, 3)\nprint(next(point))  # (3, 7)\nprint(next(point))  # (7, 15)\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_13","title":"\u6590\u6ce2\u90a3\u5951\u6570\u5217","text":"<pre><code>class FibIterator:\n\n    def __init__(self):\n        self.num1 = 1\n        self.num2 = 1\n\n    def __iter__(self):\n        return self\n\n    def __next__(self):\n        tmp_num = self.num1\n        self.num1, self.num2 = self.num2, self.num1 + self.num2\n        return tmp_num\n\n\nfib = FibIterator()\nprint(next(fib))  # 1\nprint(next(fib))  # 1 \nprint(next(fib))  # 2\nprint(next(fib))  # 3\nprint(next(fib))  # 5\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_14","title":"\u8fed\u4ee3\u5668\u7684\u4f18\u7f3a\u70b9","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_15","title":"\u4f18\u70b9","text":"<ol> <li>\u4e3a\u5e8f\u5217\u548c\u975e\u5e8f\u5217\u7c7b\u578b\u63d0\u4f9b\u4e86\u4e00\u79cd\u7edf\u4e00\u7684\u8fed\u4ee3\u53d6\u503c\u65b9\u5f0f\u3002</li> <li>\u60f0\u6027\u8ba1\u7b97\uff1a\u8fed\u4ee3\u5668\u5bf9\u8c61\u8868\u793a\u7684\u662f\u4e00\u4e2a\u6570\u636e\u6d41\uff0c\u53ef\u4ee5\u53ea\u5728\u9700\u8981\u65f6\u624d\u53bb\u8c03\u7528next\u6765\u8ba1\u7b97\u51fa\u4e00\u4e2a\u503c\uff0c\u5c31\u8fed\u4ee3\u5668\u672c\u8eab\u6765\u8bf4\uff0c\u540c\u4e00\u65f6\u523b\u5728\u5185\u5b58\u4e2d\u53ea\u6709\u4e00\u4e2a\u503c\uff0c\u56e0\u800c\u53ef\u4ee5\u5b58\u653e\u65e0\u9650\u5927\u7684\u6570\u636e\u6d41\uff0c\u800c\u5bf9\u4e8e\u5176\u4ed6\u5bb9\u5668\u7c7b\u578b\uff0c\u5982\u5217\u8868\uff0c\u9700\u8981\u628a\u6240\u6709\u7684\u5143\u7d20\u90fd\u5b58\u653e\u4e8e\u5185\u5b58\u4e2d\uff0c\u53d7\u5185\u5b58\u5927\u5c0f\u7684\u9650\u5236\uff0c\u53ef\u4ee5\u5b58\u653e\u7684\u503c\u7684\u4e2a\u6570\u662f\u6709\u9650\u7684\u3002</li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_16","title":"\u7f3a\u70b9","text":"<ol> <li>\u9664\u975e\u53d6\u5c3d\uff0c\u5426\u5219\u65e0\u6cd5\u83b7\u53d6\u8fed\u4ee3\u5668\u7684\u957f\u5ea6</li> <li>\u53ea\u80fd\u53d6\u4e0b\u4e00\u4e2a\u503c\uff0c\u4e0d\u80fd\u56de\u5230\u5f00\u59cb\uff0c\u66f4\u50cf\u662f\u2018\u4e00\u6b21\u6027\u7684\u2019\uff0c\u8fed\u4ee3\u5668\u4ea7\u751f\u540e\u7684\u552f\u4e00\u76ee\u6807\u5c31\u662f\u91cd\u590d\u6267\u884c<code>next</code>\u65b9\u6cd5\u76f4\u5230\u503c\u53d6\u5c3d\uff0c\u5426\u5219\u5c31\u4f1a\u505c\u7559\u5728\u67d0\u4e2a\u4f4d\u7f6e\uff0c\u7b49\u5f85\u4e0b\u4e00\u6b21\u8c03\u7528<code>next</code>\uff1b\u82e5\u662f\u8981\u518d\u6b21\u8fed\u4ee3\u540c\u4e2a\u5bf9\u8c61\uff0c\u4f60\u53ea\u80fd\u91cd\u65b0\u8c03\u7528<code>iter</code>\u65b9\u6cd5\u53bb\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fed\u4ee3\u5668\u5bf9\u8c61\uff0c\u5982\u679c\u6709\u4e24\u4e2a\u6216\u8005\u591a\u4e2a\u5faa\u73af\u4f7f\u7528\u540c\u4e00\u4e2a\u8fed\u4ee3\u5668\uff0c\u5fc5\u7136\u53ea\u4f1a\u6709\u4e00\u4e2a\u5faa\u73af\u80fd\u53d6\u5230\u503c\u3002</li> </ol> <p>\u8fed\u4ee3\u5668\u5b58\u50a8\u662f\u751f\u6210\u6570\u636e\u7684\u7b97\u6cd5\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#_17","title":"\u4e8c\u3001\u751f\u6210\u5668","text":"<p>\u5229\u7528\u8fed\u4ee3\u5668\u4e5f\u53ef\u4ee5\u5728\u6bcf\u6b21\u8fed\u4ee3\u83b7\u53d6\u6570\u636e\uff08\u901a\u8fc7next()\u65b9\u6cd5\uff09\u65f6\u6309\u7167\u7279\u5b9a\u7684\u89c4\u5f8b\u8fdb\u884c\u751f\u6210\u3002 \u4f46\u662f\u5728\u5b9e\u73b0\u4e00\u4e2a\u8fed\u4ee3\u5668\u65f6\uff0c\u5173\u4e8e\u5f53\u524d\u8fed\u4ee3\u5230\u7684\u72b6\u6001\u9700\u8981\u6211\u4eec\u81ea\u5df1\u8bb0\u5f55\uff0c\u8fdb\u800c\u624d\u80fd\u6839\u636e\u5f53\u524d\u72b6\u59d4\u751f\u6210\u4e0b\u4e00\u4e2a\u6570\u636e\u3002\u4e3a\u4e86\u8fbe\u5230\u8bb0\u5f55\u5f53\u524d\u72b6\u6001\uff0c\u5e76\u914d\u5408<code>next()</code>\u51fd\u6570\u8fdb\u884c\u8fed\u4ee3\u4f7f\u7528\uff0c \u7b80\u8a00\u4e4b\uff0c\u8fed\u4ee3\u5668\u662f\u53ef\u4ee5\u5b9e\u73b0\u5728\u5faa\u73af\u7684\u8fc7\u7a0b\u4e2d\u751f\u6210\u6570\u636e\u7684\uff0c\u4f46\u662f\u7a0d\u7a0d\u6709\u4e9b\u590d\u6742.\u6709\u4e00\u4e2a\u80fd\u5177\u6709\u8fed\u4ee3\u5668\u7684\u529f\u80fd\uff0c\u4e14\u6bd4\u5b83\u66f4\u52a0\u7b80\u5355\u7684\u65b9\u5f0f\uff1a\u751f\u6210\u5668\uff08generator\uff09\u3002\u751f\u6210\u5668\u662f\u4e00\u7c7b\u7279\u6b8a\u7684\u8fed\u4ee3\u5668\u3002</p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#1","title":"1.\u521b\u5efa\u751f\u6210\u5668\u7684\u65b9\u6cd5","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#1_1","title":"1. \u628a\u5217\u8868\u751f\u6210\u5f0f\u7684<code>[]</code>\u6539\u4e3a<code>()</code>","text":"<pre><code>&gt;&gt;&gt; g = (x * x for x in range(10) if x % 3 == 0)\n&gt;&gt;&gt; print(next(g))\n0\n&gt;&gt;&gt; print(next(g))\n9\n&gt;&gt;&gt; print(next(g))\n36\n&gt;&gt;&gt; print(next(g))\n81\n&gt;&gt;&gt; print(next(g))\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n&gt;&gt;&gt; g\n&lt;generator object &lt;genexpr&gt; at 0x0000019318767A98&gt;\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#2-yield","title":"2. \u4f7f\u7528yield\u5173\u952e\u5b57","text":""},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#1-yeild","title":"1. yeild\u6267\u884c\u8fc7\u7a0b","text":"<pre><code>&gt;&gt;&gt; def func():\n...     print('\u7b2c\u4e00\u6b21')\n...     yield 1\n...     print('\u7b2c\u4e8c\u6b21')\n...     yield 2\n...     print('\u7b2c\u4e09\u6b21')\n...     yield 3\n...     print('\u7b2c\u56db\u6b21')\n...\n&gt;&gt;&gt; g=func()\n&gt;&gt;&gt; print(g)\n&lt;generator object func at 0x0000019318767A98&gt;\n&gt;&gt;&gt; next(g)\n\u7b2c\u4e00\u6b21\n1\n&gt;&gt;&gt; next(g)\n\u7b2c\u4e8c\u6b21\n2\n&gt;&gt;&gt; next(g)\n\u7b2c\u4e09\u6b21\n3\n&gt;&gt;&gt; next(g)\n\u7b2c\u56db\u6b21\nTraceback (most recent call last):\n  File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\nStopIteration\n&gt;&gt;&gt; #next() \u4f1a\u89e6\u53d1\u51fd\u6570\u4f53\u4ee3\u7801\u7684\u8fd0\u884c\uff0c\u7136\u540e\u9047\u5230yield\u505c\u4e0b\u6765\uff0c\u5c06yield\u540e\u7684\u503c\u5f53\u505a\u672c\u6b21\u8c03\u7528\u7684\u7ed3\u679c\u8fd4\u56de\n...\n</code></pre> <p>\u6267\u884c\u8fc7\u7a0b\uff1a 1. \u5982\u679c\u662f\u7b2c\u4e00\u6b21\u6267\u884c\uff0c\u5219\u4ecedef\u4ee3\u7801\u5757\u7684\u5f00\u59cb\u90e8\u5206\u6267\u884c\uff0c\u76f4\u5230\u9047\u5230yield\u4e3a\u6b62\uff0c\u5e76\u4e14\u628ayield\u5173\u952e\u5b57\u540e\u7684\u6570\u503c\u8fd4\u56de\uff0c\u5f53\u505a<code>next()</code>\u7684\u8fd4\u56de\u503c 2. \u5982\u679c\u4e0d\u662f\u7b2c\u4e00\u6b21\u6267\u884c\uff0c\u5219\u4ece\u4e0a\u4e00\u6b21\u6682\u505c\u7684\u4f4d\u7f6e\u6267\u884c\uff08\u5373\u4ece\u4e0a\u4e00\u6b21yield\u5173\u952e\u5b57\u7684\u4e0b\u4e00\u4e2a\u8bed\u53e5\u5f00\u59cb\u6267\u884c\uff09\uff0c\u76f4\u5230\u9047\u5230\u4e0b\u4e00\u6b21yield\u4e3a\u6b62\uff0c\u5e76\u4e14\u628ayield\u952e\u5b57\u540e\u7684\u6570\u503c\u8fd4\u56de\uff0c\u5f53\u505a<code>next()</code>\u7684\u8fd4\u56de\u503c 3. \u5982\u679c\u51fd\u6570\u8fd0\u884c\u7ed3\u675f\uff08\u5373\u9047\u5230return\uff09\u5219\u629b\u51faStopIteration\u5f02\u5e38</p> <p>\u6709\u4e86yield\u5173\u952e\u5b57\uff0c\u6211\u4eec\u5c31\u6709\u4e86\u4e00\u79cd\u81ea\u5b9a\u4e49\u8fed\u4ee3\u5668\u7684\u5b9e\u73b0\u65b9\u5f0f\u3002yield\u53ef\u4ee5\u7528\u4e8e\u8fd4\u56de\u503c\uff0c\u4f46\u4e0d\u540c\u4e8ereturn\uff0c\u51fd\u6570\u4e00\u65e6\u9047\u5230return\u5c31\u7ed3\u675f\u4e86\uff0c\u800cyield\u53ef\u4ee5\u4fdd\u5b58\u51fd\u6570\u7684\u8fd0\u884c\u72b6\u6001\u6302\u8d77\u51fd\u6570\uff0c\u7528\u6765\u8fd4\u56de\u591a\u6b21\u503c\u3002</p> <p>\u901a\u5e38\u628a\u542b\u6709yield\u7684\u51fd\u6570\u79f0\u4e3a\u751f\u6210\u5668\u51fd\u6570\uff0c\u628a\u8c03\u7528\u751f\u6210\u5668\u51fd\u6570\u8fd4\u56de\u7684\u7ed3\u679c\u79f0\u4e3a\u751f\u6210\u5668\u3002</p> <p>yield\u5173\u952e\u5b57\u6539\u53d8\u4e86\u51fd\u6570\u7684\u6027\u8d28\uff1a 1. \u8c03\u7528\u751f\u6210\u5668\u51fd\u6570\u4e0d\u662f\u76f4\u63a5\u6267\u884c\u5176\u4e2d\u7684\u4ee3\u7801\uff0c\u800c\u662f\u8fd4\u56de\u4e00\u4e2a\u5bf9\u8c61 2. \u751f\u6210\u5668\u51fd\u6570\u5185\u7684\u4ee3\u7801\uff0c\u9700\u8981\u901a\u8fc7\u751f\u6210\u5668\u5bf9\u8c61\u6765\u6267\u884c\u3002</p> <p>\u4f7f\u7528\u8fed\u4ee3\u5668\u5b9e\u73b0\u6590\u6ce2\u90a3\u5951\u6570\u5217</p> <pre><code>def fib_generator():\n    num1 = 1\n    num2 = 1\n\n    while True:\n        tmp_num = num1\n        num1, num2 = num2, num1 + num2\n        yield tmp_num\n\n\nfib = fib_generator()\nprint(fib)  # &lt;generator object fib_generator at 0x000001AEC6FBAA50&gt;\nprint(next(fib))  # 1\nprint(next(fib))  # 1\nprint(next(fib))  # 2\nprint(next(fib))  # 3\nprint(next(fib))  # 4\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#2-return","title":"2. \u83b7\u53d6\u751f\u6210\u5668\u4e2dreturn\u7684\u8fd4\u56de\u503c\u3002","text":"<pre><code>def fib_generator():\n    num1 = 1\n    num2 = 1\n\n    tmp_num = num1\n    num1, num2 = num2, num1 + num2\n    yield tmp_num\n\n    tmp_num = num1\n    num1, num2 = num2, num1 + num2\n    yield tmp_num\n\n    tmp_num = num1\n    num1, num2 = num2, num1 + num2\n    yield tmp_num\n\n    return \"\u7ed3\u675f\"\n\nfib = fib_generator()\nprint(next(fib))  # 1\nprint(next(fib))  # 1\nprint(next(fib))  # 2\ntry: \n    print(next(fib))\nexcept StopIteration as ret:\n    print(ret.value)  # \u7ed3\u675f\n</code></pre>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#3-send","title":"3. send","text":"<p>\u5982\u679c\u60f3\u8981\u8ba9\u751f\u6210\u5668\u7ee7\u7eed\u5411\u4e0b\u5f00\u59cb\u8fd0\u884c\uff0c\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528next\u6216\u8005send\u3002 \u4e24\u8005\u90fd\u4f1a\u8ba9\u751f\u6210\u5668\u7ee7\u7eed\u5411\u4e0b\u8fd0\u884c\uff0c\u5982\u679c\u8fd0\u884c\u65f6\uff0c\u9047\u4e0d\u89c1yield\uff0c\u90a3\u4e48\u90fd\u4f1a\u4ea7\u751f\u5f02\u5e38\u3002 \u4f46\u662fnext\u53ea\u4f1a\u8ba9\u8fd0\u884c\u7ee7\u7eed\u5f00\u59cb\uff0c\u800csend\u9664\u4e86\u53ef\u4ee5\u8ba9\u5176\u5f00\u59cb\u8fd0\u884c\u4e4b\u5916\uff0c\u8fd8\u53ef\u4ee5\u5c06\u67d0\u4e2a\u6570\u636e\u643a\u5e26\u8fc7\u53bb</p> <pre><code>def g_fun():\n    while True:\n        print(\"----1----\")\n        num = yield 100\n        print(\"----2----\", \"num=\", num)\n\ng = g_fun()\nprint(next(g))   \nprint(next(g))   \nprint(next(g))   \nprint(g.send(200))   \nprint(g.send(300))\n</code></pre> <p>\u6267\u884c\u7ed3\u679c <pre><code>----1----\n100\n----2---- num= None\n----1----\n100\n----2---- num= None\n----1----\n100\n----2---- num= 200\n----1----\n100\n----2---- num= 300\n----1----\n100\n</code></pre></p>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#2-4","title":"2. \u751f\u6210\u5668\u76844\u4e2a\u72b6\u6001","text":"<ol> <li> <p>\u5f53\u8c03\u7528\u751f\u6210\u5668\u51fd\u6570\u5f97\u5230\u751f\u6210\u5668\u5bf9\u8c61\u65f6\uff0c\u6b64\u65f6\u7684\u751f\u6210\u5668\u5bf9\u8c61\u53ef\u4ee5\u7406\u89e3\u4e3a\u5904\u4e8e\u521d\u59cb\u72b6\u6001</p> </li> <li> <p>\u901a\u8fc7<code>next()</code>\u8c03\u7528\u751f\u6210\u5668\u5bf9\u8c61\uff0c\u5bf9\u5e94\u7684\u751f\u6210\u5668\u51fd\u6570\u4ee3\u7801\u5f00\u59cb\u8fd0\u884c,\u6b64\u65f6\u751f\u6210\u5668\u5bf9\u8c61\u5904\u4e8e\u8fd0\u884c\u4e2d\u72b6\u6001</p> </li> <li> <p>\u5982\u679c\u9047\u5230\u4e86yield\u8bed\u53e5\uff0c<code>next()</code>\u8fd4\u56de\u65f6\uff0cyield\u8bed\u53e5\u53f3\u8fb9\u7684\u5bf9\u8c61\u4f5c\u4e3a <code>next()</code>\u7684\u8fd4\u56de\u503c\uff1b\u751f\u6210\u5668\u5728yield\u8bed\u53e5\u6240\u5728\u7684\u4f4d\u7f6e\u6682\u505c\u5f53\u518d\u6b21\u4f7f\u7528<code>next()</code>\u65f6\u7ee7\u7eed\u4ece\u8be5\u4f4d\u7f6e\u7ee7\u7eed\u8fd0\u884c</p> </li> <li> <p>\u5982\u679c\u6267\u884c\u5230\u51fd\u6570\u7ed3\u675f\uff0c\u5219\u629b\u51faStopIteration\u5f02\u5e38\u3002\u4e0d\u7ba1\u662f\u4f7f\u7528\u4e86return\u8bed\u53e5\u663e\u5f0f\u5730\u8fd4\u56de\u503c\uff0c\u6216\u8005\u9ed8\u8ba4\u8fd4\u56deNone\u503c\uff0c\u8fd4\u56de\u503c\u90fd\u53ea\u80fd\u4f5c\u4e3a\u5f02\u5e38\u7684\u503c\u4e00\u5e76\u629b\u51fa,\u6b64\u65f6\u7684\u751f\u6210\u5668\u5bf9\u8c61\u5904\u4e8e\u7ed3\u675f\u7684\u72b6\u6001\uff1b\u5bf9\u4e8e\u5df2\u7ecf\u7ed3\u675f\u7684\u751f\u6210\u5668\u5bf9\u8c61\u518d\u6b21\u8c03\u7528<code>next()</code>\uff0c\u76f4\u63a5\u629b\u51faStopIteration\u5f02\u5e38\uff0c\u5e76\u4e14\u4e0d\u542b\u8fd4\u56de\u503c</p> </li> </ol>"},{"location":"programming/python/%E5%9F%BA%E7%A1%80/%E8%BF%AD%E4%BB%A3%E5%99%A8%E5%92%8C%E7%94%9F%E6%88%90%E5%99%A8/#3","title":"3. \u751f\u6210\u5668\u6848\u4f8b","text":"<p>\u4f7f\u7528\u751f\u6210\u5668\u5b9e\u73b0\u4e00\u4e2a\u4e8c\u5143\u4e00\u6b21\u65b9\u7a0b\uff1a<code>y=2x+1</code></p> <pre><code>def point_generator():\n    x = 0\n    k = 2\n    b = 1\n    while True:\n        y = k * x + b\n        tmp = yield (x, y)\n        if tmp:\n            k, b = tmp\n        x = y\n\n\npoint = point_generator()\n\nprint(next(point))  # (0, 1)\nprint(next(point))  # (1, 3)\nprint(next(point))  # (3, 7)\nprint(next(point))  # (7, 15)\nprint(point.send((3, 2)))  # (15, 47)\nprint(point.send((3, 2)))  # (47, 143)\nprint(point.send((3, 2)))  # (143, 431)\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/","title":"\u6570\u636e\u5206\u6790","text":""},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#matplotlib","title":"\u4e00\u3001matplotlib","text":"<ol> <li>\u80fd\u5c06\u6570\u636e\u8fdb\u884c\u53ef\u89c6\u5316\uff0c\u66f4\u76f4\u89c2\u7684\u5448\u73b0</li> <li>\u4f7f\u6570\u636e\u66f4\u52a0\u5ba2\u89c2\u3001\u66f4\u5177\u8bf4\u670d\u529b</li> <li>\u6700\u6d41\u884c\u7684Python\u5e95\u5c42\u7ed8\u56fe\u5e93\uff0c\u4e3b\u8981\u505a\u6570\u636e\u53ef\u89c6\u5316\u56fe\u8868,\u540d\u5b57\u53d6\u6750\u4e8eMATLAB\uff0c\u6a21\u4effMATLAB\u6784\u5efa</li> </ol>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#1","title":"1. \u57fa\u672c\u4f7f\u7528","text":"<pre><code>from matplotlib import pylab as plt\n\nx = range(2, 26, 2)  # \u6570\u636e\u5728x\u8f74\u7684\u4f4d\u7f6e 0-24h\ny = [15, 13, 14.5, 17, 20, 25, 26, 26, 27, 22, 18, 15]  # \u6570\u636e\u5728y\u8f74\u7684\u4f4d\u7f6e\nplt.plot(x, y)  # \u7ed8\u5236\u6298\u7ebf\u56fe\nplt.show()  # \u5c55\u793a\u56fe\u5f62\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#2","title":"2. \u8bbe\u7f6e\u56fe\u5f62\u5927\u5c0f\u548c\u523b\u5ea6","text":"<pre><code>from matplotlib import pylab as plt\n\nplt.figure(figsize=(20, 8), dpi=80)\n# figsize(\u5bbd\uff0c\u9ad8)\uff1a\u8bbe\u7f6e\u56fe\u5f62\u5927\u5c0f\uff0c\u5355\u4f4d\u662f\u82f1\u5bf8\uff1b dpi\uff1a\u8bbe\u7f6e\u56fe\u5f62\u6bcf\u82f1\u5bf8\u7684\u70b9\u6570\n\nx = range(2, 26, 2)  # \u6570\u636e\u5728x\u8f74\u7684\u4f4d\u7f6e 0-24h\ny = [15, 13, 14.5, 17, 20, 25, 26, 26, 27, 22, 18, 15]  # \u6570\u636e\u5728y\u8f74\u7684\u4f4d\u7f6e\n\nplt.plot(x, y)  # \u7ed8\u5236\u6298\u7ebf\u56fe\nplt.xticks(x)  # \u628ax\u8f74\u7684\u503c\u5168\u90e8\u7ed8\u5236\u5230\u56fe\u5f62\u4e0a\nplt.yticks(range(min(y), max(y) + 1))  # \u7ed9y\u8f74\u7ed8\u6570\u503c\nplt.savefig('./tmp.png')  # \u4fdd\u5b58\nplt.show()  # \u5c55\u793a\u56fe\u5f62\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#3","title":"3. \u8bbe\u7f6e\u4e2d\u6587\u5b57\u4f53","text":"<pre><code>from matplotlib import pylab as plt\nimport matplotlib\n# \u65b9\u5f0f\u4e00\uff1a\nfont = {'family': 'Microsoft Yahei',\n        'weight': 'bold',\n        'size': 16}\nmatplotlib.rc('font', **font)  # \u8bbe\u7f6e\u5b57\u4f53\uff0c\u652f\u6301\u4e2d\u6587\n# \u65b9\u5f0f\u4e8c\uff1a\n# from matplotlib import font_manager\n# font = font_manager.FontProperties(fname=r'C:\\Windows\\Fonts\\STXINGKA.TTF')\n# plt.xticks(list(x), x_labels, rotation=45, fontproperties=font)\n\n\nplt.figure(figsize=(20, 8), dpi=80)\n\nx = range(0, 60, 5)  # \u6570\u636e\u5728x\u8f74\u7684\u4f4d\u7f6e 0-24h\ny = [15, 13, 14.5, 17, 20, 25, 26, 26, 27, 22, 18, 15]  # \u6570\u636e\u5728y\u8f74\u7684\u4f4d\u7f6e\n\nplt.plot(x, y)  # \u7ed8\u5236\u6298\u7ebf\u56fe\n\n# \u8c03\u6574x\u8f74\u7684\u523b\u5ea6\nx_labels = [\"10\u65f6{}\u5206\".format(i) for i in x]\n\nplt.xticks(list(x), x_labels, rotation=45)  # \u628ax\u8f74\u7684\u503c\u5168\u90e8\u7ed8\u5236\u5230\u56fe\u5f62\u4e0a\n# rotation : \u8bbe\u7f6e\u5b57\u65cb\u8f6c\u89d2\u5ea6\nplt.yticks(range(min(y), max(y) + 1))  # \u7ed9y\u8f74\u7ed8\u6570\u503c\nplt.show()  # \u5c55\u793a\u56fe\u5f62\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#4","title":"4. \u8bbe\u7f6e\u56fe\u5f62\u4fe1\u606f","text":"<pre><code>from matplotlib import pylab as plt\nimport matplotlib\n\nfont = {'family': 'Microsoft Yahei',\n        'weight': 'bold',\n        'size': 16}\nmatplotlib.rc('font', **font)  # \u8bbe\u7f6e\u5b57\u4f53\uff0c\u652f\u6301\u4e2d\u6587\nplt.figure(figsize=(20, 12), dpi=80)\n\nx = range(0, 60, 5)\n\ny = [15, 13, 14.5, 17, 20, 25, 26, 26, 27, 22, 18, 15]  # \u6570\u636e\u5728y\u8f74\u7684\u4f4d\u7f6e\nplt.plot(x, y, label=\"Beijing\", color='r', linestyle='--', linewidth=5)  # label \u663e\u793a\u56fe\u4f8b\n# \u6709\u51e0\u4e2ay\u8f74\u6570\u636e\u8c03\u7528\u51e0\u6b21plot\u5373\u53ef\n\nx_labels = [\"10\u65f6{}\u5206\".format(i) for i in x]\nplt.xticks(list(x), x_labels, rotation=45)\nplt.yticks(range(min(y), max(y) + 1))\n\n# \u6dfb\u52a0\u63cf\u8ff0\u4fe1\u606f\nplt.xlabel(\"\u65f6\u95f4\")\nplt.ylabel(\"\u6e29\u5ea6 \u5355\u4f4d\u2103\")\nplt.title(\"10\u70b9\u6bcf5\u5206\u949f\u7684\u6c14\u6e29\u53d8\u5316\u60c5\u51b5\")\nplt.grid(alpha=0.5)  # \u8bbe\u7f6e\u7f51\u683c alpha\uff1a\u8bbe\u7f6e\u900f\u660e\u5ea6\nplt.legend(loc=\"upper left\")  # \u6dfb\u52a0\u56fe\u4f8b  loc: \u8bbe\u7f6e\u56fe\u4f8b\u7684\u4f4d\u7f6e\nplt.show()\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#5","title":"5. \u7ed8\u5236\u56fe\u5f62","text":""},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#1_1","title":"1. \u6563\u70b9\u56fe","text":"<pre><code>from matplotlib import pylab as plt\nimport matplotlib\n\nfont = {'family': 'Microsoft Yahei',\n        'weight': 'bold',\n        'size': 16}\nmatplotlib.rc('font', **font)  # \u8bbe\u7f6e\u5b57\u4f53\uff0c\u652f\u6301\u4e2d\u6587\nplt.figure(figsize=(20, 12), dpi=80)\n\ny = [11, 17, 16, 11, 12, 11, 12, 6, 6, 7, 8, 9, 12, 15, 14, 17, 18,\n     21, 16, 17, 20, 14, 15, 15, 15, 19, 21, 22, 22, 22, 23]\n\nx = range(1, 32)\n\nplt.scatter(x, y)\nplt.show()\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#2_1","title":"2. \u6761\u5f62\u56fe","text":"<p>\u4f7f\u7528\u573a\u666f\uff1a</p> <ol> <li>\u6570\u91cf\u7edf\u8ba1</li> <li>\u9891\u7387\u7edf\u8ba1</li> </ol> <pre><code>from matplotlib import pylab as plt\nimport matplotlib\n\nfont = {'family': 'Microsoft Yahei',\n        'size': 16}\nmatplotlib.rc('font', **font)  # \u8bbe\u7f6e\u5b57\u4f53\uff0c\u652f\u6301\u4e2d\u6587\nplt.figure(figsize=(20, 16), dpi=80)\na = [\"\u6218\u72fc2\", \"\u901f\u5ea6\u4e0e\u6fc0\u60c58\", \"\u529f\u592b\u745c\u4f3d\", \"\u897f\u6e38\u4f0f\u5996\u7bc7\", \"\u53d8\u5f62\u91d1\u521a5\uff1a\u6700\u540e\u7684\u9a91\u58eb\", \"\u6454\u8de4\u5427\uff01\u7238\u7238\", \"\u52a0\u52d2\u6bd4\u6d77\u76d75\uff1a\u6b7b\u65e0\u5bf9\u8bc1\", \"\u91d1\u521a\uff1a\u9ab7\u9ac5\u5c9b\", \"\u6781\u9650\u7279\u5de5\uff1a\u7ec8\u6781\u56de\u5f52\", \"\u751f\u5316\u5371\u673a6\uff1a\u7ec8\u7ae0\",\n     \"\u4e58\u98ce\u7834\u6d6a\", \"\u795e\u5077\u5976\u72383\", \"\u667a\u53d6\u5a01\u864e\u5c71\", \"\u5927\u95f9\u5929\u7afa\", \"\u91d1\u521a\u72fc3\uff1a\u6b8a\u6b7b\u4e00\u6218\", \"\u8718\u86db\u4fa0\uff1a\u82f1\u96c4\u5f52\u6765\", \"\u609f\u7a7a\u4f20\", \"\u94f6\u6cb3\u62a4\u536b\u961f2\", \"\u60c5\u5723\", \"\u65b0\u6728\u4e43\u4f0a\", ]\n\nb = [56.01, 26.94, 17.53, 16.49, 15.45, 12.96, 11.8, 11.61, 11.28, 11.12, 10.49, 10.3, 8.75, 7.55, 7.32, 6.99, 6.88,\n     6.86, 6.58, 6.23]\n\n# \u7eb5\u5411\u6761\u5f62\u56fe\n# plt.bar(a, b, width=0.3)  # width: \u8bbe\u7f6e\u6761\u5f62\u5bbd\u5ea6\n\n# \u6a2a\u5411\u6761\u5f62\u56fe\nplt.barh(a, b, height=0.3)  # height: \u8bbe\u7f6e\u6761\u5f62\u5bbd\u5ea6\n\nplt.ylabel(\"\u7535\u5f71\u540d\u79f0\")\nplt.xlabel(\"\u7968\u623f \u5355\u4f4d\uff1a\u4ebf\")\nplt.title(\"2017\u5e74\u7535\u5f71\u7968\u623f\u6392\u884c\u699c\")\nplt.show()\n</code></pre> <p></p> <pre><code>from matplotlib import pylab as plt\nimport matplotlib\n\nfont = {'family': 'Microsoft Yahei',\n        'size': 16}\nmatplotlib.rc('font', **font)  # \u8bbe\u7f6e\u5b57\u4f53\uff0c\u652f\u6301\u4e2d\u6587\nplt.figure(figsize=(20, 16), dpi=80)\n\na = [\"\u7329\u7403\u5d1b\u8d773\uff1a\u7ec8\u6781\u4e4b\u6218\", \"\u6566\u523b\u5c14\u514b\", \"\u8718\u86db\u4fa0\uff1a\u82f1\u96c4\u5f52\u6765\", \"\u6218\u72fc2\"]\nb_14 = [2358, 399, 2358, 362]\nb_15 = [12357, 156, 2045, 168]\nb_16 = [15746, 312, 4497, 319]\n\nbar_width = 0.2\n\nx_14 = list(range(len(a)))\nx_15 = [i + bar_width for i in x_14]\nx_16 = [i + bar_width * 2 for i in x_14]\n\nplt.bar(range(len(a)), b_14, width=bar_width, label=\"9\u670814\u65e5\")\nplt.bar(x_15, b_15, width=bar_width, label=\"9\u670815\u65e5\")\nplt.bar(x_16, b_16, width=bar_width, label=\"9\u670816\u65e5\")\nplt.xticks(x_15, a)\nplt.legend()\nplt.show()\n</code></pre> <p></p>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#3_1","title":"3. \u76f4\u65b9\u56fe","text":"<pre><code>from matplotlib import pylab as plt\nimport matplotlib\n\nfont = {'family': 'Microsoft Yahei',\n        'size': 16}\nmatplotlib.rc('font', **font)  # \u8bbe\u7f6e\u5b57\u4f53\uff0c\u652f\u6301\u4e2d\u6587\nplt.figure(figsize=(20, 16), dpi=80)\n\na = [131, 98, 125, 131, 124, 139, 131, 117, 128, 108, 135, 138, 131, 102, 107,\n     114, 119, 128, 121, 142, 127, 130, 124, 101, 110, 116, 117, 110, 128, 128,\n     115, 99, 136, 126, 134, 95, 138, 117, 111, 78, 132, 124, 113, 150, 110, 117,\n     86, 95, 144, 105, 126, 130, 126, 130, 126, 116, 123, 106, 112, 138, 123, 86,\n     101, 99, 136, 123, 117, 119, 105, 137, 123, 128, 125, 104, 109, 134, 125, 127,\n     105, 120, 107, 129, 116, 108, 132, 103, 136, 118, 102, 120, 114, 105, 115, 132,\n     145, 119, 121, 112, 139, 125, 138, 109, 132, 134, 156, 106, 117, 127, 144, 139,\n     139, 119, 140, 83, 110, 102, 123, 107, 143, 115, 136, 118, 139, 123, 112, 118,\n     125, 109, 119, 133, 112, 114, 122, 109, 106, 123, 116, 131, 127, 115, 118, 112,\n     135, 115, 146, 137, 116, 103, 144, 83, 123, 111, 110, 111, 100, 154, 136, 100, 118,\n     119, 133, 134, 106, 129, 126, 110, 111, 109, 141, 120, 117, 106, 149, 122, 122, 110,\n     118, 127, 121, 114, 125, 126, 114, 140, 103, 130, 141, 117, 106, 114, 121, 114, 133,\n     137, 92, 121, 112, 146, 97, 137, 105, 98, 117, 112, 81, 97, 139, 113, 134, 106,\n     144, 110, 137, 137, 111, 104, 117, 100, 111, 101, 110, 105, 129, 137, 112, 120, 113,\n     133, 112, 83, 94, 146, 133, 101, 131, 116, 111, 84, 137, 115, 122, 106, 144, 109,\n     123, 116, 111, 111, 133, 150]\n\n# \u7ec4\u6570 = \u6781\u5dee/\u7ec4\u8ddd = (max(a) - min(a)) / width\nd = 3  # \u7ec4\u8ddd\nnum_bins = (max(a) - min(a)) // d\n# plt.hist(a, num_bins)\n# plt.hist(a, num_bins, density=True)  # density  \u9891\u7387\u5206\u5e03\u76f4\u65b9\u56fe\nplt.hist(a, range(min(a), max(a) + d, d))  # \u5982\u679c\u7ed8\u5236\u7684\u56fe\u5f62\u6709\u504f\u79fb\uff0c\u7528\u8fd9\u79cd\u65b9\u6cd5\nplt.xticks(range(min(a), max(a) + d, d))\n\nplt.grid()\nplt.show()\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#numpy","title":"\u4e8c\u3001numpy","text":""},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#1_2","title":"1. \u521b\u5efa\u6570\u7ec4","text":"<pre><code>import numpy as np\n\nprint(np.array([1, 2, 3, 4, 5]))  # [1 2 3 4 5]\nprint(np.array(range(1, 6)))  # [1 2 3 4 5]\nprint(np.arange(1, 6, 2))  # [1 3 5]\nprint(np.arange(1, 6, 2).dtype)  # int32\nprint(np.array(range(1, 6), dtype='int8').dtype)  # int8  dtype:\u6307\u5b9a\u6570\u636e\u7c7b\u578b\nt = np.array(range(1, 6), dtype='int8')\nt = t.astype('int64')  # \u8c03\u6574\u6570\u636e\u7c7b\u578b\nprint(t.dtype)  # int64\n\n# \u5904\u7406\u5c0f\u6570\nimport random\nt = np.array([random.random() for _ in range(10)])\nprint(t.round(2))  # [0.38 0.28 0.75 0.93 0.04 0.29 0.82 0.59 0.12 0.5 ]\nprint(np.round(t, 2))  # [0.38 0.28 0.75 0.93 0.04 0.29 0.82 0.59 0.12 0.5 ]\n\n\nt = np.ones((2, 3))  # 2\u884c3\u5217\u5168\u4e3a1\u7684\u6570\u7ec4\n\nt = np.zeros((2, 3))  # 2\u884c3\u5217\u5168\u4e3a0\u7684\u6570\u7ec4\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#2_2","title":"2. \u6570\u7ec4\u7684\u5f62\u72b6","text":"<pre><code>import numpy as np\n# \u4e8c\u7ef4\nt = np.array([[1, 2, 3, 4, 5], [6, 7, 8, 9, 0]])\nprint(t.shape)  # (2, 5)  2\u884c5\u5217\n\n# \u4e09\u7ef4\nt = np.array([[[1, 2, 3], [4, 5, 6]], [[7, 8, 9], [10,11,12]]])\nprint(t.shape)  # (2, 2, 3)\n\nprint(t.reshape(2, 6))  # \u8c03\u6574\u6570\u636e\u7684\u5f62\u72b6\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#3_2","title":"3. \u6570\u7ec4\u548c\u6570\u7684\u8ba1\u7b97","text":"<pre><code>import numpy as np\n\nt = np.array([1, 2, 3, 4, 5])\n# \u6570\u7ec4\u548c\u6570\u5b57\u76f8\u52a0\nprint(t + 1)  # [2 3 4 5 6]\nprint(t * 3)  # [ 2  4  6  8 10]\n# \u6570\u7ec4\u548c\u6570\u7ec4\u76f8\u52a0\nprint(t + t)  # [ 2  4  6  8 10]\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#4_1","title":"4. \u8bfb\u53d6\u6587\u4ef6","text":"<pre><code>np.loadtxt(fname,dtype=np.float,delimiter=None,skiprows=0,usecols=None,unpack=False)\n</code></pre> \u53c2\u6570 \u89e3\u91ca frame \u6587\u4ef6\u3001\u5b57\u7b26\u4e32\u6216\u751f\u4ea7\u5668\uff0c\u53ef\u4ee5\u662f.gz\u6216bz2\u538b\u7f29\u6587\u4ef6 dtype \u6570\u636e\u7c7b\u578b\uff0c\u53ef\u9009\u3002\u9ed8\u8ba4np.float delimiter \u5206\u5272\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u7a7a\u683c skiprows \u8df3\u8fc7\u524dx\u884c usecols \u8bfb\u53d6\u6307\u5b9a\u7684\u5217\uff0c\u7d22\u5f15\uff0c\u5143\u7ec4\u7c7b\u578b unpack \u5982\u679cTrue\uff0c\u8bfb\u5165\u5c5e\u6027\u5c06\u5206\u522b\u5199\u5165\u4e0d\u540c\u6570\u7ec4\u53d8\u91cf\uff0cFalse\u8bfb\u5165\u6570\u636e\u53ea\u5199\u5165\u4e00\u4e2a\u6570\u7ec4\u53d8\u91cf\uff0c\u9ed8\u8ba4False <pre><code># \u8f6c\u7f6e\nimport numpy as np\n\nt = np.array(range(24)).reshape(4, 6)\nprint(t)\n# [[ 0  1  2  3  4  5]\n#  [ 6  7  8  9 10 11]\n#  [12 13 14 15 16 17]\n#  [18 19 20 21 22 23]]\nprint(t.T)\nprint(t.transpose())\nprint(t.swapaxes(1, 0))\n# [[ 0  6 12 18]\n#  [ 1  7 13 19]\n#  [ 2  8 14 20]\n#  [ 3  9 15 21]\n#  [ 4 10 16 22]\n#  [ 5 11 17 23]]\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#5_1","title":"5. \u7d22\u5f15\u548c\u5207\u7247","text":"<pre><code>import numpy as np\n\nt = np.array(range(24)).reshape(8, 3)\n\n# \u53d6\u5176\u4e2d\u4e00\u884c\nprint(t[3])  # [ 9 10 11]\n\n# \u53d6\u8fde\u7eed\u591a\u884c\nprint(t[3:])\n\n# \u53d6\u4e0d\u8fde\u7eed\u591a\u884c\nprint(t[[1, 2, 5]])\n\n# \u53d6\u5217\nprint(t[:, 1])  # \u53d6\u7b2c2\u5217\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#6","title":"6. \u4fee\u6539\u6570\u503c","text":"<pre><code>import numpy as np\n\nt = np.array(range(24)).reshape(8, 3)\n\n# \u628a\u5c0f\u4e8e10\u7684\u503c\u4fee\u6539\u4e3a0\nt[t &lt; 10] = 0\nprint(t)\n\n# \u4e09\u5143\u8fd0\u7b97\uff0c\u628a\u5c0f\u4e8e10\u7684\u503c\u6539\u4e3a0\uff0c\u5176\u4ed6\u6539\u4e3a1\nt1 = np.where(t &lt; 10, 0, 1)\nprint(t1)\n\n# \u88c1\u526a\n#  \u5c0f\u4e8e10\u7684\u5168\u90e8\u6539\u621010\uff0c\u5927\u4e8e18\u7684\u5168\u90e8\u6539\u621018\nt1 = t.clip(10, 18)\nprint(t1)\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#7","title":"7. \u62fc\u63a5","text":"<pre><code>import numpy as np\n\nt1 = np.array(range(12)).reshape(2, 6)\nt2 = np.array(range(12)).reshape(2, 6)\n\nprint(np.vstack((t1, t2)))  # \u7ad6\u76f4\u62fc\u63a5\n# [[ 0  1  2  3  4  5]\n#  [ 6  7  8  9 10 11]\n#  [ 0  1  2  3  4  5]\n#  [ 6  7  8  9 10 11]]\nprint(np.hstack((t1, t2)))  # \u6c34\u5e73\u62fc\u63a5\n# [[ 0  1  2  3  4  5  0  1  2  3  4  5]\n#  [ 6  7  8  9 10 11  6  7  8  9 10 11]]\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#pandas","title":"\u4e09\u3001pandas","text":"<p>pandas\u9664\u4e86\u5904\u7406\u6570\u503c\u4e4b\u5916(\u57fa\u4e8enumpy)\uff0c\u8fd8\u80fd\u591f\u5e2e\u52a9\u6211\u4eec\u5904\u7406\u5176\u4ed6\u7c7b\u578b\u7684\u6570\u636e\u3002</p> <ol> <li>Series \u4e00\u7ef4\uff0c\u5e26\u6807\u7b7e\u6570\u7ec4</li> <li>DataFrame \u4e8c\u7ef4\uff0cSeries\u5bb9\u5668</li> </ol>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#1-series","title":"1. <code>Series</code>","text":""},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#11","title":"1.1 \u521b\u5efa","text":"<pre><code>import pandas as pd\n\nt = pd.Series([1, 2, 3, 4, 5])\n\nprint(type(t))  # &lt;class 'pandas.core.series.Series'&gt;\nprint(t)\n# 0    1\n# 1    2\n# 2    3\n# 3    4\n# 4    5\n# dtype: int64\n\n# \u6307\u5b9a\u7d22\u5f15\nt = pd.Series([1, 2, 3, 4, 5], index=[list('abcde')])\nprint(t)\n# a    1\n# b    2\n# c    3\n# d    4\n# e    5\n# dtype: int64\n\n# \u901a\u8fc7\u5b57\u5178\u521b\u5efa\n\nd = {\"name\": \"Tom\", \"age\": 18}\nt = pd.Series(d)\nprint(t)\n# name    Tom\n# age      18\n# dtype: object\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#12","title":"1.2 \u7d22\u5f15\u548c\u5207\u7247","text":"<pre><code>import pandas as pd\n\nd = {\"name\": \"Tom\", \"age\": 18}\nt = pd.Series(d)\nprint(t[1])  # 18\nprint(t['name'])  # Tom\nprint(t[['name', 'age']])\n# name    Tom\n# age      18\n# dtype: object\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#2-dataframe","title":"2. <code>DataFrame</code>","text":""},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#21","title":"2.1 \u521b\u5efa","text":"<pre><code>import pandas as pd\nimport numpy as np\n\nt = pd.DataFrame(np.arange(12).reshape(3, 4), index=list('abc'), columns=list(\"ABCD\"))\nprint(t)\n#    0  1   2   3\n# 0  0  1   2   3\n# 1  4  5   6   7\n# 2  8  9  10  11\n\n\n# \u901a\u8fc7\u5b57\u5178\u521b\u5efa\n# \u65b9\u5f0f\u4e00\nd = {\"name\": [\"Tom\", \"Jerry\"], \"age\": [18, 16]}\nt = pd.DataFrame(d)\nprint(t)\n#     name  age\n# 0    Tom   18\n# 1  Jerry   16\n\n# \u65b9\u5f0f\u4e8c\nl = [{\"name\": \"Tom\", \"age\": 18}, {\"name\": \"Jerry\", \"age\": 16}]\nt = pd.DataFrame(l)\nprint(t)\n#     name  age\n# 0    Tom   18\n# 1  Jerry   16\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#22","title":"2.2 \u57fa\u7840\u5c5e\u6027","text":"<pre><code>In [1]: import pandas as pd\n\nIn [2]: d = {\"name\": [\"Tom\", \"Jerry\"], \"age\": [18, 16]}\n\nIn [3]: t = pd.DataFrame(d)\n\nIn [4]: t.shape\nOut[4]: (2, 2)\n\nIn [5]: t.dtypes\nOut[5]:\nname    object\nage      int64\ndtype: object\n\nIn [6]: t.ndim\nOut[6]: 2\n\nIn [7]: t.index\nOut[7]: RangeIndex(start=0, stop=2, step=1)\n\nIn [8]: t.columns\nOut[8]: Index(['name', 'age'], dtype='object')\n\nIn [9]: t.values\nOut[9]:\narray([['Tom', 18],\n       ['Jerry', 16]], dtype=object)\n\nIn [10]: t.head(1)  # \u663e\u793a\u5934\u90e8\u51e0\u884c\uff0c\u9ed8\u8ba45\u884c\nOut[10]:\n  name  age\n0  Tom   18\n\nIn [11]: t.tail(1)  # \u663e\u793a\u5c3e\u90e8\u90e8\u51e0\u884c\uff0c\u9ed8\u8ba45\u884c\nOut[11]:\n    name  age\n1  Jerry   16\n\nIn [12]: t.info()  # \u663e\u793a\u76f8\u5173\u4fe1\u606f\u6982\u89c8\n&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 2 entries, 0 to 1\nData columns (total 2 columns):\n #   Column  Non-Null Count  Dtype\n---  ------  --------------  -----\n 0   name    2 non-null      object\n 1   age     2 non-null      int64\ndtypes: int64(1), object(1)\nmemory usage: 160.0+ bytes\n\nIn [13]: t.describe()   # \u5feb\u901f\u7efc\u5408\u7edf\u8ba1\u7ed3\u679c\uff1a\u8ba1\u6570\uff0c\u5747\u503c\uff0c\u6807\u51c6\u5dee\uff0c\u56db\u5206\u4f4d\u6570\uff0c\u6700\u5c0f\u503c\uff0c\u6700\u5927\u503c\nOut[13]:\n             age\ncount   2.000000\nmean   17.000000\nstd     1.414214\nmin    16.000000\n25%    16.500000\n50%    17.000000\n75%    17.500000\nmax    18.000000\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#23","title":"2.3 \u57fa\u7840\u65b9\u6cd5","text":"<pre><code>import pandas as pd\n\nd = {\"name\": [\"Tom\", \"Jerry\"], \"age\": [18, 16]}\nt = pd.DataFrame(d)\n\n# \u6392\u5e8f\nprint(t.sort_values(by='age'))\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#24","title":"2.4 \u7d22\u5f15","text":"<pre><code>import pandas as pd\n\nd = {\"project\": [\"Django\", \"Flask\", \"Fastapi\", \"Tornado\", \"Bottle\"], \"star\": [58234, 55953, 32574, 20134, 7351]}\nt = pd.DataFrame(d)\n\nprint(t[:3])  # \u524d3\u884c\nprint(t[:3]['star'])  # \u524d3\u884cstar\u5217\nprint(t['project']) # \u53d6\u5217\n\n\n# df.loc \u901a\u8fc7\u6807\u7b7e\u7d22\u5f15\u884c\u6570\u636e\n# df.iloc \u901a\u8fc7\u4f4d\u7f6e\u83b7\u53d6\u884c\u6570\u636e\n\nt = pd.DataFrame(np.arange(12).reshape(3, 4), index=list('abc'), columns=list(\"WZYX\"))\nprint(t.loc['a'])  # \u53d6\u67d0\u4e00\u884c\n# W    0\n# Z    1\n# Y    2\n# X    3\n# Name: a, dtype: int32\n\nprint(t.loc[:, \"Y\"])  # \u53d6\u67d0\u4e00\u5217\n# a     2\n# b     6\n# c    10\n# Name: Y, dtype: int32\n\nprint(t.loc['a', \"Z\"])  # 1\nprint(t.loc['a':'c', \"Z\"])  # \u9700\u8981\u6ce8\u610f\u7684\u662f\uff1a\u5192\u53f7\u5728loc\u91cc\u662f\u95ed\u5408\u7684\n# a    1\n# b    5\n# c    9\n# Name: Z, dtype: int32\n\n\n# \u5e03\u5c14\u7d22\u5f15\nd = {\"project\": [\"Django\", \"Flask\", \"Fastapi\", \"Tornado\", \"Bottle\"], \"star\": [58234, 55953, 32574, 20134, 7351]}\nt = pd.DataFrame(d)\n\nprint(t[t['star'] &gt; 30000])\n#    project   star\n# 0   Django  58234\n# 1    Flask  55953\n# 2  Fastapi  32574\n\n\n# \u591a\u6761\u4ef6 &amp; | \uff0c\u4e0d\u540c\u7684\u6761\u4ef6\u4e4b\u95f4\u8981\u7528\u62ec\u53f7\u62ec\u8d77\u6765\u3002\nprint(t[(t['star'] &lt; 30000) &amp; (t['star'] &gt; 20000)])\n#    project   star\n# 3  Tornado  20134\n</code></pre>"},{"location":"programming/python/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/#3_3","title":"3. \u8bfb\u53d6\u5916\u90e8\u6570\u636e","text":"<pre><code>import pandas as pd\n\ndf = pd.read_csv(\"filename.csv\")\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/","title":"\u5355\u5143\u6d4b\u8bd5\u6846\u67b6","text":"<ol> <li>\u6d4b\u8bd5\u53d1\u73b0\uff1a\u4ece\u591a\u4e2a<code>py</code>\u6587\u4ef6\u4e2d\u6536\u96c6\u5e76\u52a0\u8f7d\u6d4b\u8bd5\u7528\u4f8b</li> <li>\u6d4b\u8bd5\u6267\u884c\uff1a\u5c06\u6d4b\u8bd5\u7528\u4f8b\u6309\u7167\u4e00\u5b9a\u7684\u987a\u5e8f\u548c\u6761\u4ef6\u53d6\u6267\u884c\u5e76\u751f\u6210\u7ed3\u679c</li> <li>\u6d4b\u8bd5\u5224\u65ad\uff1a\u901a\u8fc7\u65ad\u8a00\u53d6\u5224\u65ad\u7ed3\u679c\u662f\u5426\u6b63\u786e</li> <li>\u6d4b\u8bd5\u62a5\u544a\uff1a\u7edf\u8ba1\u6d4b\u8bd5\u8fdb\u5ea6\uff0c\u901a\u8fc7\u7387\uff0c\u751f\u6210\u62a5\u544a</li> </ol>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#unittest","title":"\u4e00 <code>unittest</code>","text":""},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1","title":"1. \u91cd\u8981\u7ec4\u4ef6","text":"<ol> <li><code>TestCase</code></li> <li><code>TestSuite</code></li> <li><code>TestFixTure</code></li> <li><code>TestLoader</code></li> <li><code>TestRunner</code></li> </ol>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2-testcase","title":"2. <code>TestCase</code>","text":"<pre><code>import unittest\n\n\nclass EcshopLogin(unittest.TestCase):\n    # \u6d4b\u8bd5\u7528\u4f8b\n    def test01_register(self):\n        print(\"\u6ce8\u518c\u6d4b\u8bd5\")\n\n    def test02_login(self):\n        print(\"\u767b\u5f55\u6d4b\u8bd5\")\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1_1","title":"1. \u4f7f\u7528\u547d\u4ee4\u884c\u65b9\u5f0f\u8fd0\u884c","text":"<pre><code># python -m unittest \u6587\u4ef6\u540d\npython -m unittest ecshop_login.py\n\u6ce8\u518c\u6d4b\u8bd5\n.\u767b\u5f55\u6d4b\u8bd5\n.\n----------------------------------------------------------------------\nRan 2 tests in 0.000s\n\nOK\n\n# python -m unittest \u6a21\u5757\u540d.\u7c7b\u540d\npython -m unittest ecshop_login.EcshopLogin\n\u6ce8\u518c\u6d4b\u8bd5\n.\u767b\u5f55\u6d4b\u8bd5\n.\n----------------------------------------------------------------------\nRan 2 tests in 0.002s\n\nOK\n# python -m unittest \u6a21\u5757\u540d.\u7c7b\u540d.\u65b9\u6cd5\u540d\npython -m unittest ecshop_login.EcshopLogin.test02_login\n\u767b\u5f55\u6d4b\u8bd5\n.\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nOK\n# python -m unittest -v \u6a21\u5757\u540d.\u7c7b\u540d.\u65b9\u6cd5\u540d \n# -v \u663e\u793a\u8be6\u7ec6\npython -m unittest -v ecshop_login.EcshopLogin.test02_login\ntest02_login (ecshop_login.EcshopLogin) ... \u767b\u5f55\u6d4b\u8bd5\nok\n\n----------------------------------------------------------------------\nRan 1 test in 0.000s\n\nOK\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2","title":"2. \u6267\u884c\u7ed3\u679c\u5206\u6790","text":"<pre><code>. \u6210\u529f\nF \u5931\u8d25\nE \u9519\u8bef\nS \u8df3\u8fc7\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#3","title":"3. \u7528\u4f8b\u6267\u884c\u987a\u5e8f","text":"<p>\u6309\u7167ASCII\u7801\u7684\u89c4\u5219\uff1a0-9 A-Z a-z</p>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#4-testsuite","title":"4. \u4f7f\u7528<code>TestSuite</code>\u53ea\u8fd0\u884c\u90e8\u5206\u7528\u4f8b","text":"<pre><code>import unittest\n\n\nclass EcshopLogin(unittest.TestCase):\n    # \u6d4b\u8bd5\u7528\u4f8b\n    def test01_register(self):\n        print(\"\u6ce8\u518c\u6d4b\u8bd5\")\n\n    def test02_login(self):\n        print(\"\u767b\u5f55\u6d4b\u8bd5\")\n\n\nif __name__ == '__main__':\n    suite = unittest.TestSuite()\n    # \u6dfb\u52a0\u6d4b\u8bd5\u5355\u5143\u65b9\u5f0f\u4e00\n    suite.addTest(EcshopLogin(\"test02_login\"))\n    # \u6dfb\u52a0\u6d4b\u8bd5\u5355\u5143\u65b9\u5f0f\u4e8c\n    #testcases = [EcshopLogin(\"test02_login\")]\n    #suite.addTests(testcases)\n    # \u6dfb\u52a0\u6d4b\u8bd5\u5355\u5143\u65b9\u5f0f\u4e09\n    #testcases = unittest.defaultTestLoader.discover(start_dir=os.getcwd(), pattern=\"test*.py\")\n    #suite.addTests(testcases)\n\n\n    # \u8fd0\u884c\u65b9\u5f0f\u4e00\n    # unittest.main(defaultTest='suite')\n    # \u8fd0\u884c\u65b9\u5f0f\u4e8c\n    unittest.TextTestRunner().run(suite)\n</code></pre> <pre><code>python ecshop_login.py\n\u767b\u5f55\u6d4b\u8bd5\n.\n----------------------------------------------------------------------\nRan 1 test in 0.001s\n\nOK\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#5-testfixture","title":"5. <code>Testfixture</code>","text":"<pre><code>import unittest\n\n\ndef setUpModule():\n    print(\"start Module TestFixture\")\n\n\ndef tearDownModule():\n    print(\"end Module TestFixture\")\n\n\nclass EcshopLogin(unittest.TestCase):\n    @classmethod\n    def setUpClass(cls) -&gt; None:\n        print(\"setUpClass: \u5728\u6bcf\u4e2a\u7c7b\u4e4b\u524d\u6267\u884c\u4e00\u6b21\")\n\n    def setUp(self) -&gt; None:\n        print(\"setUp: \u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4e4b\u524d\u7684\u51c6\u5907\u5de5\u4f5c\")\n\n    def test01_register(self):\n        print(\"\u6ce8\u518c\u6d4b\u8bd5\")\n\n    def test02_login(self):\n        print(\"\u767b\u5f55\u6d4b\u8bd5\")\n\n    def tearDown(self) -&gt; None:\n        print(\"tearDown: \u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4e4b\u540e\u7684\u6e05\u7406\u5de5\u4f5c\")\n\n    @classmethod\n    def tearDownClass(cls) -&gt; None:\n        print(\"tearDownClass: \u5728\u6bcf\u4e2a\u7c7b\u4e4b\u540e\u7684\u6267\u884c\u4e00\u6b21\")\n\n\nif __name__ == '__main__':\n    unittest.main()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>$ python ecshop_login.py\nstart Module TestFixture\nsetUpClass: \u5728\u6bcf\u4e2a\u7c7b\u4e4b\u524d\u6267\u884c\u4e00\u6b21\nsetUp: \u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4e4b\u524d\u7684\u51c6\u5907\u5de5\u4f5c\n\u6ce8\u518c\u6d4b\u8bd5\ntearDown: \u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4e4b\u540e\u7684\u6e05\u7406\u5de5\u4f5c\n.setUp: \u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4e4b\u524d\u7684\u51c6\u5907\u5de5\u4f5c\n\u767b\u5f55\u6d4b\u8bd5\ntearDown: \u5728\u6bcf\u4e2a\u6d4b\u8bd5\u7528\u4f8b\u4e4b\u540e\u7684\u6e05\u7406\u5de5\u4f5c\n.tearDownClass: \u5728\u6bcf\u4e2a\u7c7b\u4e4b\u540e\u7684\u6267\u884c\u4e00\u6b21\nend Module TestFixture\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#6","title":"6. \u5ffd\u7565\u6d4b\u8bd5\u7528\u4f8b","text":"<pre><code>import unittest\n\n@unittest.skip(\"\u6b64\u6a21\u5757\u5ffd\u7565\u6d4b\u8bd5\")\nclass EcshopLogin(unittest.TestCase):\n    age = 20\n\n    @unittest.skip(\"\u65e0\u6761\u4ef6\u5ffd\u7565\")\n    def test01_register(self):\n        print(\"\u6ce8\u518c\u6d4b\u8bd5\")\n\n    @unittest.skipIf(age &gt; 18, \"\u6761\u4ef6\u4e3a\u771f\u5ffd\u7565\")\n    def test02_login(self):\n        print(\"\u767b\u5f55\u6d4b\u8bd5\")\n\n    @unittest.skipUnless(age &gt; 18, \"\u6761\u4ef6\u4e3a\u5047\u5ffd\u7565\")\n    def test03_logout(self):\n        print(\"\u767b\u51fa\u6d4b\u8bd5\")\n\n\nif __name__ == '__main__':\n    unittest.main()\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#7","title":"7. \u65ad\u8a00","text":"<pre><code>import unittest\n\n\nclass EcshopLogin(unittest.TestCase):\n\n    def test01_register(self):\n        self.assertTrue([])\n\n    def test02_login(self):\n        self.assertEqual(1, 2)\n\n\nif __name__ == '__main__':\n    unittest.main()\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#8-ddt","title":"8. DDT\u88c5\u9970\u5668","text":"<pre><code>@ddt  # \u7c7b\u88c5\u9970\u5668\uff0c\u58f0\u660e\u5f53\u524d\u7c7b\u4f7f\u7528DDT\u6846\u67b6\n@data # \u51fd\u6570\u88c5\u9970\u5668\uff0c\u7528\u4e8e\u7ed9\u6d4b\u8bd5\u7528\u4f8b\u4f20\u9012\u53c2\u6570\n@unpack # \u51fd\u6570\u88c5\u9970\u5668\uff0c\u5c06\u4f20\u8f93\u7684\u6570\u636e\u5305\u89e3\u5305\uff0c\u4e00\u822c\u4f5c\u7528\u4e8e\u5143\u7ec4\u548c\u5217\u8868\n@file_data # \u51fd\u6570\u88c5\u9970\u5668\uff0c\u53ef\u76f4\u63a5\u8bfb\u53d6yaml/json\u6587\u4ef6\n</code></pre> <p><code>@data</code>\u7684\u4f7f\u7528</p> <pre><code>import unittest\n\nimport ddt as ddt\n\n\n@ddt.ddt()\nclass LoginTest(unittest.TestCase):\n    @ddt.data('tom')  # \u4f20\u51e0\u4e2a\u503c\uff0c\u7528\u4f8b\u6267\u884c\u51e0\u6b21\n    def test01_login(self, name):\n        print(name)\n\n\nif __name__ == '__main__':\n    unittest.main()\n</code></pre> <p><code>@unpack</code>\u7684\u4f7f\u7528</p> <pre><code>import unittest\n\nimport ddt as ddt\n\n\n@ddt.ddt()\nclass LoginTest(unittest.TestCase):\n    @ddt.data((\"tom\", 18), (\"jerry\", 16))\n    @ddt.unpack\n    def test01_login(self, name, age):\n        print(name, age)\n\n\nif __name__ == '__main__':\n    unittest.main()\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#9","title":"9. \u6e90\u7801\u5206\u6790","text":"<pre><code>class TestProgram(object):\n    def __init__(self, \n                 module='__main__',  # \u6d4b\u8bd5\u7528\u4f8b\u6240\u5728\u7684\u8def\u5f84\n                 defaultTest=None,  # \u5f85\u6d4b\u8bd5\u7528\u4f8b\u7684\u540d\u79f0\uff0c\u9ed8\u8ba4\u6240\u6709\n                 argv=None,  # \u63a5\u6536\u5916\u90e8\u53c2\u6570\n                 testRunner=None,   # \u6d4b\u8bd5\u8fd0\u884c\u5668\uff0c\u9ed8\u8ba4\u4e3aTextTestRunner\n                 testLoader=loader.defaultTestLoader,  # \u6307\u5b9a\u9ed8\u8ba4\u6d4b\u8bd5\u52a0\u8f7d\u5668\n                 exit=True,  # \u662f\u5426\u5728\u6d4b\u8bd5\u5b8c\u6210\u540e\u7ed3\u675fpython\u7a0b\u5e8f\n                 verbosity=1,  # \u7c7b\u4f3c\u4e8e\u547d\u4ee4\u884c-v [0|1|2]\n                 failfast=None, \n                 catchbreak=None,\n                 buffer=None, \n                 warnings=None, \n                 *, \n                 tb_locals=False):\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#pytest","title":"\u4e8c\u3001<code>pytest</code>","text":""},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1_2","title":"1. \u7f16\u5199\u89c4\u5219","text":"<pre><code>import pytest\n\n\nclass TestLogin:\n\n    def test_01_login(self):\n        print(\"\u767b\u5f55\u6d4b\u8bd5\")\n\n\nif __name__ == '__main__':\n    pytest.main(['-sv'])\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2_1","title":"2 \u6267\u884c","text":""},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1_3","title":"1. \u6267\u884c\u65b9\u5f0f","text":""},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1_4","title":"1. \u4e3b\u51fd\u6570\u6a21\u5f0f","text":"<ol> <li>\u6267\u884c\u6240\u6709\uff1a<code>pytest.main()</code></li> <li>\u6307\u5b9a\u6a21\u5757\uff1a<code>pytest.main(['-sv','test_login.py']</code></li> <li>\u6307\u5b9a\u76ee\u5f55\uff1a<code>pytest.main(['-sv', './testcases_dir'])</code></li> <li>\u901a\u8fc7nodeid\u6307\u5b9a\uff1anodeid\u7531\u6a21\u5757\u540d\uff0c\u5206\u9694\u7b26\uff0c\u7c7b\u540d\uff0c\u65b9\u6cd5\u540d\uff0c\u51fd\u6570\u540d\u7ec4\u6210<code>pytest.main(['-sv', 'test_login.py::TestLogin::test_01_login'])</code></li> </ol>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2_2","title":"2.\u547d\u4ee4\u884c\u6a21\u5f0f","text":"<ol> <li>\u6267\u884c\u6240\u6709\uff1a<code>pytest</code></li> <li>\u6307\u5b9a\u6a21\u5757\uff1a<code>pytest -sv test_login.py</code></li> <li>\u6307\u5b9a\u76ee\u5f55\uff1a<code>pytest -sv ./testcases_dir</code></li> <li>\u901a\u8fc7nodeid\u6307\u5b9a\uff1anodeid\u7531\u6a21\u5757\u540d\uff0c\u5206\u9694\u7b26\uff0c\u7c7b\u540d\uff0c\u65b9\u6cd5\u540d\uff0c\u51fd\u6570\u540d\u7ec4\u6210<code>pytest -sv test_login.py::TestLogin::test_01     _login</code></li> </ol>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2_3","title":"2. \u5e38\u7528\u53c2\u6570","text":"<pre><code>-s: \u8868\u793a\u8f93\u51fa\u8c03\u8bd5\u4fe1\u606f\uff0c\u5305\u62ecprint\u6253\u5370\u7684\u4fe1\u606f\n-v: \u663e\u793a\u66f4\u8be6\u7ec6\u7684\u4fe1\u606f\n-n \u5206\u5e03\u5f0f\u8fd0\u884c\n</code></pre>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#_2","title":"\u5355\u5143\u6d4b\u8bd5","text":""},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#_3","title":"\u5355\u5143\u6d4b\u8bd5\u6846\u67b6\u5bf9\u6bd4","text":""},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#1_5","title":"1. \u7528\u4f8b\u7f16\u5199\u89c4\u5219","text":"<p><code>unittest</code>: \u63d0\u4f9b\u4e86<code>testcase</code>(\u6d4b\u8bd5\u7528\u4f8b)\u3001<code>testsuites</code>(\u6d4b\u8bd5\u5957\u4ef6)\u3001<code>testfixtures</code>(\u6d4b\u8bd5\u56fa\u4ef6/\u5939\u5177)\u3001<code>testloader</code>(\u6d4b\u8bd5\u52a0\u8f7d\u5668)\u3001<code>testrunner</code>(\u6d4b\u8bd5\u8fd0\u884c\u5668)\u3002\u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ol> <li>\u6d4b\u8bd5\u6587\u4ef6\u5fc5\u987b\u5bfc\u5165\uff1a<code>import\u00a0unittest</code></li> <li>\u6d4b\u8bd5\u7c7b\u5fc5\u987b\u7ee7\u627f<code>unittest.TestCase</code></li> <li>\u6d4b\u8bd5\u65b9\u6cd5\u5fc5\u987b\u4ee5<code>test</code>\u5f00\u5934</li> </ol> <p><code>pytest</code>\uff1a\u7b2c\u4e09\u65b9\u6d4b\u8bd5\u6846\u67b6\uff0c\u57fa\u4e8e<code>unittest</code>\u7684\u6269\u5c55\u6846\u67b6\uff0c\u5fc5\u987b\u9075\u5b88\u4ee5\u4e0b\u89c4\u5219\uff1a</p> <ol> <li>\u6d4b\u8bd5\u6587\u4ef6\u540d\u5fc5\u987b\u4ee5<code>test_</code>\u5f00\u5934\u6216\u8005<code>_test</code>\u7ed3\u5c3e</li> <li>\u6d4b\u8bd5\u7c7b\u5fc5\u987b\u4ee5<code>Test</code>\u5f00\u5934</li> <li>\u6d4b\u8bd5\u65b9\u6cd5\u5fc5\u987b\u4ee5<code>test</code>\u5f00\u5934</li> </ol>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#2_4","title":"2. \u7528\u4f8b\u7684\u524d\u7f6e\u548c\u540e\u7f6e","text":"<p><code>unittest</code>: </p> <ol> <li><code>setUp</code>/<code>tearDown</code>  \u5728\u6bcf\u4e2a\u7528\u4f8b\u4e4b\u524d/\u4e4b\u540e\u8fd0\u884c\u4e00\u6b21\u3002\u5982\u6253\u5f00\u6d4f\u89c8\u5668\uff0c\u52a0\u8f7d/\u5173\u95ed\u7f51\u9875</li> <li><code>setUpClass</code>/<code>teatDownClass</code> \u5728\u6bcf\u4e2a\u7c7b\u8fd0\u884c\u4e4b\u524d/\u4e4b\u540e\u8fd0\u884c\u4e00\u6b21\u3002\u5982\u521b\u5efa/\u5173\u95ed\u6570\u636e\u5e93\u8fde\u63a5\uff0c\u521b\u5efa/\u9500\u6bc1\u65e5\u5fd7\u5bf9\u8c61</li> <li><code>setUpModule</code>/<code>tearDownModule</code> \u5728\u6bcf\u4e2a\u6a21\u5757\u4e4b\u524d/\u4e4b\u540e\u6267\u884c\u4e00\u6b21</li> </ol> <p><code>pytest</code>:</p> <ol> <li>\u65b9\u6cd5\u7ea7<ol> <li><code>setup_method</code>/<code>teardown_method</code> \u5728\u65b9\u6cd5\u4e4b\u524d/\u4e4b\u540e\u3002\u4f18\u5148\u7ea7\u9ad8</li> <li><code>setup</code>/<code>teardown</code> \u5728\u65b9\u6cd5\u4e4b\u524d/\u4e4b\u540e\u3002\u4f18\u5148\u7ea7\u4f4e</li> </ol> </li> <li>\u51fd\u6570\u7ea7<ol> <li><code>setup_function</code>/<code>teardown_function</code> \u5728\u51fd\u6570\u4e4b\u524d/\u4e4b\u540e</li> </ol> </li> <li>\u7c7b\u7ea7<ol> <li><code>setup_class/teardown_class</code> \u5728\u7c7b\u4e4b\u524d/\u4e4b\u540e</li> </ol> </li> <li>\u6a21\u5757\u7ea7<ol> <li><code>setup_module/teardown_module</code> \u5728\u6a21\u5757\u4e4b\u524d/\u4e4b\u540e</li> </ol> </li> <li>\u88c5\u9970\u5668\uff1a\u53ef\u4ee5\u5728\u51fd\u6570\u4e4b\u524d\u52a0<code>pytest_fixture()</code>\u5b9e\u73b0\u4e0a\u8ff0\u7684\u529f\u80fd</li> </ol>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#3_1","title":"3. \u65ad\u8a00","text":"<p><code>unittest</code>: <code>assertTrue</code>\u3001<code>assertEqual</code>\u3001<code>assertin</code></p> <p><code>pytest</code>: <code>assert</code></p>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#4","title":"4. \u62a5\u544a","text":"<p><code>unittest</code>: <code>htmltestrunner</code></p> <p><code>pytest</code>:\u63d2\u4ef6\uff08<code>pytest-HTML</code>\u3001<code>allure</code>\uff09</p>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#5","title":"5. \u5931\u8d25\u91cd\u8dd1","text":"<p><code>unittest</code>\uff1a\u65e0</p> <p><code>pytest</code>: <code>pytest-rerunfailures</code>\u63d2\u4ef6</p>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#6_1","title":"6. \u6570\u636e\u9a71\u52a8","text":"<p><code>unittest</code>: DDT</p> <p><code>pytest</code>: <code>@pytest.mark.parametrize</code>\u88c5\u9970\u5668</p>"},{"location":"programming/python/%E6%B5%8B%E8%AF%95/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/#7_1","title":"7. \u7528\u4f8b\u5206\u7c7b\u6267\u884c","text":"<p><code>unittest</code>:\u9ed8\u8ba4\u6267\u884c\u6240\u6709\uff0c\u4e5f\u53ef\u4ee5\u7528\u8fc7<code>testsuite</code>\u6765\u6267\u884c\u90e8\u5206\u7528\u529b\uff0c\u6216\u8005-k\u53c2\u6570</p> <p><code>pytest</code>:<code>@pytest.mark</code></p>"},{"location":"resource/docs/","title":"\u6587\u6863","text":""},{"location":"resource/docs/#-python","title":"- Python","text":"<ul> <li>Django2.2.x\u6587\u6863</li> <li>Django1.11.x\u6587\u6863</li> <li>Flask1.1.x\u6587\u6863\uff08\u82f1\u6587\u7248\uff09</li> <li>Flask1.1.x\u6587\u6863\uff08\u4e2d\u6587\u7248\uff09</li> <li>Flask Web\u5f00\u53d1\uff1a\u57fa\u4e8ePython\u7684Web\u5e94\u7528\u5f00\u53d1\u5b9e\u6218.\u7b2c2\u7248</li> <li>bottle-docs</li> <li>Jinja2.11x\u6587\u6863</li> </ul>"},{"location":"resource/docs/#-","title":"- \u6570\u636e\u5e93","text":""},{"location":"resource/docs/#postgresql","title":"PostgreSQL","text":"<ul> <li>PostgreSQL11.2\u4e2d\u6587\u6587\u6863</li> <li>Mysql5.7\u53c2\u8003\u624b\u518c</li> </ul>"},{"location":"resource/docs/#-vim","title":"- VIM","text":"<p>Vim\u5b9e\u7528\u6280\u5de7</p>"},{"location":"software/middleware/rabbitmq/","title":"RabbitMQ","text":""},{"location":"software/middleware/rabbitmq/#_1","title":"\u4e00\u3001\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"software/middleware/rabbitmq/#1","title":"1. \u6d88\u606f\u4e2d\u95f4\u4ef6","text":""},{"location":"software/middleware/rabbitmq/#1_1","title":"1. \u6d88\u606f\u4e0e\u6d88\u606f\u961f\u5217\u4e2d\u95f4\u4ef6","text":"<p>\u6d88\u606f\uff1a\u6d88\u606f\u662f\u6307\u5e94\u7528\u95f4\u4f20\u9001\u7684\u6570\u636e\uff0c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\uff0cJSON\uff0c\u5185\u5d4c\u5bf9\u8c61\u7b49</p> <p>\u6d88\u606f\u4e2d\u95f4\u4ef6\uff1a\u662f\u6307\u5229\u7528\u9ad8\u6548\u53ef\u9760\u989d\u6d88\u606f\u4f20\u9012\u673a\u5236\u8fdb\u884c\u4e0e\u5e73\u53f0\u65e0\u5173\u7684\u6570\u636e\u4ea4\u6d41\uff0c\u5e76\u57fa\u4e8e\u6570\u636e\u901a\u4fe1\u6765\u8fdb\u884c\u5206\u5e03\u5f0f\u7cfb\u7edf\u96c6\u6210\u3002</p>"},{"location":"software/middleware/rabbitmq/#2","title":"2. \u6d88\u606f\u4f20\u9012\u6a21\u5f0f","text":"<ol> <li>\u70b9\u5bf9\u70b9\uff1a\u6d88\u606f\u751f\u4ea7\u8005\u751f\u4ea7\u6d88\u606f\u53d1\u9001\u5230queue\u4e2d\uff0c\u7136\u540e\u6d88\u606f\u6d88\u8d39\u8005\u4ecequeue\u4e2d\u53d6\u51fa\u5e76\u4e14\u6d88\u8d39\u6d88\u606f</li> <li>\u53d1\u5e03/\u8ba2\u9605\uff1a\u4f7f\u7528topic\u4f5c\u4e3a\u901a\u4fe1\u8f7d\u4f53 </li> </ol>"},{"location":"software/middleware/rabbitmq/#3","title":"3.\u4e3b\u6d41\u4ea7\u54c1","text":"<p>Rabbitmq\u3001Kafka\u3001ActiveMQ\u3001RocketMQ</p>"},{"location":"software/middleware/rabbitmq/#4","title":"4. \u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u4f5c\u7528","text":"<ol> <li>\u89e3\u8026</li> <li>\u5197\u4f59\uff08\u5b58\u50a8\uff09\uff1a\u628a\u6570\u636e\u6301\u4e45\u5316\u76f4\u5230\u6570\u636e\u88ab\u5904\u7406\u5b8c</li> <li>\u6269\u5c55\u6027</li> <li>\u524a\u5cf0\uff1a\u4f7f\u5173\u952e\u7ec4\u4ef6\u652f\u6491\u7a81\u53d1\u8bbf\u95ee\u538b\u529b</li> <li>\u53ef\u6062\u590d\u6027</li> <li>\u987a\u5e8f\u4fdd\u8bc1\uff1a\u4fdd\u8bc1\u6570\u636e\u5904\u7406\u7684\u987a\u5e8f</li> <li>\u7f13\u51b2</li> <li>\u5f02\u6b65\u901a\u4fe1</li> </ol>"},{"location":"software/middleware/rabbitmq/#2-rabbitmq","title":"2. Rabbitmq","text":""},{"location":"software/middleware/rabbitmq/#1_2","title":"1. \u5b98\u7f51","text":"<p>http://www.rabbitmq.com/</p>"},{"location":"software/middleware/rabbitmq/#2_1","title":"2. \u7279\u70b9","text":"<ol> <li>\u53ef\u9760\u6027\uff1a \u6301\u4e45\u5316\u3001\u4f20\u8f93\u786e\u8ba4\u3001\u53d1\u5e03\u786e\u8ba4</li> <li>\u7075\u6d3b\u7684\u8def\u7531</li> <li>\u6269\u5c55\u6027\uff1a\u96c6\u7fa4</li> <li>\u9ad8\u53ef\u7528\u6027\uff1a \u96c6\u7fa4\u955c\u50cf</li> <li>\u591a\u79cd\u534f\u8bae\uff1aAMQP\u3001STOMP\u3001MQTT</li> <li>\u591a\u8bed\u8a00\u5ba2\u6237\u7aef\uff1aPython\u3001Java\u3001Ruby\u3001PHP\u3001C#\u3001JavaScript\u3001Go\u3001Elixir\u3001Objective-C\u3001Swift\u3001Spring AMQP</li> <li>\u7ba1\u7406\u754c\u9762</li> <li>\u63d2\u4ef6\u673a\u5236</li> </ol>"},{"location":"software/middleware/rabbitmq/#3_1","title":"3. \u6982\u5ff5","text":""},{"location":"software/middleware/rabbitmq/#1-producer","title":"1. Producer","text":"<p>\u751f\u4ea7\u8005\uff0c\u6295\u9012\u6d88\u606f\u7684\u4e00\u65b9\uff0c\u6d88\u606f\u7684\u7ec4\u6210\uff1a</p> <ol> <li>\u6d88\u606f\u4f53\uff1a\u5e26\u6709\u4e1a\u52a1\u903b\u8f91\u7ed3\u6784\u7684\u6570\u636e\uff08\u5982JSON\uff09</li> <li>\u6807\u7b7e\uff1a\u4ea4\u6362\u5668\u540d\u79f0\u6216\u8def\u7531\u952e</li> </ol>"},{"location":"software/middleware/rabbitmq/#2-consumer","title":"2. Consumer","text":"<p>\u6d88\u8d39\u8005\uff0c\u63a5\u6536\u6d88\u606f\u7684\u4e00\u65b9\uff0c\u6d88\u8d39\u4e00\u6761\u6d88\u606f\u65f6\u53ea\u6d88\u8d39\u6d88\u606f\u4f53\uff0c\u6d88\u606f\u7684\u6807\u7b7e\u5728\u8def\u7531\u7684\u8fc7\u7a0b\u4e2d\u4f1a\u4e22\u5f03</p>"},{"location":"software/middleware/rabbitmq/#3-broker","title":"3. Broker","text":"<p>\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u670d\u52a1\u8282\u70b9\uff0c\u53ef\u4ee5\u7b80\u5355\u7684\u770b\u4f5c\u4e00\u4e2aRabbitmq\u670d\u52a1\u8282\u70b9\u6216\u8005Rabbitmq\u670d\u52a1\u5b9e\u4f8b</p>"},{"location":"software/middleware/rabbitmq/#4-queue","title":"4. Queue","text":"<p>\u961f\u5217\uff0cRabbitmq\u7684\u5185\u90e8\u5bf9\u8c61\uff0c\u7528\u6765\u5b58\u50a8\u6d88\u606f\u3002</p> <p>\u591a\u4e2a\u6d88\u8d39\u8005\u53ef\u4ee5\u8ba2\u9605\u540c\u4e00\u4e2a\u961f\u5217\uff0c\u961f\u5217\u4e2d\u7684\u6d88\u606f\u4f1a\u8f6e\u8be2\u7ed9\u591a\u4e2a\u6d88\u8d39\u8005\u8fdb\u884c\u5904\u7406\u3002</p>"},{"location":"software/middleware/rabbitmq/#5-exchange","title":"5. Exchange","text":"<p>\u4ea4\u6362\u5668\uff0c\u751f\u4ea7\u8005\u5c06\u6d88\u606f\u53d1\u9001\u5230\u4ea4\u6362\u5668\uff0c\u7531\u4ea4\u6362\u5668\u5c06\u6d88\u606f\u8def\u7531\u5230\u4e00\u4e2a\u6216\u591a\u4e2a\u961f\u5217\u4e2d\u3002</p> <p>\u4ea4\u6362\u5668\u7c7b\u578b\uff1a</p> <ol> <li> <p>fanout\uff1a \u628a\u6240\u6709\u53d1\u9001\u5230\u8be5\u4ea4\u6362\u5668\u7684\u6d88\u606f\u8def\u7531\u5230\u6240\u6709\u4e0e\u8be5\u4ea4\u6362\u5668\u7ed1\u5b9a\u7684\u961f\u5217\u4e2d</p> </li> <li> <p>direct\uff1a \u628a\u6d88\u606f\u8def\u7531\u5230BindingKey\u548cRoutingKey\u5b8c\u5168\u5339\u914d\u7684\u961f\u5217\u4e2d</p> </li> <li> <p>topic\uff1a\u628a\u6d88\u606f\u8def\u7531\u5230BindingKey\u548cRoutingKey\u5339\u914d\uff08\u53ef\u4ee5\u6a21\u7cca\u5339\u914d\uff09\u7684\u961f\u5217\u4e2d</p> </li> </ol> <pre><code>\u5339\u914d\u89c4\u5219\uff1a\n1. routing key\u4e3a\u4e00\u4e2a\u53e5\u70b9\u53f7\u201c.\u201d\u5206\u9694\u7684\u5b57\u7b26\u4e32\uff08\u6211\u4eec\u5c06\u88ab\u53e5\u70b9\u53f7\u201c.\u201d\u5206\u9694\u5f00\u7684\n\u6bcf\u4e00\u6bb5\u72ec\u7acb\u7684\u5b57\u7b26\u4e32\u79f0\u4e3a\u4e00\u4e2a\u5355\u8bcd\uff09\uff0c\u5982\u201cstock.usd.nyse\u201d\u3001\u201cnyse.vmw\u201d\u3001\n\u201cquick.orange.rabbit\u201d\n2.binding key\u4e0erouting key\u4e00\u6837\u4e5f\u662f\u53e5\u70b9\u53f7\u201c.\u201d\u5206\u9694\u7684\u5b57\u7b26\u4e32\n3.binding key\u4e2d\u53ef\u4ee5\u5b58\u5728\u4e24\u79cd\u7279\u6b8a\u5b57\u7b26\u201c*\u201d\u4e0e\u201c#\u201d\uff0c\u7528\u4e8e\u505a\u6a21\u7cca\u5339\u914d\uff0c\u5176\u4e2d\u201c*\u201d\n\u7528\u4e8e\u5339\u914d\u4e00\u4e2a\u5355\u8bcd\uff0c\u201c#\u201d\u7528\u4e8e\u5339\u914d\u591a\u4e2a\u5355\u8bcd\uff08\u53ef\u4ee5\u662f\u96f6\u4e2a\uff09\n</code></pre> <ol> <li>headers: \u6839\u636e\u6d88\u606f\u5185\u5bb9\u4e2dheader\uff08\u952e\u503c\u5bf9\u5f62\u5f0f\uff09\u5c5e\u6027\u8fdb\u884c\u5339\u914d    \u6027\u80fd\u8f83\u5dee\uff0c\u800c\u4e14\u4e0d\u5b9e\u7528</li> </ol>"},{"location":"software/middleware/rabbitmq/#6routingkey","title":"6.RoutingKey","text":"<p>\u8def\u7531\u952e\uff0c\u751f\u4ea7\u8005\u5c06\u6d88\u606f\u53d1\u7ed9\u4ea4\u6362\u5668\u7684\u65f6\u5019\uff0c\u4e00\u822c\u4f1a\u6307\u5b9a\u4e00\u4e2aRoutingKey\uff0c\u7528\u6765\u6307\u5b9a\u8fd9\u4e2a\u6d88\u606f\u7684\u8def\u7531\u89c4\u5219\uff0c\uff1b\u8def\u7531\u952e\u9700\u8981\u4e0e \u4ea4\u6362\u5668\u7c7b\u578b\u548c\u7ed1\u5b9a\u952e\u8054\u5408\u4f7f\u7528\u624d\u80fd\u751f\u6548</p>"},{"location":"software/middleware/rabbitmq/#7-binding","title":"7. Binding","text":"<p>\u7ed1\u5b9a\uff0c\u7ed1\u5b9a\u53ef\u4ee5\u5c06\u4ea4\u6362\u5668\u4e0e\u961f\u5217\u5173\u8054\u8d77\u6765</p>"},{"location":"software/middleware/rabbitmq/#8-connection","title":"8. Connection","text":"<p>\u8fde\u63a5\uff0c\u6d88\u8d39\u8005/\u751f\u4ea7\u8005\u4e0eRabbitmq Broker\u5efa\u7acb\u7684TCP\u8fde\u63a5</p>"},{"location":"software/middleware/rabbitmq/#9-channel","title":"9. Channel","text":"<p>\u4fe1\u9053\uff0c\u5efa\u7acb\u5728Connection\u4e0a\u7684\u865a\u62df\u8fde\u63a5</p>"},{"location":"software/middleware/rabbitmq/#4_1","title":"4. \u5de5\u4f5c\u6d41\u7a0b","text":""},{"location":"software/middleware/rabbitmq/#1_3","title":"1. \u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f","text":"<ol> <li>\u751f\u4ea7\u8005\u8fde\u63a5\u5230Rabbitmq Broker\uff0c\u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u5f00\u542f\u4e00\u4e2a\u4fe1\u9053(Channel)</li> <li>\u751f\u4ea7\u8005\u58f0\u660e\u4e00\u4e2a\u4ea4\u6362\u5668\uff0c\u5e76\u8bbe\u7f6e\u76f8\u5173\u5c5e\u6027\uff0c\u6bd4\u5982\u4ea4\u6362\u673a\u7c7b\u578b\u3001\u662f\u5426\u6301\u4e45\u5316\u7b49</li> <li>\u751f\u4ea7\u8005\u58f0\u660e\u4e00\u4e2a\u961f\u5217\u5e76\u8bbe\u7f6e\u76f8\u5173\u5c5e\u6027\uff0c\u6bd4\u5982\u662f\u5426\u62cd\u4ed6\uff0c\u662f\u5426\u6301\u4e45\u5316\uff0c\u662f\u5426\u81ea\u52a8\u5220\u9664\u7b49</li> <li>\u751f\u4ea7\u8005\u901a\u8fc7\u8def\u7531\u952e\u5c06\u4ea4\u6362\u5668\u548c\u961f\u5217\u7ed1\u5b9a\u8d77\u6765</li> <li>\u751f\u4ea7\u8005\u53d1\u9001\u6d88\u606f\u5230Rabbitmq Broker\uff0c\u5176\u4e2d\u5305\u62ec\u8def\u7531\u952e\u3001\u4ea4\u6362\u5668\u7b49</li> <li>\u76f8\u5e94\u7684\u4ea4\u6362\u5668\u6839\u636e\u63a5\u6536\u5230\u7684\u8def\u7531\u952e\u67e5\u627e\u76f8\u5339\u914d\u7684\u961f\u5217</li> <li>\u5982\u679c\u627e\u5230\uff0c\u5219\u5c06\u4ece\u751f\u4ea7\u8005\u53d1\u9001\u8fc7\u6765\u7684\u6d88\u606f\u5b58\u5165\u5230\u76f8\u5e94\u7684\u961f\u5217\u4e2d\uff0c\u672a\u627e\u5230\u5219\u6839\u636e\u751f\u4ea7\u8005\u914d\u7f6e\u7684\u5c5e\u6027    \u9009\u62e9\u4e22\u5f03\u8fd8\u662f\u9000\u56de\u7ed9\u751f\u4ea7\u8005</li> <li>\u5173\u95ed\u4fe1\u9053</li> <li>\u5173\u95ed\u8fde\u63a5</li> </ol>"},{"location":"software/middleware/rabbitmq/#2_2","title":"2. \u6d88\u8d39\u8005\u63a5\u6536\u6d88\u606f","text":"<ol> <li>\u6d88\u8d39\u8005\u8fde\u63a5\u5230Rabbitmq Broker\uff0c \u5efa\u7acb\u4e00\u4e2a\u8fde\u63a5\uff0c\u5f00\u542f\u4e00\u4e2a\u4fe1\u9053</li> <li>\u6d88\u8d39\u8005\u5411Rabbitmq Broker\u8bf7\u6c42\u6d88\u8d39\u76f8\u5e94\u961f\u5217\u4e2d\u7684\u6d88\u606f\uff0c\u53ef\u80fd\u4f1a\u8bbe\u7f6e\u76f8\u5e94\u7684\u56de\u8c03\u51fd\u6570\uff0c\u4ee5    \u53ca\u4e00\u4e9b\u51c6\u5907\u5de5\u4f5c</li> <li>\u7b49\u5f85Rabbitmq Broker\u56de\u5e94\u5e76\u6295\u9012\u76f8\u5e94\u961f\u5217\u4e2d\u7684\u6d88\u606f</li> <li>\u6d88\u8d39\u8005\u786e\u8ba4\u63a5\u6536\u5230\u7684\u6d88\u606f\u3001</li> <li>Rabbitmq\u4ece\u961f\u5217\u4e2d\u5220\u9664\u5df2\u7ecf\u88ab\u786e\u8ba4\u7684\u6d88\u606f</li> <li>\u5173\u95ed\u4fe1\u9053</li> <li>\u5173\u95ed\u8fde\u63a5</li> </ol>"},{"location":"software/middleware/rabbitmq/#3-amqp","title":"3. AMQP\u534f\u8bae","text":"<p>AMQP\u534f\u8bae\u5305\u62ec\u4e09\u5c42</p> <ol> <li>Module Layer\uff1a\u4f4d\u4e8e\u534f\u8bae\u6700\u9ad8\u5c42\uff0c\u4e3b\u8981\u5b9a\u4e49\u4e86\u4e00\u4e9b\u63d0\u4f9b\u7ed9\u5ba2\u6237\u7aef\u8c03\u7528\u7684\u547d\u4ee4\uff0c\u5ba2\u6237\u7aef\u53ef    \u4ee5\u5229\u7528\u8fd9\u4e9b\u547d\u4ee4\u5b9e\u73b0\u81ea\u5df1\u7684\u4e1a\u52a1\u903b\u8f91\u3002</li> <li>Session Layer\uff1a\u4f4d\u4e8e\u4e2d\u95f4\u5c42\uff0c\u4e3b\u8981\u8d1f\u8d23\u5c06\u5ba2\u6237\u7aef\u7684\u547d\u4ee4\u53d1\u9001\u7ed9\u670d\u52a1\u5668\uff0c\u518d\u5c06\u670d\u52a1\u5668\u7aef\u7684    \u5e94\u7b54\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u4e3b\u8981\u4e3a\u5ba2\u6237\u7aef\u4e0e\u670d\u52a1\u5668\u76f4\u63a5\u7684\u901a\u4fe1\u63d0\u4f9b\u53ef\u9ad8\u6027\u540c\u6b65\u673a\u5236\u548c\u9519\u8bef\u5904\u7406</li> <li>Transport Layer\uff1a\u4f4d\u4e8e\u6700\u5e95\u5c42\uff0c\u4e3b\u8981\u4f20\u8f93\u4e8c\u8fdb\u5236\u6570\u636e\u6d41\uff0c\u63d0\u4f9b\u5e27\u7684\u5904\u7406\u3001\u4fe1\u9053\u590d\u7528\u3001\u9519    \u8bef\u68c0\u6d4b\u548c\u6570\u636e\u8868\u793a</li> </ol>"},{"location":"software/middleware/rabbitmq/#_2","title":"\u4e8c\u3001\u4f7f\u7528","text":"<p>\u5b89\u88c5pika</p> <pre><code>pip install pika\n</code></pre> <p>\u4ee5\u5bb9\u5668\u65b9\u5f0f\u542f\u52a8\u4e00\u4e2arabbitmq</p> <pre><code>$ docker run -it --name rabbitmq -p 5672:5672 -p 15672:15672 -p 25672:25672 rabbitmq:3.6.12\n</code></pre>"},{"location":"software/middleware/rabbitmq/#1-hello-word","title":"1. Hello Word","text":"<ol> <li>\u751f\u4ea7\u8005</li> </ol> <pre><code>import pika\n\n# \u5efa\u7acbTCP\u8fde\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\n# \u5efa\u7acb\u4e00\u4e2a\u4fe1\u9053\nchannel = connection.channel()\n# \u521b\u5efa\u4e00\u4e2a\u961f\u5217\nchannel.queue_declare(queue='hello')\n# \u521b\u5efa\u4e00\u4e2a\u4ea4\u6362\u673a\nchannel.basic_publish(exchange='',routing_key='hello',body='Hello World!')\nprint(\" [\u00d7] Sent 'Hello World!'\")\n# \u5173\u95ed\u8fde\u63a5\nconnection.close()\n</code></pre> <p>\u67e5\u770brabbitmq\u4e2d\u7684\u961f\u5217</p> <pre><code>$ docker exec  -it  rabbitmq  bash\nroot@f6d1cc085307:/# rabbitmqctl list_queues\nListing queues\nhello   1\n</code></pre> <ol> <li>\u6d88\u8d39\u8005</li> </ol> <pre><code>import pika\n\nconnection = pika.BlockingConnection(pika.ConnectionParameters(host='localhost')\nchannel = connection.channel()\n# \u4e00\u6b21\u518d\u5efa\u7acb\u961f\u5217\u3002\u5b98\u65b9\u5efa\u8bae\u5728\u6d88\u8d39\u548c\u751f\u4ea7\u8005\u90fd\u58f0\u660e\u5efa\u7acb\u4e00\u4e2a\u961f\u5217\nchannel.queue_declare(queue='hello')\n# \u5b9a\u4e49\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u6765\u5904\u7406\u6d88\u606f\uff0c\u51fd\u6570\u683c\u5f0f\u56fa\u5b9a\ndef callback(ch, method, properties, body):\n    print(\"[\u00d7] Receive %r\" % body)\n# \u5b9a\u4e49\u4ece\u54ea\u4e2a\u961f\u5217\u63a5\u6536\u6d88\u606f\u4ee5\u53ca\u5904\u7406\u6d88\u606f\u7684\u51fd\u6570\nchannel.basic_consume(callback,\n                      queue='hello',\n                      no_ack=True)\n\nprint('[*] Waiting for messages. To exit press CTRL+C')\n# \u5f00\u59cb\u5904\u7406\u6d88\u606f\nchannel.start_consuming()\n</code></pre> <p>\u6267\u884c\u7ed3\u679c</p> <pre><code>$python3 send.py\n[\u00d7] Sent 'Hello World!'\n$ python3 receive.py \n[*] Waiting for messages. To exit press CTRL+C\n[\u00d7] Receive b'Hello World!'\n</code></pre>"},{"location":"software/middleware/rabbitmq/#queue","title":"Queue \u961f\u5217","text":"<p>\u961f\u5217\u7684\u4f5c\u7528\uff1a</p> <p>\u60f3\u8c61\u4e00\u4e2a\u573a\u666f\uff0c\u5982\u679c\u751f\u4ea7\u8005\u4ea7\u751f\u8bb8\u591a\u9700\u8981\u82b1\u5f88\u591a\u65f6\u95f4\u5904\u7406\u7684\u6570\u636e\u548c\u4efb\u52a1\uff0c\u91c7\u7528BIO\u7684\u6a21\u5f0f \u4ea4\u7ed9\u6d88\u8d39\u8005\u5904\u7406\u7684\u8bdd\uff0c\u751f\u4ea7\u8005\u9700\u8981\u7b49\u5f88\u957f\u65f6\u95f4\u76f4\u5230\u6d88\u8d39\u8005\u5904\u7406\u5b8c\u6d88\u606f\u518d\u7ee7\u7eed\u53d1\u9001\u4e0b\u4e00\u4e2a\u6d88\u606f\u3002 \u6709\u4e86\u961f\u5217\u4ee5\u540e\u751f\u4ea7\u8005\u53ea\u9700\u8981\u628a\u6570\u636e\u6254\u5230\u961f\u5217\u4e2d\u5c31\u53ef\u4ee5\u4e86\uff0c\u6d88\u8d39\u8005\u5b9a\u671f\u4ece\u961f\u5217\u4e2d\u53d6\u6570\u636e\u8fdb\u884c\u5904 \u7406\uff08\u6d88\u8d39\uff09\u3002\u5904\u7406\u5b8c\u4e00\u4e2a\u518d\u4ece\u961f\u5217\u4e2d\u53d6\u4e0b\u4e00\u4e2a\u8fdb\u884c\u5904\u7406\u3002\u5982\u679c\u6570\u636e\u5904\u7406\u7684\u65f6\u95f4\u592a\u957f\uff0c\u6211\u4eec\u53ef \u4ee5\u591a\u5efa\u51e0\u4e2a\u6d88\u8d39\u8005\u4e00\u8d77\u6d88\u8d39\u6570\u636e\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0crabbitmq\u4ee5\u8f6e\u8be2\u7684\u65b9\u5f0f\u628a\u6d88\u606f\u5206\u53d1\u7ed9\u6d88\u8d39\u8005\u3002</p>"},{"location":"software/middleware/rabbitmq/#1_4","title":"1. \u6d88\u606f\u786e\u8ba4","text":"<p>\u5728\u4e4b\u524d\u7684\u4ee3\u7801\u4e2d\uff0c\u4e00\u65e6rabbitmq\u628a\u6d88\u606f\u53d1\u7ed9\u6d88\u8d39\u8005\u5c31\u4f1a\u628a\u6d88\u8d39\u6807\u8bb0\u4e3a\u5220\u9664\uff0c\u5982\u679c\u6b64\u65f6\u6d88\u8d39\u8005 \u6302\u4e86\uff0c\u6d88\u606f\u5c31\u4f1a\u4e22\u5931\uff0c\u6211\u4eec\u5e0c\u671b\u5982\u679c\u56e0\u4e3a\u4e00\u4e2a\u6d88\u8d39\u8005\u6302\u4e86\u800c\u628a\u6ca1\u6709\u6ca1\u6709\u5904\u7406\u7684\u6d88\u606f\u4ea4\u7ed9\u53e6\u4e00 \u4e2a\u6d88\u8d39\u8005\u5904\u7406\u3002\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931\uff0crabbitmq\u4f7f\u7528\u6d88\u606f\u786e\u8ba4\u673a\u5236\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931\u3002\u6d88\u8d39\u8005 \u5982\u679c\u5904\u7406\u5b8c\u6d88\u606f\u4f1a\u7ed9rabbitmq\u53d1\u9001\u4e00\u4e2aack\u3002</p> <p>\u5982\u679c\u6d88\u8d39\u8005\u6302\u4e86\uff08TCP\u8fde\u63a5\u7aef\u53e3\uff0c\u4fe1\u9053\u5173\u95ed\uff09\uff0c\u6ca1\u6709\u53d1\u9001ack\uff0crabbitmq\u5c31\u8ba4\u4e3a\u6d88\u606f\u6ca1\u6709\u5904\u7406 \u7136\u540e\u628a\u6d88\u606f\u4ea4\u7ed9\u5176\u4ed6\u6d88\u8d39\u8005\u53bb\u5904\u7406\u3002</p> <p>\u66f4\u6539\u540e\u7684\u4ee3\u7801</p> <p>\u751f\u4ea7\u8005</p> <pre><code>import pika\nimport sys\n\n# \u5efa\u7acbTCP\u8fde\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\n# \u5efa\u7acb\u4e00\u4e2a\u4fe1\u9053\nchannel = connection.channel()\n# \u521b\u5efa\u4e00\u4e2a\u961f\u5217\nchannel.queue_declare(queue='hello')\n# \u5b9a\u4e49\u6d88\u606f\u5185\u5bb9\nmessage = ' '.join(sys.argv[1:]) or \"Hello World!\"\n\n# \u521b\u5efa\u4e00\u4e2a\u4ea4\u6362\u673a\nchannel.basic_publish(exchange='',routing_key='hello',body=message)\nprint(\" [\u00d7] Sent %r\" % message)\n# \u5173\u95ed\u8fde\u63a5\nconnection.close()\n</code></pre> <p>\u6d88\u8d39\u8005</p> <pre><code>import pika\nimport time\nconnection = pika.BlockingConnection(pika.ConnectionParameters(host='localhost'))\nchannel = connection.channel()\n# \u4e00\u6b21\u518d\u5efa\u7acb\u961f\u5217\u3002\u5b98\u65b9\u5efa\u8bae\u5728\u6d88\u8d39\u548c\u751f\u4ea7\u8005\u90fd\u58f0\u660e\u5efa\u7acb\u4e00\u4e2a\u961f\u5217\nchannel.queue_declare(queue='hello')\n# \u5b9a\u4e49\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u6765\u5904\u7406\u6d88\u606f\uff0c\u51fd\u6570\u683c\u5f0f\u56fa\u5b9a\ndef callback(ch, method, properties, body):\n    print(\"[\u00d7] Receive %r\" % body)\n    # \u8ba1\u7b97\u6d88\u606f\u957f\u5ea6\u6765\u6a21\u62df\u6d88\u8d39\u8005\u5904\u7406\u6d88\u606f\u9700\u8981\u7684\u65f6\u95f4\n    time.sleep(len(body))\n    print(\"[\u00d7] Done\")\n    # \u786e\u8ba4\u6d88\u606f\u5df2\u7ecf\u88ab\u5904\u7406\n    ch.basic_ack(delivery_tag = method.delivery_tag)\n\n# \u5b9a\u4e49\u4ece\u54ea\u4e2a\u961f\u5217\u63a5\u6536\u6d88\u606f\u4ee5\u53ca\u5904\u7406\u6d88\u606f\u7684\u51fd\u6570\nchannel.basic_consume(callback,\n                      queue='hello')\nprint('[*] Waiting for messages. To exit press CTRL+C')\n# \u5f00\u59cb\u5904\u7406\u6d88\u606f\nchannel.start_consuming()\n</code></pre> <p>\u6d4b\u8bd5</p> <p>\u5f00\u7b2c1\u4e2ashell\u53d1\u9001\u6d88\u606f</p> <pre><code># \u53d1\u9001\u4e00\u4e2a\u6d88\u606f\n$ python3 send.py\n[\u00d7] Sent 'Hello World!'\n</code></pre> <p>\u5f00\u7b2c2\u4e2ashell\u5904\u7406\u6d88\u606f\uff0c\u6d88\u606f\u6ca1\u5904\u7406\u5b8c\u76f4\u63a5\u7ed3\u675f\u8fdb\u884c</p> <pre><code># \u6d88\u606f\u8fd8\u6ca1\u6709\u5904\u7406\u5b8c\u7684\u65f6\u5019\u628a\u8fdb\u7a0b\u7ed3\u675f\u6389\n$ python3 receive.py \n[*] Waiting for messages. To exit press CTRL+C\n[\u00d7] Receive b'Hello World!'\n^CTraceback (most recent call last):\n...\n</code></pre> <p>\u5f00\u7b2c3\u4e2ashell\u7ee7\u7eed\u5904\u7406\u6d88\u606f</p> <pre><code># \u6d88\u606f\u88ab\u8f6c\u5230\u53e6\u4e2a\u4e00\u6d88\u8d39\u8005\u8fdb\u884c\u5904\u7406\n$ python3 receive.py \n[*] Waiting for messages. To exit press CTRL+C\n[\u00d7] Receive b'Hello World!'\n[\u00d7] Done\n</code></pre> <p>\u67e5\u770b\u672a\u88ab\u786e\u8ba4\u7684\u6d88\u606f</p> <pre><code>$ rabbitmqctl list_queues name messages_ready messages_unacknowledged\nListing queues\nhello   0   5\n</code></pre>"},{"location":"software/middleware/rabbitmq/#2_3","title":"2. \u6d88\u606f\u6301\u4e45\u5316","text":"<p>\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0crabbitmq\u9000\u51fa\u4e4b\u540e\u961f\u5217\u548c\u6d88\u606f\u5c31\u4f1a\u4e22\u5931\u3002\u4e3a\u4e86\u4fdd\u8bc1\u6570\u636e\u4e0d\u4e22\u5931\u9700\u8981\u505a\u6570\u636e\u6301\u4e45\u5316\u3002</p> <p>\u961f\u5217\u6301\u4e45\u5316</p> <pre><code>channel.queue_declare(queue='hello', durable=True)\n</code></pre> <p>\u6d88\u606f\u6301\u4e45\u5316</p> <pre><code>channel.basic_publish(exchange='',\n                      routing_key=\"task_queue\",\n                      body=message,\n                      properties=pika.BasicProperties(\n                      delivery_mode = 2, # make message persistent\n                      ))\n</code></pre>"},{"location":"software/middleware/rabbitmq/#3_2","title":"3. \u516c\u5e73\u5206\u53d1","text":"<p>\u666e\u901a\u7684\u8f6e\u8be2\u7b56\u7565\u53ef\u80fd\u4f1a\u5bfc\u81f4\u8d1f\u8f7d\u4e0d\u5747\u8861\u3002Fair dispatch\u6709\u70b9\u52a0\u6743\u8f6e\u8be2\u7684\u610f\u601d\uff0c\u628a\u6d88\u606f\u5206\u53d1 \u7ed9\u4e0d\u592a\u5fd9\u7684\u6d88\u8d39\u8005</p> <p>\u4f7f\u7528basic.qos\u6a21\u5f0f\u4ee4prefetch_count=1\u3002\u8ba9\u6d88\u8d39\u8005\u544a\u8bc9Rabbitmq\uff0c\u5728\u5f53\u524d\u7684\u6d88\u606f\u5904\u7406\u5b8c\u6bd5 \u5e76\u786e\u8ba4\u4e4b\u524d\u4e0d\u8981\u518d\u53d1\u6d88\u606f</p> <p>\u6700\u7ec8\u4ee3\u7801</p> <p>\u751f\u4ea7\u8005</p> <pre><code>#!/usr/bin/env python\nimport pika\nimport sys\n\nconnection = pika.BlockingConnection(pika.ConnectionParameters(host='localhost'))\nchannel = connection.channel()\n\nchannel.queue_declare(queue='task_queue', durable=True)\n\nmessage = ' '.join(sys.argv[1:]) or \"Hello World!\"\nchannel.basic_publish(exchange='',\n                      routing_key='task_queue',\n                      body=message,\n                      properties=pika.BasicProperties(\n                         delivery_mode = 2, # make message persistent\n                      ))\nprint(\" [x] Sent %r\" % message)\nconnection.close()\n</code></pre> <p>\u6d88\u8d39\u8005</p> <pre><code>#!/usr/bin/env python\nimport pika\nimport time\n\nconnection = pika.BlockingConnection(pika.ConnectionParameters(host='localhost'))\nchannel = connection.channel()\n\nchannel.queue_declare(queue='task_queue', durable=True)\nprint(' [*] Waiting for messages. To exit press CTRL+C')\n\ndef callback(ch, method, properties, body):\n    print(\" [x] Received %r\" % body)\n    time.sleep(len(body))\n    print(\" [x] Done\")\n    ch.basic_ack(delivery_tag = method.delivery_tag)\n\nchannel.basic_qos(prefetch_count=1)\nchannel.basic_consume(callback,\n                      queue='task_queue')\n\nchannel.start_consuming()\n</code></pre>"},{"location":"software/middleware/rabbitmq/#3_3","title":"3. \u5206\u53d1\u4e0e\u8ba2\u9605","text":""},{"location":"software/middleware/rabbitmq/#1_5","title":"1. \u4ea4\u6362\u5668","text":"<ol> <li>\u4ea4\u6362\u5668\u4ece\u751f\u4ea7\u8005\u90a3\u91cc\u5c31\u6536\u6570\u636e\uff0c\u7136\u540e\u63a8\u9001\u7684\u961f\u5217</li> <li>\u4ea4\u6362\u5668\u89c9\u5f97\u6d88\u606f\u662f\u5206\u53d1\u7ed9\u6307\u5b9a\u961f\u5217\uff0c\u8fd8\u662f\u591a\u4e2a\u961f\u5217\uff0c\u8fd8\u662f\u4e22\u5f03</li> <li>\u4ea4\u6362\u5668\u7684\u7c7b\u578b\uff1adirect\u3001topic\u3001fanout\u3001header </li> </ol>"},{"location":"software/middleware/rabbitmq/#2_4","title":"2. \u4e34\u65f6\u961f\u5217","text":"<p>\u7528\u5b8c\u4e4b\u540e\u5c31\u5220\u9664\uff0c\u5b98\u65b9\u6587\u6863\u4ee5\u8bb0\u5f55\u65e5\u5fd7\u7684\u5b9e\u4f8b\u8bf4\u660e\u3002</p> <ol> <li>\u4f7f\u7528fanout\u4ea4\u6362\u5668\uff0c\u6d88\u8d39\u8005\u8981\u63a5\u6536\u6240\u6709\u7684\u65e5\u5fd7\u6d88\u606f\uff0c</li> <li>\u6d88\u8d39\u8005\u60f3\u8981\u63a5\u6536\u7684\u6d88\u606f\u662f\u6700\u65b0\u7684\u6d88\u606f\u6d41\u800c\u4e0d\u662f\u65e7\u7684\u3002</li> </ol> <p>\u4e3a\u4e86\u8fbe\u5230\u8fd9\u4e2a\u76ee\u7684\uff0c\u9700\u8981\u5e72\u4e24\u4ef6\u4e8b\uff1a</p> <ol> <li>\u65e0\u8bba\u4ec0\u4e48\u65f6\u5019\u8fde\u63a5rabbitmq\u65f6\uff0c\u9700\u8981\u4e00\u4e2a\u65b0\u7684\u3001\u7a7a\u7684\u961f\u5217--&gt;\u521b\u5efa\u4e00\u4e2a\u968f\u673a\u961f\u5217</li> <li>\u4e00\u65e6\u6d88\u8d39\u8005\u65ad\u5f00\u8fde\u63a5\uff0c\u5c31\u5220\u9664\u8fd9\u4e2a\u961f\u5217</li> </ol> <p>\u6700\u7ec8\u4ee3\u7801</p> <pre><code>import pika\nimport sys\n\n# \u5efa\u7acbTCP\u8fde\u63a5\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\n# \u5efa\u7acb\u4e00\u4e2a\u4fe1\u9053\nchannel = connection.channel()\n# \u5efa\u7acb\u4e00\u4e2a\u4ea4\u6362\u5668\uff0c\u4ea4\u6362\u5668\u7684\u7c7b\u578b\u4e3afanout\nchannel.exchange_declare(exchange='logs',\n                        exchange_type='fanout')\n\n# \u5b9a\u4e49\u6d88\u606f\u5185\u5bb9\nmessage = ' '.join(sys.argv[1:]) or \"Hello World!\"\n\n# \u521b\u5efa\u4e00\u4e2a\u4ea4\u6362\u673a\nchannel.basic_publish(exchange='logs',\n                     routing_key='',   # \u5728fanout\u6a21\u5f0f\u4e0b\uff0c\u8def\u7531\u952e\u88ab\u5ffd\u7565\n                     body=message)\nprint(\" [\u00d7] Sent %r\" % message)\n# \u5173\u95ed\u8fde\u63a5\nconnection.close()\n</code></pre> <pre><code>import pika\nimport time\nconnection = pika.BlockingConnection(pika.ConnectionParameters(host='localhost'))\nchannel = connection.channel()\nchannel.exchange_declare(exchange='logs',\n                        exchange_type='fanout')\n\n# \u6d88\u8d39\u5b8c\u4e4b\u540e\u5220\u9664\u961f\u5217\nresult = channel.queue_declare(exclusive=True)\n\n# \u751f\u6210\u4e00\u4e2a\u968f\u673a\u961f\u5217\nqueue_name = result.method.queue\n\nchannel.queue_bind(exchange='logs',\n                   queue=queue_name)\n\nprint('[*] Waiting for messages. To exit press CTRL+C')\n# \u5b9a\u4e49\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u6765\u5904\u7406\u6d88\u606f\uff0c\u51fd\u6570\u683c\u5f0f\u56fa\u5b9a\ndef callback(ch, method, properties, body):\n    print(\"[\u00d7] Receive %r\" % body)\n\n# \u5b9a\u4e49\u4ece\u54ea\u4e2a\u961f\u5217\u63a5\u6536\u6d88\u606f\u4ee5\u53ca\u5904\u7406\u6d88\u606f\u7684\u51fd\u6570\nchannel.basic_consume(callback,\n                      queue=queue_name,\n                      no_ack=True)\n\n\n# \u5f00\u59cb\u5904\u7406\u6d88\u606f\nchannel.start_consuming()\n</code></pre> <pre><code># rabbitmqctl list_bindings\nListing bindings\n    exchange    amq.gen-gFj_8p_zIA4a2rpIpTSYcA  queue   amq.gen-gFj_8p_zIA4a2rpIpTSYcA  []\nlogs    exchange    amq.gen-gFj_8p_zIA4a2rpIpTSYcA  queue   amq.gen-gFj_8p_zIA4a2rpIpTSYcA  []\n</code></pre>"},{"location":"software/middleware/rabbitmq/#4_2","title":"4. \u8def\u7531","text":""},{"location":"software/middleware/rabbitmq/#1-binging","title":"1. Binging","text":"<p>\u7ed1\u5b9a\u628a\u4ea4\u6362\u5668\u548c\u961f\u5217\u5173\u8054\u8d77\u6765\uff0c\u961f\u5217\u53ef\u4ee5\u4ece\u4ea4\u6362\u5668\u90a3\u91cc\u53ea\u63a5\u6536\u81ea\u5df1\u201c\u611f\u5174\u8da3\u201d\u7684\u6d88\u606f</p>"},{"location":"software/middleware/rabbitmq/#2-direct","title":"2. Direct \u4ea4\u6362\u5668","text":"<p>fanout \u4ea4\u6362\u5668\u4f1a\u201c\u65e0\u8111\u201d\u7684\u628a\u6d88\u606f\u5e7f\u64ad\u7ed9\u6bcf\u4e2a\u6d88\u8d39\u8005\uff0c\u4f46\u662f\u6709\u65f6\u5019\u6211\u4eec\u5e76\u4e0d\u9700\u8981\u6240\u6709\u7684\u6d88\u606f \u6bd4\u5982\u4e0a\u9762\u7684log\u4f8b\u5b50\u4e2d\uff0c\u5047\u5982\u6d88\u8d39\u8005\u53ea\u60f3\u63a5\u6536\u9519\u8bef\u65e5\u5fd7\u65f6\u5c31\u9700\u8981\u7528direct \u4ea4\u6362\u5668\u6765\u5b9e\u73b0\u4e86</p> <p>\u6700\u7ec8\u4ee3\u7801</p> <p>\u751f\u4ea7\u8005</p> <pre><code>mport pika\nimport sys\n\nconnection = pika.BlockingConnection(pika.ConnectionParameters('localhost'))\nchannel = connection.channel()\n\nchannel.exchange_declare(exchange='logs',\n                        exchange_type='direct')\n\n# \u5b9a\u4e49\u65e5\u5fd7\u7ea7\u522b\nseverity = sys.argv[1] if len(sys.argv) &gt; 1 else 'info'\n# \u6d88\u606f\u5185\u5bb9\nmessage = ' '.join(sys.argv[2:]) or \"Hello World!\"\n\n# \u521b\u5efa\u4e00\u4e2a\u4ea4\u6362\u673a\nchannel.basic_publish(exchange='logs',\n                     routing_key=severity,   # \u5728fanout\u6a21\u5f0f\u4e0b\uff0c\u8def\u7531\u952e\u88ab\u5ffd\u7565\n                     body=message)\n\nprint(\" [\u00d7] Sent %r:%r\" % (severity, message))\nconnection.close()\n</code></pre> <p>\u6d88\u8d39\u8005</p> <pre><code>import pika\nimport sys\nconnection = pika.BlockingConnection(pika.ConnectionParameters(host='localhost'))\nchannel = connection.channel()\nchannel.exchange_declare(exchange='logs',\n                        exchange_type='direct')\n\n# \u6d88\u8d39\u5b8c\u4e4b\u540e\u5220\u9664\u961f\u5217\nresult = channel.queue_declare(exclusive=True)\n# \u751f\u6210\u4e00\u4e2a\u968f\u673a\u961f\u5217\nqueue_name = result.method.queue\n\n# \u6d88\u8d39\u8005\u63a5\u6536\u65e5\u5fd7\u7684\u7ea7\u522b\nseverities = sys.argv[1:] \nif not severities:\n    sys.stderr.write(\"Usage: %s [info] [warning] [error]\\n\" % sys.argv[0])\n\n\nfor severity in severities:\n    channel.queue_bind(exchange='logs',\n                       queue=queue_name,\n                       routing_key=severity)\n\nprint('[*] Waiting for messages. To exit press CTRL+C')\n# \u5b9a\u4e49\u4e00\u4e2a\u56de\u8c03\u51fd\u6570\u6765\u5904\u7406\u6d88\u606f\uff0c\u51fd\u6570\u683c\u5f0f\u56fa\u5b9a\ndef callback(ch, method, properties, body):\n    print(\"[\u00d7] %r:%r\" % (method.routing_key, body))\n\n# \u5b9a\u4e49\u4ece\u54ea\u4e2a\u961f\u5217\u63a5\u6536\u6d88\u606f\u4ee5\u53ca\u5904\u7406\u6d88\u606f\u7684\u51fd\u6570\nchannel.basic_consume(callback,\n                      queue=queue_name,\n                      no_ack=True)\n\nchannel.start_consuming()\n</code></pre> <p>\u9a8c\u8bc1\uff1a</p> <p>\u5f00\u56db\u4e2a\u7a97\u53e3\uff0c\u4e00\u4e2a\u53d1\u9001\uff0c\u4e09\u4e2a\u63a5\u6536</p> <p>shell 1</p> <pre><code># \u7b2c\u4e00\u6b21\u53d1\u9001info\u7ea7\u522b\u7684\u65e5\u5fd7\n$ python3 send.py info hello\n [\u00d7] Sent 'info':'hello'\n# \u7b2c\u4e8c\u6b21\u53d1\u9001warning\u7ea7\u522b\u7684\u65e5\u5fd7\n$ python3 send.py warning world\n [\u00d7] Sent 'warning':'world'\n</code></pre> <p>shell 2</p> <pre><code># \u53ea\u63a5\u6536info\u7ea7\u522b\u65e5\u5fd7\u7ea7\u522b\u7684\u6d88\u8d39\u8005\u90fd\u6536\u5230\u65e5\u5fd7\n$ python3 receive.py info\n[*] Waiting for messages. To exit press CTRL+C\n[\u00d7] 'info':b'hello'\n</code></pre> <p>shell 3</p> <pre><code># \u53ea\u5c31\u6536warning\u7ea7\u522b\u65e5\u5fd7\u7684\u6d88\u8d39\u8005\u53ea\u6536\u5230\u7b2c\u4e8c\u6b21\u53d1\u9001\u7684\u6d88\u606f\n$ python3 receive.py warning\n[*] Waiting for messages. To exit press CTRL+C\n[\u00d7] 'warning':b'world'\n</code></pre> <p>shell 4</p> <pre><code># \u53ea\u63a5\u6536info\u7ea7\u522b\u65e5\u5fd7\u7ea7\u522b\u7684\u6d88\u8d39\u8005\u90fd\u6536\u5230\u65e5\u5fd7\n$ python3 receive.py info\n[*] Waiting for messages. To exit press CTRL+C\n[\u00d7] 'info':b'hello'\n</code></pre>"},{"location":"software/middleware/rabbitmq/#5","title":"5. \u4e3b\u9898","text":""},{"location":"software/middleware/rabbitmq/#6-rpc","title":"6. RPC","text":""},{"location":"software/middleware/rabbitmq/#_3","title":"\u4e09\u3001\u8fd0\u7ef4","text":""},{"location":"software/middleware/rabbitmq/#1_6","title":"1.\u5b89\u88c5","text":""},{"location":"software/middleware/rabbitmq/#1_7","title":"1. \u7f16\u8bd1\u5b89\u88c5","text":""},{"location":"software/middleware/rabbitmq/#11","title":"1.1. \u5b89\u88c5\u7f16\u8bd1\u5de5\u5177","text":"<pre><code>$ sudo apt update\n$ sudo apt install gcc make\n</code></pre>"},{"location":"software/middleware/rabbitmq/#12-ncurses","title":"1.2. \u5b89\u88c5ncurses","text":"<pre><code>$ wget http://ftp.gnu.org/gnu/ncurses/ncurses-6.1.tar.gz\n$ tar zxf ncurses-6.1.tar.gz\n$ cd ncurses-6.1\n$ ./configure\n$ make\n$ sudo make install\n</code></pre>"},{"location":"software/middleware/rabbitmq/#13-openssl","title":"1.3. \u5b89\u88c5openssl","text":"<pre><code>$ wget https://www.openssl.org/source/old/1.0.2/openssl-1.0.2p.tar.gz\n$ sudo mkdir /usr/local/openssl\n$ tar zxf openssl-1.0.2p.tar.gz\n$ cd openssl-1.0.2p/\n$ ./config --prefix=/usr/local/openssl\n#\u65b0\u7248\u672copenssl\u9ed8\u8ba4\u7f16\u8bd1\u51fa\u6765\u7684libcrypto.a\u662f\u6ca1\u6709\u52a0-fPIC\u53c2\u6570\u7684\uff0c\u5f53\u91cd\u5b9a\u4f4d\u88ab\u5f15\u7528\u7684\u4ee3\u7801\n#\u6bb5\u6570\u636e\u5bf9\u8c61\u65f6\u51fa\u9519\u3002\n#\u4fee\u6539openssl\u6e90\u7801\u7684Makefile\n#\u53c2\u8003\uff1ahttps://blog.csdn.net/erlib/article/details/20995947\n#\u5728CFLAG=\u3000\u6dfb\u52a0\u3000-fPIC\n$ vi Makefile\nCC= gcc\nCFLAG= -fPIC ...\n$ make\n$ sudo make install\n</code></pre>"},{"location":"software/middleware/rabbitmq/#14-erlang","title":"1.4. \u5b89\u88c5erlang\u73af\u5883","text":"<pre><code>#\u4e0b\u8f7derlang\uff1ahttp://www.erlang.org/downloads/19.3\n#\u5b89\u88c5\u6307\u5357\uff1ahttp://erlang.org/doc/installation_guide/INSTALL.html\n\n$ wget http://erlang.org/download/otp_src_19.3.tar.gz\n$ tar zxf otp_src_19.3.tar.gz\n$ sudo mkdir /usr/local/erlang\n$ cd otp_src_19.3/\n$ ./configure --prefix=/usr/local/erlang/ --with-ssl=/usr/local/openssl\n$ make &amp;&amp; sudo make install\n</code></pre>"},{"location":"software/middleware/rabbitmq/#15-rabbitmq","title":"1.5. \u5b89\u88c5rabbitmq","text":"<pre><code># rabbitmq\u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.rabbitmq.com/releases/rabbitmq-server/\n# \u4e0b\u8f7d\u9700\u8981\u5b89\u88c5\u7684\u7248\u672c\uff1a\n$ wget http://www.rabbitmq.com/releases/rabbitmq-server/v3.6.12/rabbitmq-server-generic-unix-3.6.12.tar.xz\n$ tar xJf rabbitmq-server-generic-unix-3.6.12.tar.xz\n$ sudo mv rabbitmq_server-3.6.12 /usr/local/rabbitmq\n</code></pre>"},{"location":"software/middleware/rabbitmq/#16","title":"1.6. \u914d\u7f6e\u73af\u5883\u53d8\u91cf","text":"<pre><code>$ cat /etc/profile\nexport ERLANG_HOME=/usr/local/erlang\nexport PATH=$ERLANG_HOME/bin:$PATH\nexport RABBITMQ_HOME=/usr/local/rabbitmq\nexport PATH=$RABBITMQ_HOME/sbin:$PATH\n$ source  /etc/profile\n</code></pre>"},{"location":"software/middleware/rabbitmq/#17","title":"1.7. \u542f\u52a8\u670d\u52a1","text":"<pre><code>$ rabbitmq-server -detached\nWarning: PID file not written; -detached was passed.  # \u4f7f\u7528-detached\u4e0d\u4f1a\u751f\u4ea7pid\u6587\u4ef6\n# \u67e5\u770brabbitmq\u72b6\u6001\n$ rabbitmqctl status\nStatus of node rabbit@node1\n[{pid,2162},\n {running_applications,\n     [{rabbit,\"RabbitMQ\",\"3.6.12\"},\n      {mnesia,\"MNESIA  CXC 138 12\",\"4.14.3\"},\n      {ranch,\"Socket acceptor pool for TCP protocols.\",\"1.3.0\"},\n      {ssl,\"Erlang/OTP SSL application\",\"8.1.1\"},\n      {public_key,\"Public key infrastructure\",\"1.4\"},\n      {asn1,\"The Erlang ASN1 compiler version 4.0.4\",\"4.0.4\"},\n      {rabbit_common,\n          \"Modules shared by rabbitmq-server and rabbitmq-erlang-client\",\n          \"3.6.12\"},\n      {syntax_tools,\"Syntax tools\",\"2.1.1\"},\n      {os_mon,\"CPO  CXC 138 46\",\"2.4.2\"},\n      {crypto,\"CRYPTO\",\"3.7.3\"},\n      {xmerl,\"XML parser\",\"1.3.13\"},\n      {compiler,\"ERTS  CXC 138 10\",\"7.0.4\"},\n      {sasl,\"SASL  CXC 138 11\",\"3.0.3\"},\n      {stdlib,\"ERTS  CXC 138 10\",\"3.3\"},\n      {kernel,\"ERTS  CXC 138 10\",\"5.2\"}]},\n {os,{unix,linux}},\n {erlang_version,\n     \"Erlang/OTP 19 [erts-8.3] [source] [64-bit] [async-threads:64] [kernel-poll:true]\\n\"},\n {memory,\n     [{connection_readers,0},\n      {connection_writers,0},\n      {connection_channels,0},\n      {connection_other,0},\n      {queue_procs,2600},\n      {queue_slave_procs,0},\n      {plugins,0},\n      {other_proc,22505384},\n      {metrics,42216},\n      {mgmt_db,0},\n      {mnesia,58288},\n      {other_ets,1946128},\n      {binary,52272},\n      {msg_index,41080},\n      {code,21412394},\n      {atom,891849},\n      {other_system,18227437},\n      {total,65179648}]},\n {alarms,[]},\n {listeners,[{clustering,25672,\"::\"},{amqp,5672,\"::\"}]},\n {vm_memory_calculation_strategy,rss},\n {vm_memory_high_watermark,0.4},\n {vm_memory_limit,416343654},\n {disk_free_limit,50000000},\n {disk_free,6662619136},\n {file_descriptors,\n     [{total_limit,924},{total_used,2},{sockets_limit,829},{sockets_used,0}]},\n {processes,[{limit,1048576},{used,151}]},\n {run_queue,0},\n {uptime,176},\n {kernel,{net_ticktime,60}}]\n</code></pre> <p>\u4ee5\u8fd9\u79cd\u65b9\u5f0f\u542f\u52a8\u65f6\uff0c\u5f53\u524d\u8282\u70b9\u4ee5rabbit@\u4e3b\u673a\u540d\u6765\u547d\u4ee4\u3002 \u6307\u5b9a\u8282\u70b9\u540d\u7684\u65b9\u6cd5</p> <pre><code>$ RABBITMQ_NODENAME=rabbit@\u540d\u79f0 rabbitmq-server -detached\n</code></pre>"},{"location":"software/middleware/rabbitmq/#2_5","title":"2. \u7f51\u7edc\u6e90\u5b89\u88c5","text":"<p>\u7565</p>"},{"location":"software/middleware/rabbitmq/#2_6","title":"2. \u7ba1\u7406","text":""},{"location":"software/middleware/rabbitmq/#1_8","title":"1. \u865a\u62df\u4e3b\u673a\u7ba1\u7406","text":"<ol> <li>\u67e5\u770b\u73b0\u6709\u7684\u865a\u62df\u4e3b\u673a</li> </ol> <pre><code># \u67e5\u770b\u73b0\u6709\u7684\u865a\u62df\u4e3b\u673a\n$ rabbitmqctl list_vhosts\n# \u67e5\u770b\u662f\u5426\u4f7f\u7528\u4e86trace\u529f\u80fd\n$ rabbitmqctl list_vhosts name tracing\n</code></pre> <ol> <li>\u6dfb\u52a0\u4e00\u4e2a\u865a\u62df\u4e3b\u673a</li> </ol> <pre><code>$ rabbitmqctl add_vhost {\u865a\u62df\u4e3b\u673a\u540d}\n</code></pre> <ol> <li>\u5220\u9664\u4e00\u4e2a\u865a\u62df\u4e3b\u673a</li> </ol> <pre><code>$ rabbitmqctl delete_vhost  {\u865a\u62df\u4e3b\u673a\u540d}\n</code></pre> <ol> <li>\u67e5\u770b\u865a\u62df\u673a\u6743\u9650</li> </ol> <pre><code>$ rabbitmqctl list_permissions -p {\u865a\u62df\u4e3b\u673a\u540d}\n</code></pre> <ol> <li>\u865a\u62df\u673a\u6743\u9650\u6388\u4e88</li> </ol> <pre><code>rabbitmqctl set_permissions -p {\u865a\u62df\u4e3b\u673a\u540d} {\u7528\u6237\u540d} \".*\" \".*\" \".*\"\n</code></pre> <p>\u683c\u5f0f\uff1arabbitmqctl set_permissions [-p vhost] {user} {conf} {write} {read}  vhost:\u6388\u4e88\u7528\u6237\u8bbf\u95ee\u6743\u9650\u7684vhost\u7684\u540d\u79f0 user\uff1a\u53ef\u4ee5\u8bbf\u95ee\u6307\u5b9avhost\u7684\u7528\u6237\u540d conf:\u7528\u4e8e\u5339\u914d\u7528\u6237\u5728\u54ea\u4e9b\u8d44\u6e90\u662f\u62e5\u6709\u53ef\u914d\u7f6e\u6743\u9650\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u961f\u5217\u548c\u4ea4\u6362\u673a\u7684\u521b\u5efa\u53ca\u5220\u9664\u4e4b\u7c7b\uff09 write\uff1a\u7528\u4e8e\u5339\u914d\u7528\u6237\u5728\u54ea\u4e9b\u8d44\u6e90\u662f\u62e5\u6709\u53ef\u5199\u6743\u9650\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u53d1\u5e03\u6d88\u606f\uff09 read\uff1a\u7528\u4e8e\u5339\u914d\u7528\u6237\u5728\u54ea\u4e9b\u8d44\u6e90\u662f\u62e5\u6709\u53ef\u8bfb\u6743\u9650\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\uff08\u8bfb\u53d6\u6d88\u606f\u548c\u6e05\u7a7a\u961f\u5217\uff09  </p> <ol> <li>\u67e5\u770b\u7528\u6237\u7684\u6743\u9650</li> </ol> <pre><code>    $ rabbitmqctl list_user_permissions {USER}\n</code></pre>"},{"location":"software/middleware/rabbitmq/#2_7","title":"2. \u7528\u6237\u7ba1\u7406","text":"<ol> <li>\u521b\u5efa\u7528\u6237\u5e76\u8bbe\u7f6e\u5bc6\u7801</li> </ol> <pre><code>$ rabbitmqctl add_user {username} {password}\n</code></pre> <ol> <li>\u66f4\u6539\u5bc6\u7801</li> </ol> <pre><code>$ rabbitmqctl change_password {username} {new password}\n</code></pre> <ol> <li>\u6e05\u9664\u5bc6\u7801</li> </ol> <pre><code>$ rabbitmqctl clear_password {username}\n</code></pre> <ol> <li>\u67e5\u770b\u73b0\u6709\u7528\u6237</li> </ol> <pre><code>$ rabbitmqctl list_users\n</code></pre> <ol> <li>\u8bbe\u7f6e\u7528\u6237\u89d2\u8272</li> </ol> <pre><code>$ rabbitmqctl  set_user_tags {username} {roles}\n\u7528\u6237\u89d2\u8272\u7c7b\u578b\uff1a\nnone: \u65e0\u4efb\u4f55\u89d2\u8272\uff0c\u65b0\u521b\u5efa\u7684\u7528\u6237\u89d2\u8272\u9ed8\u8ba4\u4e3anone\nmanagement:\u53ef\u4ee5\u8bbf\u95eeweb\u7ba1\u7406\u754c\u9762\npolicymaker:\u5305\u542bmanagement\u7684\u6240\u6709\u6743\u9650\uff0c\u5e76\u53ef\u53ef\u4ee5\u7ba1\u7406\u7b56\u7565\u548c\u53c2\u6570\nmonitoring:\u5305\u542bmanagement\u7684\u6240\u6709\u6743\u9650\uff0c\u53ef\u4ee5\u770b\u5230\u6240\u6709\u8fde\u63a5\u3001\u4fe1\u9053\u53ca\u8282\u70b9\u76f8\u5173\u4fe1\u606f\nadministrator: \u6700\u9ad8\u6743\u9650\n</code></pre> <ol> <li>\u9a8c\u8bc1\u7528\u6237\u662f\u5426\u80fd\u767b\u9646\u6210\u529f</li> </ol> <pre><code>$ rabbitmqctl authenticate_user {username} {password}\n</code></pre> <ol> <li>\u5220\u9664\u7528\u6237</li> </ol> <pre><code>$ rabbitmqctl delete_user {username}\n</code></pre>"},{"location":"software/middleware/rabbitmq/#3-web","title":"3. WEB\u7aef\u7ba1\u7406","text":"<ol> <li>\u67e5\u770b\u53ef\u7528\u63d2\u4ef6</li> </ol> <pre><code>$ rabbitmq-plugins list\n# [E*] \u4e3a\u663e\u5f0f\u542f\u52a8\uff1b[e*] \u4e3a\u9690\u5f0f\u542f\u52a8\n</code></pre> <p>\u63d2\u4ef6\u8def\u5f84\uff1a$RABBITMQ_HOME/plugins</p> <ol> <li>\u542f\u7528web\u7ba1\u7406\u63d2\u4ef6</li> </ol> <pre><code>$ rabbitmq-plugins enable rabbitmq_management\n$ netstat  -lant | grep 15672\ntcp        0      0 0.0.0.0:15672           0.0.0.0:*               LISTEN  \n</code></pre> <ol> <li>\u521b\u5efa\u4e00\u4e2a\u5177\u6709\u7ba1\u7406\u5458\u8eab\u4efd\u7684\u7528\u6237</li> </ol> <pre><code>$ rabbitmqctl add_user admin admin\n$ rabbitmqctl set_user_tags admin administrator\n</code></pre> <ol> <li> <p>\u767b\u9646\u7ba1\u7406\u754c\u9762    http://serverip:15672    </p> </li> <li> <p>\u5173\u95ed\u63d2\u4ef6</p> </li> </ol> <pre><code>$ rabbitmq-plugins disable rabbitmq_management\n</code></pre>"},{"location":"software/middleware/rabbitmq/#4_3","title":"4. \u5e94\u7528\u7ba1\u7406","text":"<ol> <li>\u505c\u6b62\u670d\u52a1</li> </ol> <pre><code># \u505c\u6b62\u8fd0\u884cRabbitmq Erlang\u865a\u62df\u673a\u548cRabbitmq\u670d\u52a1\u5e94\u7528\n$ rabbitmqctl stop \n# \u505c\u6b62\u8fd0\u884cRabbitmq Erlang\u865a\u62df\u673a\u548cRabbitmq\u670d\u52a1\u5e94\u7528\uff08\u963b\u585e\u76f4\u5230Erlang\u865a\u62df\u673a\u8fdb\u7a0b\u9000\u51fa\uff09\n$ rabbitmqctl shutdown\n</code></pre> <ol> <li>\u505c\u6b62Rabbitmq\u5e94\u7528(Erlang\u865a\u62df\u673a\u5904\u4e8e\u8fd0\u884c\u72b6\u6001)</li> </ol> <pre><code>$ rabbitmqctl stop_app\n</code></pre> <ol> <li>\u542f\u52a8Rabbitmq\u5e94\u7528</li> </ol> <pre><code>$ rabbitmqctl start_app\n</code></pre> <ol> <li>\u91cd\u7f6e\u8282\u70b9\uff0c\u8fd8\u539f\u5230\u6700\u521d\u72b6\u6001</li> </ol> <pre><code>$ rabbitmqctl reset\n</code></pre> <ol> <li>\u65e5\u5fd7\u8f6c\u50a8</li> </ol> <pre><code>$ rabbitmqctl rotate_logs {\u540e\u7f00}\n</code></pre>"},{"location":"software/middleware/rabbitmq/#5_1","title":"5. \u670d\u52a1\u72b6\u6001","text":"<ol> <li>\u961f\u5217\u72b6\u6001    \u683c\u5f0f\uff1arabbitmqctl list_queues [-p  vhost] [queueinfoitem ...]</li> </ol> <pre><code>$ rabbitmqctl list_queues -p myvhost   \n</code></pre> <ol> <li>\u4ea4\u6362\u673a\u72b6\u6001    \u683c\u5f0f\uff1arabbitmqctl list_exchange [-p  vhost] [exchangeinfoitem ...]</li> </ol> <pre><code>$ rabbitmqctl list_exchanges -p myvhost name type durable auto_delete internal arguments policy\n</code></pre> <ol> <li>bind\u72b6\u6001    \u683c\u5f0f\uff1arabbitmqctl list bindings [-p vhost] [bindinginfoitem ...]</li> </ol> <pre><code>    $ rabbitmqctl list_bindings -p myvhost -q\n</code></pre> <ol> <li>\u8fde\u63a5\u72b6\u6001    \u683c\u5f0f\uff1arabbitmqctllist_connections [connectioninfoitem ...]</li> </ol> <pre><code>$ rabbitmqctl list_connections\n</code></pre> <ol> <li>\u4fe1\u9053\u72b6\u6001    \u683c\u5f0f\uff1a rabbitmqctl list_channels [channelinfoitem ...]</li> </ol> <pre><code>$ rabbitmqctl list_channels\n</code></pre> <ol> <li>\u6d88\u8d39\u8005\u72b6\u6001    \u683c\u5f0f\uff1arabbitmqctl list_consumers [-p vhost]</li> </ol> <pre><code>$ rabbitmqctl list_consumers -p /\n</code></pre> <ol> <li>\u670d\u52a1\u72b6\u6001</li> </ol> <pre><code># Broker \u72b6\u6001\n$ rabbitmqctl status\n# \u8282\u70b9\u5065\u5eb7\u68c0\u6d4b\n$ rabbitmqctl node_health_check\n# \u73af\u5883\u53d8\u91cf\u540d\u79f0\u548c\u503c\n$ rabbitmqctl environment\n# \u751f\u6210\u670d\u52a1\u72b6\u6001\u62a5\u544a\n$ rabbitmqctl report &gt; report.txt\n</code></pre>"},{"location":"software/middleware/rabbitmq/#3_4","title":"3. \u914d\u7f6e","text":""},{"location":"software/middleware/rabbitmq/#1_9","title":"1. \u73af\u5883\u53d8\u91cf","text":"<p>\u73af\u5883\u53d8\u91cf\u4f18\u5148\u7ea7\uff1aSHELL\u73af\u5883&gt;rabbitmq-env.conf&gt;\u9ed8\u8ba4\u914d\u7f6e rabbitmq-env.conf:$RABBITMQ_HOME/etc/rabbitmq/rabbitmq-env.conf \u9ed8\u8ba4\u914d\u7f6e\uff1a$RABBITMQ_HOME/sbin/rabbitmq-defaults</p>"},{"location":"software/middleware/rabbitmq/#2_8","title":"2. \u914d\u7f6e\u6587\u4ef6","text":"<p>\u914d\u7f6e\u6587\u4ef6\u793a\u4f8b\uff1ahttps://github.com/rabbitmq/rabbitmq-server/blob/v3.7.x/docs/rabbitmq.conf.example</p>"},{"location":"software/middleware/rabbitmq/#3_5","title":"3. \u4f18\u5316\u914d\u7f6e","text":"<ol> <li>\u5185\u6838\u53c2\u6570</li> </ol> <pre><code>net.ipv4.tcp_fID_timeout = 5\nnet.core.somaxconn = 128\nnet.ipv4.tcp_max_syn_backlog = 4096\n</code></pre>"},{"location":"software/middleware/rabbitmq/#4_4","title":"4. \u96c6\u7fa4","text":"<p>Rabbitmq\u96c6\u7fa4\u4e2d\u7684\u6240\u6709\u8282\u70b9\u90fd\u4f1a\u5907\u4efd\u6240\u6709\u5143\u6570\u636e\u4fe1\u606f\uff0c\u5305\u62ec:</p> <ol> <li>\u961f\u5217\u5143\u6570\u636e\uff1a\u961f\u5217\u7684\u540d\u79f0\u53ca\u5c5e\u6027</li> <li>\u4ea4\u6362\u5668\uff1a\u4ea4\u6362\u5668\u7684\u540d\u79f0\u53ca\u5c5e\u6027</li> <li>\u7ed1\u5b9a\u5173\u7cfb\u5143\u6570\u636e\uff1a\u4ea4\u6362\u5668\u4e0e\u961f\u5217\u6216\u8005\u4ea4\u6362\u5668\u4e0e\u4ea4\u6362\u5668\u4e4b\u95f4\u7684\u7ed1\u5b9a\u5173\u7cfb\uff1b</li> <li>vhost\u6570\u636e\uff1a\u4e3avhost\u5185\u7684\u961f\u5217\u3001\u4ea4\u6362\u5668\u548c\u7ed1\u5b9a\u63d0\u4f9b\u547d\u540d\u7a7a\u95f4\u53ca\u5b89\u5168\u5c5e\u6027\u3002</li> </ol> <p>\u6d88\u606f\u4e0d\u4f1a\u5907\u4efd\uff08\u901a\u8fc7\u914d\u7f6e\u955c\u50cf\u961f\u5217\u53ef\u4ee5\u89e3\u51b3\uff09:\u53ea\u4f1a\u5728\u5355\u8282\u70b9\u521b\u5efa\u961f\u5217\u5e76\u5305\u542b\u5b8c\u6574\u7684\u961f \u5217\u4fe1\u606f\uff08\u5143\u6570\u636e\u3001\u72b6\u6001\u3001\u5185\u5bb9\uff09\u3002</p>"},{"location":"software/middleware/rabbitmq/#1_10","title":"1. \u96c6\u7fa4\u642d\u5efa","text":"<ol> <li>\u5b89\u88c5rabbitmq</li> </ol> <p>\u53c2\u7167\u4e00.1\u4e2d\u7684\u6b65\u9aa4\u5b89\u88c5\u4e09\u53f0rabbitmq\u670d\u52a1\u5668</p> <ol> <li>\u914d\u7f6eDNS\u89e3\u6790</li> </ol> <pre><code>cat /etc/hosts\n172.16.10.101 node1\n172.16.10.102 node2\n172.16.10.103 node3\n</code></pre> <ol> <li>\u542f\u52a8node1</li> </ol> <pre><code>[ubuntu@nodel:~$ rabbitmq-server -detached\n</code></pre> <ol> <li>\u62f7\u8d1dnode1\u7684cookie\u6587\u4ef6\u5230node2\uff0cnode3</li> </ol> <p>\u7f16\u8bd1\u5b89\u88c5\u7684cookie\u6587\u4ef6\u5728\u3000$HOME/.erlang.cookie</p> <pre><code>ubuntu@node1:~$ scp  $HOME/.erlang.cookie ubuntu@node2:~/\nubuntu@node1:~$ scp  $HOME/.erlang.cookie ubuntu@node3:~/\n</code></pre> <ol> <li>\u914d\u7f6e\u96c6\u7fa4</li> </ol> <p>\u96c6\u7fa4\u914d\u7f6e\u7684\u65b9\u5f0f\uff1a</p> <ul> <li>rabbitmqctl \u6700\u5e38\u7528</li> <li>rabbitmq.config</li> <li>rabbitmq-autocluster</li> </ul> <p>\u5c06node2\u52a0\u5165\u96c6\u7fa4</p> <pre><code>ubuntu@node2:~$ rabbitmq-server -detached\nubuntu@node2:~$ rabbitmqctl stop_app\nStopping rabbit application on node rabbit@node2\nubuntu@node2:~$ rabbitmqctl reset\nResetting node rabbit@node2\nubuntu@node2:~$ rabbitmqctl join_cluster rabbit@node1\nClustering node rabbit@node2 with rabbit@node1\nubuntu@node2:~$ rabbitmqctl start_app\nStarting node rabbit@node2\n</code></pre> <p>\u5c06node3\u52a0\u5165\u96c6\u7fa4</p> <pre><code>ubuntu@node3:~$ rabbitmq-server -detached\nubuntu@node3:~$ rabbitmqctl stop_app\nStopping rabbit application on node rabbit@node3\nubuntu@node3:~$ rabbitmqctl reset\nResetting node rabbit@node3\nubuntu@node3:~$ rabbitmqctl join_cluster rabbit@node1\nClustering node rabbit@node3 with rabbit@node1\nubuntu@node3:~$ rabbitmqctl start_app\nStarting node rabbit@node3\n</code></pre> <p>\u67e5\u770b\u96c6\u7fa4\u72b6\u6001</p> <pre><code>ubuntu@node1:~$ rabbitmqctl cluster_status\nCluster status of node rabbit@node1\n[{nodes,[{disc,[rabbit@node1,rabbit@node2,rabbit@node3]}]},\n {running_nodes,[rabbit@node3,rabbit@node2,rabbit@node1]},\n {cluster_name,&lt;&lt;\"rabbit@node1\"&gt;&gt;},\n {partitions,[]},\n {alarms,[{rabbit@node3,[]},{rabbit@node2,[]},{rabbit@node1,[]}]}]\n</code></pre> <p>\u5982\u679c\u5173\u95ed\u4e86\u96c6\u7fa4\u4e2d\u6240\u6709\u7684\u8282\u70b9\uff0c\u5219\u9700\u8981\u4fdd\u8bc1\u5728\u542f\u52a8\u7684\u65f6\u5019\u6700\u540e\u5173\u95ed\u7684\u90a3\u4e2a\u8282\u70b9\u662f\u7b2c\u4e00\u4e2a\u542f\u52a8 \u7684\u3002\u5982\u679c\u7b2c\u4e00\u4e2a\u8d77\u5230\u80fd\u591f\u7684\u4e0d\u662f\u6700\u540e\u5173\u95ed\u7684\u8282\u70b9\uff0c\u90a3\u4e48\u8fd9\u4e2a\u8282\u70b9\u4f1a\u7b49\u5f85\u6700\u540e\u5173\u95ed\u7684\u8282\u70b9\u542f\u52a8\u3002 \u9ed8\u8ba4\u91cd\u8bd510\u6b2130s\u4ee5\u7b49\u5f85\u6700\u540e\u5173\u95ed\u7684\u8282\u70b9\u542f\u52a8\u3002\u5728\u91cd\u8bd5\u5931\u8d25\u4e4b\u540e\uff0c\u5f53\u524d\u8282\u70b9\u4e5f\u4f1a\u56e0\u4e3a\u5931\u8d25\u800c \u5173\u95ed\u81ea\u8eab\u7684\u5e94\u7528\u3002\u5982\u679c\u6700\u540e\u4e00\u4e2a\u5173\u95ed\u7684\u8282\u70b9\u6700\u7ec8\u7531\u4e8e\u67d0\u4e9b\u5f02\u5e38\u800c\u65e0\u6cd5\u542f\u52a8\uff0c\u5219\u53ef\u4ee5\u901a\u8fc7rab bitmqctlforget_cluster_node \u547d\u4ee4\u6765\u5c06\u6b64\u8282\u70b9\u8e22\u51fa\u96c6\u7fa4\u3002 \u5982\u679c\u6240\u6709\u7684\u8282\u70b9\u56e0\u4e3a\u67d0\u4e9b\u56e0\u7d20(\u65ad\u7535\u7b49)\u5173\u95ed\uff0c\u90a3\u4e48\u96c6\u7fa4\u4e2d\u7684\u8282\u70b9\u4f1a\u8ba4\u4e3a\u8fd8\u6709\u5176\u4ed6\u8282\u70b9\u5728\u5176\u540e \u9762\u5173\u95ed\u3002\u9700\u8981\u8c03\u7528rabbitmqctl force_boot\u6765\u542f\u52a8\u4e00\u4e2a\u8282\u70b9\uff0c\u4e4b\u540e\u96c6\u7fa4\u624d\u80fd\u6b63\u5e38\u542f\u52a8\u3002</p>"},{"location":"software/middleware/rabbitmq/#2_9","title":"2. \u96c6\u7fa4\u7ba1\u7406","text":""},{"location":"software/middleware/rabbitmq/#1_11","title":"1. \u96c6\u7fa4\u8282\u70b9\u7684\u7c7b\u578b","text":"<ol> <li>\u78c1\u76d8\u8282\u70b9 \u96c6\u7fa4\u4e2d\u81f3\u5c11\u8981\u67092\u4e2a\u78c1\u76d8\u8282\u70b9    \u5982\u679c\u53ea\u6709\u4e00\u4e2a\u78c1\u76d8\u8282\u70b9\uff0c\u5f53\u78c1\u76d8\u8282\u70b9\u5d29\u6e83\u65f6\uff0c\u76f4\u8fbe\u8be5\u8282\u70b9\u6062\u590d\u4e4b\u524d\u3002\u4e0d\u80fd\u6267\u884c\u521b\u5efa\u961f\u5217\u3001\u4ea4\u6362    \u5668\u3001\u7ed1\u5b9a\u5173\u7cfb\u3001\u7528\u6237\uff0c\u4ee5\u53ca\u6743\u9650\u66f4\u6539\u3001\u6dfb\u52a0\u6216\u5220\u9664\u96c6\u7fa4\u8282\u70b9\u7684\u64cd\u4f5c</li> <li>\u5185\u5b58\u8282\u70b9    \u5185\u5b58\u8282\u70b9\u552f\u4e00\u5b58\u50a8\u5230\u78c1\u76d8\u7684\u5143\u6570\u636e\u4fe1\u606f\u662f\u96c6\u7fa4\u53ea\u80fd\u602a\u78c1\u76d8\u8282\u70b9\u7684\u5730\u5740\u3002\u53ea\u8981\u5185\u5b58\u8282\u70b9\u53ef\u4ee5\u627e\u5230    \u81f3\u5c11\u4e00\u5757\u76d8\uff0c\u90a3\u4e48\u5b83\u5c31\u80fd\u5728\u91cd\u542f\u4ee5\u540e\u91cd\u65b0\u52a0\u5165\u96c6\u7fa4\u4e2d</li> </ol> <p>\u5355\u96c6\u7fa4\u8282\u70b9\u4e2d\u53ea\u6709\u78c1\u76d8\u7c7b\u578b\u7684\u8282\u70b9\uff0c\u5426\u5219\u91cd\u542f\u540e\u6570\u636e\u5c31\u4f1a\u4e22\u5931</p> <p>\u52a0\u5165\u8282\u70b9\u65f6\u6307\u5b9a\u8282\u70b9\u7c7b\u578b</p> <pre><code>rabbitmqctl join_cluster rabbit@node1 --ram\n</code></pre> <p>\u6539\u53d8\u8282\u70b9\u7c7b\u578b(\u9700\u8981\u5148stop_app)</p> <pre><code>ubuntu@node2:~$ rabbitmqctl change_cluster_node_type {disc|ram}\n</code></pre>"},{"location":"software/middleware/rabbitmq/#2_10","title":"2. \u5254\u9664\u5355\u4e2a\u8282\u70b9","text":"<p>\u5254\u9664\u8282\u70b9\u6709\u4e24\u79cd\u65b9\u5f0f\uff0c\u4ee5\u5254\u9664node2\u4e3a\u4f8b</p> <ol> <li>\u88ab\u52a8\u5254\u9664    \u5148\u5728node2\u5173\u95edrabbitmq\uff1a rabbitmqctl stop_app    \u7136\u540e\u5728node1\u4e0a\u628anode2\u5254\u9664\uff1a rabbitmqctl forget_cluster_node rabbit@node2</li> <li>\u4e3b\u52a8\u5254\u9664    \u505c\u6b62\u5e94\u7528\uff1arabbitmqctl stop_app    \u91cd\u7f6erabbitmq \uff1arabbitmqctl reset</li> </ol>"},{"location":"software/middleware/rabbitmq/#3_6","title":"3. \u603b\u7ed3","text":"<ol> <li>\u67e5\u770b\u96c6\u7fa4\u72b6\u6001</li> </ol> <pre><code>$ rabbitmqctl cluster_status\n</code></pre> <ol> <li>\u4fee\u6539\u96c6\u7fa4\u8282\u70b9\u7c7b\u578b</li> </ol> <pre><code># \u9700\u8981\u73b0\u505c\u6b62rabbitmq\u5e94\u7528\uff1arabbitmqctl stop_app\n$ rabbitmqctl change_cluster_node_type {disc|ram}\n</code></pre> <ol> <li>\u5c06\u8282\u70b9\u4ece\u96c6\u7fa4\u4e2d\u5220\u9664</li> </ol> <pre><code>$ rabbitmqctl forget_cluster_node {\u8282\u70b9\u540d\u79f0}\n</code></pre> <ol> <li>\u542f\u52a8\u524d\u54a8\u8be2\u96c6\u7fa4\u8282\u70b9\u7684\u6700\u65b0\u4fe1\u606f</li> </ol> <pre><code>rabbitmqctl update_cluster_nodes {\u8282\u70b9\u540d\u79f0}\n</code></pre> <ol> <li>\u65ad\u7535\u540e\u91cd\u542f    \u4e00\u822c\u60c5\u51b5\u4e0b\uff0c\u91cd\u542f\u7684\u7b2c\u4e00\u4e2a\u8282\u70b9\u5e94\u8be5\u662f\u6700\u540e\u5173\u95ed\u7684\u8282\u70b9</li> </ol> <pre><code>$ rabbitmqctl force_boot\n</code></pre> <ol> <li>\u540c\u6b65\u961f\u5217</li> </ol> <pre><code># \u524d\u63d0\u6761\u4ef6\u662f\u961f\u5217\u914d\u7f6e\u4e86\u955c\u50cf\n$ rabbitmqctl sync_queue queue\n</code></pre> <ol> <li>\u8bbe\u7f6e\u96c6\u7fa4\u540d\u79f0    \u9ed8\u8ba4\u662f\u96c6\u7fa4\u4e2d\u7b2c\u4e00\u4e2a\u8282\u70b9\u7684\u540d\u79f0</li> </ol> <pre><code>$ rabbitmqctl set_cluster_name {name}\n</code></pre>"},{"location":"software/middleware/rabbitmq/#3_7","title":"3. \u96c6\u7fa4\u76d1\u63a7","text":"<ol> <li>\u901a\u8fc7HTTP API\u63d0\u4f9b\u76d1\u63a7\u6570\u636e</li> <li>\u901a\u8fc7\u5ba2\u6237\u7aef\u63d0\u4f9b\u76d1\u63a7\u6570\u636e</li> <li>\u5143\u6570\u636e\u7ba1\u7406\u4e0e\u76d1\u63a7</li> </ol>"},{"location":"software/middleware/rabbitmq/#4_5","title":"4. \u961f\u5217\u955c\u50cf","text":"<p>\u96c6\u7fa4\u4e2d\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u53ef\u4ee5\u4fdd\u5b58\u5143\u6570\u636e\uff0c\u4f46\u662f\u6d88\u606f\u53ea\u5728\u5355\u8282\u70b9\u4e0a\u4fdd\u5b58\uff0c\u4f7f\u7528\u955c\u50cf\u961f\u5217\u53ef\u4ee5\u5c06\u961f\u5217\u955c\u50cf\u5230 \u96c6\u7fa4\u4e2d\u7684\u5176\u4ed6Broker\u4e0a\uff0c\u5982\u679c\u96c6\u7fa4\u4e2d\u7684\u4e00\u4e2a\u8282\u70b9\u5931\u6548\u4e86\uff0c\u961f\u5217\u80fd\u81ea\u52a8\u5207\u6362\u5230\u955c\u50cf\u4e2d\u7684\u53e6\u4e00\u4e2a\u8282\u70b9\u4e0a\u3002</p> <p>\u955c\u50cf\u961f\u5217\u90fd\u5305\u542b\u4e00\u4e2amaster\u8282\u70b9\uff0c\u548c\u82e5\u5e72\u4e2a\u4ece\u8282\u70b9\u3002\u5982\u679cmaster\u7531\u4e8e\u67d0\u79cd\u539f\u56e0\u5931\u6548\uff0c\u90a3\u4e48\u8d44\u5386\u6700\u8001 \u7684\uff08\u52a0\u5165\u96c6\u7fa4\u65f6\u95f4\u6700\u957f\u7684\uff09slave\u4f1a\u88ab\u63d0\u5347\u4e3a\u65b0\u7684master\u3002\u53d1\u9001\u5230\u955c\u50cf\u961f\u5217\u7684\u6240\u6709\u6d88\u606f\u4f1a\u540c\u65f6\u53d1\u5f80 master\u548c\u6240\u6709\u7684slave\uff0c\u5982\u679c\u6b64\u65f6master\u6302\u4e86\uff0c\u6d88\u606f\u8fd8\u4f1a\u5728slave\u4e0a\u3002\u9664\u4e86\u53d1\u9001\u6d88\u606f\u5916\u7684\u6240\u6709\u52a8\u4f5c \u90fd\u53ea\u4f1a\u5411master\u53d1\u9001\uff0c\u7136\u540e\u518d\u7531master\u5c06\u547d\u4ee4\u6267\u884c\u7684\u7ed3\u679c\u5e7f\u64ad\u7ed9\u5404\u4e2aslave\u3002</p> <p>\u6d88\u8d39\u8005\u8ba2\u9605\u7684\u6d88\u606f\u5b9e\u9645\u4e0a\u90fd\u662f\u4ecemaster\u83b7\u53d6\u6d88\u606f\uff0c\u6bd4\u5982\u6d88\u8d39\u8005\u8fde\u63a5\u5230salve \u6d88\u8d39\u8005\u4e0eslave\u5efa\u7acb\u8fde\u63a5--&gt;\u6d88\u8d39\u8005\u53d1\u51faget\u8bf7\u6c42--&gt;slave\u628a\u8bf7\u6c42\u8f6c\u7ed9master--&gt;master\u51c6\u5907\u6570\u636e \u8fd4\u7ed9slave--&gt;slave\u628a\u6570\u636e\u6295\u9012\u7ed9\u6d88\u8d39\u8005</p> <p>\u4e8b\u5b9e\u4e0a\u961f\u5217\u7684master\u4e0d\u662f\u90fd\u5b58\u5728\u67d0\u4e00\u4e2a\u8282\u70b9\u4e0a\u7684\uff0c\u800c\u6bcf\u4e2a\u8282\u70b9\u4e0a\u65e2\u6709master\uff0c\u53c8\u6709slave\u3002\u961f\u5217\u7684 master\u662f\u5747\u5300\u5206\u5e03\u5728\u96c6\u7fa4\u4e2d\u7684\u5404\u4e2a\u8282\u70b9\u4e0a\u7684\u3002\uff08\u4e0d\u6070\u5f53\u7684\u6bd4\u4f8b\uff1a\u7c7b\u4f3c\u4e0e\u78c1\u76d8raid5\u7684\u90a3\u79cd\u5b58\u50a8)</p> <pre><code>$ rabbitmqctl set_policy ha-all \".*\" '{\"ha-mode\":\"all\",\"ha-sync-mode\":\"automatic\"}'\n</code></pre>"},{"location":"software/middleware/rabbitmq/#5_2","title":"5. \u8d1f\u8f7d\u5747\u8861","text":"<p>\u96c6\u7fa4\u914d\u7f6e\u955c\u50cf\u961f\u5217\u4e4b\u540e\u518d\u914d\u7f6e\u8d1f\u8f7d\u5747\u8861</p>"},{"location":"software/middleware/rabbitmq/#1_12","title":"1. \u5ba2\u6237\u7aef\u5185\u90e8\u5b9e\u73b0","text":"<p>\u8d1f\u8f7d\u5747\u8861\u6d41\u7a0b\u7b97\u6cd5\uff1a</p> <ol> <li>\u8f6e\u8be2</li> <li>\u52a0\u6743\u8f6e\u8be2</li> <li>\u968f\u673a\u6cd5</li> <li>\u52a0\u6743\u968f\u673a\u6cd5l</li> <li>\u6e90\u5730\u5740\u54c8\u5e0c</li> <li>\u6700\u5c0f\u8fde\u63a5\u6570\u6cd5</li> </ol>"},{"location":"software/middleware/rabbitmq/#2-haproxy","title":"2. \u4f7f\u7528HAProxy","text":""},{"location":"software/middleware/rabbitmq/#1-haproxy","title":"1. \u5b89\u88c5haproxy","text":"<pre><code>$ sudo apt update &amp;&amp; sudo apt install make gcc\n$ sudo apt install -y  zlib1g-dev libpcre3-dev libssl-dev\n# \u76f4\u63a5\u4e0b\u8f7d\u88ab\u5899\n$ wget http://www.haproxy.org/download/1.8/src/haproxy-1.8.19.tar.gz\n$ tar zxf haproxy-1.8.19.tar.gz\n$ sudo mkdir /usr/local/haproxy\n$ make TARGET=generic USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1\n$ sodo make install PREFIX=/usr/loacal/haproxy\n</code></pre>"},{"location":"software/middleware/rabbitmq/#2_11","title":"2. \u914d\u7f6e","text":"<pre><code>$ sudo mkdir /usr/loacl/haproxy\n$ cat /usr/loacl/haproxy/haproxy.cnf\n# \u5168\u5c40\u914d\u7f6e\nglobal\n    log 127.0.0.1 local0 info\n    maxconn 4096\n    chroot /usr/local/haproxy\n    user haproxy\n    group haproxy\n    daemon\n    pidfile /tmp/haproxy.pid\n# \u9ed8\u8ba4\u914d\u7f6e\ndefaults\n    log global\n    mode tcp\n    option tcplog\n    option dontlognull\n    retries 3\n    maxconn 2000\n    timeout connect 5s\n    timeout client 60s\n    timeout server 60s\n\n# \u7ed1\u5b9a\u914d\u7f6e\nfrontend rabbitmq\n    bind *:5672\n    mode tcp\n    default_backend rabbitmq_cluster\nbackend rabbitmq_cluster\n    mode tcp\n    balance roundrobin\n    server node1 172.16.10.101:5672 check inter 5000 rise 2 fall 3 weight 1\n    server node2 172.16.10.102:5672 check inter 5000 rise 2 fall 3 weight 1\n    server node3 172.16.10.103:5672 check inter 5000 rise 2 fall 3 weight 1\n# haproxy \u76d1\u63a7\nlisten monitor\n    bind *:8100\n    mode http\n    stats enable\n    stats auth admin:admin\n    stats refresh 5s\n    stats uri /haproxy?stats\n\n# \u786e\u8ba4\u670d\u52a1\u542f\u52a8\n$ netstat  -lant | egrep \"(8100|5672)\"\ntcp        0      0 0.0.0.0:8100            0.0.0.0:*               LISTEN     \ntcp        0      0 0.0.0.0:5672            0.0.0.0:*               LISTEN     \n</code></pre>"},{"location":"software/middleware/rabbitmq/#3_8","title":"3. \u9a8c\u8bc1","text":""},{"location":"software/middleware/rabbitmq/#3-keepalived","title":"3. keepalived\u5b9e\u73b0\u9ad8\u53ef\u7528+\u8d1f\u8f7d\u5747\u8861","text":""},{"location":"software/middleware/rabbitmq/#_4","title":"\u7ed3\u5c3e","text":"<p>\u4ee5\u4e0a\u5185\u5bb9\u662f\u770b\u4e66+\u5b9e\u8df5\u505a\u7684\u4e00\u4e9b\u7b14\u8bb0\uff0c\u6700\u540e\u4e00\u90e8\u5206\u60f3\u5199\u9ad8\u53ef\u7528\u76f8\u5173\u7684\u5185\u5bb9\uff08keepalived\u7b49\uff09\uff0c\u4f46\u662f \u77e5\u8bc6\u50a8\u5907\u8fd8\u6ca1\u5230\u3002\u540e\u671f\u4f1a\u4e13\u95e8\u5199\u4e00\u7bc7\u5173\u4e8elvs\u3001keepalived\u76f8\u5173\u7684\u3002\u672c\u6765\u8fd8\u884c\u5199\u4e00\u4e9b\u5173\u4e8epython \u5ba2\u6237\u7aef\u4f7f\u7528rabbitmq\u7684\u6559\u7a0b\uff0c\u80fd\u529b\u6709\u9650\uff0c\u8fd8\u662f\u770b\u5b98\u65b9\u624b\u518c\u5427</p>"},{"location":"software/web/Nginx/","title":"Nginx\u8d1f\u8f7d\u5747\u8861","text":"<p>Nginx\u652f\u6301\u4e03\u5c42\u8d1f\u8f7d\uff08HTTP\uff09\u548c\u56db\u5c42\u8d1f\u8f7d\uff08TCP and UDP\uff09\uff0c\u8fd9\u91cc\u4e3b\u8981\u4ecb\u7ecdHTTP\u8d1f\u8f7d</p> <p>\u5b9e\u73b0\u65b9\u6cd5\uff1a\u5229\u7528Nginx\u53cd\u5411\u4ee3\u7406\u7684\u529f\u80fd\u5b9e\u73b0\u540e\u7aef\u670d\u52a1\u7684\u8d1f\u8f7d\u5747\u8861</p> <p>\u6307\u4ee4\uff1aproxy_pass\u3001upstream</p>"},{"location":"software/web/Nginx/#_1","title":"\u4e00\u3001\u8d1f\u8f7d\u5747\u8861\u7b56\u7565","text":"<p>Nginx\u8d1f\u8f7d\u5747\u8861\u6a21\u5f0f\u67096\u79cd\uff08\u5f00\u6e90\u72484\u79cd+Plus\u72482\u79cd\uff09</p> <ol> <li>\u8f6e\u8be2(Round Robin)    \u9ed8\u8ba4\u65b9\u5f0f\uff0c\u8bf7\u6c42\u5728\u540e\u7aef\u670d\u52a1\u5668\u4f9d\u6b21\u8f6e\u8be2\uff0c\u901a\u8fc7weights\u53c2\u6570\u6539\u53d8\u8f6e\u8be2\u7684\u6743\u91cd\u3002</li> </ol> <pre><code>upstream backend {\n   server backend1.example.com;\n   server backend2.example.com;\n}\n</code></pre> <ol> <li>\u6700\u5c11\u8fde\u63a5\u6570(Least Connections)    \u5ba2\u6237\u7aef\u8bf7\u6c42\u53d1\u7ed9\u8fde\u63a5\u6570\u6700\u5c11\u7684\u670d\u52a1\u5668\uff0c\u540c\u65f6\u53ef\u4ee5\u901a\u8fc7weight\u6307\u5b9a\u6743\u91cd</li> </ol> <pre><code>upstream backend {\n    least_conn;\n    server backend1.example.com;\n    server backend2.example.com;\n}\n</code></pre> <ol> <li>IP\u54c8\u5e0c(IP Hash)    \u6839\u636e\u5ba2\u6237\u7aef\u7684IP\u5730\u5740\u89c9\u5f97\u53d1\u7ed9\u540e\u7aef\u7684\u54ea\u4e2a\u670d\u52a1\u5668\uff0c\u540c\u4e00IP\u5730\u5740\u7684\u8bf7\u6c42\u90fd\u53d1\u7ed9\u540e\u7aef\u7684\u540c\u4e00\u670d\u52a1\u5668\uff0c\u9664\u975e\u540e\u7aef\u670d\u52a1\u5668\u4e0d\u53ef\u7528\u3002</li> </ol> <pre><code>upstream backend {\n    ip_hash;\n    server backend1.example.com;\n    server backend2.example.com;\n}\n</code></pre> <ol> <li>\u81ea\u5b9a\u4e49\u54c8\u5e0c(Generic Hash,1.7.2\u4ee5\u4e0a)</li> </ol> <pre><code>upstream backend {ea\n    hash $request_uri consistent;\n    server backend1.example.com;\n    server backend2.example.com;\n}\n</code></pre> <ol> <li> <p>\u6700\u77ed\u54cd\u5e94\u65f6\u95f4(Least Time,1.7.10\u4ee5\u4e0a)    \u8bf7\u6c42\u53d1\u7ed9\u54cd\u5e94\u65f6\u95f4\u6700\u77ed\u548c\u8fde\u63a5\u6570\u6700\u5c11\u7684\u670d\u52a1\u5668\u3002</p> </li> <li> <p>\u968f\u673a\u9009\u62e9(Random\uff0c1.15.1\u4ee5\u4e0a)    \u6839\u636e\u968f\u673a\u7b56\u7565\u9009\u62e9\u540e\u7aef\u670d\u52a1\u5668</p> </li> </ol>"},{"location":"software/web/Nginx/#_2","title":"\u4e8c\u3001\u540e\u7aef\u670d\u52a1\u5668\u914d\u7f6e","text":"<pre><code>upstream name {\n    server address [parameters];\n}\n</code></pre> <pre><code>\u53c2\u6570\uff1a\n    weight\uff1a \u8bbe\u7f6e\u670d\u52a1\u5668\u6743\u91cd\uff0c\u9ed8\u8ba4\u4e3a1\u3002\u4f8b\uff1aweight=1\uff1b\n    max_fails:\u8bbe\u7f6e\u4e0e\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u8fde\u63a5\u5931\u8d25\u7684\u6b21\u6570\uff0c\u9ed8\u8ba4\u4e3a1\u3002\u4f8b\uff1amax_fails=3\n    fail_timeout\uff1a\u8fde\u63a5\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba4\u4e3a10s\u3002\u4f8b\uff1afail_timeout=5\n    backup\uff1a\u628a\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u6807\u8bb0\u4e3a\u5907\u4efd\u670d\u52a1\u5668\uff0c\u5f53\u4e3b\u670d\u52a1\u5668\u5b95\u673a\u4e4b\u540e\u542f\u7528\n    down\uff1a\u628a\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u6807\u8bb0\u4e3a\u4e0d\u53ef\u7528\u72b6\u6001\n    slow_start\uff1a\u6162\u542f\u52a8\uff0c\u670d\u52a1\u5728\u542f\u52a8\u540e\u7ecf\u8fc7\u4e00\u6bb5\u65f6\u95f4\u624d\u6807\u8bb0\u4e3a\u53ef\u7528\uff0c\u9ed8\u8ba4\u4e3a0\uff08\u7981\u7528\uff09**\u6ce8\u610f**\uff1a\u4e0d\u80fd\u4e0ehash\u548cip_hash\u4e00\u8d77\u4f7f\u7528\n    max_conns\uff081.29~1.11.5\uff0c\u5546\u4e1a\u7248\u4e2d\uff09\uff1a\u9650\u5236\u548c\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u7684\u6700\u5927\u6d3b\u52a8\u8fde\u63a5\uff0c\u9ed8\u8ba4\u4e3a0\uff0c\u4e0d\u9650\u5236\u3002\u4f8b\uff1amax_conns=25\n</code></pre>"},{"location":"software/web/Nginx/#_3","title":"\u4e09\u3001\u914d\u7f6e\u5b9e\u4f8b","text":"<ol> <li>\u5bf9\u6240\u6709\u8bf7\u6c42\u5b9e\u73b0\u4e00\u822c\u8f6e\u8be2\u89c4\u5219\u7684\u8d1f\u8f7d\u5747\u8861\u3002</li> </ol> <pre><code>upstream patapi{\n    server 192.168.1.130:9900;\n    server 192.168.1.131:9901;\n}\n\nserver {\n        listen 9988;\n        location / {\n                proxy_pass http://patapi;\n                ...\n        }\n\n}\n</code></pre> <ol> <li>\u5bf9\u6240\u6709\u8bf7\u6c42\u5b9e\u73b0\u52a0\u6743\u8f6e\u8be2\u89c4\u5219\u7684\u8d1f\u8f7d\u5747\u8861</li> </ol> <pre><code>upstream patapi{\n    server 192.168.1.130:9900 weight=5;\n    server 192.168.1.131:9901 weight=2;\n}\n\nserver {\n        listen 9988;\n        location / {\n                proxy_pass http://patapi;\n                ...\n        }\n\n}\n\n\n\n\n\n\n\nhttps://docs.nginx.com/nginx/admin-guide/load-balancer/http-load-balancer/#metho_hasj\n</code></pre>"},{"location":"software/web/Nginx/#nginx-rewrite","title":"Nginx rewrite","text":"<p>\u5b98\u65b9\u94fe\u63a5\uff1ahttp://nginx.org/en/docs/http/ngx_http_rewrite_module.html#rewrite</p> <p>\u6a21\u5757\uff1angx_http_rewrite_module \u529f\u80fd\uff1a\u5b9e\u73b0URL\u91cd\u5199 \u4f9d\u8d56\uff1a\u4f9d\u8d56PCRE(Perl Compatible Regular Expressions)</p>"},{"location":"software/web/Nginx/#_4","title":"\u8f6c\u53d1\u4e0e\u91cd\u5199\u7684\u533a\u522b\uff1a","text":"\u533a\u522b \u91cd\u5199 \u8f6c\u53d1 \u5ba2\u6237\u7aef\u6d4f\u89c8\u5668\u5730\u5740\u680f\u4e2d\u7684\u5730\u5740 \u6539\u53d8(\u53d8\u4e3a\u771f\u5b9e\u63d0\u4f9b\u670d\u52a1\u7684\u5730\u5740) \u4e0d\u53d8 \u8bf7\u6c42\u6b21\u6570 \u4e24\u6b21 \u4e00\u6b21 \u4f4d\u7f6e \u6ca1\u6709\u9650\u5236 \u540c\u4e00\u7ad9\u70b9\u9879\u76ee\u5185 \u8f6c\u53d1\u5230\u7684\u9875\u9762\u8def\u5f84\u540d\u8868\u793a \u5b8c\u6574\u7684\u8def\u5f84\u540d \u53ef\u4ee5\u4e0d\u7528\u5168\u8def\u5f84\u540d request\u8303\u56f4\u5185\u5c5e\u6027\u7684\u4f20\u9012 \u4e0d\u53ef\u4ee5 \u53ef\u4ee5\u4f20\u9012\u7ed9\u65b0\u9875\u9762 \u901f\u5ea6 \u6162 \u5757"},{"location":"software/web/Nginx/#_5","title":"\u914d\u7f6e\u6307\u4ee4","text":""},{"location":"software/web/Nginx/#1-if","title":"1. if","text":"<p>\u4f4d\u7f6e\uff1aserver, location</p> <p>\u8bed\u6cd5\uff1a if (condition) { ... }</p> <p>condition\u7684\u683c\u5f0f\uff1a</p> <ol> <li> <p>\u53d8\u91cf\u540d\uff1a\u5982\u679c\u53d8\u91cf\u7684\u503c\u4e3a\u7a7a\u5b57\u7b26\u4e32\u6216\u201c <code>0</code>\u201d\uff0c\u5219\u4e3afalse ;</p> </li> <li> <p>\u4f7f\u7528\u201c =\u201d\u548c\u201c !=\u201d\u8fd0\u7b97\u7b26\u6bd4\u8f83\u53d8\u91cf\u548c\u5b57\u7b26\u4e32;</p> </li> </ol> <pre><code>if  ($request_method = POST){\n     return 405\n}\n</code></pre> <ol> <li>\u53d8\u91cf\u4e0e\u6b63\u5219\u8868\u8fbe\u5f0f\u5339\u914d</li> </ol> <p>~:\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\uff0c\u5339\u914d\u6210\u529f\u4e3atrue</p> <p>~*:\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\uff0c\u5339\u914d\u6210\u529f\u4e3atrue</p> <p>!~:\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\uff0c\u5339\u914d\u5931\u8d25\u4e3atrue</p> <p>!~*:\u4e0d\u533a\u5206\u5927\u5c0f\u5199\u7684\u5339\u914d\uff0c\u5339\u914d\u5931\u8d25\u4e3atrue</p> <p>\u5728\u6b63\u5219\u8868\u8fbe\u5f0f\u4e2d\u53ef\u4ee5\u7528\u5c0f\u62ec\u53f7\u5bf9\u53d8\u91cf\u8fdb\u884c\u622a\u53d6\uff0c\u5728\u82b1\u62ec\u53f7\u4e2d\u4f7f\u7528\\(1-\\)9\u5f15\u7528\u622a\u53d6\u7684\u503c\u3002\u5982\u679c\u6b63\u5219\u8868\u8fbe\u5f0f\u5305\u542b\u201c <code>}</code>\u201d\u6216\u201c <code>;</code>\u201d\u5b57\u7b26\uff0c\u5219\u6574\u4e2a\u8868\u8fbe\u5f0f\u5e94\u5305\u542b\u5728\u5355\u5f15\u53f7\u6216\u53cc\u5f15\u53f7\u4e2d\u3002</p> <pre><code> if ($request_uri ~ /a/b/c/d) {\n                        return 200 \"$request_method $request_uri\";\n                }\n</code></pre> <ol> <li>\u4f7f\u7528\u201c -f\u201d\u548c\u201c !-f\u201d\u8fd0\u7b97\u7b26\u68c0\u67e5\u6587\u4ef6\u662f\u5426\u5b58\u5728;</li> <li>\u4f7f\u7528\u201c -d\u201d\u548c\u201c !-d\u201d\u8fd0\u7b97\u7b26\u68c0\u67e5\u76ee\u5f55\u662f\u5426\u5b58\u5728;</li> <li>\u4f7f\u7528\u201c -e\u201d\u548c\u201c !-e\u201d\u8fd0\u7b97\u7b26\u68c0\u67e5\u6587\u4ef6\uff0c\u76ee\u5f55\u6216\u7b26\u53f7\u94fe\u63a5\u662f\u5426\u5b58\u5728;</li> <li>\u4f7f\u7528\u201c -x\u201d\u548c\u201c !-x\u201d\u8fd0\u7b97\u7b26\u68c0\u67e5\u53ef\u6267\u884c\u6587\u4ef6\u3002</li> </ol>"},{"location":"software/web/Nginx/#2break","title":"2.break","text":"<p>\u4f5c\u7528\uff1astops processing the current set of ngx_http_rewrite_module directives;</p> <p>\u4e2d\u65ad\u5f53\u524d\u76f8\u540c\u4f5c\u7528\u57df\u4e2d\u5176\u4ed6Nginx\u914d\u7f6e\uff0c\u4f4d\u4e8e\u5b83\u524d\u9762\u7684\u6307\u4ee4\u914d\u7f6e\u751f\u6548\uff0c\u4f4d\u4e8e\u540e\u9762\u7684\u6307\u4ee4\u914d\u7f6e\u65e0\u6548\u3002\u670d\u52a1\u5668\u5728\u6839\u636e\u914d\u7f6e\u5904\u7406\u8bf7\u6c42\u7684\u8fc7\u7a0b\u4e2d\u9047\u5230\u8be5\u6307\u4ee4\u65f6\u3002\u56de\u5230\u4e0a\u4e00\u5c42\u4f5c\u7528\u57df\u7ee7\u7eed\u5411\u4e0b\u8bfb\u53d6\u914d\u7f6e\u3002</p> <p>\u4f4d\u7f6e\uff1aserver, location, if</p> <p>\u8bed\u6cd5\uff1abreak;</p> <p>\u5b9e\u4f8b\uff1a</p>"},{"location":"software/web/Nginx/#3return","title":"3.return","text":"<p>\u4f5c\u7528\uff1a\u5b8c\u6210\u5bf9\u8bf7\u6c42\u7684\u5904\u7406\uff0c\u76f4\u63a5\u5411\u5ba2\u6237\u7aef\u8fd4\u56de\u54cd\u5e94\u72b6\u6001\u7801\u3002\u5904\u4e8e\u8be5\u6307\u4ee4\u540e\u7684\u6240\u6709Nginx\u914d\u7f6e\u90fd\u662f\u65e0\u6548\u7684\u3002</p> <p>\u4f4d\u7f6e\uff1aserver\uff0clocation\uff0cif</p> <p>\u8bed\u6cd5\uff1a</p> <p>return code [ text ];  return code URL ;  return URL ;</p> <p>\u5b9e\u4f8b\uff1a</p> <pre><code>default_type  application/json;\nif ($http_appversion != \"\"){\n    return 200 '{\"code\":-2, \"message\":\"\u7248\u672c\u8fc7\u65e7\uff0c\u9700\u8981\u5f3a\u5236\u5347\u7ea7\"}';\n}\n</code></pre>"},{"location":"software/web/Nginx/#4rewrite","title":"4.rewrite","text":"<p>\u4f5c\u7528\uff1a\u901a\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\u6765\u6539\u53d8URI\u3002\u53ef\u4ee5\u540c\u65f6\u5b58\u5728\u4e00\u4e2a\u6216\u591a\u4e2a\u6307\u4ee4\uff0c\u6309\u7167\u987a\u5e8f\u4f9d\u6b21\u5bf9URL\u8fdb\u884c\u5339\u914d\u548c\u5904\u7406\u3002</p> <p>\u4f4d\u7f6e\uff1aserver<code>\uff0c</code>location<code>\uff0c</code>if</p> <p>\u8bed\u6cd5\uff1arewrite regex replacement [flag];</p> <p>\u200b   regex**\uff1a\u7528\u4e8e\u5339\u914dURI\u7684\u6b63\u5219\u8868\u8fbe\u5f0f\u3002\u4f7f\u7528()\u6807\u8bb0\u8981\u622a\u53d6\u7684\u5185\u5bb9</p> <p>\u200b   replacement\uff1a\u5339\u914d\u6210\u529f\u540e\u7528\u4e8e\u66ff\u6362URI\u4e2d\u88ab\u622a\u53d6\u5185\u5bb9\u7684\u5b57\u7b26\u4e32\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u5982\u679c\u8be5\u5b57\u7b26\u4e32\u7531\u201chttp://\u201d\uff0c\u201chttps://\u201d\u6216\u201c$scheme\u201d \u5f00\u5934\uff0c\u5219\u5904\u7406\u505c\u6b62\u5e76\u5c06\u91cd\u5b9a\u5411\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u3002</p> <p>\u200b   flag\uff1a\u7528\u6765\u8bbe\u7f6erewrite\u5bf9URI\u7684\u5904\u7406\u884c\u4e3a\u3002</p> <p>\u200b       last\uff1a\u7ec8\u6b62\u7ee7\u7eed\u5728\u672clocation\u4e2d\u5904\u7406\u63a5\u6536\u5230\u7684URI\uff0c\u5e76\u5c06\u6b64\u5904\u91cd\u5199\u7684URI\u4f5c\u4e3a\u65b0\u7684URI\u3002\u4f7f\u7528\u5404location\u5757\u8fdb\u884c\u5904\u7406\u3002\u8be5\u6807\u8bc6\u5c06\u91cd\u5199\u540e\u7684URI\u91cd\u65b0\u548bserver\u5757\u4e2d\u6267\u884c\uff0c\u4e3a\u91cd\u5199\u540e\u7684URI\u63d0\u4f9b\u4e86\u8f6c\u5165\u5176\u4ed6location\u5757\u7684\u673a\u4f1a\u3002</p> <p>\u200b       \u5b9e\u4f8b\uff1a</p> <pre><code>location /  {\n    rewrite ^(/download/.*)/media/(.*)\\..*$ $1/mp3/$2.mp3 last; # \u5339\u914d\u6210\u529f\u540e\u540e\u9762\u7684\u4e0d\u6267\u884c\n    rewrite ^(/download/.*)/audio/(.*)\\..*$ $1/mp3/$2.ra  last;\n}\n</code></pre> <p>\u200b       break\uff1a\u5c06\u6b64\u5904\u91cd\u5199\u7684URI\u4f5c\u4e3a\u65b0\u7684URI\uff0c\u5728\u672c\u5757\u4e2d\u7ee7\u7eed\u8fdb\u884c\u5904\u7406\u3002\u8be5\u6807\u8bc6\u540e\u5c06\u91cd\u5199\u540e\u7684\u5730\u5740\u5728\u5f53\u524d\u7684location\u5757\u4e2d\u7ee7\u7eed\u6267\u884c\uff0c\u4e0d\u4f1a\u5c06\u65b0\u7684URI\u8f6c\u5411\u5230\u5176\u4ed6location\u5757\u3002</p> <p>\u200b       \u5b9e\u4f8b\uff1a</p> <pre><code>location /download  {\n    rewrite ^(/download/.*)/media/(.*)\\..*$ $1/mp3/$2.mp3 break; # \u5339\u914d\u6210\u529f\u540e\u4f7f\u7528\u8fdb\u5165\u7b2c3\u884c\n    rewrite ^(/download/.*)/audio/(.*)\\..*$ $1/mp3/$2.ra  break;\n}\n</code></pre> <p>\u200b       \u5982\u679c\u628abreak\u66ff\u6362\u4e3alast\uff0c\u91cd\u5199\u540e\u7684URI\u8fd8\u53ef\u80fd\u4f1a\u88ab\u8be5location\u5339\u914d\u5230\uff0cNginx\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\u56de\u5c1d\u8bd510\u6b64\u5faa\u73af\u540e\u8fd4\u56de\u9519\u8bef\u72b6\u6001\u7801500.</p> <p>\u200b       redirect\uff1a\u5c06\u91cd\u5199\u540e\u7684URI\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u72b6\u6001\u4ee3\u7801\u4e3a302\u3002\u4e3b\u8981\u7528\u5728replacement\u53d8\u91cf\u4e0d\u662f\u4ee5\u201chttp://\u201d\uff0c\u201chttps://\u201d\u5f00\u5934\u7684\u60c5\u51b5\u4e0b\u3002</p> <p>\u200b       permanent\uff1a\u5c06\u91cd\u5199\u540e\u7684URI\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u72b6\u6001\u7801\u662f301.\u6307\u660e\u662f\u6c38\u4e45\u91cd\u5b9a\u5411\u3002</p> <p>\u6ce8\u610f\uff1a\u2460rewrite\u63a5\u6536\u5230\u7684URI\u4e0d\u5305\u542bhost\u5730\u5740\uff1b\u2461\u4e0d\u5305\u542bURL\u4e2d\u7684\u8bf7\u6c42\u6307\u4ee4\uff08\u4e0d\u5305\u542b?arg1=value1&amp;arg2=value2\uff09</p> <p>\u5b9e\u4f8b1\uff1a\u57df\u540d\u8df3\u8f6c</p> <pre><code>server {\n        listen 9988;# default_server;\n        server_name localhost;\n        charset utf-8;\n        rewrite_log on;\n        rewrite ^/ http://www.baidu.com/;\n        }\n</code></pre>"},{"location":"software/web/Nginx/#5rewrite_log","title":"5.rewrite_log","text":"<p>\u4f5c\u7528\uff1a\u914d\u7f6e\u662f\u5426\u5f00\u542fURL\u91cd\u5199\u65e5\u5fd7\u7684\u8f93\u51fa\u529f\u80fd\uff0c\u65e5\u5fd7\u5c06\u4ee5notice\u7ea7\u522b\u8f93\u51fa\u5230error_log</p> <p>\u8bed\u6cd5\uff1arewrite_log on|off;</p>"},{"location":"software/web/Nginx/#6set","title":"6.set","text":"<p>\u4f5c\u7528\uff1a\u8bbe\u7f6e\u4e00\u4e2a\u65b0\u7684\u53d8\u91cf</p> <p>\u8bed\u6cd5\uff1aset var vaule;</p> <p>\u5b9e\u4f8b\uff1a</p> <pre><code>   set $newIp \"\";\n   if ($http_appversion = \"1.0.16\"){    \n    set $newIp \"192.168.1.11:8080\";\n   }\n   proxy_pass \"http://$newIp\";      \n</code></pre>"},{"location":"software/web/Nginx/#7uninitialized_variable_warn","title":"7.uninitialized_variable_warn","text":"<p>\u4f5c\u7528\uff1a\u914d\u7f6e\u4f7f\u7528\u672a\u521d\u59cb\u5316\u7684\u53d8\u91cf\u65f6\uff0c\u662f\u5426\u8bb0\u5f55\u8b66\u544a\u65e5\u5fd7</p> <p>\u8bed\u6cd5\uff1auninitialized_variable_warn on|off;  \u9ed8\u8ba4on</p> <p>rewrite\u5e38\u7528\u5168\u5c40\u53d8\u91cf</p> <p>\u6240\u6709Nginx\u53d8\u91cf\uff1ahttp://nginx.org/en/docs/varindex.html</p> <p>http://nginx.org/en/docs/http/ngx_http_proxy_module.html</p>"},{"location":"software/web/Nginx/#_6","title":"\u4e00\u3001\u6b63\u5411\u4ee3\u7406","text":"<p>\u4e0d\u5e38\u7528</p>"},{"location":"software/web/Nginx/#_7","title":"\u4e8c\u3001\u53cd\u5411\u4ee3\u7406","text":"<p>\u6a21\u5757\uff1angx_http_proxy_module \u7279\u70b9\uff1a\u9ad8\u6548\u3001 \u6700\u5927\u8fde\u63a5\u6570\uff1dworker_processes * worker_connection/4 \u914d\u7f6e\uff1a\u4e00\u822c\u5355\u72ec\u914d\u7f6e\u4e00\u4e2aserver\u5757 \u57fa\u672c\u8bbe\u7f6e\uff1a</p> <ol> <li>proxy_pass URL    \u4f5c\u7528\uff1a\u8bbe\u7f6e\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u7684\u5730\u5740    \u683c\u5f0f\uff1a\u4e3b\u673a\u540d\u3001IP\u5730\u5740:\u7aef\u53e3\u53f7\u3001URI    \u534f\u8bae\uff1ahttp\u3001https\u3001UNIX-domain socket    \u3000\u3000\u4f8b\uff1a</li> </ol> <pre><code>    proxy_pass http://localhost:8000/uri/;\n    proxy_pass http://unix:/tmp/backend.socket:/uri/;\n</code></pre> <pre><code>\u5982\u679c\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u662f\u4e00\u7ec4\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u4f7f\u7528upstream\u6307\u4ee4\u914d\u7f6e\u540e\u7aef\u670d\u52a1\u5668\u7ec4\u3002\n</code></pre> <p>\u4f8b\uff1a</p> <pre><code>\n</code></pre> <ol> <li>proxy_hide_header</li> </ol> <p>\u4f5c\u7528\uff1a\u7528\u4e8e\u8bbe\u7f6eNginx\u5728\u53d1\u9001HTTP\u54cd\u5e94\u662f\uff0c\u9690\u85cf\u4e00\u4e9b\u5934\u57df\u4fe1\u606f</p> <p>\u4f4d\u7f6e\uff1ahttp\u3001server\u3001location</p> <p>\u8bed\u6cd5\uff1aproxy_hide_header field</p> <ol> <li>proxy_pass_header</li> </ol> <p>\u4f5c\u7528\uff1a\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0cNginx\u5728\u53d1\u9001\u54cd\u5e94\u62a5\u6587\u65f6\uff0c\u62a5\u6587\u5934\u4e2d\u4e0d\u5305\u542b\u201dDate\u201c,\"Server\",\u201dX-Accel-...\u201c\u7b49\u6765\u81ea\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u7684\u5934\u57df\u4fe1\u606f\uff0c\u8be5\u6307\u4ee4\u53ef\u4ee5\u8bbe\u7f6e\u8fd9\u4e9b\u5934\u57df\u4fe1\u606f\u4e00\u88ab\u53d1\u9001\u3002</p> <p>\u8bed\u6cd5\uff1aproxy_pass_header field</p> <ol> <li>proxy_pass_request_body</li> </ol> <p>\u4f5c\u7528\uff1a\u914d\u7f6e\u662f\u5426\u5c06\u8bf7\u6c42\u7684\u8bf7\u6c42\u4f53\u53d1\u9001\u7ed9\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u9ed8\u8ba4\u4e3a on</p> <p>\u8bed\u6cd5\uff1aproxy_pass_request_body on|off;</p> <ol> <li>proxy_pass_request_headers</li> </ol> <p>\u4f5c\u7528\uff1a\u914d\u7f6e\u662f\u5426\u5c06\u8bf7\u6c42\u7684\u8bf7\u6c42\u5934\u53d1\u9001\u7ed9\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u9ed8\u8ba4\u4e3a on</p> <p>\u8bed\u6cd5\uff1aproxy_pass_request_header on|off;</p> <ol> <li>proxy_set_header</li> </ol> <p>\u4f5c\u7528\uff1a\u66f4\u6539Nginx\u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u5934\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u4fe1\u606f\u7684\u8bf7\u6c42\u5934\u53d1\u7ed9\u88ab\u4ee3\u7406\u670d\u52a1\u5668</p> <p>\u8bed\u6cd5\uff1a proxy_set_header field value;</p> <p>\u9ed8\u8ba4\u914d\u7f6e\uff1a    </p> <pre><code>        proxy_set_header Host $proxy_host;\n        proxy_set_header Connection close;\n</code></pre> <ol> <li>proxy_set_body</li> </ol> <p>\u4f5c\u7528\uff1a\u66f4\u6539Nginx\u670d\u52a1\u5668\u63a5\u6536\u5230\u7684\u5ba2\u6237\u7aef\u5f3a\u6c42\u7684\u8bf7\u6c42\u4f53\u4fe1\u606f\uff0c\u7136\u540e\u5c06\u65b0\u7684\u8bf7\u6c42\u4f53\u53d1\u9001\u7ed9\u88ab\u4ee3\u7406\u670d\u52a1\u5668</p> <p>\u8bed\u6cd5\uff1aproxy_set_body value;</p> <ol> <li>proxy_connect_timeout</li> </ol> <p>\u4f5c\u7528\uff1a\u914d\u7f6eNginx\u670d\u52a1\u5668\u4e0e\u540e\u7aef\u4ee3\u7406\u670d\u52a1\u5668\u5c1d\u8bd5\u5efa\u7acb\u8fde\u63a5\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u9ed8\u8ba460s\u3002</p> <p>\u8bed\u6cd5\uff1aproxy_connect_timeout time;</p> <ol> <li>proxy_read_timeout</li> </ol> <p>\u4f5c\u7528\uff1a\u914d\u7f6eNginx\u670d\u52a1\u5668\u4e0e\u540e\u7aef\u4ee3\u7406\u53d1\u51faread\u8bf7\u6c42\u540e\uff0c\u7b49\u5f85\u54cd\u5e94\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba460s\u3002</p> <p>\u8bed\u6cd5\uff1aproxy_read_timeout time;</p> <ol> <li> <p>proxy_send_timeout</p> <p>\u4f5c\u7528\uff1a\u914d\u7f6eNginx\u670d\u52a1\u5668\u4e0e\u540e\u7aef\u4ee3\u7406\u53d1\u51fawrite\u8bf7\u6c42\u540e\uff0c\u7b49\u5f85\u54cd\u5e94\u7684\u8d85\u65f6\u65f6\u95f4\u3002\u9ed8\u8ba460s\u3002</p> <p>\u8bed\u6cd5\uff1aproxy_send_timeout time;</p> </li> <li> <p>proxy_http_verson</p> <p>\u4f5c\u7528\uff1a\u914d\u7f6eNginx\u670d\u52a1\u5668\u63d0\u4f9b\u4ee3\u7406\u670d\u52a1\u7684HTTP\u534f\u8bae\u7248\u672c\uff0c\u9ed8\u8ba41.0</p> <p>\u8bed\u6cd5\uff1aproxy_http_verson 1.0|1.1;</p> </li> <li> <p>proxy_method</p> <p>\u4f5c\u7528\uff1a\u8bbe\u7f6eNginx\u670d\u52a1\u5668\u8bf7\u6c42\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u65f6\u4f7f\u7528\u7684\u8bf7\u6c42\u65b9\u6cd5\uff0c\u8bbe\u7f6e\u4e86\u8be5\u6307\u4ee4\uff0c\u5ba2\u6237\u7aef\u8bf7\u6c42\u7684\u65b9\u6cd5\u88ab\u5ffd\u7565</p> <p>\u8bed\u6cd5\uff1aproxy_method method;</p> </li> <li> <p>proxy_ignore_client_abort</p> <p>\u4f5c\u7528\uff1a\u8bbe\u7f6e\u5728\u5ba2\u6237\u7aef\u4e2d\u65ad\u7f51\u7edc\u8bf7\u6c42\u65f6\uff0cNginx\u670d\u52a1\u5668\u662f\u5426\u4e2d\u65ad\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u7684\u8bf7\u6c42,\u9ed8\u8ba4off(\u4e2d\u65ad)</p> <p>\u8bed\u6cd5\uff1aproxy_ignore_client_abort on|off</p> </li> <li> <p>proxy_redirect</p> <p>\u4f5c\u7528\uff1a \u4e0eproxy_pass\u914d\u5408\u4f7f\u7528\uff0c\u4fee\u6539\u88ab\u4ee3\u7406\u670d\u52a1\u5668\u8fd4\u56de\u7684\u54cd\u5e94\u5934\u4e2d\u7684Location\u5934\u57df\u548cRefresh\u5934\u57df</p> <p>\u8bed\u6cd5\uff1a </p> <pre><code>    proxy_redirect default;(\u9ed8\u8ba4)\n    proxy_redirect off;\n    proxy_redirect redirect replacement;\n</code></pre> </li> </ol>"},{"location":"software/web/Tomcat/","title":"Tomcat","text":"<p>servlet\uff1a\u7c7b\u5e93\uff0c\u5bb9\u5668\uff0c\u80fd\u8ba9\u57fa\u4e8eservlet\u5f00\u53d1\u7684\u7a0b\u5e8f\u80fd\u5728servlet\u4e0a\u8fd0\u884c\u3002 JSP\uff1a\u7c7b\u5e93\uff0c\u80fd\u5c06java\u5199\u7684\u7a0b\u5e8f\u5d4c\u5165html\u4e2d\u3002 tomcat=JDK+servlet+jsp  java EE\u7684\u4e0d\u5b8c\u6574\u5b9e\u73b0\uff0ctomcat\u662f\u4e00\u4e2aweb container\u3002</p>"},{"location":"software/web/Tomcat/#tomcat","title":"\u4e00\u3001Tomcat \u4ecb\u7ecd","text":""},{"location":"software/web/Tomcat/#1-tomcat","title":"1. Tomcat \u6765\u5386","text":"<p>Sun \u65e9\u671f\u4e3a\u4e86\u80fd\u4e3a\u65e9\u671f\u63d0\u51fa\u7684\u5404\u79cd\u89c4\u8303\u505a\u4e00\u4e2a\u6f14\u793a\uff0c\u5bf9Servlet \u63d0\u4f9b\u4e86\u4e00\u4e2a\u53c2\u8003\u6027\u5b9e\u73b0\u53eb Java Web Server\uff1b ASF\u4e5f\u521b\u5efa\u4e86\u4e00\u4e2a\u53ebJServ\u3002\u540e\u6765\u5408\u5e76\u53ebTomcat 3.0, Tomcat 4.0\uff0c\u6709\u4e00\u4e2a\u9879\u76ee\u540d\u79f0\u53ebCatalina,\u540e\u6765\u7684Tomcat\u53d1\u578b\u7248\u4e2d\u9ed8\u8ba4\u7684Service\u5c31\u53ebCatalina\u3002</p>"},{"location":"software/web/Tomcat/#2-jdk","title":"2. JDK \u79cd\u7c7b","text":"<p>Oracle\uff1aJDK</p> <p>Oracle\uff1aJRockit</p> <p>Open\uff1a  OpenJDK</p>"},{"location":"software/web/Tomcat/#3-java-ee-application-servers","title":"3. Java EE Application Servers","text":""},{"location":"software/web/Tomcat/#1","title":"1. \u5546\u4e1a\u8f6f\u4ef6","text":"<ol> <li>Websphere  IBM</li> <li>Weblogic   Oracle</li> <li>JBoss      Redhat</li> <li>oc4j       Oracle</li> </ol>"},{"location":"software/web/Tomcat/#2","title":"2. \u5f00\u6e90\u8f6f\u4ef6","text":"<ol> <li>Jetty   </li> <li>Tomcat     Apache</li> <li>Resin</li> </ol>"},{"location":"software/web/Tomcat/#4-tomcat","title":"4. Tomcat\u7684\u7ec4\u4ef6","text":"<ol> <li>\u9876\u7ea7\u7ec4\u4ef6\uff1a\u4f4d\u4e8e\u6574\u4e2a\u914d\u7f6e\u7684\u9876\u5c42</li> <li>\u5bb9\u5668\u7c7b\u7ec4\u4ef6\uff1a\u53ef\u4ee5\u5305\u542b\u5176\u4ed6\u7ec4\u4ef6 </li> <li>\u8fde\u63a5\u5668\u7ec4\u4ef6\uff1a\u8fde\u63a5\u7528\u6237\u8bf7\u6c42\u81f3Tomcat</li> <li>\u88ab\u5d4c\u5957\u7c7b\u7ec4\u4ef6\uff1a\u4f4d\u4e8e\u4e00\u4e2a\u5bb9\u5668\u4e2d\uff0c\u4e0d\u80fd\u5305\u542b\u5176\u4ed6\u7ec4\u4ef6</li> </ol>"},{"location":"software/web/Tomcat/#41","title":"4.1 \u5bb9\u5668\u7c7b","text":"<ol> <li>engine\uff1a\u6838\u5fc3\u5bb9\u5668\uff1aCatalina\u5f15\u64ce\u3002\u901a\u8fc7connector\u63a5\u53d7\u7528\u6237\u8bf7\u6c42</li> <li>host:\u7c7b\u4f3c\u4e8eapache\u7684\u865a\u62df\u4e3b\u673a\u3002\u652f\u6301\u57fa\u4e8eFQDN\u7684\u865a\u62df\u4e3b\u673a</li> <li>context\uff1a\u6700\u5185\u5c42\u7684\u5bb9\u5668\u7c7b\u7ec4\u4ef6\uff0c\u4e00\u4e2acontext\u4ee3\u8868\u4e00\u4e2aweb\u5e94\u7528\u7a0b\u5e8f\uff0c\u914d\u7f6econtext\u7684\u4e3b\u8981\u76ee\u7684\u662fwebapp\u7684\u6839\u76ee\u5f55\u3002\u8fd8\u80fd\u914d\u7f6e\u4e00\u4e9b\u989d\u5916\u7684\u5c5e\u6027\uff0c\u5982\u90e8\u7f72\u65b9\u5f0f\u3002</li> <li>service\uff1a\u5c06\u8fde\u63a5\u5668\u5173\u8054\u81f3engine\uff0c\u4e00\u4e2aService\u5185\u90e8\u53ea\u80fd\u6709\u4e00\u4e2aengine\uff0c\u53ef\u4ee5\u6709\u591a\u4e2aconnector\u3002</li> </ol>"},{"location":"software/web/Tomcat/#42","title":"4.2 \u9876\u7ea7\u7ec4\u4ef6","text":"<ol> <li>server:\u4e00\u4e2a\u8fd0\u884c\u4e0eJVM\u4e2d\u7684Tomcat\u5b9e\u4f8b</li> </ol>"},{"location":"software/web/Tomcat/#43","title":"4.3 \u5d4c\u5957\u7c7b\u7ec4\u4ef6","text":"<ol> <li>valve\uff1a\u62e6\u622a\u8bf7\u6c42\uff0c\u5e76\u5728\u5c06\u5176\u8f6c\u81f3\u5bf9\u5e94\u7684webapp\u4e4b\u95f4\u8fdb\u884c\u9b54\u79cd\u5904\u7406\u64cd\u4f5c\u3002\u53ef\u7528\u4e8e\u4efb\u4f55\u5bb9\u5668\u4e2d</li> <li>access log valve\uff1a</li> <li> <p>remote address filter vlave\uff1a\u57fa\u4e8eIP\u505a\u8bbf\u95ee\u63a7\u5236</p> </li> <li> <p>logger\uff1a\u65e5\u5fd7\u8bb0\u5f55\u5668\uff0c\u7528\u4e8e\u8bb0\u5f55\u7ec4\u4ef6\u5185\u90e8\u7684\u72b6\u6001\u4fe1\u606f\uff1b\u53ef\u7528\u4e8e\u9664context\u4e4b\u5916\u7684\u4efb\u4f55\u5bb9\u5668\u4e2d\u3002</p> </li> <li> <p>realm\uff1a\u53ef\u7528\u4e8e\u4efb\u4f55\u5bb9\u5668\u7c7b\u7ec4\u4ef6\u4e2d\u3002\u5173\u8054\u4e00\u4e2a\u7528\u6237\u8ba4\u8bc1\u5e93\uff0c\u5b9e\u73b0\u8ba4\u8bc1\u548c\u6388\u6743\u3002</p> <ol> <li> <p>UserDatabaseRealm\uff1a\u57fa\u4e8eJNDI\u81ea\u5b9a\u4e49\u7684\u7528\u6237\u8ba4\u8bc1</p> </li> <li> <p>MemoryRealm:tomcat-users.xml</p> </li> <li> <p>JDBCRealm\uff1a\u57fa\u4e8eJDBC\u8fde\u63a5\u81f3\u6570\u636e\u5e93\u4e2d\u67e5\u627e\u7528\u6237</p> </li> </ol> </li> </ol>"},{"location":"software/web/Tomcat/#tomcat_1","title":"\u4e8c\u3001Tomcat \u5b89\u88c5","text":""},{"location":"software/web/Tomcat/#tomcat_2","title":"\u4e09\u3001Tomcat \u76ee\u5f55\u7ed3\u6784","text":"<pre><code>apache-tomcat-8.5.35/\n\u251c\u2500\u2500 bin \u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u542f\u52a8\u548c\u5173\u95edTomcat\u7684\u811a\u672c\u6587\u4ef6\n\u251c\u2500\u2500 BUILDING.txt\n\u251c\u2500\u2500 conf\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000Tomcat\u7684\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 CONTRIBUTING.md\n\u251c\u2500\u2500 lib\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000 \u5b58\u653eTomcat\u8fd0\u884c\u9700\u8981\u7684\u5e93\u6587\u4ef6\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 logs\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u5b58\u653eTomcat\u6267\u884c\u65f6\u7684log\u6587\u4ef6\n\u251c\u2500\u2500 NOTICE\n\u251c\u2500\u2500 README.md \n\u251c\u2500\u2500 RELEASE-NOTES\n\u251c\u2500\u2500 RUNNING.txt\n\u251c\u2500\u2500 temp              \u5b58\u653eTomcat\u6267\u884c\u65f6\u7684LOG\u6587\u4ef6\n\u251c\u2500\u2500 webapps           \u5b58\u653eTomcat\u7684\u5e94\u7528\u6587\u4ef6\n\u2514\u2500\u2500 work              \u5b58\u653eTomcat\u8fd0\u884c\u65f6\u4ea7\u751f\u7684class\u6587\u4ef6\n</code></pre> <p>bin\u76ee\u5f55\u7ed3\u6784</p> <p>bin\u4e0b\u7684\u811a\u672c\u4e3b\u8981\u6709\u4e24\u79cd\uff0c\u4e00\u79cd\u4ee5.bat\u7ed3\u5c3e\u7684\u662f\u5728Windows\u73af\u5883\u4e0b\u8fd0\u884c\u7684\uff0c\u4e00\u79cd\u4ee5.sh\u7ed3\u5c3e\u7684\u662f\u5728Linux\u73af\u5883\u4e0b\u8fd0\u884c\u7684\u3002\u8fd9\u91cc\u4ee5Linux\u4ecb\u7ecd\u811a\u672c\u7684\u7528\u9014</p> <pre><code>bin\n\u251c\u2500\u2500 catalina.sh\u3000\u3000\u3000\u3000Tomcat\u7684\u4e3b\u8981\u811a\u672c\uff0c\u4f1a\u6267\u884cjava\u547d\u4ee4\u4ee5\u8c03\u7528Tomcat\u7684\u542f\u52a8\u548c\u505c\u6b62\u7c7b\n\u251c\u2500\u2500 configtest.sh\n\u251c\u2500\u2500 daemon.sh\n\u251c\u2500\u2500 digest.sh\u3000\u3000\u3000\u3000\u3000\u751f\u4ea7Tomcat\u5bc6\u7801\u7684\u52a0\u5bc6\u6458\u8981\u503c\uff0c\u7528\u4e8e\u751f\u6210\u52a0\u5bc6\u8fc7\u7684\u5bc6\u7801\n\u251c\u2500\u2500 setclasspath.sh\u3000\u3000\u552f\u4e00\u7528\u4e8e\u7cfb\u7edf\u5185\u90e8\u4ee5\u8bbe\u5b9aTomcat\u7684classpath\u53ca\u8bb8\u591a\u5176\u4ed6\u73af\u5883\u53d8\u91cf\u7684\u811a\u672c\u3000\u3000\n\u251c\u2500\u2500 shutdown.sh\u3000\u3000\u3000\u3000\u8fd0\u884ccatalina\u4ee5\u505c\u6b62Tomcat\u8fd0\u884c\n\u251c\u2500\u2500 startup.sh\u3000\u3000\u3000\u3000\u3000\u8fd0\u884ccatalina\u4ee5\u542f\u52a8Tomcat\u8fd0\u884c\n\u251c\u2500\u2500 tool-wrapper.sh\u3000\u3000\u7528\u4e8edigest\u811a\u672c\u7cfb\u7edf\u5185\u90e8\uff0c\u7528\u4e8e\u5c01\u88c5\u53ef\u7528\u4e0e\u8bbe\u7f6e\u73af\u5883\u53d8\u91cf\u7684\u811a\u672c\uff0c\u5e76\u8c03\u7528Classpath\u4e2d\u8bbe\u7f6e\u7684\u5b8c\u5168\u7b26\u5408\u8bbe\u5b9a\u7684\u4e3b\u8981\u65b9\u6cd5\n\u2514\u2500\u2500 version.sh\u3000\u3000\u3000\u3000\u3000\u8f93\u51faTomcat\u7684\u7248\u672c\u4fe1\u606f\n</code></pre> <p>conf\u76ee\u5f55\u7ed3\u6784</p> <p>\u5b58\u653eTomcat\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6 <pre><code>conf/\n\u251c\u2500\u2500 Catalina\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u7528\u4e8e\u5b58\u50a8\u81ea\u5b9a\u4e49\u90e8\u7f72Web\u5e94\u7528\u7684\u8def\u5f84\n\u2502   \u2514\u2500\u2500 localhost\n\u251c\u2500\u2500 catalina.policy\n\u251c\u2500\u2500 catalina.properties\n\u251c\u2500\u2500 context.xml\n\u251c\u2500\u2500 jaspic-providers.xml\n\u251c\u2500\u2500 jaspic-providers.xsd\n\u251c\u2500\u2500 logging.properties\n\u251c\u2500\u2500 server.xml\n\u251c\u2500\u2500 tomcat-users.xml\n\u251c\u2500\u2500 tomcat-users.xsd\n\u2514\u2500\u2500 web.xml\n</code></pre></p>"},{"location":"software/web/Tomcat/#tomcat_3","title":"\u56db\u3001Tomcat\u751f\u547d\u5468\u671f\u7ba1\u7406","text":""},{"location":"software/web/Tomcat/#1_1","title":"1.\u542f\u52a8","text":""},{"location":"software/web/Tomcat/#2_1","title":"2. \u5173\u95ed","text":""},{"location":"software/web/Tomcat/#3","title":"3.\u8fdb\u7a0b\u7ba1\u7406","text":"<p>\u901a\u8fc7java\u81ea\u5e26\u7684jps\u547d\u4ee4\u67e5\u627eTomcat\u7684JVM\u4e0a\u662f\u5426\u4fdd\u7559Tomcat\u8fdb\u7a0b</p> <pre><code>$ jps  | grep Bootstrap\n</code></pre>"},{"location":"software/web/Tomcat/#_1","title":"\u4e94\u3001\u914d\u7f6e\u6587\u4ef6\u89e3\u91ca","text":"<pre><code>&lt;?xml version='1.0' encoding='utf-8'?&gt;\n&lt;Server port=\"8005\" shutdown=\"SHUTDOWN\"&gt;\n  &lt;Listener className=\"org.apache.catalina.startup.VersionLoggerListener\" /&gt;\n  &lt;Listener className=\"org.apache.catalina.security.SecurityListener\" /&gt;\n  &lt;Listener className=\"org.apache.catalina.core.AprLifecycleListener\" SSLEngine=\"on\" /&gt;\n  &lt;Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" /&gt;\n  &lt;Listener className=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" /&gt;\n  &lt;Listener className=\"org.apache.catalina.core.ThreadLocalLeakPreventionListener\" /&gt;\n\n  &lt;!-- \u5168\u5c40\u547d\u540d\u8d44\u6e90--&gt;\n  &lt;GlobalNamingResources&gt;\n    &lt;Resource name=\"UserDatabase\" auth=\"Container\"\n              type=\"org.apache.catalina.UserDatabase\"\n              description=\"User database that can be updated and saved\"\n              factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\"\n              pathname=\"conf/tomcat-users.xml\" /&gt;\n                &lt;!--\u52a0\u8f7dconf/tomcat-users.xml\u4e2d\u7684\u5185\u5bb9--&gt;\n  &lt;/GlobalNamingResources&gt;\n\n   &lt;Service name=\"Catalina\"&gt;\n  &lt;!--\u5b9a\u4e49\u4e00\u4e2aHTTP\u7c7b\u578b\u7684\u8fde\u63a5\u5668\uff0c\u7aef\u53e3\u4e3a8080\uff0c\u7b49\u5f85\u5ba2\u6237\u7aef\u53d1\u9001\u8bf7\u6c42\u7684\u8d85\u65f6\u65f6\u95f4\uff0c\u5355\u4f4d\u4e3a\u6beb\u79d2--&gt;\n     &lt;Connector port=\"8080\" protocol=\"HTTP/1.1\"\n               connectionTimeout=\"20000\"\n               redirectPort=\"8443\" /&gt;\n  &lt;!--\u5b9a\u4e49\u4e00\u4e2aAJP\u7c7b\u578b\u7684\u8fde\u63a5\u5668--&gt;\n     &lt;Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" /&gt;\n  &lt;!--\u5b9a\u4e49\u5f53\u524d\u5f15\u64ce\u7684\u540d\u5b57\u548c\u9ed8\u8ba4\u4e3b\u673a--&gt;\n    &lt;Engine name=\"Catalina\" defaultHost=\"localhost\"&gt;\n  &lt;!--\u5b9a\u4e49\u5bf9\u5f53\u524d\u5bb9\u5668\u5e94\u7528\u7a0b\u5e8f\u7684\u8bbf\u95ee\u8ba4\u8bc1\u65b9\u5f0f--&gt;\n      &lt;Realm className=\"org.apache.catalina.realm.LockOutRealm\"&gt;\n        &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\"\n               resourceName=\"UserDatabase\"/&gt;\n                        &lt;!--\u901a\u8fc7UserDatabase\u8fdb\u884c\u8ba4\u8bc1 --&gt;\n      &lt;/Realm&gt;\n        &lt;!--\u5b9a\u4e49\u4e3b\u673a\u540d\uff0c \u5e94\u7528\u7a0b\u5e8f\u7684\u76ee\u5f55\uff08e.g:/web\uff09,\u9ed8\u8ba4\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684webapps\n        uppackWaRs\u5b9a\u4e49\u662f\u4e0d\u662f\u5b50\u81ea\u52a8\u89e3\u538bwar\u5305\uff0cautoDeploy\u5b9a\u4e49\u662f\u591f\u81ea\u52a8\u90e8\u7f72webapps\u4e0b\u7684\u5e94\u7528--&gt;\n      &lt;Host name=\"localhost\"  appBase=\"webapps\"\n            unpackWARs=\"true\" autoDeploy=\"true\"&gt;\n        &lt;!--\u53ef\u9009\uff1a\u5b9a\u4e49\u522b\u540d--&gt;\n        &lt;Alisa&gt;www.example.com&lt;/Alisa&gt;\n        &lt;!--\u66f4\u6539\u8bbf\u95ee\u9ed8\u8ba4\u8def\u5f84--&gt;\n        &lt;Context path=\"\" docBase=\"/web/sample\" reloadable=\"true\" /&gt;\n        &lt;!--   \u5b9a\u4e49\u4e00\u4e2aValve\u7ec4\u4ef6\uff0c\u7528\u6765\u8bb0\u5f55tomcat\u7684\u8bbf\u95ee\u65e5\u5fd7\uff0c\u65e5\u5fd7\u5b58\u653e\u76ee\u5f55\u4e3a\u5b89\u88c5tomcat\u4e0b\u7684logs,\u540e\u7f00\u4e3a.txt--&gt;\n        &lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n               prefix=\"localhost_access_log\" suffix=\".txt\"\n               pattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n    &lt;Valve className=\"org.apache.catalina.valves.RemoteAddrValve\" allow=\"192.168.1.*\" /&gt; \n        &lt;!--   \u5b9a\u4e49\u8fdc\u7a0b\u5730\u5740\u8bbf\u95ee\u7b56\u7565\uff0c\u4ec5\u5141\u8bb8192.168.1.*\u7f51\u6bb5\u8bbf\u95ee\u8be5\u4e3b\u673a\uff0c\u5176\u4ed6\u7684\u5c06\u88ab\u62d2\u7edd\u8bbf\u95ee  --&gt;\n      &lt;/Host&gt;\n      &lt;Host name='www.gaoyuanzhi.xyz' appBase='/www/webapps'\n            unpackWARs=\"true\" autoDeploy=\"true\"&gt;\n          &lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\"\n               prefix=\"gaoyuanzhi.xyz_access_log\" suffix=\".txt\"\n               pattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt;\n      &lt;/Host&gt;\n    &lt;/Engine&gt;\n  &lt;/Service&gt;\n&lt;/Server&gt;\n</code></pre> <p>Tomcat\u4f18\u5316 \u5185\u5b58\u7a7a\u95f4\u4f18\u5316\uff1a</p> <p>-x -XX </p> <p>jinfo</p> <p>-Xmx \uff1a\u5806\u5185\u5b58\u7a7a\u95f4\u7684\u6700\u5927\u503c -Xms  \u5806\u5185\u5b58\u521d\u59cb\u5316\u5927\u5c0f</p> <p>\u5b9a\u4e49\u5728\u5806\u5185\u90e8\u5982\u4f55\u4f7f\u7528\u5185\u5b58\u7a7a\u95f4 -XX:NewSize: \u65b0\u751f\u4ee3\u521d\u59cb\u5316\u5927\u5c0f -XX MaxNewSize :\u65b0\u751f\u4ee3\u7a7a\u95f4\u6700\u5927\u503c \u8001\u5e74\u4ee3\u521d\u59cb\u5316\u7a7a\u95f4=-Xms --XX:NewSize -XX:SurvivorRatio\uff1a\u5e74\u8f7b\u4ee3\u4e2dEden\u533a\u4e0eSurvivor\u533a\u7684\u5927\u5c0f\u6bd4\u503c</p> <p>-XX PermSize: \u6301\u4e45\u4ee3\u521d\u59cb\u5316\u503c -XX MaxPermSize: \u6301\u4e45\u4ee3\u6700\u5927\u503c</p> <p>\u76d1\u63a7\uff1a jstat gc   jstat -gc 1576 1000 <p>jconsole visualvm jprofiler janalyzer</p>"},{"location":"software/web/Tomcat/#tomcat-apr","title":"\u516d\u3001tomcat APR\u6a21\u5f0f\u914d\u7f6e","text":""},{"location":"software/web/Tomcat/#1_2","title":"1. \u73af\u5883","text":"<p>\u64cd\u4f5c\u7cfb\u7edf\uff1aUbutnu 14</p> <pre><code>ubuntu@ubuntu:~$ uname -a\nLinux ubuntu 4.4.0-31-generic #50~14.04.1-Ubuntu SMP Wed Jul 13 01:07:32 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n</code></pre> <p>JDK 1.8</p> <pre><code>ubuntu@ubuntu:~$ java -version\njava version \"1.8.0_141\"\nJava(TM) SE Runtime Environment (build 1.8.0_141-b15)\nJava HotSpot(TM) 64-Bit Server VM (build 25.141-b15, mixed mode)\nubuntu@ubuntu:~$ whereis java\njava: /usr/local/java /usr/share/java\n</code></pre> <p>Tomcat 8.5.35</p> <pre><code>root@ubuntu:~# /var/www/demo/bin/version.sh\nUsing CATALINA_BASE:   /var/www/demo\nUsing CATALINA_HOME:   /var/www/demo\nUsing CATALINA_TMPDIR: /var/www/demo/temp\nUsing JRE_HOME:        /usr/local/java/jre\nUsing CLASSPATH:       /var/www/demo/bin/bootstrap.jar:/var/www/demo/bin/tomcat-juli.jar\nServer version: Apache Tomcat/8.5.35\nServer built:   Nov 3 2018 17:39:20 UTC\nServer number:  8.5.35.0\nOS Name:        Linux\nOS Version:     4.4.0-31-generic\nArchitecture:   amd64\nJVM Version:    1.8.0_141-b15\nJVM Vendor:     Oracle Corporation\n</code></pre>"},{"location":"software/web/Tomcat/#2_2","title":"2. \u5b89\u88c5","text":""},{"location":"software/web/Tomcat/#1_3","title":"1. \u5b89\u88c5\u7f16\u8bd1\u9700\u8981\u7684\u73af\u5883","text":"<pre><code>$ sudo apt install gcc make\n</code></pre>"},{"location":"software/web/Tomcat/#2-native","title":"2. \u5b89\u88c5 native\u3000\u7f16\u8bd1\u6240\u9700\u8981\u7684\u4f9d\u8d56\u5305","text":"<pre><code># apache apr\n$ sudo apt install libapr1-dev\n# openssl,\u81ea\u5e26\u7684 openssl\u7248\u672c\u8f83\u4f4e\uff0c\u9700\u8981\u7f16\u8bd1\u5b89\u88c5\n$ wget https://www.openssl.org/source/openssl-1.1.1a.tar.gz\n$ sudo mkdir /usr/local/openssl\n$ tar zxf openssl-1.1.1a.tar.gz\n$ ./config --prefix=/usr/local/openssl\n$ make\n$ sudo make install\n</code></pre>"},{"location":"software/web/Tomcat/#3native","title":"3.\u4e0b\u8f7d\u5b89\u88c5native","text":"<pre><code>$ wget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-connectors/native/1.2.19/source/tomcat-native-1.2.19-src.tar.gz\n$ cd tomcat-native-1.2.19-src/native/\n$ ./configure  --with-ssl=/usr/local/openssl\n$ make\n$ sudo make install\n</code></pre>"},{"location":"software/web/Tomcat/#3-tomcat","title":"3. \u914d\u7f6eTomcat","text":"<pre><code>root@ubuntu:/var/www/demo# cat bin/setenv.sh \nexport JAVA_OPTS=\"$JAVA_OPTS -Djava.library.path=/usr/local/apr/lib\"\n</code></pre> <pre><code>    &lt;Connector port=\"8080\" \n               protocol=\"org.apache.coyote.http11.Http11AprProtocol\"\n               connectionTimeout=\"20000\"\n               redirectPort=\"8443\" /&gt;\n    ...\n    &lt;!--&lt;Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" /&gt; --&gt;\n</code></pre>"},{"location":"software/web/Tomcat/#4-tomcat_1","title":"4. \u542f\u52a8Tomcat","text":"<pre><code>root@ubuntu:/var/www/demo# bin/catalina.sh run\n.....\n28-Jan-2019 15:55:09.140 INFO [localhost-startStop-1] org.apache.catalina.startup.HostConfig.deployDirectory Deployment of web application directory [/var/www/demo/webapps/docs] has finished in [13] ms\n28-Jan-2019 15:55:09.153 INFO [main] org.apache.coyote.AbstractProtocol.start Starting ProtocolHandler [\"http-apr-8080\"]\n28-Jan-2019 15:55:09.172 INFO [main] org.apache.catalina.startup.Catalina.start Server startup in 803 ms\n</code></pre>"},{"location":"software/web/Tomcat/#5-apr","title":"5. \u7f16\u8bd1\u65b9\u5f0f\u5b89\u88c5apr","text":""},{"location":"software/web/Tomcat/#1_4","title":"1. \u5b89\u88c5\u7f16\u8bd1\u9700\u8981\u7684\u73af\u5883","text":"<pre><code>$ sudo apt install -y gcc make  libtool  libexpat1-dev\n</code></pre>"},{"location":"software/web/Tomcat/#2-apache-portable-runtime-apr","title":"2. \u5b89\u88c5Apache Portable Runtime (apr)","text":"<p>\u5b98\u65b9\u5730\u5740\uff1ahttps://apr.apache.org/compiling_unix.html</p>"},{"location":"software/web/Tomcat/#1-apr","title":"1. \u7f16\u8bd1\u5b89\u88c5apr","text":"<pre><code>wget http://mirrors.shu.edu.cn/apache//apr/apr-1.6.5.tar.gz\ntar zxf apr-1.6.5.tar.gz\ncd apr-1.6.5/\n./configure --prefix=/usr/local/apache-apr\nmake\nsudo make install\n</code></pre>"},{"location":"software/web/Tomcat/#2-apr-iconv","title":"2. \u7f16\u8bd1\u5b89\u88c5apr-iconv","text":"<pre><code>wget http://mirrors.shu.edu.cn/apache//apr/apr-iconv-1.2.2.tar.gz\ntar zxf apr-iconv-1.2.2.tar.gz\ncd apr-iconv-1.2.2/\n./configure --prefix=/usr/local/apache-apr-iconv --with-apr=/usr/local/apache-apr\nmake\nsudo make install\n</code></pre>"},{"location":"software/web/Tomcat/#3-apr-util","title":"3. \u7f16\u8bd1\u5b89\u88c5apr-util","text":"<pre><code>wget http://mirrors.shu.edu.cn/apache//apr/apr-util-1.6.1.tar.gz\nubuntu@ubuntu:~/apr-util-1.6.1$ ./configure --prefix=/usr/local/apache-apr-util --with-apr=/usr/local/apache-apr --with-apr-iconv=/usr/local/apache-apr-iconv/bin/apriconv\ntar zxf apr-util-1.6.1.tar.gz\ncd apr-util-1.6.1/\nmake\nsudo make install\n</code></pre>"},{"location":"software/web/Tomcat/#3-openssl","title":"3. \u7f16\u8bd1\u5b89\u88c5openssl","text":"<pre><code>wget https://www.openssl.org/source/openssl-1.1.1a.tar.gz\n$ sudo mkdir /usr/local/openssl\n$ tar zxf openssl-1.1.1a.tar.gz\n$ ./config --prefix=/usr/local/openssl\ncd openssl-1.1.1a\n$ make\n$ sudo make install\n</code></pre>"},{"location":"software/web/Tomcat/#4-native","title":"4. \u7f16\u8bd1\u5b89\u88c5native","text":"<pre><code>wget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-connectors/native/1.2.19/source/tomcat-native-1.2.19-src.tar.gz\ntar zxf tomcat-native-1.2.19-src.tar.gz\n$ cd tomcat-native-1.2.19-src/native/\n$ ./configure --prefix=/usr/local/native --with-ssl=/usr/local/openssl --with-apr=/usr/local/apache-apr/bin/apr-1-config\n$ make\n$ sudo make install\n</code></pre>"}]}